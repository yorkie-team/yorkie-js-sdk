var Ed=Object.defineProperty;var Cd=(r,e,t)=>e in r?Ed(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var a=(r,e,t)=>Cd(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Hc(r){const e=Object.create(null);for(const t of r.split(","))e[t]=1;return t=>t in e}const le={},Fs=[],Ht=()=>{},Pd=()=>!1,ra=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&(r.charCodeAt(2)>122||r.charCodeAt(2)<97),Gc=r=>r.startsWith("onUpdate:"),qe=Object.assign,_c=(r,e)=>{const t=r.indexOf(e);t>-1&&r.splice(t,1)},Nd=Object.prototype.hasOwnProperty,se=(r,e)=>Nd.call(r,e),H=Array.isArray,Ms=r=>na(r)==="[object Map]",df=r=>na(r)==="[object Set]",_=r=>typeof r=="function",xe=r=>typeof r=="string",os=r=>typeof r=="symbol",we=r=>r!==null&&typeof r=="object",gf=r=>(we(r)||_(r))&&_(r.then)&&_(r.catch),mf=Object.prototype.toString,na=r=>mf.call(r),Dd=r=>na(r).slice(8,-1),pf=r=>na(r)==="[object Object]",Yc=r=>xe(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,vi=Hc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),sa=r=>{const e=Object.create(null);return t=>e[t]||(e[t]=r(t))},Od=/-(\w)/g,ss=sa(r=>r.replace(Od,(e,t)=>t?t.toUpperCase():"")),Bd=/\B([A-Z])/g,as=sa(r=>r.replace(Bd,"-$1").toLowerCase()),yf=sa(r=>r.charAt(0).toUpperCase()+r.slice(1)),Ta=sa(r=>r?`on${yf(r)}`:""),ws=(r,e)=>!Object.is(r,e),lo=(r,...e)=>{for(let t=0;t<r.length;t++)r[t](...e)},za=(r,e,t,n=!1)=>{Object.defineProperty(r,e,{configurable:!0,enumerable:!1,writable:n,value:t})},qa=r=>{const e=parseFloat(r);return isNaN(e)?r:e};let $u;const ia=()=>$u||($u=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Xc(r){if(H(r)){const e={};for(let t=0;t<r.length;t++){const n=r[t],s=xe(n)?$d(n):Xc(n);if(s)for(const i in s)e[i]=s[i]}return e}else if(xe(r)||we(r))return r}const Rd=/;(?![^(]*\))/g,Ld=/:([^]+)/,Jd=/\/\*[^]*?\*\//g;function $d(r){const e={};return r.replace(Jd,"").split(Rd).forEach(t=>{if(t){const n=t.split(Ld);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Zc(r){let e="";if(xe(r))e=r;else if(H(r))for(let t=0;t<r.length;t++){const n=Zc(r[t]);n&&(e+=n+" ")}else if(we(r))for(const t in r)r[t]&&(e+=t+" ");return e.trim()}const Fd="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Md=Hc(Fd);function vf(r){return!!r||r===""}const wf=r=>!!(r&&r.__v_isRef===!0),Ka=r=>xe(r)?r:r==null?"":H(r)||we(r)&&(r.toString===mf||!_(r.toString))?wf(r)?Ka(r.value):JSON.stringify(r,bf,2):String(r),bf=(r,e)=>wf(e)?bf(r,e.value):Ms(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[n,s],i)=>(t[Aa(n,i)+" =>"]=s,t),{})}:df(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Aa(t))}:os(e)?Aa(e):we(e)&&!H(e)&&!pf(e)?String(e):e,Aa=(r,e="")=>{var t;return os(r)?`Symbol(${(t=r.description)!=null?t:e})`:r};/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let je;class Ud{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=je,!e&&je&&(this.index=(je.scopes||(je.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=je;try{return je=this,e()}finally{je=t}}}on(){++this._on===1&&(this.prevScope=je,je=this)}off(){this._on>0&&--this._on===0&&(je=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function zd(){return je}let ge;const Ia=new WeakSet;class Sf{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,je&&je.active&&je.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ia.has(this)&&(Ia.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Af(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Fu(this),If(this);const e=ge,t=Et;ge=this,Et=!0;try{return this.fn()}finally{kf(this),ge=e,Et=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)tu(e);this.deps=this.depsTail=void 0,Fu(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ia.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Va(this)&&this.run()}get dirty(){return Va(this)}}let Tf=0,wi,bi;function Af(r,e=!1){if(r.flags|=8,e){r.next=bi,bi=r;return}r.next=wi,wi=r}function Qc(){Tf++}function eu(){if(--Tf>0)return;if(bi){let e=bi;for(bi=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let r;for(;wi;){let e=wi;for(wi=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){r||(r=n)}e=t}}if(r)throw r}function If(r){for(let e=r.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function kf(r){let e,t=r.depsTail,n=t;for(;n;){const s=n.prevDep;n.version===-1?(n===t&&(t=s),tu(n),qd(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=s}r.deps=e,r.depsTail=t}function Va(r){for(let e=r.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(xf(e.dep.computed)||e.dep.version!==e.version))return!0;return!!r._dirty}function xf(r){if(r.flags&4&&!(r.flags&16)||(r.flags&=-17,r.globalVersion===Di)||(r.globalVersion=Di,!r.isSSR&&r.flags&128&&(!r.deps&&!r._dirty||!Va(r))))return;r.flags|=2;const e=r.dep,t=ge,n=Et;ge=r,Et=!0;try{If(r);const s=r.fn(r._value);(e.version===0||ws(s,r._value))&&(r.flags|=128,r._value=s,e.version++)}catch(s){throw e.version++,s}finally{ge=t,Et=n,kf(r),r.flags&=-3}}function tu(r,e=!1){const{dep:t,prevSub:n,nextSub:s}=r;if(n&&(n.nextSub=s,r.prevSub=void 0),s&&(s.prevSub=n,r.nextSub=void 0),t.subs===r&&(t.subs=n,!n&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)tu(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function qd(r){const{prevDep:e,nextDep:t}=r;e&&(e.nextDep=t,r.prevDep=void 0),t&&(t.prevDep=e,r.nextDep=void 0)}let Et=!0;const Ef=[];function zn(){Ef.push(Et),Et=!1}function qn(){const r=Ef.pop();Et=r===void 0?!0:r}function Fu(r){const{cleanup:e}=r;if(r.cleanup=void 0,e){const t=ge;ge=void 0;try{e()}finally{ge=t}}}let Di=0;class Kd{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Cf{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!ge||!Et||ge===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==ge)t=this.activeLink=new Kd(ge,this),ge.deps?(t.prevDep=ge.depsTail,ge.depsTail.nextDep=t,ge.depsTail=t):ge.deps=ge.depsTail=t,Pf(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const n=t.nextDep;n.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=n),t.prevDep=ge.depsTail,t.nextDep=void 0,ge.depsTail.nextDep=t,ge.depsTail=t,ge.deps===t&&(ge.deps=n)}return t}trigger(e){this.version++,Di++,this.notify(e)}notify(e){Qc();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{eu()}}}function Pf(r){if(r.dep.sc++,r.sub.flags&4){const e=r.dep.computed;if(e&&!r.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)Pf(n)}const t=r.dep.subs;t!==r&&(r.prevSub=t,t&&(t.nextSub=r)),r.dep.subs=r}}const ja=new WeakMap,bs=Symbol(""),Wa=Symbol(""),Oi=Symbol("");function De(r,e,t){if(Et&&ge){let n=ja.get(r);n||ja.set(r,n=new Map);let s=n.get(t);s||(n.set(t,s=new Cf),s.map=n,s.key=t),s.track()}}function On(r,e,t,n,s,i){const o=ja.get(r);if(!o){Di++;return}const c=u=>{u&&u.trigger()};if(Qc(),e==="clear")o.forEach(c);else{const u=H(r),f=u&&Yc(t);if(u&&t==="length"){const h=Number(n);o.forEach((d,p)=>{(p==="length"||p===Oi||!os(p)&&p>=h)&&c(d)})}else switch((t!==void 0||o.has(void 0))&&c(o.get(t)),f&&c(o.get(Oi)),e){case"add":u?f&&c(o.get("length")):(c(o.get(bs)),Ms(r)&&c(o.get(Wa)));break;case"delete":u||(c(o.get(bs)),Ms(r)&&c(o.get(Wa)));break;case"set":Ms(r)&&c(o.get(bs));break}}eu()}function Cs(r){const e=ae(r);return e===r?e:(De(e,"iterate",Oi),Ct(r)?e:e.map(Fe))}function oa(r){return De(r=ae(r),"iterate",Oi),r}const Vd={__proto__:null,[Symbol.iterator](){return ka(this,Symbol.iterator,Fe)},concat(...r){return Cs(this).concat(...r.map(e=>H(e)?Cs(e):e))},entries(){return ka(this,"entries",r=>(r[1]=Fe(r[1]),r))},every(r,e){return nr(this,"every",r,e,void 0,arguments)},filter(r,e){return nr(this,"filter",r,e,t=>t.map(Fe),arguments)},find(r,e){return nr(this,"find",r,e,Fe,arguments)},findIndex(r,e){return nr(this,"findIndex",r,e,void 0,arguments)},findLast(r,e){return nr(this,"findLast",r,e,Fe,arguments)},findLastIndex(r,e){return nr(this,"findLastIndex",r,e,void 0,arguments)},forEach(r,e){return nr(this,"forEach",r,e,void 0,arguments)},includes(...r){return xa(this,"includes",r)},indexOf(...r){return xa(this,"indexOf",r)},join(r){return Cs(this).join(r)},lastIndexOf(...r){return xa(this,"lastIndexOf",r)},map(r,e){return nr(this,"map",r,e,void 0,arguments)},pop(){return ui(this,"pop")},push(...r){return ui(this,"push",r)},reduce(r,...e){return Mu(this,"reduce",r,e)},reduceRight(r,...e){return Mu(this,"reduceRight",r,e)},shift(){return ui(this,"shift")},some(r,e){return nr(this,"some",r,e,void 0,arguments)},splice(...r){return ui(this,"splice",r)},toReversed(){return Cs(this).toReversed()},toSorted(r){return Cs(this).toSorted(r)},toSpliced(...r){return Cs(this).toSpliced(...r)},unshift(...r){return ui(this,"unshift",r)},values(){return ka(this,"values",Fe)}};function ka(r,e,t){const n=oa(r),s=n[e]();return n!==r&&!Ct(r)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=t(i.value)),i}),s}const jd=Array.prototype;function nr(r,e,t,n,s,i){const o=oa(r),c=o!==r&&!Ct(r),u=o[e];if(u!==jd[e]){const d=u.apply(r,i);return c?Fe(d):d}let f=t;o!==r&&(c?f=function(d,p){return t.call(this,Fe(d),p,r)}:t.length>2&&(f=function(d,p){return t.call(this,d,p,r)}));const h=u.call(o,f,n);return c&&s?s(h):h}function Mu(r,e,t,n){const s=oa(r);let i=t;return s!==r&&(Ct(r)?t.length>3&&(i=function(o,c,u){return t.call(this,o,c,u,r)}):i=function(o,c,u){return t.call(this,o,Fe(c),u,r)}),s[e](i,...n)}function xa(r,e,t){const n=ae(r);De(n,"iterate",Oi);const s=n[e](...t);return(s===-1||s===!1)&&iu(t[0])?(t[0]=ae(t[0]),n[e](...t)):s}function ui(r,e,t=[]){zn(),Qc();const n=ae(r)[e].apply(r,t);return eu(),qn(),n}const Wd=Hc("__proto__,__v_isRef,__isVue"),Nf=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(os));function Hd(r){os(r)||(r=String(r));const e=ae(this);return De(e,"has",r),e.hasOwnProperty(r)}class Df{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return n===(s?i?ng:Lf:i?Rf:Bf).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=H(e);if(!s){let u;if(o&&(u=Vd[t]))return u;if(t==="hasOwnProperty")return Hd}const c=Reflect.get(e,t,ze(e)?e:n);return(os(t)?Nf.has(t):Wd(t))||(s||De(e,"get",t),i)?c:ze(c)?o&&Yc(t)?c:c.value:we(c)?s?Jf(c):nu(c):c}}class Of extends Df{constructor(e=!1){super(!1,e)}set(e,t,n,s){let i=e[t];if(!this._isShallow){const u=Ts(i);if(!Ct(n)&&!Ts(n)&&(i=ae(i),n=ae(n)),!H(e)&&ze(i)&&!ze(n))return u?!1:(i.value=n,!0)}const o=H(e)&&Yc(t)?Number(t)<e.length:se(e,t),c=Reflect.set(e,t,n,ze(e)?e:s);return e===ae(s)&&(o?ws(n,i)&&On(e,"set",t,n):On(e,"add",t,n)),c}deleteProperty(e,t){const n=se(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&n&&On(e,"delete",t,void 0),s}has(e,t){const n=Reflect.has(e,t);return(!os(t)||!Nf.has(t))&&De(e,"has",t),n}ownKeys(e){return De(e,"iterate",H(e)?"length":bs),Reflect.ownKeys(e)}}class Gd extends Df{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const _d=new Of,Yd=new Gd,Xd=new Of(!0);const Ha=r=>r,Qi=r=>Reflect.getPrototypeOf(r);function Zd(r,e,t){return function(...n){const s=this.__v_raw,i=ae(s),o=Ms(i),c=r==="entries"||r===Symbol.iterator&&o,u=r==="keys"&&o,f=s[r](...n),h=t?Ha:e?To:Fe;return!e&&De(i,"iterate",u?Wa:bs),{next(){const{value:d,done:p}=f.next();return p?{value:d,done:p}:{value:c?[h(d[0]),h(d[1])]:h(d),done:p}},[Symbol.iterator](){return this}}}}function eo(r){return function(...e){return r==="delete"?!1:r==="clear"?void 0:this}}function Qd(r,e){const t={get(s){const i=this.__v_raw,o=ae(i),c=ae(s);r||(ws(s,c)&&De(o,"get",s),De(o,"get",c));const{has:u}=Qi(o),f=e?Ha:r?To:Fe;if(u.call(o,s))return f(i.get(s));if(u.call(o,c))return f(i.get(c));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!r&&De(ae(s),"iterate",bs),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=ae(i),c=ae(s);return r||(ws(s,c)&&De(o,"has",s),De(o,"has",c)),s===c?i.has(s):i.has(s)||i.has(c)},forEach(s,i){const o=this,c=o.__v_raw,u=ae(c),f=e?Ha:r?To:Fe;return!r&&De(u,"iterate",bs),c.forEach((h,d)=>s.call(i,f(h),f(d),o))}};return qe(t,r?{add:eo("add"),set:eo("set"),delete:eo("delete"),clear:eo("clear")}:{add(s){!e&&!Ct(s)&&!Ts(s)&&(s=ae(s));const i=ae(this);return Qi(i).has.call(i,s)||(i.add(s),On(i,"add",s,s)),this},set(s,i){!e&&!Ct(i)&&!Ts(i)&&(i=ae(i));const o=ae(this),{has:c,get:u}=Qi(o);let f=c.call(o,s);f||(s=ae(s),f=c.call(o,s));const h=u.call(o,s);return o.set(s,i),f?ws(i,h)&&On(o,"set",s,i):On(o,"add",s,i),this},delete(s){const i=ae(this),{has:o,get:c}=Qi(i);let u=o.call(i,s);u||(s=ae(s),u=o.call(i,s)),c&&c.call(i,s);const f=i.delete(s);return u&&On(i,"delete",s,void 0),f},clear(){const s=ae(this),i=s.size!==0,o=s.clear();return i&&On(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=Zd(s,r,e)}),t}function ru(r,e){const t=Qd(r,e);return(n,s,i)=>s==="__v_isReactive"?!r:s==="__v_isReadonly"?r:s==="__v_raw"?n:Reflect.get(se(t,s)&&s in n?t:n,s,i)}const eg={get:ru(!1,!1)},tg={get:ru(!1,!0)},rg={get:ru(!0,!1)};const Bf=new WeakMap,Rf=new WeakMap,Lf=new WeakMap,ng=new WeakMap;function sg(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ig(r){return r.__v_skip||!Object.isExtensible(r)?0:sg(Dd(r))}function nu(r){return Ts(r)?r:su(r,!1,_d,eg,Bf)}function og(r){return su(r,!1,Xd,tg,Rf)}function Jf(r){return su(r,!0,Yd,rg,Lf)}function su(r,e,t,n,s){if(!we(r)||r.__v_raw&&!(e&&r.__v_isReactive))return r;const i=ig(r);if(i===0)return r;const o=s.get(r);if(o)return o;const c=new Proxy(r,i===2?n:t);return s.set(r,c),c}function Us(r){return Ts(r)?Us(r.__v_raw):!!(r&&r.__v_isReactive)}function Ts(r){return!!(r&&r.__v_isReadonly)}function Ct(r){return!!(r&&r.__v_isShallow)}function iu(r){return r?!!r.__v_raw:!1}function ae(r){const e=r&&r.__v_raw;return e?ae(e):r}function ag(r){return!se(r,"__v_skip")&&Object.isExtensible(r)&&za(r,"__v_skip",!0),r}const Fe=r=>we(r)?nu(r):r,To=r=>we(r)?Jf(r):r;function ze(r){return r?r.__v_isRef===!0:!1}function cg(r){return ze(r)?r.value:r}const ug={get:(r,e,t)=>e==="__v_raw"?r:cg(Reflect.get(r,e,t)),set:(r,e,t,n)=>{const s=r[e];return ze(s)&&!ze(t)?(s.value=t,!0):Reflect.set(r,e,t,n)}};function $f(r){return Us(r)?r:new Proxy(r,ug)}class lg{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Cf(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Di-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&ge!==this)return Af(this,!0),!0}get value(){const e=this.dep.track();return xf(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function fg(r,e,t=!1){let n,s;return _(r)?n=r:(n=r.get,s=r.set),new lg(n,s,t)}const to={},Ao=new WeakMap;let gs;function hg(r,e=!1,t=gs){if(t){let n=Ao.get(t);n||Ao.set(t,n=[]),n.push(r)}}function dg(r,e,t=le){const{immediate:n,deep:s,once:i,scheduler:o,augmentJob:c,call:u}=t,f=$=>s?$:Ct($)||s===!1||s===0?Bn($,1):Bn($);let h,d,p,m,T=!1,A=!1;if(ze(r)?(d=()=>r.value,T=Ct(r)):Us(r)?(d=()=>f(r),T=!0):H(r)?(A=!0,T=r.some($=>Us($)||Ct($)),d=()=>r.map($=>{if(ze($))return $.value;if(Us($))return f($);if(_($))return u?u($,2):$()})):_(r)?e?d=u?()=>u(r,2):r:d=()=>{if(p){zn();try{p()}finally{qn()}}const $=gs;gs=h;try{return u?u(r,3,[m]):r(m)}finally{gs=$}}:d=Ht,e&&s){const $=d,Y=s===!0?1/0:s;d=()=>Bn($(),Y)}const N=zd(),R=()=>{h.stop(),N&&N.active&&_c(N.effects,h)};if(i&&e){const $=e;e=(...Y)=>{$(...Y),R()}}let M=A?new Array(r.length).fill(to):to;const V=$=>{if(!(!(h.flags&1)||!h.dirty&&!$))if(e){const Y=h.run();if(s||T||(A?Y.some((j,ee)=>ws(j,M[ee])):ws(Y,M))){p&&p();const j=gs;gs=h;try{const ee=[Y,M===to?void 0:A&&M[0]===to?[]:M,m];M=Y,u?u(e,3,ee):e(...ee)}finally{gs=j}}}else h.run()};return c&&c(V),h=new Sf(d),h.scheduler=o?()=>o(V,!1):V,m=$=>hg($,!1,h),p=h.onStop=()=>{const $=Ao.get(h);if($){if(u)u($,4);else for(const Y of $)Y();Ao.delete(h)}},e?n?V(!0):M=h.run():o?o(V.bind(null,!0),!0):h.run(),R.pause=h.pause.bind(h),R.resume=h.resume.bind(h),R.stop=R,R}function Bn(r,e=1/0,t){if(e<=0||!we(r)||r.__v_skip||(t=t||new Set,t.has(r)))return r;if(t.add(r),e--,ze(r))Bn(r.value,e,t);else if(H(r))for(let n=0;n<r.length;n++)Bn(r[n],e,t);else if(df(r)||Ms(r))r.forEach(n=>{Bn(n,e,t)});else if(pf(r)){for(const n in r)Bn(r[n],e,t);for(const n of Object.getOwnPropertySymbols(r))Object.prototype.propertyIsEnumerable.call(r,n)&&Bn(r[n],e,t)}return r}/**
* @vue/runtime-core v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function ji(r,e,t,n){try{return n?r(...n):r()}catch(s){aa(s,e,t)}}function Xt(r,e,t,n){if(_(r)){const s=ji(r,e,t,n);return s&&gf(s)&&s.catch(i=>{aa(i,e,t)}),s}if(H(r)){const s=[];for(let i=0;i<r.length;i++)s.push(Xt(r[i],e,t,n));return s}}function aa(r,e,t,n=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||le;if(e){let c=e.parent;const u=e.proxy,f=`https://vuejs.org/error-reference/#runtime-${t}`;for(;c;){const h=c.ec;if(h){for(let d=0;d<h.length;d++)if(h[d](r,u,f)===!1)return}c=c.parent}if(i){zn(),ji(i,null,10,[r,u,f]),qn();return}}gg(r,t,s,n,o)}function gg(r,e,t,n=!0,s=!1){if(s)throw r;console.error(r)}const Me=[];let $t=-1;const zs=[];let Xn=null,Os=0;const Ff=Promise.resolve();let Io=null;function mg(r){const e=Io||Ff;return r?e.then(this?r.bind(this):r):e}function pg(r){let e=$t+1,t=Me.length;for(;e<t;){const n=e+t>>>1,s=Me[n],i=Bi(s);i<r||i===r&&s.flags&2?e=n+1:t=n}return e}function ou(r){if(!(r.flags&1)){const e=Bi(r),t=Me[Me.length-1];!t||!(r.flags&2)&&e>=Bi(t)?Me.push(r):Me.splice(pg(e),0,r),r.flags|=1,Mf()}}function Mf(){Io||(Io=Ff.then(zf))}function yg(r){H(r)?zs.push(...r):Xn&&r.id===-1?Xn.splice(Os+1,0,r):r.flags&1||(zs.push(r),r.flags|=1),Mf()}function Uu(r,e,t=$t+1){for(;t<Me.length;t++){const n=Me[t];if(n&&n.flags&2){if(r&&n.id!==r.uid)continue;Me.splice(t,1),t--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function Uf(r){if(zs.length){const e=[...new Set(zs)].sort((t,n)=>Bi(t)-Bi(n));if(zs.length=0,Xn){Xn.push(...e);return}for(Xn=e,Os=0;Os<Xn.length;Os++){const t=Xn[Os];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}Xn=null,Os=0}}const Bi=r=>r.id==null?r.flags&2?-1:1/0:r.id;function zf(r){try{for($t=0;$t<Me.length;$t++){const e=Me[$t];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),ji(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;$t<Me.length;$t++){const e=Me[$t];e&&(e.flags&=-2)}$t=-1,Me.length=0,Uf(),Io=null,(Me.length||zs.length)&&zf()}}let dt=null,qf=null;function ko(r){const e=dt;return dt=r,qf=r&&r.type.__scopeId||null,e}function vg(r,e=dt,t){if(!e||r._n)return r;const n=(...s)=>{n._d&&Xu(-1);const i=ko(e);let o;try{o=r(...s)}finally{ko(i),n._d&&Xu(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function zu(r,e){if(dt===null)return r;const t=fa(dt),n=r.dirs||(r.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,c,u=le]=e[s];i&&(_(i)&&(i={mounted:i,updated:i}),i.deep&&Bn(o),n.push({dir:i,instance:t,value:o,oldValue:void 0,arg:c,modifiers:u}))}return r}function fs(r,e,t,n){const s=r.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const c=s[o];i&&(c.oldValue=i[o].value);let u=c.dir[n];u&&(zn(),Xt(u,t,8,[r.el,c,r,e]),qn())}}const wg=Symbol("_vte"),bg=r=>r.__isTeleport;function au(r,e){r.shapeFlag&6&&r.component?(r.transition=e,au(r.component.subTree,e)):r.shapeFlag&128?(r.ssContent.transition=e.clone(r.ssContent),r.ssFallback.transition=e.clone(r.ssFallback)):r.transition=e}function Kf(r){r.ids=[r.ids[0]+r.ids[2]+++"-",0,0]}function Si(r,e,t,n,s=!1){if(H(r)){r.forEach((T,A)=>Si(T,e&&(H(e)?e[A]:e),t,n,s));return}if(Ti(n)&&!s){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Si(r,e,t,n.component.subTree);return}const i=n.shapeFlag&4?fa(n.component):n.el,o=s?null:i,{i:c,r:u}=r,f=e&&e.r,h=c.refs===le?c.refs={}:c.refs,d=c.setupState,p=ae(d),m=d===le?()=>!1:T=>se(p,T);if(f!=null&&f!==u&&(xe(f)?(h[f]=null,m(f)&&(d[f]=null)):ze(f)&&(f.value=null)),_(u))ji(u,c,12,[o,h]);else{const T=xe(u),A=ze(u);if(T||A){const N=()=>{if(r.f){const R=T?m(u)?d[u]:h[u]:u.value;s?H(R)&&_c(R,i):H(R)?R.includes(i)||R.push(i):T?(h[u]=[i],m(u)&&(d[u]=h[u])):(u.value=[i],r.k&&(h[r.k]=u.value))}else T?(h[u]=o,m(u)&&(d[u]=o)):A&&(u.value=o,r.k&&(h[r.k]=o))};o?(N.id=-1,Xe(N,t)):N()}}}ia().requestIdleCallback;ia().cancelIdleCallback;const Ti=r=>!!r.type.__asyncLoader,Vf=r=>r.type.__isKeepAlive;function Sg(r,e){jf(r,"a",e)}function Tg(r,e){jf(r,"da",e)}function jf(r,e,t=Ue){const n=r.__wdc||(r.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return r()});if(ca(e,n,t),t){let s=t.parent;for(;s&&s.parent;)Vf(s.parent.vnode)&&Ag(n,e,t,s),s=s.parent}}function Ag(r,e,t,n){const s=ca(e,r,n,!0);Wf(()=>{_c(n[e],s)},t)}function ca(r,e,t=Ue,n=!1){if(t){const s=t[r]||(t[r]=[]),i=e.__weh||(e.__weh=(...o)=>{zn();const c=Wi(t),u=Xt(e,t,r,o);return c(),qn(),u});return n?s.unshift(i):s.push(i),i}}const jn=r=>(e,t=Ue)=>{(!Li||r==="sp")&&ca(r,(...n)=>e(...n),t)},Ig=jn("bm"),kg=jn("m"),xg=jn("bu"),Eg=jn("u"),Cg=jn("bum"),Wf=jn("um"),Pg=jn("sp"),Ng=jn("rtg"),Dg=jn("rtc");function Og(r,e=Ue){ca("ec",r,e)}const Bg=Symbol.for("v-ndc");function qu(r,e,t,n){let s;const i=t,o=H(r);if(o||xe(r)){const c=o&&Us(r);let u=!1,f=!1;c&&(u=!Ct(r),f=Ts(r),r=oa(r)),s=new Array(r.length);for(let h=0,d=r.length;h<d;h++)s[h]=e(u?f?To(Fe(r[h])):Fe(r[h]):r[h],h,void 0,i)}else if(typeof r=="number"){s=new Array(r);for(let c=0;c<r;c++)s[c]=e(c+1,c,void 0,i)}else if(we(r))if(r[Symbol.iterator])s=Array.from(r,(c,u)=>e(c,u,void 0,i));else{const c=Object.keys(r);s=new Array(c.length);for(let u=0,f=c.length;u<f;u++){const h=c[u];s[u]=e(r[h],h,u,i)}}else s=[];return s}const Ga=r=>r?dh(r)?fa(r):Ga(r.parent):null,Ai=qe(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>Ga(r.parent),$root:r=>Ga(r.root),$host:r=>r.ce,$emit:r=>r.emit,$options:r=>Gf(r),$forceUpdate:r=>r.f||(r.f=()=>{ou(r.update)}),$nextTick:r=>r.n||(r.n=mg.bind(r.proxy)),$watch:r=>tm.bind(r)}),Ea=(r,e)=>r!==le&&!r.__isScriptSetup&&se(r,e),Rg={get({_:r},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:n,data:s,props:i,accessCache:o,type:c,appContext:u}=r;let f;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return n[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(Ea(n,e))return o[e]=1,n[e];if(s!==le&&se(s,e))return o[e]=2,s[e];if((f=r.propsOptions[0])&&se(f,e))return o[e]=3,i[e];if(t!==le&&se(t,e))return o[e]=4,t[e];_a&&(o[e]=0)}}const h=Ai[e];let d,p;if(h)return e==="$attrs"&&De(r.attrs,"get",""),h(r);if((d=c.__cssModules)&&(d=d[e]))return d;if(t!==le&&se(t,e))return o[e]=4,t[e];if(p=u.config.globalProperties,se(p,e))return p[e]},set({_:r},e,t){const{data:n,setupState:s,ctx:i}=r;return Ea(s,e)?(s[e]=t,!0):n!==le&&se(n,e)?(n[e]=t,!0):se(r.props,e)||e[0]==="$"&&e.slice(1)in r?!1:(i[e]=t,!0)},has({_:{data:r,setupState:e,accessCache:t,ctx:n,appContext:s,propsOptions:i}},o){let c;return!!t[o]||r!==le&&se(r,o)||Ea(e,o)||(c=i[0])&&se(c,o)||se(n,o)||se(Ai,o)||se(s.config.globalProperties,o)},defineProperty(r,e,t){return t.get!=null?r._.accessCache[e]=0:se(t,"value")&&this.set(r,e,t.value,null),Reflect.defineProperty(r,e,t)}};function Ku(r){return H(r)?r.reduce((e,t)=>(e[t]=null,e),{}):r}let _a=!0;function Lg(r){const e=Gf(r),t=r.proxy,n=r.ctx;_a=!1,e.beforeCreate&&Vu(e.beforeCreate,r,"bc");const{data:s,computed:i,methods:o,watch:c,provide:u,inject:f,created:h,beforeMount:d,mounted:p,beforeUpdate:m,updated:T,activated:A,deactivated:N,beforeDestroy:R,beforeUnmount:M,destroyed:V,unmounted:$,render:Y,renderTracked:j,renderTriggered:ee,errorCaptured:oe,serverPrefetch:ue,expose:Ie,inheritAttrs:Dt,components:tr,directives:rr,filters:ba}=e;if(f&&Jg(f,n,null),o)for(const ye in o){const he=o[ye];_(he)&&(n[ye]=he.bind(t))}if(s){const ye=s.call(t,t);we(ye)&&(r.data=nu(ye))}if(_a=!0,i)for(const ye in i){const he=i[ye],us=_(he)?he.bind(t,t):_(he.get)?he.get.bind(t,t):Ht,Xi=!_(he)&&_(he.set)?he.set.bind(t):Ht,ls=Am({get:us,set:Xi});Object.defineProperty(n,ye,{enumerable:!0,configurable:!0,get:()=>ls.value,set:Ot=>ls.value=Ot})}if(c)for(const ye in c)Hf(c[ye],n,t,ye);if(u){const ye=_(u)?u.call(t):u;Reflect.ownKeys(ye).forEach(he=>{qg(he,ye[he])})}h&&Vu(h,r,"c");function Le(ye,he){H(he)?he.forEach(us=>ye(us.bind(t))):he&&ye(he.bind(t))}if(Le(Ig,d),Le(kg,p),Le(xg,m),Le(Eg,T),Le(Sg,A),Le(Tg,N),Le(Og,oe),Le(Dg,j),Le(Ng,ee),Le(Cg,M),Le(Wf,$),Le(Pg,ue),H(Ie))if(Ie.length){const ye=r.exposed||(r.exposed={});Ie.forEach(he=>{Object.defineProperty(ye,he,{get:()=>t[he],set:us=>t[he]=us,enumerable:!0})})}else r.exposed||(r.exposed={});Y&&r.render===Ht&&(r.render=Y),Dt!=null&&(r.inheritAttrs=Dt),tr&&(r.components=tr),rr&&(r.directives=rr),ue&&Kf(r)}function Jg(r,e,t=Ht){H(r)&&(r=Ya(r));for(const n in r){const s=r[n];let i;we(s)?"default"in s?i=fo(s.from||n,s.default,!0):i=fo(s.from||n):i=fo(s),ze(i)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[n]=i}}function Vu(r,e,t){Xt(H(r)?r.map(n=>n.bind(e.proxy)):r.bind(e.proxy),e,t)}function Hf(r,e,t,n){let s=n.includes(".")?ah(t,n):()=>t[n];if(xe(r)){const i=e[r];_(i)&&Pa(s,i)}else if(_(r))Pa(s,r.bind(t));else if(we(r))if(H(r))r.forEach(i=>Hf(i,e,t,n));else{const i=_(r.handler)?r.handler.bind(t):e[r.handler];_(i)&&Pa(s,i,r)}}function Gf(r){const e=r.type,{mixins:t,extends:n}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=r.appContext,c=i.get(e);let u;return c?u=c:!s.length&&!t&&!n?u=e:(u={},s.length&&s.forEach(f=>xo(u,f,o,!0)),xo(u,e,o)),we(e)&&i.set(e,u),u}function xo(r,e,t,n=!1){const{mixins:s,extends:i}=e;i&&xo(r,i,t,!0),s&&s.forEach(o=>xo(r,o,t,!0));for(const o in e)if(!(n&&o==="expose")){const c=$g[o]||t&&t[o];r[o]=c?c(r[o],e[o]):e[o]}return r}const $g={data:ju,props:Wu,emits:Wu,methods:gi,computed:gi,beforeCreate:Je,created:Je,beforeMount:Je,mounted:Je,beforeUpdate:Je,updated:Je,beforeDestroy:Je,beforeUnmount:Je,destroyed:Je,unmounted:Je,activated:Je,deactivated:Je,errorCaptured:Je,serverPrefetch:Je,components:gi,directives:gi,watch:Mg,provide:ju,inject:Fg};function ju(r,e){return e?r?function(){return qe(_(r)?r.call(this,this):r,_(e)?e.call(this,this):e)}:e:r}function Fg(r,e){return gi(Ya(r),Ya(e))}function Ya(r){if(H(r)){const e={};for(let t=0;t<r.length;t++)e[r[t]]=r[t];return e}return r}function Je(r,e){return r?[...new Set([].concat(r,e))]:e}function gi(r,e){return r?qe(Object.create(null),r,e):e}function Wu(r,e){return r?H(r)&&H(e)?[...new Set([...r,...e])]:qe(Object.create(null),Ku(r),Ku(e??{})):e}function Mg(r,e){if(!r)return e;if(!e)return r;const t=qe(Object.create(null),r);for(const n in e)t[n]=Je(r[n],e[n]);return t}function _f(){return{app:null,config:{isNativeTag:Pd,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ug=0;function zg(r,e){return function(n,s=null){_(n)||(n=qe({},n)),s!=null&&!we(s)&&(s=null);const i=_f(),o=new WeakSet,c=[];let u=!1;const f=i.app={_uid:Ug++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:Im,get config(){return i.config},set config(h){},use(h,...d){return o.has(h)||(h&&_(h.install)?(o.add(h),h.install(f,...d)):_(h)&&(o.add(h),h(f,...d))),f},mixin(h){return i.mixins.includes(h)||i.mixins.push(h),f},component(h,d){return d?(i.components[h]=d,f):i.components[h]},directive(h,d){return d?(i.directives[h]=d,f):i.directives[h]},mount(h,d,p){if(!u){const m=f._ceVNode||Ss(n,s);return m.appContext=i,p===!0?p="svg":p===!1&&(p=void 0),r(m,h,p),u=!0,f._container=h,h.__vue_app__=f,fa(m.component)}},onUnmount(h){c.push(h)},unmount(){u&&(Xt(c,f._instance,16),r(null,f._container),delete f._container.__vue_app__)},provide(h,d){return i.provides[h]=d,f},runWithContext(h){const d=qs;qs=f;try{return h()}finally{qs=d}}};return f}}let qs=null;function qg(r,e){if(Ue){let t=Ue.provides;const n=Ue.parent&&Ue.parent.provides;n===t&&(t=Ue.provides=Object.create(n)),t[r]=e}}function fo(r,e,t=!1){const n=ym();if(n||qs){let s=qs?qs._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&r in s)return s[r];if(arguments.length>1)return t&&_(e)?e.call(n&&n.proxy):e}}const Yf={},Xf=()=>Object.create(Yf),Zf=r=>Object.getPrototypeOf(r)===Yf;function Kg(r,e,t,n=!1){const s={},i=Xf();r.propsDefaults=Object.create(null),Qf(r,e,s,i);for(const o in r.propsOptions[0])o in s||(s[o]=void 0);t?r.props=n?s:og(s):r.type.props?r.props=s:r.props=i,r.attrs=i}function Vg(r,e,t,n){const{props:s,attrs:i,vnode:{patchFlag:o}}=r,c=ae(s),[u]=r.propsOptions;let f=!1;if((n||o>0)&&!(o&16)){if(o&8){const h=r.vnode.dynamicProps;for(let d=0;d<h.length;d++){let p=h[d];if(ua(r.emitsOptions,p))continue;const m=e[p];if(u)if(se(i,p))m!==i[p]&&(i[p]=m,f=!0);else{const T=ss(p);s[T]=Xa(u,c,T,m,r,!1)}else m!==i[p]&&(i[p]=m,f=!0)}}}else{Qf(r,e,s,i)&&(f=!0);let h;for(const d in c)(!e||!se(e,d)&&((h=as(d))===d||!se(e,h)))&&(u?t&&(t[d]!==void 0||t[h]!==void 0)&&(s[d]=Xa(u,c,d,void 0,r,!0)):delete s[d]);if(i!==c)for(const d in i)(!e||!se(e,d))&&(delete i[d],f=!0)}f&&On(r.attrs,"set","")}function Qf(r,e,t,n){const[s,i]=r.propsOptions;let o=!1,c;if(e)for(let u in e){if(vi(u))continue;const f=e[u];let h;s&&se(s,h=ss(u))?!i||!i.includes(h)?t[h]=f:(c||(c={}))[h]=f:ua(r.emitsOptions,u)||(!(u in n)||f!==n[u])&&(n[u]=f,o=!0)}if(i){const u=ae(t),f=c||le;for(let h=0;h<i.length;h++){const d=i[h];t[d]=Xa(s,u,d,f[d],r,!se(f,d))}}return o}function Xa(r,e,t,n,s,i){const o=r[t];if(o!=null){const c=se(o,"default");if(c&&n===void 0){const u=o.default;if(o.type!==Function&&!o.skipFactory&&_(u)){const{propsDefaults:f}=s;if(t in f)n=f[t];else{const h=Wi(s);n=f[t]=u.call(null,e),h()}}else n=u;s.ce&&s.ce._setProp(t,n)}o[0]&&(i&&!c?n=!1:o[1]&&(n===""||n===as(t))&&(n=!0))}return n}const jg=new WeakMap;function eh(r,e,t=!1){const n=t?jg:e.propsCache,s=n.get(r);if(s)return s;const i=r.props,o={},c=[];let u=!1;if(!_(r)){const h=d=>{u=!0;const[p,m]=eh(d,e,!0);qe(o,p),m&&c.push(...m)};!t&&e.mixins.length&&e.mixins.forEach(h),r.extends&&h(r.extends),r.mixins&&r.mixins.forEach(h)}if(!i&&!u)return we(r)&&n.set(r,Fs),Fs;if(H(i))for(let h=0;h<i.length;h++){const d=ss(i[h]);Hu(d)&&(o[d]=le)}else if(i)for(const h in i){const d=ss(h);if(Hu(d)){const p=i[h],m=o[d]=H(p)||_(p)?{type:p}:qe({},p),T=m.type;let A=!1,N=!0;if(H(T))for(let R=0;R<T.length;++R){const M=T[R],V=_(M)&&M.name;if(V==="Boolean"){A=!0;break}else V==="String"&&(N=!1)}else A=_(T)&&T.name==="Boolean";m[0]=A,m[1]=N,(A||se(m,"default"))&&c.push(d)}}const f=[o,c];return we(r)&&n.set(r,f),f}function Hu(r){return r[0]!=="$"&&!vi(r)}const cu=r=>r==="_"||r==="__"||r==="_ctx"||r==="$stable",uu=r=>H(r)?r.map(Ut):[Ut(r)],Wg=(r,e,t)=>{if(e._n)return e;const n=vg((...s)=>uu(e(...s)),t);return n._c=!1,n},th=(r,e,t)=>{const n=r._ctx;for(const s in r){if(cu(s))continue;const i=r[s];if(_(i))e[s]=Wg(s,i,n);else if(i!=null){const o=uu(i);e[s]=()=>o}}},rh=(r,e)=>{const t=uu(e);r.slots.default=()=>t},nh=(r,e,t)=>{for(const n in e)(t||!cu(n))&&(r[n]=e[n])},Hg=(r,e,t)=>{const n=r.slots=Xf();if(r.vnode.shapeFlag&32){const s=e.__;s&&za(n,"__",s,!0);const i=e._;i?(nh(n,e,t),t&&za(n,"_",i,!0)):th(e,n)}else e&&rh(r,e)},Gg=(r,e,t)=>{const{vnode:n,slots:s}=r;let i=!0,o=le;if(n.shapeFlag&32){const c=e._;c?t&&c===1?i=!1:nh(s,e,t):(i=!e.$stable,th(e,s)),o=e}else e&&(rh(r,e),o={default:1});if(i)for(const c in s)!cu(c)&&o[c]==null&&delete s[c]},Xe=cm;function _g(r){return Yg(r)}function Yg(r,e){const t=ia();t.__VUE__=!0;const{insert:n,remove:s,patchProp:i,createElement:o,createText:c,createComment:u,setText:f,setElementText:h,parentNode:d,nextSibling:p,setScopeId:m=Ht,insertStaticContent:T}=r,A=(g,v,S,C=null,k=null,x=null,L=void 0,O=null,D=!!v.dynamicChildren)=>{if(g===v)return;g&&!li(g,v)&&(C=Zi(g),Ot(g,k,x,!0),g=null),v.patchFlag===-2&&(D=!1,v.dynamicChildren=null);const{type:P,ref:K,shapeFlag:J}=v;switch(P){case la:N(g,v,S,C);break;case js:R(g,v,S,C);break;case Na:g==null&&M(v,S,C,L);break;case nt:tr(g,v,S,C,k,x,L,O,D);break;default:J&1?Y(g,v,S,C,k,x,L,O,D):J&6?rr(g,v,S,C,k,x,L,O,D):(J&64||J&128)&&P.process(g,v,S,C,k,x,L,O,D,ai)}K!=null&&k?Si(K,g&&g.ref,x,v||g,!v):K==null&&g&&g.ref!=null&&Si(g.ref,null,x,g,!0)},N=(g,v,S,C)=>{if(g==null)n(v.el=c(v.children),S,C);else{const k=v.el=g.el;v.children!==g.children&&f(k,v.children)}},R=(g,v,S,C)=>{g==null?n(v.el=u(v.children||""),S,C):v.el=g.el},M=(g,v,S,C)=>{[g.el,g.anchor]=T(g.children,v,S,C,g.el,g.anchor)},V=({el:g,anchor:v},S,C)=>{let k;for(;g&&g!==v;)k=p(g),n(g,S,C),g=k;n(v,S,C)},$=({el:g,anchor:v})=>{let S;for(;g&&g!==v;)S=p(g),s(g),g=S;s(v)},Y=(g,v,S,C,k,x,L,O,D)=>{v.type==="svg"?L="svg":v.type==="math"&&(L="mathml"),g==null?j(v,S,C,k,x,L,O,D):ue(g,v,k,x,L,O,D)},j=(g,v,S,C,k,x,L,O)=>{let D,P;const{props:K,shapeFlag:J,transition:q,dirs:W}=g;if(D=g.el=o(g.type,x,K&&K.is,K),J&8?h(D,g.children):J&16&&oe(g.children,D,null,C,k,Ca(g,x),L,O),W&&fs(g,null,C,"created"),ee(D,g,g.scopeId,L,C),K){for(const de in K)de!=="value"&&!vi(de)&&i(D,de,null,K[de],x,C);"value"in K&&i(D,"value",null,K.value,x),(P=K.onVnodeBeforeMount)&&Jt(P,C,g)}W&&fs(g,null,C,"beforeMount");const te=Xg(k,q);te&&q.beforeEnter(D),n(D,v,S),((P=K&&K.onVnodeMounted)||te||W)&&Xe(()=>{P&&Jt(P,C,g),te&&q.enter(D),W&&fs(g,null,C,"mounted")},k)},ee=(g,v,S,C,k)=>{if(S&&m(g,S),C)for(let x=0;x<C.length;x++)m(g,C[x]);if(k){let x=k.subTree;if(v===x||uh(x.type)&&(x.ssContent===v||x.ssFallback===v)){const L=k.vnode;ee(g,L,L.scopeId,L.slotScopeIds,k.parent)}}},oe=(g,v,S,C,k,x,L,O,D=0)=>{for(let P=D;P<g.length;P++){const K=g[P]=O?Zn(g[P]):Ut(g[P]);A(null,K,v,S,C,k,x,L,O)}},ue=(g,v,S,C,k,x,L)=>{const O=v.el=g.el;let{patchFlag:D,dynamicChildren:P,dirs:K}=v;D|=g.patchFlag&16;const J=g.props||le,q=v.props||le;let W;if(S&&hs(S,!1),(W=q.onVnodeBeforeUpdate)&&Jt(W,S,v,g),K&&fs(v,g,S,"beforeUpdate"),S&&hs(S,!0),(J.innerHTML&&q.innerHTML==null||J.textContent&&q.textContent==null)&&h(O,""),P?Ie(g.dynamicChildren,P,O,S,C,Ca(v,k),x):L||he(g,v,O,null,S,C,Ca(v,k),x,!1),D>0){if(D&16)Dt(O,J,q,S,k);else if(D&2&&J.class!==q.class&&i(O,"class",null,q.class,k),D&4&&i(O,"style",J.style,q.style,k),D&8){const te=v.dynamicProps;for(let de=0;de<te.length;de++){const ie=te[de],Ke=J[ie],Ve=q[ie];(Ve!==Ke||ie==="value")&&i(O,ie,Ke,Ve,k,S)}}D&1&&g.children!==v.children&&h(O,v.children)}else!L&&P==null&&Dt(O,J,q,S,k);((W=q.onVnodeUpdated)||K)&&Xe(()=>{W&&Jt(W,S,v,g),K&&fs(v,g,S,"updated")},C)},Ie=(g,v,S,C,k,x,L)=>{for(let O=0;O<v.length;O++){const D=g[O],P=v[O],K=D.el&&(D.type===nt||!li(D,P)||D.shapeFlag&198)?d(D.el):S;A(D,P,K,null,C,k,x,L,!0)}},Dt=(g,v,S,C,k)=>{if(v!==S){if(v!==le)for(const x in v)!vi(x)&&!(x in S)&&i(g,x,v[x],null,k,C);for(const x in S){if(vi(x))continue;const L=S[x],O=v[x];L!==O&&x!=="value"&&i(g,x,O,L,k,C)}"value"in S&&i(g,"value",v.value,S.value,k)}},tr=(g,v,S,C,k,x,L,O,D)=>{const P=v.el=g?g.el:c(""),K=v.anchor=g?g.anchor:c("");let{patchFlag:J,dynamicChildren:q,slotScopeIds:W}=v;W&&(O=O?O.concat(W):W),g==null?(n(P,S,C),n(K,S,C),oe(v.children||[],S,K,k,x,L,O,D)):J>0&&J&64&&q&&g.dynamicChildren?(Ie(g.dynamicChildren,q,S,k,x,L,O),(v.key!=null||k&&v===k.subTree)&&sh(g,v,!0)):he(g,v,S,K,k,x,L,O,D)},rr=(g,v,S,C,k,x,L,O,D)=>{v.slotScopeIds=O,g==null?v.shapeFlag&512?k.ctx.activate(v,S,C,L,D):ba(v,S,C,k,x,L,D):Du(g,v,D)},ba=(g,v,S,C,k,x,L)=>{const O=g.component=pm(g,C,k);if(Vf(g)&&(O.ctx.renderer=ai),vm(O,!1,L),O.asyncDep){if(k&&k.registerDep(O,Le,L),!g.el){const D=O.subTree=Ss(js);R(null,D,v,S),g.placeholder=D.el}}else Le(O,g,v,S,k,x,L)},Du=(g,v,S)=>{const C=v.component=g.component;if(om(g,v,S))if(C.asyncDep&&!C.asyncResolved){ye(C,v,S);return}else C.next=v,C.update();else v.el=g.el,C.vnode=v},Le=(g,v,S,C,k,x,L)=>{const O=()=>{if(g.isMounted){let{next:J,bu:q,u:W,parent:te,vnode:de}=g;{const Rt=ih(g);if(Rt){J&&(J.el=de.el,ye(g,J,L)),Rt.asyncDep.then(()=>{g.isUnmounted||O()});return}}let ie=J,Ke;hs(g,!1),J?(J.el=de.el,ye(g,J,L)):J=de,q&&lo(q),(Ke=J.props&&J.props.onVnodeBeforeUpdate)&&Jt(Ke,te,J,de),hs(g,!0);const Ve=_u(g),Bt=g.subTree;g.subTree=Ve,A(Bt,Ve,d(Bt.el),Zi(Bt),g,k,x),J.el=Ve.el,ie===null&&am(g,Ve.el),W&&Xe(W,k),(Ke=J.props&&J.props.onVnodeUpdated)&&Xe(()=>Jt(Ke,te,J,de),k)}else{let J;const{el:q,props:W}=v,{bm:te,m:de,parent:ie,root:Ke,type:Ve}=g,Bt=Ti(v);hs(g,!1),te&&lo(te),!Bt&&(J=W&&W.onVnodeBeforeMount)&&Jt(J,ie,v),hs(g,!0);{Ke.ce&&Ke.ce._def.shadowRoot!==!1&&Ke.ce._injectChildStyle(Ve);const Rt=g.subTree=_u(g);A(null,Rt,S,C,g,k,x),v.el=Rt.el}if(de&&Xe(de,k),!Bt&&(J=W&&W.onVnodeMounted)){const Rt=v;Xe(()=>Jt(J,ie,Rt),k)}(v.shapeFlag&256||ie&&Ti(ie.vnode)&&ie.vnode.shapeFlag&256)&&g.a&&Xe(g.a,k),g.isMounted=!0,v=S=C=null}};g.scope.on();const D=g.effect=new Sf(O);g.scope.off();const P=g.update=D.run.bind(D),K=g.job=D.runIfDirty.bind(D);K.i=g,K.id=g.uid,D.scheduler=()=>ou(K),hs(g,!0),P()},ye=(g,v,S)=>{v.component=g;const C=g.vnode.props;g.vnode=v,g.next=null,Vg(g,v.props,C,S),Gg(g,v.children,S),zn(),Uu(g),qn()},he=(g,v,S,C,k,x,L,O,D=!1)=>{const P=g&&g.children,K=g?g.shapeFlag:0,J=v.children,{patchFlag:q,shapeFlag:W}=v;if(q>0){if(q&128){Xi(P,J,S,C,k,x,L,O,D);return}else if(q&256){us(P,J,S,C,k,x,L,O,D);return}}W&8?(K&16&&oi(P,k,x),J!==P&&h(S,J)):K&16?W&16?Xi(P,J,S,C,k,x,L,O,D):oi(P,k,x,!0):(K&8&&h(S,""),W&16&&oe(J,S,C,k,x,L,O,D))},us=(g,v,S,C,k,x,L,O,D)=>{g=g||Fs,v=v||Fs;const P=g.length,K=v.length,J=Math.min(P,K);let q;for(q=0;q<J;q++){const W=v[q]=D?Zn(v[q]):Ut(v[q]);A(g[q],W,S,null,k,x,L,O,D)}P>K?oi(g,k,x,!0,!1,J):oe(v,S,C,k,x,L,O,D,J)},Xi=(g,v,S,C,k,x,L,O,D)=>{let P=0;const K=v.length;let J=g.length-1,q=K-1;for(;P<=J&&P<=q;){const W=g[P],te=v[P]=D?Zn(v[P]):Ut(v[P]);if(li(W,te))A(W,te,S,null,k,x,L,O,D);else break;P++}for(;P<=J&&P<=q;){const W=g[J],te=v[q]=D?Zn(v[q]):Ut(v[q]);if(li(W,te))A(W,te,S,null,k,x,L,O,D);else break;J--,q--}if(P>J){if(P<=q){const W=q+1,te=W<K?v[W].el:C;for(;P<=q;)A(null,v[P]=D?Zn(v[P]):Ut(v[P]),S,te,k,x,L,O,D),P++}}else if(P>q)for(;P<=J;)Ot(g[P],k,x,!0),P++;else{const W=P,te=P,de=new Map;for(P=te;P<=q;P++){const Ye=v[P]=D?Zn(v[P]):Ut(v[P]);Ye.key!=null&&de.set(Ye.key,P)}let ie,Ke=0;const Ve=q-te+1;let Bt=!1,Rt=0;const ci=new Array(Ve);for(P=0;P<Ve;P++)ci[P]=0;for(P=W;P<=J;P++){const Ye=g[P];if(Ke>=Ve){Ot(Ye,k,x,!0);continue}let Lt;if(Ye.key!=null)Lt=de.get(Ye.key);else for(ie=te;ie<=q;ie++)if(ci[ie-te]===0&&li(Ye,v[ie])){Lt=ie;break}Lt===void 0?Ot(Ye,k,x,!0):(ci[Lt-te]=P+1,Lt>=Rt?Rt=Lt:Bt=!0,A(Ye,v[Lt],S,null,k,x,L,O,D),Ke++)}const Ru=Bt?Zg(ci):Fs;for(ie=Ru.length-1,P=Ve-1;P>=0;P--){const Ye=te+P,Lt=v[Ye],Lu=v[Ye+1],Ju=Ye+1<K?Lu.el||Lu.placeholder:C;ci[P]===0?A(null,Lt,S,Ju,k,x,L,O,D):Bt&&(ie<0||P!==Ru[ie]?ls(Lt,S,Ju,2):ie--)}}},ls=(g,v,S,C,k=null)=>{const{el:x,type:L,transition:O,children:D,shapeFlag:P}=g;if(P&6){ls(g.component.subTree,v,S,C);return}if(P&128){g.suspense.move(v,S,C);return}if(P&64){L.move(g,v,S,ai);return}if(L===nt){n(x,v,S);for(let J=0;J<D.length;J++)ls(D[J],v,S,C);n(g.anchor,v,S);return}if(L===Na){V(g,v,S);return}if(C!==2&&P&1&&O)if(C===0)O.beforeEnter(x),n(x,v,S),Xe(()=>O.enter(x),k);else{const{leave:J,delayLeave:q,afterLeave:W}=O,te=()=>{g.ctx.isUnmounted?s(x):n(x,v,S)},de=()=>{J(x,()=>{te(),W&&W()})};q?q(x,te,de):de()}else n(x,v,S)},Ot=(g,v,S,C=!1,k=!1)=>{const{type:x,props:L,ref:O,children:D,dynamicChildren:P,shapeFlag:K,patchFlag:J,dirs:q,cacheIndex:W}=g;if(J===-2&&(k=!1),O!=null&&(zn(),Si(O,null,S,g,!0),qn()),W!=null&&(v.renderCache[W]=void 0),K&256){v.ctx.deactivate(g);return}const te=K&1&&q,de=!Ti(g);let ie;if(de&&(ie=L&&L.onVnodeBeforeUnmount)&&Jt(ie,v,g),K&6)xd(g.component,S,C);else{if(K&128){g.suspense.unmount(S,C);return}te&&fs(g,null,v,"beforeUnmount"),K&64?g.type.remove(g,v,S,ai,C):P&&!P.hasOnce&&(x!==nt||J>0&&J&64)?oi(P,v,S,!1,!0):(x===nt&&J&384||!k&&K&16)&&oi(D,v,S),C&&Ou(g)}(de&&(ie=L&&L.onVnodeUnmounted)||te)&&Xe(()=>{ie&&Jt(ie,v,g),te&&fs(g,null,v,"unmounted")},S)},Ou=g=>{const{type:v,el:S,anchor:C,transition:k}=g;if(v===nt){kd(S,C);return}if(v===Na){$(g);return}const x=()=>{s(S),k&&!k.persisted&&k.afterLeave&&k.afterLeave()};if(g.shapeFlag&1&&k&&!k.persisted){const{leave:L,delayLeave:O}=k,D=()=>L(S,x);O?O(g.el,x,D):D()}else x()},kd=(g,v)=>{let S;for(;g!==v;)S=p(g),s(g),g=S;s(v)},xd=(g,v,S)=>{const{bum:C,scope:k,job:x,subTree:L,um:O,m:D,a:P,parent:K,slots:{__:J}}=g;Gu(D),Gu(P),C&&lo(C),K&&H(J)&&J.forEach(q=>{K.renderCache[q]=void 0}),k.stop(),x&&(x.flags|=8,Ot(L,g,v,S)),O&&Xe(O,v),Xe(()=>{g.isUnmounted=!0},v),v&&v.pendingBranch&&!v.isUnmounted&&g.asyncDep&&!g.asyncResolved&&g.suspenseId===v.pendingId&&(v.deps--,v.deps===0&&v.resolve())},oi=(g,v,S,C=!1,k=!1,x=0)=>{for(let L=x;L<g.length;L++)Ot(g[L],v,S,C,k)},Zi=g=>{if(g.shapeFlag&6)return Zi(g.component.subTree);if(g.shapeFlag&128)return g.suspense.next();const v=p(g.anchor||g.el),S=v&&v[wg];return S?p(S):v};let Sa=!1;const Bu=(g,v,S)=>{g==null?v._vnode&&Ot(v._vnode,null,null,!0):A(v._vnode||null,g,v,null,null,null,S),v._vnode=g,Sa||(Sa=!0,Uu(),Uf(),Sa=!1)},ai={p:A,um:Ot,m:ls,r:Ou,mt:ba,mc:oe,pc:he,pbc:Ie,n:Zi,o:r};return{render:Bu,hydrate:void 0,createApp:zg(Bu)}}function Ca({type:r,props:e},t){return t==="svg"&&r==="foreignObject"||t==="mathml"&&r==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function hs({effect:r,job:e},t){t?(r.flags|=32,e.flags|=4):(r.flags&=-33,e.flags&=-5)}function Xg(r,e){return(!r||r&&!r.pendingBranch)&&e&&!e.persisted}function sh(r,e,t=!1){const n=r.children,s=e.children;if(H(n)&&H(s))for(let i=0;i<n.length;i++){const o=n[i];let c=s[i];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=s[i]=Zn(s[i]),c.el=o.el),!t&&c.patchFlag!==-2&&sh(o,c)),c.type===la&&(c.el=o.el),c.type===js&&!c.el&&(c.el=o.el)}}function Zg(r){const e=r.slice(),t=[0];let n,s,i,o,c;const u=r.length;for(n=0;n<u;n++){const f=r[n];if(f!==0){if(s=t[t.length-1],r[s]<f){e[n]=s,t.push(n);continue}for(i=0,o=t.length-1;i<o;)c=i+o>>1,r[t[c]]<f?i=c+1:o=c;f<r[t[i]]&&(i>0&&(e[n]=t[i-1]),t[i]=n)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function ih(r){const e=r.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:ih(e)}function Gu(r){if(r)for(let e=0;e<r.length;e++)r[e].flags|=8}const Qg=Symbol.for("v-scx"),em=()=>fo(Qg);function Pa(r,e,t){return oh(r,e,t)}function oh(r,e,t=le){const{immediate:n,deep:s,flush:i,once:o}=t,c=qe({},t),u=e&&n||!e&&i!=="post";let f;if(Li){if(i==="sync"){const m=em();f=m.__watcherHandles||(m.__watcherHandles=[])}else if(!u){const m=()=>{};return m.stop=Ht,m.resume=Ht,m.pause=Ht,m}}const h=Ue;c.call=(m,T,A)=>Xt(m,h,T,A);let d=!1;i==="post"?c.scheduler=m=>{Xe(m,h&&h.suspense)}:i!=="sync"&&(d=!0,c.scheduler=(m,T)=>{T?m():ou(m)}),c.augmentJob=m=>{e&&(m.flags|=4),d&&(m.flags|=2,h&&(m.id=h.uid,m.i=h))};const p=dg(r,e,c);return Li&&(f?f.push(p):u&&p()),p}function tm(r,e,t){const n=this.proxy,s=xe(r)?r.includes(".")?ah(n,r):()=>n[r]:r.bind(n,n);let i;_(e)?i=e:(i=e.handler,t=e);const o=Wi(this),c=oh(s,i.bind(n),t);return o(),c}function ah(r,e){const t=e.split(".");return()=>{let n=r;for(let s=0;s<t.length&&n;s++)n=n[t[s]];return n}}const rm=(r,e)=>e==="modelValue"||e==="model-value"?r.modelModifiers:r[`${e}Modifiers`]||r[`${ss(e)}Modifiers`]||r[`${as(e)}Modifiers`];function nm(r,e,...t){if(r.isUnmounted)return;const n=r.vnode.props||le;let s=t;const i=e.startsWith("update:"),o=i&&rm(n,e.slice(7));o&&(o.trim&&(s=t.map(h=>xe(h)?h.trim():h)),o.number&&(s=t.map(qa)));let c,u=n[c=Ta(e)]||n[c=Ta(ss(e))];!u&&i&&(u=n[c=Ta(as(e))]),u&&Xt(u,r,6,s);const f=n[c+"Once"];if(f){if(!r.emitted)r.emitted={};else if(r.emitted[c])return;r.emitted[c]=!0,Xt(f,r,6,s)}}function ch(r,e,t=!1){const n=e.emitsCache,s=n.get(r);if(s!==void 0)return s;const i=r.emits;let o={},c=!1;if(!_(r)){const u=f=>{const h=ch(f,e,!0);h&&(c=!0,qe(o,h))};!t&&e.mixins.length&&e.mixins.forEach(u),r.extends&&u(r.extends),r.mixins&&r.mixins.forEach(u)}return!i&&!c?(we(r)&&n.set(r,null),null):(H(i)?i.forEach(u=>o[u]=null):qe(o,i),we(r)&&n.set(r,o),o)}function ua(r,e){return!r||!ra(e)?!1:(e=e.slice(2).replace(/Once$/,""),se(r,e[0].toLowerCase()+e.slice(1))||se(r,as(e))||se(r,e))}function _u(r){const{type:e,vnode:t,proxy:n,withProxy:s,propsOptions:[i],slots:o,attrs:c,emit:u,render:f,renderCache:h,props:d,data:p,setupState:m,ctx:T,inheritAttrs:A}=r,N=ko(r);let R,M;try{if(t.shapeFlag&4){const $=s||n,Y=$;R=Ut(f.call(Y,$,h,d,m,p,T)),M=c}else{const $=e;R=Ut($.length>1?$(d,{attrs:c,slots:o,emit:u}):$(d,null)),M=e.props?c:sm(c)}}catch($){Ii.length=0,aa($,r,1),R=Ss(js)}let V=R;if(M&&A!==!1){const $=Object.keys(M),{shapeFlag:Y}=V;$.length&&Y&7&&(i&&$.some(Gc)&&(M=im(M,i)),V=Ws(V,M,!1,!0))}return t.dirs&&(V=Ws(V,null,!1,!0),V.dirs=V.dirs?V.dirs.concat(t.dirs):t.dirs),t.transition&&au(V,t.transition),R=V,ko(N),R}const sm=r=>{let e;for(const t in r)(t==="class"||t==="style"||ra(t))&&((e||(e={}))[t]=r[t]);return e},im=(r,e)=>{const t={};for(const n in r)(!Gc(n)||!(n.slice(9)in e))&&(t[n]=r[n]);return t};function om(r,e,t){const{props:n,children:s,component:i}=r,{props:o,children:c,patchFlag:u}=e,f=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&u>=0){if(u&1024)return!0;if(u&16)return n?Yu(n,o,f):!!o;if(u&8){const h=e.dynamicProps;for(let d=0;d<h.length;d++){const p=h[d];if(o[p]!==n[p]&&!ua(f,p))return!0}}}else return(s||c)&&(!c||!c.$stable)?!0:n===o?!1:n?o?Yu(n,o,f):!0:!!o;return!1}function Yu(r,e,t){const n=Object.keys(e);if(n.length!==Object.keys(r).length)return!0;for(let s=0;s<n.length;s++){const i=n[s];if(e[i]!==r[i]&&!ua(t,i))return!0}return!1}function am({vnode:r,parent:e},t){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===r&&(n.el=r.el),n===r)(r=e.vnode).el=t,e=e.parent;else break}}const uh=r=>r.__isSuspense;function cm(r,e){e&&e.pendingBranch?H(r)?e.effects.push(...r):e.effects.push(r):yg(r)}const nt=Symbol.for("v-fgt"),la=Symbol.for("v-txt"),js=Symbol.for("v-cmt"),Na=Symbol.for("v-stc"),Ii=[];let Ze=null;function sr(r=!1){Ii.push(Ze=r?null:[])}function um(){Ii.pop(),Ze=Ii[Ii.length-1]||null}let Ri=1;function Xu(r,e=!1){Ri+=r,r<0&&Ze&&e&&(Ze.hasOnce=!0)}function lm(r){return r.dynamicChildren=Ri>0?Ze||Fs:null,um(),Ri>0&&Ze&&Ze.push(r),r}function ir(r,e,t,n,s,i){return lm($e(r,e,t,n,s,i,!0))}function lh(r){return r?r.__v_isVNode===!0:!1}function li(r,e){return r.type===e.type&&r.key===e.key}const fh=({key:r})=>r??null,ho=({ref:r,ref_key:e,ref_for:t})=>(typeof r=="number"&&(r=""+r),r!=null?xe(r)||ze(r)||_(r)?{i:dt,r,k:e,f:!!t}:r:null);function $e(r,e=null,t=null,n=0,s=null,i=r===nt?0:1,o=!1,c=!1){const u={__v_isVNode:!0,__v_skip:!0,type:r,props:e,key:e&&fh(e),ref:e&&ho(e),scopeId:qf,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:dt};return c?(lu(u,t),i&128&&r.normalize(u)):t&&(u.shapeFlag|=xe(t)?8:16),Ri>0&&!o&&Ze&&(u.patchFlag>0||i&6)&&u.patchFlag!==32&&Ze.push(u),u}const Ss=fm;function fm(r,e=null,t=null,n=0,s=null,i=!1){if((!r||r===Bg)&&(r=js),lh(r)){const c=Ws(r,e,!0);return t&&lu(c,t),Ri>0&&!i&&Ze&&(c.shapeFlag&6?Ze[Ze.indexOf(r)]=c:Ze.push(c)),c.patchFlag=-2,c}if(Tm(r)&&(r=r.__vccOpts),e){e=hm(e);let{class:c,style:u}=e;c&&!xe(c)&&(e.class=Zc(c)),we(u)&&(iu(u)&&!H(u)&&(u=qe({},u)),e.style=Xc(u))}const o=xe(r)?1:uh(r)?128:bg(r)?64:we(r)?4:_(r)?2:0;return $e(r,e,t,n,s,o,i,!0)}function hm(r){return r?iu(r)||Zf(r)?qe({},r):r:null}function Ws(r,e,t=!1,n=!1){const{props:s,ref:i,patchFlag:o,children:c,transition:u}=r,f=e?dm(s||{},e):s,h={__v_isVNode:!0,__v_skip:!0,type:r.type,props:f,key:f&&fh(f),ref:e&&e.ref?t&&i?H(i)?i.concat(ho(e)):[i,ho(e)]:ho(e):i,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:c,target:r.target,targetStart:r.targetStart,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:e&&r.type!==nt?o===-1?16:o|16:o,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:u,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&Ws(r.ssContent),ssFallback:r.ssFallback&&Ws(r.ssFallback),placeholder:r.placeholder,el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce};return u&&n&&au(h,u.clone(h)),h}function hh(r=" ",e=0){return Ss(la,null,r,e)}function Ut(r){return r==null||typeof r=="boolean"?Ss(js):H(r)?Ss(nt,null,r.slice()):lh(r)?Zn(r):Ss(la,null,String(r))}function Zn(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:Ws(r)}function lu(r,e){let t=0;const{shapeFlag:n}=r;if(e==null)e=null;else if(H(e))t=16;else if(typeof e=="object")if(n&65){const s=e.default;s&&(s._c&&(s._d=!1),lu(r,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!Zf(e)?e._ctx=dt:s===3&&dt&&(dt.slots._===1?e._=1:(e._=2,r.patchFlag|=1024))}else _(e)?(e={default:e,_ctx:dt},t=32):(e=String(e),n&64?(t=16,e=[hh(e)]):t=8);r.children=e,r.shapeFlag|=t}function dm(...r){const e={};for(let t=0;t<r.length;t++){const n=r[t];for(const s in n)if(s==="class")e.class!==n.class&&(e.class=Zc([e.class,n.class]));else if(s==="style")e.style=Xc([e.style,n.style]);else if(ra(s)){const i=e[s],o=n[s];o&&i!==o&&!(H(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=n[s])}return e}function Jt(r,e,t,n=null){Xt(r,e,7,[t,n])}const gm=_f();let mm=0;function pm(r,e,t){const n=r.type,s=(e?e.appContext:r.appContext)||gm,i={uid:mm++,vnode:r,type:n,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Ud(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:eh(n,s),emitsOptions:ch(n,s),emit:null,emitted:null,propsDefaults:le,inheritAttrs:n.inheritAttrs,ctx:le,data:le,props:le,attrs:le,slots:le,refs:le,setupState:le,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=nm.bind(null,i),r.ce&&r.ce(i),i}let Ue=null;const ym=()=>Ue||dt;let Eo,Za;{const r=ia(),e=(t,n)=>{let s;return(s=r[t])||(s=r[t]=[]),s.push(n),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};Eo=e("__VUE_INSTANCE_SETTERS__",t=>Ue=t),Za=e("__VUE_SSR_SETTERS__",t=>Li=t)}const Wi=r=>{const e=Ue;return Eo(r),r.scope.on(),()=>{r.scope.off(),Eo(e)}},Zu=()=>{Ue&&Ue.scope.off(),Eo(null)};function dh(r){return r.vnode.shapeFlag&4}let Li=!1;function vm(r,e=!1,t=!1){e&&Za(e);const{props:n,children:s}=r.vnode,i=dh(r);Kg(r,n,i,e),Hg(r,s,t||e);const o=i?wm(r,e):void 0;return e&&Za(!1),o}function wm(r,e){const t=r.type;r.accessCache=Object.create(null),r.proxy=new Proxy(r.ctx,Rg);const{setup:n}=t;if(n){zn();const s=r.setupContext=n.length>1?Sm(r):null,i=Wi(r),o=ji(n,r,0,[r.props,s]),c=gf(o);if(qn(),i(),(c||r.sp)&&!Ti(r)&&Kf(r),c){if(o.then(Zu,Zu),e)return o.then(u=>{Qu(r,u)}).catch(u=>{aa(u,r,0)});r.asyncDep=o}else Qu(r,o)}else gh(r)}function Qu(r,e,t){_(e)?r.type.__ssrInlineRender?r.ssrRender=e:r.render=e:we(e)&&(r.setupState=$f(e)),gh(r)}function gh(r,e,t){const n=r.type;r.render||(r.render=n.render||Ht);{const s=Wi(r);zn();try{Lg(r)}finally{qn(),s()}}}const bm={get(r,e){return De(r,"get",""),r[e]}};function Sm(r){const e=t=>{r.exposed=t||{}};return{attrs:new Proxy(r.attrs,bm),slots:r.slots,emit:r.emit,expose:e}}function fa(r){return r.exposed?r.exposeProxy||(r.exposeProxy=new Proxy($f(ag(r.exposed)),{get(e,t){if(t in e)return e[t];if(t in Ai)return Ai[t](r)},has(e,t){return t in e||t in Ai}})):r.proxy}function Tm(r){return _(r)&&"__vccOpts"in r}const Am=(r,e)=>fg(r,e,Li),Im="3.5.18";/**
* @vue/runtime-dom v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Qa;const el=typeof window<"u"&&window.trustedTypes;if(el)try{Qa=el.createPolicy("vue",{createHTML:r=>r})}catch{}const mh=Qa?r=>Qa.createHTML(r):r=>r,km="http://www.w3.org/2000/svg",xm="http://www.w3.org/1998/Math/MathML",or=typeof document<"u"?document:null,tl=or&&or.createElement("template"),Em={insert:(r,e,t)=>{e.insertBefore(r,t||null)},remove:r=>{const e=r.parentNode;e&&e.removeChild(r)},createElement:(r,e,t,n)=>{const s=e==="svg"?or.createElementNS(km,r):e==="mathml"?or.createElementNS(xm,r):t?or.createElement(r,{is:t}):or.createElement(r);return r==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:r=>or.createTextNode(r),createComment:r=>or.createComment(r),setText:(r,e)=>{r.nodeValue=e},setElementText:(r,e)=>{r.textContent=e},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>or.querySelector(r),setScopeId(r,e){r.setAttribute(e,"")},insertStaticContent(r,e,t,n,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{tl.innerHTML=mh(n==="svg"?`<svg>${r}</svg>`:n==="mathml"?`<math>${r}</math>`:r);const c=tl.content;if(n==="svg"||n==="mathml"){const u=c.firstChild;for(;u.firstChild;)c.appendChild(u.firstChild);c.removeChild(u)}e.insertBefore(c,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},Cm=Symbol("_vtc");function Pm(r,e,t){const n=r[Cm];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?r.removeAttribute("class"):t?r.setAttribute("class",e):r.className=e}const rl=Symbol("_vod"),Nm=Symbol("_vsh"),Dm=Symbol(""),Om=/(^|;)\s*display\s*:/;function Bm(r,e,t){const n=r.style,s=xe(t);let i=!1;if(t&&!s){if(e)if(xe(e))for(const o of e.split(";")){const c=o.slice(0,o.indexOf(":")).trim();t[c]==null&&go(n,c,"")}else for(const o in e)t[o]==null&&go(n,o,"");for(const o in t)o==="display"&&(i=!0),go(n,o,t[o])}else if(s){if(e!==t){const o=n[Dm];o&&(t+=";"+o),n.cssText=t,i=Om.test(t)}}else e&&r.removeAttribute("style");rl in r&&(r[rl]=i?n.display:"",r[Nm]&&(n.display="none"))}const nl=/\s*!important$/;function go(r,e,t){if(H(t))t.forEach(n=>go(r,e,n));else if(t==null&&(t=""),e.startsWith("--"))r.setProperty(e,t);else{const n=Rm(r,e);nl.test(t)?r.setProperty(as(n),t.replace(nl,""),"important"):r[n]=t}}const sl=["Webkit","Moz","ms"],Da={};function Rm(r,e){const t=Da[e];if(t)return t;let n=ss(e);if(n!=="filter"&&n in r)return Da[e]=n;n=yf(n);for(let s=0;s<sl.length;s++){const i=sl[s]+n;if(i in r)return Da[e]=i}return e}const il="http://www.w3.org/1999/xlink";function ol(r,e,t,n,s,i=Md(e)){n&&e.startsWith("xlink:")?t==null?r.removeAttributeNS(il,e.slice(6,e.length)):r.setAttributeNS(il,e,t):t==null||i&&!vf(t)?r.removeAttribute(e):r.setAttribute(e,i?"":os(t)?String(t):t)}function al(r,e,t,n,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(r[e]=e==="innerHTML"?mh(t):t);return}const i=r.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const c=i==="OPTION"?r.getAttribute("value")||"":r.value,u=t==null?r.type==="checkbox"?"on":"":String(t);(c!==u||!("_value"in r))&&(r.value=u),t==null&&r.removeAttribute(e),r._value=t;return}let o=!1;if(t===""||t==null){const c=typeof r[e];c==="boolean"?t=vf(t):t==null&&c==="string"?(t="",o=!0):c==="number"&&(t=0,o=!0)}try{r[e]=t}catch{}o&&r.removeAttribute(s||e)}function Bs(r,e,t,n){r.addEventListener(e,t,n)}function Lm(r,e,t,n){r.removeEventListener(e,t,n)}const cl=Symbol("_vei");function Jm(r,e,t,n,s=null){const i=r[cl]||(r[cl]={}),o=i[e];if(n&&o)o.value=n;else{const[c,u]=$m(e);if(n){const f=i[e]=Um(n,s);Bs(r,c,f,u)}else o&&(Lm(r,c,o,u),i[e]=void 0)}}const ul=/(?:Once|Passive|Capture)$/;function $m(r){let e;if(ul.test(r)){e={};let n;for(;n=r.match(ul);)r=r.slice(0,r.length-n[0].length),e[n[0].toLowerCase()]=!0}return[r[2]===":"?r.slice(3):as(r.slice(2)),e]}let Oa=0;const Fm=Promise.resolve(),Mm=()=>Oa||(Fm.then(()=>Oa=0),Oa=Date.now());function Um(r,e){const t=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=t.attached)return;Xt(zm(n,t.value),e,5,[n])};return t.value=r,t.attached=Mm(),t}function zm(r,e){if(H(e)){const t=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{t.call(r),r._stopped=!0},e.map(n=>s=>!s._stopped&&n&&n(s))}else return e}const ll=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)>96&&r.charCodeAt(2)<123,qm=(r,e,t,n,s,i)=>{const o=s==="svg";e==="class"?Pm(r,n,o):e==="style"?Bm(r,t,n):ra(e)?Gc(e)||Jm(r,e,t,n,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Km(r,e,n,o))?(al(r,e,n),!r.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&ol(r,e,n,o,i,e!=="value")):r._isVueCE&&(/[A-Z]/.test(e)||!xe(n))?al(r,ss(e),n,i,e):(e==="true-value"?r._trueValue=n:e==="false-value"&&(r._falseValue=n),ol(r,e,n,o))};function Km(r,e,t,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in r&&ll(e)&&_(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&r.tagName==="INPUT"||e==="type"&&r.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=r.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return ll(e)&&xe(t)?!1:e in r}const fl=r=>{const e=r.props["onUpdate:modelValue"]||!1;return H(e)?t=>lo(e,t):e};function Vm(r){r.target.composing=!0}function hl(r){const e=r.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Ba=Symbol("_assign"),dl={created(r,{modifiers:{lazy:e,trim:t,number:n}},s){r[Ba]=fl(s);const i=n||s.props&&s.props.type==="number";Bs(r,e?"change":"input",o=>{if(o.target.composing)return;let c=r.value;t&&(c=c.trim()),i&&(c=qa(c)),r[Ba](c)}),t&&Bs(r,"change",()=>{r.value=r.value.trim()}),e||(Bs(r,"compositionstart",Vm),Bs(r,"compositionend",hl),Bs(r,"change",hl))},mounted(r,{value:e}){r.value=e??""},beforeUpdate(r,{value:e,oldValue:t,modifiers:{lazy:n,trim:s,number:i}},o){if(r[Ba]=fl(o),r.composing)return;const c=(i||r.type==="number")&&!/^0\d/.test(r.value)?qa(r.value):r.value,u=e??"";c!==u&&(document.activeElement===r&&r.type!=="range"&&(n&&e===t||s&&r.value.trim()===u)||(r.value=u))}},jm={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ro=(r,e)=>{const t=r._withKeys||(r._withKeys={}),n=e.join(".");return t[n]||(t[n]=s=>{if(!("key"in s))return;const i=as(s.key);if(e.some(o=>o===i||jm[o]===i))return r(s)})},Wm=qe({patchProp:qm},Em);let gl;function Hm(){return gl||(gl=_g(Wm))}const Gm=(...r)=>{const e=Hm().createApp(...r),{mount:t}=e;return e.mount=n=>{const s=Ym(n);if(!s)return;const i=e._component;!_(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,_m(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function _m(r){if(r instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&r instanceof MathMLElement)return"mathml"}function Ym(r){return xe(r)?document.querySelector(r):r}var X;(function(r){r[r.Canceled=1]="Canceled",r[r.Unknown=2]="Unknown",r[r.InvalidArgument=3]="InvalidArgument",r[r.DeadlineExceeded=4]="DeadlineExceeded",r[r.NotFound=5]="NotFound",r[r.AlreadyExists=6]="AlreadyExists",r[r.PermissionDenied=7]="PermissionDenied",r[r.ResourceExhausted=8]="ResourceExhausted",r[r.FailedPrecondition=9]="FailedPrecondition",r[r.Aborted=10]="Aborted",r[r.OutOfRange=11]="OutOfRange",r[r.Unimplemented=12]="Unimplemented",r[r.Internal=13]="Internal",r[r.Unavailable=14]="Unavailable",r[r.DataLoss=15]="DataLoss",r[r.Unauthenticated=16]="Unauthenticated"})(X||(X={}));function ml(r){const e=X[r];return typeof e!="string"?r.toString():e[0].toLowerCase()+e.substring(1).replace(/[A-Z]/g,t=>"_"+t.toLowerCase())}class ce extends Error{constructor(e,t=X.Unknown,n,s,i){super(Xm(e,t)),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=e,this.code=t,this.metadata=new Headers(n??{}),this.details=s??[],this.cause=i}static from(e,t=X.Unknown){return e instanceof ce?e:e instanceof Error?e.name=="AbortError"?new ce(e.message,X.Canceled):new ce(e.message,t,void 0,void 0,e):new ce(String(e),t,void 0,void 0,e)}static[Symbol.hasInstance](e){return e instanceof Error?Object.getPrototypeOf(e)===ce.prototype?!0:e.name==="ConnectError"&&"code"in e&&typeof e.code=="number"&&"metadata"in e&&"details"in e&&Array.isArray(e.details)&&"rawMessage"in e&&typeof e.rawMessage=="string"&&"cause"in e:!1}findDetails(e){const t="typeName"in e?{findMessage:s=>s===e.typeName?e:void 0}:e,n=[];for(const s of this.details){if("getType"in s){t.findMessage(s.getType().typeName)&&n.push(s);continue}const i=t.findMessage(s.type);if(i)try{n.push(i.fromBinary(s.value))}catch{}}return n}}function Xm(r,e){return r.length?`[${ml(e)}] ${r}`:`[${ml(e)}]`}function Se(r,e){if(!r)throw new Error(e)}const Zm=34028234663852886e22,Qm=-34028234663852886e22,ep=4294967295,tp=2147483647,rp=-2147483648;function mo(r){if(typeof r!="number")throw new Error("invalid int 32: "+typeof r);if(!Number.isInteger(r)||r>tp||r<rp)throw new Error("invalid int 32: "+r)}function ec(r){if(typeof r!="number")throw new Error("invalid uint 32: "+typeof r);if(!Number.isInteger(r)||r>ep||r<0)throw new Error("invalid uint 32: "+r)}function ph(r){if(typeof r!="number")throw new Error("invalid float 32: "+typeof r);if(Number.isFinite(r)&&(r>Zm||r<Qm))throw new Error("invalid float 32: "+r)}const yh=Symbol("@bufbuild/protobuf/enum-type");function np(r){const e=r[yh];return Se(e,"missing enum type on enum object"),e}function vh(r,e,t,n){r[yh]=wh(e,t.map(s=>({no:s.no,name:s.name,localName:r[s.no]})))}function wh(r,e,t){const n=Object.create(null),s=Object.create(null),i=[];for(const o of e){const c=bh(o);i.push(c),n[o.name]=c,s[o.no]=c}return{typeName:r,values:i,findName(o){return n[o]},findNumber(o){return s[o]}}}function sp(r,e,t){const n={};for(const s of e){const i=bh(s);n[i.localName]=i.no,n[i.no]=i.localName}return vh(n,r,e),n}function bh(r){return"localName"in r?r:Object.assign(Object.assign({},r),{localName:r.name})}class I{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const n=this.getType(),s=n.runtime.bin,i=s.makeReadOptions(t);return s.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,t){const n=this.getType(),s=n.runtime.json,i=s.makeReadOptions(t);return s.readMessage(n,e,i,this),this}fromJsonString(e,t){let n;try{n=JSON.parse(e)}catch(s){throw new Error(`cannot decode ${this.getType().typeName} from JSON: ${s instanceof Error?s.message:String(s)}`)}return this.fromJson(n,t)}toBinary(e){const t=this.getType(),n=t.runtime.bin,s=n.makeWriteOptions(e),i=s.writerFactory();return n.writeMessage(this,i,s),i.finish()}toJson(e){const t=this.getType(),n=t.runtime.json,s=n.makeWriteOptions(e);return n.writeMessage(this,s)}toJsonString(e){var t;const n=this.toJson(e);return JSON.stringify(n,null,(t=e==null?void 0:e.prettySpaces)!==null&&t!==void 0?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function ip(r,e,t,n){var s;const i=(s=n==null?void 0:n.localName)!==null&&s!==void 0?s:e.substring(e.lastIndexOf(".")+1),o={[i]:function(c){r.util.initFields(this),r.util.initPartial(c,this)}}[i];return Object.setPrototypeOf(o.prototype,new I),Object.assign(o,{runtime:r,typeName:e,fields:r.util.newFieldList(t),fromBinary(c,u){return new o().fromBinary(c,u)},fromJson(c,u){return new o().fromJson(c,u)},fromJsonString(c,u){return new o().fromJsonString(c,u)},equals(c,u){return r.util.equals(o,c,u)}}),o}function op(){let r=0,e=0;for(let n=0;n<28;n+=7){let s=this.buf[this.pos++];if(r|=(s&127)<<n,!(s&128))return this.assertBounds(),[r,e]}let t=this.buf[this.pos++];if(r|=(t&15)<<28,e=(t&112)>>4,!(t&128))return this.assertBounds(),[r,e];for(let n=3;n<=31;n+=7){let s=this.buf[this.pos++];if(e|=(s&127)<<n,!(s&128))return this.assertBounds(),[r,e]}throw new Error("invalid varint")}function Ra(r,e,t){for(let i=0;i<28;i=i+7){const o=r>>>i,c=!(!(o>>>7)&&e==0),u=(c?o|128:o)&255;if(t.push(u),!c)return}const n=r>>>28&15|(e&7)<<4,s=!!(e>>3);if(t.push((s?n|128:n)&255),!!s){for(let i=3;i<31;i=i+7){const o=e>>>i,c=!!(o>>>7),u=(c?o|128:o)&255;if(t.push(u),!c)return}t.push(e>>>31&1)}}const po=4294967296;function pl(r){const e=r[0]==="-";e&&(r=r.slice(1));const t=1e6;let n=0,s=0;function i(o,c){const u=Number(r.slice(o,c));s*=t,n=n*t+u,n>=po&&(s=s+(n/po|0),n=n%po)}return i(-24,-18),i(-18,-12),i(-12,-6),i(-6),e?Th(n,s):fu(n,s)}function ap(r,e){let t=fu(r,e);const n=t.hi&2147483648;n&&(t=Th(t.lo,t.hi));const s=Sh(t.lo,t.hi);return n?"-"+s:s}function Sh(r,e){if({lo:r,hi:e}=cp(r,e),e<=2097151)return String(po*e+r);const t=r&16777215,n=(r>>>24|e<<8)&16777215,s=e>>16&65535;let i=t+n*6777216+s*6710656,o=n+s*8147497,c=s*2;const u=1e7;return i>=u&&(o+=Math.floor(i/u),i%=u),o>=u&&(c+=Math.floor(o/u),o%=u),c.toString()+yl(o)+yl(i)}function cp(r,e){return{lo:r>>>0,hi:e>>>0}}function fu(r,e){return{lo:r|0,hi:e|0}}function Th(r,e){return e=~e,r?r=~r+1:e+=1,fu(r,e)}const yl=r=>{const e=String(r);return"0000000".slice(e.length)+e};function vl(r,e){if(r>=0){for(;r>127;)e.push(r&127|128),r=r>>>7;e.push(r)}else{for(let t=0;t<9;t++)e.push(r&127|128),r=r>>7;e.push(1)}}function up(){let r=this.buf[this.pos++],e=r&127;if(!(r&128))return this.assertBounds(),e;if(r=this.buf[this.pos++],e|=(r&127)<<7,!(r&128))return this.assertBounds(),e;if(r=this.buf[this.pos++],e|=(r&127)<<14,!(r&128))return this.assertBounds(),e;if(r=this.buf[this.pos++],e|=(r&127)<<21,!(r&128))return this.assertBounds(),e;r=this.buf[this.pos++],e|=(r&15)<<28;for(let t=5;r&128&&t<10;t++)r=this.buf[this.pos++];if(r&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}var wl={};function lp(){const r=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof r.getBigInt64=="function"&&typeof r.getBigUint64=="function"&&typeof r.setBigInt64=="function"&&typeof r.setBigUint64=="function"&&(typeof process!="object"||typeof wl!="object"||wl.BUF_BIGINT_DISABLE!=="1")){const s=BigInt("-9223372036854775808"),i=BigInt("9223372036854775807"),o=BigInt("0"),c=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(u){const f=typeof u=="bigint"?u:BigInt(u);if(f>i||f<s)throw new Error(`int64 invalid: ${u}`);return f},uParse(u){const f=typeof u=="bigint"?u:BigInt(u);if(f>c||f<o)throw new Error(`uint64 invalid: ${u}`);return f},enc(u){return r.setBigInt64(0,this.parse(u),!0),{lo:r.getInt32(0,!0),hi:r.getInt32(4,!0)}},uEnc(u){return r.setBigInt64(0,this.uParse(u),!0),{lo:r.getInt32(0,!0),hi:r.getInt32(4,!0)}},dec(u,f){return r.setInt32(0,u,!0),r.setInt32(4,f,!0),r.getBigInt64(0,!0)},uDec(u,f){return r.setInt32(0,u,!0),r.setInt32(4,f,!0),r.getBigUint64(0,!0)}}}const t=s=>Se(/^-?[0-9]+$/.test(s),`int64 invalid: ${s}`),n=s=>Se(/^[0-9]+$/.test(s),`uint64 invalid: ${s}`);return{zero:"0",supported:!1,parse(s){return typeof s!="string"&&(s=s.toString()),t(s),s},uParse(s){return typeof s!="string"&&(s=s.toString()),n(s),s},enc(s){return typeof s!="string"&&(s=s.toString()),t(s),pl(s)},uEnc(s){return typeof s!="string"&&(s=s.toString()),n(s),pl(s)},dec(s,i){return ap(s,i)},uDec(s,i){return Sh(s,i)}}}const Q=lp();var b;(function(r){r[r.DOUBLE=1]="DOUBLE",r[r.FLOAT=2]="FLOAT",r[r.INT64=3]="INT64",r[r.UINT64=4]="UINT64",r[r.INT32=5]="INT32",r[r.FIXED64=6]="FIXED64",r[r.FIXED32=7]="FIXED32",r[r.BOOL=8]="BOOL",r[r.STRING=9]="STRING",r[r.BYTES=12]="BYTES",r[r.UINT32=13]="UINT32",r[r.SFIXED32=15]="SFIXED32",r[r.SFIXED64=16]="SFIXED64",r[r.SINT32=17]="SINT32",r[r.SINT64=18]="SINT64"})(b||(b={}));var is;(function(r){r[r.BIGINT=0]="BIGINT",r[r.STRING=1]="STRING"})(is||(is={}));function Hn(r,e,t){if(e===t)return!0;if(r==b.BYTES){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}switch(r){case b.UINT64:case b.FIXED64:case b.INT64:case b.SFIXED64:case b.SINT64:return e==t}return!1}function Hs(r,e){switch(r){case b.BOOL:return!1;case b.UINT64:case b.FIXED64:case b.INT64:case b.SFIXED64:case b.SINT64:return e==0?Q.zero:"0";case b.DOUBLE:case b.FLOAT:return 0;case b.BYTES:return new Uint8Array(0);case b.STRING:return"";default:return 0}}function Ah(r,e){switch(r){case b.BOOL:return e===!1;case b.STRING:return e==="";case b.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var Ae;(function(r){r[r.Varint=0]="Varint",r[r.Bit64=1]="Bit64",r[r.LengthDelimited=2]="LengthDelimited",r[r.StartGroup=3]="StartGroup",r[r.EndGroup=4]="EndGroup",r[r.Bit32=5]="Bit32"})(Ae||(Ae={}));class fp{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let s=0;s<this.chunks.length;s++)e+=this.chunks[s].length;let t=new Uint8Array(e),n=0;for(let s=0;s<this.chunks.length;s++)t.set(this.chunks[s],n),n+=this.chunks[s].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(ec(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return mo(e),vl(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){ph(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){ec(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){mo(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return mo(e),e=(e<<1^e>>31)>>>0,vl(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),s=Q.enc(e);return n.setInt32(0,s.lo,!0),n.setInt32(4,s.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),s=Q.uEnc(e);return n.setInt32(0,s.lo,!0),n.setInt32(4,s.hi,!0),this.raw(t)}int64(e){let t=Q.enc(e);return Ra(t.lo,t.hi,this.buf),this}sint64(e){let t=Q.enc(e),n=t.hi>>31,s=t.lo<<1^n,i=(t.hi<<1|t.lo>>>31)^n;return Ra(s,i,this.buf),this}uint64(e){let t=Q.uEnc(e);return Ra(t.lo,t.hi,this.buf),this}}class hp{constructor(e,t){this.varint64=op,this.uint32=up,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,n=e&7;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e,t){let n=this.pos;switch(e){case Ae.Varint:for(;this.buf[this.pos++]&128;);break;case Ae.Bit64:this.pos+=4;case Ae.Bit32:this.pos+=4;break;case Ae.LengthDelimited:let s=this.uint32();this.pos+=s;break;case Ae.StartGroup:for(;;){const[i,o]=this.tag();if(o===Ae.EndGroup){if(t!==void 0&&i!==t)throw new Error("invalid end group tag");break}this.skip(o,i)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Q.dec(...this.varint64())}uint64(){return Q.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(e&1);return e=(e>>>1|(t&1)<<31)^n,t=t>>>1^n,Q.dec(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Q.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Q.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function dp(r,e,t,n){let s;return{typeName:e,extendee:t,get field(){if(!s){const i=typeof n=="function"?n():n;i.name=e.split(".").pop(),i.jsonName=`[${e}]`,s=r.util.newFieldList([i]).list()[0]}return s},runtime:r}}function Ih(r){const e=r.field.localName,t=Object.create(null);return t[e]=gp(r),[t,()=>t[e]]}function gp(r){const e=r.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return Hs(e.T,e.L);case"message":const t=e.T,n=new t;return t.fieldWrapper?t.fieldWrapper.unwrapField(n):n;case"map":throw"map fields are not allowed to be extensions"}}function mp(r,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let t=r.length-1;t>=0;--t)if(r[t].no==e.no)return[r[t]];return[]}return r.filter(t=>t.no===e.no)}let Rn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),ha=[];for(let r=0;r<Rn.length;r++)ha[Rn[r].charCodeAt(0)]=r;ha[45]=Rn.indexOf("+");ha[95]=Rn.indexOf("/");const hu={dec(r){let e=r.length*3/4;r[r.length-2]=="="?e-=2:r[r.length-1]=="="&&(e-=1);let t=new Uint8Array(e),n=0,s=0,i,o=0;for(let c=0;c<r.length;c++){if(i=ha[r.charCodeAt(c)],i===void 0)switch(r[c]){case"=":s=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(s){case 0:o=i,s=1;break;case 1:t[n++]=o<<2|(i&48)>>4,o=i,s=2;break;case 2:t[n++]=(o&15)<<4|(i&60)>>2,o=i,s=3;break;case 3:t[n++]=(o&3)<<6|i,s=0;break}}if(s==1)throw Error("invalid base64 string.");return t.subarray(0,n)},enc(r){let e="",t=0,n,s=0;for(let i=0;i<r.length;i++)switch(n=r[i],t){case 0:e+=Rn[n>>2],s=(n&3)<<4,t=1;break;case 1:e+=Rn[s|n>>4],s=(n&15)<<2,t=2;break;case 2:e+=Rn[s|n>>6],e+=Rn[n&63],t=0;break}return t&&(e+=Rn[s],e+="=",t==1&&(e+="=")),e}};function pp(r,e,t){xh(e,r);const n=e.runtime.bin.makeReadOptions(t),s=mp(r.getType().runtime.bin.listUnknownFields(r),e.field),[i,o]=Ih(e);for(const c of s)e.runtime.bin.readField(i,n.readerFactory(c.data),e.field,c.wireType,n);return o()}function yp(r,e,t,n){xh(e,r);const s=e.runtime.bin.makeReadOptions(n),i=e.runtime.bin.makeWriteOptions(n);if(kh(r,e)){const f=r.getType().runtime.bin.listUnknownFields(r).filter(h=>h.no!=e.field.no);r.getType().runtime.bin.discardUnknownFields(r);for(const h of f)r.getType().runtime.bin.onUnknownField(r,h.no,h.wireType,h.data)}const o=i.writerFactory();let c=e.field;!c.opt&&!c.repeated&&(c.kind=="enum"||c.kind=="scalar")&&(c=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(c,t,o,i);const u=s.readerFactory(o.finish());for(;u.pos<u.len;){const[f,h]=u.tag(),d=u.skip(h,f);r.getType().runtime.bin.onUnknownField(r,f,h,d)}}function kh(r,e){const t=r.getType();return e.extendee.typeName===t.typeName&&!!t.runtime.bin.listUnknownFields(r).find(n=>n.no==e.field.no)}function xh(r,e){Se(r.extendee.typeName==e.getType().typeName,`extension ${r.typeName} can only be applied to message ${r.extendee.typeName}`)}function Eh(r,e){const t=r.localName;if(r.repeated)return e[t].length>0;if(r.oneof)return e[r.oneof.localName].case===t;switch(r.kind){case"enum":case"scalar":return r.opt||r.req?e[t]!==void 0:r.kind=="enum"?e[t]!==r.T.values[0].no:!Ah(r.T,e[t]);case"message":return e[t]!==void 0;case"map":return Object.keys(e[t]).length>0}}function bl(r,e){const t=r.localName,n=!r.opt&&!r.req;if(r.repeated)e[t]=[];else if(r.oneof)e[r.oneof.localName]={case:void 0};else switch(r.kind){case"map":e[t]={};break;case"enum":e[t]=n?r.T.values[0].no:void 0;break;case"scalar":e[t]=n?Hs(r.T,r.L):void 0;break;case"message":e[t]=void 0;break}}function Ln(r,e){if(r===null||typeof r!="object"||!Object.getOwnPropertyNames(I.prototype).every(n=>n in r&&typeof r[n]=="function"))return!1;const t=r.getType();return t===null||typeof t!="function"||!("typeName"in t)||typeof t.typeName!="string"?!1:e===void 0?!0:t.typeName==e.typeName}function Ch(r,e){return Ln(e)||!r.fieldWrapper?e:r.fieldWrapper.wrapField(e)}b.DOUBLE,b.FLOAT,b.INT64,b.UINT64,b.INT32,b.UINT32,b.BOOL,b.STRING,b.BYTES;const Sl={ignoreUnknownFields:!1},Tl={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function vp(r){return r?Object.assign(Object.assign({},Sl),r):Sl}function wp(r){return r?Object.assign(Object.assign({},Tl),r):Tl}const Co=Symbol(),yo=Symbol();function bp(){return{makeReadOptions:vp,makeWriteOptions:wp,readMessage(r,e,t,n){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error(`cannot decode message ${r.typeName} from JSON: ${Mt(e)}`);n=n??new r;const s=new Map,i=t.typeRegistry;for(const[o,c]of Object.entries(e)){const u=r.fields.findJsonName(o);if(u){if(u.oneof){if(c===null&&u.kind=="scalar")continue;const f=s.get(u.oneof);if(f!==void 0)throw new Error(`cannot decode message ${r.typeName} from JSON: multiple keys for oneof "${u.oneof.name}" present: "${f}", "${o}"`);s.set(u.oneof,o)}Al(n,c,u,t,r)}else{let f=!1;if(i!=null&&i.findExtension&&o.startsWith("[")&&o.endsWith("]")){const h=i.findExtension(o.substring(1,o.length-1));if(h&&h.extendee.typeName==r.typeName){f=!0;const[d,p]=Ih(h);Al(d,c,h.field,t,h),yp(n,h,p(),t)}}if(!f&&!t.ignoreUnknownFields)throw new Error(`cannot decode message ${r.typeName} from JSON: key "${o}" is unknown`)}}return n},writeMessage(r,e){const t=r.getType(),n={};let s;try{for(s of t.fields.byNumber()){if(!Eh(s,r)){if(s.req)throw"required field not set";if(!e.emitDefaultValues||!Tp(s))continue}const o=s.oneof?r[s.oneof.localName].value:r[s.localName],c=Il(s,o,e);c!==void 0&&(n[e.useProtoFieldName?s.name:s.jsonName]=c)}const i=e.typeRegistry;if(i!=null&&i.findExtensionFor)for(const o of t.runtime.bin.listUnknownFields(r)){const c=i.findExtensionFor(t.typeName,o.no);if(c&&kh(r,c)){const u=pp(r,c,e),f=Il(c.field,u,e);f!==void 0&&(n[c.field.jsonName]=f)}}}catch(i){const o=s?`cannot encode field ${t.typeName}.${s.name} to JSON`:`cannot encode message ${t.typeName} to JSON`,c=i instanceof Error?i.message:String(i);throw new Error(o+(c.length>0?`: ${c}`:""))}return n},readScalar(r,e,t){return ki(r,e,t??is.BIGINT,!0)},writeScalar(r,e,t){if(e!==void 0&&(t||Ah(r,e)))return vo(r,e)},debug:Mt}}function Mt(r){if(r===null)return"null";switch(typeof r){case"object":return Array.isArray(r)?"array":"object";case"string":return r.length>100?"string":`"${r.split('"').join('\\"')}"`;default:return String(r)}}function Al(r,e,t,n,s){let i=t.localName;if(t.repeated){if(Se(t.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error(`cannot decode field ${s.typeName}.${t.name} from JSON: ${Mt(e)}`);const o=r[i];for(const c of e){if(c===null)throw new Error(`cannot decode field ${s.typeName}.${t.name} from JSON: ${Mt(c)}`);switch(t.kind){case"message":o.push(t.T.fromJson(c,n));break;case"enum":const u=La(t.T,c,n.ignoreUnknownFields,!0);u!==yo&&o.push(u);break;case"scalar":try{o.push(ki(t.T,c,t.L,!0))}catch(f){let h=`cannot decode field ${s.typeName}.${t.name} from JSON: ${Mt(c)}`;throw f instanceof Error&&f.message.length>0&&(h+=`: ${f.message}`),new Error(h)}break}}}else if(t.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error(`cannot decode field ${s.typeName}.${t.name} from JSON: ${Mt(e)}`);const o=r[i];for(const[c,u]of Object.entries(e)){if(u===null)throw new Error(`cannot decode field ${s.typeName}.${t.name} from JSON: map value null`);let f;try{f=Sp(t.K,c)}catch(h){let d=`cannot decode map key for field ${s.typeName}.${t.name} from JSON: ${Mt(e)}`;throw h instanceof Error&&h.message.length>0&&(d+=`: ${h.message}`),new Error(d)}switch(t.V.kind){case"message":o[f]=t.V.T.fromJson(u,n);break;case"enum":const h=La(t.V.T,u,n.ignoreUnknownFields,!0);h!==yo&&(o[f]=h);break;case"scalar":try{o[f]=ki(t.V.T,u,is.BIGINT,!0)}catch(d){let p=`cannot decode map value for field ${s.typeName}.${t.name} from JSON: ${Mt(e)}`;throw d instanceof Error&&d.message.length>0&&(p+=`: ${d.message}`),new Error(p)}break}}}else switch(t.oneof&&(r=r[t.oneof.localName]={case:i},i="value"),t.kind){case"message":const o=t.T;if(e===null&&o.typeName!="google.protobuf.Value")return;let c=r[i];Ln(c)?c.fromJson(e,n):(r[i]=c=o.fromJson(e,n),o.fieldWrapper&&!t.oneof&&(r[i]=o.fieldWrapper.unwrapField(c)));break;case"enum":const u=La(t.T,e,n.ignoreUnknownFields,!1);switch(u){case Co:bl(t,r);break;case yo:break;default:r[i]=u;break}break;case"scalar":try{const f=ki(t.T,e,t.L,!1);switch(f){case Co:bl(t,r);break;default:r[i]=f;break}}catch(f){let h=`cannot decode field ${s.typeName}.${t.name} from JSON: ${Mt(e)}`;throw f instanceof Error&&f.message.length>0&&(h+=`: ${f.message}`),new Error(h)}break}}function Sp(r,e){if(r===b.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return ki(r,e,is.BIGINT,!0).toString()}function ki(r,e,t,n){if(e===null)return n?Hs(r,t):Co;switch(r){case b.DOUBLE:case b.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const s=Number(e);if(Number.isNaN(s)||!Number.isFinite(s))break;return r==b.FLOAT&&ph(s),s;case b.INT32:case b.FIXED32:case b.SFIXED32:case b.SINT32:case b.UINT32:let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return r==b.UINT32||r==b.FIXED32?ec(i):mo(i),i;case b.INT64:case b.SFIXED64:case b.SINT64:if(typeof e!="number"&&typeof e!="string")break;const o=Q.parse(e);return t?o.toString():o;case b.FIXED64:case b.UINT64:if(typeof e!="number"&&typeof e!="string")break;const c=Q.uParse(e);return t?c.toString():c;case b.BOOL:if(typeof e!="boolean")break;return e;case b.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case b.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return hu.dec(e)}throw new Error}function La(r,e,t,n){if(e===null)return r.typeName=="google.protobuf.NullValue"?0:n?r.values[0].no:Co;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const s=r.findName(e);if(s!==void 0)return s.no;if(t)return yo;break}throw new Error(`cannot decode enum ${r.typeName} from JSON: ${Mt(e)}`)}function Tp(r){return r.repeated||r.kind=="map"?!0:!(r.oneof||r.kind=="message"||r.opt||r.req)}function Il(r,e,t){if(r.kind=="map"){Se(typeof e=="object"&&e!=null);const n={},s=Object.entries(e);switch(r.V.kind){case"scalar":for(const[o,c]of s)n[o.toString()]=vo(r.V.T,c);break;case"message":for(const[o,c]of s)n[o.toString()]=c.toJson(t);break;case"enum":const i=r.V.T;for(const[o,c]of s)n[o.toString()]=Ja(i,c,t.enumAsInteger);break}return t.emitDefaultValues||s.length>0?n:void 0}if(r.repeated){Se(Array.isArray(e));const n=[];switch(r.kind){case"scalar":for(let s=0;s<e.length;s++)n.push(vo(r.T,e[s]));break;case"enum":for(let s=0;s<e.length;s++)n.push(Ja(r.T,e[s],t.enumAsInteger));break;case"message":for(let s=0;s<e.length;s++)n.push(e[s].toJson(t));break}return t.emitDefaultValues||n.length>0?n:void 0}switch(r.kind){case"scalar":return vo(r.T,e);case"enum":return Ja(r.T,e,t.enumAsInteger);case"message":return Ch(r.T,e).toJson(t)}}function Ja(r,e,t){var n;if(Se(typeof e=="number"),r.typeName=="google.protobuf.NullValue")return null;if(t)return e;const s=r.findNumber(e);return(n=s==null?void 0:s.name)!==null&&n!==void 0?n:e}function vo(r,e){switch(r){case b.INT32:case b.SFIXED32:case b.SINT32:case b.FIXED32:case b.UINT32:return Se(typeof e=="number"),e;case b.FLOAT:case b.DOUBLE:return Se(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case b.STRING:return Se(typeof e=="string"),e;case b.BOOL:return Se(typeof e=="boolean"),e;case b.UINT64:case b.FIXED64:case b.INT64:case b.SFIXED64:case b.SINT64:return Se(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case b.BYTES:return Se(e instanceof Uint8Array),hu.enc(e)}}const Ps=Symbol("@bufbuild/protobuf/unknown-fields"),kl={readUnknownFields:!0,readerFactory:r=>new hp(r)},xl={writeUnknownFields:!0,writerFactory:()=>new fp};function Ap(r){return r?Object.assign(Object.assign({},kl),r):kl}function Ip(r){return r?Object.assign(Object.assign({},xl),r):xl}function kp(){return{makeReadOptions:Ap,makeWriteOptions:Ip,listUnknownFields(r){var e;return(e=r[Ps])!==null&&e!==void 0?e:[]},discardUnknownFields(r){delete r[Ps]},writeUnknownFields(r,e){const n=r[Ps];if(n)for(const s of n)e.tag(s.no,s.wireType).raw(s.data)},onUnknownField(r,e,t,n){const s=r;Array.isArray(s[Ps])||(s[Ps]=[]),s[Ps].push({no:e,wireType:t,data:n})},readMessage(r,e,t,n,s){const i=r.getType(),o=s?e.len:e.pos+t;let c,u;for(;e.pos<o&&([c,u]=e.tag(),!(s===!0&&u==Ae.EndGroup));){const f=i.fields.find(c);if(!f){const h=e.skip(u,c);n.readUnknownFields&&this.onUnknownField(r,c,u,h);continue}El(r,e,f,u,n)}if(s&&(u!=Ae.EndGroup||c!==t))throw new Error("invalid end group tag")},readField:El,writeMessage(r,e,t){const n=r.getType();for(const s of n.fields.byNumber()){if(!Eh(s,r)){if(s.req)throw new Error(`cannot encode field ${n.typeName}.${s.name} to binary: required field not set`);continue}const i=s.oneof?r[s.oneof.localName].value:r[s.localName];Cl(s,i,e,t)}return t.writeUnknownFields&&this.writeUnknownFields(r,e),e},writeField(r,e,t,n){e!==void 0&&Cl(r,e,t,n)}}}function El(r,e,t,n,s){let{repeated:i,localName:o}=t;switch(t.oneof&&(r=r[t.oneof.localName],r.case!=o&&delete r.value,r.case=o,o="value"),t.kind){case"scalar":case"enum":const c=t.kind=="enum"?b.INT32:t.T;let u=Po;if(t.kind=="scalar"&&t.L>0&&(u=Ep),i){let p=r[o];if(n==Ae.LengthDelimited&&c!=b.STRING&&c!=b.BYTES){let T=e.uint32()+e.pos;for(;e.pos<T;)p.push(u(e,c))}else p.push(u(e,c))}else r[o]=u(e,c);break;case"message":const f=t.T;i?r[o].push(wo(e,new f,s,t)):Ln(r[o])?wo(e,r[o],s,t):(r[o]=wo(e,new f,s,t),f.fieldWrapper&&!t.oneof&&!t.repeated&&(r[o]=f.fieldWrapper.unwrapField(r[o])));break;case"map":let[h,d]=xp(t,e,s);r[o][h]=d;break}}function wo(r,e,t,n){const s=e.getType().runtime.bin,i=n==null?void 0:n.delimited;return s.readMessage(e,r,i?n.no:r.uint32(),t,i),e}function xp(r,e,t){const n=e.uint32(),s=e.pos+n;let i,o;for(;e.pos<s;){const[c]=e.tag();switch(c){case 1:i=Po(e,r.K);break;case 2:switch(r.V.kind){case"scalar":o=Po(e,r.V.T);break;case"enum":o=e.int32();break;case"message":o=wo(e,new r.V.T,t,void 0);break}break}}if(i===void 0&&(i=Hs(r.K,is.BIGINT)),typeof i!="string"&&typeof i!="number"&&(i=i.toString()),o===void 0)switch(r.V.kind){case"scalar":o=Hs(r.V.T,is.BIGINT);break;case"enum":o=r.V.T.values[0].no;break;case"message":o=new r.V.T;break}return[i,o]}function Ep(r,e){const t=Po(r,e);return typeof t=="bigint"?t.toString():t}function Po(r,e){switch(e){case b.STRING:return r.string();case b.BOOL:return r.bool();case b.DOUBLE:return r.double();case b.FLOAT:return r.float();case b.INT32:return r.int32();case b.INT64:return r.int64();case b.UINT64:return r.uint64();case b.FIXED64:return r.fixed64();case b.BYTES:return r.bytes();case b.FIXED32:return r.fixed32();case b.SFIXED32:return r.sfixed32();case b.SFIXED64:return r.sfixed64();case b.SINT64:return r.sint64();case b.UINT32:return r.uint32();case b.SINT32:return r.sint32()}}function Cl(r,e,t,n){Se(e!==void 0);const s=r.repeated;switch(r.kind){case"scalar":case"enum":let i=r.kind=="enum"?b.INT32:r.T;if(s)if(Se(Array.isArray(e)),r.packed)Pp(t,i,r.no,e);else for(const o of e)xi(t,i,r.no,o);else xi(t,i,r.no,e);break;case"message":if(s){Se(Array.isArray(e));for(const o of e)Pl(t,n,r,o)}else Pl(t,n,r,e);break;case"map":Se(typeof e=="object"&&e!=null);for(const[o,c]of Object.entries(e))Cp(t,n,r,o,c);break}}function Cp(r,e,t,n,s){r.tag(t.no,Ae.LengthDelimited),r.fork();let i=n;switch(t.K){case b.INT32:case b.FIXED32:case b.UINT32:case b.SFIXED32:case b.SINT32:i=Number.parseInt(n);break;case b.BOOL:Se(n=="true"||n=="false"),i=n=="true";break}switch(xi(r,t.K,1,i),t.V.kind){case"scalar":xi(r,t.V.T,2,s);break;case"enum":xi(r,b.INT32,2,s);break;case"message":Se(s!==void 0),r.tag(2,Ae.LengthDelimited).bytes(s.toBinary(e));break}r.join()}function Pl(r,e,t,n){const s=Ch(t.T,n);t.delimited?r.tag(t.no,Ae.StartGroup).raw(s.toBinary(e)).tag(t.no,Ae.EndGroup):r.tag(t.no,Ae.LengthDelimited).bytes(s.toBinary(e))}function xi(r,e,t,n){Se(n!==void 0);let[s,i]=Ph(e);r.tag(t,s)[i](n)}function Pp(r,e,t,n){if(!n.length)return;r.tag(t,Ae.LengthDelimited).fork();let[,s]=Ph(e);for(let i=0;i<n.length;i++)r[s](n[i]);r.join()}function Ph(r){let e=Ae.Varint;switch(r){case b.BYTES:case b.STRING:e=Ae.LengthDelimited;break;case b.DOUBLE:case b.FIXED64:case b.SFIXED64:e=Ae.Bit64;break;case b.FIXED32:case b.SFIXED32:case b.FLOAT:e=Ae.Bit32;break}const t=b[r].toLowerCase();return[e,t]}function Np(){return{setEnumType:vh,initPartial(r,e){if(r===void 0)return;const t=e.getType();for(const n of t.fields.byMember()){const s=n.localName,i=e,o=r;if(o[s]!=null)switch(n.kind){case"oneof":const c=o[s].case;if(c===void 0)continue;const u=n.findField(c);let f=o[s].value;u&&u.kind=="message"&&!Ln(f,u.T)?f=new u.T(f):u&&u.kind==="scalar"&&u.T===b.BYTES&&(f=fi(f)),i[s]={case:c,value:f};break;case"scalar":case"enum":let h=o[s];n.T===b.BYTES&&(h=n.repeated?h.map(fi):fi(h)),i[s]=h;break;case"map":switch(n.V.kind){case"scalar":case"enum":if(n.V.T===b.BYTES)for(const[m,T]of Object.entries(o[s]))i[s][m]=fi(T);else Object.assign(i[s],o[s]);break;case"message":const p=n.V.T;for(const m of Object.keys(o[s])){let T=o[s][m];p.fieldWrapper||(T=new p(T)),i[s][m]=T}break}break;case"message":const d=n.T;if(n.repeated)i[s]=o[s].map(p=>Ln(p,d)?p:new d(p));else{const p=o[s];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?i[s]=fi(p):i[s]=p:i[s]=Ln(p,d)?p:new d(p)}break}}},equals(r,e,t){return e===t?!0:!e||!t?!1:r.fields.byMember().every(n=>{const s=e[n.localName],i=t[n.localName];if(n.repeated){if(s.length!==i.length)return!1;switch(n.kind){case"message":return s.every((o,c)=>n.T.equals(o,i[c]));case"scalar":return s.every((o,c)=>Hn(n.T,o,i[c]));case"enum":return s.every((o,c)=>Hn(b.INT32,o,i[c]))}throw new Error(`repeated cannot contain ${n.kind}`)}switch(n.kind){case"message":let o=s,c=i;return n.T.fieldWrapper&&(o!==void 0&&!Ln(o)&&(o=n.T.fieldWrapper.wrapField(o)),c!==void 0&&!Ln(c)&&(c=n.T.fieldWrapper.wrapField(c))),n.T.equals(o,c);case"enum":return Hn(b.INT32,s,i);case"scalar":return Hn(n.T,s,i);case"oneof":if(s.case!==i.case)return!1;const u=n.findField(s.case);if(u===void 0)return!0;switch(u.kind){case"message":return u.T.equals(s.value,i.value);case"enum":return Hn(b.INT32,s.value,i.value);case"scalar":return Hn(u.T,s.value,i.value)}throw new Error(`oneof cannot contain ${u.kind}`);case"map":const f=Object.keys(s).concat(Object.keys(i));switch(n.V.kind){case"message":const h=n.V.T;return f.every(p=>h.equals(s[p],i[p]));case"enum":return f.every(p=>Hn(b.INT32,s[p],i[p]));case"scalar":const d=n.V.T;return f.every(p=>Hn(d,s[p],i[p]))}break}})},clone(r){const e=r.getType(),t=new e,n=t;for(const s of e.fields.byMember()){const i=r[s.localName];let o;if(s.repeated)o=i.map(no);else if(s.kind=="map"){o=n[s.localName];for(const[c,u]of Object.entries(i))o[c]=no(u)}else s.kind=="oneof"?o=s.findField(i.case)?{case:i.case,value:no(i.value)}:{case:void 0}:o=no(i);n[s.localName]=o}for(const s of e.runtime.bin.listUnknownFields(r))e.runtime.bin.onUnknownField(n,s.no,s.wireType,s.data);return t}}}function no(r){if(r===void 0)return r;if(Ln(r))return r.clone();if(r instanceof Uint8Array){const e=new Uint8Array(r.byteLength);return e.set(r),e}return r}function fi(r){return r instanceof Uint8Array?r:new Uint8Array(r)}function Dp(r,e,t){return{syntax:r,json:bp(),bin:kp(),util:Object.assign(Object.assign({},Np()),{newFieldList:e,initFields:t}),makeMessageType(n,s,i){return ip(this,n,s,i)},makeEnum:sp,makeEnumType:wh,getEnumType:np,makeExtension(n,s,i){return dp(this,n,s,i)}}}class Op{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const t={};for(const n of this.list())t[n.jsonName]=t[n.name]=n;this.jsonNames=t}return this.jsonNames[e]}find(e){if(!this.numbers){const t={};for(const n of this.list())t[n.no]=n;this.numbers=t}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const n of this.list())n.oneof?n.oneof!==t&&(t=n.oneof,e.push(t)):e.push(n)}return this.members}}function Nh(r,e){const t=Dh(r);return e?t:Fp($p(t))}function Bp(r){return Nh(r,!1)}const Rp=Dh;function Dh(r){let e=!1;const t=[];for(let n=0;n<r.length;n++){let s=r.charAt(n);switch(s){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t.push(s),e=!1;break;default:e&&(e=!1,s=s.toUpperCase()),t.push(s);break}}return t.join("")}const Lp=new Set(["constructor","toString","toJSON","valueOf"]),Jp=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Oh=r=>`${r}$`,$p=r=>Jp.has(r)?Oh(r):r,Fp=r=>Lp.has(r)?Oh(r):r;class Mp{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=Bp(e)}addField(e){Se(e.oneof===this,`field ${e.name} not one of ${this.name}`),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}function Up(r,e){var t,n,s,i,o,c;const u=[];let f;for(const h of typeof r=="function"?r():r){const d=h;if(d.localName=Nh(h.name,h.oneof!==void 0),d.jsonName=(t=h.jsonName)!==null&&t!==void 0?t:Rp(h.name),d.repeated=(n=h.repeated)!==null&&n!==void 0?n:!1,h.kind=="scalar"&&(d.L=(s=h.L)!==null&&s!==void 0?s:is.BIGINT),d.delimited=(i=h.delimited)!==null&&i!==void 0?i:!1,d.req=(o=h.req)!==null&&o!==void 0?o:!1,d.opt=(c=h.opt)!==null&&c!==void 0?c:!1,h.packed===void 0&&(d.packed=h.kind=="enum"||h.kind=="scalar"&&h.T!=b.BYTES&&h.T!=b.STRING),h.oneof!==void 0){const p=typeof h.oneof=="string"?h.oneof:h.oneof.name;(!f||f.name!=p)&&(f=new Mp(p)),d.oneof=f,f.addField(d)}u.push(d)}return u}const l=Dp("proto3",r=>new Op(r,e=>Up(e)),r=>{for(const e of r.getType().fields.byMember()){if(e.opt)continue;const t=e.localName,n=r;if(e.repeated){n[t]=[];continue}switch(e.kind){case"oneof":n[t]={case:void 0};break;case"enum":n[t]=0;break;case"map":n[t]={};break;case"scalar":n[t]=Hs(e.T,e.L);break}}});var be;(function(r){r[r.Unary=0]="Unary",r[r.ServerStreaming=1]="ServerStreaming",r[r.ClientStreaming=2]="ClientStreaming",r[r.BiDiStreaming=3]="BiDiStreaming"})(be||(be={}));var Nl;(function(r){r[r.NoSideEffects=1]="NoSideEffects",r[r.Idempotent=2]="Idempotent"})(Nl||(Nl={}));class Ce extends I{constructor(e){super(),this.seconds=Q.zero,this.nanos=0,l.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error(`cannot decode google.protobuf.Timestamp from JSON: ${l.json.debug(e)}`);const n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const s=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(s))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(s<Date.parse("0001-01-01T00:00:00Z")||s>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Q.parse(s/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}toJson(e){const t=Number(this.seconds)*1e3;if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let n="Z";if(this.nanos>0){const s=(this.nanos+1e9).toString().substring(1);s.substring(3)==="000000"?n="."+s.substring(0,3)+"Z":s.substring(6)==="000"?n="."+s.substring(0,6)+"Z":n="."+s+"Z"}return new Date(t).toISOString().replace(".000Z",n)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Ce.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new Ce({seconds:Q.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new Ce().fromBinary(e,t)}static fromJson(e,t){return new Ce().fromJson(e,t)}static fromJsonString(e,t){return new Ce().fromJsonString(e,t)}static equals(e,t){return l.util.equals(Ce,e,t)}}Ce.runtime=l;Ce.typeName="google.protobuf.Timestamp";Ce.fields=l.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);class Jn extends I{constructor(e){super(),this.seconds=Q.zero,this.nanos=0,l.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error(`cannot decode google.protobuf.Duration from JSON: ${l.json.debug(e)}`);const n=e.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(n===null)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${l.json.debug(e)}`);const s=Number(n[1]);if(s>315576e6||s<-315576e6)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${l.json.debug(e)}`);if(this.seconds=Q.parse(s),typeof n[2]=="string"){const i=n[2]+"0".repeat(9-n[2].length);this.nanos=parseInt(i),(s<0||Object.is(s,-0))&&(this.nanos=-this.nanos)}return this}toJson(e){if(Number(this.seconds)>315576e6||Number(this.seconds)<-315576e6)throw new Error("cannot encode google.protobuf.Duration to JSON: value out of range");let t=this.seconds.toString();if(this.nanos!==0){let n=Math.abs(this.nanos).toString();n="0".repeat(9-n.length)+n,n.substring(3)==="000000"?n=n.substring(0,3):n.substring(6)==="000"&&(n=n.substring(0,6)),t+="."+n,this.nanos<0&&Number(this.seconds)==0&&(t="-"+t)}return t+"s"}static fromBinary(e,t){return new Jn().fromBinary(e,t)}static fromJson(e,t){return new Jn().fromJson(e,t)}static fromJsonString(e,t){return new Jn().fromJsonString(e,t)}static equals(e,t){return l.util.equals(Jn,e,t)}}Jn.runtime=l;Jn.typeName="google.protobuf.Duration";Jn.fields=l.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);class zt extends I{constructor(e){super(),this.typeUrl="",this.value=new Uint8Array(0),l.util.initPartial(e,this)}toJson(e){var t;if(this.typeUrl==="")return{};const n=this.typeUrlToName(this.typeUrl),s=(t=e==null?void 0:e.typeRegistry)===null||t===void 0?void 0:t.findMessage(n);if(!s)throw new Error(`cannot encode message google.protobuf.Any to JSON: "${this.typeUrl}" is not in the type registry`);let o=s.fromBinary(this.value).toJson(e);return(n.startsWith("google.protobuf.")||o===null||Array.isArray(o)||typeof o!="object")&&(o={value:o}),o["@type"]=this.typeUrl,o}fromJson(e,t){var n;if(e===null||Array.isArray(e)||typeof e!="object")throw new Error(`cannot decode message google.protobuf.Any from JSON: expected object but got ${e===null?"null":Array.isArray(e)?"array":typeof e}`);if(Object.keys(e).length==0)return this;const s=e["@type"];if(typeof s!="string"||s=="")throw new Error('cannot decode message google.protobuf.Any from JSON: "@type" is empty');const i=this.typeUrlToName(s),o=(n=t==null?void 0:t.typeRegistry)===null||n===void 0?void 0:n.findMessage(i);if(!o)throw new Error(`cannot decode message google.protobuf.Any from JSON: ${s} is not in the type registry`);let c;if(i.startsWith("google.protobuf.")&&Object.prototype.hasOwnProperty.call(e,"value"))c=o.fromJson(e.value,t);else{const u=Object.assign({},e);delete u["@type"],c=o.fromJson(u,t)}return this.packFrom(c),this}packFrom(e){this.value=e.toBinary(),this.typeUrl=this.typeNameToUrl(e.getType().typeName)}unpackTo(e){return this.is(e.getType())?(e.fromBinary(this.value),!0):!1}unpack(e){if(this.typeUrl==="")return;const t=e.findMessage(this.typeUrlToName(this.typeUrl));if(t)return t.fromBinary(this.value)}is(e){if(this.typeUrl==="")return!1;const t=this.typeUrlToName(this.typeUrl);let n="";return typeof e=="string"?n=e:n=e.typeName,t===n}typeNameToUrl(e){return`type.googleapis.com/${e}`}typeUrlToName(e){if(!e.length)throw new Error(`invalid type url: ${e}`);const t=e.lastIndexOf("/"),n=t>=0?e.substring(t+1):e;if(!n.length)throw new Error(`invalid type url: ${e}`);return n}static pack(e){const t=new zt;return t.packFrom(e),t}static fromBinary(e,t){return new zt().fromBinary(e,t)}static fromJson(e,t){return new zt().fromJson(e,t)}static fromJsonString(e,t){return new zt().fromJsonString(e,t)}static equals(e,t){return l.util.equals(zt,e,t)}}zt.runtime=l;zt.typeName="google.protobuf.Any";zt.fields=l.util.newFieldList(()=>[{no:1,name:"type_url",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:12}]);class qt extends I{constructor(e){super(),this.value=0,l.util.initPartial(e,this)}toJson(e){return l.json.writeScalar(b.DOUBLE,this.value,!0)}fromJson(e,t){try{this.value=l.json.readScalar(b.DOUBLE,e)}catch(n){let s='cannot decode message google.protobuf.DoubleValue from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new qt().fromBinary(e,t)}static fromJson(e,t){return new qt().fromJson(e,t)}static fromJsonString(e,t){return new qt().fromJsonString(e,t)}static equals(e,t){return l.util.equals(qt,e,t)}}qt.runtime=l;qt.typeName="google.protobuf.DoubleValue";qt.fields=l.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:1}]);qt.fieldWrapper={wrapField(r){return new qt({value:r})},unwrapField(r){return r.value}};class Kt extends I{constructor(e){super(),this.value=0,l.util.initPartial(e,this)}toJson(e){return l.json.writeScalar(b.FLOAT,this.value,!0)}fromJson(e,t){try{this.value=l.json.readScalar(b.FLOAT,e)}catch(n){let s='cannot decode message google.protobuf.FloatValue from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new Kt().fromBinary(e,t)}static fromJson(e,t){return new Kt().fromJson(e,t)}static fromJsonString(e,t){return new Kt().fromJsonString(e,t)}static equals(e,t){return l.util.equals(Kt,e,t)}}Kt.runtime=l;Kt.typeName="google.protobuf.FloatValue";Kt.fields=l.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:2}]);Kt.fieldWrapper={wrapField(r){return new Kt({value:r})},unwrapField(r){return r.value}};class gt extends I{constructor(e){super(),this.value=Q.zero,l.util.initPartial(e,this)}toJson(e){return l.json.writeScalar(b.INT64,this.value,!0)}fromJson(e,t){try{this.value=l.json.readScalar(b.INT64,e)}catch(n){let s='cannot decode message google.protobuf.Int64Value from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new gt().fromBinary(e,t)}static fromJson(e,t){return new gt().fromJson(e,t)}static fromJsonString(e,t){return new gt().fromJsonString(e,t)}static equals(e,t){return l.util.equals(gt,e,t)}}gt.runtime=l;gt.typeName="google.protobuf.Int64Value";gt.fields=l.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:3}]);gt.fieldWrapper={wrapField(r){return new gt({value:r})},unwrapField(r){return r.value}};class mt extends I{constructor(e){super(),this.value=Q.zero,l.util.initPartial(e,this)}toJson(e){return l.json.writeScalar(b.UINT64,this.value,!0)}fromJson(e,t){try{this.value=l.json.readScalar(b.UINT64,e)}catch(n){let s='cannot decode message google.protobuf.UInt64Value from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new mt().fromBinary(e,t)}static fromJson(e,t){return new mt().fromJson(e,t)}static fromJsonString(e,t){return new mt().fromJsonString(e,t)}static equals(e,t){return l.util.equals(mt,e,t)}}mt.runtime=l;mt.typeName="google.protobuf.UInt64Value";mt.fields=l.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:4}]);mt.fieldWrapper={wrapField(r){return new mt({value:r})},unwrapField(r){return r.value}};class Qe extends I{constructor(e){super(),this.value=0,l.util.initPartial(e,this)}toJson(e){return l.json.writeScalar(b.INT32,this.value,!0)}fromJson(e,t){try{this.value=l.json.readScalar(b.INT32,e)}catch(n){let s='cannot decode message google.protobuf.Int32Value from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new Qe().fromBinary(e,t)}static fromJson(e,t){return new Qe().fromJson(e,t)}static fromJsonString(e,t){return new Qe().fromJsonString(e,t)}static equals(e,t){return l.util.equals(Qe,e,t)}}Qe.runtime=l;Qe.typeName="google.protobuf.Int32Value";Qe.fields=l.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:5}]);Qe.fieldWrapper={wrapField(r){return new Qe({value:r})},unwrapField(r){return r.value}};class Vt extends I{constructor(e){super(),this.value=0,l.util.initPartial(e,this)}toJson(e){return l.json.writeScalar(b.UINT32,this.value,!0)}fromJson(e,t){try{this.value=l.json.readScalar(b.UINT32,e)}catch(n){let s='cannot decode message google.protobuf.UInt32Value from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new Vt().fromBinary(e,t)}static fromJson(e,t){return new Vt().fromJson(e,t)}static fromJsonString(e,t){return new Vt().fromJsonString(e,t)}static equals(e,t){return l.util.equals(Vt,e,t)}}Vt.runtime=l;Vt.typeName="google.protobuf.UInt32Value";Vt.fields=l.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:13}]);Vt.fieldWrapper={wrapField(r){return new Vt({value:r})},unwrapField(r){return r.value}};class pt extends I{constructor(e){super(),this.value=!1,l.util.initPartial(e,this)}toJson(e){return l.json.writeScalar(b.BOOL,this.value,!0)}fromJson(e,t){try{this.value=l.json.readScalar(b.BOOL,e)}catch(n){let s='cannot decode message google.protobuf.BoolValue from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new pt().fromBinary(e,t)}static fromJson(e,t){return new pt().fromJson(e,t)}static fromJsonString(e,t){return new pt().fromJsonString(e,t)}static equals(e,t){return l.util.equals(pt,e,t)}}pt.runtime=l;pt.typeName="google.protobuf.BoolValue";pt.fields=l.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:8}]);pt.fieldWrapper={wrapField(r){return new pt({value:r})},unwrapField(r){return r.value}};class ke extends I{constructor(e){super(),this.value="",l.util.initPartial(e,this)}toJson(e){return l.json.writeScalar(b.STRING,this.value,!0)}fromJson(e,t){try{this.value=l.json.readScalar(b.STRING,e)}catch(n){let s='cannot decode message google.protobuf.StringValue from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new ke().fromBinary(e,t)}static fromJson(e,t){return new ke().fromJson(e,t)}static fromJsonString(e,t){return new ke().fromJsonString(e,t)}static equals(e,t){return l.util.equals(ke,e,t)}}ke.runtime=l;ke.typeName="google.protobuf.StringValue";ke.fields=l.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:9}]);ke.fieldWrapper={wrapField(r){return new ke({value:r})},unwrapField(r){return r.value}};class jt extends I{constructor(e){super(),this.value=new Uint8Array(0),l.util.initPartial(e,this)}toJson(e){return l.json.writeScalar(b.BYTES,this.value,!0)}fromJson(e,t){try{this.value=l.json.readScalar(b.BYTES,e)}catch(n){let s='cannot decode message google.protobuf.BytesValue from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new jt().fromBinary(e,t)}static fromJson(e,t){return new jt().fromJson(e,t)}static fromJsonString(e,t){return new jt().fromJsonString(e,t)}static equals(e,t){return l.util.equals(jt,e,t)}}jt.runtime=l;jt.typeName="google.protobuf.BytesValue";jt.fields=l.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:12}]);jt.fieldWrapper={wrapField(r){return new jt({value:r})},unwrapField(r){return r.value}};function zp(r,e,t){try{const n=hu.dec(r);return e?e.fromBinary(n,t):n}catch(n){throw ce.from(n,X.DataLoss)}}function qp(r,e){const t={};for(const[n,s]of Object.entries(r.methods)){const i=e(Object.assign(Object.assign({},s),{localName:n,service:r}));i!=null&&(t[n]=i)}return t}const Dl=1;function Ol(r){let e,t=new Uint8Array(0);function n(s){const i=new Uint8Array(t.length+s.length);i.set(t),i.set(s,t.length),t=i}return new ReadableStream({start(){e=r.getReader()},async pull(s){let i;for(;;){if(i===void 0&&t.byteLength>=5){let u=0;for(let f=1;f<5;f++)u=(u<<8)+t[f];i={flags:t[0],length:u}}if(i!==void 0&&t.byteLength>=i.length+5)break;const c=await e.read();if(c.done)break;n(c.value)}if(i===void 0){if(t.byteLength==0){s.close();return}s.error(new ce("premature end of stream",X.DataLoss));return}const o=t.subarray(5,5+i.length);t=t.subarray(5+i.length),s.enqueue({flags:i.flags,data:o})}})}function Bl(r,e){const t=new Uint8Array(e.length+5);t.set(e,5);const n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setUint8(0,r),n.setUint32(1,e.length),t}var Kp=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof __values=="function"?__values(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(c,u){o=r[i](o),s(c,u,o.done,o.value)})}}function s(i,o,c,u){Promise.resolve(u).then(function(f){i({value:f,done:c})},o)}},Ji=function(r){return this instanceof Ji?(this.v=r,this):new Ji(r)},Vp=function(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},c("next"),c("throw"),c("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(T){return Promise.resolve(T).then(m,d)}}function c(m,T){n[m]&&(s[m]=function(A){return new Promise(function(N,R){i.push([m,A,N,R])>1||u(m,A)})},T&&(s[m]=T(s[m])))}function u(m,T){try{f(n[m](T))}catch(A){p(i[0][3],A)}}function f(m){m.value instanceof Ji?Promise.resolve(m.value.v).then(h,d):p(i[0][2],m)}function h(m){u("next",m)}function d(m){u("throw",m)}function p(m,T){m(T),i.shift(),i.length&&u(i[0][0],i[0][1])}},jp=function(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:Ji(r[s](o)),done:!1}:i?i(o):o}:i}};function Wp(r){return Vp(this,arguments,function*(){yield Ji(yield*jp(Kp(r)))})}var Bh=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof __values=="function"?__values(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(c,u){o=r[i](o),s(c,u,o.done,o.value)})}}function s(i,o,c,u){Promise.resolve(u).then(function(f){i({value:f,done:c})},o)}},Gs=function(r){return this instanceof Gs?(this.v=r,this):new Gs(r)},Hp=function(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:Gs(r[s](o)),done:!1}:i?i(o):o}:i}},Gp=function(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},c("next"),c("throw"),c("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(T){return Promise.resolve(T).then(m,d)}}function c(m,T){n[m]&&(s[m]=function(A){return new Promise(function(N,R){i.push([m,A,N,R])>1||u(m,A)})},T&&(s[m]=T(s[m])))}function u(m,T){try{f(n[m](T))}catch(A){p(i[0][3],A)}}function f(m){m.value instanceof Gs?Promise.resolve(m.value.v).then(h,d):p(i[0][2],m)}function h(m){u("next",m)}function d(m){u("throw",m)}function p(m,T){m(T),i.shift(),i.length&&u(i[0][0],i[0][1])}};function _p(r,e){return qp(r,t=>{switch(t.kind){case be.Unary:return Yp(e,r,t);case be.ServerStreaming:return Xp(e,r,t);case be.ClientStreaming:return Zp(e,r,t);case be.BiDiStreaming:return Qp(e,r,t);default:return null}})}function Yp(r,e,t){return async function(n,s){var i,o;const c=await r.unary(e,t,s==null?void 0:s.signal,s==null?void 0:s.timeoutMs,s==null?void 0:s.headers,n,s==null?void 0:s.contextValues);return(i=s==null?void 0:s.onHeader)===null||i===void 0||i.call(s,c.header),(o=s==null?void 0:s.onTrailer)===null||o===void 0||o.call(s,c.trailer),c.message}}function Xp(r,e,t){return function(n,s){return Rh(r.stream(e,t,s==null?void 0:s.signal,s==null?void 0:s.timeoutMs,s==null?void 0:s.headers,Wp([n]),s==null?void 0:s.contextValues),s)}}function Zp(r,e,t){return async function(n,s){var i,o,c,u,f,h;const d=await r.stream(e,t,s==null?void 0:s.signal,s==null?void 0:s.timeoutMs,s==null?void 0:s.headers,n,s==null?void 0:s.contextValues);(f=s==null?void 0:s.onHeader)===null||f===void 0||f.call(s,d.header);let p,m=0;try{for(var T=!0,A=Bh(d.message),N;N=await A.next(),i=N.done,!i;T=!0)u=N.value,T=!1,p=u,m++}catch(R){o={error:R}}finally{try{!T&&!i&&(c=A.return)&&await c.call(A)}finally{if(o)throw o.error}}if(!p)throw new ce("protocol error: missing response message",X.Unimplemented);if(m>1)throw new ce("protocol error: received extra messages for client streaming method",X.Unimplemented);return(h=s==null?void 0:s.onTrailer)===null||h===void 0||h.call(s,d.trailer),p}}function Qp(r,e,t){return function(n,s){return Rh(r.stream(e,t,s==null?void 0:s.signal,s==null?void 0:s.timeoutMs,s==null?void 0:s.headers,n,s==null?void 0:s.contextValues),s)}}function Rh(r,e){const t=function(){return Gp(this,arguments,function*(){var n,s;const i=yield Gs(r);(n=e==null?void 0:e.onHeader)===null||n===void 0||n.call(e,i.header),yield Gs(yield*Hp(Bh(i.message))),(s=e==null?void 0:e.onTrailer)===null||s===void 0||s.call(e,i.trailer)})}()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>t.next()})}}function ey(...r){const e=new AbortController,t=r.filter(s=>s!==void 0).concat(e.signal);for(const s of t){if(s.aborted){n.apply(s);break}s.addEventListener("abort",n)}function n(){e.signal.aborted||e.abort(Lh(this));for(const s of t)s.removeEventListener("abort",n)}return e}function ty(r){const e=new AbortController,t=()=>{e.abort(new ce("the operation timed out",X.DeadlineExceeded))};let n;return r!==void 0&&(r<=0?t():n=setTimeout(t,r)),{signal:e.signal,cleanup:()=>clearTimeout(n)}}function Lh(r){if(!r.aborted)return;if(r.reason!==void 0)return r.reason;const e=new Error("This operation was aborted");return e.name="AbortError",e}function Rl(){return{get(r){return r.id in this?this[r.id]:r.defaultValue},set(r,e){return this[r.id]=e,this},delete(r){return delete this[r.id],this}}}const $a=128;function Ll(r){const e=new Headers,t=new TextDecoder().decode(r).split(`\r
`);for(const n of t){if(n==="")continue;const s=n.indexOf(":");if(s>0){const i=n.substring(0,s).trim(),o=n.substring(s+1).trim();e.append(i,o)}}return e}const ry="Content-Type",ny="Grpc-Timeout",_s="Grpc-Status",Jh="Grpc-Message",sy="Grpc-Status-Details-Bin",iy="X-User-Agent",oy="X-Grpc-Web",ay="application/grpc-web+proto",cy="application/grpc-web+json";class $n extends I{constructor(e){super(),this.code=0,this.message="",this.details=[],l.util.initPartial(e,this)}static fromBinary(e,t){return new $n().fromBinary(e,t)}static fromJson(e,t){return new $n().fromJson(e,t)}static fromJsonString(e,t){return new $n().fromJsonString(e,t)}static equals(e,t){return l.util.equals($n,e,t)}}$n.runtime=l;$n.typeName="google.rpc.Status";$n.fields=l.util.newFieldList(()=>[{no:1,name:"code",kind:"scalar",T:5},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"details",kind:"message",T:zt,repeated:!0}]);const uy="0";function $h(r){var e;const t=r.get(sy);if(t!=null){const s=zp(t,$n);if(s.code==0)return;const i=new ce(s.message,s.code,r);return i.details=s.details.map(o=>({type:o.typeUrl.substring(o.typeUrl.lastIndexOf("/")+1),value:o.value})),i}const n=r.get(_s);if(n!=null){if(n===uy)return;const s=parseInt(n,10);return s in X?new ce(decodeURIComponent((e=r.get(Jh))!==null&&e!==void 0?e:""),s,r):new ce(`invalid grpc-status: ${n}`,X.Internal,r)}}function Jl(r,e,t){const n=typeof e=="string"?e:e.typeName,s=typeof t=="string"?t:t.name;return r.toString().replace(/\/?$/,`/${n}/${s}`)}function Fh(r,e){return e instanceof r?e:new r(e)}function ly(r,e){function t(n){return n.done===!0?n:{done:n.done,value:Fh(r,n.value)}}return{[Symbol.asyncIterator](){const n=e[Symbol.asyncIterator](),s={next:()=>n.next().then(t)};return n.throw!==void 0&&(s.throw=i=>n.throw(i).then(t)),n.return!==void 0&&(s.return=i=>n.return(i).then(t)),s}}}function Mh(r,e){var t;return(t=e==null?void 0:e.concat().reverse().reduce((n,s)=>s(n),r))!==null&&t!==void 0?t:r}function fy(r){var e;const t=Object.assign({},r);return(e=t.ignoreUnknownFields)!==null&&e!==void 0||(t.ignoreUnknownFields=!0),t}function $l(r,e,t,n){const s=e?Fl(r.I,n):Ml(r.I,t);return{parse:(e?Fl(r.O,n):Ml(r.O,t)).parse,serialize:s.serialize}}function Fl(r,e){return{parse(t){try{return r.fromBinary(t,e)}catch(n){const s=n instanceof Error?n.message:String(n);throw new ce(`parse binary: ${s}`,X.Internal)}},serialize(t){try{return t.toBinary(e)}catch(n){const s=n instanceof Error?n.message:String(n);throw new ce(`serialize binary: ${s}`,X.Internal)}}}}function Ml(r,e){var t,n;const s=(t=e==null?void 0:e.textEncoder)!==null&&t!==void 0?t:new TextEncoder,i=(n=e==null?void 0:e.textDecoder)!==null&&n!==void 0?n:new TextDecoder,o=fy(e);return{parse(c){try{const u=i.decode(c);return r.fromJsonString(u,o)}catch(u){throw ce.from(u,X.InvalidArgument)}},serialize(c){try{const u=c.toJsonString(o);return s.encode(u)}catch(u){throw ce.from(u,X.Internal)}}}}function hy(r){const e=Mh(r.next,r.interceptors),[t,n,s]=Uh(r),i=Object.assign(Object.assign({},r.req),{message:Fh(r.req.method.I,r.req.message),signal:t});return e(i).then(o=>(s(),o),n)}function dy(r){const e=Mh(r.next,r.interceptors),[t,n,s]=Uh(r),i=Object.assign(Object.assign({},r.req),{message:ly(r.req.method.I,r.req.message),signal:t});let o=!1;return t.addEventListener("abort",function(){var c,u;const f=r.req.message[Symbol.asyncIterator]();o||(c=f.throw)===null||c===void 0||c.call(f,this.reason).catch(()=>{}),(u=f.return)===null||u===void 0||u.call(f).catch(()=>{})}),e(i).then(c=>Object.assign(Object.assign({},c),{message:{[Symbol.asyncIterator](){const u=c.message[Symbol.asyncIterator]();return{next(){return u.next().then(f=>(f.done==!0&&(o=!0,s()),f),n)}}}}}),n)}function Uh(r){const{signal:e,cleanup:t}=ty(r.timeoutMs),n=ey(r.signal,e);return[n.signal,function(i){const o=ce.from(e.aborted?Lh(e):i);return n.abort(o),t(),Promise.reject(o)},function(){t(),n.abort()}]}function gy(){try{new Headers}catch{throw new Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}}function Ul(r,e){const t=$h(r);if(t)throw e.forEach((n,s)=>{t.metadata.append(s,n)}),t;if(!e.has(_s)&&!r.has(_s))throw new ce("protocol error: missing status",X.Internal)}function zl(r,e,t,n){const s=new Headers(t??{});return s.set(ry,r?ay:cy),s.set(oy,"1"),s.set(iy,"connect-es/1.6.1"),e!==void 0&&s.set(ny,`${e}m`),s}function my(r){switch(r){case 400:return X.Internal;case 401:return X.Unauthenticated;case 403:return X.PermissionDenied;case 404:return X.Unimplemented;case 429:return X.Unavailable;case 502:return X.Unavailable;case 503:return X.Unavailable;case 504:return X.Unavailable;default:return X.Unknown}}function ql(r,e){var t;if(r>=200&&r<300)return{foundStatus:e.has(_s),headerError:$h(e)};throw new ce(decodeURIComponent((t=e.get(Jh))!==null&&t!==void 0?t:`HTTP ${r}`),my(r),e)}var ys=function(r){return this instanceof ys?(this.v=r,this):new ys(r)},py=function(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},c("next"),c("throw"),c("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(T){return Promise.resolve(T).then(m,d)}}function c(m,T){n[m]&&(s[m]=function(A){return new Promise(function(N,R){i.push([m,A,N,R])>1||u(m,A)})},T&&(s[m]=T(s[m])))}function u(m,T){try{f(n[m](T))}catch(A){p(i[0][3],A)}}function f(m){m.value instanceof ys?Promise.resolve(m.value.v).then(h,d):p(i[0][2],m)}function h(m){u("next",m)}function d(m){u("throw",m)}function p(m,T){m(T),i.shift(),i.length&&u(i[0][0],i[0][1])}};function yy(r){var e;gy();const t=(e=r.useBinaryFormat)!==null&&e!==void 0?e:!0;return{async unary(n,s,i,o,c,u,f){var h;const{serialize:d,parse:p}=$l(s,t,r.jsonOptions,r.binaryOptions);return o=o===void 0?r.defaultTimeoutMs:o<=0?void 0:o,await hy({interceptors:r.interceptors,signal:i,timeoutMs:o,req:{stream:!1,service:n,method:s,url:Jl(r.baseUrl,n,s),init:{method:"POST",credentials:(h=r.credentials)!==null&&h!==void 0?h:"same-origin",redirect:"error",mode:"cors"},header:zl(t,o,c),contextValues:f??Rl(),message:u},next:async m=>{var T;const N=await((T=r.fetch)!==null&&T!==void 0?T:globalThis.fetch)(m.url,Object.assign(Object.assign({},m.init),{headers:m.header,signal:m.signal,body:Bl(0,d(m.message))})),{headerError:R}=ql(N.status,N.headers);if(!N.body)throw R!==void 0?R:"missing response body";const M=Ol(N.body).getReader();let V,$;for(;;){const Y=await M.read();if(Y.done)break;const{flags:j,data:ee}=Y.value;if((j&Dl)===Dl)throw new ce("protocol error: received unsupported compressed output",X.Internal);if(j===$a){if(V!==void 0)throw"extra trailer";V=Ll(ee);continue}if($!==void 0)throw new ce("extra message",X.Unimplemented);$=p(ee)}if(V===void 0)throw R!==void 0?R:new ce("missing trailer",N.headers.has(_s)?X.Unimplemented:X.Unknown);if(Ul(V,N.headers),$===void 0)throw new ce("missing message",V.has(_s)?X.Unimplemented:X.Unknown);return{stream:!1,service:n,method:s,header:N.headers,message:$,trailer:V}}})},async stream(n,s,i,o,c,u,f){var h;const{serialize:d,parse:p}=$l(s,t,r.jsonOptions,r.binaryOptions);function m(A,N,R,M,V){return py(this,arguments,function*(){const Y=Ol(A).getReader();if(N){if(!(yield ys(Y.read())).done)throw"extra data for trailers-only";return yield ys(void 0)}let j=!1;for(;;){const ee=yield ys(Y.read());if(ee.done)break;const{flags:oe,data:ue}=ee.value;if((oe&$a)===$a){if(j)throw"extra trailer";j=!0;const Ie=Ll(ue);Ul(Ie,M),Ie.forEach((Dt,tr)=>R.set(tr,Dt));continue}if(j)throw"extra message";yield yield ys(p(ue))}if("throwIfAborted"in V&&V.throwIfAborted(),!j)throw"missing trailer"})}async function T(A){if(s.kind!=be.ServerStreaming)throw"The fetch API does not support streaming request bodies";const N=await A[Symbol.asyncIterator]().next();if(N.done==!0)throw"missing request message";return Bl(0,d(N.value))}return o=o===void 0?r.defaultTimeoutMs:o<=0?void 0:o,dy({interceptors:r.interceptors,signal:i,timeoutMs:o,req:{stream:!0,service:n,method:s,url:Jl(r.baseUrl,n,s),init:{method:"POST",credentials:(h=r.credentials)!==null&&h!==void 0?h:"same-origin",redirect:"error",mode:"cors"},header:zl(t,o,c),contextValues:f??Rl(),message:u},next:async A=>{var N;const M=await((N=r.fetch)!==null&&N!==void 0?N:globalThis.fetch)(A.url,Object.assign(Object.assign({},A.init),{headers:A.header,signal:A.signal,body:await T(A.message)})),{foundStatus:V,headerError:$}=ql(M.status,M.headers);if($!=null)throw $;if(!M.body)throw"missing response body";const Y=new Headers;return Object.assign(Object.assign({},A),{header:M.headers,trailer:Y,message:m(M.body,V,Y,M.headers,A.signal)})}})}}}var G=(r=>(r[r.NULL=0]="NULL",r[r.BOOLEAN=1]="BOOLEAN",r[r.INTEGER=2]="INTEGER",r[r.LONG=3]="LONG",r[r.DOUBLE=4]="DOUBLE",r[r.STRING=5]="STRING",r[r.BYTES=6]="BYTES",r[r.DATE=7]="DATE",r[r.JSON_OBJECT=8]="JSON_OBJECT",r[r.JSON_ARRAY=9]="JSON_ARRAY",r[r.TEXT=10]="TEXT",r[r.INTEGER_CNT=11]="INTEGER_CNT",r[r.LONG_CNT=12]="LONG_CNT",r[r.TREE=13]="TREE",r))(G||{});l.util.setEnumType(G,"yorkie.v1.ValueType",[{no:0,name:"VALUE_TYPE_NULL"},{no:1,name:"VALUE_TYPE_BOOLEAN"},{no:2,name:"VALUE_TYPE_INTEGER"},{no:3,name:"VALUE_TYPE_LONG"},{no:4,name:"VALUE_TYPE_DOUBLE"},{no:5,name:"VALUE_TYPE_STRING"},{no:6,name:"VALUE_TYPE_BYTES"},{no:7,name:"VALUE_TYPE_DATE"},{no:8,name:"VALUE_TYPE_JSON_OBJECT"},{no:9,name:"VALUE_TYPE_JSON_ARRAY"},{no:10,name:"VALUE_TYPE_TEXT"},{no:11,name:"VALUE_TYPE_INTEGER_CNT"},{no:12,name:"VALUE_TYPE_LONG_CNT"},{no:13,name:"VALUE_TYPE_TREE"}]);var Ys=(r=>(r[r.DOCUMENT_CHANGED=0]="DOCUMENT_CHANGED",r[r.DOCUMENT_WATCHED=1]="DOCUMENT_WATCHED",r[r.DOCUMENT_UNWATCHED=2]="DOCUMENT_UNWATCHED",r[r.DOCUMENT_BROADCAST=3]="DOCUMENT_BROADCAST",r))(Ys||{});l.util.setEnumType(Ys,"yorkie.v1.DocEventType",[{no:0,name:"DOC_EVENT_TYPE_DOCUMENT_CHANGED"},{no:1,name:"DOC_EVENT_TYPE_DOCUMENT_WATCHED"},{no:2,name:"DOC_EVENT_TYPE_DOCUMENT_UNWATCHED"},{no:3,name:"DOC_EVENT_TYPE_DOCUMENT_BROADCAST"}]);const ar=class ar extends I{constructor(t){super();a(this,"root");a(this,"presences",{});l.util.initPartial(t,this)}static fromBinary(t,n){return new ar().fromBinary(t,n)}static fromJson(t,n){return new ar().fromJson(t,n)}static fromJsonString(t,n){return new ar().fromJsonString(t,n)}static equals(t,n){return l.util.equals(ar,t,n)}};a(ar,"runtime",l),a(ar,"typeName","yorkie.v1.Snapshot"),a(ar,"fields",l.util.newFieldList(()=>[{no:1,name:"root",kind:"message",T:_e},{no:2,name:"presences",kind:"map",K:9,V:{kind:"message",T:Zs}}]));let tc=ar;var it;let Wn=(it=class extends I{constructor(t){super();a(this,"documentKey","");a(this,"checkpoint");a(this,"snapshot",new Uint8Array(0));a(this,"changes",[]);a(this,"minSyncedTicket");a(this,"isRemoved",!1);a(this,"versionVector");l.util.initPartial(t,this)}static fromBinary(t,n){return new it().fromBinary(t,n)}static fromJson(t,n){return new it().fromJson(t,n)}static fromJsonString(t,n){return new it().fromJsonString(t,n)}static equals(t,n){return l.util.equals(it,t,n)}},a(it,"runtime",l),a(it,"typeName","yorkie.v1.ChangePack"),a(it,"fields",l.util.newFieldList(()=>[{no:1,name:"document_key",kind:"scalar",T:9},{no:2,name:"checkpoint",kind:"message",T:Kh},{no:3,name:"snapshot",kind:"scalar",T:12},{no:4,name:"changes",kind:"message",T:zh,repeated:!0},{no:5,name:"min_synced_ticket",kind:"message",T:F},{no:6,name:"is_removed",kind:"scalar",T:8},{no:7,name:"version_vector",kind:"message",T:ga}])),it);var ot;let zh=(ot=class extends I{constructor(t){super();a(this,"id");a(this,"message","");a(this,"operations",[]);a(this,"presenceChange");l.util.initPartial(t,this)}static fromBinary(t,n){return new ot().fromBinary(t,n)}static fromJson(t,n){return new ot().fromJson(t,n)}static fromJsonString(t,n){return new ot().fromJsonString(t,n)}static equals(t,n){return l.util.equals(ot,t,n)}},a(ot,"runtime",l),a(ot,"typeName","yorkie.v1.Change"),a(ot,"fields",l.util.newFieldList(()=>[{no:1,name:"id",kind:"message",T:da},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"operations",kind:"message",T:du,repeated:!0},{no:4,name:"presence_change",kind:"message",T:Mi}])),ot);var at;let da=(at=class extends I{constructor(t){super();a(this,"clientSeq",0);a(this,"serverSeq",Q.zero);a(this,"lamport",Q.zero);a(this,"actorId",new Uint8Array(0));a(this,"versionVector");l.util.initPartial(t,this)}static fromBinary(t,n){return new at().fromBinary(t,n)}static fromJson(t,n){return new at().fromJson(t,n)}static fromJsonString(t,n){return new at().fromJsonString(t,n)}static equals(t,n){return l.util.equals(at,t,n)}},a(at,"runtime",l),a(at,"typeName","yorkie.v1.ChangeID"),a(at,"fields",l.util.newFieldList(()=>[{no:1,name:"client_seq",kind:"scalar",T:13},{no:2,name:"server_seq",kind:"scalar",T:3},{no:3,name:"lamport",kind:"scalar",T:3},{no:4,name:"actor_id",kind:"scalar",T:12},{no:5,name:"version_vector",kind:"message",T:ga}])),at);var ct;let ga=(ct=class extends I{constructor(t){super();a(this,"vector",{});l.util.initPartial(t,this)}static fromBinary(t,n){return new ct().fromBinary(t,n)}static fromJson(t,n){return new ct().fromJson(t,n)}static fromJsonString(t,n){return new ct().fromJsonString(t,n)}static equals(t,n){return l.util.equals(ct,t,n)}},a(ct,"runtime",l),a(ct,"typeName","yorkie.v1.VersionVector"),a(ct,"fields",l.util.newFieldList(()=>[{no:1,name:"vector",kind:"map",K:9,V:{kind:"scalar",T:3}}])),ct);var ut;let du=(ut=class extends I{constructor(t){super();a(this,"body",{case:void 0});l.util.initPartial(t,this)}static fromBinary(t,n){return new ut().fromBinary(t,n)}static fromJson(t,n){return new ut().fromJson(t,n)}static fromJsonString(t,n){return new ut().fromJsonString(t,n)}static equals(t,n){return l.util.equals(ut,t,n)}},a(ut,"runtime",l),a(ut,"typeName","yorkie.v1.Operation"),a(ut,"fields",l.util.newFieldList(()=>[{no:1,name:"set",kind:"message",T:No,oneof:"body"},{no:2,name:"add",kind:"message",T:Do,oneof:"body"},{no:3,name:"move",kind:"message",T:Oo,oneof:"body"},{no:4,name:"remove",kind:"message",T:Bo,oneof:"body"},{no:5,name:"edit",kind:"message",T:Ro,oneof:"body"},{no:7,name:"style",kind:"message",T:Lo,oneof:"body"},{no:8,name:"increase",kind:"message",T:Jo,oneof:"body"},{no:9,name:"tree_edit",kind:"message",T:$o,oneof:"body"},{no:10,name:"tree_style",kind:"message",T:Fo,oneof:"body"},{no:11,name:"array_set",kind:"message",T:Mo,oneof:"body"}])),ut);const cr=class cr extends I{constructor(t){super();a(this,"parentCreatedAt");a(this,"key","");a(this,"value");a(this,"executedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new cr().fromBinary(t,n)}static fromJson(t,n){return new cr().fromJson(t,n)}static fromJsonString(t,n){return new cr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(cr,t,n)}};a(cr,"runtime",l),a(cr,"typeName","yorkie.v1.Operation.Set"),a(cr,"fields",l.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"value",kind:"message",T:st},{no:4,name:"executed_at",kind:"message",T:F}]));let No=cr;const ur=class ur extends I{constructor(t){super();a(this,"parentCreatedAt");a(this,"prevCreatedAt");a(this,"value");a(this,"executedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new ur().fromBinary(t,n)}static fromJson(t,n){return new ur().fromJson(t,n)}static fromJsonString(t,n){return new ur().fromJsonString(t,n)}static equals(t,n){return l.util.equals(ur,t,n)}};a(ur,"runtime",l),a(ur,"typeName","yorkie.v1.Operation.Add"),a(ur,"fields",l.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"prev_created_at",kind:"message",T:F},{no:3,name:"value",kind:"message",T:st},{no:4,name:"executed_at",kind:"message",T:F}]));let Do=ur;const lr=class lr extends I{constructor(t){super();a(this,"parentCreatedAt");a(this,"prevCreatedAt");a(this,"createdAt");a(this,"executedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new lr().fromBinary(t,n)}static fromJson(t,n){return new lr().fromJson(t,n)}static fromJsonString(t,n){return new lr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(lr,t,n)}};a(lr,"runtime",l),a(lr,"typeName","yorkie.v1.Operation.Move"),a(lr,"fields",l.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"prev_created_at",kind:"message",T:F},{no:3,name:"created_at",kind:"message",T:F},{no:4,name:"executed_at",kind:"message",T:F}]));let Oo=lr;const fr=class fr extends I{constructor(t){super();a(this,"parentCreatedAt");a(this,"createdAt");a(this,"executedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new fr().fromBinary(t,n)}static fromJson(t,n){return new fr().fromJson(t,n)}static fromJsonString(t,n){return new fr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(fr,t,n)}};a(fr,"runtime",l),a(fr,"typeName","yorkie.v1.Operation.Remove"),a(fr,"fields",l.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"created_at",kind:"message",T:F},{no:3,name:"executed_at",kind:"message",T:F}]));let Bo=fr;const hr=class hr extends I{constructor(t){super();a(this,"parentCreatedAt");a(this,"from");a(this,"to");a(this,"createdAtMapByActor",{});a(this,"content","");a(this,"executedAt");a(this,"attributes",{});l.util.initPartial(t,this)}static fromBinary(t,n){return new hr().fromBinary(t,n)}static fromJson(t,n){return new hr().fromJson(t,n)}static fromJsonString(t,n){return new hr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(hr,t,n)}};a(hr,"runtime",l),a(hr,"typeName","yorkie.v1.Operation.Edit"),a(hr,"fields",l.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"from",kind:"message",T:ks},{no:3,name:"to",kind:"message",T:ks},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:F}},{no:5,name:"content",kind:"scalar",T:9},{no:6,name:"executed_at",kind:"message",T:F},{no:7,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}]));let Ro=hr;const dr=class dr extends I{constructor(t){super();a(this,"parentCreatedAt");a(this,"from");a(this,"to");a(this,"attributes",{});a(this,"executedAt");a(this,"createdAtMapByActor",{});l.util.initPartial(t,this)}static fromBinary(t,n){return new dr().fromBinary(t,n)}static fromJson(t,n){return new dr().fromJson(t,n)}static fromJsonString(t,n){return new dr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(dr,t,n)}};a(dr,"runtime",l),a(dr,"typeName","yorkie.v1.Operation.Style"),a(dr,"fields",l.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"from",kind:"message",T:ks},{no:3,name:"to",kind:"message",T:ks},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:F},{no:6,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:F}}]));let Lo=dr;const gr=class gr extends I{constructor(t){super();a(this,"parentCreatedAt");a(this,"value");a(this,"executedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new gr().fromBinary(t,n)}static fromJson(t,n){return new gr().fromJson(t,n)}static fromJsonString(t,n){return new gr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(gr,t,n)}};a(gr,"runtime",l),a(gr,"typeName","yorkie.v1.Operation.Increase"),a(gr,"fields",l.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"value",kind:"message",T:st},{no:3,name:"executed_at",kind:"message",T:F}]));let Jo=gr;const mr=class mr extends I{constructor(t){super();a(this,"parentCreatedAt");a(this,"from");a(this,"to");a(this,"createdAtMapByActor",{});a(this,"contents",[]);a(this,"splitLevel",0);a(this,"executedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new mr().fromBinary(t,n)}static fromJson(t,n){return new mr().fromJson(t,n)}static fromJsonString(t,n){return new mr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(mr,t,n)}};a(mr,"runtime",l),a(mr,"typeName","yorkie.v1.Operation.TreeEdit"),a(mr,"fields",l.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"from",kind:"message",T:As},{no:3,name:"to",kind:"message",T:As},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:F}},{no:5,name:"contents",kind:"message",T:Go,repeated:!0},{no:7,name:"split_level",kind:"scalar",T:5},{no:6,name:"executed_at",kind:"message",T:F}]));let $o=mr;const pr=class pr extends I{constructor(t){super();a(this,"parentCreatedAt");a(this,"from");a(this,"to");a(this,"attributes",{});a(this,"executedAt");a(this,"attributesToRemove",[]);a(this,"createdAtMapByActor",{});l.util.initPartial(t,this)}static fromBinary(t,n){return new pr().fromBinary(t,n)}static fromJson(t,n){return new pr().fromJson(t,n)}static fromJsonString(t,n){return new pr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(pr,t,n)}};a(pr,"runtime",l),a(pr,"typeName","yorkie.v1.Operation.TreeStyle"),a(pr,"fields",l.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"from",kind:"message",T:As},{no:3,name:"to",kind:"message",T:As},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:F},{no:6,name:"attributes_to_remove",kind:"scalar",T:9,repeated:!0},{no:7,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:F}}]));let Fo=pr;const yr=class yr extends I{constructor(t){super();a(this,"parentCreatedAt");a(this,"createdAt");a(this,"value");a(this,"executedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new yr().fromBinary(t,n)}static fromJson(t,n){return new yr().fromJson(t,n)}static fromJsonString(t,n){return new yr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(yr,t,n)}};a(yr,"runtime",l),a(yr,"typeName","yorkie.v1.Operation.ArraySet"),a(yr,"fields",l.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"created_at",kind:"message",T:F},{no:3,name:"value",kind:"message",T:st},{no:4,name:"executed_at",kind:"message",T:F}]));let Mo=yr;const vr=class vr extends I{constructor(t){super();a(this,"createdAt");a(this,"movedAt");a(this,"removedAt");a(this,"type",0);a(this,"value",new Uint8Array(0));l.util.initPartial(t,this)}static fromBinary(t,n){return new vr().fromBinary(t,n)}static fromJson(t,n){return new vr().fromJson(t,n)}static fromJsonString(t,n){return new vr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(vr,t,n)}};a(vr,"runtime",l),a(vr,"typeName","yorkie.v1.JSONElementSimple"),a(vr,"fields",l.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:F},{no:2,name:"moved_at",kind:"message",T:F},{no:3,name:"removed_at",kind:"message",T:F},{no:4,name:"type",kind:"enum",T:l.getEnumType(G)},{no:5,name:"value",kind:"scalar",T:12}]));let st=vr;const wr=class wr extends I{constructor(t){super();a(this,"body",{case:void 0});l.util.initPartial(t,this)}static fromBinary(t,n){return new wr().fromBinary(t,n)}static fromJson(t,n){return new wr().fromJson(t,n)}static fromJsonString(t,n){return new wr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(wr,t,n)}};a(wr,"runtime",l),a(wr,"typeName","yorkie.v1.JSONElement"),a(wr,"fields",l.util.newFieldList(()=>[{no:1,name:"json_object",kind:"message",T:Uo,oneof:"body"},{no:2,name:"json_array",kind:"message",T:zo,oneof:"body"},{no:3,name:"primitive",kind:"message",T:qo,oneof:"body"},{no:5,name:"text",kind:"message",T:Ko,oneof:"body"},{no:6,name:"counter",kind:"message",T:Vo,oneof:"body"},{no:7,name:"tree",kind:"message",T:jo,oneof:"body"}]));let _e=wr;const br=class br extends I{constructor(t){super();a(this,"nodes",[]);a(this,"createdAt");a(this,"movedAt");a(this,"removedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new br().fromBinary(t,n)}static fromJson(t,n){return new br().fromJson(t,n)}static fromJsonString(t,n){return new br().fromJsonString(t,n)}static equals(t,n){return l.util.equals(br,t,n)}};a(br,"runtime",l),a(br,"typeName","yorkie.v1.JSONElement.JSONObject"),a(br,"fields",l.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:qh,repeated:!0},{no:2,name:"created_at",kind:"message",T:F},{no:3,name:"moved_at",kind:"message",T:F},{no:4,name:"removed_at",kind:"message",T:F}]));let Uo=br;const Sr=class Sr extends I{constructor(t){super();a(this,"nodes",[]);a(this,"createdAt");a(this,"movedAt");a(this,"removedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new Sr().fromBinary(t,n)}static fromJson(t,n){return new Sr().fromJson(t,n)}static fromJsonString(t,n){return new Sr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Sr,t,n)}};a(Sr,"runtime",l),a(Sr,"typeName","yorkie.v1.JSONElement.JSONArray"),a(Sr,"fields",l.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:Wo,repeated:!0},{no:2,name:"created_at",kind:"message",T:F},{no:3,name:"moved_at",kind:"message",T:F},{no:4,name:"removed_at",kind:"message",T:F}]));let zo=Sr;const Tr=class Tr extends I{constructor(t){super();a(this,"type",0);a(this,"value",new Uint8Array(0));a(this,"createdAt");a(this,"movedAt");a(this,"removedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new Tr().fromBinary(t,n)}static fromJson(t,n){return new Tr().fromJson(t,n)}static fromJsonString(t,n){return new Tr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Tr,t,n)}};a(Tr,"runtime",l),a(Tr,"typeName","yorkie.v1.JSONElement.Primitive"),a(Tr,"fields",l.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:l.getEnumType(G)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:F},{no:4,name:"moved_at",kind:"message",T:F},{no:5,name:"removed_at",kind:"message",T:F}]));let qo=Tr;const Ar=class Ar extends I{constructor(t){super();a(this,"nodes",[]);a(this,"createdAt");a(this,"movedAt");a(this,"removedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new Ar().fromBinary(t,n)}static fromJson(t,n){return new Ar().fromJson(t,n)}static fromJsonString(t,n){return new Ar().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Ar,t,n)}};a(Ar,"runtime",l),a(Ar,"typeName","yorkie.v1.JSONElement.Text"),a(Ar,"fields",l.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:Ho,repeated:!0},{no:2,name:"created_at",kind:"message",T:F},{no:3,name:"moved_at",kind:"message",T:F},{no:4,name:"removed_at",kind:"message",T:F}]));let Ko=Ar;const Ir=class Ir extends I{constructor(t){super();a(this,"type",0);a(this,"value",new Uint8Array(0));a(this,"createdAt");a(this,"movedAt");a(this,"removedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new Ir().fromBinary(t,n)}static fromJson(t,n){return new Ir().fromJson(t,n)}static fromJsonString(t,n){return new Ir().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Ir,t,n)}};a(Ir,"runtime",l),a(Ir,"typeName","yorkie.v1.JSONElement.Counter"),a(Ir,"fields",l.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:l.getEnumType(G)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:F},{no:4,name:"moved_at",kind:"message",T:F},{no:5,name:"removed_at",kind:"message",T:F}]));let Vo=Ir;const kr=class kr extends I{constructor(t){super();a(this,"nodes",[]);a(this,"createdAt");a(this,"movedAt");a(this,"removedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new kr().fromBinary(t,n)}static fromJson(t,n){return new kr().fromJson(t,n)}static fromJsonString(t,n){return new kr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(kr,t,n)}};a(kr,"runtime",l),a(kr,"typeName","yorkie.v1.JSONElement.Tree"),a(kr,"fields",l.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:Fi,repeated:!0},{no:2,name:"created_at",kind:"message",T:F},{no:3,name:"moved_at",kind:"message",T:F},{no:4,name:"removed_at",kind:"message",T:F}]));let jo=kr;var lt;let qh=(lt=class extends I{constructor(t){super();a(this,"key","");a(this,"element");l.util.initPartial(t,this)}static fromBinary(t,n){return new lt().fromBinary(t,n)}static fromJson(t,n){return new lt().fromJson(t,n)}static fromJsonString(t,n){return new lt().fromJsonString(t,n)}static equals(t,n){return l.util.equals(lt,t,n)}},a(lt,"runtime",l),a(lt,"typeName","yorkie.v1.RHTNode"),a(lt,"fields",l.util.newFieldList(()=>[{no:1,name:"key",kind:"scalar",T:9},{no:2,name:"element",kind:"message",T:_e}])),lt);const Ft=class Ft extends I{constructor(t){super();a(this,"next");a(this,"element");l.util.initPartial(t,this)}static fromBinary(t,n){return new Ft().fromBinary(t,n)}static fromJson(t,n){return new Ft().fromJson(t,n)}static fromJsonString(t,n){return new Ft().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Ft,t,n)}};a(Ft,"runtime",l),a(Ft,"typeName","yorkie.v1.RGANode"),a(Ft,"fields",l.util.newFieldList(()=>[{no:1,name:"next",kind:"message",T:Ft},{no:2,name:"element",kind:"message",T:_e}]));let Wo=Ft;const xr=class xr extends I{constructor(t){super();a(this,"value","");a(this,"updatedAt");a(this,"isRemoved",!1);l.util.initPartial(t,this)}static fromBinary(t,n){return new xr().fromBinary(t,n)}static fromJson(t,n){return new xr().fromJson(t,n)}static fromJsonString(t,n){return new xr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(xr,t,n)}};a(xr,"runtime",l),a(xr,"typeName","yorkie.v1.NodeAttr"),a(xr,"fields",l.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:9},{no:2,name:"updated_at",kind:"message",T:F},{no:3,name:"is_removed",kind:"scalar",T:8}]));let Xs=xr;const Er=class Er extends I{constructor(t){super();a(this,"id");a(this,"value","");a(this,"removedAt");a(this,"insPrevId");a(this,"attributes",{});l.util.initPartial(t,this)}static fromBinary(t,n){return new Er().fromBinary(t,n)}static fromJson(t,n){return new Er().fromJson(t,n)}static fromJsonString(t,n){return new Er().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Er,t,n)}};a(Er,"runtime",l),a(Er,"typeName","yorkie.v1.TextNode"),a(Er,"fields",l.util.newFieldList(()=>[{no:1,name:"id",kind:"message",T:$i},{no:2,name:"value",kind:"scalar",T:9},{no:3,name:"removed_at",kind:"message",T:F},{no:4,name:"ins_prev_id",kind:"message",T:$i},{no:5,name:"attributes",kind:"map",K:9,V:{kind:"message",T:Xs}}]));let Ho=Er;const Cr=class Cr extends I{constructor(t){super();a(this,"createdAt");a(this,"offset",0);l.util.initPartial(t,this)}static fromBinary(t,n){return new Cr().fromBinary(t,n)}static fromJson(t,n){return new Cr().fromJson(t,n)}static fromJsonString(t,n){return new Cr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Cr,t,n)}};a(Cr,"runtime",l),a(Cr,"typeName","yorkie.v1.TextNodeID"),a(Cr,"fields",l.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:F},{no:2,name:"offset",kind:"scalar",T:5}]));let $i=Cr;const Pr=class Pr extends I{constructor(t){super();a(this,"id");a(this,"type","");a(this,"value","");a(this,"removedAt");a(this,"insPrevId");a(this,"insNextId");a(this,"depth",0);a(this,"attributes",{});l.util.initPartial(t,this)}static fromBinary(t,n){return new Pr().fromBinary(t,n)}static fromJson(t,n){return new Pr().fromJson(t,n)}static fromJsonString(t,n){return new Pr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Pr,t,n)}};a(Pr,"runtime",l),a(Pr,"typeName","yorkie.v1.TreeNode"),a(Pr,"fields",l.util.newFieldList(()=>[{no:1,name:"id",kind:"message",T:ts},{no:2,name:"type",kind:"scalar",T:9},{no:3,name:"value",kind:"scalar",T:9},{no:4,name:"removed_at",kind:"message",T:F},{no:5,name:"ins_prev_id",kind:"message",T:ts},{no:6,name:"ins_next_id",kind:"message",T:ts},{no:7,name:"depth",kind:"scalar",T:5},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"message",T:Xs}}]));let Fi=Pr;const Nr=class Nr extends I{constructor(t){super();a(this,"content",[]);l.util.initPartial(t,this)}static fromBinary(t,n){return new Nr().fromBinary(t,n)}static fromJson(t,n){return new Nr().fromJson(t,n)}static fromJsonString(t,n){return new Nr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Nr,t,n)}};a(Nr,"runtime",l),a(Nr,"typeName","yorkie.v1.TreeNodes"),a(Nr,"fields",l.util.newFieldList(()=>[{no:1,name:"content",kind:"message",T:Fi,repeated:!0}]));let Go=Nr;const Dr=class Dr extends I{constructor(t){super();a(this,"createdAt");a(this,"offset",0);l.util.initPartial(t,this)}static fromBinary(t,n){return new Dr().fromBinary(t,n)}static fromJson(t,n){return new Dr().fromJson(t,n)}static fromJsonString(t,n){return new Dr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Dr,t,n)}};a(Dr,"runtime",l),a(Dr,"typeName","yorkie.v1.TreeNodeID"),a(Dr,"fields",l.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:F},{no:2,name:"offset",kind:"scalar",T:5}]));let ts=Dr;const Or=class Or extends I{constructor(t){super();a(this,"parentId");a(this,"leftSiblingId");l.util.initPartial(t,this)}static fromBinary(t,n){return new Or().fromBinary(t,n)}static fromJson(t,n){return new Or().fromJson(t,n)}static fromJsonString(t,n){return new Or().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Or,t,n)}};a(Or,"runtime",l),a(Or,"typeName","yorkie.v1.TreePos"),a(Or,"fields",l.util.newFieldList(()=>[{no:1,name:"parent_id",kind:"message",T:ts},{no:2,name:"left_sibling_id",kind:"message",T:ts}]));let As=Or;const Br=class Br extends I{constructor(t){super();a(this,"id","");a(this,"authProvider","");a(this,"username","");a(this,"createdAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new Br().fromBinary(t,n)}static fromJson(t,n){return new Br().fromJson(t,n)}static fromJsonString(t,n){return new Br().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Br,t,n)}};a(Br,"runtime",l),a(Br,"typeName","yorkie.v1.User"),a(Br,"fields",l.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"auth_provider",kind:"scalar",T:9},{no:3,name:"username",kind:"scalar",T:9},{no:4,name:"created_at",kind:"message",T:Ce}]));let Kl=Br;const Rr=class Rr extends I{constructor(t){super();a(this,"id","");a(this,"name","");a(this,"publicKey","");a(this,"secretKey","");a(this,"authWebhookUrl","");a(this,"authWebhookMethods",[]);a(this,"authWebhookMaxRetries",Q.zero);a(this,"authWebhookMinWaitInterval","");a(this,"authWebhookMaxWaitInterval","");a(this,"authWebhookRequestTimeout","");a(this,"eventWebhookUrl","");a(this,"eventWebhookEvents",[]);a(this,"eventWebhookMaxRetries",Q.zero);a(this,"eventWebhookMinWaitInterval","");a(this,"eventWebhookMaxWaitInterval","");a(this,"eventWebhookRequestTimeout","");a(this,"clientDeactivateThreshold","");a(this,"snapshotThreshold",Q.zero);a(this,"snapshotInterval",Q.zero);a(this,"maxSubscribersPerDocument",0);a(this,"maxAttachmentsPerDocument",0);a(this,"maxSizePerDocument",0);a(this,"removeOnDetach",!1);a(this,"autoRevisionEnabled",!1);a(this,"allowedOrigins",[]);a(this,"createdAt");a(this,"updatedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new Rr().fromBinary(t,n)}static fromJson(t,n){return new Rr().fromJson(t,n)}static fromJsonString(t,n){return new Rr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Rr,t,n)}};a(Rr,"runtime",l),a(Rr,"typeName","yorkie.v1.Project"),a(Rr,"fields",l.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"public_key",kind:"scalar",T:9},{no:4,name:"secret_key",kind:"scalar",T:9},{no:5,name:"auth_webhook_url",kind:"scalar",T:9},{no:6,name:"auth_webhook_methods",kind:"scalar",T:9,repeated:!0},{no:17,name:"auth_webhook_max_retries",kind:"scalar",T:4},{no:18,name:"auth_webhook_min_wait_interval",kind:"scalar",T:9},{no:19,name:"auth_webhook_max_wait_interval",kind:"scalar",T:9},{no:20,name:"auth_webhook_request_timeout",kind:"scalar",T:9},{no:7,name:"event_webhook_url",kind:"scalar",T:9},{no:8,name:"event_webhook_events",kind:"scalar",T:9,repeated:!0},{no:21,name:"event_webhook_max_retries",kind:"scalar",T:4},{no:22,name:"event_webhook_min_wait_interval",kind:"scalar",T:9},{no:23,name:"event_webhook_max_wait_interval",kind:"scalar",T:9},{no:24,name:"event_webhook_request_timeout",kind:"scalar",T:9},{no:9,name:"client_deactivate_threshold",kind:"scalar",T:9},{no:25,name:"snapshot_threshold",kind:"scalar",T:3},{no:26,name:"snapshot_interval",kind:"scalar",T:3},{no:10,name:"max_subscribers_per_document",kind:"scalar",T:5},{no:11,name:"max_attachments_per_document",kind:"scalar",T:5},{no:15,name:"max_size_per_document",kind:"scalar",T:5},{no:16,name:"remove_on_detach",kind:"scalar",T:8},{no:27,name:"auto_revision_enabled",kind:"scalar",T:8},{no:14,name:"allowed_origins",kind:"scalar",T:9,repeated:!0},{no:12,name:"created_at",kind:"message",T:Ce},{no:13,name:"updated_at",kind:"message",T:Ce}]));let Vl=Rr;const Lr=class Lr extends I{constructor(t){super();a(this,"timestamp",Q.zero);a(this,"value",0);l.util.initPartial(t,this)}static fromBinary(t,n){return new Lr().fromBinary(t,n)}static fromJson(t,n){return new Lr().fromJson(t,n)}static fromJsonString(t,n){return new Lr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Lr,t,n)}};a(Lr,"runtime",l),a(Lr,"typeName","yorkie.v1.MetricPoint"),a(Lr,"fields",l.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"value",kind:"scalar",T:5}]));let jl=Lr;const Jr=class Jr extends I{constructor(t){super();a(this,"name");a(this,"authWebhookUrl");a(this,"authWebhookMethods");a(this,"authWebhookMaxRetries");a(this,"authWebhookMinWaitInterval");a(this,"authWebhookMaxWaitInterval");a(this,"authWebhookRequestTimeout");a(this,"eventWebhookUrl");a(this,"eventWebhookEvents");a(this,"eventWebhookMaxRetries");a(this,"eventWebhookMinWaitInterval");a(this,"eventWebhookMaxWaitInterval");a(this,"eventWebhookRequestTimeout");a(this,"snapshotThreshold");a(this,"snapshotInterval");a(this,"clientDeactivateThreshold");a(this,"maxSubscribersPerDocument");a(this,"maxAttachmentsPerDocument");a(this,"maxSizePerDocument");a(this,"removeOnDetach");a(this,"autoRevisionEnabled");a(this,"allowedOrigins");l.util.initPartial(t,this)}static fromBinary(t,n){return new Jr().fromBinary(t,n)}static fromJson(t,n){return new Jr().fromJson(t,n)}static fromJsonString(t,n){return new Jr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Jr,t,n)}};a(Jr,"runtime",l),a(Jr,"typeName","yorkie.v1.UpdatableProjectFields"),a(Jr,"fields",l.util.newFieldList(()=>[{no:1,name:"name",kind:"message",T:ke},{no:2,name:"auth_webhook_url",kind:"message",T:ke},{no:3,name:"auth_webhook_methods",kind:"message",T:rc},{no:12,name:"auth_webhook_max_retries",kind:"message",T:mt},{no:13,name:"auth_webhook_min_wait_interval",kind:"message",T:ke},{no:14,name:"auth_webhook_max_wait_interval",kind:"message",T:ke},{no:15,name:"auth_webhook_request_timeout",kind:"message",T:ke},{no:4,name:"event_webhook_url",kind:"message",T:ke},{no:5,name:"event_webhook_events",kind:"message",T:nc},{no:16,name:"event_webhook_max_retries",kind:"message",T:mt},{no:17,name:"event_webhook_min_wait_interval",kind:"message",T:ke},{no:18,name:"event_webhook_max_wait_interval",kind:"message",T:ke},{no:19,name:"event_webhook_request_timeout",kind:"message",T:ke},{no:20,name:"snapshot_threshold",kind:"message",T:gt},{no:21,name:"snapshot_interval",kind:"message",T:gt},{no:6,name:"client_deactivate_threshold",kind:"message",T:ke},{no:7,name:"max_subscribers_per_document",kind:"message",T:Qe},{no:8,name:"max_attachments_per_document",kind:"message",T:Qe},{no:10,name:"max_size_per_document",kind:"message",T:Qe},{no:11,name:"remove_on_detach",kind:"message",T:pt},{no:22,name:"auto_revision_enabled",kind:"message",T:pt},{no:9,name:"allowed_origins",kind:"message",T:sc}]));let Wl=Jr;const $r=class $r extends I{constructor(t){super();a(this,"methods",[]);l.util.initPartial(t,this)}static fromBinary(t,n){return new $r().fromBinary(t,n)}static fromJson(t,n){return new $r().fromJson(t,n)}static fromJsonString(t,n){return new $r().fromJsonString(t,n)}static equals(t,n){return l.util.equals($r,t,n)}};a($r,"runtime",l),a($r,"typeName","yorkie.v1.UpdatableProjectFields.AuthWebhookMethods"),a($r,"fields",l.util.newFieldList(()=>[{no:1,name:"methods",kind:"scalar",T:9,repeated:!0}]));let rc=$r;const Fr=class Fr extends I{constructor(t){super();a(this,"events",[]);l.util.initPartial(t,this)}static fromBinary(t,n){return new Fr().fromBinary(t,n)}static fromJson(t,n){return new Fr().fromJson(t,n)}static fromJsonString(t,n){return new Fr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Fr,t,n)}};a(Fr,"runtime",l),a(Fr,"typeName","yorkie.v1.UpdatableProjectFields.EventWebhookEvents"),a(Fr,"fields",l.util.newFieldList(()=>[{no:1,name:"events",kind:"scalar",T:9,repeated:!0}]));let nc=Fr;const Mr=class Mr extends I{constructor(t){super();a(this,"origins",[]);l.util.initPartial(t,this)}static fromBinary(t,n){return new Mr().fromBinary(t,n)}static fromJson(t,n){return new Mr().fromJson(t,n)}static fromJsonString(t,n){return new Mr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Mr,t,n)}};a(Mr,"runtime",l),a(Mr,"typeName","yorkie.v1.UpdatableProjectFields.AllowedOrigins"),a(Mr,"fields",l.util.newFieldList(()=>[{no:1,name:"origins",kind:"scalar",T:9,repeated:!0}]));let sc=Mr;const Ur=class Ur extends I{constructor(t){super();a(this,"id","");a(this,"key","");a(this,"root","");a(this,"attachedClients",0);a(this,"documentSize");a(this,"schemaKey","");a(this,"presences",{});a(this,"createdAt");a(this,"accessedAt");a(this,"updatedAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new Ur().fromBinary(t,n)}static fromJson(t,n){return new Ur().fromJson(t,n)}static fromJsonString(t,n){return new Ur().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Ur,t,n)}};a(Ur,"runtime",l),a(Ur,"typeName","yorkie.v1.DocumentSummary"),a(Ur,"fields",l.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"root",kind:"scalar",T:9},{no:7,name:"attached_clients",kind:"scalar",T:5},{no:8,name:"document_size",kind:"message",T:cc},{no:9,name:"schema_key",kind:"scalar",T:9},{no:10,name:"presences",kind:"map",K:9,V:{kind:"message",T:Zs}},{no:4,name:"created_at",kind:"message",T:Ce},{no:5,name:"accessed_at",kind:"message",T:Ce},{no:6,name:"updated_at",kind:"message",T:Ce}]));let Hl=Ur;const zr=class zr extends I{constructor(t){super();a(this,"type",0);a(this,"presence");l.util.initPartial(t,this)}static fromBinary(t,n){return new zr().fromBinary(t,n)}static fromJson(t,n){return new zr().fromJson(t,n)}static fromJsonString(t,n){return new zr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(zr,t,n)}};a(zr,"runtime",l),a(zr,"typeName","yorkie.v1.PresenceChange"),a(zr,"fields",l.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:l.getEnumType(Is)},{no:2,name:"presence",kind:"message",T:Zs}]));let Mi=zr;var Is=(r=>(r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.PUT=1]="PUT",r[r.DELETE=2]="DELETE",r[r.CLEAR=3]="CLEAR",r))(Is||{});l.util.setEnumType(Is,"yorkie.v1.PresenceChange.ChangeType",[{no:0,name:"CHANGE_TYPE_UNSPECIFIED"},{no:1,name:"CHANGE_TYPE_PUT"},{no:2,name:"CHANGE_TYPE_DELETE"},{no:3,name:"CHANGE_TYPE_CLEAR"}]);const qr=class qr extends I{constructor(t){super();a(this,"data",{});l.util.initPartial(t,this)}static fromBinary(t,n){return new qr().fromBinary(t,n)}static fromJson(t,n){return new qr().fromJson(t,n)}static fromJsonString(t,n){return new qr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(qr,t,n)}};a(qr,"runtime",l),a(qr,"typeName","yorkie.v1.Presence"),a(qr,"fields",l.util.newFieldList(()=>[{no:1,name:"data",kind:"map",K:9,V:{kind:"scalar",T:9}}]));let Zs=qr;const Kr=class Kr extends I{constructor(t){super();a(this,"key","");a(this,"presenceCount",0);l.util.initPartial(t,this)}static fromBinary(t,n){return new Kr().fromBinary(t,n)}static fromJson(t,n){return new Kr().fromJson(t,n)}static fromJsonString(t,n){return new Kr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Kr,t,n)}};a(Kr,"runtime",l),a(Kr,"typeName","yorkie.v1.ChannelSummary"),a(Kr,"fields",l.util.newFieldList(()=>[{no:1,name:"key",kind:"scalar",T:9},{no:2,name:"presence_count",kind:"scalar",T:5}]));let Gl=Kr;var ft;let Kh=(ft=class extends I{constructor(t){super();a(this,"serverSeq",Q.zero);a(this,"clientSeq",0);l.util.initPartial(t,this)}static fromBinary(t,n){return new ft().fromBinary(t,n)}static fromJson(t,n){return new ft().fromJson(t,n)}static fromJsonString(t,n){return new ft().fromJsonString(t,n)}static equals(t,n){return l.util.equals(ft,t,n)}},a(ft,"runtime",l),a(ft,"typeName","yorkie.v1.Checkpoint"),a(ft,"fields",l.util.newFieldList(()=>[{no:1,name:"server_seq",kind:"scalar",T:3},{no:2,name:"client_seq",kind:"scalar",T:13}])),ft);const Vr=class Vr extends I{constructor(t){super();a(this,"createdAt");a(this,"offset",0);a(this,"relativeOffset",0);l.util.initPartial(t,this)}static fromBinary(t,n){return new Vr().fromBinary(t,n)}static fromJson(t,n){return new Vr().fromJson(t,n)}static fromJsonString(t,n){return new Vr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Vr,t,n)}};a(Vr,"runtime",l),a(Vr,"typeName","yorkie.v1.TextNodePos"),a(Vr,"fields",l.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:F},{no:2,name:"offset",kind:"scalar",T:5},{no:3,name:"relative_offset",kind:"scalar",T:5}]));let ks=Vr;var ht;let F=(ht=class extends I{constructor(t){super();a(this,"lamport",Q.zero);a(this,"delimiter",0);a(this,"actorId",new Uint8Array(0));l.util.initPartial(t,this)}static fromBinary(t,n){return new ht().fromBinary(t,n)}static fromJson(t,n){return new ht().fromJson(t,n)}static fromJsonString(t,n){return new ht().fromJsonString(t,n)}static equals(t,n){return l.util.equals(ht,t,n)}},a(ht,"runtime",l),a(ht,"typeName","yorkie.v1.TimeTicket"),a(ht,"fields",l.util.newFieldList(()=>[{no:1,name:"lamport",kind:"scalar",T:3},{no:2,name:"delimiter",kind:"scalar",T:13},{no:3,name:"actor_id",kind:"scalar",T:12}])),ht);const jr=class jr extends I{constructor(t){super();a(this,"topic","");a(this,"payload",new Uint8Array(0));l.util.initPartial(t,this)}static fromBinary(t,n){return new jr().fromBinary(t,n)}static fromJson(t,n){return new jr().fromJson(t,n)}static fromJsonString(t,n){return new jr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(jr,t,n)}};a(jr,"runtime",l),a(jr,"typeName","yorkie.v1.DocEventBody"),a(jr,"fields",l.util.newFieldList(()=>[{no:1,name:"topic",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12}]));let ic=jr;const Wr=class Wr extends I{constructor(t){super();a(this,"type",0);a(this,"publisher","");a(this,"body");l.util.initPartial(t,this)}static fromBinary(t,n){return new Wr().fromBinary(t,n)}static fromJson(t,n){return new Wr().fromJson(t,n)}static fromJsonString(t,n){return new Wr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Wr,t,n)}};a(Wr,"runtime",l),a(Wr,"typeName","yorkie.v1.DocEvent"),a(Wr,"fields",l.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:l.getEnumType(Ys)},{no:2,name:"publisher",kind:"scalar",T:9},{no:3,name:"body",kind:"message",T:ic}]));let oc=Wr;const Hr=class Hr extends I{constructor(t){super();a(this,"type",0);a(this,"publisher","");a(this,"count",Q.zero);a(this,"seq",Q.zero);a(this,"topic","");a(this,"payload",new Uint8Array(0));l.util.initPartial(t,this)}static fromBinary(t,n){return new Hr().fromBinary(t,n)}static fromJson(t,n){return new Hr().fromJson(t,n)}static fromJsonString(t,n){return new Hr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Hr,t,n)}};a(Hr,"runtime",l),a(Hr,"typeName","yorkie.v1.ChannelEvent"),a(Hr,"fields",l.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:l.getEnumType(ma)},{no:2,name:"publisher",kind:"scalar",T:9},{no:3,name:"count",kind:"scalar",T:3},{no:4,name:"seq",kind:"scalar",T:3},{no:5,name:"topic",kind:"scalar",T:9},{no:6,name:"payload",kind:"scalar",T:12}]));let ac=Hr;var ma=(r=>(r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.PRESENCE=1]="PRESENCE",r[r.BROADCAST=2]="BROADCAST",r))(ma||{});l.util.setEnumType(ma,"yorkie.v1.ChannelEvent.Type",[{no:0,name:"TYPE_UNSPECIFIED"},{no:1,name:"TYPE_PRESENCE"},{no:2,name:"TYPE_BROADCAST"}]);const Gr=class Gr extends I{constructor(t){super();a(this,"data",0);a(this,"meta",0);l.util.initPartial(t,this)}static fromBinary(t,n){return new Gr().fromBinary(t,n)}static fromJson(t,n){return new Gr().fromJson(t,n)}static fromJsonString(t,n){return new Gr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Gr,t,n)}};a(Gr,"runtime",l),a(Gr,"typeName","yorkie.v1.DataSize"),a(Gr,"fields",l.util.newFieldList(()=>[{no:1,name:"data",kind:"scalar",T:5},{no:2,name:"meta",kind:"scalar",T:5}]));let _o=Gr;const _r=class _r extends I{constructor(t){super();a(this,"live");a(this,"gc");l.util.initPartial(t,this)}static fromBinary(t,n){return new _r().fromBinary(t,n)}static fromJson(t,n){return new _r().fromJson(t,n)}static fromJsonString(t,n){return new _r().fromJsonString(t,n)}static equals(t,n){return l.util.equals(_r,t,n)}};a(_r,"runtime",l),a(_r,"typeName","yorkie.v1.DocSize"),a(_r,"fields",l.util.newFieldList(()=>[{no:1,name:"live",kind:"message",T:_o},{no:2,name:"gc",kind:"message",T:_o}]));let cc=_r;const Yr=class Yr extends I{constructor(t){super();a(this,"id","");a(this,"name","");a(this,"version",0);a(this,"body","");a(this,"rules",[]);a(this,"createdAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new Yr().fromBinary(t,n)}static fromJson(t,n){return new Yr().fromJson(t,n)}static fromJsonString(t,n){return new Yr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Yr,t,n)}};a(Yr,"runtime",l),a(Yr,"typeName","yorkie.v1.Schema"),a(Yr,"fields",l.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"version",kind:"scalar",T:5},{no:4,name:"body",kind:"scalar",T:9},{no:5,name:"rules",kind:"message",T:Yo,repeated:!0},{no:6,name:"created_at",kind:"message",T:Ce}]));let _l=Yr;const Xr=class Xr extends I{constructor(t){super();a(this,"path","");a(this,"type","");l.util.initPartial(t,this)}static fromBinary(t,n){return new Xr().fromBinary(t,n)}static fromJson(t,n){return new Xr().fromJson(t,n)}static fromJsonString(t,n){return new Xr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Xr,t,n)}};a(Xr,"runtime",l),a(Xr,"typeName","yorkie.v1.Rule"),a(Xr,"fields",l.util.newFieldList(()=>[{no:1,name:"path",kind:"scalar",T:9},{no:2,name:"type",kind:"scalar",T:9}]));let Yo=Xr;const Zr=class Zr extends I{constructor(t){super();a(this,"id","");a(this,"label","");a(this,"description","");a(this,"snapshot","");a(this,"createdAt");l.util.initPartial(t,this)}static fromBinary(t,n){return new Zr().fromBinary(t,n)}static fromJson(t,n){return new Zr().fromJson(t,n)}static fromJsonString(t,n){return new Zr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Zr,t,n)}};a(Zr,"runtime",l),a(Zr,"typeName","yorkie.v1.RevisionSummary"),a(Zr,"fields",l.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"label",kind:"scalar",T:9},{no:3,name:"description",kind:"scalar",T:9},{no:4,name:"snapshot",kind:"scalar",T:9},{no:5,name:"created_at",kind:"message",T:Ce}]));let Xo=Zr;const Qr=class Qr extends I{constructor(t){super();a(this,"clientKey","");a(this,"metadata",{});l.util.initPartial(t,this)}static fromBinary(t,n){return new Qr().fromBinary(t,n)}static fromJson(t,n){return new Qr().fromJson(t,n)}static fromJsonString(t,n){return new Qr().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Qr,t,n)}};a(Qr,"runtime",l),a(Qr,"typeName","yorkie.v1.ActivateClientRequest"),a(Qr,"fields",l.util.newFieldList(()=>[{no:1,name:"client_key",kind:"scalar",T:9},{no:2,name:"metadata",kind:"map",K:9,V:{kind:"scalar",T:9}}]));let uc=Qr;const en=class en extends I{constructor(t){super();a(this,"clientId","");l.util.initPartial(t,this)}static fromBinary(t,n){return new en().fromBinary(t,n)}static fromJson(t,n){return new en().fromJson(t,n)}static fromJsonString(t,n){return new en().fromJsonString(t,n)}static equals(t,n){return l.util.equals(en,t,n)}};a(en,"runtime",l),a(en,"typeName","yorkie.v1.ActivateClientResponse"),a(en,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9}]));let lc=en;const tn=class tn extends I{constructor(t){super();a(this,"clientId","");a(this,"synchronous",!1);l.util.initPartial(t,this)}static fromBinary(t,n){return new tn().fromBinary(t,n)}static fromJson(t,n){return new tn().fromJson(t,n)}static fromJsonString(t,n){return new tn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(tn,t,n)}};a(tn,"runtime",l),a(tn,"typeName","yorkie.v1.DeactivateClientRequest"),a(tn,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"synchronous",kind:"scalar",T:8}]));let fc=tn;const rn=class rn extends I{constructor(e){super(),l.util.initPartial(e,this)}static fromBinary(e,t){return new rn().fromBinary(e,t)}static fromJson(e,t){return new rn().fromJson(e,t)}static fromJsonString(e,t){return new rn().fromJsonString(e,t)}static equals(e,t){return l.util.equals(rn,e,t)}};a(rn,"runtime",l),a(rn,"typeName","yorkie.v1.DeactivateClientResponse"),a(rn,"fields",l.util.newFieldList(()=>[]));let hc=rn;const nn=class nn extends I{constructor(t){super();a(this,"clientId","");a(this,"changePack");a(this,"schemaKey","");l.util.initPartial(t,this)}static fromBinary(t,n){return new nn().fromBinary(t,n)}static fromJson(t,n){return new nn().fromJson(t,n)}static fromJsonString(t,n){return new nn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(nn,t,n)}};a(nn,"runtime",l),a(nn,"typeName","yorkie.v1.AttachDocumentRequest"),a(nn,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:Wn},{no:3,name:"schema_key",kind:"scalar",T:9}]));let dc=nn;const sn=class sn extends I{constructor(t){super();a(this,"documentId","");a(this,"changePack");a(this,"maxSizePerDocument",0);a(this,"schemaRules",[]);l.util.initPartial(t,this)}static fromBinary(t,n){return new sn().fromBinary(t,n)}static fromJson(t,n){return new sn().fromJson(t,n)}static fromJsonString(t,n){return new sn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(sn,t,n)}};a(sn,"runtime",l),a(sn,"typeName","yorkie.v1.AttachDocumentResponse"),a(sn,"fields",l.util.newFieldList(()=>[{no:1,name:"document_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:Wn},{no:3,name:"max_size_per_document",kind:"scalar",T:5},{no:4,name:"schema_rules",kind:"message",T:Yo,repeated:!0}]));let gc=sn;const on=class on extends I{constructor(t){super();a(this,"clientId","");a(this,"documentId","");a(this,"changePack");a(this,"removeIfNotAttached",!1);l.util.initPartial(t,this)}static fromBinary(t,n){return new on().fromBinary(t,n)}static fromJson(t,n){return new on().fromJson(t,n)}static fromJsonString(t,n){return new on().fromJsonString(t,n)}static equals(t,n){return l.util.equals(on,t,n)}};a(on,"runtime",l),a(on,"typeName","yorkie.v1.DetachDocumentRequest"),a(on,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:Wn},{no:4,name:"remove_if_not_attached",kind:"scalar",T:8}]));let mc=on;const an=class an extends I{constructor(t){super();a(this,"changePack");l.util.initPartial(t,this)}static fromBinary(t,n){return new an().fromBinary(t,n)}static fromJson(t,n){return new an().fromJson(t,n)}static fromJsonString(t,n){return new an().fromJsonString(t,n)}static equals(t,n){return l.util.equals(an,t,n)}};a(an,"runtime",l),a(an,"typeName","yorkie.v1.DetachDocumentResponse"),a(an,"fields",l.util.newFieldList(()=>[{no:2,name:"change_pack",kind:"message",T:Wn}]));let pc=an;const cn=class cn extends I{constructor(t){super();a(this,"clientId","");a(this,"documentId","");l.util.initPartial(t,this)}static fromBinary(t,n){return new cn().fromBinary(t,n)}static fromJson(t,n){return new cn().fromJson(t,n)}static fromJsonString(t,n){return new cn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(cn,t,n)}};a(cn,"runtime",l),a(cn,"typeName","yorkie.v1.WatchDocumentRequest"),a(cn,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9}]));let yc=cn;const un=class un extends I{constructor(t){super();a(this,"body",{case:void 0});l.util.initPartial(t,this)}static fromBinary(t,n){return new un().fromBinary(t,n)}static fromJson(t,n){return new un().fromJson(t,n)}static fromJsonString(t,n){return new un().fromJsonString(t,n)}static equals(t,n){return l.util.equals(un,t,n)}};a(un,"runtime",l),a(un,"typeName","yorkie.v1.WatchDocumentResponse"),a(un,"fields",l.util.newFieldList(()=>[{no:1,name:"initialization",kind:"message",T:wc,oneof:"body"},{no:2,name:"event",kind:"message",T:oc,oneof:"body"}]));let vc=un;const ln=class ln extends I{constructor(t){super();a(this,"clientIds",[]);l.util.initPartial(t,this)}static fromBinary(t,n){return new ln().fromBinary(t,n)}static fromJson(t,n){return new ln().fromJson(t,n)}static fromJsonString(t,n){return new ln().fromJsonString(t,n)}static equals(t,n){return l.util.equals(ln,t,n)}};a(ln,"runtime",l),a(ln,"typeName","yorkie.v1.WatchDocumentResponse.Initialization"),a(ln,"fields",l.util.newFieldList(()=>[{no:1,name:"client_ids",kind:"scalar",T:9,repeated:!0}]));let wc=ln;const fn=class fn extends I{constructor(t){super();a(this,"clientId","");a(this,"documentId","");a(this,"changePack");l.util.initPartial(t,this)}static fromBinary(t,n){return new fn().fromBinary(t,n)}static fromJson(t,n){return new fn().fromJson(t,n)}static fromJsonString(t,n){return new fn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(fn,t,n)}};a(fn,"runtime",l),a(fn,"typeName","yorkie.v1.RemoveDocumentRequest"),a(fn,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:Wn}]));let bc=fn;const hn=class hn extends I{constructor(t){super();a(this,"changePack");l.util.initPartial(t,this)}static fromBinary(t,n){return new hn().fromBinary(t,n)}static fromJson(t,n){return new hn().fromJson(t,n)}static fromJsonString(t,n){return new hn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(hn,t,n)}};a(hn,"runtime",l),a(hn,"typeName","yorkie.v1.RemoveDocumentResponse"),a(hn,"fields",l.util.newFieldList(()=>[{no:1,name:"change_pack",kind:"message",T:Wn}]));let Sc=hn;const dn=class dn extends I{constructor(t){super();a(this,"clientId","");a(this,"documentId","");a(this,"changePack");a(this,"pushOnly",!1);l.util.initPartial(t,this)}static fromBinary(t,n){return new dn().fromBinary(t,n)}static fromJson(t,n){return new dn().fromJson(t,n)}static fromJsonString(t,n){return new dn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(dn,t,n)}};a(dn,"runtime",l),a(dn,"typeName","yorkie.v1.PushPullChangesRequest"),a(dn,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:Wn},{no:4,name:"push_only",kind:"scalar",T:8}]));let Tc=dn;const gn=class gn extends I{constructor(t){super();a(this,"changePack");l.util.initPartial(t,this)}static fromBinary(t,n){return new gn().fromBinary(t,n)}static fromJson(t,n){return new gn().fromJson(t,n)}static fromJsonString(t,n){return new gn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(gn,t,n)}};a(gn,"runtime",l),a(gn,"typeName","yorkie.v1.PushPullChangesResponse"),a(gn,"fields",l.util.newFieldList(()=>[{no:1,name:"change_pack",kind:"message",T:Wn}]));let Ac=gn;const mn=class mn extends I{constructor(t){super();a(this,"clientId","");a(this,"documentId","");a(this,"label","");a(this,"description","");l.util.initPartial(t,this)}static fromBinary(t,n){return new mn().fromBinary(t,n)}static fromJson(t,n){return new mn().fromJson(t,n)}static fromJsonString(t,n){return new mn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(mn,t,n)}};a(mn,"runtime",l),a(mn,"typeName","yorkie.v1.CreateRevisionRequest"),a(mn,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"label",kind:"scalar",T:9},{no:4,name:"description",kind:"scalar",T:9}]));let Ic=mn;const pn=class pn extends I{constructor(t){super();a(this,"revision");l.util.initPartial(t,this)}static fromBinary(t,n){return new pn().fromBinary(t,n)}static fromJson(t,n){return new pn().fromJson(t,n)}static fromJsonString(t,n){return new pn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(pn,t,n)}};a(pn,"runtime",l),a(pn,"typeName","yorkie.v1.CreateRevisionResponse"),a(pn,"fields",l.util.newFieldList(()=>[{no:1,name:"revision",kind:"message",T:Xo}]));let kc=pn;const yn=class yn extends I{constructor(t){super();a(this,"projectId","");a(this,"documentId","");a(this,"pageSize",0);a(this,"offset",0);a(this,"isForward",!1);l.util.initPartial(t,this)}static fromBinary(t,n){return new yn().fromBinary(t,n)}static fromJson(t,n){return new yn().fromJson(t,n)}static fromJsonString(t,n){return new yn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(yn,t,n)}};a(yn,"runtime",l),a(yn,"typeName","yorkie.v1.ListRevisionsRequest"),a(yn,"fields",l.util.newFieldList(()=>[{no:1,name:"project_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"page_size",kind:"scalar",T:5},{no:4,name:"offset",kind:"scalar",T:5},{no:5,name:"is_forward",kind:"scalar",T:8}]));let xc=yn;const vn=class vn extends I{constructor(t){super();a(this,"revisions",[]);l.util.initPartial(t,this)}static fromBinary(t,n){return new vn().fromBinary(t,n)}static fromJson(t,n){return new vn().fromJson(t,n)}static fromJsonString(t,n){return new vn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(vn,t,n)}};a(vn,"runtime",l),a(vn,"typeName","yorkie.v1.ListRevisionsResponse"),a(vn,"fields",l.util.newFieldList(()=>[{no:1,name:"revisions",kind:"message",T:Xo,repeated:!0}]));let Ec=vn;const wn=class wn extends I{constructor(t){super();a(this,"clientId","");a(this,"revisionId","");l.util.initPartial(t,this)}static fromBinary(t,n){return new wn().fromBinary(t,n)}static fromJson(t,n){return new wn().fromJson(t,n)}static fromJsonString(t,n){return new wn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(wn,t,n)}};a(wn,"runtime",l),a(wn,"typeName","yorkie.v1.RestoreRevisionRequest"),a(wn,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"revision_id",kind:"scalar",T:9}]));let Cc=wn;const bn=class bn extends I{constructor(e){super(),l.util.initPartial(e,this)}static fromBinary(e,t){return new bn().fromBinary(e,t)}static fromJson(e,t){return new bn().fromJson(e,t)}static fromJsonString(e,t){return new bn().fromJsonString(e,t)}static equals(e,t){return l.util.equals(bn,e,t)}};a(bn,"runtime",l),a(bn,"typeName","yorkie.v1.RestoreRevisionResponse"),a(bn,"fields",l.util.newFieldList(()=>[]));let Pc=bn;const Sn=class Sn extends I{constructor(t){super();a(this,"clientId","");a(this,"channelKey","");l.util.initPartial(t,this)}static fromBinary(t,n){return new Sn().fromBinary(t,n)}static fromJson(t,n){return new Sn().fromJson(t,n)}static fromJsonString(t,n){return new Sn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Sn,t,n)}};a(Sn,"runtime",l),a(Sn,"typeName","yorkie.v1.AttachChannelRequest"),a(Sn,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"channel_key",kind:"scalar",T:9}]));let Nc=Sn;const Tn=class Tn extends I{constructor(t){super();a(this,"sessionId","");a(this,"count",Q.zero);l.util.initPartial(t,this)}static fromBinary(t,n){return new Tn().fromBinary(t,n)}static fromJson(t,n){return new Tn().fromJson(t,n)}static fromJsonString(t,n){return new Tn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Tn,t,n)}};a(Tn,"runtime",l),a(Tn,"typeName","yorkie.v1.AttachChannelResponse"),a(Tn,"fields",l.util.newFieldList(()=>[{no:1,name:"session_id",kind:"scalar",T:9},{no:2,name:"count",kind:"scalar",T:3}]));let Dc=Tn;const An=class An extends I{constructor(t){super();a(this,"clientId","");a(this,"channelKey","");a(this,"sessionId","");l.util.initPartial(t,this)}static fromBinary(t,n){return new An().fromBinary(t,n)}static fromJson(t,n){return new An().fromJson(t,n)}static fromJsonString(t,n){return new An().fromJsonString(t,n)}static equals(t,n){return l.util.equals(An,t,n)}};a(An,"runtime",l),a(An,"typeName","yorkie.v1.DetachChannelRequest"),a(An,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"channel_key",kind:"scalar",T:9},{no:3,name:"session_id",kind:"scalar",T:9}]));let Oc=An;const In=class In extends I{constructor(t){super();a(this,"count",Q.zero);l.util.initPartial(t,this)}static fromBinary(t,n){return new In().fromBinary(t,n)}static fromJson(t,n){return new In().fromJson(t,n)}static fromJsonString(t,n){return new In().fromJsonString(t,n)}static equals(t,n){return l.util.equals(In,t,n)}};a(In,"runtime",l),a(In,"typeName","yorkie.v1.DetachChannelResponse"),a(In,"fields",l.util.newFieldList(()=>[{no:1,name:"count",kind:"scalar",T:3}]));let Bc=In;const kn=class kn extends I{constructor(t){super();a(this,"clientId","");a(this,"channelKey","");a(this,"sessionId","");l.util.initPartial(t,this)}static fromBinary(t,n){return new kn().fromBinary(t,n)}static fromJson(t,n){return new kn().fromJson(t,n)}static fromJsonString(t,n){return new kn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(kn,t,n)}};a(kn,"runtime",l),a(kn,"typeName","yorkie.v1.RefreshChannelRequest"),a(kn,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"channel_key",kind:"scalar",T:9},{no:3,name:"session_id",kind:"scalar",T:9}]));let Rc=kn;const xn=class xn extends I{constructor(t){super();a(this,"count",Q.zero);l.util.initPartial(t,this)}static fromBinary(t,n){return new xn().fromBinary(t,n)}static fromJson(t,n){return new xn().fromJson(t,n)}static fromJsonString(t,n){return new xn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(xn,t,n)}};a(xn,"runtime",l),a(xn,"typeName","yorkie.v1.RefreshChannelResponse"),a(xn,"fields",l.util.newFieldList(()=>[{no:1,name:"count",kind:"scalar",T:3}]));let Lc=xn;const En=class En extends I{constructor(t){super();a(this,"clientId","");a(this,"channelKey","");l.util.initPartial(t,this)}static fromBinary(t,n){return new En().fromBinary(t,n)}static fromJson(t,n){return new En().fromJson(t,n)}static fromJsonString(t,n){return new En().fromJsonString(t,n)}static equals(t,n){return l.util.equals(En,t,n)}};a(En,"runtime",l),a(En,"typeName","yorkie.v1.WatchChannelRequest"),a(En,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"channel_key",kind:"scalar",T:9}]));let Jc=En;const Cn=class Cn extends I{constructor(t){super();a(this,"body",{case:void 0});l.util.initPartial(t,this)}static fromBinary(t,n){return new Cn().fromBinary(t,n)}static fromJson(t,n){return new Cn().fromJson(t,n)}static fromJsonString(t,n){return new Cn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Cn,t,n)}};a(Cn,"runtime",l),a(Cn,"typeName","yorkie.v1.WatchChannelResponse"),a(Cn,"fields",l.util.newFieldList(()=>[{no:1,name:"initialized",kind:"message",T:Fc,oneof:"body"},{no:2,name:"event",kind:"message",T:ac,oneof:"body"}]));let $c=Cn;const Pn=class Pn extends I{constructor(t){super();a(this,"count",Q.zero);a(this,"seq",Q.zero);l.util.initPartial(t,this)}static fromBinary(t,n){return new Pn().fromBinary(t,n)}static fromJson(t,n){return new Pn().fromJson(t,n)}static fromJsonString(t,n){return new Pn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Pn,t,n)}};a(Pn,"runtime",l),a(Pn,"typeName","yorkie.v1.WatchChannelInitialized"),a(Pn,"fields",l.util.newFieldList(()=>[{no:1,name:"count",kind:"scalar",T:3},{no:2,name:"seq",kind:"scalar",T:3}]));let Fc=Pn;const Nn=class Nn extends I{constructor(t){super();a(this,"clientId","");a(this,"channelKey","");a(this,"topic","");a(this,"payload",new Uint8Array(0));l.util.initPartial(t,this)}static fromBinary(t,n){return new Nn().fromBinary(t,n)}static fromJson(t,n){return new Nn().fromJson(t,n)}static fromJsonString(t,n){return new Nn().fromJsonString(t,n)}static equals(t,n){return l.util.equals(Nn,t,n)}};a(Nn,"runtime",l),a(Nn,"typeName","yorkie.v1.BroadcastRequest"),a(Nn,"fields",l.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"channel_key",kind:"scalar",T:9},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"payload",kind:"scalar",T:12}]));let Mc=Nn;const Dn=class Dn extends I{constructor(e){super(),l.util.initPartial(e,this)}static fromBinary(e,t){return new Dn().fromBinary(e,t)}static fromJson(e,t){return new Dn().fromJson(e,t)}static fromJsonString(e,t){return new Dn().fromJsonString(e,t)}static equals(e,t){return l.util.equals(Dn,e,t)}};a(Dn,"runtime",l),a(Dn,"typeName","yorkie.v1.BroadcastResponse"),a(Dn,"fields",l.util.newFieldList(()=>[]));let Uc=Dn;const vy={typeName:"yorkie.v1.YorkieService",methods:{activateClient:{name:"ActivateClient",I:uc,O:lc,kind:be.Unary},deactivateClient:{name:"DeactivateClient",I:fc,O:hc,kind:be.Unary},attachDocument:{name:"AttachDocument",I:dc,O:gc,kind:be.Unary},detachDocument:{name:"DetachDocument",I:mc,O:pc,kind:be.Unary},removeDocument:{name:"RemoveDocument",I:bc,O:Sc,kind:be.Unary},pushPullChanges:{name:"PushPullChanges",I:Tc,O:Ac,kind:be.Unary},watchDocument:{name:"WatchDocument",I:yc,O:vc,kind:be.ServerStreaming},createRevision:{name:"CreateRevision",I:Ic,O:kc,kind:be.Unary},listRevisions:{name:"ListRevisions",I:xc,O:Ec,kind:be.Unary},restoreRevision:{name:"RestoreRevision",I:Cc,O:Pc,kind:be.Unary},attachChannel:{name:"AttachChannel",I:Nc,O:Dc,kind:be.Unary},detachChannel:{name:"DetachChannel",I:Oc,O:Bc,kind:be.Unary},refreshChannel:{name:"RefreshChannel",I:Rc,O:Lc,kind:be.Unary},watchChannel:{name:"WatchChannel",I:Jc,O:$c,kind:be.ServerStreaming},broadcast:{name:"Broadcast",I:Mc,O:Uc,kind:be.Unary}}},wy=l.makeMessageType("google.rpc.ErrorInfo",()=>[{no:1,name:"reason",kind:"scalar",T:9},{no:2,name:"domain",kind:"scalar",T:9},{no:3,name:"metadata",kind:"map",K:9,V:{kind:"scalar",T:9}}]);l.makeMessageType("google.rpc.RetryInfo",()=>[{no:1,name:"retry_delay",kind:"message",T:Jn}]);l.makeMessageType("google.rpc.DebugInfo",()=>[{no:1,name:"stack_entries",kind:"scalar",T:9,repeated:!0},{no:2,name:"detail",kind:"scalar",T:9}]);l.makeMessageType("google.rpc.QuotaFailure",()=>[{no:1,name:"violations",kind:"message",T:by,repeated:!0}]);const by=l.makeMessageType("google.rpc.QuotaFailure.Violation",()=>[{no:1,name:"subject",kind:"scalar",T:9},{no:2,name:"description",kind:"scalar",T:9},{no:3,name:"api_service",kind:"scalar",T:9},{no:4,name:"quota_metric",kind:"scalar",T:9},{no:5,name:"quota_id",kind:"scalar",T:9},{no:6,name:"quota_dimensions",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:7,name:"quota_value",kind:"scalar",T:3},{no:8,name:"future_quota_value",kind:"scalar",T:3,opt:!0}],{localName:"QuotaFailure_Violation"});l.makeMessageType("google.rpc.PreconditionFailure",()=>[{no:1,name:"violations",kind:"message",T:Sy,repeated:!0}]);const Sy=l.makeMessageType("google.rpc.PreconditionFailure.Violation",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"subject",kind:"scalar",T:9},{no:3,name:"description",kind:"scalar",T:9}],{localName:"PreconditionFailure_Violation"});l.makeMessageType("google.rpc.BadRequest",()=>[{no:1,name:"field_violations",kind:"message",T:Ty,repeated:!0}]);const Ty=l.makeMessageType("google.rpc.BadRequest.FieldViolation",()=>[{no:1,name:"field",kind:"scalar",T:9},{no:2,name:"description",kind:"scalar",T:9},{no:3,name:"reason",kind:"scalar",T:9},{no:4,name:"localized_message",kind:"message",T:Iy}],{localName:"BadRequest_FieldViolation"});l.makeMessageType("google.rpc.RequestInfo",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"serving_data",kind:"scalar",T:9}]);l.makeMessageType("google.rpc.ResourceInfo",()=>[{no:1,name:"resource_type",kind:"scalar",T:9},{no:2,name:"resource_name",kind:"scalar",T:9},{no:3,name:"owner",kind:"scalar",T:9},{no:4,name:"description",kind:"scalar",T:9}]);l.makeMessageType("google.rpc.Help",()=>[{no:1,name:"links",kind:"message",T:Ay,repeated:!0}]);const Ay=l.makeMessageType("google.rpc.Help.Link",()=>[{no:1,name:"description",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9}],{localName:"Help_Link"}),Iy=l.makeMessageType("google.rpc.LocalizedMessage",()=>[{no:1,name:"locale",kind:"scalar",T:9},{no:2,name:"message",kind:"scalar",T:9}]);var y=(r=>(r.Ok="ok",r.ErrClientNotActivated="ErrClientNotActivated",r.ErrClientNotFound="ErrClientNotFound",r.ErrUnimplemented="ErrUnimplemented",r.ErrInvalidType="ErrInvalidType",r.ErrDummy="ErrDummy",r.ErrNotAttached="ErrNotAttached",r.ErrNotDetached="ErrNotDetached",r.ErrDocumentRemoved="ErrDocumentRemoved",r.ErrDocumentSizeExceedsLimit="ErrDocumentSizeExceedsLimit",r.ErrDocumentSchemaValidationFailed="ErrDocumentSchemaValidationFailed",r.ErrInvalidObjectKey="ErrInvalidObjectKey",r.ErrInvalidArgument="ErrInvalidArgument",r.ErrNotInitialized="ErrNotInitialized",r.ErrNotReady="ErrNotReady",r.ErrRefused="ErrRefused",r.ErrContextNotProvided="ErrContextNotProvided",r.ErrPermissionDenied="ErrPermissionDenied",r.ErrUnauthenticated="ErrUnauthenticated",r.ErrTooManySubscribers="ErrTooManySubscribers",r.ErrTooManyAttachments="ErrTooManyAttachments",r))(y||{});class w extends Error{constructor(t,n){super(n);a(this,"name","YorkieError");a(this,"stack");this.code=t,this.message=n,this.toString=()=>`[code=${this.code}]: ${this.message}`}}var Zt=(r=>(r.Put="put",r.Clear="clear",r))(Zt||{});const gu="000000000000000000000000",Gt=24;class wt{constructor(e,t,n){a(this,"lamport");a(this,"delimiter");a(this,"actorID");this.lamport=e,this.delimiter=t,this.actorID=n}static of(e,t,n){return new wt(e,t,n)}static fromStruct(e){return wt.of(BigInt(e.lamport),e.delimiter,e.actorID)}toIDString(){return`${this.lamport.toString()}:${this.actorID}:${this.delimiter}`}toStruct(){return{lamport:this.getLamportAsString(),delimiter:this.getDelimiter(),actorID:this.getActorID()}}toTestString(){return`${this.lamport.toString()}:${this.actorID.slice(-2)}:${this.delimiter}`}setActor(e){return new wt(this.lamport,this.delimiter,e)}getLamportAsString(){return this.lamport.toString()}getLamport(){return this.lamport}getDelimiter(){return this.delimiter}getActorID(){return this.actorID}after(e){return this.compare(e)>0}equals(e){return this.compare(e)===0}compare(e){if(this.lamport>e.lamport)return 1;if(e.lamport>this.lamport)return-1;const t=this.actorID.localeCompare(e.actorID);return t!==0?t:this.delimiter>e.delimiter?1:e.delimiter>this.delimiter?-1:0}}const zc=0n,Vh=0,qc=9223372036854775807n,Qs=new wt(zc,Vh,gu);function Wt(r){return r.replace(/["'\\\n\r\f\b\t\u2028\u2029]/g,function(e){switch(e){case'"':case"\\":return"\\"+e;case`
`:return"\\n";case"\r":return"\\r";case"\f":return"\\f";case"\b":return"\\b";case"	":return"\\t";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e}})}class Hi{constructor(e){a(this,"createdAt");a(this,"movedAt");a(this,"removedAt");this.createdAt=e}getCreatedAt(){return this.createdAt}getID(){return this.createdAt}getMovedAt(){return this.movedAt}getRemovedAt(){return this.removedAt}getPositionedAt(){return this.movedAt?this.movedAt:this.createdAt}setCreatedAt(e){this.createdAt=e}setMovedAt(e){return!this.movedAt||e&&e.after(this.movedAt)?(this.movedAt=e,!0):!1}setRemovedAt(e){this.removedAt=e}remove(e){return e&&e.after(this.createdAt)&&(!this.removedAt||e.after(this.removedAt))?(this.removedAt=e,!0):!1}isRemoved(){return!!this.removedAt}getMetaUsage(){let e=0;return this.getCreatedAt()&&(e+=Gt),this.getMovedAt()&&(e+=Gt),this.getRemovedAt()&&(e+=Gt),e}}class rs extends Hi{constructor(e){super(e)}}class Zo{constructor(e,t){a(this,"strKey");a(this,"value");this.strKey=e,this.value=t}static of(e,t){return new Zo(e,t)}isRemoved(){return this.value.isRemoved()}getStrKey(){return this.strKey}getValue(){return this.value}remove(e){return this.value.remove(e)}}class ei{constructor(){a(this,"nodeMapByKey");a(this,"nodeMapByCreatedAt");this.nodeMapByKey=new Map,this.nodeMapByCreatedAt=new Map}static create(){return new ei}set(e,t,n){let s;const i=this.nodeMapByKey.get(e);i&&!i.isRemoved()&&i.remove(n)&&(s=i.getValue());const o=Zo.of(e,t);return this.nodeMapByCreatedAt.set(t.getCreatedAt().toIDString(),o),(!i||n.after(i.getValue().getPositionedAt()))&&(this.nodeMapByKey.set(e,o),t.setMovedAt(n)),s}delete(e,t){if(!this.nodeMapByCreatedAt.has(e.toIDString()))throw new w(y.ErrInvalidArgument,`fail to find ${e.toIDString()}`);const n=this.nodeMapByCreatedAt.get(e.toIDString());return n.remove(t),n.getValue()}subPathOf(e){const t=this.nodeMapByCreatedAt.get(e.toIDString());if(t)return t.getStrKey()}purge(e){const t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!t)throw new w(y.ErrInvalidArgument,`fail to find ${e.getCreatedAt().toIDString()}`);const n=this.nodeMapByKey.get(t.getStrKey());t===n&&this.nodeMapByKey.delete(n.getStrKey()),this.nodeMapByCreatedAt.delete(t.getValue().getCreatedAt().toIDString())}deleteByKey(e,t){const n=this.nodeMapByKey.get(e);if(n&&n.remove(t))return n.getValue()}has(e){const t=this.nodeMapByKey.get(e);return t?!t.isRemoved():!1}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}get(e){const t=this.nodeMapByKey.get(e);if(!(!t||t.isRemoved()))return t}deepcopy(){const e=ei.create();for(const[,t]of this.nodeMapByCreatedAt)e.nodeMapByCreatedAt.set(t.getValue().getCreatedAt().toIDString(),Zo.of(t.getStrKey(),t.getValue().deepcopy()));for(const[t,n]of this.nodeMapByKey)e.nodeMapByKey.set(t,e.nodeMapByCreatedAt.get(n.getValue().getCreatedAt().toIDString()));return e}*[Symbol.iterator](){for(const[,e]of this.nodeMapByCreatedAt)yield e}}class Oe extends rs{constructor(t,n){super(t);a(this,"memberNodes");this.memberNodes=n}static create(t,n){if(!n)return new Oe(t,ei.create());const s=ei.create();for(const[i,o]of Object.entries(n))s.set(i,o.deepcopy(),o.getCreatedAt());return new Oe(t,s)}subPathOf(t){return this.memberNodes.subPathOf(t)}purge(t){this.memberNodes.purge(t)}set(t,n,s){return this.memberNodes.set(t,n,s)}delete(t,n){return this.memberNodes.delete(t,n)}deleteByKey(t,n){return this.memberNodes.deleteByKey(t,n)}get(t){const n=this.memberNodes.get(t);return n==null?void 0:n.getValue()}getByID(t){const n=this.memberNodes.getByID(t);return n==null?void 0:n.getValue()}has(t){return this.memberNodes.has(t)}getDataSize(){return{data:0,meta:this.getMetaUsage()}}toJSON(){const t=[];for(const[n,s]of this)t.push(`"${Wt(n)}":${s.toJSON()}`);return`{${t.join(",")}}`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const t={};for(const[n,s]of this){const{createdAt:i,value:o,type:c}=s.toJSForTest();t[n]={key:n,createdAt:i,value:o,type:c}}return{createdAt:this.getCreatedAt().toTestString(),value:t,type:"YORKIE_OBJECT"}}getKeys(){const t=Array();for(const[n]of this)t.push(n);return t}toSortedJSON(){var s;const t=new Set;for(const[i]of this)t.add(i);const n=[];for(const i of Array.from(t).sort()){const o=(s=this.memberNodes.get(i))==null?void 0:s.getValue();n.push(`"${Wt(i)}":${o.toSortedJSON()}`)}return`{${n.join(",")}}`}getRHT(){return this.memberNodes}deepcopy(){const t=Oe.create(this.getCreatedAt());return t.memberNodes=this.memberNodes.deepcopy(),t.setRemovedAt(this.getRemovedAt()),t.setMovedAt(this.getMovedAt()),t}getDescendants(t){for(const n of this.memberNodes){const s=n.getValue();if(t(s,this))return;s instanceof rs&&s.getDescendants(t)}}*[Symbol.iterator](){for(const t of this.memberNodes)t.isRemoved()||(yield[t.getStrKey(),t.getValue()])}}var me=(r=>(r.Local="local",r.Remote="remote",r.UndoRedo="undoredo",r))(me||{});class Nt{constructor(e,t){a(this,"parentCreatedAt");a(this,"executedAt");this.parentCreatedAt=e,this.executedAt=t}getParentCreatedAt(){return this.parentCreatedAt}getExecutedAt(){if(!this.executedAt)throw new w(y.ErrNotReady,"executedAt is not set yet");return this.executedAt}setActor(e){this.executedAt&&(this.executedAt=this.executedAt.setActor(e))}setExecutedAt(e){this.executedAt=e}}class jh{constructor(e){a(this,"value");a(this,"left");a(this,"right");a(this,"parent");a(this,"weight");this.value=e,this.initWeight()}getNodeString(){return`${this.weight}${this.value}`}getValue(){return this.value}getLeftWeight(){return this.hasLeft()?this.left.getWeight():0}getRightWeight(){return this.hasRight()?this.right.getWeight():0}getWeight(){return this.weight}getLeft(){return this.left}getRight(){return this.right}getParent(){return this.parent}hasLeft(){return!!this.left}hasRight(){return!!this.right}hasParent(){return!!this.parent}setLeft(e){this.left=e}setRight(e){this.right=e}setParent(e){this.parent=e}unlink(){this.parent=void 0,this.right=void 0,this.left=void 0}hasLinks(){return this.hasParent()||this.hasLeft()||this.hasRight()}increaseWeight(e){this.weight+=e}initWeight(){this.weight=this.getLength()}}class Ui{constructor(e){a(this,"root");this.root=e}get length(){return this.root?this.root.getWeight():0}find(e){if(!this.root||e<0)return[void 0,0];let t=this.root;for(;;)if(t.hasLeft()&&e<=t.getLeftWeight())t=t.getLeft();else if(t.hasRight()&&t.getLeftWeight()+t.getLength()<e)e-=t.getLeftWeight()+t.getLength(),t=t.getRight();else{e-=t.getLeftWeight();break}if(e>t.getLength())throw new w(y.ErrInvalidArgument,`out of index range: pos: ${e} > node.length: ${t.getLength()}`);return this.splayNode(t),[t,e]}indexOf(e){return!e||e!==this.root&&!e.hasLinks()?-1:(this.splayNode(e),this.root.getLeftWeight())}getRoot(){return this.root}insert(e){return this.insertAfter(this.root,e)}insertAfter(e,t){return e?(this.splayNode(e),this.root=t,t.setRight(e.getRight()),e.hasRight()&&e.getRight().setParent(t),t.setLeft(e),e.setParent(t),e.setRight(),this.updateWeight(e),this.updateWeight(t),t):(this.root=t,t)}updateWeight(e){e.initWeight(),e.hasLeft()&&e.increaseWeight(e.getLeftWeight()),e.hasRight()&&e.increaseWeight(e.getRightWeight())}updateTreeWeight(e){for(;e;)this.updateWeight(e),e=e.getParent()}splayNode(e){if(e)for(;;)if(this.isLeftChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e),this.rotateLeft(e);else if(this.isLeftChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e.getParent()),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e.getParent()),this.rotateLeft(e);else{this.isLeftChild(e)?this.rotateRight(e):this.isRightChild(e)&&this.rotateLeft(e),this.updateWeight(e);return}}delete(e){this.splayNode(e);const t=new Ui(e.getLeft());t.root&&t.root.setParent();const n=new Ui(e.getRight());if(n.root&&n.root.setParent(),t.root){const s=t.getRightmost();t.splayNode(s),t.root.setRight(n.root),n.root&&n.root.setParent(t.root),this.root=t.root}else this.root=n.root;e.unlink(),this.root&&this.updateWeight(this.root)}deleteRange(e,t){if(!t){this.splayNode(e),this.cutOffRight(e);return}this.splayNode(e),this.splayNode(t),t.getLeft()!=e&&this.rotateRight(e),this.cutOffRight(e)}cutOffRight(e){const t=[];this.traversePostorder(e.getRight(),t);for(const n of t)n.initWeight();this.updateTreeWeight(e)}toTestString(){const e=[];return this.traverseInorder(this.root,e),e.map(t=>`[${t.getWeight()},${t.getLength()}]${t.getValue()||""}`).join("")}checkWeight(){const e=[];this.traverseInorder(this.root,e);for(const t of e)if(t.getWeight()!=t.getLength()+t.getLeftWeight()+t.getRightWeight())return!1;return!0}getRightmost(){let e=this.root;for(;e.hasRight();)e=e.getRight();return e}traverseInorder(e,t){e&&(this.traverseInorder(e.getLeft(),t),t.push(e),this.traverseInorder(e.getRight(),t))}traversePostorder(e,t){e&&(this.traversePostorder(e.getLeft(),t),this.traversePostorder(e.getRight(),t),t.push(e))}rotateLeft(e){const t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setRight(e.getLeft()),t.hasRight()&&t.getRight().setParent(t),e.setLeft(t),e.getLeft().setParent(e),this.updateWeight(t),this.updateWeight(e)}rotateRight(e){const t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setLeft(e.getRight()),t.hasLeft()&&t.getLeft().setParent(t),e.setRight(t),e.getRight().setParent(e),this.updateWeight(t),this.updateWeight(e)}isLeftChild(e){return e&&e.hasParent()?e.getParent().getLeft()===e:!1}isRightChild(e){return e&&e.hasParent()?e.getParent().getRight()===e:!1}}/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var yt=null;try{yt=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Z(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}Z.prototype.__isLong__;Object.defineProperty(Z.prototype,"__isLong__",{value:!0});function Re(r){return(r&&r.__isLong__)===!0}function Yl(r){var e=Math.clz32(r&-r);return r?31-e:e}Z.isLong=Re;var Xl={},Zl={};function Es(r,e){var t,n,s;return e?(r>>>=0,(s=0<=r&&r<256)&&(n=Zl[r],n)?n:(t=re(r,0,!0),s&&(Zl[r]=t),t)):(r|=0,(s=-128<=r&&r<128)&&(n=Xl[r],n)?n:(t=re(r,r<0?-1:0,!1),s&&(Xl[r]=t),t))}Z.fromInt=Es;function vt(r,e){if(isNaN(r))return e?Fn:It;if(e){if(r<0)return Fn;if(r>=Wh)return _h}else{if(r<=-ef)return He;if(r+1>=ef)return Gh}return r<0?vt(-r,e).neg():re(r%ti|0,r/ti|0,e)}Z.fromNumber=vt;function re(r,e,t){return new Z(r,e,t)}Z.fromBits=re;var Qo=Math.pow;function mu(r,e,t){if(r.length===0)throw Error("empty string");if(typeof e=="number"?(t=e,e=!1):e=!!e,r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return e?Fn:It;if(t=t||10,t<2||36<t)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return mu(r.substring(1),e,t).neg();for(var s=vt(Qo(t,8)),i=It,o=0;o<r.length;o+=8){var c=Math.min(8,r.length-o),u=parseInt(r.substring(o,o+c),t);if(c<8){var f=vt(Qo(t,c));i=i.mul(f).add(vt(u))}else i=i.mul(s),i=i.add(vt(u))}return i.unsigned=e,i}Z.fromString=mu;function bt(r,e){return typeof r=="number"?vt(r,e):typeof r=="string"?mu(r,e):re(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}Z.fromValue=bt;var Ql=65536,ky=1<<24,ti=Ql*Ql,Wh=ti*ti,ef=Wh/2,tf=Es(ky),It=Es(0);Z.ZERO=It;var Fn=Es(0,!0);Z.UZERO=Fn;var Js=Es(1);Z.ONE=Js;var Hh=Es(1,!0);Z.UONE=Hh;var Kc=Es(-1);Z.NEG_ONE=Kc;var Gh=re(-1,2147483647,!1);Z.MAX_VALUE=Gh;var _h=re(-1,-1,!0);Z.MAX_UNSIGNED_VALUE=_h;var He=re(0,-2147483648,!1);Z.MIN_VALUE=He;var E=Z.prototype;E.toInt=function(){return this.unsigned?this.low>>>0:this.low};E.toNumber=function(){return this.unsigned?(this.high>>>0)*ti+(this.low>>>0):this.high*ti+(this.low>>>0)};E.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(He)){var t=vt(e),n=this.div(t),s=n.mul(t).sub(this);return n.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=vt(Qo(e,6),this.unsigned),o=this,c="";;){var u=o.div(i),f=o.sub(u.mul(i)).toInt()>>>0,h=f.toString(e);if(o=u,o.isZero())return h+c;for(;h.length<6;)h="0"+h;c=""+h+c}};E.getHighBits=function(){return this.high};E.getHighBitsUnsigned=function(){return this.high>>>0};E.getLowBits=function(){return this.low};E.getLowBitsUnsigned=function(){return this.low>>>0};E.getNumBitsAbs=function(){if(this.isNegative())return this.eq(He)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};E.isSafeInteger=function(){var e=this.high>>21;return e?this.unsigned?!1:e===-1&&!(this.low===0&&this.high===-2097152):!0};E.isZero=function(){return this.high===0&&this.low===0};E.eqz=E.isZero;E.isNegative=function(){return!this.unsigned&&this.high<0};E.isPositive=function(){return this.unsigned||this.high>=0};E.isOdd=function(){return(this.low&1)===1};E.isEven=function(){return(this.low&1)===0};E.equals=function(e){return Re(e)||(e=bt(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};E.eq=E.equals;E.notEquals=function(e){return!this.eq(e)};E.neq=E.notEquals;E.ne=E.notEquals;E.lessThan=function(e){return this.comp(e)<0};E.lt=E.lessThan;E.lessThanOrEqual=function(e){return this.comp(e)<=0};E.lte=E.lessThanOrEqual;E.le=E.lessThanOrEqual;E.greaterThan=function(e){return this.comp(e)>0};E.gt=E.greaterThan;E.greaterThanOrEqual=function(e){return this.comp(e)>=0};E.gte=E.greaterThanOrEqual;E.ge=E.greaterThanOrEqual;E.compare=function(e){if(Re(e)||(e=bt(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};E.comp=E.compare;E.negate=function(){return!this.unsigned&&this.eq(He)?He:this.not().add(Js)};E.neg=E.negate;E.add=function(e){Re(e)||(e=bt(e));var t=this.high>>>16,n=this.high&65535,s=this.low>>>16,i=this.low&65535,o=e.high>>>16,c=e.high&65535,u=e.low>>>16,f=e.low&65535,h=0,d=0,p=0,m=0;return m+=i+f,p+=m>>>16,m&=65535,p+=s+u,d+=p>>>16,p&=65535,d+=n+c,h+=d>>>16,d&=65535,h+=t+o,h&=65535,re(p<<16|m,h<<16|d,this.unsigned)};E.subtract=function(e){return Re(e)||(e=bt(e)),this.add(e.neg())};E.sub=E.subtract;E.multiply=function(e){if(this.isZero())return this;if(Re(e)||(e=bt(e)),yt){var t=yt.mul(this.low,this.high,e.low,e.high);return re(t,yt.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?Fn:It;if(this.eq(He))return e.isOdd()?He:It;if(e.eq(He))return this.isOdd()?He:It;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(tf)&&e.lt(tf))return vt(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,c=e.high>>>16,u=e.high&65535,f=e.low>>>16,h=e.low&65535,d=0,p=0,m=0,T=0;return T+=o*h,m+=T>>>16,T&=65535,m+=i*h,p+=m>>>16,m&=65535,m+=o*f,p+=m>>>16,m&=65535,p+=s*h,d+=p>>>16,p&=65535,p+=i*f,d+=p>>>16,p&=65535,p+=o*u,d+=p>>>16,p&=65535,d+=n*h+s*f+i*u+o*c,d&=65535,re(m<<16|T,d<<16|p,this.unsigned)};E.mul=E.multiply;E.divide=function(e){if(Re(e)||(e=bt(e)),e.isZero())throw Error("division by zero");if(yt){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?yt.div_u:yt.div_s)(this.low,this.high,e.low,e.high);return re(t,yt.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Fn:It;var n,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Fn;if(e.gt(this.shru(1)))return Hh;i=Fn}else{if(this.eq(He)){if(e.eq(Js)||e.eq(Kc))return He;if(e.eq(He))return Js;var o=this.shr(1);return n=o.div(e).shl(1),n.eq(It)?e.isNegative()?Js:Kc:(s=this.sub(e.mul(n)),i=n.add(s.div(e)),i)}else if(e.eq(He))return this.unsigned?Fn:It;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=It}for(s=this;s.gte(e);){n=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var c=Math.ceil(Math.log(n)/Math.LN2),u=c<=48?1:Qo(2,c-48),f=vt(n),h=f.mul(e);h.isNegative()||h.gt(s);)n-=u,f=vt(n,this.unsigned),h=f.mul(e);f.isZero()&&(f=Js),i=i.add(f),s=s.sub(h)}return i};E.div=E.divide;E.modulo=function(e){if(Re(e)||(e=bt(e)),yt){var t=(this.unsigned?yt.rem_u:yt.rem_s)(this.low,this.high,e.low,e.high);return re(t,yt.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};E.mod=E.modulo;E.rem=E.modulo;E.not=function(){return re(~this.low,~this.high,this.unsigned)};E.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};E.clz=E.countLeadingZeros;E.countTrailingZeros=function(){return this.low?Yl(this.low):Yl(this.high)+32};E.ctz=E.countTrailingZeros;E.and=function(e){return Re(e)||(e=bt(e)),re(this.low&e.low,this.high&e.high,this.unsigned)};E.or=function(e){return Re(e)||(e=bt(e)),re(this.low|e.low,this.high|e.high,this.unsigned)};E.xor=function(e){return Re(e)||(e=bt(e)),re(this.low^e.low,this.high^e.high,this.unsigned)};E.shiftLeft=function(e){return Re(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?re(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):re(0,this.low<<e-32,this.unsigned)};E.shl=E.shiftLeft;E.shiftRight=function(e){return Re(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?re(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):re(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};E.shr=E.shiftRight;E.shiftRightUnsigned=function(e){return Re(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?re(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?re(this.high,0,this.unsigned):re(this.high>>>e-32,0,this.unsigned)};E.shru=E.shiftRightUnsigned;E.shr_u=E.shiftRightUnsigned;E.rotateLeft=function(e){var t;return Re(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?re(this.high,this.low,this.unsigned):e<32?(t=32-e,re(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,re(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))};E.rotl=E.rotateLeft;E.rotateRight=function(e){var t;return Re(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?re(this.high,this.low,this.unsigned):e<32?(t=32-e,re(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,re(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))};E.rotr=E.rotateRight;E.toSigned=function(){return this.unsigned?re(this.low,this.high,!1):this};E.toUnsigned=function(){return this.unsigned?this:re(this.low,this.high,!0)};E.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};E.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};E.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Z.fromBytes=function(e,t,n){return n?Z.fromBytesLE(e,t):Z.fromBytesBE(e,t)};Z.fromBytesLE=function(e,t){return new Z(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Z.fromBytesBE=function(e,t){return new Z(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};typeof BigInt=="function"&&(Z.fromBigInt=function(e,t){var n=Number(BigInt.asIntN(32,e)),s=Number(BigInt.asIntN(32,e>>BigInt(32)));return re(n,s,t)},Z.fromValue=function(e,t){return typeof e=="bigint"?Z.fromBigInt(e,t):bt(e,t)},E.toBigInt=function(){var e=BigInt(this.low>>>0),t=BigInt(this.unsigned?this.high>>>0:this.high);return t<<BigInt(32)|e});var fe=(r=>(r[r.Null=0]="Null",r[r.Boolean=1]="Boolean",r[r.Integer=2]="Integer",r[r.Long=3]="Long",r[r.Double=4]="Double",r[r.String=5]="String",r[r.Bytes=6]="Bytes",r[r.Date=7]="Date",r))(fe||{});class ve extends Hi{constructor(t,n){super(n);a(this,"valueType");a(this,"value");this.valueType=ve.getPrimitiveType(t),this.value=t===void 0?null:t}static of(t,n){return new ve(t,n)}static valueFromBytes(t,n){switch(t){case 0:return null;case 1:return!!n[0];case 2:return n[0]|n[1]<<8|n[2]<<16|n[3]<<24;case 4:{const s=new DataView(n.buffer);return n.forEach(function(i,o){s.setUint8(o,i)}),s.getFloat64(0,!0)}case 5:return new TextDecoder("utf-8").decode(n);case 3:return Z.fromBytesLE(Array.from(n));case 6:return n;case 7:return new Date(Z.fromBytesLE(Array.from(n),!0).toNumber());default:throw new w(y.ErrUnimplemented,`unimplemented type: ${t}`)}}getValueSize(){switch(this.valueType){case 0:return 8;case 1:return 4;case 2:return 4;case 3:return 8;case 4:return 8;case 5:return this.value.length*2;case 6:return this.value.length;case 7:return 8;default:throw new w(y.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}getDataSize(){return{data:this.getValueSize(),meta:this.getMetaUsage()}}toJSON(){return this.valueType===5?`"${Wt(this.value)}"`:`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_PRIMITIVE"}}deepcopy(){const t=ve.of(this.value,this.getCreatedAt());return t.setMovedAt(this.getMovedAt()),t.setRemovedAt(this.getRemovedAt()),t}getType(){return this.valueType}static getPrimitiveType(t){switch(typeof t){case"undefined":return 0;case"boolean":return 1;case"number":return this.isInteger(t)?2:4;case"string":return 5;case"object":if(t===null)return 0;if(t instanceof Z)return 3;if(t instanceof Uint8Array)return 6;if(t instanceof Date)return 7}}static isSupport(t){return ve.getPrimitiveType(t)!==void 0}static isInteger(t){return t%1===0}isNumericType(){const t=this.valueType;return t===2||t===3||t===4}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:return new Uint8Array;case 1:return this.value?new Uint8Array([1]):new Uint8Array([0]);case 2:{const t=this.value;return new Uint8Array([t&255,t>>8&255,t>>16&255,t>>24&255])}case 4:{const t=this.value,n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,t,!0),n}case 5:return new TextEncoder().encode(this.value);case 3:{const n=this.value.toBytesLE();return Uint8Array.from(n)}case 6:return this.value;case 7:{const t=this.value,n=Z.fromNumber(t.getTime(),!0).toBytesLE();return Uint8Array.from(n)}default:throw new w(y.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}}class ea extends jh{constructor(t){super(t);a(this,"prev");a(this,"next");a(this,"movedFrom");this.value=t}static createAfter(t,n){const s=new ea(n),i=t.next;return t.next=s,s.prev=t,s.next=i,i&&(i.prev=s),s}remove(t){return this.value.remove(t)}getCreatedAt(){return this.value.getCreatedAt()}getPositionedAt(){return this.value.getPositionedAt()}release(){this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.prev=void 0,this.next=void 0}getLength(){return this.value.isRemoved()?0:1}getPrev(){return this.prev}getNext(){return this.next}getMovedFrom(){return this.movedFrom}setMovedFrom(t){this.movedFrom=t}getValue(){return this.value}isRemoved(){return this.value.isRemoved()}}class zi{constructor(){a(this,"dummyHead");a(this,"last");a(this,"nodeMapByIndex");a(this,"nodeMapByCreatedAt");const e=ve.of(0,Qs);e.setRemovedAt(Qs),this.dummyHead=new ea(e),this.last=this.dummyHead,this.nodeMapByIndex=new Ui,this.nodeMapByCreatedAt=new Map,this.nodeMapByIndex.insert(this.dummyHead),this.nodeMapByCreatedAt.set(this.dummyHead.getCreatedAt().toIDString(),this.dummyHead)}static create(){return new zi}get length(){return this.nodeMapByIndex.length}findNextBeforeExecutedAt(e,t){let n=this.nodeMapByCreatedAt.get(e.toIDString());if(!n)throw new w(y.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);for(;n.getValue().getMovedAt()&&n.getValue().getMovedAt().after(t)&&n.getMovedFrom();)n=n.getMovedFrom();for(;n.getNext()&&n.getNext().getPositionedAt().after(t);)n=n.getNext();return n}release(e){this.last===e&&(this.last=e.getPrev()),e.release(),this.nodeMapByIndex.delete(e),this.nodeMapByCreatedAt.delete(e.getValue().getCreatedAt().toIDString())}insertAfter(e,t,n=t.getCreatedAt()){const s=this.findNextBeforeExecutedAt(e,n),i=ea.createAfter(s,t);return s===this.last&&(this.last=i),this.nodeMapByIndex.insertAfter(s,i),this.nodeMapByCreatedAt.set(i.getCreatedAt().toIDString(),i),i}moveAfter(e,t,n){let s=this.nodeMapByCreatedAt.get(e.toIDString());if(!s)throw new w(y.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);let i=this.nodeMapByCreatedAt.get(t.toIDString());if(!i)throw new w(y.ErrInvalidArgument,`cant find the given node: ${t.toIDString()}`);if(s!==i&&n.after(i.getPositionedAt())){const o=i.getPrev();let c=i.getNext();for(this.release(i),i=this.insertAfter(s.getCreatedAt(),i.getValue(),n),i.getValue().setMovedAt(n),i.setMovedFrom(o);c&&c.getPositionedAt().after(n);)s=i,i=c,c=i.getNext(),this.release(i),i=this.insertAfter(s.getCreatedAt(),i.getValue(),n),i.getValue().setMovedAt(n),i.setMovedFrom(o)}}insert(e){this.insertAfter(this.last.getCreatedAt(),e)}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}subPathOf(e){const t=this.nodeMapByCreatedAt.get(e.toIDString());if(t)return String(this.nodeMapByIndex.indexOf(t))}purge(e){const t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!t)throw new w(y.ErrInvalidArgument,`fail to find the given createdAt: ${e.getCreatedAt().toIDString()}`);this.release(t)}getByIndex(e){if(e>=this.length)return;const[t,n]=this.nodeMapByIndex.find(e);let s=t;if(e===0&&t===this.dummyHead||n>0)do s&&(s=s.getNext());while(s&&s.isRemoved());return s}getPrevCreatedAt(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());do t=t.getPrev();while(this.dummyHead!==t&&t.isRemoved());return t.getValue().getCreatedAt()}delete(e,t){const n=this.nodeMapByCreatedAt.get(e.toIDString()),s=n.isRemoved();return n.remove(t)&&!s&&this.nodeMapByIndex.splayNode(n),n.getValue()}set(e,t,n){const s=this.nodeMapByCreatedAt.get(e.toIDString());if(!s)throw new w(y.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);return this.insertAfter(s.getCreatedAt(),t,n),this.delete(e,n)}deleteByIndex(e,t){const n=this.getByIndex(e);if(n)return n.remove(t)&&this.nodeMapByIndex.splayNode(n),n.getValue()}getHead(){return this.dummyHead.getValue()}getLast(){return this.last.getValue()}getLastCreatedAt(){return this.last.getCreatedAt()}toTestString(){const e=[];for(const t of this){const n=`${t.getCreatedAt().toIDString()}:${t.getValue().toJSON()}`;t.isRemoved()?e.push(`{${n}}`):e.push(`[${n}]`)}return e.join("")}*[Symbol.iterator](){let e=this.dummyHead.getNext();for(;e;)yield e,e=e.getNext()}}class Be extends rs{constructor(t,n){super(t);a(this,"elements");this.elements=n}static create(t,n){if(!n)return new Be(t,zi.create());const s=zi.create();for(const i of n)s.insertAfter(s.getLastCreatedAt(),i.deepcopy());return new Be(t,s)}subPathOf(t){return this.elements.subPathOf(t)}purge(t){this.elements.purge(t)}insertAfter(t,n,s){this.elements.insertAfter(t,n,s)}moveAfter(t,n,s){this.elements.moveAfter(t,n,s)}get(t){const n=this.elements.getByIndex(t);return n==null?void 0:n.getValue()}getByID(t){const n=this.elements.getByID(t);return n==null?void 0:n.getValue()}getHead(){return this.elements.getHead()}getLast(){return this.elements.getLast()}getPrevCreatedAt(t){return this.elements.getPrevCreatedAt(t)}delete(t,n){return this.elements.delete(t,n)}deleteByIndex(t,n){return this.elements.deleteByIndex(t,n)}set(t,n,s){return this.elements.set(t,n,s)}getLastCreatedAt(){return this.elements.getLastCreatedAt()}get length(){return this.elements.length}*[Symbol.iterator](){for(const t of this.elements)t.isRemoved()||(yield t.getValue())}toTestString(){return this.elements.toTestString()}getDescendants(t){for(const n of this.elements){const s=n.getValue();if(t(s,this))return;s instanceof rs&&s.getDescendants(t)}}getDataSize(){return{data:0,meta:this.getMetaUsage()}}toJSON(){const t=[];for(const n of this)t.push(n.toJSON());return`[${t.join(",")}]`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const t={};for(let n=0;n<this.length;n++){const{createdAt:s,value:i,type:o}=this.get(n).toJSForTest();t[n]={key:String(n),createdAt:s,value:i,type:o}}return{createdAt:this.getCreatedAt().toTestString(),value:t,type:"YORKIE_ARRAY"}}toSortedJSON(){return this.toJSON()}getElements(){return this.elements}deepcopy(){const t=Be.create(this.getCreatedAt());for(const n of this.elements)t.elements.insertAfter(t.getLastCreatedAt(),n.getValue().deepcopy());return t.setRemovedAt(this.getRemovedAt()),t.setMovedAt(this.getMovedAt()),t}}class cs extends Nt{constructor(t,n,s,i){super(t,i);a(this,"prevCreatedAt");a(this,"value");this.prevCreatedAt=n,this.value=s}static create(t,n,s,i){return new cs(t,n,s,i)}execute(t){const n=t.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new w(y.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof Be))throw new w(y.ErrInvalidArgument,"fail to execute, only array can execute add");const s=n,i=this.value.deepcopy();return s.insertAfter(this.prevCreatedAt,i,this.getExecutedAt()),t.registerElement(i,s),{opInfos:[{type:"add",path:t.createPath(this.getParentCreatedAt()),index:Number(s.subPathOf(this.getEffectedCreatedAt()))}],reverseOp:this.toReverseOperation()}}toReverseOperation(){return Qt.create(this.getParentCreatedAt(),this.value.getCreatedAt())}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.ADD.${this.value.toJSON()}`}getPrevCreatedAt(){return this.prevCreatedAt}getValue(){return this.value}setPrevCreatedAt(t){this.prevCreatedAt=t}}class Qt extends Nt{constructor(t,n,s){super(t,s);a(this,"createdAt");this.createdAt=n}static create(t,n,s){return new Qt(t,n,s)}execute(t,n){var f;const s=t.findByCreatedAt(this.getParentCreatedAt());if(!s)throw new w(y.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(s instanceof rs))throw new w(y.ErrInvalidArgument,`only object and array can execute remove: ${s}`);if(n===me.UndoRedo){let h=s.getByID(this.createdAt);for(;h;){if(h.getRemovedAt())return;h=(f=t.findElementPairByCreatedAt(h.getCreatedAt()))==null?void 0:f.parent}}const i=s.subPathOf(this.createdAt),o=this.toReverseOperation(s),c=s.delete(this.createdAt,this.getExecutedAt());return t.registerRemovedElement(c),{opInfos:s instanceof Be?[{type:"remove",path:t.createPath(this.getParentCreatedAt()),index:Number(i)}]:[{type:"remove",path:t.createPath(this.getParentCreatedAt()),key:i}],reverseOp:o}}toReverseOperation(t){if(t instanceof Be){const n=t.getByID(this.createdAt);if(n!==void 0){const s=t.getPrevCreatedAt(this.createdAt);return cs.create(this.getParentCreatedAt(),s,n.deepcopy())}}if(t instanceof Oe){const n=t.subPathOf(this.createdAt);if(n!==void 0){const s=t.get(n);if(s!==void 0)return xs.create(n,s.deepcopy(),this.getParentCreatedAt())}}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.REMOVE.${this.createdAt.toTestString()}`}getCreatedAt(){return this.createdAt}setCreatedAt(t){this.createdAt=t}}class xs extends Nt{constructor(t,n,s,i){super(s,i);a(this,"key");a(this,"value");this.key=t,this.value=n}static create(t,n,s,i){return new xs(t,n,s,i)}execute(t,n){var f;const s=t.findByCreatedAt(this.getParentCreatedAt());if(!s)throw new w(y.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(s instanceof Oe))throw new w(y.ErrInvalidArgument,"fail to execute, only object can execute set");if(n===me.UndoRedo){let h=s;for(;h;){if(h.getRemovedAt())return;h=(f=t.findElementPairByCreatedAt(h.getCreatedAt()))==null?void 0:f.parent}}const i=s.get(this.key),o=this.toReverseOperation(i),c=this.value.deepcopy(),u=s.set(this.key,c,this.getExecutedAt());return n===me.UndoRedo&&t.findByCreatedAt(c.getCreatedAt())&&t.deregisterElement(c),t.registerElement(c,s),u&&t.registerRemovedElement(u),{opInfos:[{type:"set",path:t.createPath(this.getParentCreatedAt()),key:this.key}],reverseOp:o}}toReverseOperation(t){let n=Qt.create(this.getParentCreatedAt(),this.value.getCreatedAt());return t!==void 0&&!t.isRemoved()&&(n=xs.create(this.key,t.deepcopy(),this.getParentCreatedAt())),n}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.SET.${this.key}=${this.value.toSortedJSON()}`}getKey(){return this.key}getValue(){return this.value}}class kt extends Nt{constructor(t,n,s,i){super(t,i);a(this,"prevCreatedAt");a(this,"createdAt");this.prevCreatedAt=n,this.createdAt=s}static create(t,n,s,i){return new kt(t,n,s,i)}execute(t){const n=t.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new w(y.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof Be))throw new w(y.ErrInvalidArgument,"fail to execute, only array can execute move");const s=n,i=this.toReverseOperation(s),o=Number(s.subPathOf(this.createdAt));s.moveAfter(this.prevCreatedAt,this.createdAt,this.getExecutedAt());const c=Number(s.subPathOf(this.createdAt));return{opInfos:[{type:"move",path:t.createPath(this.getParentCreatedAt()),index:c,previousIndex:o}],reverseOp:i}}toReverseOperation(t){const n=t.getPrevCreatedAt(this.createdAt);return kt.create(this.getParentCreatedAt(),n,this.createdAt)}getEffectedCreatedAt(){return this.createdAt}toTestString(){return`${this.getParentCreatedAt().toTestString()}.MOVE`}getPrevCreatedAt(){return this.prevCreatedAt}getCreatedAt(){return this.createdAt}setPrevCreatedAt(t){this.prevCreatedAt=t}setCreatedAt(t){this.createdAt=t}}class es{constructor(e,t,n,s){a(this,"key");a(this,"value");a(this,"updatedAt");a(this,"_isRemoved");this.key=e,this.value=t,this.updatedAt=n,this._isRemoved=s}static of(e,t,n,s){return new es(e,t,n,s)}getKey(){return this.key}getValue(){return this.value}getUpdatedAt(){return this.updatedAt}isRemoved(){return this._isRemoved}toIDString(){return`${this.updatedAt.toIDString()}:${this.key}`}getRemovedAt(){if(this._isRemoved)return this.updatedAt}getDataSize(){return{data:(this.key.length+this.value.length)*2,meta:Gt}}}class Kn{constructor(){a(this,"nodeMapByKey");a(this,"numberOfRemovedElement");this.nodeMapByKey=new Map,this.numberOfRemovedElement=0}static create(){return new Kn}getNodeMapByKey(){return this.nodeMapByKey}set(e,t,n){const s=this.nodeMapByKey.get(e);if(s&&s.isRemoved()&&n.after(s.getUpdatedAt())&&(this.numberOfRemovedElement-=1),s===void 0||n.after(s.getUpdatedAt())){const i=es.of(e,t,n,!1);return this.nodeMapByKey.set(e,i),s!==void 0&&s.isRemoved()?[s,i]:[void 0,i]}return s.isRemoved()?[s,void 0]:[void 0,void 0]}setInternal(e,t,n,s){const i=es.of(e,t,n,s);this.nodeMapByKey.set(e,i),s&&this.numberOfRemovedElement++}remove(e,t){const n=this.nodeMapByKey.get(e),s=[];if(n===void 0||t.after(n.getUpdatedAt())){if(n===void 0){this.numberOfRemovedElement+=1;const c=es.of(e,"",t,!0);return this.nodeMapByKey.set(e,c),s.push(c),s}const i=n.isRemoved();i||(this.numberOfRemovedElement+=1),i&&s.push(n);const o=es.of(e,n.getValue(),t,!0);return this.nodeMapByKey.set(e,o),s.push(o),s}return s}has(e){if(this.nodeMapByKey.has(e)){const t=this.nodeMapByKey.get(e);return t!==void 0&&!t.isRemoved()}return!1}get(e){if(this.nodeMapByKey.has(e))return this.nodeMapByKey.get(e).getValue()}deepcopy(){const e=new Kn;for(const[,t]of this.nodeMapByKey)e.setInternal(t.getKey(),t.getValue(),t.getUpdatedAt(),t.isRemoved());return e}toJSON(){if(!this.size())return"{}";const e=[];for(const[t,n]of this.nodeMapByKey)n.isRemoved()||e.push(`"${Wt(t)}":"${Wt(n.getValue())}"`);return`{${e.join(",")}}`}size(){return this.nodeMapByKey.size-this.numberOfRemovedElement}toObject(){const e={};for(const[t,n]of this.nodeMapByKey)n.isRemoved()||(e[t]=n.getValue());return e}*[Symbol.iterator](){for(const[,e]of this.nodeMapByKey)yield e}purge(e){const t=this.nodeMapByKey.get(e.getKey());t==null||t.toIDString()!=e.toIDString()||(this.nodeMapByKey.delete(e.getKey()),this.numberOfRemovedElement--)}}function Tt(r){if(r instanceof Map){const e=Array.from(r);return new Map(JSON.parse(JSON.stringify(e)))}return JSON.parse(JSON.stringify(r))}const Yh=r=>r?Object.entries(r).length===0:!0,ri=r=>{const e={};for(const[t,n]of Object.entries(r))e[t]=JSON.stringify(n);return e},Mn=r=>{const e={};for(const[t,n]of Object.entries(r))e[t]=JSON.parse(n);return e};function xy(r){return r?rf(r.live)+rf(r.gc):0}function rf(r){return r.data+r.meta}function Pe(r,...e){for(const t of e)r.data+=t.data,r.meta+=t.meta}function vs(r,e){r.data-=e.data,r.meta-=e.meta}class qi{constructor(e){a(this,"attributes");a(this,"content");this.attributes=Kn.create(),this.content=e}static create(e){return new qi(e)}get length(){return this.content.length}substring(e,t){const n=new qi(this.content.substring(e,t));return n.attributes=this.attributes.deepcopy(),n}setAttr(e,t,n){return this.attributes.set(e,t,n)}getAttrs(){return this.attributes}toString(){return this.content}getDataSize(){const e={data:0,meta:0};e.data+=this.content.length*2;for(const t of this.attributes){const n=t.getDataSize();e.meta+=n.meta,e.data+=n.data}return e}toJSON(){const e=Wt(this.content),t=this.attributes.toObject(),n=[];for(const[s,i]of Object.entries(t)){const o=JSON.parse(i),c=typeof o=="string"?`"${Wt(s)}":"${Wt(o)}"`:`"${Wt(s)}":${String(o)}`;n.push(c)}return n.sort(),n.length===0?`{"val":"${e}"}`:`{"attrs":{${n.join(",")}},"val":"${e}"}`}getAttributes(){return this.attributes.toObject()}getContent(){return this.content}purge(e){this.attributes&&e instanceof es&&this.attributes.purge(e)}getGCPairs(){const e=[];for(const t of this.attributes)t.getRemovedAt()&&e.push({parent:this,child:t});return e}}class tt extends Hi{constructor(t,n){super(n);a(this,"rgaTreeSplit");this.rgaTreeSplit=t}static create(t,n){return new tt(t,n)}edit(t,n,s,i,o){const c=n?qi.create(n):void 0;if(c&&i)for(const[m,T]of Object.entries(i))c.setAttr(m,T,s);const[u,f,h,d]=this.rgaTreeSplit.edit(t,s,c,o);return[d.map(m=>({...m,value:m.value?{attributes:Mn(m.value.getAttributes()),content:m.value.getContent()}:{attributes:void 0,content:""},type:"content"})),f,h,[u,u]]}setStyle(t,n,s,i){const o={data:0,meta:0},[,c,u]=this.rgaTreeSplit.findNodeWithSplit(t[1],s),[,f,h]=this.rgaTreeSplit.findNodeWithSplit(t[0],s);Pe(o,c,f);const d=[],p=this.rgaTreeSplit.findBetween(h,u),m=[];for(const A of p){const N=A.getCreatedAt().getActorID();let R=qc;i!=null&&(R=i.get(N)?i.get(N):0n),A.canStyle(s,R)&&m.push(A)}const T=[];for(const A of m){if(A.isRemoved())continue;const[N,R]=this.rgaTreeSplit.findIndexesFromRange(A.createPosRange());d.push({type:"style",actor:s.getActorID(),from:N,to:R,value:{attributes:Mn(n)}});for(const[M,V]of Object.entries(n)){const[$]=A.getValue().setAttr(M,V,s);$!==void 0&&T.push({parent:A.getValue(),child:$});const Y=A.getValue().getAttrs().getNodeMapByKey().get(M);Y!==void 0&&Pe(o,Y.getDataSize())}}return[T,o,d]}indexRangeToPosRange(t,n){const s=this.rgaTreeSplit.indexToPos(t);return t===n?[s,s]:[s,this.rgaTreeSplit.indexToPos(n)]}get length(){return this.rgaTreeSplit.length}getTreeByIndex(){return this.rgaTreeSplit.getTreeByIndex()}getTreeByID(){return this.rgaTreeSplit.getTreeByID()}getDataSize(){const t={data:0,meta:0};for(const n of this.rgaTreeSplit){if(n.isRemoved())continue;const s=n.getDataSize();t.data+=s.data,t.meta+=s.meta}return{data:t.data,meta:t.meta+this.getMetaUsage()}}toJSON(){const t=[];for(const n of this.rgaTreeSplit)n.isRemoved()||t.push(n.getValue().toJSON());return`[${t.join(",")}]`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TEXT"}}toString(){return this.rgaTreeSplit.toString()}values(){const t=[];for(const n of this.rgaTreeSplit)if(!n.isRemoved()){const s=n.getValue();t.push({attributes:Mn(s.getAttributes()),content:s.getContent()})}return t}getRGATreeSplit(){return this.rgaTreeSplit}toTestString(){return this.rgaTreeSplit.toTestString()}deepcopy(){const t=new tt(this.rgaTreeSplit.deepcopy(),this.getCreatedAt());return t.setRemovedAt(this.getRemovedAt()),t.setMovedAt(this.getMovedAt()),t}findIndexesFromRange(t){return this.rgaTreeSplit.findIndexesFromRange(t)}getGCPairs(){const t=[];for(const n of this.rgaTreeSplit){n.getRemovedAt()&&t.push({parent:this.rgaTreeSplit,child:n});for(const s of n.getValue().getGCPairs())t.push(s)}return t}}class Gi extends Nt{constructor(t,n,s,i,o,c){super(t,c);a(this,"fromPos");a(this,"toPos");a(this,"content");a(this,"attributes");this.fromPos=n,this.toPos=s,this.content=i,this.attributes=o}static create(t,n,s,i,o,c){return new Gi(t,n,s,i,o,c)}execute(t,n,s){const i=t.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new w(y.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof tt))throw new w(y.ErrInvalidArgument,"fail to execute, only Text can execute edit");const o=i,[c,u,f]=o.edit([this.fromPos,this.toPos],this.content,this.getExecutedAt(),Object.fromEntries(this.attributes),s);t.acc(f);for(const h of u)t.registerGCPair(h);return{opInfos:c.map(({from:h,to:d,value:p})=>({type:"edit",from:h,to:d,value:p,path:t.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const t=this.getParentCreatedAt().toTestString(),n=this.fromPos.toTestString(),s=this.toPos.toTestString(),i=this.content;return`${t}.EDIT(${n},${s},${i})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContent(){return this.content}getAttributes(){return this.attributes||new Map}}class _i extends Nt{constructor(t,n,s,i,o){super(t,o);a(this,"fromPos");a(this,"toPos");a(this,"attributes");this.fromPos=n,this.toPos=s,this.attributes=i}static create(t,n,s,i,o){return new _i(t,n,s,i,o)}execute(t,n,s){const i=t.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new w(y.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof tt))throw new w(y.ErrInvalidArgument,"fail to execute, only Text can execute edit");const o=i,[c,u,f]=o.setStyle([this.fromPos,this.toPos],this.attributes?Object.fromEntries(this.attributes):{},this.getExecutedAt(),s);t.acc(u);for(const h of c)t.registerGCPair(h);return{opInfos:f.map(({from:h,to:d,value:p})=>({type:"style",from:h,to:d,value:p,path:t.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const t=this.getParentCreatedAt().toTestString(),n=this.fromPos.toTestString(),s=this.toPos.toTestString(),i=this.attributes;return`${t}.STYL(${n},${s},${JSON.stringify(i)})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}}const Ey=2,Cy="root",_t="text";function hi(r,e,t=!1){let n=0;const s=t?r.allChildren:r.children;for(let i=0;i<e;i++){const o=s[i];!o||!t&&o.isRemoved||(n+=o.paddedSize(t))}return n}class Py{constructor(e,t=[]){a(this,"type");a(this,"parent");a(this,"_children");a(this,"visibleSize");a(this,"totalSize");if(this.type=e,this.visibleSize=0,this.totalSize=0,this._children=t,this.isText&&this._children.length>0)throw new w(y.ErrRefused,"Text node cannot have children")}updateAncestorsSize(e,t=!1){let n=this.parent;for(;n;){if(t)n.totalSize+=e;else if(n.visibleSize+=e,n.isRemoved)break;n=n.parent}}updateDescendantsSize(e=!1){let t=0;for(const n of this._children){const s=n.updateDescendantsSize(e);!e&&n.isRemoved||(t+=s)}return e?this.totalSize+=t:this.visibleSize+=t,this.paddedSize(e)}get isText(){return this.type===_t}paddedSize(e=!1){let t=this.visibleSize;return e&&(t=this.totalSize),this.isText||(t+=Ey),t}isAncestorOf(e){return Ny(this,e)}get nextSibling(){const e=this.parent.findOffset(this),t=this.parent.children[e+1];if(t)return t}get prevSibling(){const e=this.parent.findOffset(this),t=this.parent.children[e-1];if(t)return t}splitText(e,t){const n={data:0,meta:0};if(e===0||e===this.visibleSize)return[void 0,n];const s=this.value.slice(0,e),i=this.value.slice(e);if(!i.length)return[void 0,n];const o=this.getDataSize();this.value=s;const c=this.cloneText(e+t);return c.value=i,this.parent.insertAfterInternal(c,this),Pe(n,this.getDataSize(),c.getDataSize()),vs(n,o),[c,n]}get children(){return this._children.filter(e=>!e.isRemoved)}get allChildren(){return[...this._children]}hasTextChild(){return this.children.length>0&&this.children.every(e=>e.isText)}getChildrenText(){return this.isText?this.value:this.hasTextChild()?this.children.map(e=>e.value).join(""):""}append(...e){if(this.isText)throw new w(y.ErrRefused,"Text node cannot have children");this._children.push(...e);for(const t of e)t.parent=this,t.updateAncestorsSize(t.paddedSize()),t.updateAncestorsSize(t.paddedSize(!0),!0)}prepend(...e){if(this.isText)throw new w(y.ErrRefused,"Text node cannot have children");this._children.unshift(...e);for(const t of e)t.parent=this}insertBefore(e,t){if(this.isText)throw new w(y.ErrRefused,"Text node cannot have children");const n=this._children.indexOf(t);if(n===-1)throw new w(y.ErrInvalidArgument,"child not found");this.insertAtInternal(e,n),e.updateAncestorsSize(e.paddedSize()),e.updateAncestorsSize(e.paddedSize(!0),!0)}insertAfter(e,t){if(this.isText)throw new w(y.ErrRefused,"Text node cannot have children");const n=this._children.indexOf(t);if(n===-1)throw new w(y.ErrInvalidArgument,"child not found");this.insertAtInternal(e,n+1),e.updateAncestorsSize(e.paddedSize()),e.updateAncestorsSize(e.paddedSize(!0),!0)}insertAt(e,t){if(this.isText)throw new w(y.ErrRefused,"Text node cannot have children");this.insertAtInternal(e,t),e.updateAncestorsSize(e.paddedSize()),e.updateAncestorsSize(e.paddedSize(!0),!0)}removeChild(e){if(this.isText)throw new w(y.ErrRefused,"Text node cannot have children");const t=this._children.indexOf(e);if(t===-1)throw new w(y.ErrInvalidArgument,"child not found");this._children.splice(t,1),e.updateAncestorsSize(-e.paddedSize(!0),!0),e.parent=void 0}splitElement(e,t){const n={data:0,meta:0},s=this.getDataSize(),i=this.cloneElement(t);this.parent.insertAfterInternal(i,this),i.updateAncestorsSize(i.paddedSize()),i.updateAncestorsSize(i.paddedSize(!0),!0);const o=this.children.slice(0,e),c=this.children.slice(e);this._children=o,i._children=c,this.visibleSize=this._children.reduce((u,f)=>u+f.paddedSize(),0),this.totalSize=this._children.reduce((u,f)=>u+f.paddedSize(!0),0),i.visibleSize=i._children.reduce((u,f)=>u+f.paddedSize(!0),0),i.totalSize=i._children.reduce((u,f)=>u+f.paddedSize(!0),0);for(const u of i._children)u.parent=i;return Pe(n,this.getDataSize(),i.getDataSize()),vs(n,s),[i,n]}insertAfterInternal(e,t){if(this.isText)throw new w(y.ErrRefused,"Text node cannot have children");const n=this._children.indexOf(t);if(n===-1)throw new w(y.ErrInvalidArgument,"child not found");this.insertAtInternal(e,n+1)}insertAtInternal(e,t){if(this.isText)throw new w(y.ErrRefused,"Text node cannot have children");this._children.splice(t,0,e),e.parent=this}findOffset(e,t=!1){if(this.isText)throw new w(y.ErrRefused,"Text node cannot have children");if(t)return this._children.indexOf(e);if(e.isRemoved){const n=this._children.indexOf(e);return this.allChildren.splice(0,n).filter(i=>!i.isRemoved).length}return this.children.indexOf(e)}findBranchOffset(e){if(this.isText)throw new w(y.ErrRefused,"Text node cannot have children");let t=e;for(;t;){const n=this._children.indexOf(t);if(n!==-1)return n;t=t.parent}return-1}}function Ny(r,e){if(r===e)return!1;for(;e.parent;){if(e.parent===r)return!0;e=e.parent}return!1}var Te=(r=>(r.Start="Start",r.End="End",r.Text="Text",r))(Te||{});function Xh(r,e,t,n,s=!1){if(e>t)throw new w(y.ErrInvalidArgument,`from is greater than to: ${e} > ${t}`);const i=s?r.totalSize:r.visibleSize;if(e>i)throw new w(y.ErrInvalidArgument,`from is out of range: ${e} > ${i}`);if(t>i)throw new w(y.ErrInvalidArgument,`to is out of range: ${t} > ${i}`);if(e===t)return;let o=0;const c=s?r._children:r.children;for(const u of c){if(e-u.paddedSize(s)<o&&o<t){const f=u.isText?e-o:e-o-1,h=u.isText?t-o:t-o-1,d=s?u.totalSize:u.visibleSize,p=!u.isText&&f<0,m=!u.isText&&h>d;(u.isText||p)&&n([u,u.isText?"Text":"Start"],m),Xh(u,Math.max(0,f),Math.min(h,d),n,s),m&&n([u,"End"],m)}o+=u.paddedSize(s)}}function Zh(r,e,t=0){for(const n of r.children)Zh(n,e,t+1);e(r,t)}function pa(r,e,t=0){for(const n of r._children)pa(n,e,t+1);e(r,t)}function Vc(r,e,t=!0){if(e>r.visibleSize)throw new w(y.ErrInvalidArgument,`index is out of range: ${e} > ${r.visibleSize}`);if(r.isText)return{node:r,offset:e};let n=0,s=0;for(const i of r.children){if(t&&i.isText&&i.visibleSize>=e-s)return Vc(i,e-s,t);if(e===s)return{node:r,offset:n};if(!t&&i.paddedSize()===e-s)return{node:r,offset:n+1};if(i.paddedSize()>e-s)return Vc(i,e-s-1,t);s+=i.paddedSize(),n+=1}return{node:r,offset:n}}function Qh(r){return r.isText||r.children.length===0?r:Qh(r.children[0])}function Dy(r,e){if(r.visibleSize<e)throw new w(y.ErrInvalidArgument,"unacceptable path");for(let t=0;t<r.children.length;t++){const n=r.children[t];if(n.visibleSize<e)e-=n.visibleSize;else{r=n;break}}return{node:r,offset:e}}class Oy{constructor(e){a(this,"root");this.root=e}tokensBetween(e,t,n,s=!1){Xh(this.root,e,t,n,s)}traverse(e){Zh(this.root,e,0)}traverseAll(e){pa(this.root,e,0)}findTreePos(e,t=!0){return Vc(this.root,e,t)}treePosToPath(e){const t=[];let n=e.node;if(n.isText){const s=n.parent.findOffset(n);if(s===-1)throw new w(y.ErrInvalidArgument,"invalid treePos");const i=hi(n.parent,s);t.push(i+e.offset),n=n.parent}else if(n.hasTextChild()){const s=hi(n,e.offset);t.push(s)}else t.push(e.offset);for(;n.parent;){const s=n.parent.findOffset(n);if(s===-1)throw new w(y.ErrInvalidArgument,"invalid treePos");t.push(s),n=n.parent}return t.reverse()}pathToIndex(e){const t=this.pathToTreePos(e);return this.indexOf(t)}pathToTreePos(e){if(!e.length)throw new w(y.ErrInvalidArgument,"unacceptable path");let t=this.root;for(let n=0;n<e.length-1;n++){const s=e[n];if(t=t.children[s],!t)throw new w(y.ErrInvalidArgument,"unacceptable path")}if(t.hasTextChild())return Dy(t,e[e.length-1]);if(t.children.length<e[e.length-1])throw new w(y.ErrInvalidArgument,"unacceptable path");return{node:t,offset:e[e.length-1]}}getRoot(){return this.root}get size(){return this.root.visibleSize}findPostorderRight(e){const{node:t,offset:n}=e;if(t.isText){if(t.visibleSize===n){const s=t.nextSibling;return s||t.parent}return t}return t.children.length===n?t:Qh(t.children[n])}indexOf(e,t=!1){let{node:n}=e;const{offset:s}=e;let i=0,o=1;if(n.isText){i+=s;const c=n.parent,u=c.findOffset(n,t);if(u===-1)throw new w(y.ErrInvalidArgument,"invalid pos");i+=hi(c,u,t),n=n.parent}else i+=hi(n,s,t);for(;n!=null&&n.parent;){const c=n.parent,u=c.findOffset(n,t);if(u===-1)throw new w(y.ErrInvalidArgument,"invalid pos");i+=hi(c,u,t),o++,n=n.parent}return i+o-1}indexToPath(e){const t=this.findTreePos(e);return this.treePosToPath(t)}}const By=(r,e)=>r===e?0:r<e?-1:1;class Ry{constructor(e,t,n){a(this,"key");a(this,"value");a(this,"left");a(this,"right");a(this,"isRed");this.key=e,this.value=t,this.isRed=n}}class Ly{constructor(e){a(this,"stack");this.stack=[],this.traverseInorder(e)}traverseInorder(e){e&&(this.traverseInorder(e.left),this.stack.push({key:e.key,value:e.value}),this.traverseInorder(e.right))}}class ed{constructor(e){a(this,"root");a(this,"comparator");a(this,"counter");this.comparator=typeof e<"u"?e:By,this.counter=0}put(e,t){return this.root=this.putInternal(e,t,this.root),this.root.isRed=!1,t}get(e){const t=this.getInternal(e,this.root);return t?t.value:void 0}remove(e){!this.isRed(this.root.left)&&!this.isRed(this.root.right)&&(this.root.isRed=!0),this.root=this.removeInternal(this.root,e),this.root&&(this.root.isRed=!1)}getIterator(){return new Ly(this.root)}values(){const e=[];for(const t of this.getIterator().stack)e.push(t.value);return e}floorEntry(e){let t=this.root,n;for(;t;){const s=this.comparator(e,t.key);if(s===0)return t;s<0?t=t.left:(n=t,t=t.right)}return n}lastEntry(){if(!this.root)return this.root;let e=this.root;for(;e.right;)e=e.right;return e}size(){return this.counter}isEmpty(){return this.counter===0}getInternal(e,t){for(;t;){const n=this.comparator(e,t.key);if(n===0)return t;n<0?t=t.left:n>0&&(t=t.right)}}putInternal(e,t,n){if(!n)return this.counter+=1,new Ry(e,t,!0);const s=this.comparator(e,n.key);return s<0?n.left=this.putInternal(e,t,n.left):s>0?n.right=this.putInternal(e,t,n.right):n.value=t,this.isRed(n.right)&&!this.isRed(n.left)&&(n=this.rotateLeft(n)),this.isRed(n.left)&&this.isRed(n.left.left)&&(n=this.rotateRight(n)),this.isRed(n.left)&&this.isRed(n.right)&&this.flipColors(n),n}removeInternal(e,t){if(this.comparator(t,e.key)<0)!this.isRed(e.left)&&!this.isRed(e.left.left)&&(e=this.moveRedLeft(e)),e.left=this.removeInternal(e.left,t);else{if(this.isRed(e.left)&&(e=this.rotateRight(e)),this.comparator(t,e.key)===0&&!e.right){this.counter-=1;return}if(!this.isRed(e.right)&&!this.isRed(e.right.left)&&(e=this.moveRedRight(e)),this.comparator(t,e.key)===0){this.counter-=1;const n=this.min(e.right);e.value=n.value,e.key=n.key,e.right=this.removeMin(e.right)}else e.right=this.removeInternal(e.right,t)}return this.fixUp(e)}min(e){return e.left?this.min(e.left):e}removeMin(e){if(e.left)return!this.isRed(e.left)&&!this.isRed(e.left.left)&&(e=this.moveRedLeft(e)),e.left=this.removeMin(e.left),this.fixUp(e)}fixUp(e){return this.isRed(e.right)&&(e=this.rotateLeft(e)),this.isRed(e.left)&&this.isRed(e.left.left)&&(e=this.rotateRight(e)),this.isRed(e.left)&&this.isRed(e.right)&&this.flipColors(e),e}moveRedLeft(e){return this.flipColors(e),this.isRed(e.right.left)&&(e.right=this.rotateRight(e.right),e=this.rotateLeft(e),this.flipColors(e)),e}moveRedRight(e){return this.flipColors(e),this.isRed(e.left.left)&&(e=this.rotateRight(e),this.flipColors(e)),e}isRed(e){return e&&e.isRed}rotateLeft(e){const t=e.right;return e.right=t.left,t.left=e,t.isRed=t.left.isRed,t.left.isRed=!0,t}rotateRight(e){const t=e.left;return e.left=t.right,t.right=e,t.isRed=t.right.isRed,t.right.isRed=!0,t}flipColors(e){e.isRed=!e.isRed,e.left.isRed=!e.left.isRed,e.right.isRed=!e.right.isRed}}class xt{constructor(e,t){a(this,"parentID");a(this,"leftSiblingID");this.parentID=e,this.leftSiblingID=t}static of(e,t){return new xt(e,t)}static fromTreePos(e){const{offset:t}=e;let{node:n}=e,s;return n.isText?(n.parent.children[0]===n&&t===0?s=n.parent:s=n,n=n.parent):t===0?s=n:s=n.children[t-1],xt.of(n.id,Ne.of(s.getCreatedAt(),s.getOffset()+t))}getParentID(){return this.parentID}static fromStruct(e){return xt.of(Ne.of(wt.fromStruct(e.parentID.createdAt),e.parentID.offset),Ne.of(wt.fromStruct(e.leftSiblingID.createdAt),e.leftSiblingID.offset))}toStruct(){return{parentID:{createdAt:this.getParentID().getCreatedAt().toStruct(),offset:this.getParentID().getOffset()},leftSiblingID:{createdAt:this.getLeftSiblingID().getCreatedAt().toStruct(),offset:this.getLeftSiblingID().getOffset()}}}toTreeNodePair(e){const t=this.getParentID(),n=this.getLeftSiblingID(),s=e.findFloorNode(t);let i=e.findFloorNode(n);if(!s||!i)throw new w(y.ErrRefused,`cannot find node of CRDTTreePos(${t.toTestString()}, ${n.toTestString()})`);return!n.equals(t)&&n.getOffset()>0&&n.getOffset()===i.id.getOffset()&&i.insPrevID&&(i=e.findFloorNode(i.insPrevID)),[s,i]}getLeftSiblingID(){return this.leftSiblingID}equals(e){return this.getParentID().getCreatedAt().equals(e.getParentID().getCreatedAt())&&this.getParentID().getOffset()===e.getParentID().getOffset()&&this.getLeftSiblingID().getCreatedAt().equals(e.getLeftSiblingID().getCreatedAt())&&this.getLeftSiblingID().getOffset()===e.getLeftSiblingID().getOffset()}}class Ne{constructor(e,t){a(this,"createdAt");a(this,"offset");this.createdAt=e,this.offset=t}static of(e,t){return new Ne(e,t)}static fromStruct(e){return Ne.of(wt.fromStruct(e.createdAt),e.offset)}static createComparator(){return(e,t)=>{const n=e.getCreatedAt().compare(t.getCreatedAt());return n!==0?n:e.getOffset()>t.getOffset()?1:e.getOffset()<t.getOffset()?-1:0}}getCreatedAt(){return this.createdAt}equals(e){return this.createdAt.compare(e.createdAt)===0&&this.offset===e.offset}getOffset(){return this.offset}setOffset(e){this.offset=e}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}toTestString(){return`${this.createdAt.toTestString()}/${this.offset}`}}class et extends Py{constructor(t,n,s,i,o){super(n);a(this,"id");a(this,"removedAt");a(this,"attrs");a(this,"insPrevID");a(this,"insNextID");a(this,"_value","");this.id=t,this.removedAt=o,i&&(this.attrs=i),typeof s=="string"?this.value=s:Array.isArray(s)&&(this._children=s)}toIDString(){return this.id.toIDString()}getRemovedAt(){return this.removedAt}static create(t,n,s,i){return new et(t,n,s,i)}deepcopy(){var n;const t=new et(this.id,this.type);return t.removedAt=this.removedAt,t._value=this._value,t.visibleSize=this.visibleSize,t.totalSize=this.totalSize,t.attrs=(n=this.attrs)==null?void 0:n.deepcopy(),t._children=this._children.map(s=>{const i=s.deepcopy();return i.parent=t,i}),t.insPrevID=this.insPrevID,t.insNextID=this.insNextID,t}get value(){if(!this.isText)throw new w(y.ErrInvalidType,`cannot get value of element node: ${this.type}`);return this._value}set value(t){if(!this.isText)throw new w(y.ErrInvalidType,`cannot set value of element node: ${this.type}`);this._value=t,this.visibleSize=t.length,this.totalSize=t.length}get isRemoved(){return!!this.removedAt}remove(t){return this.removedAt?(t.after(this.removedAt)&&(this.removedAt=t),!1):(this.removedAt=t,this.updateAncestorsSize(-this.paddedSize()),!0)}cloneText(t){return new et(Ne.of(this.id.getCreatedAt(),t),this.type,void 0,void 0,this.removedAt)}cloneElement(t){return new et(Ne.of(t(),0),this.type,void 0,void 0,this.removedAt)}split(t,n,s){const[i,o]=this.isText?this.splitText(n,this.id.getOffset()):this.splitElement(n,s);if(i){if(i.insPrevID=this.id,this.insNextID){const c=t.findFloorNode(this.insNextID);c.insPrevID=i.id,i.insNextID=this.insNextID}this.insNextID=i.id,t.registerNode(i)}return[i,o]}getCreatedAt(){return this.id.getCreatedAt()}getOffset(){return this.id.getOffset()}canDelete(t,n,s){return n?!!(!this.removedAt||!s&&(t!=null&&t.after(this.removedAt))):!1}canStyle(t,n){return this.isText?!1:this.getCreatedAt().getLamport()<=n&&(!this.removedAt||t.after(this.removedAt))}setAttrs(t,n){this.attrs||(this.attrs=new Kn);const s=[];for(const[i,o]of Object.entries(t))s.push(this.attrs.set(i,o,n));return s}purge(t){this.attrs&&this.attrs.purge(t)}getDataSize(){const t={data:0,meta:0};if(this.isText&&(t.data+=this.visibleSize*2),this.id&&(t.meta+=Gt),this.removedAt&&(t.meta+=Gt),this.attrs)for(const n of this.attrs){if(n.getRemovedAt())continue;const s=n.getDataSize();t.meta+=s.meta,t.data+=s.data}return t}getGCPairs(){const t=[];if(!this.attrs)return t;for(const n of this.attrs)n.getRemovedAt()&&t.push({parent:this,child:n});return t}}function jc(r){var t;if(r.isText){const n=r;return{type:n.type,value:n.value}}const e={type:r.type,children:r.children.map(jc)};return r.attrs&&(e.attributes=Mn((t=r.attrs)==null?void 0:t.toObject())),e}function pu(r){if(r.isText)return r.value;let e="";return r.attrs&&r.attrs.size()&&(e=" "+Array.from(r.attrs).filter(t=>!t.isRemoved()).sort((t,n)=>t.getKey().localeCompare(n.getKey())).map(t=>{const n=JSON.parse(t.getValue());return typeof n=="string"?`${t.getKey()}="${n}"`:`${t.getKey()}="${Wt(t.getValue())}"`}).join(" ")),`<${r.type}${e}>${r.children.map(t=>pu(t)).join("")}</${r.type}>`}function td(r){if(r.isText){const e=r;return{type:e.type,value:e.value,visibleSize:e.visibleSize,isRemoved:e.isRemoved}}return{type:r.type,children:r.children.map(td),visibleSize:r.visibleSize,isRemoved:r.isRemoved}}class rt extends Hi{constructor(t,n){super(n);a(this,"indexTree");a(this,"nodeMapByID");this.indexTree=new Oy(t),this.nodeMapByID=new ed(Ne.createComparator()),this.indexTree.traverseAll(s=>{this.nodeMapByID.put(s.id,s)})}static create(t,n){return new rt(t,n)}findFloorNode(t){const n=this.nodeMapByID.floorEntry(t);if(!(!n||!n.key.getCreatedAt().equals(t.getCreatedAt())))return n.value}registerNode(t){this.nodeMapByID.put(t.id,t)}findNodesAndSplitText(t,n){let s={data:0,meta:0};const[i,o]=t.toTreeNodePair(this);let c=o;const u=i===c,f=c.parent&&!u?c.parent:i;if(c.isText){const[,h]=c.split(this,t.getLeftSiblingID().getOffset()-c.id.getOffset());s=h}if(n){const h=f.allChildren,d=u?0:h.indexOf(c)+1;for(let p=d;p<h.length;p++){const m=h[p];if(!m.id.getCreatedAt().after(n))break;c=m}}return[[f,c],s]}style(t,n,s,i){const o={data:0,meta:0},[[c,u],f]=this.findNodesAndSplitText(t[0],s),[[h,d],p]=this.findNodesAndSplitText(t[1],s);Pe(o,p,f);const m=[],T=n?Mn(n):{},A=[];return this.traverseInPosRange(c,u,h,d,([N,R])=>{var $;const M=N.getCreatedAt().getActorID();let V=qc;if(i!=null&&(V=i.get(M)?i.get(M):0n),N.canStyle(s,V)&&n){const Y=N.setAttrs(n,s),j=Y.reduce((ue,[,Ie])=>(Ie&&(ue[Ie.getKey()]=T[Ie.getKey()]),ue),{}),ee=N.parent,oe=N.prevSibling||N.parent;Object.keys(j).length>0&&m.push({type:"style",from:this.toIndex(ee,oe),to:this.toIndex(N,N),fromPath:this.toPath(ee,oe),toPath:this.toPath(N,N),actor:s.getActorID(),value:j});for(const[ue]of Y)ue&&A.push({parent:N,child:ue});for(const[ue]of Object.entries(T)){const Ie=($=N.attrs)==null?void 0:$.getNodeMapByKey().get(ue);Ie!==void 0&&R!==Te.End&&Pe(o,Ie.getDataSize())}}}),[A,m,o]}removeStyle(t,n,s,i){const o={data:0,meta:0},[[c,u],f]=this.findNodesAndSplitText(t[0],s),[[h,d],p]=this.findNodesAndSplitText(t[1],s);Pe(o,p,f);const m=[],T=[];return this.traverseInPosRange(c,u,h,d,([A])=>{const N=A.getCreatedAt().getActorID();let R=qc;if(i!=null&&(R=i.get(N)?i.get(N):0n),A.canStyle(s,R)&&n){A.attrs||(A.attrs=new Kn);for(const $ of n){const Y=A.attrs.remove($,s);for(const j of Y)T.push({parent:A,child:j})}const M=A.parent,V=A.prevSibling||A.parent;m.push({actor:s.getActorID(),type:"removeStyle",from:this.toIndex(M,V),to:this.toIndex(A,A),fromPath:this.toPath(M,V),toPath:this.toPath(A,A),value:n})}}),[T,m,o]}edit(t,n,s,i,o,c){const u={data:0,meta:0},[[f,h],d]=this.findNodesAndSplitText(t[0],i),[[p,m],T]=this.findNodesAndSplitText(t[1],i);Pe(u,T,d);const A=this.toIndex(f,h),N=this.toPath(f,h),R=[],M=[],V=[];this.traverseInPosRange(f,h,p,m,([j,ee],oe)=>{if(ee===Te.Start&&!oe)for(const rr of j.children)V.push(rr);const ue=c===void 0;let Ie=!1;const Dt=c==null?void 0:c.get(j.id.getCreatedAt().getActorID());Ie=ue||Dt!==void 0&&Dt>=j.id.getCreatedAt().getLamport();let tr=!1;if(j.removedAt){const rr=c==null?void 0:c.get(j.removedAt.getActorID());tr=ue||rr!==void 0&&rr>=j.removedAt.getLamport()}(j.canDelete(i,Ie,tr)||R.includes(j.parent))&&((ee===Te.Text||ee===Te.Start)&&R.push(j),M.push([j,ee]))},!0);const $=this.makeDeletionChanges(M,i),Y=[];for(const j of R)j.remove(i),j.isRemoved&&Y.push({parent:this,child:j});for(const j of V)j.removedAt||f.append(j);if(s>0){let j=0,ee=f,oe=h;for(;j<s;)ee.split(this,ee.findOffset(oe)+1,o),oe=ee,ee=ee.parent,j++;$.push({type:"content",from:A,to:A,fromPath:N,toPath:N,actor:i.getActorID()})}if(n!=null&&n.length){const j=[];let ee=h;for(const oe of n)ee===f?f.insertAt(oe,0):f.insertAfter(oe,ee),ee=oe,pa(oe,ue=>{f.isRemoved?(ue.remove(i),Y.push({parent:this,child:ue})):Pe(u,ue.getDataSize()),this.nodeMapByID.put(ue.id,ue)}),oe.isRemoved||j.push(oe);if(j.length){const oe=j.map(ue=>jc(ue));$.length&&$[$.length-1].from===A?$[$.length-1].value=oe:$.push({type:"content",from:A,to:A,fromPath:N,toPath:N,actor:i.getActorID(),value:oe})}}return[$,Y,u]}editT(t,n,s,i,o){const c=this.findPos(t[0]),u=this.findPos(t[1]);return this.edit([c,u],n,s,i,o)}move(t,n,s){throw new w(y.ErrUnimplemented,`not implemented: ${t}, ${n}, ${s}`)}pathToTreePos(t){return this.indexTree.pathToTreePos(t)}purge(t){var i;(i=t.parent)==null||i.removeChild(t),this.nodeMapByID.remove(t.id);const n=t.insPrevID,s=t.insNextID;if(n){const o=this.findFloorNode(n);o.insNextID=s}if(s){const o=this.findFloorNode(s);o.insPrevID=n}t.insPrevID=void 0,t.insNextID=void 0}getGCPairs(){const t=[];return this.indexTree.traverse(n=>{n.getRemovedAt()&&t.push({parent:this,child:n});for(const s of n.getGCPairs())t.push(s)}),t}findPos(t,n=!0){const s=this.indexTree.findTreePos(t,n);return xt.fromTreePos(s)}pathToPosRange(t){const n=this.pathToIndex(t);return[this.findPos(n),this.findPos(n+1)]}pathToPos(t){const n=this.indexTree.pathToIndex(t);return this.findPos(n)}getRoot(){return this.indexTree.getRoot()}getSize(){return this.indexTree.size}getNodeSize(){return this.nodeMapByID.size()}getIndexTree(){return this.indexTree}toXML(){return pu(this.indexTree.getRoot())}getDataSize(){const t={data:0,meta:0};return this.indexTree.traverse(n=>{if(n.getRemovedAt())return;const s=n.getDataSize();t.data+=s.data,t.meta+=s.meta}),{data:t.data,meta:t.meta+this.getMetaUsage()}}toJSON(){return JSON.stringify(this.getRootTreeNode())}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TREE"}}toJSInfoForTest(){const t=this.indexTree.getRoot(),n=(s,i=void 0,o=void 0,c=0)=>{var m,T,A,N;let u,f,h;const d=s.isText?{node:s,offset:0}:i&&o?this.toTreePos(i,o):null;d&&(u=this.indexTree.indexOf(d),f=this.indexTree.treePosToPath(d),h=xt.fromTreePos(d).toStruct());const p={type:s.type,parent:i==null?void 0:i.id.toTestString(),size:s.visibleSize,id:s.id.toTestString(),removedAt:(m=s.removedAt)==null?void 0:m.toTestString(),insPrev:(T=s.insPrevID)==null?void 0:T.toTestString(),insNext:(A=s.insNextID)==null?void 0:A.toTestString(),value:s.isText?s.value:void 0,isRemoved:s.isRemoved,children:[],depth:c,attributes:s.attrs?Mn((N=s.attrs)==null?void 0:N.toObject()):void 0,index:u,path:f,pos:h};for(let R=0;R<s.allChildren.length;R++){const M=R===0?s:s.allChildren[R-1];p.children.push(n(s.allChildren[R],s,M,c+1))}return p};return n(t)}getRootTreeNode(){return jc(this.indexTree.getRoot())}toTestTreeNode(){return td(this.indexTree.getRoot())}toSortedJSON(){return this.toJSON()}deepcopy(){const t=this.getRoot(),n=new rt(t.deepcopy(),this.getCreatedAt());return n.setRemovedAt(this.getRemovedAt()),n.setMovedAt(this.getMovedAt()),n}toPath(t,n){const s=this.toTreePos(t,n);return s?this.indexTree.treePosToPath(s):[]}toIndex(t,n,s=!1){const i=this.toTreePos(t,n,s);return i?this.indexTree.indexOf(i,s):-1}indexToPath(t){return this.indexTree.indexToPath(t)}pathToIndex(t){return this.indexTree.pathToIndex(t)}indexRangeToPosRange(t){const n=this.findPos(t[0]);return t[0]===t[1]?[n,n]:[n,this.findPos(t[1])]}indexRangeToPosStructRange(t){const[n,s]=t,i=this.findPos(n);return n===s?[i.toStruct(),i.toStruct()]:[i.toStruct(),this.findPos(s).toStruct()]}posRangeToPathRange(t){const[[n,s]]=this.findNodesAndSplitText(t[0]),[[i,o]]=this.findNodesAndSplitText(t[1]);return[this.toPath(n,s),this.toPath(i,o)]}posRangeToIndexRange(t){const[[n,s]]=this.findNodesAndSplitText(t[0]),[[i,o]]=this.findNodesAndSplitText(t[1]);return[this.toIndex(n,s),this.toIndex(i,o)]}traverseInPosRange(t,n,s,i,o,c=!1){const u=this.toIndex(t,n,c),f=this.toIndex(s,i,c);this.indexTree.tokensBetween(u,f,o,c)}toTreePos(t,n,s=!1){if(!t||!n)return;if(!s&&t.isRemoved){let o;for(;t.isRemoved;)o=t,t=o.parent;const c=t.findOffset(o,s);return{node:t,offset:c}}if(t===n)return{node:t,offset:0};let i=t.findOffset(n,s);if(s||!n.isRemoved){if(n.isText)return{node:n,offset:n.paddedSize(s)};i++}return{node:t,offset:i}}makeDeletionChanges(t,n){const s=[],i=[];let o=null,c=null;for(let u=0;u<t.length;u++){const f=t[u],h=t[u+1];o||(o=f),c=f;const d=this.findRightToken(f);(!d||!h||d[0]!==h[0]||d[1]!==h[1])&&(i.push([o,c]),o=null,c=null)}for(const u of i){const[f,h]=u,[d,p]=this.findLeftToken(f),[m,T]=h,A=p===Te.Start?d:d.parent,N=T===Te.Start?m:m.parent,R=this.toIndex(A,d),M=this.toIndex(N,m);R<M&&(s.length>0&&R===s[s.length-1].to?(s[s.length-1].to=M,s[s.length-1].toPath=this.toPath(N,m)):s.push({type:"content",from:R,to:M,fromPath:this.toPath(A,d),toPath:this.toPath(N,m),actor:n.getActorID()}))}return s.reverse()}findRightToken([t,n]){if(n===Te.Start){const u=t.allChildren;return u.length>0?[u[0],u[0].isText?Te.Text:Te.Start]:[t,Te.End]}const s=t.parent,i=s.allChildren,o=i.indexOf(t);if(s&&o===i.length-1)return[s,Te.End];const c=i[o+1];return[c,c.isText?Te.Text:Te.Start]}findLeftToken([t,n]){if(n===Te.End){const u=t.allChildren;if(u.length>0){const f=u[u.length-1];return[f,f.isText?Te.Text:Te.End]}return[t,Te.Start]}const s=t.parent,i=s.allChildren,o=i.indexOf(t);if(s&&o===0)return[s,Te.Start];const c=i[o-1];return[c,c.isText?Te.Text:Te.End]}}class Yi extends Nt{constructor(t,n,s,i,o,c){super(t,c);a(this,"fromPos");a(this,"toPos");a(this,"contents");a(this,"splitLevel");this.fromPos=n,this.toPos=s,this.contents=i,this.splitLevel=o}static create(t,n,s,i,o,c){return new Yi(t,n,s,i,o,c)}execute(t,n,s){var d;const i=t.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new w(y.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof rt))throw new w(y.ErrInvalidArgument,"fail to execute, only Tree can execute edit");const o=this.getExecutedAt(),c=i,[u,f,h]=c.edit([this.fromPos,this.toPos],(d=this.contents)==null?void 0:d.map(p=>p.deepcopy()),this.splitLevel,o,(()=>{let p=o.getDelimiter();return this.contents!==void 0&&(p+=this.contents.length),()=>wt.of(o.getLamport(),++p,o.getActorID())})(),s);t.acc(h);for(const p of f)t.registerGCPair(p);return{opInfos:u.map(({from:p,to:m,value:T,splitLevel:A,fromPath:N,toPath:R})=>({type:"tree-edit",path:t.createPath(this.getParentCreatedAt()),from:p,to:m,value:T,splitLevel:A,fromPath:N,toPath:R}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const t=this.getParentCreatedAt().toTestString(),n=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.fromPos.getLeftSiblingID().getOffset()}`,s=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.toPos.getLeftSiblingID().getOffset()}`,i=this.contents||[];return`${t}.EDIT(${n},${s},${i.map(o=>pu(o)).join("")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContents(){return this.contents}getSplitLevel(){return this.splitLevel}}class Ks{constructor(e){a(this,"vector");this.vector=e||new Map}set(e,t){this.vector.set(e,t)}unset(e){this.vector.delete(e)}get(e){return this.vector.get(e)}has(e){return this.vector.has(e)}maxLamport(){let e=BigInt(0);for(const[,t]of this)t>e&&(e=t);return e}max(e){const t=new Map;for(const[n,s]of e){const i=this.vector.get(n),o=i&&i>s?i:s;t.set(n,o)}for(const[n,s]of this){const i=e.get(n),o=i&&i>s?i:s;t.set(n,o)}return new Ks(t)}afterOrEqual(e){const t=this.vector.get(e.getActorID());return t===void 0?!1:t>=e.getLamport()}deepcopy(){const e=new Map;for(const[t,n]of this.vector)e.set(t,n);return new Ks(e)}filter(e){const t=new Map;for(const[n]of e){const s=this.vector.get(n);s!==void 0&&t.set(n,s)}return new Ks(t)}size(){return this.vector.size}*[Symbol.iterator](){for(const[e,t]of this.vector)yield[e,t]}}const rd=new Ks(new Map);class At{constructor(e,t,n,s,i){a(this,"clientSeq");a(this,"serverSeq");a(this,"actor");a(this,"lamport");a(this,"versionVector");this.clientSeq=e,this.serverSeq=i,this.lamport=t,this.versionVector=s,this.actor=n}hasClocks(){return this.versionVector.size()>0&&this.lamport!=zc}static of(e,t,n,s,i){return new At(e,t,n,s,i)}next(e=!1){if(e)return new At(this.clientSeq+1,this.lamport,this.actor,rd,zc);const t=this.versionVector.deepcopy();return t.set(this.actor,this.lamport+1n),new At(this.clientSeq+1,this.lamport+1n,this.actor,t)}syncClocks(e){if(!e.hasClocks())return this;const t=e.lamport>this.lamport?e.lamport+1n:this.lamport+1n,n=this.versionVector.max(e.versionVector),s=new At(this.clientSeq,t,this.actor,n);return s.versionVector.set(this.actor,t),s}setClocks(e,t){const n=e>this.lamport?e+1n:this.lamport+1n,s=this.versionVector.max(t);return s.set(this.actor,n),At.of(this.clientSeq,n,this.actor,s)}createTimeTicket(e){return wt.of(this.lamport,e,this.actor)}setActor(e){return new At(this.clientSeq,this.lamport,e,this.versionVector,this.serverSeq)}setLamport(e){return new At(this.clientSeq,e,this.actor,this.versionVector,this.serverSeq)}setVersionVector(e){return new At(this.clientSeq,this.lamport,this.actor,e,this.serverSeq)}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq?this.serverSeq.toString():""}getLamport(){return this.lamport}getLamportAsString(){return this.lamport.toString()}getActorID(){return this.actor}getVersionVector(){return this.versionVector}toTestString(){return`${this.lamport.toString()}:${this.actor.slice(-2)}:${this.clientSeq}`}}const Jy=new At(0,0n,gu,rd);class ni{constructor({id:e,operations:t,presenceChange:n,message:s}){a(this,"id");a(this,"operations");a(this,"presenceChange");a(this,"message");this.id=e,this.operations=t||[],this.presenceChange=n,this.message=s}static create({id:e,operations:t,presenceChange:n,message:s}){return new ni({id:e,operations:t,presenceChange:n,message:s})}getID(){return this.id}getMessage(){return this.message}hasOperations(){return this.operations.length>0}getOperations(){return this.operations}setActor(e){for(const t of this.operations)t.setActor(e);this.id=this.id.setActor(e)}hasPresenceChange(){return this.presenceChange!==void 0}getPresenceChange(){return this.presenceChange}execute(e,t,n){const s=[],i=[];for(const o of this.operations){const c=o.execute(e,n,this.id.getVersionVector());if(!c)continue;const{opInfos:u,reverseOp:f}=c;s.push(...u),f&&i.unshift(f)}return this.presenceChange&&(this.presenceChange.type===Zt.Put?t.set(this.id.getActorID(),Tt(this.presenceChange.presence)):t.delete(this.id.getActorID())),{opInfos:s,reverseOps:i}}toTestString(){return`${this.operations.map(e=>e.toTestString()).join(",")}`}toStruct(){return{changeID:pe.bytesToHex(pe.toChangeID(this.getID()).toBinary()),message:this.getMessage(),operations:this.getOperations().map(e=>pe.bytesToHex(pe.toOperation(e).toBinary())),presenceChange:this.getPresenceChange()}}static fromStruct(e){const{changeID:t,operations:n,presenceChange:s,message:i}=e;return ni.create({id:pe.bytesToChangeID(pe.hexToBytes(t)),operations:n==null?void 0:n.map(o=>pe.bytesToOperation(pe.hexToBytes(o))),presenceChange:s,message:i})}}class ya{constructor(e,t,n,s,i,o){a(this,"documentKey");a(this,"checkpoint");a(this,"isRemoved");a(this,"changes");a(this,"snapshot");a(this,"versionVector");this.documentKey=e,this.checkpoint=t,this.isRemoved=n,this.changes=s,this.snapshot=o,this.versionVector=i}static create(e,t,n,s,i,o){return new ya(e,t,n,s,i,o)}getDocumentKey(){return this.documentKey}getCheckpoint(){return this.checkpoint}getIsRemoved(){return this.isRemoved}getChanges(){return this.changes}hasChanges(){return this.changes.length>0}getChangeSize(){return this.changes.length}hasSnapshot(){return!!this.snapshot&&!!this.snapshot.length}getSnapshot(){return this.snapshot}getVersionVector(){return this.versionVector}}class Vs{constructor(e,t){a(this,"serverSeq");a(this,"clientSeq");this.serverSeq=e,this.clientSeq=t}static of(e,t){return new Vs(e,t)}increaseClientSeq(e){return e===0?this:new Vs(this.serverSeq,this.clientSeq+e)}forward(e){if(this.equals(e))return this;const t=this.serverSeq>e.serverSeq?this.serverSeq:e.serverSeq,n=Math.max(this.clientSeq,e.clientSeq);return Vs.of(t,n)}getServerSeqAsString(){return this.serverSeq.toString()}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq}equals(e){return this.clientSeq===e.clientSeq&&this.serverSeq==e.serverSeq}toTestString(){return`serverSeq=${this.serverSeq}, clientSeq=${this.clientSeq}`}}const $y=new Vs(0n,0);class Yt{constructor(e,t){a(this,"createdAt");a(this,"offset");this.createdAt=e,this.offset=t}static of(e,t){return new Yt(e,t)}static fromStruct(e){return Yt.of(wt.fromStruct(e.createdAt),e.offset)}getCreatedAt(){return this.createdAt}getOffset(){return this.offset}equals(e){return this.createdAt.compare(e.createdAt)===0&&this.offset===e.offset}hasSameCreatedAt(e){return this.createdAt.compare(e.createdAt)===0}split(e){return new Yt(this.createdAt,this.offset+e)}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toTestString(){return`${this.createdAt.toTestString()}:${this.offset}`}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}}const Fy=Yt.of(Qs,0);class Pt{constructor(e,t){a(this,"id");a(this,"relativeOffset");this.id=e,this.relativeOffset=t}static of(e,t){return new Pt(e,t)}static fromStruct(e){const t=Yt.fromStruct(e.id);return Pt.of(t,e.relativeOffset)}getID(){return this.id}getRelativeOffset(){return this.relativeOffset}getAbsoluteID(){return Yt.of(this.id.getCreatedAt(),this.id.getOffset()+this.relativeOffset)}toTestString(){return`${this.id.toTestString()}:${this.relativeOffset}`}toStruct(){return{id:this.id.toStruct(),relativeOffset:this.relativeOffset}}equals(e){return this.id.equals(e.id)?this.relativeOffset===e.relativeOffset:!1}}class ns extends jh{constructor(t,n,s){super(n);a(this,"id");a(this,"removedAt");a(this,"prev");a(this,"next");a(this,"insPrev");a(this,"insNext");this.id=t,this.removedAt=s}static create(t,n){return new ns(t,n)}static createComparator(){return(t,n)=>{const s=t.getCreatedAt().compare(n.getCreatedAt());return s!==0?s:t.getOffset()>n.getOffset()?1:t.getOffset()<n.getOffset()?-1:0}}getID(){return this.id}getCreatedAt(){return this.id.getCreatedAt()}getLength(){return this.removedAt?0:this.getContentLength()}getContentLength(){return this.value&&this.value.length||0}getPrev(){return this.prev}getNext(){return this.next}getInsPrev(){return this.insPrev}getInsNext(){return this.insNext}getInsPrevID(){return this.insPrev.getID()}setPrev(t){this.prev=t,t&&(t.next=this)}setNext(t){this.next=t,t&&(t.prev=this)}setInsPrev(t){this.insPrev=t,t&&(t.insNext=this)}setInsNext(t){this.insNext=t,t&&(t.insPrev=this)}hasNext(){return!!this.next}hasInsPrev(){return!!this.insPrev}isRemoved(){return!!this.removedAt}getRemovedAt(){return this.removedAt}split(t){return new ns(this.id.split(t),this.splitValue(t),this.removedAt)}canRemove(t,n,s){return n?!!(!this.removedAt||!s&&(t!=null&&t.after(this.removedAt))):!1}canStyle(t,n){return this.getCreatedAt().getLamport()<=n&&(!this.removedAt||t.after(this.removedAt))}setRemovedAt(t){this.removedAt=t}remove(t){if(!this.removedAt){this.removedAt=t;return}t.after(this.removedAt)&&(this.removedAt=t)}createPosRange(){return[Pt.of(this.id,0),Pt.of(this.id,this.getLength())]}getDataSize(){const t=this.value.getDataSize();return this.id&&(t.meta+=Gt),this.removedAt&&(t.meta+=Gt),t}deepcopy(){return new ns(this.id,this.value,this.removedAt)}toTestString(){return`${this.id.toTestString()} ${this.value?this.value:""}`}splitValue(t){const n=this.value;return this.value=n.substring(0,t),n.substring(t,n.length)}toIDString(){return this.id.toIDString()}}class si{constructor(){a(this,"head");a(this,"treeByIndex");a(this,"treeByID");this.head=ns.create(Fy),this.treeByIndex=new Ui,this.treeByID=new ed(ns.createComparator()),this.treeByIndex.insert(this.head),this.treeByID.put(this.head.getID(),this.head)}static create(){return new si}edit(e,t,n,s){const i={data:0,meta:0},[o,c,u]=this.findNodeWithSplit(e[1],t),[f,h,d]=this.findNodeWithSplit(e[0],t);Pe(i,c,h);const p=this.findBetween(d,u),[m,T]=this.deleteNodes(p,t,s),A=u?u.getID():o.getID();let N=Pt.of(A,0);if(n){const M=this.posToIndex(f.createPosRange()[1],!0),V=this.insertAfter(f,ns.create(Yt.of(t,0),n));Pe(i,V.getDataSize()),m.length&&m[m.length-1].from===M?m[m.length-1].value=n:m.push({actor:t.getActorID(),from:M,to:M,value:n}),N=Pt.of(V.getID(),V.getContentLength())}const R=[];for(const[,M]of T)R.push({parent:this,child:M});return[N,R,i,m]}indexToPos(e){const[t,n]=this.treeByIndex.find(e),s=t;return Pt.of(s.getID(),n)}findIndexesFromRange(e){const[t,n]=e;return[this.posToIndex(t,!1),this.posToIndex(n,!0)]}posToIndex(e,t){const n=e.getAbsoluteID(),s=t?this.findFloorNodePreferToLeft(n):this.findFloorNode(n);if(!s)throw new w(y.ErrInvalidArgument,`the node of the given id should be found: ${n.toTestString()}`);const i=this.treeByIndex.indexOf(s),o=s.isRemoved()?0:n.getOffset()-s.getID().getOffset();return i+o}findNode(e){return this.findFloorNode(e)}get length(){return this.treeByIndex.length}getTreeByIndex(){return this.treeByIndex}getTreeByID(){return this.treeByID}toString(){const e=[];for(const t of this)t.isRemoved()||e.push(t.getValue());return e.join("")}*[Symbol.iterator](){let e=this.head.getNext();for(;e;)yield e,e=e.getNext()}getHead(){return this.head}deepcopy(){const e=new si;let t=this.head.getNext(),n=e.head,s;for(;t;){if(s=e.insertAfter(n,t.deepcopy()),t.hasInsPrev()){const i=e.findNode(t.getInsPrevID());s.setInsPrev(i)}n=s,t=t.getNext()}return e}toTestString(){const e=[];let t=this.head;for(;t;)t.isRemoved()?e.push(`{${t.toTestString()}}`):e.push(`[${t.toTestString()}]`),t=t.getNext();return e.join("")}insertAfter(e,t){const n=e.getNext();return t.setPrev(e),n&&n.setPrev(t),this.treeByID.put(t.getID(),t),this.treeByIndex.insertAfter(e,t),t}findNodeWithSplit(e,t){const n=e.getAbsoluteID();let s=this.findFloorNodePreferToLeft(n);const i=n.getOffset()-s.getID().getOffset(),[,o]=this.splitNode(s,i);for(;s.hasNext()&&s.getNext().getCreatedAt().after(t);)s=s.getNext();return[s,o,s.getNext()]}findFloorNodePreferToLeft(e){let t=this.findFloorNode(e);if(!t)throw new w(y.ErrInvalidArgument,`the node of the given id should be found: ${e.toTestString()}`);if(e.getOffset()>0&&t.getID().getOffset()==e.getOffset()){if(!t.hasInsPrev())return t;t=t.getInsPrev()}return t}findFloorNode(e){const t=this.treeByID.floorEntry(e);if(t&&!(!t.key.equals(e)&&!t.key.hasSameCreatedAt(e)))return t.value}findBetween(e,t){const n=[];let s=e;for(;s&&s!==t;)n.push(s),s=s.getNext();return n}splitNode(e,t){const n={data:0,meta:0};if(t>e.getContentLength())throw new w(y.ErrInvalidArgument,"offset should be less than or equal to length");if(t===0)return[e,n];if(t===e.getContentLength())return[e.getNext(),n];const s=e.getDataSize(),i=e.split(t);this.treeByIndex.updateWeight(i),this.insertAfter(e,i);const o=e.getInsNext();return o&&o.setInsPrev(i),i.setInsPrev(e),Pe(n,e.getDataSize(),i.getDataSize()),vs(n,s),[i,n]}deleteNodes(e,t,n){if(!e.length)return[[],new Map];const s=n===void 0||n.size()===0,i=[],o=[],[c,u]=this.findEdgesOfCandidates(e);o.push(c);for(const d of e){let p=!1;if(s)p=!0;else{const T=n==null?void 0:n.get(d.getCreatedAt().getActorID());T&&T>=d.getCreatedAt().getLamport()&&(p=!0)}let m=!1;if(d.getRemovedAt()){const T=n==null?void 0:n.get(d.getRemovedAt().getActorID());(s||T&&T>=d.getRemovedAt().getLamport())&&(m=!0)}d.canRemove(t,p,m)?i.push(d):o.push(d)}o.push(u);const f=this.makeChanges(o,t),h=new Map;for(const d of i)h.set(d.getID().toIDString(),d),d.remove(t);return this.deleteIndexNodes(o),[f,h]}findEdgesOfCandidates(e){return[e[0].getPrev(),e[e.length-1].getNext()]}makeChanges(e,t){const n=[];let s,i;for(let o=0;o<e.length-1;o++){const c=e[o],u=e[o+1];c.getNext()!=u&&([s]=this.findIndexesFromRange(c.getNext().createPosRange()),u?[,i]=this.findIndexesFromRange(u.getPrev().createPosRange()):i=this.treeByIndex.length,s<i&&n.push({actor:t.getActorID(),from:s,to:i}))}return n.reverse()}deleteIndexNodes(e){for(let t=0;t<e.length-1;t++){const n=e[t],s=e[t+1];n.getNext()!=s&&this.treeByIndex.deleteRange(n,s)}}purge(e){this.treeByIndex.delete(e),this.treeByID.remove(e.getID());const t=e.getPrev(),n=e.getNext(),s=e.getInsPrev(),i=e.getInsNext();t&&t.setNext(n),n&&n.setPrev(t),e.setPrev(void 0),e.setNext(void 0),s&&s.setInsNext(i),i&&i.setInsPrev(s),e.setInsPrev(void 0),e.setInsNext(void 0)}}const nf=r=>r<0?Math.ceil(r):Math.floor(r);var er=(r=>(r[r.Int=0]="Int",r[r.Long=1]="Long",r))(er||{});class Ge extends Hi{constructor(t,n,s){super(s);a(this,"valueType");a(this,"value");switch(this.valueType=t,t){case 0:typeof n=="number"?n>Math.pow(2,31)-1||n<-Math.pow(2,31)?this.value=Z.fromNumber(n).toInt():this.value=nf(n):this.value=n.toInt();break;case 1:typeof n=="number"?this.value=Z.fromNumber(n):this.value=n;break;default:throw new w(y.ErrUnimplemented,`unimplemented type: ${t}`)}}static create(t,n,s){return new Ge(t,n,s)}static valueFromBytes(t,n){switch(t){case 0:return n[0]|n[1]<<8|n[2]<<16|n[3]<<24;case 1:return Z.fromBytesLE(Array.from(n));default:throw new w(y.ErrUnimplemented,`unimplemented type: ${t}`)}}getDataSize(){return{data:this.valueType===0?4:8,meta:this.getMetaUsage()}}toJSON(){return`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_COUNTER"}}deepcopy(){const t=Ge.create(this.valueType,this.value,this.getCreatedAt());return t.setRemovedAt(this.getRemovedAt()),t.setMovedAt(this.getMovedAt()),t}getType(){return this.valueType}static getCounterType(t){switch(typeof t){case"object":return t instanceof Z?1:void 0;case"number":return t>Math.pow(2,31)-1||t<-Math.pow(2,31)?1:0;default:return}}static isSupport(t){return!!Ge.getCounterType(t)}static isInteger(t){return t%1===0}isNumericType(){const t=this.valueType;return t===0||t===1}getValueType(){return this.valueType}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:{const t=this.value;return new Uint8Array([t&255,t>>8&255,t>>16&255,t>>24&255])}case 1:{const n=this.value.toBytesLE();return Uint8Array.from(n)}default:throw new w(y.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}increase(t){function n(s){if(!s.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof s.getValue()}`)}return n(this),n(t),this.valueType===1?this.value=this.value.add(t.getValue()):t.getType()===fe.Long?this.value=this.value+t.getValue().toInt():this.value=Z.fromNumber(this.value+nf(t.getValue())).toInt(),this}}class ii extends Nt{constructor(t,n,s){super(t,s);a(this,"value");this.value=n}static create(t,n,s){return new ii(t,n,s)}execute(t){const n=t.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new w(y.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof Ge))throw new w(y.ErrInvalidArgument,"fail to execute, only Counter can execute increase");const s=n,i=this.value.deepcopy();return s.increase(i),{opInfos:[{type:"increase",path:t.createPath(this.getParentCreatedAt()),value:i.getValue()}],reverseOp:this.toReverseOperation()}}toReverseOperation(){const t=this.value.deepcopy(),s=t.getType()===fe.Long?t.getValue().multiply(-1):t.getValue()*-1;return ii.create(this.getParentCreatedAt(),ve.of(s,t.getCreatedAt()))}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.INCREASE.${this.value.toJSON()}`}getValue(){return this.value}}class Un extends Nt{constructor(t,n,s,i,o,c){super(t,c);a(this,"fromPos");a(this,"toPos");a(this,"attributes");a(this,"attributesToRemove");this.fromPos=n,this.toPos=s,this.attributes=i,this.attributesToRemove=o}static create(t,n,s,i,o){return new Un(t,n,s,i,[],o)}static createTreeRemoveStyleOperation(t,n,s,i,o){return new Un(t,n,s,new Map,i,o)}execute(t,n,s){const i=t.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new w(y.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof rt))throw new w(y.ErrInvalidArgument,"fail to execute, only Tree can execute edit");const o=i;let c,u,f={data:0,meta:0};if(this.attributes.size){const h={};[...this.attributes].forEach(([d,p])=>h[d]=p),[u,c,f]=o.style([this.fromPos,this.toPos],h,this.getExecutedAt(),s)}else{const h=this.attributesToRemove;[u,c,f]=o.removeStyle([this.fromPos,this.toPos],h,this.getExecutedAt(),s)}t.acc(f);for(const h of u)t.registerGCPair(h);return{opInfos:c.map(({from:h,to:d,value:p,fromPath:m,toPath:T})=>({type:"tree-style",from:h,to:d,value:this.attributes.size?{attributes:p}:{attributesToRemove:p},fromPath:m,toPath:T,path:t.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const t=this.getParentCreatedAt().toTestString(),n=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.fromPos.getLeftSiblingID().getOffset()}`,s=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.toPos.getLeftSiblingID().getOffset()}`;return`${t}.STYLE(${n},${s},${Object.entries(this.attributes||{}).map(([i,o])=>`${i}:"${o}"`).join(" ")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getAttributesToRemove(){return this.attributesToRemove}}class Vn extends Nt{constructor(t,n,s,i){super(t,i);a(this,"createdAt");a(this,"value");this.createdAt=n,this.value=s}static create(t,n,s,i){return new Vn(t,n,s,i)}execute(t){const n=t.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new w(y.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof Be))throw new w(y.ErrInvalidArgument,"fail to execute, only array can execute set");const s=n.getByID(this.createdAt).deepcopy(),i=this.toReverseOperation(this.value,s),o=this.value.deepcopy();return n.insertAfter(this.createdAt,o,this.getExecutedAt()),n.delete(this.createdAt,this.getExecutedAt()),t.registerElement(o),{opInfos:[{type:"array-set",path:t.createPath(this.getParentCreatedAt())}],reverseOp:i}}toReverseOperation(t,n){return Vn.create(this.getParentCreatedAt(),t.getCreatedAt(),n)}getEffectedCreatedAt(){return this.createdAt}toTestString(){return`${this.getParentCreatedAt().toTestString()}.ARRAY_SET.${this.createdAt.toTestString()}=${this.value.toSortedJSON()}`}getCreatedAt(){return this.createdAt}getValue(){return this.value}setCreatedAt(t){this.createdAt=t}}function My(r){const e=new Zs,t=e.data;for(const[n,s]of Object.entries(r))t[n]=JSON.stringify(s);return e}function Uy(r){if(r.type===Zt.Put)return new Mi({type:Is.PUT,presence:My(r.presence)});if(r.type===Zt.Clear)return new Mi({type:Is.CLEAR});throw new w(y.ErrUnimplemented,"unimplemented type")}function zy(r){return new Kh({serverSeq:r.getServerSeq(),clientSeq:r.getClientSeq()})}function nd(r){return new da({clientSeq:r.getClientSeq(),lamport:r.getLamport(),actorId:wa(r.getActorID()),versionVector:yu(r.getVersionVector())})}function U(r){if(r)return new F({lamport:r.getLamport(),delimiter:r.getDelimiter(),actorId:wa(r.getActorID())})}function yu(r){if(!r)return;const e=new ga;for(const[t,n]of r){const s=Iv(wa(t));e.vector[s]=BigInt(n.toString())}return e}function sd(r){switch(r){case fe.Null:return G.NULL;case fe.Boolean:return G.BOOLEAN;case fe.Integer:return G.INTEGER;case fe.Long:return G.LONG;case fe.Double:return G.DOUBLE;case fe.String:return G.STRING;case fe.Bytes:return G.BYTES;case fe.Date:return G.DATE;default:throw new w(y.ErrInvalidType,`unsupported type: ${r}`)}}function id(r){switch(r){case er.Int:return G.INTEGER_CNT;case er.Long:return G.LONG_CNT;default:throw new w(y.ErrInvalidType,`unsupported type: ${r}`)}}function so(r){if(r instanceof Oe)return new st({type:G.JSON_OBJECT,createdAt:U(r.getCreatedAt()),value:vd(r)});if(r instanceof Be)return new st({type:G.JSON_ARRAY,createdAt:U(r.getCreatedAt()),value:bv(r)});if(r instanceof tt)return new st({type:G.TEXT,createdAt:U(r.getCreatedAt())});if(r instanceof ve)return new st({type:sd(r.getType()),createdAt:U(r.getCreatedAt()),value:r.toBytes()});if(r instanceof Ge)return new st({type:id(r.getType()),createdAt:U(r.getCreatedAt()),value:r.toBytes()});if(r instanceof rt)return new st({type:G.TREE,createdAt:U(r.getCreatedAt()),value:Tv(r)});throw new w(y.ErrUnimplemented,"unimplemented element")}function qy(r){return new $i({createdAt:U(r.getCreatedAt()),offset:r.getOffset()})}function io(r){return new ks({createdAt:U(r.getID().getCreatedAt()),offset:r.getID().getOffset(),relativeOffset:r.getRelativeOffset()})}function oo(r){return new As({parentId:Ei(r.getParentID()),leftSiblingId:Ei(r.getLeftSiblingID())})}function Ei(r){return new ts({createdAt:U(r.getCreatedAt()),offset:r.getOffset()})}function od(r){const e=new du;if(r instanceof xs){const t=r,n=new No;n.parentCreatedAt=U(t.getParentCreatedAt()),n.key=t.getKey(),n.value=so(t.getValue()),n.executedAt=U(t.getExecutedAt()),e.body.case="set",e.body.value=n}else if(r instanceof cs){const t=r,n=new Do;n.parentCreatedAt=U(t.getParentCreatedAt()),n.prevCreatedAt=U(t.getPrevCreatedAt()),n.value=so(t.getValue()),n.executedAt=U(t.getExecutedAt()),e.body.case="add",e.body.value=n}else if(r instanceof kt){const t=r,n=new Oo;n.parentCreatedAt=U(t.getParentCreatedAt()),n.prevCreatedAt=U(t.getPrevCreatedAt()),n.createdAt=U(t.getCreatedAt()),n.executedAt=U(t.getExecutedAt()),e.body.case="move",e.body.value=n}else if(r instanceof Qt){const t=r,n=new Bo;n.parentCreatedAt=U(t.getParentCreatedAt()),n.createdAt=U(t.getCreatedAt()),n.executedAt=U(t.getExecutedAt()),e.body.case="remove",e.body.value=n}else if(r instanceof Gi){const t=r,n=new Ro;n.parentCreatedAt=U(t.getParentCreatedAt()),n.from=io(t.getFromPos()),n.to=io(t.getToPos()),n.content=t.getContent();const s=n.attributes;for(const[i,o]of t.getAttributes())s[i]=o;n.executedAt=U(t.getExecutedAt()),e.body.case="edit",e.body.value=n}else if(r instanceof _i){const t=r,n=new Lo;n.parentCreatedAt=U(t.getParentCreatedAt()),n.from=io(t.getFromPos()),n.to=io(t.getToPos());const s=n.attributes;for(const[i,o]of t.getAttributes())s[i]=o;n.executedAt=U(t.getExecutedAt()),e.body.case="style",e.body.value=n}else if(r instanceof ii){const t=r,n=new Jo;n.parentCreatedAt=U(t.getParentCreatedAt()),n.value=so(t.getValue()),n.executedAt=U(t.getExecutedAt()),e.body.case="increase",e.body.value=n}else if(r instanceof Yi){const t=r,n=new $o;n.parentCreatedAt=U(t.getParentCreatedAt()),n.from=oo(t.getFromPos()),n.to=oo(t.getToPos()),n.contents=_y(t.getContents()),n.splitLevel=t.getSplitLevel(),n.executedAt=U(t.getExecutedAt()),e.body.case="treeEdit",e.body.value=n}else if(r instanceof Un){const t=r,n=new Fo;n.parentCreatedAt=U(t.getParentCreatedAt()),n.from=oo(t.getFromPos()),n.to=oo(t.getToPos());const s=t.getAttributesToRemove();if(s.length>0)n.attributesToRemove=s;else{const i=n.attributes;for(const[o,c]of t.getAttributes())i[o]=c}n.executedAt=U(t.getExecutedAt()),e.body.case="treeStyle",e.body.value=n}else if(r instanceof Vn){const t=r,n=new Mo;n.parentCreatedAt=U(t.getParentCreatedAt()),n.createdAt=U(t.getCreatedAt()),n.value=so(t.getValue()),n.executedAt=U(t.getExecutedAt()),e.body.case="arraySet",e.body.value=n}else throw new w(y.ErrUnimplemented,"unimplemented operation");return e}function Ky(r){const e=[];for(const t of r)e.push(od(t));return e}function Vy(r){const e=new zh({id:nd(r.getID()),message:r.getMessage()});return r.hasOperations()&&(e.operations=Ky(r.getOperations())),r.hasPresenceChange()&&(e.presenceChange=Uy(r.getPresenceChange())),e}function jy(r){const e=[];for(const t of r)e.push(Vy(t));return e}function Wy(r){const e=[];for(const t of r)e.push(new qh({key:t.getStrKey(),element:wu(t.getValue())}));return e}function Hy(r){const e=[];for(const t of r)e.push(new Wo({element:wu(t.getValue())}));return e}function Gy(r){const e=[];for(const t of r){const n=new Ho;n.id=qy(t.getID()),n.value=t.getValue().getContent(),n.removedAt=U(t.getRemovedAt());const s=n.attributes,i=t.getValue().getAttrs();for(const o of i){const c=new Xs;c.value=o.getValue(),c.updatedAt=U(o.getUpdatedAt()),s[o.getKey()]=c}e.push(n)}return e}function _y(r){const e=[];if(!r||!r.length)return e;for(const t of r)e.push(new Go({content:vu(t)}));return e}function Yy(r){const e={};for(const t of r)e[t.getKey()]=new Xs({value:t.getValue(),updatedAt:U(t.getUpdatedAt()),isRemoved:t.isRemoved()});return e}function vu(r){if(!r)return[];const e=[];return pa(r,(t,n)=>{const s=new Fi({id:Ei(t.id),type:t.type,removedAt:U(t.removedAt),depth:n});t.isText&&(s.value=t.value),t.insPrevID&&(s.insPrevId=Ei(t.insPrevID)),t.insNextID&&(s.insNextId=Ei(t.insNextID)),t.attrs&&(s.attributes=Yy(t.attrs)),e.push(s)}),e}function Xy(r){const e=new _e;return e.body.case="jsonObject",e.body.value=new Uo({nodes:Wy(r.getRHT()),createdAt:U(r.getCreatedAt()),movedAt:U(r.getMovedAt()),removedAt:U(r.getRemovedAt())}),e}function ad(r){const e=new _e;return e.body.case="jsonArray",e.body.value=new zo({nodes:Hy(r.getElements()),createdAt:U(r.getCreatedAt()),movedAt:U(r.getMovedAt()),removedAt:U(r.getRemovedAt())}),e}function Zy(r){const e=new _e;return e.body.case="primitive",e.body.value=new qo({type:sd(r.getType()),value:r.toBytes(),createdAt:U(r.getCreatedAt()),movedAt:U(r.getMovedAt()),removedAt:U(r.getRemovedAt())}),e}function Qy(r){const e=new _e;return e.body.case="text",e.body.value=new Ko({nodes:Gy(r.getRGATreeSplit()),createdAt:U(r.getCreatedAt()),movedAt:U(r.getMovedAt()),removedAt:U(r.getRemovedAt())}),e}function ev(r){const e=new _e;return e.body.case="counter",e.body.value=new Vo({type:id(r.getType()),value:r.toBytes(),createdAt:U(r.getCreatedAt()),movedAt:U(r.getMovedAt()),removedAt:U(r.getRemovedAt())}),e}function cd(r){const e=new _e;return e.body.case="tree",e.body.value=new jo({nodes:vu(r.getRoot()),createdAt:U(r.getCreatedAt()),movedAt:U(r.getMovedAt()),removedAt:U(r.getRemovedAt())}),e}function wu(r){if(r instanceof Oe)return Xy(r);if(r instanceof Be)return ad(r);if(r instanceof ve)return Zy(r);if(r instanceof tt)return Qy(r);if(r instanceof Ge)return ev(r);if(r instanceof rt)return cd(r);throw new w(y.ErrUnimplemented,"unimplemented element")}function tv(r){return new Wn({documentKey:r.getDocumentKey(),checkpoint:zy(r.getCheckpoint()),isRemoved:r.getIsRemoved(),changes:jy(r.getChanges()),snapshot:r.getSnapshot(),versionVector:yu(r.getVersionVector())})}function rv(r){var e;return{id:r.id,label:r.label,description:r.description,snapshot:r.snapshot,createdAt:((e=r.createdAt)==null?void 0:e.toDate())||new Date}}function mi(r){if(!(r instanceof ce))return{};const e=r.findDetails(wy);for(const t of e)return t.metadata;return{}}function Rs(r){return mi(r).code??""}function Fa(r,e){return r instanceof ce&&Rs(r)===e}function ud(r){return At.of(r.clientSeq,BigInt(r.lamport),Iu(r.actorId),bu(r.versionVector),BigInt(r.serverSeq))}function bu(r){if(!r)return;const e=new Ks;return Object.entries(r.vector).forEach(([t,n])=>{const s=va(Av(t));e.set(s,BigInt(n.toString()))}),e}function z(r){if(r)return wt.of(BigInt(r.lamport),r.delimiter,Iu(r.actorId))}function Su(r){const e={};return Object.entries(r.data).forEach(([t,n])=>{e[t]=JSON.parse(n)}),e}function nv(r){const e=r.type;if(e===Is.PUT){const t=Su(r.presence);return{type:Zt.Put,presence:t}}if(e===Is.CLEAR)return{type:Zt.Clear};throw new w(y.ErrInvalidType,`unsupported type: ${e}`)}function sv(r){const e=new Map;return Object.entries(r).forEach(([t,n])=>{e.set(t,Su(n))}),e}function ld(r){switch(r){case G.NULL:return fe.Null;case G.BOOLEAN:return fe.Boolean;case G.INTEGER:return fe.Integer;case G.LONG:return fe.Long;case G.DOUBLE:return fe.Double;case G.STRING:return fe.String;case G.BYTES:return fe.Bytes;case G.DATE:return fe.Date}throw new w(y.ErrUnimplemented,`unimplemented value type: ${r}`)}function ta(r){switch(r){case G.INTEGER_CNT:return er.Int;case G.LONG_CNT:return er.Long}throw new w(y.ErrUnimplemented,`unimplemented value type: ${r}`)}function ao(r){switch(r.type){case G.JSON_OBJECT:return r.value?yd(r.value):Oe.create(z(r.createdAt));case G.JSON_ARRAY:return r.value?wv(r.value):Be.create(z(r.createdAt));case G.TEXT:return tt.create(si.create(),z(r.createdAt));case G.TREE:return Sv(r.value);case G.NULL:case G.BOOLEAN:case G.INTEGER:case G.LONG:case G.DOUBLE:case G.STRING:case G.BYTES:case G.DATE:return ve.of(ve.valueFromBytes(ld(r.type),r.value),z(r.createdAt));case G.INTEGER_CNT:case G.LONG_CNT:return Ge.create(ta(r.type),Ge.valueFromBytes(ta(r.type),r.value),z(r.createdAt))}}function co(r){return Pt.of(Yt.of(z(r.createdAt),r.offset),r.relativeOffset)}function fd(r){return Yt.of(z(r.createdAt),r.offset)}function iv(r){const e=qi.create(r.value);Object.entries(r.attributes).forEach(([n,s])=>{e.setAttr(n,s.value,z(s.updatedAt))});const t=ns.create(fd(r.id),e);return t.setRemovedAt(z(r.removedAt)),t}function Ns(r){return xt.of(Ci(r.parentId),Ci(r.leftSiblingId))}function Ci(r){return Ne.of(z(r.createdAt),r.offset)}function ov(r){if(!r.length)return;const e=[];return r.forEach(t=>{const n=Tu(t.content);e.push(n)}),e}function Tu(r){if(r.length===0)return;const e=[];for(const s of r)e.push(cv(s));const t=e[e.length-1],n=new Map;n.set(r[e.length-1].depth,e[e.length-1]);for(let s=e.length-2;s>=0;s--)n.get(r[s].depth-1).prepend(e[s]),n.set(r[s].depth,e[s]);return t.updateDescendantsSize(),t.updateDescendantsSize(!0),rt.create(t,Qs).getRoot()}function av(r){const e=Kn.create();for(const[t,n]of Object.entries(r))e.setInternal(t,n.value,z(n.updatedAt),n.isRemoved);return e}function cv(r){const e=Ci(r.id),t=et.create(e,r.type),n=Object.entries(r.attributes);return t.isText?t.value=r.value:n.length&&(t.attrs=av(r.attributes)),r.insPrevId&&(t.insPrevID=Ci(r.insPrevId)),r.insNextId&&(t.insNextID=Ci(r.insNextId)),t.removedAt=z(r.removedAt),t}function hd(r){if(r.body.case==="set"){const e=r.body.value;return xs.create(e.key,ao(e.value),z(e.parentCreatedAt),z(e.executedAt))}else if(r.body.case==="add"){const e=r.body.value;return cs.create(z(e.parentCreatedAt),z(e.prevCreatedAt),ao(e.value),z(e.executedAt))}else if(r.body.case==="move"){const e=r.body.value;return kt.create(z(e.parentCreatedAt),z(e.prevCreatedAt),z(e.createdAt),z(e.executedAt))}else if(r.body.case==="remove"){const e=r.body.value;return Qt.create(z(e.parentCreatedAt),z(e.createdAt),z(e.executedAt))}else if(r.body.case==="edit"){const e=r.body.value,t=new Map;return Object.entries(e.attributes).forEach(([n,s])=>{t.set(n,s)}),Gi.create(z(e.parentCreatedAt),co(e.from),co(e.to),e.content,t,z(e.executedAt))}else if(r.body.case==="style"){const e=r.body.value,t=new Map;return Object.entries(e.attributes).forEach(([n,s])=>{t.set(n,s)}),_i.create(z(e.parentCreatedAt),co(e.from),co(e.to),t,z(e.executedAt))}else if(r.body.case==="increase"){const e=r.body.value;return ii.create(z(e.parentCreatedAt),ao(e.value),z(e.executedAt))}else if(r.body.case==="treeEdit"){const e=r.body.value;return Yi.create(z(e.parentCreatedAt),Ns(e.from),Ns(e.to),ov(e.contents),e.splitLevel,z(e.executedAt))}else if(r.body.case==="treeStyle"){const e=r.body.value,t=new Map,n=e.attributesToRemove;return(n==null?void 0:n.length)>0?Un.createTreeRemoveStyleOperation(z(e.parentCreatedAt),Ns(e.from),Ns(e.to),n,z(e.executedAt)):(Object.entries(e.attributes).forEach(([s,i])=>{t.set(s,i)}),Un.create(z(e.parentCreatedAt),Ns(e.from),Ns(e.to),t,z(e.executedAt)))}else if(r.body.case==="arraySet"){const e=r.body.value;return Vn.create(z(e.parentCreatedAt),z(e.createdAt),ao(e.value),z(e.executedAt))}else throw new w(y.ErrUnimplemented,"unimplemented operation")}function uv(r){const e=[];for(const t of r){const n=hd(t);n&&e.push(n)}return e}function dd(r){const e=[];for(const t of r)e.push(ni.create({id:ud(t.id),operations:uv(t.operations),presenceChange:t.presenceChange?nv(t.presenceChange):void 0,message:t.message}));return e}function lv(r){return Vs.of(BigInt(r.serverSeq),r.clientSeq)}function fv(r){return ya.create(r.documentKey,lv(r.checkpoint),r.isRemoved,dd(r.changes),bu(r.versionVector),r.snapshot)}function gd(r){const e=new ei;for(const n of r.nodes){const s=Au(n.element);e.set(n.key,s,s.getPositionedAt())}const t=new Oe(z(r.createdAt),e);return t.setMovedAt(z(r.movedAt)),t.setRemovedAt(z(r.removedAt)),t}function md(r){const e=new zi;for(const n of r.nodes)e.insert(Au(n.element));const t=new Be(z(r.createdAt),e);return t.setMovedAt(z(r.movedAt)),t.setRemovedAt(z(r.removedAt)),t}function hv(r){const e=ve.of(ve.valueFromBytes(ld(r.type),r.value),z(r.createdAt));return e.setMovedAt(z(r.movedAt)),e.setRemovedAt(z(r.removedAt)),e}function dv(r){const e=new si;let t=e.getHead();for(const s of r.nodes){const i=e.insertAfter(t,iv(s));s.insPrevId&&i.setInsPrev(e.findNode(fd(s.insPrevId))),t=i}const n=new tt(e,z(r.createdAt));return n.setMovedAt(z(r.movedAt)),n.setRemovedAt(z(r.removedAt)),n}function gv(r){const e=Ge.create(ta(r.type),Ge.valueFromBytes(ta(r.type),r.value),z(r.createdAt));return e.setMovedAt(z(r.movedAt)),e.setRemovedAt(z(r.removedAt)),e}function pd(r){const e=Tu(r.nodes);return rt.create(e,z(r.createdAt))}function Au(r){if(r.body.case==="jsonObject")return gd(r.body.value);if(r.body.case==="jsonArray")return md(r.body.value);if(r.body.case==="primitive")return hv(r.body.value);if(r.body.case==="text")return dv(r.body.value);if(r.body.case==="counter")return gv(r.body.value);if(r.body.case==="tree")return pd(r.body.value);throw new w(y.ErrUnimplemented,"unimplemented element")}function mv(r){return r.map(e=>({path:e.path,type:e.type}))}function pv(r){if(!r)return{root:Oe.create(Qs),presences:new Map};const e=tc.fromBinary(r);return{root:Au(e.root),presences:sv(e.presences)}}function yv(r){const e=yu(r);return va(e.toBinary())}function vv(r){const e=ku(r),t=ga.fromBinary(e);return bu(t)}function yd(r){if(!r)throw new w(y.ErrInvalidArgument,"bytes is empty");const e=_e.fromBinary(r);return gd(e.body.value)}function vd(r){return wu(r).toBinary()}function wv(r){if(!r)throw new w(y.ErrInvalidArgument,"bytes is empty");const e=_e.fromBinary(r);return md(e.body.value)}function bv(r){return ad(r).toBinary()}function Sv(r){if(!r)throw new w(y.ErrInvalidArgument,"bytes is empty");const e=_e.fromBinary(r);return pd(e.body.value)}function Tv(r){return cd(r).toBinary()}function va(r){return r?Array.from(r).map(e=>e.toString(16).padStart(2,"0")).join(""):""}function Iu(r){return va(r)}function ku(r){return new Uint8Array(r.match(/.{1,2}/g).map(e=>parseInt(e,16)))}function Av(r){if(typeof window<"u"&&typeof window.atob=="function"){const e=window.atob(r),t=e.length,n=new Uint8Array(t);for(let s=0;s<t;s++)n[s]=e.charCodeAt(s);return n}else if(typeof globalThis<"u"&&typeof globalThis.Buffer<"u"){const e=globalThis.Buffer;return new Uint8Array(e.from(r,"base64"))}else throw new Error("No base64 decoder available")}function wa(r){return ku(r)}function Iv(r){if(typeof window<"u"&&typeof window.btoa=="function"){let e="";for(let t=0;t<r.byteLength;t++)e+=String.fromCharCode(r[t]);return window.btoa(e)}else{if(typeof globalThis<"u"&&typeof globalThis.Buffer<"u")return globalThis.Buffer.from(r).toString("base64");throw new Error("No base64 encoder available")}}function kv(r){const e=da.fromBinary(r);return ud(e)}function xv(r){const e=du.fromBinary(r);return hd(e)}const pe={fromPresence:Su,toChangePack:tv,fromChangePack:fv,fromChanges:dd,toTreeNodes:vu,fromTreeNodes:Tu,objectToBytes:vd,bytesToObject:yd,bytesToSnapshot:pv,bytesToHex:va,hexToBytes:ku,toHexString:Iu,toUint8Array:wa,toOperation:od,toChangeID:nd,PbChangeID:da,bytesToChangeID:kv,bytesToOperation:xv,versionVectorToHex:yv,hexToVersionVector:vv,fromSchemaRules:mv,toRevisionSummary:rv};var We=(r=>(r[r.Trivial=0]="Trivial",r[r.Debug=1]="Debug",r[r.Info=2]="Info",r[r.Warn=3]="Warn",r[r.Error=4]="Error",r[r.Fatal=5]="Fatal",r))(We||{});let ms=3;function Ev(r){ms=r}const B={trivial:(...r)=>{ms>0||typeof console<"u"&&console.log("YORKIE T:",...r)},debug:(...r)=>{ms>1||typeof console<"u"&&console.log("YORKIE D:",...r)},info:(...r)=>{ms>2||typeof console<"u"&&console.log("YORKIE I:",...r)},warn:(...r)=>{ms>3||typeof console<"u"&&(typeof console.warn<"u"?console.warn("YORKIE W:",...r):console.log("YORKIE W:",...r))},error:(...r)=>{ms>4||typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE E:",...r):console.log("YORKIE E:",...r))},fatal:(...r)=>{typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE F:",...r):console.log("YORKIE F:",...r))},isEnabled:r=>ms<=r};function wd(){return"xxxxxxxx-xxxx-4xxxy-xxxx-xxxxxxxxxxx".replace(/[xy]/g,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}const Ma=()=>{};class Cv{constructor(e){a(this,"finalized",!1);a(this,"observers",[]);a(this,"finalError");try{e(this)}catch(t){this.error(t)}}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(!e)throw new w(y.ErrInvalidArgument,"missing observer");if(this.finalized)throw new w(y.ErrRefused,"observable is finalized due to previous error");typeof e=="object"?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=Ma),s.error===void 0&&(s.error=Ma),s.complete===void 0&&(s.complete=Ma);const i=wd(),o=this.unsubscribeOne.bind(this,i);if(this.observers.push({subscriptionID:i,observer:s}),this.finalized)try{this.finalError?s.error(this.finalError):s.complete()}catch(c){B.warn(c)}return o}unsubscribeOne(e){var t;this.observers=(t=this.observers)==null?void 0:t.filter(n=>n.subscriptionID!==e)}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e].observer)}catch(n){B.error(n)}}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.observers=void 0)}}function bd(r){const e=new Cv(r);return{subscribe:e.subscribe.bind(e),getProxy:()=>e}}class Pi{constructor(e,t,n,s){a(this,"prevID");a(this,"nextID");a(this,"delimiter");a(this,"message");a(this,"root");a(this,"operations");a(this,"presenceChange");a(this,"previousPresence");a(this,"reversePresenceKeys");this.prevID=e,this.nextID=e.next(),this.delimiter=Vh,this.root=t,this.operations=[],this.previousPresence=Tt(n),this.presenceChange=void 0,this.reversePresenceKeys=new Set,this.message=s}static create(e,t,n,s){return new Pi(e,t,n,s)}push(e){this.operations.push(e)}registerElement(e,t){this.root.registerElement(e,t)}registerRemovedElement(e){this.root.registerRemovedElement(e)}registerGCPair(e){this.root.registerGCPair(e)}getNextID(){return this.isPresenceOnlyChange()?this.prevID.next(!0).setLamport(this.prevID.getLamport()).setVersionVector(this.prevID.getVersionVector()):this.nextID}toChange(){const e=this.isPresenceOnlyChange()?this.prevID.next(!0):this.nextID;return ni.create({id:e,operations:this.operations,presenceChange:this.presenceChange,message:this.message})}isPresenceOnlyChange(){return this.operations.length===0}hasChange(){return this.operations.length>0||this.presenceChange!==void 0}setPresenceChange(e){this.presenceChange=e}setReversePresence(e,t){for(const n of Object.keys(e))t!=null&&t.addToHistory?this.reversePresenceKeys.add(n):this.reversePresenceKeys.delete(n)}getReversePresence(){if(this.reversePresenceKeys.size===0)return;const e={};for(const t of this.reversePresenceKeys)e[t]=this.previousPresence[t];return e}issueTimeTicket(){return this.delimiter+=1,this.nextID.createTimeTicket(this.delimiter)}getLastTimeTicket(){return this.nextID.createTimeTicket(this.delimiter)}acc(e){this.root.acc(e)}}function Sd(r,e){const t=new Ki(r);return new Proxy(e,t.getHandlers())}class Ki{constructor(e){a(this,"context");a(this,"handlers");this.context=e,this.handlers={set:(t,n,s)=>(B.isEnabled(We.Trivial)&&B.trivial(`obj[${n}]=${JSON.stringify(s)}`),Ki.setInternal(e,t,n,s),!0),get:(t,n)=>(B.isEnabled(We.Trivial)&&B.trivial(`obj[${n}]`),n==="getID"?()=>t.getCreatedAt():n==="toJSON"||n==="toString"?()=>t.toJSON():n==="toJS"?()=>t.toJS():n==="toJSForTest"?()=>t.toJSForTest():ps(e,t.get(n))),ownKeys:t=>t.getKeys(),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),deleteProperty:(t,n)=>(B.isEnabled(We.Trivial)&&B.trivial(`obj[${n}]`),Ki.deleteInternal(e,t,n),!0)}}static setInternal(e,t,n,s){if(n.includes("."))throw new w(y.ErrInvalidObjectKey,"key must not contain the '.'.");const i=e.issueTimeTicket(),o=Ni(e,s,i),c=t.set(n,o,i);e.registerElement(o,t),c&&e.registerRemovedElement(c),e.push(xs.create(n,o.deepcopy(),t.getCreatedAt(),i))}static buildObjectMembers(e,t){const n={};for(const[s,i]of Object.entries(t)){if(s.includes("."))throw new w(y.ErrInvalidObjectKey,"key must not contain the '.'.");const o=e.issueTimeTicket(),c=Ni(e,i,o);n[s]=c}return n}static deleteInternal(e,t,n){const s=e.issueTimeTicket(),i=t.deleteByKey(n,s);i&&(e.push(Qt.create(t.getCreatedAt(),i.getCreatedAt(),s)),e.registerRemovedElement(i))}getHandlers(){return this.handlers}}function Pv(r,e){const t=new ne(r,e);return new Proxy(e,t.getHandlers())}function sf(r){return typeof r=="string"||r instanceof String?!isNaN(r):!1}function Nv(r){return["concat","entries","every","filter","find","findIndex","forEach","join","keys","map","reduce","reduceRight","slice","some","toLocaleString","toString","values"].includes(r)}class ne{constructor(e,t){a(this,"context");a(this,"handlers");a(this,"array");this.context=e,this.array=t,this.handlers={get:(n,s,i)=>s==="getID"?()=>n.getCreatedAt():s==="getElementByID"?o=>{const c=n.getByID(o);if(!(!c||c.isRemoved()))return St(e,c)}:s==="getElementByIndex"?o=>{const c=n.get(o);return St(e,c)}:s==="getLast"?()=>St(e,n.getLast()):s==="delete"?o=>{const c=ne.deleteInternalByIndex(e,n,o);return St(e,c)}:s==="deleteByID"?o=>{const c=ne.deleteInternalByID(e,n,o);return St(e,c)}:s==="insertAfter"?(o,c)=>{const u=ne.insertAfterInternal(e,n,o,c);return St(e,u)}:s==="insertIntegerAfter"?(o,c)=>{const u=ne.insertIntegerAfterInternal(e,n,o,c);return St(e,u)}:s==="insertBefore"?(o,c)=>{const u=ne.insertBeforeInternal(e,n,o,c);return St(e,u)}:s==="setValue"?(o,c)=>{const u=ne.setValueInternal(e,n,o,c);return St(e,u)}:s==="moveBefore"?(o,c)=>{ne.moveBeforeInternal(e,n,o,c)}:s==="moveAfter"?(o,c)=>{ne.moveAfterInternal(e,n,o,c)}:s==="moveAfterByIndex"?(o,c)=>{ne.moveAfterByIndexInternal(e,n,o,c)}:s==="moveFront"?o=>{ne.moveFrontInternal(e,n,o)}:s==="moveLast"?o=>{ne.moveLastInternal(e,n,o)}:sf(s)?ps(e,n.get(Number(s))):s==="push"?o=>ne.pushInternal(e,n,o):s==="splice"?(o,c,...u)=>ne.splice(e,n,o,c,...u):s==="length"?n.length:typeof s=="symbol"&&s===Symbol.iterator?ne.iteratorInternal.bind(this,e,n):s==="includes"?(o,c)=>ne.includes(e,n,o,c):s==="indexOf"?(o,c)=>ne.indexOf(e,n,o,c):s==="lastIndexOf"?(o,c)=>ne.lastIndexOf(e,n,o,c):s==="toJSForTest"?()=>n.toJSForTest():s==="toTestString"?()=>ne.toTestString(n):typeof s=="string"&&Nv(s)?(...o)=>{const c=Array.from(n).map(u=>ps(e,u));return Array.prototype[s].apply(c,o)}:Reflect.get(n,s,i),set:(n,s,i)=>{if(sf(s)){const o=Number(s);return ne.setValueInternal(e,n,o,i),!0}return Reflect.set(n,s,i)},deleteProperty:(n,s)=>(B.isEnabled(We.Trivial)&&B.trivial(`array[${s}]`),ne.deleteInternalByIndex(e,n,Number.parseInt(s)),!0)}}static*iteratorInternal(e,t){for(const n of t)yield St(e,n)}static buildArrayElements(e,t){const n=[];for(const s of t){const i=e.issueTimeTicket(),o=Ni(e,s,i);n.push(o)}return n}static pushInternal(e,t,n){return ne.insertAfterInternal(e,t,t.getLastCreatedAt(),n),t.length}static moveBeforeInternal(e,t,n,s){const i=e.issueTimeTicket(),o=t.getPrevCreatedAt(n);t.moveAfter(o,s,i),e.push(kt.create(t.getCreatedAt(),o,s,i))}static moveAfterInternal(e,t,n,s){const i=e.issueTimeTicket();e.push(kt.create(t.getCreatedAt(),n,s,i)),t.moveAfter(n,s,i)}static moveAfterByIndexInternal(e,t,n,s){const i=t.get(n);if(!i)throw new w(y.ErrInvalidArgument,`index out of bounds: ${n}`);const o=t.get(s);if(!o)throw new w(y.ErrInvalidArgument,`index out of bounds: ${s}`);ne.moveAfterInternal(e,t,i.getCreatedAt(),o.getCreatedAt())}static moveFrontInternal(e,t,n){const s=e.issueTimeTicket(),i=t.getHead();t.moveAfter(i.getCreatedAt(),n,s),e.push(kt.create(t.getCreatedAt(),i.getCreatedAt(),n,s))}static moveLastInternal(e,t,n){const s=e.issueTimeTicket(),i=t.getLastCreatedAt();t.moveAfter(i,n,s),e.push(kt.create(t.getCreatedAt(),i,n,s))}static insertAfterInternal(e,t,n,s){const i=e.issueTimeTicket(),o=Ni(e,s,i);return t.insertAfter(n,o),e.registerElement(o,t),e.push(cs.create(t.getCreatedAt(),n,o.deepcopy(),i)),o}static insertIntegerAfterInternal(e,t,n,s){const i=t.get(n);if(!i)throw new w(y.ErrInvalidArgument,`index out of bounds: ${n}`);return ne.insertAfterInternal(e,t,i.getCreatedAt(),s),t}static insertBeforeInternal(e,t,n,s){return ne.insertAfterInternal(e,t,t.getPrevCreatedAt(n),s)}static setValueInternal(e,t,n,s){const i=t.get(n);if(!i)throw new w(y.ErrInvalidArgument,`index out of bounds: ${n}`);return ne.setByIndexInternal(e,t,i.getCreatedAt(),s),t}static setByIndexInternal(e,t,n,s){const i=e.issueTimeTicket(),o=Ni(e,s,i),c=o.deepcopy();return e.push(Vn.create(t.getCreatedAt(),n,c,i)),t.set(n,o,i),e.registerElement(o,t),o}static deleteInternalByIndex(e,t,n){const s=e.issueTimeTicket(),i=t.deleteByIndex(n,s);if(i)return e.push(Qt.create(t.getCreatedAt(),i.getCreatedAt(),s)),e.registerRemovedElement(i),i}static deleteInternalByID(e,t,n){const s=e.issueTimeTicket(),i=t.delete(n,s);return e.push(Qt.create(t.getCreatedAt(),i.getCreatedAt(),s)),e.registerRemovedElement(i),i}static splice(e,t,n,s,...i){const o=t.length,c=n>=0?Math.min(n,o):Math.max(o+n,0),u=s===void 0?o:s<0?c:Math.min(c+s,o),f=[];for(let h=c;h<u;h++){const d=ne.deleteInternalByIndex(e,t,c);if(d){const p=d.deepcopy();p.setRemovedAt(),f.push(ps(e,p))}}if(i){let h=c===0?t.getHead().getID():t.get(c-1).getID();for(const d of i)h=ne.insertAfterInternal(e,t,h,d).getID()}return f}static includes(e,t,n,s){var c;const i=t.length,o=s===void 0?0:s<0?Math.max(s+i,0):s;if(o>=i)return!1;if(ve.isSupport(n))return Array.from(t).map(f=>ps(e,f)).includes(n,o);for(let u=o;u<i;u++)if(((c=t.get(u))==null?void 0:c.getID())===n.getID())return!0;return!1}static indexOf(e,t,n,s){var c;const i=t.length,o=s===void 0?0:s<0?Math.max(s+i,0):s;if(o>=i)return-1;if(ve.isSupport(n))return Array.from(t).map(f=>ps(e,f)).indexOf(n,o);for(let u=o;u<i;u++)if(((c=t.get(u))==null?void 0:c.getID())===n.getID())return u;return-1}static lastIndexOf(e,t,n,s){var c;const i=t.length,o=s===void 0||s>=i?i-1:s<0?s+i:s;if(o<0)return-1;if(ve.isSupport(n))return Array.from(t).map(f=>ps(e,f)).lastIndexOf(n,o);for(let u=o;u>0;u--)if(((c=t.get(u))==null?void 0:c.getID())===n.getID())return u;return-1}static toTestString(e){return e.toTestString()}getHandlers(){return this.handlers}}class xu{constructor(e,t){a(this,"context");a(this,"text");this.context=e,this.text=t}initialize(e,t){this.context=e,this.text=t}getID(){return this.text.getID()}edit(e,t,n,s){if(!this.context||!this.text)throw new w(y.ErrNotInitialized,"Text is not initialized yet");if(e>t)throw new w(y.ErrInvalidArgument,"from should be less than or equal to to");const i=this.text.indexRangeToPosRange(e,t);B.isEnabled(We.Debug)&&B.debug(`EDIT: f:${e}->${i[0].toTestString()}, t:${t}->${i[1].toTestString()} c:${n}`);const o=s?ri(s):void 0,c=this.context.issueTimeTicket(),[,u,f,h]=this.text.edit(i,n,c,o);this.context.acc(f);for(const d of u)this.context.registerGCPair(d);return this.context.push(new Gi(this.text.getCreatedAt(),i[0],i[1],n,o?new Map(Object.entries(o)):new Map,c)),this.text.findIndexesFromRange(h)}delete(e,t){return this.edit(e,t,"")}empty(){return this.edit(0,this.length,"")}setStyle(e,t,n){if(!this.context||!this.text)throw new w(y.ErrNotInitialized,"Text is not initialized yet");if(e>t)throw new w(y.ErrInvalidArgument,"from should be less than or equal to to");const s=this.text.indexRangeToPosRange(e,t);B.isEnabled(We.Debug)&&B.debug(`STYL: f:${e}->${s[0].toTestString()}, t:${t}->${s[1].toTestString()} a:${JSON.stringify(n)}`);const i=ri(n),o=this.context.issueTimeTicket(),[c,u]=this.text.setStyle(s,i,o);this.context.acc(u);for(const f of c)this.context.registerGCPair(f);return this.context.push(new _i(this.text.getCreatedAt(),s[0],s[1],new Map(Object.entries(i)),o)),!0}indexRangeToPosRange(e){if(!this.context||!this.text)throw new w(y.ErrNotInitialized,"Text is not initialized yet");const t=this.text.indexRangeToPosRange(e[0],e[1]);return[t[0].toStruct(),t[1].toStruct()]}posRangeToIndexRange(e){if(!this.context||!this.text)throw new w(y.ErrNotInitialized,"Text is not initialized yet");const t=this.text.findIndexesFromRange([Pt.fromStruct(e[0]),Pt.fromStruct(e[1])]);return[t[0],t[1]]}toTestString(){if(!this.context||!this.text)throw new w(y.ErrNotInitialized,"Text is not initialized yet");return this.text.toTestString()}values(){if(!this.context||!this.text)throw new w(y.ErrNotInitialized,"Text is not initialized yet");return this.text.values()}get length(){return this.text.length}getTreeByIndex(){return this.text.getTreeByIndex()}getTreeByID(){return this.text.getTreeByID()}toString(){if(!this.context||!this.text)throw new w(y.ErrNotInitialized,"Text is not initialized yet");return this.text.toString()}toJSON(){if(!this.context||!this.text)throw new w(y.ErrNotInitialized,"Text is not initialized yet");return this.text.toJSON()}toJSForTest(){if(!this.context||!this.text)throw new w(y.ErrNotInitialized,"Text is not initialized yet");return this.text.toJSForTest()}createRangeForTest(e,t){if(!this.context||!this.text)throw new w(y.ErrNotInitialized,"Text is not initialized yet");return this.text.indexRangeToPosRange(e,t)}}class Eu{constructor(e,t){a(this,"valueType");a(this,"value");a(this,"context");a(this,"counter");this.valueType=e,this.value=t}initialize(e,t){this.valueType=t.getValueType(),this.context=e,this.counter=t,this.value=t.getValue()}getID(){return this.counter.getID()}getValue(){return this.value}getValueType(){return this.valueType}increase(e){if(!this.context||!this.counter)throw new w(y.ErrNotInitialized,"Counter is not initialized yet");const t=this.context.issueTimeTicket(),n=ve.of(e,t);if(!n.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof n.getValue()}`);return this.counter.increase(n),this.context.push(ii.create(this.counter.getCreatedAt(),n,t)),this}toJSForTest(){if(!this.context||!this.counter)throw new w(y.ErrNotInitialized,"Counter is not initialized yet");return this.counter.toJSForTest()}}function Cu(r){if(r.isText)return{type:r.type,value:r.value};const e={type:r.type,children:r.children.map(t=>Cu(t))};return r.attrs&&(e.attributes=Mn(r.attrs.toObject())),e}function Dv(r,e){const t={type:r.isText?r.parent.type:r.type,children:r.isText?r.parent.getChildrenText().length===e?[]:[{type:_t,value:r.parent.getChildrenText().slice(e)}]:r.children.slice(e).map(n=>Cu(n))};return r.attrs?t.attributes=Mn(r.attrs.toObject()):r.isText&&r.parent.attrs&&(t.attributes=Mn(r.parent.attrs.toObject())),t}function Ov(r,e){const{node:t}=r,n=[...e].slice(0,-1),s=t.isText?t.parent.getChildrenText().length:t.children.length,i=[...n,s],o=[...n],c=[];o[o.length-1]+=1,e.every((f,h)=>f===i[h])||c.push({fromPath:[...e],toPath:i});const u=Dv(t,e[e.length-1]);return u&&c.push({fromPath:o,toPath:o,content:u}),c}function Bv(r,e){const{node:t,offset:n}=r,s=t.children[n],i=t.children[n-1],{children:o}=s,c=[...e].slice(0,-1),u=[{fromPath:[...e],toPath:[...c,n+1]}];if(!s.children.length)return u;const f=[...c,n-1,i.hasTextChild()?i.getChildrenText().length:i.children.length],h=o.map(d=>Cu(d));return u.push({fromPath:f,toPath:f,content:h}),u}function Pu(r,e,t){const{type:n}=r,s=t.issueTimeTicket();if(n===_t){Td(r);const{value:i}=r,o=et.create(Ne.of(s,0),n,i);e.append(o)}else{const{children:i=[]}=r,{attributes:o}=r;let c;if(typeof o=="object"&&!Yh(o)){const f=ri(o);c=new Kn;for(const[h,d]of Object.entries(f))c.set(h,d,s)}const u=et.create(Ne.of(s,0),n,void 0,c);e.append(u);for(const f of i)Pu(f,u,t)}}function Rv(r,e){const{type:t}=e,n=r.issueTimeTicket();let s;if(e.type===_t){const{value:i}=e;s=et.create(Ne.of(n,0),t,i)}else if(e){const{children:i=[]}=e,{attributes:o}=e;let c;if(typeof o=="object"&&!Yh(o)){const u=ri(o);c=new Kn;for(const[f,h]of Object.entries(u))c.set(f,h,n)}s=et.create(Ne.of(r.issueTimeTicket(),0),t,void 0,c);for(const u of i)Pu(u,s,r)}return s}function Td(r){if(!r.value.length)throw new w(y.ErrInvalidArgument,"text node cannot have empty value");return!0}function of(r){if(!r.length)return!0;if(r[0].type===_t)for(const t of r){const{type:n}=t;if(n!==_t)throw new w(y.ErrInvalidArgument,"element node and text node cannot be passed together");Td(t)}else for(const t of r){const{type:n}=t;if(n===_t)throw new w(y.ErrInvalidArgument,"element node and text node cannot be passed together")}return!0}class Nu{constructor(e){a(this,"initialRoot");a(this,"context");a(this,"tree");this.initialRoot=e}initialize(e,t){this.context=e,this.tree=t}getID(){return this.tree.getID()}buildRoot(e){if(!this.initialRoot)return et.create(Ne.of(e.issueTimeTicket(),0),Cy);const t=et.create(Ne.of(e.issueTimeTicket(),0),this.initialRoot.type);for(const n of this.initialRoot.children)Pu(n,t,e);return t}getSize(){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getSize()}getNodeSize(){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getNodeSize()}getIndexTree(){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getIndexTree()}splitByPath(e){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");if(!e.length)throw new w(y.ErrInvalidArgument,"path should not be empty");const t=this.tree.pathToTreePos(e),n=Ov(t,e);for(const s of n){const{fromPath:i,toPath:o,content:c}=s,u=this.tree.pathToPos(i),f=this.tree.pathToPos(o);this.editInternal(u,f,c?[c]:[],0)}}mergeByPath(e){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");if(!e.length)throw new w(y.ErrInvalidArgument,"path should not be empty");const t=this.tree.pathToTreePos(e);if(t.node.isText)throw new w(y.ErrInvalidArgument,"text node cannot be merged");const n=Bv(t,e);for(const s of n){const{fromPath:i,toPath:o,content:c}=s,u=this.tree.pathToPos(i),f=this.tree.pathToPos(o);this.editInternal(u,f,c??[],0)}}styleByPath(e,t){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");if(!e.length)throw new w(y.ErrInvalidArgument,"path should not be empty");const[n,s]=this.tree.pathToPosRange(e),i=this.context.issueTimeTicket(),o=t?ri(t):void 0,[c,,u]=this.tree.style([n,s],o,i);this.context.acc(u);for(const f of c)this.context.registerGCPair(f);this.context.push(Un.create(this.tree.getCreatedAt(),n,s,o?new Map(Object.entries(o)):new Map,i))}style(e,t,n){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new w(y.ErrInvalidArgument,"from should be less than or equal to to");const s=this.tree.findPos(e),i=this.tree.findPos(t),o=this.context.issueTimeTicket(),c=n?ri(n):void 0,[u,,f]=this.tree.style([s,i],c,o);this.context.acc(f);for(const h of u)this.context.registerGCPair(h);this.context.push(Un.create(this.tree.getCreatedAt(),s,i,c?new Map(Object.entries(c)):new Map,o))}removeStyle(e,t,n){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new w(y.ErrInvalidArgument,"from should be less than or equal to to");const s=this.tree.findPos(e),i=this.tree.findPos(t),o=this.context.issueTimeTicket(),[c,,u]=this.tree.removeStyle([s,i],n,o);this.context.acc(u);for(const f of c)this.context.registerGCPair(f);this.context.push(Un.createTreeRemoveStyleOperation(this.tree.getCreatedAt(),s,i,n,o))}editInternal(e,t,n,s=0){var f;if(n.length!==0&&n[0]&&(of(n),n[0].type!==_t))for(const h of n){const{children:d=[]}=h;of(d)}const i=this.context.getLastTimeTicket();let o=new Array;if(((f=n[0])==null?void 0:f.type)===_t){let h="";for(const d of n){const{value:p}=d;h+=p}o.push(et.create(Ne.of(this.context.issueTimeTicket(),0),_t,h))}else o=n.map(h=>h&&Rv(this.context,h)).filter(h=>h);const[,c,u]=this.tree.edit([e,t],o.length?o.map(h=>h==null?void 0:h.deepcopy()):void 0,s,i,()=>this.context.issueTimeTicket());this.context.acc(u);for(const h of c)this.context.registerGCPair(h);return this.context.push(Yi.create(this.tree.getCreatedAt(),e,t,o.length?o:void 0,s,i)),!0}editByPath(e,t,n,s=0){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");if(e.length!==t.length)throw new w(y.ErrInvalidArgument,"path length should be equal");if(!e.length||!t.length)throw new w(y.ErrInvalidArgument,"path should not be empty");const i=this.tree.pathToPos(e),o=this.tree.pathToPos(t);return this.editInternal(i,o,n?[n]:[],s)}editBulkByPath(e,t,n,s=0){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");if(e.length!==t.length)throw new w(y.ErrInvalidArgument,"path length should be equal");if(!e.length||!t.length)throw new w(y.ErrInvalidArgument,"path should not be empty");const i=this.tree.pathToPos(e),o=this.tree.pathToPos(t);return this.editInternal(i,o,n,s)}edit(e,t,n,s=0){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new w(y.ErrInvalidArgument,"from should be less than or equal to to");const i=this.tree.findPos(e),o=this.tree.findPos(t);return this.editInternal(i,o,n?[n]:[],s)}editBulk(e,t,n,s=0){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new w(y.ErrInvalidArgument,"from should be less than or equal to to");const i=this.tree.findPos(e),o=this.tree.findPos(t);return this.editInternal(i,o,n,s)}toXML(){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toXML()}toJSON(){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSON()}toJSForTest(){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSForTest()}toJSInfoForTest(){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSInfoForTest()}getRootTreeNode(){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getRootTreeNode()}indexToPath(e){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");return this.tree.indexToPath(e)}pathToIndex(e){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");return this.tree.pathToIndex(e)}pathRangeToPosRange(e){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");const t=[this.tree.pathToIndex(e[0]),this.tree.pathToIndex(e[1])],n=this.tree.indexRangeToPosRange(t);return[n[0].toStruct(),n[1].toStruct()]}indexRangeToPosRange(e){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");return this.tree.indexRangeToPosStructRange(e)}posRangeToIndexRange(e){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");const t=[xt.fromStruct(e[0]),xt.fromStruct(e[1])];return this.tree.posRangeToIndexRange(t)}posRangeToPathRange(e){if(!this.context||!this.tree)throw new w(y.ErrNotInitialized,"Tree is not initialized yet");const t=[xt.fromStruct(e[0]),xt.fromStruct(e[1])];return this.tree.posRangeToPathRange(t)}}function af(r,e){return Sd(r,e)}function St(r,e){if(e){if(e instanceof ve)return e;if(e instanceof Oe)return Sd(r,e);if(e instanceof Be)return Pv(r,e);if(e instanceof tt)return new xu(r,e);if(e instanceof Ge){const t=new Eu(er.Int,0);return t.initialize(r,e),t}else if(e instanceof rt){const t=new Nu;return t.initialize(r,e),t}}else return;throw new TypeError(`Unsupported type of element: ${typeof e}`)}function ps(r,e){const t=St(r,e);return t instanceof ve?t.getValue():t}function Ni(r,e,t){let n;if(ve.isSupport(e))n=ve.of(e,t);else if(Array.isArray(e))n=Be.create(t,ne.buildArrayElements(r,e));else if(typeof e=="object")e instanceof xu?(n=tt.create(si.create(),t),e.initialize(r,n)):e instanceof Eu?(n=Ge.create(e.getValueType(),e.getValue(),t),e.initialize(r,n)):e instanceof Nu?(n=rt.create(e.buildRoot(r),t),e.initialize(r,n)):n=Oe.create(t,Ki.buildObjectMembers(r,e));else throw new TypeError(`Unsupported type of value: ${typeof e}`);return n}class Vi{constructor(e){a(this,"rootObject");a(this,"elementPairMapByCreatedAt");a(this,"gcElementSetByCreatedAt");a(this,"gcPairMap");a(this,"docSize");this.rootObject=e,this.elementPairMapByCreatedAt=new Map,this.gcElementSetByCreatedAt=new Set,this.gcPairMap=new Map,this.docSize={live:{data:0,meta:0},gc:{data:0,meta:0}},this.registerElement(e,void 0),e.getDescendants(t=>{if(t.getRemovedAt()&&this.registerRemovedElement(t),t instanceof tt||t instanceof rt)for(const n of t.getGCPairs())this.registerGCPair(n);return!1})}static create(){return new Vi(Oe.create(Qs))}findByCreatedAt(e){const t=this.elementPairMapByCreatedAt.get(e.toIDString());if(t)return t.element}findElementPairByCreatedAt(e){return this.elementPairMapByCreatedAt.get(e.toIDString())}createSubPaths(e){let t=this.elementPairMapByCreatedAt.get(e.toIDString());if(!t)return[];const n=[];for(;t.parent;){const s=t.element.getCreatedAt(),i=t.parent.subPathOf(s);if(i===void 0)throw new w(y.ErrInvalidArgument,`cant find the given element: ${s.toIDString()}`);n.unshift(i),t=this.elementPairMapByCreatedAt.get(t.parent.getCreatedAt().toIDString())}return n.unshift("$"),n}createPath(e){return this.createSubPaths(e).join(".")}registerElement(e,t){this.elementPairMapByCreatedAt.set(e.getCreatedAt().toIDString(),{parent:t,element:e}),Pe(this.docSize.live,e.getDataSize()),e instanceof rs&&e.getDescendants((n,s)=>(this.elementPairMapByCreatedAt.set(n.getCreatedAt().toIDString(),{parent:s,element:n}),Pe(this.docSize.live,n.getDataSize()),!1))}deregisterElement(e){let t=0;const n=s=>{const i=s.getCreatedAt().toIDString();vs(this.docSize.gc,s.getDataSize()),this.elementPairMapByCreatedAt.delete(i),this.gcElementSetByCreatedAt.delete(i),t++};return n(e),e instanceof rs&&e.getDescendants(s=>(n(s),!1)),t}registerRemovedElement(e){Pe(this.docSize.gc,e.getDataSize()),vs(this.docSize.live,e.getDataSize()),this.docSize.live.meta+=Gt,this.gcElementSetByCreatedAt.add(e.getCreatedAt().toIDString())}registerGCPair(e){if(this.gcPairMap.get(e.child.toIDString())){this.gcPairMap.delete(e.child.toIDString());return}this.gcPairMap.set(e.child.toIDString(),e);const n=this.gcPairMap.get(e.child.toIDString()).child.getDataSize();Pe(this.docSize.gc,n),vs(this.docSize.live,n),e.child instanceof es||(this.docSize.live.meta+=Gt)}getElementMapSize(){return this.elementPairMapByCreatedAt.size}getGarbageElementSetSize(){const e=new Set;for(const t of this.gcElementSetByCreatedAt){e.add(t);const n=this.elementPairMapByCreatedAt.get(t);n.element instanceof rs&&n.element.getDescendants(s=>(e.add(s.getCreatedAt().toIDString()),!1))}return e.size}getObject(){return this.rootObject}getGarbageLen(){return this.getGarbageElementSetSize()+this.gcPairMap.size}getDocSize(){return this.docSize}deepcopy(){return new Vi(this.rootObject.deepcopy())}garbageCollect(e){let t=0;for(const n of this.gcElementSetByCreatedAt){const s=this.elementPairMapByCreatedAt.get(n),i=s.element.getRemovedAt();i&&(e!=null&&e.afterOrEqual(i))&&(s.parent.purge(s.element),t+=this.deregisterElement(s.element))}for(const[,n]of this.gcPairMap){const s=n.child.getRemovedAt();s&&(e!=null&&e.afterOrEqual(s))&&(n.parent.purge(n.child),vs(this.docSize.gc,n.child.getDataSize()),this.gcPairMap.delete(n.child.toIDString()),t+=1)}return t}toJSON(){return this.rootObject.toJSON()}toSortedJSON(){return this.rootObject.toSortedJSON()}getStats(){return{elements:this.getElementMapSize(),gcPairs:this.gcPairMap.size,gcElements:this.getGarbageElementSetSize()}}acc(e){Pe(this.docSize.live,e)}*getGCElementPairs(){for(const e of this.gcElementSetByCreatedAt){const t=this.elementPairMapByCreatedAt.get(e);t&&(yield t)}}}let cf=class{constructor(e,t){a(this,"context");a(this,"presence");this.context=e,this.presence=t}set(e,t){for(const n of Object.keys(e))this.presence[n]=e[n];this.context.setPresenceChange({type:Zt.Put,presence:Tt(this.presence)}),this.context.setReversePresence(e,t)}get(e){return this.presence[e]}clear(){this.presence={},this.context.setPresenceChange({type:Zt.Clear})}};const uf=50;class Lv{constructor(){a(this,"undoStack",[]);a(this,"redoStack",[])}hasUndo(){return this.undoStack.length>0}hasRedo(){return this.redoStack.length>0}pushUndo(e){this.undoStack.length>=uf&&this.undoStack.shift(),this.undoStack.push(e)}popUndo(){return this.undoStack.pop()}pushRedo(e){this.redoStack.length>=uf&&this.redoStack.shift(),this.redoStack.push(e)}popRedo(){return this.redoStack.pop()}clearRedo(){this.redoStack=[]}getUndoStackForTest(){return this.undoStack}getRedoStackForTest(){return this.redoStack}reconcileCreatedAt(e,t){const n=s=>{for(const i of s)for(const o of i)(o instanceof Vn||o instanceof Qt||o instanceof kt)&&o.getCreatedAt()===e&&o.setCreatedAt(t),(o instanceof cs||o instanceof kt)&&o.getPrevCreatedAt()===e&&o.setPrevCreatedAt(t)};n(this.undoStack),n(this.redoStack)}}function Jv(r,e){const t=[];for(const n of e){const s=$v(r,n.path),i=Fv(s,n);if(!i.valid)for(const o of i.errors||[])t.push(o)}return{valid:t.length===0,errors:t}}function $v(r,e){if(!e.startsWith("$"))throw new Error(`Path must start with $, got ${e}`);const t=e.split(".");let n=r;for(let s=1;s<t.length;s++){const i=t[s];if(!(n instanceof Oe))return;n=n.get(i)}return n}function Fv(r,e){switch(e.type){case"string":case"boolean":case"integer":case"double":case"long":case"date":case"bytes":case"null":return Uv(r,e);case"object":if(!(r instanceof Oe))return{valid:!1,errors:[{path:e.path,message:`expected object at path ${e.path}`}]};break;case"array":if(!(r instanceof Be))return{valid:!1,errors:[{path:e.path,message:`expected array at path ${e.path}`}]};break;case"yorkie.Text":if(!(r instanceof tt))return{valid:!1,errors:[{path:e.path,message:`expected yorkie.Text at path ${e.path}`}]};break;case"yorkie.Tree":if(!(r instanceof rt))return{valid:!1,errors:[{path:e.path,message:`expected yorkie.Tree at path ${e.path}`}]};break;case"yorkie.Counter":if(!(r instanceof Ge))return{valid:!1,errors:[{path:e.path,message:`expected yorkie.Counter at path ${e.path}`}]};break;default:throw new Error(`Unknown rule type: ${e.type}`)}return{valid:!0}}function Mv(r){switch(r){case"null":return fe.Null;case"boolean":return fe.Boolean;case"integer":return fe.Integer;case"long":return fe.Long;case"double":return fe.Double;case"string":return fe.String;case"bytes":return fe.Bytes;case"date":return fe.Date;default:throw new Error(`Unknown primitive type: ${r}`)}}function Uv(r,e){return r instanceof ve&&r.getType()===Mv(e.type)?{valid:!0}:{valid:!1,errors:[{path:e.path,message:`expected ${e.type} at path ${e.path}`}]}}const zv="yorkie-devtools-panel",qv="yorkie-devtools-sdk";function Kv(r){return[Ee.StatusChanged,Ee.Snapshot,Ee.LocalChange,Ee.RemoteChange,Ee.Initialized,Ee.Watched,Ee.Unwatched,Ee.PresenceChanged].includes(r.type)}function Vv(r){return r.every(Kv)}let Ls="disconnected";const lf=new Map,bo=new Map;typeof window<"u"&&(window.docEventsForReplayByDocKey=bo);function uo(r,e){(e!=null&&e.force||Ls!=="disconnected")&&window.postMessage({source:qv,...r},"*")}function jv(r){if(!r.isEnableDevtools()||typeof window>"u"||lf.has(r.getKey()))return;bo.set(r.getKey(),[]);const e=r.subscribe("all",t=>{Vv(t)&&(bo.get(r.getKey()).push(t),Ls==="synced"&&uo({msg:"doc::sync::partial",docKey:r.getKey(),event:t}))});lf.set(r.getKey(),[e]),uo({msg:"refresh-devtools"},{force:!0}),window.addEventListener("message",t=>{var s;if(((s=t.data)==null?void 0:s.source)!==zv)return;switch(t.data.msg){case"devtools::connect":if(Ls!=="disconnected")break;Ls="connected",uo({msg:"doc::available",docKey:r.getKey()}),B.info(`[YD] Devtools connected. Doc: ${r.getKey()}`);break;case"devtools::disconnect":Ls="disconnected",B.info(`[YD] Devtools disconnected. Doc: ${r.getKey()}`);break;case"devtools::subscribe":Ls="synced",uo({msg:"doc::sync::full",docKey:r.getKey(),events:bo.get(r.getKey())}),B.info(`[YD] Devtools subscribed. Doc: ${r.getKey()}`);break}})}var _n=(r=>(r.Detached="detached",r.Attached="attached",r.Removed="removed",r))(_n||{}),Ee=(r=>(r.StatusChanged="status-changed",r.ConnectionChanged="connection-changed",r.SyncStatusChanged="sync-status-changed",r.Snapshot="snapshot",r.LocalChange="local-change",r.RemoteChange="remote-change",r.Initialized="initialized",r.Watched="watched",r.Unwatched="unwatched",r.PresenceChanged="presence-changed",r.AuthError="auth-error",r))(Ee||{}),So=(r=>(r.Connected="connected",r.Disconnected="disconnected",r))(So||{}),Wc=(r=>(r.Synced="synced",r.SyncFailed="sync-failed",r))(Wc||{});class Qn{constructor(e,t){a(this,"key");a(this,"status");a(this,"opts");a(this,"maxSizeLimit");a(this,"schemaRules");a(this,"changeID");a(this,"checkpoint");a(this,"localChanges");a(this,"root");a(this,"presences");a(this,"clone");a(this,"internalHistory");a(this,"isUpdating");a(this,"onlineClients");a(this,"eventStream");a(this,"eventStreamObserver");a(this,"history");this.key=e,this.status="detached",this.opts=t||{},this.maxSizeLimit=0,this.schemaRules=[],this.changeID=Jy,this.checkpoint=$y,this.localChanges=[],this.root=Vi.create(),this.presences=new Map,this.onlineClients=new Set,this.internalHistory=new Lv,this.isUpdating=!1,this.eventStream=bd(n=>this.eventStreamObserver=n),this.history={canUndo:()=>this.internalHistory.hasUndo()&&!this.isUpdating,canRedo:()=>this.internalHistory.hasRedo()&&!this.isUpdating,undo:()=>this.executeUndoRedo(!0),redo:()=>this.executeUndoRedo(!1)},jv(this)}update(e,t){var c,u,f;if(this.getStatus()==="removed")throw new w(y.ErrDocumentRemoved,`${this.key} is removed`);this.ensureClone();const n=this.changeID.getActorID(),s=Pi.create(this.changeID,this.clone.root,this.clone.presences.get(n)||{},t);try{const h=af(s,this.clone.root.getObject());this.presences.has(n)||this.clone.presences.set(n,{}),this.isUpdating=!0,e(h,new cf(s,this.clone.presences.get(n)))}catch(h){throw this.clone=void 0,h}finally{this.isUpdating=!1}const i=this.getSchemaRules();if(!s.isPresenceOnlyChange()&&i.length){const h=Jv((c=this.clone)==null?void 0:c.root.getObject(),i);if(!h.valid)throw this.clone=void 0,new w(y.ErrDocumentSchemaValidationFailed,`schema validation failed: ${(u=h.errors)==null?void 0:u.map(d=>d.message).join(", ")}`)}const o=xy((f=this.clone)==null?void 0:f.root.getDocSize());if(!s.isPresenceOnlyChange()&&this.maxSizeLimit>0&&this.maxSizeLimit<o)throw this.clone=void 0,new w(y.ErrDocumentSizeExceedsLimit,`document size exceeded: ${o} > ${this.maxSizeLimit}`);if(s.hasChange()){B.isEnabled(We.Trivial)&&B.trivial(`trying to update a local change: ${this.toJSON()}`);const h=s.toChange(),{opInfos:d,reverseOps:p}=h.execute(this.root,this.presences,me.Local);for(const A of h.getOperations())A instanceof Vn&&this.internalHistory.reconcileCreatedAt(A.getCreatedAt(),A.getValue().getCreatedAt());const m=s.getReversePresence();m&&p.push({type:"presence",value:m}),this.localChanges.push(h),p.length&&this.internalHistory.pushUndo(p),d.length&&this.internalHistory.clearRedo(),this.changeID=s.getNextID();const T=[];d.length&&T.push({type:"local-change",source:me.Local,value:{message:h.getMessage()||"",operations:d,actor:n,clientSeq:h.getID().getClientSeq(),serverSeq:h.getID().getServerSeq()},rawChange:this.isEnableDevtools()?h.toStruct():void 0}),h.hasPresenceChange()&&T.push({type:"presence-changed",source:me.Local,value:{clientID:n,presence:this.getPresence(n)}}),this.publish(T),B.isEnabled(We.Trivial)&&B.trivial(`after update a local change: ${this.toJSON()}`)}}subscribe(e,t,n,s){if(typeof e=="string"){if(typeof t!="function")throw new w(y.ErrInvalidArgument,"Second argument must be a callback function");if(e==="presence"){const c=t;return this.eventStream.subscribe(u=>{for(const f of u)f.type!=="initialized"&&f.type!=="watched"&&f.type!=="unwatched"&&f.type!=="presence-changed"||c(f)},n,s)}if(e==="my-presence"){const c=t;return this.eventStream.subscribe(u=>{for(const f of u)f.type!=="initialized"&&f.type!=="presence-changed"||f.type==="presence-changed"&&f.value.clientID!==this.changeID.getActorID()||c(f)},n,s)}if(e==="others"){const c=t;return this.eventStream.subscribe(u=>{for(const f of u)f.type!=="watched"&&f.type!=="unwatched"&&f.type!=="presence-changed"||f.value.clientID!==this.changeID.getActorID()&&c(f)},n,s)}if(e==="connection"){const c=t;return this.eventStream.subscribe(u=>{for(const f of u)f.type==="connection-changed"&&c(f)},n,s)}if(e==="status"){const c=t;return this.eventStream.subscribe(u=>{for(const f of u)f.type==="status-changed"&&c(f)},n,s)}if(e==="sync"){const c=t;return this.eventStream.subscribe(u=>{for(const f of u)f.type==="sync-status-changed"&&c(f)},n,s)}if(e==="auth-error"){const c=t;return this.eventStream.subscribe(u=>{for(const f of u)f.type==="auth-error"&&c(f)},n)}if(e==="all"){const c=t;return this.eventStream.subscribe(c,n,s)}const i=e,o=t;return this.eventStream.subscribe(c=>{for(const u of c){if(u.type!=="local-change"&&u.type!=="remote-change")continue;const f=[];for(const h of u.value.operations)this.isSameElementOrChildOf(h.path,i)&&f.push(h);f.length&&o({...u,value:{...u.value,operations:f}})}},n,s)}if(typeof e=="function"){const i=e,o=t,c=n;return this.eventStream.subscribe(u=>{for(const f of u)f.type!=="snapshot"&&f.type!=="local-change"&&f.type!=="remote-change"||i(f)},o,c)}throw new w(y.ErrInvalidArgument,`"${e}" is not a valid`)}publish(e){this.eventStreamObserver&&this.eventStreamObserver.next(e)}applyChangePack(e){e.hasSnapshot()?this.applySnapshot(e.getCheckpoint().getServerSeq(),e.getVersionVector(),e.getSnapshot(),e.getCheckpoint().getClientSeq()):(this.applyChanges(e.getChanges(),me.Remote),this.removePushedLocalChanges(e.getCheckpoint().getClientSeq())),this.checkpoint=this.checkpoint.forward(e.getCheckpoint()),e.hasSnapshot()||this.garbageCollect(e.getVersionVector()),e.getIsRemoved()&&this.applyStatus("removed"),B.isEnabled(We.Trivial)&&B.trivial(`${this.root.toJSON()}`)}getCheckpoint(){return this.checkpoint}getChangeID(){return this.changeID}hasLocalChanges(){return this.localChanges.length>0}ensureClone(){this.clone||(this.clone={root:this.root.deepcopy(),presences:Tt(this.presences)})}createChangePack(){const e=Array.from(this.localChanges),t=this.checkpoint.increaseClientSeq(e.length);return ya.create(this.key,t,!1,e,this.getVersionVector())}setActor(e){for(const t of this.localChanges)t.setActor(e);this.changeID=this.changeID.setActor(e)}isEnableDevtools(){return!!this.opts.enableDevtools}getKey(){return this.key}getStatus(){return this.status}getClone(){return this.clone}getCloneRoot(){if(this.clone)return this.clone.root.getObject()}getRoot(){this.ensureClone();const e=Pi.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});return af(e,this.clone.root.getObject())}getDocSize(){return this.root.getDocSize()}getMaxSizePerDocument(){return this.maxSizeLimit}setMaxSizePerDocument(e){this.maxSizeLimit=e}getSchemaRules(){return this.schemaRules}setSchemaRules(e){this.schemaRules=e}garbageCollect(e){return this.opts.disableGC?0:(this.clone&&this.clone.root.garbageCollect(e),this.root.garbageCollect(e))}getRootObject(){return this.root.getObject()}getGarbageLen(){return this.root.getGarbageLen()}getRootCRDT(){return this.root}getGarbageLenFromClone(){return this.clone.root.getGarbageLen()}toJSON(){return this.root.toJSON()}toSortedJSON(){return this.root.toSortedJSON()}getStats(){return this.root.getStats()}toJSForTest(){return{...this.getRoot().toJSForTest(),key:"root"}}applySnapshot(e,t,n,s=-1){const{root:i,presences:o}=pe.bytesToSnapshot(n);this.root=new Vi(i),this.presences=o,this.changeID=this.changeID.setClocks(t.maxLamport(),t),this.clone=void 0,this.removePushedLocalChanges(s),this.applyChanges(this.localChanges,me.Local),this.publish([{type:"snapshot",source:me.Remote,value:{serverSeq:e.toString(),snapshot:this.isEnableDevtools()?pe.bytesToHex(n):void 0,snapshotVector:pe.versionVectorToHex(t)}}])}applyChanges(e,t){B.isEnabled(We.Debug)&&B.debug(`trying to apply ${e.length} remote changes.elements:${this.root.getElementMapSize()}, removeds:${this.root.getGarbageElementSetSize()}`),B.isEnabled(We.Trivial)&&B.trivial(e.map(n=>`${n.getID().toTestString()}	${n.toTestString()}`).join(`
`));for(const n of e)this.applyChange(n,t);B.isEnabled(We.Debug)&&B.debug(`after appling ${e.length} remote changes.elements:${this.root.getElementMapSize()},  removeds:${this.root.getGarbageElementSetSize()}`)}applyChange(e,t){this.ensureClone(),e.execute(this.clone.root,this.clone.presences,t);const n=[],s=e.getID().getActorID();if(e.hasPresenceChange()&&this.onlineClients.has(s)){const o=e.getPresenceChange();switch(o.type){case Zt.Put:n.push(this.presences.has(s)?{type:"presence-changed",source:t,value:{clientID:s,presence:o.presence}}:{type:"watched",source:me.Remote,value:{clientID:s,presence:o.presence}});break;case Zt.Clear:n.push({type:"unwatched",source:me.Remote,value:{clientID:s,presence:this.getPresence(s)}}),this.removeOnlineClient(s);break}}const{opInfos:i}=e.execute(this.root,this.presences,t);if(this.changeID=this.changeID.syncClocks(e.getID()),i.length){const o=this.isEnableDevtools()?e.toStruct():void 0;n.push(t===me.Remote?{type:"remote-change",source:t,value:{actor:s,clientSeq:e.getID().getClientSeq(),serverSeq:e.getID().getServerSeq(),message:e.getMessage()||"",operations:i},rawChange:o}:{type:"local-change",source:t,value:{actor:s,clientSeq:e.getID().getClientSeq(),serverSeq:e.getID().getServerSeq(),message:e.getMessage()||"",operations:i},rawChange:o})}n.length&&this.publish(n)}applyWatchStream(e){if(e.body.case==="initialization"){const t=e.body.value.clientIds,n=new Set;for(const s of t)s!==this.changeID.getActorID()&&n.add(s);this.setOnlineClients(n),this.publish([{type:"initialized",source:me.Local,value:this.getPresences()}]);return}if(e.body.case==="event"){const{type:t,publisher:n}=e.body.value,s=[];if(t===Ys.DOCUMENT_WATCHED){if(this.onlineClients.has(n)&&this.hasPresence(n))return;this.addOnlineClient(n),this.hasPresence(n)&&s.push({type:"watched",source:me.Remote,value:{clientID:n,presence:this.getPresence(n)}})}else if(t===Ys.DOCUMENT_UNWATCHED){const i=this.getPresence(n);this.removeOnlineClient(n),i&&s.push({type:"unwatched",source:me.Remote,value:{clientID:n,presence:i}})}s.length&&this.publish(s)}}applyStatus(e){this.status=e,e==="detached"&&this.setActor(gu),this.publish([{source:e==="removed"?me.Remote:me.Local,type:"status-changed",value:e==="attached"?{status:e,actorID:this.changeID.getActorID()}:{status:e}}])}applyDocEventsForReplay(e){for(const t of e){if(t.type==="status-changed"){this.applyStatus(t.value.status),t.value.status==="attached"&&this.setActor(t.value.actorID);continue}if(t.type==="snapshot"){const{snapshot:n,serverSeq:s,snapshotVector:i}=t.value;if(!n)continue;this.applySnapshot(BigInt(s),pe.hexToVersionVector(i),pe.hexToBytes(n));continue}if(t.type==="local-change"||t.type==="remote-change"){if(!t.rawChange)continue;const n=ni.fromStruct(t.rawChange);this.applyChange(n,t.source)}if(t.type==="initialized"){const n=new Set;for(const{clientID:s,presence:i}of t.value)n.add(s),this.presences.set(s,i);this.setOnlineClients(n)}else if(t.type==="watched"){const{clientID:n,presence:s}=t.value;this.addOnlineClient(n),this.presences.set(n,s)}else if(t.type==="unwatched"){const{clientID:n}=t.value;this.removeOnlineClient(n),this.presences.delete(n)}else if(t.type==="presence-changed"){const{clientID:n,presence:s}=t.value;this.presences.set(n,s)}}}getValueByPath(e){if(!e.startsWith("$"))throw new w(y.ErrInvalidArgument,'path must start with "$"');const t=e.split(".");t.shift();let n=this.getRoot();for(const s of t)if(n=n[s],!n)return;return n}setOnlineClients(e){this.onlineClients=e}resetOnlineClients(){this.onlineClients=new Set}addOnlineClient(e){this.onlineClients.add(e)}removeOnlineClient(e){this.onlineClients.delete(e)}hasPresence(e){return this.presences.has(e)}getMyPresence(){if(this.status!=="attached")return{};const e=this.presences.get(this.changeID.getActorID());return e?Tt(e):{}}getOthersPresences(){const e=[],t=this.changeID.getActorID();for(const n of this.onlineClients)n!==t&&this.presences.has(n)&&e.push({clientID:n,presence:Tt(this.presences.get(n))});return e}getPresence(e){if(e===this.changeID.getActorID())return this.getMyPresence();if(!this.onlineClients.has(e))return;const t=this.presences.get(e);return t?Tt(t):void 0}getPresences(){const e=[];e.push({clientID:this.changeID.getActorID(),presence:Tt(this.getMyPresence())});for(const t of this.onlineClients)this.presences.has(t)&&e.push({clientID:t,presence:Tt(this.presences.get(t))});return e}getPresenceForTest(e){const t=this.presences.get(e);return t?Tt(t):void 0}getSelfForTest(){return{clientID:this.getChangeID().getActorID(),presence:this.getMyPresence()}}getOthersForTest(){const e=this.getChangeID().getActorID();return this.getPresences().filter(t=>t.clientID!==e).sort((t,n)=>t.clientID>n.clientID?1:-1)}getUndoStackForTest(){return this.internalHistory.getUndoStackForTest()}getRedoStackForTest(){return this.internalHistory.getRedoStackForTest()}getVersionVector(){return this.changeID.getVersionVector()}isSameElementOrChildOf(e,t){if(t===e)return!0;const n=e.split(".");return t.split(".").every((s,i)=>s===n[i])}removePushedLocalChanges(e){for(;this.localChanges.length&&!(this.localChanges[0].getID().getClientSeq()>e);)this.localChanges.shift()}executeUndoRedo(e){if(this.isUpdating)throw new w(y.ErrRefused,`${e?"Undo":"Redo"} is not allowed during an update`);const t=e?this.internalHistory.popUndo():this.internalHistory.popRedo();if(!t)throw new w(y.ErrRefused,`There is no operation to be ${e?"undone":"redone"}`);this.ensureClone();const n=Pi.create(this.changeID,this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(const h of t){if(!(h instanceof Nt)){new cf(n,Tt(this.clone.presences.get(this.changeID.getActorID()))).set(h.value,{addToHistory:!0});continue}const d=n.issueTimeTicket();if(h.setExecutedAt(d),h instanceof Vn){const p=h.getCreatedAt();h.getValue().setCreatedAt(d),this.internalHistory.reconcileCreatedAt(p,d)}else if(h instanceof cs){const p=h.getValue().getCreatedAt();h.getValue().setCreatedAt(d),this.internalHistory.reconcileCreatedAt(p,d)}n.push(h)}const s=n.toChange();s.execute(this.clone.root,this.clone.presences,me.UndoRedo);const{opInfos:i,reverseOps:o}=s.execute(this.root,this.presences,me.UndoRedo),c=n.getReversePresence();if(c&&o.push({type:"presence",value:c}),o.length&&(e?this.internalHistory.pushRedo(o):this.internalHistory.pushUndo(o)),!s.hasPresenceChange()&&!i.length)return;this.localChanges.push(s),this.changeID=n.getNextID();const u=this.changeID.getActorID(),f=[];i.length&&f.push({type:"local-change",source:me.UndoRedo,value:{message:s.getMessage()||"",operations:i,actor:u,clientSeq:s.getID().getClientSeq(),serverSeq:s.getID().getServerSeq()},rawChange:this.isEnableDevtools()?s.toStruct():void 0}),s.hasPresenceChange()&&f.push({type:"presence-changed",source:me.UndoRedo,value:{clientID:u,presence:this.getPresence(u)}}),this.publish(f)}}class ff{constructor(e,t,n,s){a(this,"resource");a(this,"resourceID");a(this,"syncMode");a(this,"changeEventReceived");a(this,"lastHeartbeatTime");a(this,"reconnectStreamDelay");a(this,"cancelled");a(this,"watchStream");a(this,"watchLoopTimerID");a(this,"watchAbortController");this.reconnectStreamDelay=e,this.resource=t,this.resourceID=n,this.syncMode=s,this.changeEventReceived=s!==void 0?!1:void 0,this.lastHeartbeatTime=Date.now(),this.cancelled=!1}changeSyncMode(e){this.syncMode=e}needRealtimeSync(){return this.syncMode===yi.RealtimeSyncOff?!1:this.syncMode===yi.RealtimePushOnly?this.resource.hasLocalChanges():this.syncMode!==yi.Manual&&(this.resource.hasLocalChanges()||(this.changeEventReceived??!1))}needSync(e){return this.resource instanceof Qn?this.needRealtimeSync():this.syncMode===yi.Manual?!1:Date.now()-this.lastHeartbeatTime>=e}updateHeartbeatTime(){this.lastHeartbeatTime=Date.now()}async runWatchLoop(e){const t=async()=>{if(this.watchStream)return Promise.resolve();this.watchLoopTimerID&&(clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0);try{[this.watchStream,this.watchAbortController]=await e(()=>{this.watchStream=void 0,this.watchAbortController=void 0,this.cancelled||(this.watchLoopTimerID=setTimeout(t,this.reconnectStreamDelay))})}catch{}};await t()}cancelWatchStream(){this.cancelled=!0,this.watchStream&&this.watchAbortController&&(this.watchAbortController.abort(),this.watchStream=void 0,this.watchAbortController=void 0),clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0}}function Wv(r,e){let t=e;return{authInterceptor:i=>async o=>(r&&o.header.set("x-api-key",r),t&&o.header.set("authorization",t),await i(o)),setToken:i=>{t=i}}}const Hv="@yorkie-js/sdk",Gv="0.6.39",hf={name:Hv,version:Gv};function _v(r){return e=>async t=>(r?t.header.set("x-yorkie-user-agent",r):t.header.set("x-yorkie-user-agent",hf.name+"/"+hf.version),await e(t))}const Yv=r=>{try{if(JSON.stringify(r)===void 0)return!1}catch{return!1}return!0};var pi=(r=>(r.Detached="detached",r.Attached="attached",r.Removed="removed",r))(pi||{}),$s=(r=>(r.PresenceChanged="presence-changed",r.Initialized="initialized",r.Broadcast="broadcast",r.LocalBroadcast="local-broadcast",r.AuthError="auth-error",r))($s||{});const di=".";class Yn{constructor(e){a(this,"key");a(this,"status");a(this,"actorID");a(this,"sessionID");a(this,"count");a(this,"seq");a(this,"eventStream");a(this,"eventStreamObserver");this.validateChannelKey(e),this.key=e,this.status="detached",this.count=0,this.seq=0,this.eventStream=bd(t=>this.eventStreamObserver=t)}getKey(){return this.key}getFirstKeyPath(){return this.key.split(di)[0]}getStatus(){return this.status}applyStatus(e){this.status=e}isAttached(){return this.status==="attached"}getActorID(){return this.actorID}setActor(e){this.actorID=e}getSessionID(){return this.sessionID}setSessionID(e){this.sessionID=e}getPresenceCount(){return this.count}updateCount(e,t){return t===0||t>this.seq?(this.count=e,this.seq=t,!0):!1}hasLocalChanges(){return!1}subscribe(e,t){if(typeof e=="function")return this.eventStream.subscribe(e);const n=e,s=t;if(!s)throw new Error("callback is required when subscribing to specific event type or topic");if(n==="broadcast")return this.eventStream.subscribe(o=>{o.type==="broadcast"&&s(o)});if(n==="local-broadcast")return this.eventStream.subscribe(o=>{o.type==="local-broadcast"&&s(o)});if(n==="auth-error")return this.eventStream.subscribe(o=>{o.type==="auth-error"&&s(o)});if(n==="presence")return this.eventStream.subscribe(o=>{(o.type==="presence-changed"||o.type==="initialized")&&s(o)});if(n==="all")return this.eventStream.subscribe(s);const i=n;return this.eventStream.subscribe(o=>{o.type==="broadcast"&&o.topic===i&&s(o)})}publish(e){this.eventStreamObserver&&this.eventStreamObserver.next(e)}broadcast(e,t,n){if(this.status!=="attached")throw new Error(`channel is not attached: ${this.status}`);if(!this.actorID)throw new Error("actorID is not set");this.publish({type:"local-broadcast",clientID:this.actorID,topic:e,payload:t,options:n})}validateChannelKey(e){if(e==="")throw new Error("channel key must not be empty");if(e.includes(" "))throw new Error("channel key must not contain a whitespace");if(e.startsWith(di))throw new Error("channel key must not start with a period");if(e.endsWith(di))throw new Error("channel key must not end with a period");if(e.includes(`${di}${di}`))throw new Error("channel key path must not empty")}}var yi=(r=>(r.Manual="manual",r.Realtime="realtime",r.RealtimePushOnly="realtime-pushonly",r.RealtimeSyncOff="realtime-syncoff",r))(yi||{});const Ds={rpcAddr:"https://api.yorkie.dev",syncLoopDuration:50,retrySyncLoopDelay:1e3,reconnectStreamDelay:1e3,channelHeartbeatInterval:3e4},Ua={maxRetries:1/0,initialRetryInterval:1e3,maxBackoff:2e4};class Ad{constructor(e){a(this,"id");a(this,"key");a(this,"metadata");a(this,"status");a(this,"attachmentMap");a(this,"apiKey");a(this,"authTokenInjector");a(this,"conditions");a(this,"syncLoopDuration");a(this,"reconnectStreamDelay");a(this,"retrySyncLoopDelay");a(this,"channelHeartbeatInterval");a(this,"rpcClient");a(this,"setAuthToken");a(this,"taskQueue");a(this,"processing",!1);a(this,"keepalive",!1);e=e||Ds;const t=e.rpcAddr||Ds.rpcAddr;this.key=e.key||wd(),this.metadata=e.metadata||{},this.status="deactivated",this.attachmentMap=new Map,this.apiKey=e.apiKey||"",this.authTokenInjector=e.authTokenInjector,this.conditions={SyncLoop:!1,WatchLoop:!1},this.syncLoopDuration=e.syncLoopDuration??Ds.syncLoopDuration,this.reconnectStreamDelay=e.reconnectStreamDelay??Ds.reconnectStreamDelay,this.retrySyncLoopDelay=e.retrySyncLoopDelay??Ds.retrySyncLoopDelay,this.channelHeartbeatInterval=e.channelHeartbeatInterval??Ds.channelHeartbeatInterval;const{authInterceptor:n,setToken:s}=Wv(this.apiKey);this.setAuthToken=s,this.rpcClient=_p(vy,yy({baseUrl:t,interceptors:[n,_v(e==null?void 0:e.userAgent)],fetch:(i,o)=>fetch(i,{...o,keepalive:this.keepalive})})),this.taskQueue=[]}async activate(){if(this.isActive())return Promise.resolve();if(this.authTokenInjector){const e=await this.authTokenInjector();this.setAuthToken(e)}return this.enqueueTask(async()=>{try{const e=await this.rpcClient.activateClient({clientKey:this.key,metadata:this.metadata},{headers:{"x-shard-key":`${this.apiKey}/${this.key}`}});this.id=e.clientId,this.status="activated",this.runSyncLoop(),B.info(`[AC] c:"${this.getKey()}" activated, id:"${this.id}"`),typeof window<"u"&&window.addEventListener("beforeunload",async()=>{await this.deactivate({keepalive:!0})})}catch(e){throw B.error(`[AC] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}})}deactivate(e={keepalive:!1,synchronous:!1}){if(this.status==="deactivated")return Promise.resolve();const t=async()=>{try{await this.rpcClient.deactivateClient({clientId:this.id,synchronous:e.synchronous},{headers:{"x-shard-key":`${this.apiKey}/${this.key}`}}),this.deactivateInternal(),B.info(`[DC] c"${this.getKey()}" deactivated`)}catch(n){throw B.error(`[DC] c:"${this.getKey()}" err :`,n),await this.handleConnectError(n),n}};if(e.keepalive){this.keepalive=!0;const n=t();return this.keepalive=!1,n}return this.enqueueTask(t)}has(e){return this.attachmentMap.has(e)}attach(e,t){return e instanceof Yn?this.attachChannel(e,t):this.attachDocument(e,t)}attachDocument(e,t={}){if(!this.isActive())throw new w(y.ErrClientNotActivated,`${this.key} is not active`);if(e.getStatus()!==_n.Detached)throw new w(y.ErrNotDetached,`${e.getKey()} is not detached`);e.setActor(this.id),e.update((s,i)=>i.set(t.initialPresence||{}));const n=t.syncMode??"realtime";return this.enqueueTask(async()=>{try{const s=await this.rpcClient.attachDocument({clientId:this.id,changePack:pe.toChangePack(e.createChangePack()),schemaKey:t.schema},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}});(s.maxSizePerDocument??0)>0&&e.setMaxSizePerDocument(s.maxSizePerDocument),s.schemaRules.length>0&&e.setSchemaRules(pe.fromSchemaRules(s.schemaRules));const o=pe.fromChangePack(s.changePack);if(e.applyChangePack(o),e.getStatus()===_n.Removed)return e;e.applyStatus(_n.Attached),this.attachmentMap.set(e.getKey(),new ff(this.reconnectStreamDelay,e,s.documentId,n)),n!=="manual"&&await this.runWatchLoop(e.getKey()),B.info(`[AD] c:"${this.getKey()}" attaches d:"${e.getKey()}"`);const c=e.getRootObject();if(t.initialRoot){const u=t.initialRoot;e.update(f=>{for(const[h,d]of Object.entries(u))if(!c.has(h)){const p=h;f[p]=d}})}return e}catch(s){throw B.error(`[AD] c:"${this.getKey()}" err :`,s),await this.handleConnectError(s),s}})}detach(e,t){return e instanceof Yn?this.detachChannel(e):this.detachDocument(e,t)}detachDocument(e,t={keepalive:!1}){if(!this.isActive())throw new w(y.ErrClientNotActivated,`${this.key} is not active`);const n=this.attachmentMap.get(e.getKey());if(!n)throw new w(y.ErrNotAttached,`${e.getKey()} is not attached`);e.update((i,o)=>o.clear());const s=async()=>{try{const i=await this.rpcClient.detachDocument({clientId:this.id,documentId:n.resourceID,changePack:pe.toChangePack(e.createChangePack()),removeIfNotAttached:t.removeIfNotAttached??!1},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),o=pe.fromChangePack(i.changePack);return e.applyChangePack(o),e.getStatus()!==_n.Removed&&e.applyStatus(_n.Detached),this.detachInternal(e.getKey()),B.info(`[DD] c:"${this.getKey()}" detaches d:"${e.getKey()}"`),e}catch(i){throw B.error(`[DD] c:"${this.getKey()}" err :`,i),await this.handleConnectError(i),i}};if(t.keepalive){this.keepalive=!0;const i=s();return this.keepalive=!1,i}return this.enqueueTask(s)}async attachChannel(e,t={}){if(!this.isActive())throw new w(y.ErrClientNotActivated,`${this.key} is not active`);if(e.getStatus()!==pi.Detached)throw new w(y.ErrNotDetached,`${e.getKey()} is not detached`);e.setActor(this.id);const n=async()=>{try{const s=await this.rpcClient.attachChannel({clientId:this.id,channelKey:e.getKey()},{headers:{"x-shard-key":`${this.apiKey}/${e.getFirstKeyPath()}`}});e.setSessionID(s.sessionId),e.updateCount(Number(s.count),0),e.applyStatus(pi.Attached);const i=t.isRealtime!==!1?"realtime":"manual",o=new ff(this.reconnectStreamDelay,e,s.sessionId,i);return e.subscribe("local-broadcast",c=>{const{topic:u,payload:f,options:h}=c;this.broadcast(e.getKey(),u,f,h).catch(d=>{h!=null&&h.error&&h.error(d),B.error(`[BC] c:"${this.getKey()}" failed: ${d}`)})}),this.attachmentMap.set(e.getKey(),o),i==="realtime"&&await this.runWatchLoop(e.getKey()),B.info(`[AP] c:"${this.getKey()}" attaches p:"${e.getKey()}" mode:${i} count:${e.getPresenceCount()}`),e}catch(s){throw B.error(`[AP] c:"${this.getKey()}" err :`,s),await this.handleConnectError(s),s}};return this.enqueueTask(n)}async detachChannel(e){if(!this.isActive())throw new w(y.ErrClientNotActivated,`${this.key} is not active`);if(!this.attachmentMap.has(e.getKey()))throw new w(y.ErrNotAttached,`${e.getKey()} is not attached`);const t=async()=>{try{const n=await this.rpcClient.detachChannel({clientId:this.id,channelKey:e.getKey(),sessionId:e.getSessionID()},{headers:{"x-shard-key":`${this.apiKey}/${e.getFirstKeyPath()}`}});return e.updateCount(Number(n.count),0),e.applyStatus(pi.Detached),this.detachInternal(e.getKey()),B.info(`[DP] c:"${this.getKey()}" detaches p:"${e.getKey()}" count:${e.getPresenceCount()}`),e}catch(n){throw B.error(`[DP] c:"${this.getKey()}" err :`,n),await this.handleConnectError(n),n}};return this.enqueueTask(t)}async changeSyncMode(e,t){if(!this.isActive())throw new w(y.ErrClientNotActivated,`${this.key} is not active`);const n=this.attachmentMap.get(e.getKey());if(!n)throw new w(y.ErrNotAttached,`${e.getKey()} is not attached`);const s=n.syncMode;return s===t?e:(n.changeSyncMode(t),t==="manual"?(n.cancelWatchStream(),e):(t==="realtime"&&(n.changeEventReceived=!0),s==="manual"&&await this.runWatchLoop(e.getKey()),e))}sync(e){if(!this.isActive())throw new w(y.ErrClientNotActivated,`${this.key} is not active`);if(e instanceof Yn){const t=this.attachmentMap.get(e.getKey());if(!t)throw new w(y.ErrNotAttached,`${e.getKey()} is not attached`);return this.enqueueTask(async()=>this.syncInternal(t).catch(async n=>{throw B.error(`[SY] c:"${this.getKey()}" err :`,n),await this.handleConnectError(n),n}))}if(e instanceof Qn){const t=this.attachmentMap.get(e.getKey());if(!t)throw new w(y.ErrNotAttached,`${e.getKey()} is not attached`);return this.enqueueTask(async()=>this.syncInternal(t,"realtime").catch(async n=>{throw B.error(`[SY] c:"${this.getKey()}" err :`,n),await this.handleConnectError(n),n}))}return this.enqueueTask(async()=>{const t=[];for(const[,n]of this.attachmentMap)n.syncMode!==void 0&&n.resource instanceof Qn&&t.push(this.syncInternal(n,n.syncMode));return Promise.all(t).catch(async n=>{throw B.error(`[SY] c:"${this.getKey()}" err :`,n),await this.handleConnectError(n),n})})}remove(e){if(!this.isActive())throw new w(y.ErrClientNotActivated,`${this.key} is not active`);const t=this.attachmentMap.get(e.getKey());if(!t)throw new w(y.ErrNotAttached,`${e.getKey()} is not attached`);e.setActor(this.id);const n=pe.toChangePack(e.createChangePack());return n.isRemoved=!0,this.enqueueTask(async()=>{try{const s=await this.rpcClient.removeDocument({clientId:this.id,documentId:t.resourceID,changePack:n},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),i=pe.fromChangePack(s.changePack);e.applyChangePack(i),this.detachInternal(e.getKey()),B.info(`[RD] c:"${this.getKey()}" removes d:"${e.getKey()}"`)}catch(s){throw B.error(`[RD] c:"${this.getKey()}" err :`,s),await this.handleConnectError(s),s}})}getID(){return this.id}getKey(){return this.key}isActive(){return this.status==="activated"}getStatus(){return this.status}getCondition(e){return this.conditions[e]}async createRevision(e,t,n){if(!this.isActive())throw new w(y.ErrClientNotActivated,`${this.key} is not active`);const s=this.attachmentMap.get(e.getKey());if(!s)throw new w(y.ErrNotAttached,`${e.getKey()} is not attached`);const i=async()=>{try{const o=await this.rpcClient.createRevision({clientId:this.id,documentId:s.resourceID,label:t,description:n||""},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}});if(!o.revision)throw new w(y.ErrInvalidArgument,"revision is not returned");return B.info(`[CR] c:"${this.getKey()}" creates revision d:"${e.getKey()}" l:"${t}"`),pe.toRevisionSummary(o.revision)}catch(o){throw B.error(`[CR] c:"${this.getKey()}" err :`,o),await this.handleConnectError(o),o}};return this.enqueueTask(i)}async listRevisions(e,t){if(!this.isActive())throw new w(y.ErrClientNotActivated,`${this.key} is not active`);const n=this.attachmentMap.get(e.getKey());if(!n)throw new w(y.ErrNotAttached,`${e.getKey()} is not attached`);const s=async()=>{try{const i=await this.rpcClient.listRevisions({projectId:"",documentId:n.resourceID,pageSize:(t==null?void 0:t.pageSize)||10,offset:(t==null?void 0:t.offset)||0,isForward:(t==null?void 0:t.isForward)??!1},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}});return B.info(`[LR] c:"${this.getKey()}" lists revisions d:"${e.getKey()}" count:${i.revisions.length}`),i.revisions.map(pe.toRevisionSummary)}catch(i){throw B.error(`[LR] c:"${this.getKey()}" err :`,i),await this.handleConnectError(i),i}};return this.enqueueTask(s)}async restoreRevision(e,t){if(!this.isActive())throw new w(y.ErrClientNotActivated,`${this.key} is not active`);if(!this.attachmentMap.get(e.getKey()))throw new w(y.ErrNotAttached,`${e.getKey()} is not attached`);const s=async()=>{try{await this.rpcClient.restoreRevision({clientId:this.id,revisionId:t},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),B.info(`[RR] c:"${this.getKey()}" restores revision d:"${e.getKey()}" r:"${t}"`)}catch(i){throw B.error(`[RR] c:"${this.getKey()}" err :`,i),await this.handleConnectError(i),i}};return this.enqueueTask(s)}async broadcast(e,t,n,s){if(!this.isActive())throw new w(y.ErrClientNotActivated,`${this.key} is not active`);const i=this.attachmentMap.get(e);if(!i)throw new w(y.ErrNotAttached,`${e} is not attached`);if(!Yv(n))throw new w(y.ErrInvalidArgument,"payload is not serializable");const o=i.resource,c=(s==null?void 0:s.maxRetries)??Ua.maxRetries,u=Ua.maxBackoff;let f=0;const h=p=>Math.min(Ua.initialRetryInterval*2**p,u),d=async()=>this.enqueueTask(async()=>{try{await this.rpcClient.broadcast({clientId:this.id,channelKey:e,topic:t,payload:new TextEncoder().encode(JSON.stringify(n))},{headers:{"x-shard-key":`${this.apiKey}/${o.getFirstKeyPath()}`}}),B.info(`[BC] c:"${this.getKey()}" broadcasts p:"${e}" t:"${t}"`)}catch(p){if(B.error(`[BC] c:"${this.getKey()}" err:`,p),await this.handleConnectError(p))if(Fa(p,y.ErrUnauthenticated)&&i.resource instanceof Yn&&i.resource.publish({type:$s.AuthError,reason:mi(p).reason||"unauthenticated",method:"Broadcast"}),f<c)f++,setTimeout(()=>d(),h(f-1)),B.info(`[BC] c:"${this.getKey()}" retry attempt ${f}/${c}`);else throw B.error(`[BC] c:"${this.getKey()}" exceeded maximum retry attempts`),p}});return d()}runSyncLoop(){const e=async()=>{if(!this.isActive()){B.debug(`[SL] c:"${this.getKey()}" exit sync loop`),this.conditions.SyncLoop=!1;return}try{await this.enqueueTask(async()=>{const t=[];for(const[,n]of this.attachmentMap)n.needSync(this.channelHeartbeatInterval)&&(n.changeEventReceived!==void 0&&(n.changeEventReceived=!1),t.push(this.syncInternal(n,n.syncMode).catch(s=>{throw Fa(s,y.ErrUnauthenticated)&&n.resource.publish([{type:Ee.AuthError,value:{reason:mi(s).reason,method:"PushPull"}}]),s})));await Promise.all(t),setTimeout(e,this.syncLoopDuration)})}catch(t){B.error(`[SL] c:"${this.getKey()}" sync failed:`,t),await this.handleConnectError(t)?setTimeout(e,this.retrySyncLoopDelay):this.conditions.SyncLoop=!1}};B.debug(`[SL] c:"${this.getKey()}" run sync loop`),this.conditions.SyncLoop=!0,e()}async runWatchLoop(e){const t=this.attachmentMap.get(e);if(!t)throw new w(y.ErrNotAttached,`${e} is not attached`);return this.conditions.WatchLoop=!0,t.runWatchLoop(n=>{if(!this.isActive())return this.conditions.WatchLoop=!1,Promise.reject(new w(y.ErrClientNotActivated,`${this.key} is not active`));if(!this.attachmentMap.has(e))return this.conditions.WatchLoop=!1,Promise.reject(new w(y.ErrNotAttached,`${e} is not attached`));const s=new AbortController;return t.resource instanceof Qn?this.createDocumentWatchStream(t,e,s,n):t.resource instanceof Yn?this.createChannelWatchStream(t,e,s,n):Promise.reject(new w(y.ErrClientNotActivated,`Unknown resource type for ${e}`))})}createDocumentWatchStream(e,t,n,s){const i=this.rpcClient.watchDocument({clientId:this.id,documentId:e.resourceID},{headers:{"x-shard-key":`${this.apiKey}/${t}`},signal:n.signal});return e.resource.publish([{type:Ee.ConnectionChanged,value:So.Connected}]),B.info(`[WD] c:"${this.getKey()}" watches d:"${t}"`),e.changeEventReceived!==void 0&&(e.changeEventReceived=!0),new Promise((o,c)=>{(async()=>{try{for await(const f of i)this.handleWatchDocumentResponse(e,f),f.body.case==="initialization"&&o([i,n]);e.resource.resetOnlineClients(),e.resource.publish([{type:Ee.Initialized,source:me.Local,value:e.resource.getPresences()}]),e.resource.publish([{type:Ee.ConnectionChanged,value:So.Disconnected}]),B.debug(`[WD] c:"${this.getKey()}" unwatches (stream ended)`),s()}catch(f){e.resource.resetOnlineClients(),e.resource.publish([{type:Ee.Initialized,source:me.Local,value:e.resource.getPresences()}]),e.resource.publish([{type:Ee.ConnectionChanged,value:So.Disconnected}]),B.debug(`[WD] c:"${this.getKey()}" unwatches`),await this.handleConnectError(f)?(Fa(f,y.ErrUnauthenticated)&&e.resource.publish([{type:Ee.AuthError,value:{reason:mi(f).reason,method:"WatchDocument"}}]),s()):this.conditions.WatchLoop=!1,c(f)}})()})}createChannelWatchStream(e,t,n,s){const i=this.rpcClient.watchChannel({clientId:this.id,channelKey:t},{headers:{"x-shard-key":`${this.apiKey}/${e.resource.getFirstKeyPath()}`},signal:n.signal});return B.info(`[WP] c:"${this.getKey()}" watches p:"${t}"`),new Promise((o,c)=>{(async()=>{try{let f=!0;for await(const h of i)this.handleWatchChannelResponse(e,h),f&&(f=!1,o([i,n]));B.debug(`[WP] c:"${this.getKey()}" p:"${t}" stream ended`),s()}catch(f){if(f instanceof Error&&f.name==="AbortError"){B.debug(`[WP] c:"${this.getKey()}" p:"${t}" stream aborted`);return}B.debug(`[WP] c:"${this.getKey()}" p:"${t}" err:`,f),await this.handleConnectError(f)?s():this.conditions.WatchLoop=!1,c(f)}})()})}handleWatchChannelResponse(e,t){const n=e.resource;if(t.body.case==="initialized"){const{count:s,seq:i}=t.body.value;n.updateCount(Number(s),Number(i))&&n.publish({type:$s.Initialized,count:Number(s)})}else if(t.body.case==="event"){const s=t.body.value;if(s.type===ma.BROADCAST){const i=new TextDecoder;try{const o=JSON.parse(i.decode(s.payload));n.publish({type:$s.Broadcast,clientID:s.publisher,topic:s.topic,payload:o})}catch(o){B.error(`[WP] c:"${this.getKey()}" failed to parse broadcast payload:`,o)}return}n.updateCount(Number(s.count),Number(s.seq))&&n.publish({type:$s.PresenceChanged,count:Number(s.count)})}}handleWatchDocumentResponse(e,t){if(t.body.case==="event"&&t.body.value.type===Ys.DOCUMENT_CHANGED){e.changeEventReceived!==void 0&&(e.changeEventReceived=!0);return}e.resource.applyWatchStream(t)}deactivateInternal(){this.status="deactivated";for(const[e,t]of this.attachmentMap)this.detachInternal(e),t.resource instanceof Qn?t.resource.applyStatus(_n.Detached):t.resource instanceof Yn&&t.resource.applyStatus(pi.Detached)}detachInternal(e){const t=this.attachmentMap.get(e);t&&(t.cancelWatchStream(),t.resource instanceof Qn&&t.resource.resetOnlineClients(),this.attachmentMap.delete(e))}async syncInternal(e,t){const{resource:n}=e;if(n instanceof Yn){try{const c=await this.rpcClient.refreshChannel({clientId:this.id,channelKey:n.getKey(),sessionId:n.getSessionID()},{headers:{"x-shard-key":`${this.apiKey}/${n.getFirstKeyPath()}`}});n.updateCount(Number(c.count),0),e.updateHeartbeatTime(),B.debug(`[RP] c:"${this.getKey()}" refreshes p:"${n.getKey()}" mode:${e.syncMode}`)}catch(c){throw B.error(`[RP] c:"${this.getKey()}" err :`,c),c}return n}const s=n,{resourceID:i}=e,o=s.createChangePack();try{const c=await this.rpcClient.pushPullChanges({clientId:this.id,documentId:i,changePack:pe.toChangePack(o),pushOnly:t==="realtime-pushonly"},{headers:{"x-shard-key":`${this.apiKey}/${s.getKey()}`}}),u=pe.fromChangePack(c.changePack);if(u.hasChanges()&&(e.syncMode==="realtime-pushonly"||e.syncMode==="realtime-syncoff"))return s;s.applyChangePack(u),e.resource.publish([{type:Ee.SyncStatusChanged,value:Wc.Synced}]),s.getStatus()===_n.Removed&&this.detachInternal(s.getKey());const f=s.getKey(),h=u.getChangeSize();return B.info(`[PP] c:"${this.getKey()}" sync d:"${f}", push:${o.getChangeSize()} pull:${h} cp:${u.getCheckpoint().toTestString()}`),s}catch(c){throw s.publish([{type:Ee.SyncStatusChanged,value:Wc.SyncFailed}]),B.error(`[PP] c:"${this.getKey()}" err :`,c),c}}async handleConnectError(e){if(!(e instanceof ce))return!1;if(e.code===X.Canceled||e.code===X.Unknown||e.code===X.ResourceExhausted||e.code===X.Unavailable)return!0;if(Rs(e)===y.ErrUnauthenticated){if(this.authTokenInjector){const t=await this.authTokenInjector(mi(e).reason);this.setAuthToken(t)}return!0}return Rs(e)===y.ErrTooManySubscribers?(B.error(`[WD] c:"${this.getKey()}" err :`,e.rawMessage),!0):(Rs(e)===y.ErrTooManyAttachments||(Rs(e)===y.ErrClientNotActivated||Rs(e)===y.ErrClientNotFound)&&this.deactivateInternal(),!1)}enqueueTask(e){return new Promise((t,n)=>{this.taskQueue.push(()=>e().then(t).catch(n)),this.processing||this.processNext()})}async processNext(){if(this.taskQueue.length===0){this.processing=!1;return}try{this.processing=!0,await this.taskQueue.shift()()}catch{B.error(`[TQ] c:"${this.getKey()}" process failed, id:"${this.id}"`)}this.processNext()}}const Id={Client:Ad,Document:Qn,IntType:er.Int,LongType:er.Long};typeof globalThis<"u"&&(globalThis.yorkie={Client:Ad,Document:Qn,Primitive:ve,Text:xu,Counter:Eu,Tree:Nu,Channel:Yn,ChannelEventType:$s,LogLevel:We,setLogLevel:Ev,IntType:er.Int,LongType:er.Long});const Xv=(r,e)=>{const t=r.__vccOpts||r;for(const[n,s]of e)t[n]=s;return t},Zv={lists:[{title:"Todo",cards:[{title:"Pruning document"},{title:"Clean up codes"}]},{title:"Doing",cards:[{title:"Array operations"}]},{title:"Done",cards:[{title:"Create a sample page"},{title:"Launch demo site"}]}]},ds=new Id.Client({rpcAddr:"https://api.yorkie.dev",apiKey:"D6sd9E5ehtXBssmeRZ4QQP"}),Gn=new Id.Document(`vuejs-kanban-${new Date().toISOString().substring(0,10).replace(/-/g,"")}`,{enableDevtools:!0}),Qv={data(){return{lists:[],title:"",opened:null}},created(){this.fetchDoc()},watch:{opened(r){this.$nextTick(function(){r===0?this.$refs.addListForm.querySelector("input").focus():r&&this.$refs.addCardForm[r-1].querySelector("input").focus(),this.title=""})}},methods:{async fetchDoc(){await ds.activate(),await ds.attach(Gn,{initialRoot:Zv}),Gn.subscribe(r=>{this.lists=Gn.getRoot().lists}),await ds.sync(),this.lists=Gn.getRoot().lists},isOpened(r){return this.opened===r},openForm(r){this.opened=r},closeForm(){this.opened=null},addCard(r){this.title!==""&&Gn.update(e=>{e.lists.getElementByID(r.getID()).cards.push({title:this.title}),this.title=""},`add new card by ${ds.getID()}`)},deleteCard(r,e){Gn.update(t=>{t.lists.getElementByID(r.getID()).cards.deleteByID(e.getID())},`delete a card by ${ds.getID()}`)},addList(){this.title!==""&&Gn.update(r=>{r.lists.push({title:this.title,cards:[]}),this.title=""},`add new list by ${ds.getID()}`)},deleteList(r){Gn.update(e=>{e.lists.deleteByID(r.getID())},`delete a list by ${ds.getID()}`)}}},ew={class:"list"},tw=["onClick"],rw={class:"title"},nw={class:"card"},sw=["onClick"],iw={key:0,class:"add-form"},ow=["onKeyup"],aw={class:"buttons"},cw=["onClick"],uw=["onClick"],lw={class:"add-list",ref:"addListForm"},fw={key:0,class:"add-form"},hw={class:"buttons"};function dw(r,e,t,n,s,i){return sr(),ir(nt,null,[(sr(!0),ir(nt,null,qu(s.lists,(o,c)=>(sr(),ir("div",ew,[$e("span",{class:"delete",onClick:u=>i.deleteList(o)},"",8,tw),$e("div",rw,Ka(o.title),1),(sr(!0),ir(nt,null,qu(o.cards,u=>(sr(),ir("div",nw,[$e("span",{class:"delete",onClick:f=>i.deleteCard(o,u)},"",8,sw),hh(" "+Ka(u.title),1)]))),256)),$e("div",{class:"add-card",ref_for:!0,ref:"addCardForm"},[i.isOpened(c+1)?(sr(),ir("div",iw,[zu($e("input",{type:"text",placeholder:"Enter card title","onUpdate:modelValue":e[0]||(e[0]=u=>s.title=u),onKeyup:[ro(u=>i.addCard(o),["enter"]),e[1]||(e[1]=ro(u=>i.closeForm(),["esc"]))]},null,40,ow),[[dl,s.title]]),$e("div",aw,[$e("input",{type:"button",value:"Add",onClick:u=>i.addCard(o)},null,8,cw),$e("input",{type:"button",value:"Close",class:"pull-right",onClick:e[2]||(e[2]=u=>i.closeForm())})])])):(sr(),ir("div",{key:1,class:"add-card-opener",onClick:u=>i.openForm(c+1)}," Add another card ",8,uw))],512)]))),256)),$e("div",lw,[i.isOpened(0)?(sr(),ir("div",fw,[zu($e("input",{type:"text",placeholder:"Enter list title","onUpdate:modelValue":e[3]||(e[3]=o=>s.title=o),onKeyup:[e[4]||(e[4]=ro(o=>i.addList(),["enter"])),e[5]||(e[5]=ro(o=>i.closeForm(),["esc"]))]},null,544),[[dl,s.title]]),$e("div",hw,[$e("input",{type:"button",value:"Add",onClick:e[6]||(e[6]=o=>i.addList())}),$e("input",{type:"button",value:"Close",class:"pull-right",onClick:e[7]||(e[7]=o=>i.closeForm())})])])):(sr(),ir("div",{key:1,class:"add-list-opener",onClick:e[8]||(e[8]=o=>i.openForm(0))}," Add another list "))],512)],64)}const gw=Xv(Qv,[["render",dw]]);Gm(gw).mount("#app");
