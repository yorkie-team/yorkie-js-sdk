var Lh=Object.defineProperty;var Jh=(n,e,t)=>e in n?Lh(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var c=(n,e,t)=>Jh(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function ic(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const ue={},gs=[],jt=()=>{},Fh=()=>!1,ko=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),oc=n=>n.startsWith("onUpdate:"),Ue=Object.assign,ac=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},$h=Object.prototype.hasOwnProperty,ne=(n,e)=>$h.call(n,e),H=Array.isArray,ms=n=>Eo(n)==="[object Map]",vl=n=>Eo(n)==="[object Set]",_=n=>typeof n=="function",Ae=n=>typeof n=="string",$r=n=>typeof n=="symbol",ye=n=>n!==null&&typeof n=="object",wl=n=>(ye(n)||_(n))&&_(n.then)&&_(n.catch),bl=Object.prototype.toString,Eo=n=>bl.call(n),Mh=n=>Eo(n).slice(8,-1),Tl=n=>Eo(n)==="[object Object]",cc=n=>Ae(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,js=ic(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),No=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},Uh=/-(\w)/g,Jr=No(n=>n.replace(Uh,(e,t)=>t?t.toUpperCase():"")),qh=/\B([A-Z])/g,Mr=No(n=>n.replace(qh,"-$1").toLowerCase()),Sl=No(n=>n.charAt(0).toUpperCase()+n.slice(1)),Ho=No(n=>n?`on${Sl(n)}`:""),Yr=(n,e)=>!Object.is(n,e),Ji=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},Il=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},da=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let Gc;const Po=()=>Gc||(Gc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function uc(n){if(H(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],s=Ae(r)?jh(r):uc(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(Ae(n)||ye(n))return n}const zh=/;(?![^(]*\))/g,Vh=/:([^]+)/,Kh=/\/\*[^]*?\*\//g;function jh(n){const e={};return n.replace(Kh,"").split(zh).forEach(t=>{if(t){const r=t.split(Vh);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function lc(n){let e="";if(Ae(n))e=n;else if(H(n))for(let t=0;t<n.length;t++){const r=lc(n[t]);r&&(e+=r+" ")}else if(ye(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const Hh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Wh=ic(Hh);function Al(n){return!!n||n===""}const xl=n=>!!(n&&n.__v_isRef===!0),ga=n=>Ae(n)?n:n==null?"":H(n)||ye(n)&&(n.toString===bl||!_(n.toString))?xl(n)?ga(n.value):JSON.stringify(n,kl,2):String(n),kl=(n,e)=>xl(e)?kl(n,e.value):ms(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,s],i)=>(t[Wo(r,i)+" =>"]=s,t),{})}:vl(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Wo(t))}:$r(e)?Wo(e):ye(e)&&!H(e)&&!Tl(e)?String(e):e,Wo=(n,e="")=>{var t;return $r(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Xe;class Gh{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Xe,!e&&Xe&&(this.index=(Xe.scopes||(Xe.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Xe;try{return Xe=this,e()}finally{Xe=t}}}on(){Xe=this}off(){Xe=this.parent}stop(e){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function _h(){return Xe}let de;const Go=new WeakSet;class El{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Xe&&Xe.active&&Xe.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Go.has(this)&&(Go.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Pl(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,_c(this),Cl(this);const e=de,t=It;de=this,It=!0;try{return this.fn()}finally{Dl(this),de=e,It=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)dc(e);this.deps=this.depsTail=void 0,_c(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Go.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ma(this)&&this.run()}get dirty(){return ma(this)}}let Nl=0,Hs,Ws;function Pl(n,e=!1){if(n.flags|=8,e){n.next=Ws,Ws=n;return}n.next=Hs,Hs=n}function fc(){Nl++}function hc(){if(--Nl>0)return;if(Ws){let e=Ws;for(Ws=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;Hs;){let e=Hs;for(Hs=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function Cl(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Dl(n){let e,t=n.depsTail,r=t;for(;r;){const s=r.prevDep;r.version===-1?(r===t&&(t=s),dc(r),Yh(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}n.deps=e,n.depsTail=t}function ma(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Ol(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function Ol(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===ni))return;n.globalVersion=ni;const e=n.dep;if(n.flags|=2,e.version>0&&!n.isSSR&&n.deps&&!ma(n)){n.flags&=-3;return}const t=de,r=It;de=n,It=!0;try{Cl(n);const s=n.fn(n._value);(e.version===0||Yr(s,n._value))&&(n._value=s,e.version++)}catch(s){throw e.version++,s}finally{de=t,It=r,Dl(n),n.flags&=-3}}function dc(n,e=!1){const{dep:t,prevSub:r,nextSub:s}=n;if(r&&(r.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)dc(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function Yh(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let It=!0;const Rl=[];function Ur(){Rl.push(It),It=!1}function qr(){const n=Rl.pop();It=n===void 0?!0:n}function _c(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=de;de=void 0;try{e()}finally{de=t}}}let ni=0;class Xh{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Bl{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!de||!It||de===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==de)t=this.activeLink=new Xh(de,this),de.deps?(t.prevDep=de.depsTail,de.depsTail.nextDep=t,de.depsTail=t):de.deps=de.depsTail=t,Ll(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=de.depsTail,t.nextDep=void 0,de.depsTail.nextDep=t,de.depsTail=t,de.deps===t&&(de.deps=r)}return t}trigger(e){this.version++,ni++,this.notify(e)}notify(e){fc();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{hc()}}}function Ll(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)Ll(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const pa=new WeakMap,Xr=Symbol(""),ya=Symbol(""),ri=Symbol("");function Pe(n,e,t){if(It&&de){let r=pa.get(n);r||pa.set(n,r=new Map);let s=r.get(t);s||(r.set(t,s=new Bl),s.map=r,s.key=t),s.track()}}function fr(n,e,t,r,s,i){const o=pa.get(n);if(!o){ni++;return}const a=u=>{u&&u.trigger()};if(fc(),e==="clear")o.forEach(a);else{const u=H(n),l=u&&cc(t);if(u&&t==="length"){const f=Number(r);o.forEach((d,y)=>{(y==="length"||y===ri||!$r(y)&&y>=f)&&a(d)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),l&&a(o.get(ri)),e){case"add":u?l&&a(o.get("length")):(a(o.get(Xr)),ms(n)&&a(o.get(ya)));break;case"delete":u||(a(o.get(Xr)),ms(n)&&a(o.get(ya)));break;case"set":ms(n)&&a(o.get(Xr));break}}hc()}function os(n){const e=oe(n);return e===n?e:(Pe(e,"iterate",ri),At(n)?e:e.map(ze))}function Co(n){return Pe(n=oe(n),"iterate",ri),n}const Zh={__proto__:null,[Symbol.iterator](){return _o(this,Symbol.iterator,ze)},concat(...n){return os(this).concat(...n.map(e=>H(e)?os(e):e))},entries(){return _o(this,"entries",n=>(n[1]=ze(n[1]),n))},every(n,e){return Qt(this,"every",n,e,void 0,arguments)},filter(n,e){return Qt(this,"filter",n,e,t=>t.map(ze),arguments)},find(n,e){return Qt(this,"find",n,e,ze,arguments)},findIndex(n,e){return Qt(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return Qt(this,"findLast",n,e,ze,arguments)},findLastIndex(n,e){return Qt(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return Qt(this,"forEach",n,e,void 0,arguments)},includes(...n){return Yo(this,"includes",n)},indexOf(...n){return Yo(this,"indexOf",n)},join(n){return os(this).join(n)},lastIndexOf(...n){return Yo(this,"lastIndexOf",n)},map(n,e){return Qt(this,"map",n,e,void 0,arguments)},pop(){return $s(this,"pop")},push(...n){return $s(this,"push",n)},reduce(n,...e){return Yc(this,"reduce",n,e)},reduceRight(n,...e){return Yc(this,"reduceRight",n,e)},shift(){return $s(this,"shift")},some(n,e){return Qt(this,"some",n,e,void 0,arguments)},splice(...n){return $s(this,"splice",n)},toReversed(){return os(this).toReversed()},toSorted(n){return os(this).toSorted(n)},toSpliced(...n){return os(this).toSpliced(...n)},unshift(...n){return $s(this,"unshift",n)},values(){return _o(this,"values",ze)}};function _o(n,e,t){const r=Co(n),s=r[e]();return r!==n&&!At(n)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=t(i.value)),i}),s}const Qh=Array.prototype;function Qt(n,e,t,r,s,i){const o=Co(n),a=o!==n&&!At(n),u=o[e];if(u!==Qh[e]){const d=u.apply(n,i);return a?ze(d):d}let l=t;o!==n&&(a?l=function(d,y){return t.call(this,ze(d),y,n)}:t.length>2&&(l=function(d,y){return t.call(this,d,y,n)}));const f=u.call(o,l,r);return a&&s?s(f):f}function Yc(n,e,t,r){const s=Co(n);let i=t;return s!==n&&(At(n)?t.length>3&&(i=function(o,a,u){return t.call(this,o,a,u,n)}):i=function(o,a,u){return t.call(this,o,ze(a),u,n)}),s[e](i,...r)}function Yo(n,e,t){const r=oe(n);Pe(r,"iterate",ri);const s=r[e](...t);return(s===-1||s===!1)&&yc(t[0])?(t[0]=oe(t[0]),r[e](...t)):s}function $s(n,e,t=[]){Ur(),fc();const r=oe(n)[e].apply(n,t);return hc(),qr(),r}const ed=ic("__proto__,__v_isRef,__isVue"),Jl=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter($r));function td(n){$r(n)||(n=String(n));const e=oe(this);return Pe(e,"has",n),e.hasOwnProperty(n)}class Fl{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return r===(s?i?fd:ql:i?Ul:Ml).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=H(e);if(!s){let u;if(o&&(u=Zh[t]))return u;if(t==="hasOwnProperty")return td}const a=Reflect.get(e,t,$e(e)?e:r);return($r(t)?Jl.has(t):ed(t))||(s||Pe(e,"get",t),i)?a:$e(a)?o&&cc(t)?a:a.value:ye(a)?s?zl(a):mc(a):a}}class $l extends Fl{constructor(e=!1){super(!1,e)}set(e,t,r,s){let i=e[t];if(!this._isShallow){const u=Ss(i);if(!At(r)&&!Ss(r)&&(i=oe(i),r=oe(r)),!H(e)&&$e(i)&&!$e(r))return u?!1:(i.value=r,!0)}const o=H(e)&&cc(t)?Number(t)<e.length:ne(e,t),a=Reflect.set(e,t,r,$e(e)?e:s);return e===oe(s)&&(o?Yr(r,i)&&fr(e,"set",t,r):fr(e,"add",t,r)),a}deleteProperty(e,t){const r=ne(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&r&&fr(e,"delete",t,void 0),s}has(e,t){const r=Reflect.has(e,t);return(!$r(t)||!Jl.has(t))&&Pe(e,"has",t),r}ownKeys(e){return Pe(e,"iterate",H(e)?"length":Xr),Reflect.ownKeys(e)}}class nd extends Fl{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const rd=new $l,sd=new nd,id=new $l(!0);const va=n=>n,Ei=n=>Reflect.getPrototypeOf(n);function od(n,e,t){return function(...r){const s=this.__v_raw,i=oe(s),o=ms(i),a=n==="entries"||n===Symbol.iterator&&o,u=n==="keys"&&o,l=s[n](...r),f=t?va:e?wa:ze;return!e&&Pe(i,"iterate",u?ya:Xr),{next(){const{value:d,done:y}=l.next();return y?{value:d,done:y}:{value:a?[f(d[0]),f(d[1])]:f(d),done:y}},[Symbol.iterator](){return this}}}}function Ni(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function ad(n,e){const t={get(s){const i=this.__v_raw,o=oe(i),a=oe(s);n||(Yr(s,a)&&Pe(o,"get",s),Pe(o,"get",a));const{has:u}=Ei(o),l=e?va:n?wa:ze;if(u.call(o,s))return l(i.get(s));if(u.call(o,a))return l(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!n&&Pe(oe(s),"iterate",Xr),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=oe(i),a=oe(s);return n||(Yr(s,a)&&Pe(o,"has",s),Pe(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,u=oe(a),l=e?va:n?wa:ze;return!n&&Pe(u,"iterate",Xr),a.forEach((f,d)=>s.call(i,l(f),l(d),o))}};return Ue(t,n?{add:Ni("add"),set:Ni("set"),delete:Ni("delete"),clear:Ni("clear")}:{add(s){!e&&!At(s)&&!Ss(s)&&(s=oe(s));const i=oe(this);return Ei(i).has.call(i,s)||(i.add(s),fr(i,"add",s,s)),this},set(s,i){!e&&!At(i)&&!Ss(i)&&(i=oe(i));const o=oe(this),{has:a,get:u}=Ei(o);let l=a.call(o,s);l||(s=oe(s),l=a.call(o,s));const f=u.call(o,s);return o.set(s,i),l?Yr(i,f)&&fr(o,"set",s,i):fr(o,"add",s,i),this},delete(s){const i=oe(this),{has:o,get:a}=Ei(i);let u=o.call(i,s);u||(s=oe(s),u=o.call(i,s)),a&&a.call(i,s);const l=i.delete(s);return u&&fr(i,"delete",s,void 0),l},clear(){const s=oe(this),i=s.size!==0,o=s.clear();return i&&fr(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=od(s,n,e)}),t}function gc(n,e){const t=ad(n,e);return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(ne(t,s)&&s in r?t:r,s,i)}const cd={get:gc(!1,!1)},ud={get:gc(!1,!0)},ld={get:gc(!0,!1)};const Ml=new WeakMap,Ul=new WeakMap,ql=new WeakMap,fd=new WeakMap;function hd(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function dd(n){return n.__v_skip||!Object.isExtensible(n)?0:hd(Mh(n))}function mc(n){return Ss(n)?n:pc(n,!1,rd,cd,Ml)}function gd(n){return pc(n,!1,id,ud,Ul)}function zl(n){return pc(n,!0,sd,ld,ql)}function pc(n,e,t,r,s){if(!ye(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=s.get(n);if(i)return i;const o=dd(n);if(o===0)return n;const a=new Proxy(n,o===2?r:t);return s.set(n,a),a}function ps(n){return Ss(n)?ps(n.__v_raw):!!(n&&n.__v_isReactive)}function Ss(n){return!!(n&&n.__v_isReadonly)}function At(n){return!!(n&&n.__v_isShallow)}function yc(n){return n?!!n.__v_raw:!1}function oe(n){const e=n&&n.__v_raw;return e?oe(e):n}function md(n){return!ne(n,"__v_skip")&&Object.isExtensible(n)&&Il(n,"__v_skip",!0),n}const ze=n=>ye(n)?mc(n):n,wa=n=>ye(n)?zl(n):n;function $e(n){return n?n.__v_isRef===!0:!1}function pd(n){return $e(n)?n.value:n}const yd={get:(n,e,t)=>e==="__v_raw"?n:pd(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const s=n[e];return $e(s)&&!$e(t)?(s.value=t,!0):Reflect.set(n,e,t,r)}};function Vl(n){return ps(n)?n:new Proxy(n,yd)}class vd{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Bl(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ni-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&de!==this)return Pl(this,!0),!0}get value(){const e=this.dep.track();return Ol(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function wd(n,e,t=!1){let r,s;return _(n)?r=n:(r=n.get,s=n.set),new vd(r,s,t)}const Pi={},Wi=new WeakMap;let Hr;function bd(n,e=!1,t=Hr){if(t){let r=Wi.get(t);r||Wi.set(t,r=[]),r.push(n)}}function Td(n,e,t=ue){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:u}=t,l=L=>s?L:At(L)||s===!1||s===0?hr(L,1):hr(L);let f,d,y,m,S=!1,I=!1;if($e(n)?(d=()=>n.value,S=At(n)):ps(n)?(d=()=>l(n),S=!0):H(n)?(I=!0,S=n.some(L=>ps(L)||At(L)),d=()=>n.map(L=>{if($e(L))return L.value;if(ps(L))return l(L);if(_(L))return u?u(L,2):L()})):_(n)?e?d=u?()=>u(n,2):n:d=()=>{if(y){Ur();try{y()}finally{qr()}}const L=Hr;Hr=f;try{return u?u(n,3,[m]):n(m)}finally{Hr=L}}:d=jt,e&&s){const L=d,Y=s===!0?1/0:s;d=()=>hr(L(),Y)}const C=_h(),R=()=>{f.stop(),C&&C.active&&ac(C.effects,f)};if(i&&e){const L=e;e=(...Y)=>{L(...Y),R()}}let $=I?new Array(n.length).fill(Pi):Pi;const V=L=>{if(!(!(f.flags&1)||!f.dirty&&!L))if(e){const Y=f.run();if(s||S||(I?Y.some((W,Q)=>Yr(W,$[Q])):Yr(Y,$))){y&&y();const W=Hr;Hr=f;try{const Q=[Y,$===Pi?void 0:I&&$[0]===Pi?[]:$,m];u?u(e,3,Q):e(...Q),$=Y}finally{Hr=W}}}else f.run()};return a&&a(V),f=new El(d),f.scheduler=o?()=>o(V,!1):V,m=L=>bd(L,!1,f),y=f.onStop=()=>{const L=Wi.get(f);if(L){if(u)u(L,4);else for(const Y of L)Y();Wi.delete(f)}},e?r?V(!0):$=f.run():o?o(V.bind(null,!0),!0):f.run(),R.pause=f.pause.bind(f),R.resume=f.resume.bind(f),R.stop=R,R}function hr(n,e=1/0,t){if(e<=0||!ye(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,$e(n))hr(n.value,e,t);else if(H(n))for(let r=0;r<n.length;r++)hr(n[r],e,t);else if(vl(n)||ms(n))n.forEach(r=>{hr(r,e,t)});else if(Tl(n)){for(const r in n)hr(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&hr(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function vi(n,e,t,r){try{return r?n(...r):n()}catch(s){Do(s,e,t)}}function _t(n,e,t,r){if(_(n)){const s=vi(n,e,t,r);return s&&wl(s)&&s.catch(i=>{Do(i,e,t)}),s}if(H(n)){const s=[];for(let i=0;i<n.length;i++)s.push(_t(n[i],e,t,r));return s}}function Do(n,e,t,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||ue;if(e){let a=e.parent;const u=e.proxy,l=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const f=a.ec;if(f){for(let d=0;d<f.length;d++)if(f[d](n,u,l)===!1)return}a=a.parent}if(i){Ur(),vi(i,null,10,[n,u,l]),qr();return}}Sd(n,t,s,r,o)}function Sd(n,e,t,r=!0,s=!1){if(s)throw n;console.error(n)}const Je=[];let Ot=-1;const ys=[];let Cr=null,us=0;const Kl=Promise.resolve();let Gi=null;function Id(n){const e=Gi||Kl;return n?e.then(this?n.bind(this):n):e}function Ad(n){let e=Ot+1,t=Je.length;for(;e<t;){const r=e+t>>>1,s=Je[r],i=si(s);i<n||i===n&&s.flags&2?e=r+1:t=r}return e}function vc(n){if(!(n.flags&1)){const e=si(n),t=Je[Je.length-1];!t||!(n.flags&2)&&e>=si(t)?Je.push(n):Je.splice(Ad(e),0,n),n.flags|=1,jl()}}function jl(){Gi||(Gi=Kl.then(Wl))}function xd(n){H(n)?ys.push(...n):Cr&&n.id===-1?Cr.splice(us+1,0,n):n.flags&1||(ys.push(n),n.flags|=1),jl()}function Xc(n,e,t=Ot+1){for(;t<Je.length;t++){const r=Je[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;Je.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function Hl(n){if(ys.length){const e=[...new Set(ys)].sort((t,r)=>si(t)-si(r));if(ys.length=0,Cr){Cr.push(...e);return}for(Cr=e,us=0;us<Cr.length;us++){const t=Cr[us];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}Cr=null,us=0}}const si=n=>n.id==null?n.flags&2?-1:1/0:n.id;function Wl(n){try{for(Ot=0;Ot<Je.length;Ot++){const e=Je[Ot];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),vi(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Ot<Je.length;Ot++){const e=Je[Ot];e&&(e.flags&=-2)}Ot=-1,Je.length=0,Hl(),Gi=null,(Je.length||ys.length)&&Wl()}}let gt=null,Gl=null;function _i(n){const e=gt;return gt=n,Gl=n&&n.type.__scopeId||null,e}function kd(n,e=gt,t){if(!e||n._n)return n;const r=(...s)=>{r._d&&cu(-1);const i=_i(e);let o;try{o=n(...s)}finally{_i(i),r._d&&cu(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function Zc(n,e){if(gt===null)return n;const t=Lo(gt),r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,u=ue]=e[s];i&&(_(i)&&(i={mounted:i,updated:i}),i.deep&&hr(o),r.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:u}))}return n}function Kr(n,e,t,r){const s=n.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let u=a.dir[r];u&&(Ur(),_t(u,t,8,[n.el,a,n,e]),qr())}}const Ed=Symbol("_vte"),Nd=n=>n.__isTeleport;function wc(n,e){n.shapeFlag&6&&n.component?(n.transition=e,wc(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function _l(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function Yi(n,e,t,r,s=!1){if(H(n)){n.forEach((S,I)=>Yi(S,e&&(H(e)?e[I]:e),t,r,s));return}if(Gs(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Yi(n,e,t,r.component.subTree);return}const i=r.shapeFlag&4?Lo(r.component):r.el,o=s?null:i,{i:a,r:u}=n,l=e&&e.r,f=a.refs===ue?a.refs={}:a.refs,d=a.setupState,y=oe(d),m=d===ue?()=>!1:S=>ne(y,S);if(l!=null&&l!==u&&(Ae(l)?(f[l]=null,m(l)&&(d[l]=null)):$e(l)&&(l.value=null)),_(u))vi(u,a,12,[o,f]);else{const S=Ae(u),I=$e(u);if(S||I){const C=()=>{if(n.f){const R=S?m(u)?d[u]:f[u]:u.value;s?H(R)&&ac(R,i):H(R)?R.includes(i)||R.push(i):S?(f[u]=[i],m(u)&&(d[u]=f[u])):(u.value=[i],n.k&&(f[n.k]=u.value))}else S?(f[u]=o,m(u)&&(d[u]=o)):I&&(u.value=o,n.k&&(f[n.k]=o))};o?(C.id=-1,Ye(C,t)):C()}}}Po().requestIdleCallback;Po().cancelIdleCallback;const Gs=n=>!!n.type.__asyncLoader,Yl=n=>n.type.__isKeepAlive;function Pd(n,e){Xl(n,"a",e)}function Cd(n,e){Xl(n,"da",e)}function Xl(n,e,t=Fe){const r=n.__wdc||(n.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(Oo(e,r,t),t){let s=t.parent;for(;s&&s.parent;)Yl(s.parent.vnode)&&Dd(r,e,t,s),s=s.parent}}function Dd(n,e,t,r){const s=Oo(e,n,r,!0);Zl(()=>{ac(r[e],s)},t)}function Oo(n,e,t=Fe,r=!1){if(t){const s=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{Ur();const a=wi(t),u=_t(e,t,n,o);return a(),qr(),u});return r?s.unshift(i):s.push(i),i}}const Ir=n=>(e,t=Fe)=>{(!ai||n==="sp")&&Oo(n,(...r)=>e(...r),t)},Od=Ir("bm"),Rd=Ir("m"),Bd=Ir("bu"),Ld=Ir("u"),Jd=Ir("bum"),Zl=Ir("um"),Fd=Ir("sp"),$d=Ir("rtg"),Md=Ir("rtc");function Ud(n,e=Fe){Oo("ec",n,e)}const qd=Symbol.for("v-ndc");function Qc(n,e,t,r){let s;const i=t,o=H(n);if(o||Ae(n)){const a=o&&ps(n);let u=!1;a&&(u=!At(n),n=Co(n)),s=new Array(n.length);for(let l=0,f=n.length;l<f;l++)s[l]=e(u?ze(n[l]):n[l],l,void 0,i)}else if(typeof n=="number"){s=new Array(n);for(let a=0;a<n;a++)s[a]=e(a+1,a,void 0,i)}else if(ye(n))if(n[Symbol.iterator])s=Array.from(n,(a,u)=>e(a,u,void 0,i));else{const a=Object.keys(n);s=new Array(a.length);for(let u=0,l=a.length;u<l;u++){const f=a[u];s[u]=e(n[f],f,u,i)}}else s=[];return s}const ba=n=>n?Tf(n)?Lo(n):ba(n.parent):null,_s=Ue(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>ba(n.parent),$root:n=>ba(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>ef(n),$forceUpdate:n=>n.f||(n.f=()=>{vc(n.update)}),$nextTick:n=>n.n||(n.n=Id.bind(n.proxy)),$watch:n=>ug.bind(n)}),Xo=(n,e)=>n!==ue&&!n.__isScriptSetup&&ne(n,e),zd={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:u}=n;let l;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return r[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(Xo(r,e))return o[e]=1,r[e];if(s!==ue&&ne(s,e))return o[e]=2,s[e];if((l=n.propsOptions[0])&&ne(l,e))return o[e]=3,i[e];if(t!==ue&&ne(t,e))return o[e]=4,t[e];Ta&&(o[e]=0)}}const f=_s[e];let d,y;if(f)return e==="$attrs"&&Pe(n.attrs,"get",""),f(n);if((d=a.__cssModules)&&(d=d[e]))return d;if(t!==ue&&ne(t,e))return o[e]=4,t[e];if(y=u.config.globalProperties,ne(y,e))return y[e]},set({_:n},e,t){const{data:r,setupState:s,ctx:i}=n;return Xo(s,e)?(s[e]=t,!0):r!==ue&&ne(r,e)?(r[e]=t,!0):ne(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!t[o]||n!==ue&&ne(n,o)||Xo(e,o)||(a=i[0])&&ne(a,o)||ne(r,o)||ne(_s,o)||ne(s.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:ne(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function eu(n){return H(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let Ta=!0;function Vd(n){const e=ef(n),t=n.proxy,r=n.ctx;Ta=!1,e.beforeCreate&&tu(e.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:a,provide:u,inject:l,created:f,beforeMount:d,mounted:y,beforeUpdate:m,updated:S,activated:I,deactivated:C,beforeDestroy:R,beforeUnmount:$,destroyed:V,unmounted:L,render:Y,renderTracked:W,renderTriggered:Q,errorCaptured:ie,serverPrefetch:ae,expose:Ie,inheritAttrs:Zt,components:is,directives:Ai,filters:Ko}=e;if(l&&Kd(l,r,null),o)for(const me in o){const fe=o[me];_(fe)&&(r[me]=fe.bind(t))}if(s){const me=s.call(t,t);ye(me)&&(n.data=mc(me))}if(Ta=!0,i)for(const me in i){const fe=i[me],zr=_(fe)?fe.bind(t,t):_(fe.get)?fe.get.bind(t,t):jt,xi=!_(fe)&&_(fe.set)?fe.set.bind(t):jt,Vr=Cg({get:zr,set:xi});Object.defineProperty(r,me,{enumerable:!0,configurable:!0,get:()=>Vr.value,set:Et=>Vr.value=Et})}if(a)for(const me in a)Ql(a[me],r,t,me);if(u){const me=_(u)?u.call(t):u;Reflect.ownKeys(me).forEach(fe=>{Yd(fe,me[fe])})}f&&tu(f,n,"c");function Oe(me,fe){H(fe)?fe.forEach(zr=>me(zr.bind(t))):fe&&me(fe.bind(t))}if(Oe(Od,d),Oe(Rd,y),Oe(Bd,m),Oe(Ld,S),Oe(Pd,I),Oe(Cd,C),Oe(Ud,ie),Oe(Md,W),Oe($d,Q),Oe(Jd,$),Oe(Zl,L),Oe(Fd,ae),H(Ie))if(Ie.length){const me=n.exposed||(n.exposed={});Ie.forEach(fe=>{Object.defineProperty(me,fe,{get:()=>t[fe],set:zr=>t[fe]=zr})})}else n.exposed||(n.exposed={});Y&&n.render===jt&&(n.render=Y),Zt!=null&&(n.inheritAttrs=Zt),is&&(n.components=is),Ai&&(n.directives=Ai),ae&&_l(n)}function Kd(n,e,t=jt){H(n)&&(n=Sa(n));for(const r in n){const s=n[r];let i;ye(s)?"default"in s?i=Fi(s.from||r,s.default,!0):i=Fi(s.from||r):i=Fi(s),$e(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function tu(n,e,t){_t(H(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function Ql(n,e,t,r){let s=r.includes(".")?mf(t,r):()=>t[r];if(Ae(n)){const i=e[n];_(i)&&Qo(s,i)}else if(_(n))Qo(s,n.bind(t));else if(ye(n))if(H(n))n.forEach(i=>Ql(i,e,t,r));else{const i=_(n.handler)?n.handler.bind(t):e[n.handler];_(i)&&Qo(s,i,n)}}function ef(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(e);let u;return a?u=a:!s.length&&!t&&!r?u=e:(u={},s.length&&s.forEach(l=>Xi(u,l,o,!0)),Xi(u,e,o)),ye(e)&&i.set(e,u),u}function Xi(n,e,t,r=!1){const{mixins:s,extends:i}=e;i&&Xi(n,i,t,!0),s&&s.forEach(o=>Xi(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=jd[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const jd={data:nu,props:ru,emits:ru,methods:Vs,computed:Vs,beforeCreate:Re,created:Re,beforeMount:Re,mounted:Re,beforeUpdate:Re,updated:Re,beforeDestroy:Re,beforeUnmount:Re,destroyed:Re,unmounted:Re,activated:Re,deactivated:Re,errorCaptured:Re,serverPrefetch:Re,components:Vs,directives:Vs,watch:Wd,provide:nu,inject:Hd};function nu(n,e){return e?n?function(){return Ue(_(n)?n.call(this,this):n,_(e)?e.call(this,this):e)}:e:n}function Hd(n,e){return Vs(Sa(n),Sa(e))}function Sa(n){if(H(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Re(n,e){return n?[...new Set([].concat(n,e))]:e}function Vs(n,e){return n?Ue(Object.create(null),n,e):e}function ru(n,e){return n?H(n)&&H(e)?[...new Set([...n,...e])]:Ue(Object.create(null),eu(n),eu(e??{})):e}function Wd(n,e){if(!n)return e;if(!e)return n;const t=Ue(Object.create(null),n);for(const r in e)t[r]=Re(n[r],e[r]);return t}function tf(){return{app:null,config:{isNativeTag:Fh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Gd=0;function _d(n,e){return function(r,s=null){_(r)||(r=Ue({},r)),s!=null&&!ye(s)&&(s=null);const i=tf(),o=new WeakSet,a=[];let u=!1;const l=i.app={_uid:Gd++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:Dg,get config(){return i.config},set config(f){},use(f,...d){return o.has(f)||(f&&_(f.install)?(o.add(f),f.install(l,...d)):_(f)&&(o.add(f),f(l,...d))),l},mixin(f){return i.mixins.includes(f)||i.mixins.push(f),l},component(f,d){return d?(i.components[f]=d,l):i.components[f]},directive(f,d){return d?(i.directives[f]=d,l):i.directives[f]},mount(f,d,y){if(!u){const m=l._ceVNode||Zr(r,s);return m.appContext=i,y===!0?y="svg":y===!1&&(y=void 0),n(m,f,y),u=!0,l._container=f,f.__vue_app__=l,Lo(m.component)}},onUnmount(f){a.push(f)},unmount(){u&&(_t(a,l._instance,16),n(null,l._container),delete l._container.__vue_app__)},provide(f,d){return i.provides[f]=d,l},runWithContext(f){const d=vs;vs=l;try{return f()}finally{vs=d}}};return l}}let vs=null;function Yd(n,e){if(Fe){let t=Fe.provides;const r=Fe.parent&&Fe.parent.provides;r===t&&(t=Fe.provides=Object.create(r)),t[n]=e}}function Fi(n,e,t=!1){const r=Fe||gt;if(r||vs){const s=vs?vs._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return t&&_(e)?e.call(r&&r.proxy):e}}const nf={},rf=()=>Object.create(nf),sf=n=>Object.getPrototypeOf(n)===nf;function Xd(n,e,t,r=!1){const s={},i=rf();n.propsDefaults=Object.create(null),of(n,e,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);t?n.props=r?s:gd(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function Zd(n,e,t,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,a=oe(s),[u]=n.propsOptions;let l=!1;if((r||o>0)&&!(o&16)){if(o&8){const f=n.vnode.dynamicProps;for(let d=0;d<f.length;d++){let y=f[d];if(Ro(n.emitsOptions,y))continue;const m=e[y];if(u)if(ne(i,y))m!==i[y]&&(i[y]=m,l=!0);else{const S=Jr(y);s[S]=Ia(u,a,S,m,n,!1)}else m!==i[y]&&(i[y]=m,l=!0)}}}else{of(n,e,s,i)&&(l=!0);let f;for(const d in a)(!e||!ne(e,d)&&((f=Mr(d))===d||!ne(e,f)))&&(u?t&&(t[d]!==void 0||t[f]!==void 0)&&(s[d]=Ia(u,a,d,void 0,n,!0)):delete s[d]);if(i!==a)for(const d in i)(!e||!ne(e,d))&&(delete i[d],l=!0)}l&&fr(n.attrs,"set","")}function of(n,e,t,r){const[s,i]=n.propsOptions;let o=!1,a;if(e)for(let u in e){if(js(u))continue;const l=e[u];let f;s&&ne(s,f=Jr(u))?!i||!i.includes(f)?t[f]=l:(a||(a={}))[f]=l:Ro(n.emitsOptions,u)||(!(u in r)||l!==r[u])&&(r[u]=l,o=!0)}if(i){const u=oe(t),l=a||ue;for(let f=0;f<i.length;f++){const d=i[f];t[d]=Ia(s,u,d,l[d],n,!ne(l,d))}}return o}function Ia(n,e,t,r,s,i){const o=n[t];if(o!=null){const a=ne(o,"default");if(a&&r===void 0){const u=o.default;if(o.type!==Function&&!o.skipFactory&&_(u)){const{propsDefaults:l}=s;if(t in l)r=l[t];else{const f=wi(s);r=l[t]=u.call(null,e),f()}}else r=u;s.ce&&s.ce._setProp(t,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Mr(t))&&(r=!0))}return r}const Qd=new WeakMap;function af(n,e,t=!1){const r=t?Qd:e.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},a=[];let u=!1;if(!_(n)){const f=d=>{u=!0;const[y,m]=af(d,e,!0);Ue(o,y),m&&a.push(...m)};!t&&e.mixins.length&&e.mixins.forEach(f),n.extends&&f(n.extends),n.mixins&&n.mixins.forEach(f)}if(!i&&!u)return ye(n)&&r.set(n,gs),gs;if(H(i))for(let f=0;f<i.length;f++){const d=Jr(i[f]);su(d)&&(o[d]=ue)}else if(i)for(const f in i){const d=Jr(f);if(su(d)){const y=i[f],m=o[d]=H(y)||_(y)?{type:y}:Ue({},y),S=m.type;let I=!1,C=!0;if(H(S))for(let R=0;R<S.length;++R){const $=S[R],V=_($)&&$.name;if(V==="Boolean"){I=!0;break}else V==="String"&&(C=!1)}else I=_(S)&&S.name==="Boolean";m[0]=I,m[1]=C,(I||ne(m,"default"))&&a.push(d)}}const l=[o,a];return ye(n)&&r.set(n,l),l}function su(n){return n[0]!=="$"&&!js(n)}const cf=n=>n[0]==="_"||n==="$stable",bc=n=>H(n)?n.map(Lt):[Lt(n)],eg=(n,e,t)=>{if(e._n)return e;const r=kd((...s)=>bc(e(...s)),t);return r._c=!1,r},uf=(n,e,t)=>{const r=n._ctx;for(const s in n){if(cf(s))continue;const i=n[s];if(_(i))e[s]=eg(s,i,r);else if(i!=null){const o=bc(i);e[s]=()=>o}}},lf=(n,e)=>{const t=bc(e);n.slots.default=()=>t},ff=(n,e,t)=>{for(const r in e)(t||r!=="_")&&(n[r]=e[r])},tg=(n,e,t)=>{const r=n.slots=rf();if(n.vnode.shapeFlag&32){const s=e._;s?(ff(r,e,t),t&&Il(r,"_",s,!0)):uf(e,r)}else e&&lf(n,e)},ng=(n,e,t)=>{const{vnode:r,slots:s}=n;let i=!0,o=ue;if(r.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:ff(s,e,t):(i=!e.$stable,uf(e,s)),o=e}else e&&(lf(n,e),o={default:1});if(i)for(const a in s)!cf(a)&&o[a]==null&&delete s[a]},Ye=pg;function rg(n){return sg(n)}function sg(n,e){const t=Po();t.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:u,setText:l,setElementText:f,parentNode:d,nextSibling:y,setScopeId:m=jt,insertStaticContent:S}=n,I=(g,p,T,E=null,A=null,x=null,B=void 0,O=null,D=!!p.dynamicChildren)=>{if(g===p)return;g&&!Ms(g,p)&&(E=ki(g),Et(g,A,x,!0),g=null),p.patchFlag===-2&&(D=!1,p.dynamicChildren=null);const{type:N,ref:K,shapeFlag:J}=p;switch(N){case Bo:C(g,p,T,E);break;case ii:R(g,p,T,E);break;case ea:g==null&&$(p,T,E,B);break;case rt:is(g,p,T,E,A,x,B,O,D);break;default:J&1?Y(g,p,T,E,A,x,B,O,D):J&6?Ai(g,p,T,E,A,x,B,O,D):(J&64||J&128)&&N.process(g,p,T,E,A,x,B,O,D,Js)}K!=null&&A&&Yi(K,g&&g.ref,x,p||g,!p)},C=(g,p,T,E)=>{if(g==null)r(p.el=a(p.children),T,E);else{const A=p.el=g.el;p.children!==g.children&&l(A,p.children)}},R=(g,p,T,E)=>{g==null?r(p.el=u(p.children||""),T,E):p.el=g.el},$=(g,p,T,E)=>{[g.el,g.anchor]=S(g.children,p,T,E,g.el,g.anchor)},V=({el:g,anchor:p},T,E)=>{let A;for(;g&&g!==p;)A=y(g),r(g,T,E),g=A;r(p,T,E)},L=({el:g,anchor:p})=>{let T;for(;g&&g!==p;)T=y(g),s(g),g=T;s(p)},Y=(g,p,T,E,A,x,B,O,D)=>{p.type==="svg"?B="svg":p.type==="math"&&(B="mathml"),g==null?W(p,T,E,A,x,B,O,D):ae(g,p,A,x,B,O,D)},W=(g,p,T,E,A,x,B,O)=>{let D,N;const{props:K,shapeFlag:J,transition:q,dirs:j}=g;if(D=g.el=o(g.type,x,K&&K.is,K),J&8?f(D,g.children):J&16&&ie(g.children,D,null,E,A,Zo(g,x),B,O),j&&Kr(g,null,E,"created"),Q(D,g,g.scopeId,B,E),K){for(const he in K)he!=="value"&&!js(he)&&i(D,he,null,K[he],x,E);"value"in K&&i(D,"value",null,K.value,x),(N=K.onVnodeBeforeMount)&&Dt(N,E,g)}j&&Kr(g,null,E,"beforeMount");const ee=ig(A,q);ee&&q.beforeEnter(D),r(D,p,T),((N=K&&K.onVnodeMounted)||ee||j)&&Ye(()=>{N&&Dt(N,E,g),ee&&q.enter(D),j&&Kr(g,null,E,"mounted")},A)},Q=(g,p,T,E,A)=>{if(T&&m(g,T),E)for(let x=0;x<E.length;x++)m(g,E[x]);if(A){let x=A.subTree;if(p===x||yf(x.type)&&(x.ssContent===p||x.ssFallback===p)){const B=A.vnode;Q(g,B,B.scopeId,B.slotScopeIds,A.parent)}}},ie=(g,p,T,E,A,x,B,O,D=0)=>{for(let N=D;N<g.length;N++){const K=g[N]=O?Dr(g[N]):Lt(g[N]);I(null,K,p,T,E,A,x,B,O)}},ae=(g,p,T,E,A,x,B)=>{const O=p.el=g.el;let{patchFlag:D,dynamicChildren:N,dirs:K}=p;D|=g.patchFlag&16;const J=g.props||ue,q=p.props||ue;let j;if(T&&jr(T,!1),(j=q.onVnodeBeforeUpdate)&&Dt(j,T,p,g),K&&Kr(p,g,T,"beforeUpdate"),T&&jr(T,!0),(J.innerHTML&&q.innerHTML==null||J.textContent&&q.textContent==null)&&f(O,""),N?Ie(g.dynamicChildren,N,O,T,E,Zo(p,A),x):B||fe(g,p,O,null,T,E,Zo(p,A),x,!1),D>0){if(D&16)Zt(O,J,q,T,A);else if(D&2&&J.class!==q.class&&i(O,"class",null,q.class,A),D&4&&i(O,"style",J.style,q.style,A),D&8){const ee=p.dynamicProps;for(let he=0;he<ee.length;he++){const se=ee[he],Ge=J[se],qe=q[se];(qe!==Ge||se==="value")&&i(O,se,Ge,qe,A,T)}}D&1&&g.children!==p.children&&f(O,p.children)}else!B&&N==null&&Zt(O,J,q,T,A);((j=q.onVnodeUpdated)||K)&&Ye(()=>{j&&Dt(j,T,p,g),K&&Kr(p,g,T,"updated")},E)},Ie=(g,p,T,E,A,x,B)=>{for(let O=0;O<p.length;O++){const D=g[O],N=p[O],K=D.el&&(D.type===rt||!Ms(D,N)||D.shapeFlag&70)?d(D.el):T;I(D,N,K,null,E,A,x,B,!0)}},Zt=(g,p,T,E,A)=>{if(p!==T){if(p!==ue)for(const x in p)!js(x)&&!(x in T)&&i(g,x,p[x],null,A,E);for(const x in T){if(js(x))continue;const B=T[x],O=p[x];B!==O&&x!=="value"&&i(g,x,O,B,A,E)}"value"in T&&i(g,"value",p.value,T.value,A)}},is=(g,p,T,E,A,x,B,O,D)=>{const N=p.el=g?g.el:a(""),K=p.anchor=g?g.anchor:a("");let{patchFlag:J,dynamicChildren:q,slotScopeIds:j}=p;j&&(O=O?O.concat(j):j),g==null?(r(N,T,E),r(K,T,E),ie(p.children||[],T,K,A,x,B,O,D)):J>0&&J&64&&q&&g.dynamicChildren?(Ie(g.dynamicChildren,q,T,A,x,B,O),(p.key!=null||A&&p===A.subTree)&&hf(g,p,!0)):fe(g,p,T,K,A,x,B,O,D)},Ai=(g,p,T,E,A,x,B,O,D)=>{p.slotScopeIds=O,g==null?p.shapeFlag&512?A.ctx.activate(p,T,E,B,D):Ko(p,T,E,A,x,B,D):Vc(g,p,D)},Ko=(g,p,T,E,A,x,B)=>{const O=g.component=Ag(g,E,A);if(Yl(g)&&(O.ctx.renderer=Js),xg(O,!1,B),O.asyncDep){if(A&&A.registerDep(O,Oe,B),!g.el){const D=O.subTree=Zr(ii);R(null,D,p,T)}}else Oe(O,g,p,T,A,x,B)},Vc=(g,p,T)=>{const E=p.component=g.component;if(gg(g,p,T))if(E.asyncDep&&!E.asyncResolved){me(E,p,T);return}else E.next=p,E.update();else p.el=g.el,E.vnode=p},Oe=(g,p,T,E,A,x,B)=>{const O=()=>{if(g.isMounted){let{next:J,bu:q,u:j,parent:ee,vnode:he}=g;{const Pt=df(g);if(Pt){J&&(J.el=he.el,me(g,J,B)),Pt.asyncDep.then(()=>{g.isUnmounted||O()});return}}let se=J,Ge;jr(g,!1),J?(J.el=he.el,me(g,J,B)):J=he,q&&Ji(q),(Ge=J.props&&J.props.onVnodeBeforeUpdate)&&Dt(Ge,ee,J,he),jr(g,!0);const qe=ou(g),Nt=g.subTree;g.subTree=qe,I(Nt,qe,d(Nt.el),ki(Nt),g,A,x),J.el=qe.el,se===null&&mg(g,qe.el),j&&Ye(j,A),(Ge=J.props&&J.props.onVnodeUpdated)&&Ye(()=>Dt(Ge,ee,J,he),A)}else{let J;const{el:q,props:j}=p,{bm:ee,m:he,parent:se,root:Ge,type:qe}=g,Nt=Gs(p);jr(g,!1),ee&&Ji(ee),!Nt&&(J=j&&j.onVnodeBeforeMount)&&Dt(J,se,p),jr(g,!0);{Ge.ce&&Ge.ce._injectChildStyle(qe);const Pt=g.subTree=ou(g);I(null,Pt,T,E,g,A,x),p.el=Pt.el}if(he&&Ye(he,A),!Nt&&(J=j&&j.onVnodeMounted)){const Pt=p;Ye(()=>Dt(J,se,Pt),A)}(p.shapeFlag&256||se&&Gs(se.vnode)&&se.vnode.shapeFlag&256)&&g.a&&Ye(g.a,A),g.isMounted=!0,p=T=E=null}};g.scope.on();const D=g.effect=new El(O);g.scope.off();const N=g.update=D.run.bind(D),K=g.job=D.runIfDirty.bind(D);K.i=g,K.id=g.uid,D.scheduler=()=>vc(K),jr(g,!0),N()},me=(g,p,T)=>{p.component=g;const E=g.vnode.props;g.vnode=p,g.next=null,Zd(g,p.props,E,T),ng(g,p.children,T),Ur(),Xc(g),qr()},fe=(g,p,T,E,A,x,B,O,D=!1)=>{const N=g&&g.children,K=g?g.shapeFlag:0,J=p.children,{patchFlag:q,shapeFlag:j}=p;if(q>0){if(q&128){xi(N,J,T,E,A,x,B,O,D);return}else if(q&256){zr(N,J,T,E,A,x,B,O,D);return}}j&8?(K&16&&Ls(N,A,x),J!==N&&f(T,J)):K&16?j&16?xi(N,J,T,E,A,x,B,O,D):Ls(N,A,x,!0):(K&8&&f(T,""),j&16&&ie(J,T,E,A,x,B,O,D))},zr=(g,p,T,E,A,x,B,O,D)=>{g=g||gs,p=p||gs;const N=g.length,K=p.length,J=Math.min(N,K);let q;for(q=0;q<J;q++){const j=p[q]=D?Dr(p[q]):Lt(p[q]);I(g[q],j,T,null,A,x,B,O,D)}N>K?Ls(g,A,x,!0,!1,J):ie(p,T,E,A,x,B,O,D,J)},xi=(g,p,T,E,A,x,B,O,D)=>{let N=0;const K=p.length;let J=g.length-1,q=K-1;for(;N<=J&&N<=q;){const j=g[N],ee=p[N]=D?Dr(p[N]):Lt(p[N]);if(Ms(j,ee))I(j,ee,T,null,A,x,B,O,D);else break;N++}for(;N<=J&&N<=q;){const j=g[J],ee=p[q]=D?Dr(p[q]):Lt(p[q]);if(Ms(j,ee))I(j,ee,T,null,A,x,B,O,D);else break;J--,q--}if(N>J){if(N<=q){const j=q+1,ee=j<K?p[j].el:E;for(;N<=q;)I(null,p[N]=D?Dr(p[N]):Lt(p[N]),T,ee,A,x,B,O,D),N++}}else if(N>q)for(;N<=J;)Et(g[N],A,x,!0),N++;else{const j=N,ee=N,he=new Map;for(N=ee;N<=q;N++){const _e=p[N]=D?Dr(p[N]):Lt(p[N]);_e.key!=null&&he.set(_e.key,N)}let se,Ge=0;const qe=q-ee+1;let Nt=!1,Pt=0;const Fs=new Array(qe);for(N=0;N<qe;N++)Fs[N]=0;for(N=j;N<=J;N++){const _e=g[N];if(Ge>=qe){Et(_e,A,x,!0);continue}let Ct;if(_e.key!=null)Ct=he.get(_e.key);else for(se=ee;se<=q;se++)if(Fs[se-ee]===0&&Ms(_e,p[se])){Ct=se;break}Ct===void 0?Et(_e,A,x,!0):(Fs[Ct-ee]=N+1,Ct>=Pt?Pt=Ct:Nt=!0,I(_e,p[Ct],T,null,A,x,B,O,D),Ge++)}const Hc=Nt?og(Fs):gs;for(se=Hc.length-1,N=qe-1;N>=0;N--){const _e=ee+N,Ct=p[_e],Wc=_e+1<K?p[_e+1].el:E;Fs[N]===0?I(null,Ct,T,Wc,A,x,B,O,D):Nt&&(se<0||N!==Hc[se]?Vr(Ct,T,Wc,2):se--)}}},Vr=(g,p,T,E,A=null)=>{const{el:x,type:B,transition:O,children:D,shapeFlag:N}=g;if(N&6){Vr(g.component.subTree,p,T,E);return}if(N&128){g.suspense.move(p,T,E);return}if(N&64){B.move(g,p,T,Js);return}if(B===rt){r(x,p,T);for(let J=0;J<D.length;J++)Vr(D[J],p,T,E);r(g.anchor,p,T);return}if(B===ea){V(g,p,T);return}if(E!==2&&N&1&&O)if(E===0)O.beforeEnter(x),r(x,p,T),Ye(()=>O.enter(x),A);else{const{leave:J,delayLeave:q,afterLeave:j}=O,ee=()=>r(x,p,T),he=()=>{J(x,()=>{ee(),j&&j()})};q?q(x,ee,he):he()}else r(x,p,T)},Et=(g,p,T,E=!1,A=!1)=>{const{type:x,props:B,ref:O,children:D,dynamicChildren:N,shapeFlag:K,patchFlag:J,dirs:q,cacheIndex:j}=g;if(J===-2&&(A=!1),O!=null&&Yi(O,null,T,g,!0),j!=null&&(p.renderCache[j]=void 0),K&256){p.ctx.deactivate(g);return}const ee=K&1&&q,he=!Gs(g);let se;if(he&&(se=B&&B.onVnodeBeforeUnmount)&&Dt(se,p,g),K&6)Bh(g.component,T,E);else{if(K&128){g.suspense.unmount(T,E);return}ee&&Kr(g,null,p,"beforeUnmount"),K&64?g.type.remove(g,p,T,Js,E):N&&!N.hasOnce&&(x!==rt||J>0&&J&64)?Ls(N,p,T,!1,!0):(x===rt&&J&384||!A&&K&16)&&Ls(D,p,T),E&&Kc(g)}(he&&(se=B&&B.onVnodeUnmounted)||ee)&&Ye(()=>{se&&Dt(se,p,g),ee&&Kr(g,null,p,"unmounted")},T)},Kc=g=>{const{type:p,el:T,anchor:E,transition:A}=g;if(p===rt){Rh(T,E);return}if(p===ea){L(g);return}const x=()=>{s(T),A&&!A.persisted&&A.afterLeave&&A.afterLeave()};if(g.shapeFlag&1&&A&&!A.persisted){const{leave:B,delayLeave:O}=A,D=()=>B(T,x);O?O(g.el,x,D):D()}else x()},Rh=(g,p)=>{let T;for(;g!==p;)T=y(g),s(g),g=T;s(p)},Bh=(g,p,T)=>{const{bum:E,scope:A,job:x,subTree:B,um:O,m:D,a:N}=g;iu(D),iu(N),E&&Ji(E),A.stop(),x&&(x.flags|=8,Et(B,g,p,T)),O&&Ye(O,p),Ye(()=>{g.isUnmounted=!0},p),p&&p.pendingBranch&&!p.isUnmounted&&g.asyncDep&&!g.asyncResolved&&g.suspenseId===p.pendingId&&(p.deps--,p.deps===0&&p.resolve())},Ls=(g,p,T,E=!1,A=!1,x=0)=>{for(let B=x;B<g.length;B++)Et(g[B],p,T,E,A)},ki=g=>{if(g.shapeFlag&6)return ki(g.component.subTree);if(g.shapeFlag&128)return g.suspense.next();const p=y(g.anchor||g.el),T=p&&p[Ed];return T?y(T):p};let jo=!1;const jc=(g,p,T)=>{g==null?p._vnode&&Et(p._vnode,null,null,!0):I(p._vnode||null,g,p,null,null,null,T),p._vnode=g,jo||(jo=!0,Xc(),Hl(),jo=!1)},Js={p:I,um:Et,m:Vr,r:Kc,mt:Ko,mc:ie,pc:fe,pbc:Ie,n:ki,o:n};return{render:jc,hydrate:void 0,createApp:_d(jc)}}function Zo({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function jr({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function ig(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function hf(n,e,t=!1){const r=n.children,s=e.children;if(H(r)&&H(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=Dr(s[i]),a.el=o.el),!t&&a.patchFlag!==-2&&hf(o,a)),a.type===Bo&&(a.el=o.el)}}function og(n){const e=n.slice(),t=[0];let r,s,i,o,a;const u=n.length;for(r=0;r<u;r++){const l=n[r];if(l!==0){if(s=t[t.length-1],n[s]<l){e[r]=s,t.push(r);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,n[t[a]]<l?i=a+1:o=a;l<n[t[i]]&&(i>0&&(e[r]=t[i-1]),t[i]=r)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function df(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:df(e)}function iu(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const ag=Symbol.for("v-scx"),cg=()=>Fi(ag);function Qo(n,e,t){return gf(n,e,t)}function gf(n,e,t=ue){const{immediate:r,deep:s,flush:i,once:o}=t,a=Ue({},t),u=e&&r||!e&&i!=="post";let l;if(ai){if(i==="sync"){const m=cg();l=m.__watcherHandles||(m.__watcherHandles=[])}else if(!u){const m=()=>{};return m.stop=jt,m.resume=jt,m.pause=jt,m}}const f=Fe;a.call=(m,S,I)=>_t(m,f,S,I);let d=!1;i==="post"?a.scheduler=m=>{Ye(m,f&&f.suspense)}:i!=="sync"&&(d=!0,a.scheduler=(m,S)=>{S?m():vc(m)}),a.augmentJob=m=>{e&&(m.flags|=4),d&&(m.flags|=2,f&&(m.id=f.uid,m.i=f))};const y=Td(n,e,a);return ai&&(l?l.push(y):u&&y()),y}function ug(n,e,t){const r=this.proxy,s=Ae(n)?n.includes(".")?mf(r,n):()=>r[n]:n.bind(r,r);let i;_(e)?i=e:(i=e.handler,t=e);const o=wi(this),a=gf(s,i.bind(r),t);return o(),a}function mf(n,e){const t=e.split(".");return()=>{let r=n;for(let s=0;s<t.length&&r;s++)r=r[t[s]];return r}}const lg=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${Jr(e)}Modifiers`]||n[`${Mr(e)}Modifiers`];function fg(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||ue;let s=t;const i=e.startsWith("update:"),o=i&&lg(r,e.slice(7));o&&(o.trim&&(s=t.map(f=>Ae(f)?f.trim():f)),o.number&&(s=t.map(da)));let a,u=r[a=Ho(e)]||r[a=Ho(Jr(e))];!u&&i&&(u=r[a=Ho(Mr(e))]),u&&_t(u,n,6,s);const l=r[a+"Once"];if(l){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,_t(l,n,6,s)}}function pf(n,e,t=!1){const r=e.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},a=!1;if(!_(n)){const u=l=>{const f=pf(l,e,!0);f&&(a=!0,Ue(o,f))};!t&&e.mixins.length&&e.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}return!i&&!a?(ye(n)&&r.set(n,null),null):(H(i)?i.forEach(u=>o[u]=null):Ue(o,i),ye(n)&&r.set(n,o),o)}function Ro(n,e){return!n||!ko(e)?!1:(e=e.slice(2).replace(/Once$/,""),ne(n,e[0].toLowerCase()+e.slice(1))||ne(n,Mr(e))||ne(n,e))}function ou(n){const{type:e,vnode:t,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:u,render:l,renderCache:f,props:d,data:y,setupState:m,ctx:S,inheritAttrs:I}=n,C=_i(n);let R,$;try{if(t.shapeFlag&4){const L=s||r,Y=L;R=Lt(l.call(Y,L,f,d,m,y,S)),$=a}else{const L=e;R=Lt(L.length>1?L(d,{attrs:a,slots:o,emit:u}):L(d,null)),$=e.props?a:hg(a)}}catch(L){Ys.length=0,Do(L,n,1),R=Zr(ii)}let V=R;if($&&I!==!1){const L=Object.keys($),{shapeFlag:Y}=V;L.length&&Y&7&&(i&&L.some(oc)&&($=dg($,i)),V=Is(V,$,!1,!0))}return t.dirs&&(V=Is(V,null,!1,!0),V.dirs=V.dirs?V.dirs.concat(t.dirs):t.dirs),t.transition&&wc(V,t.transition),R=V,_i(C),R}const hg=n=>{let e;for(const t in n)(t==="class"||t==="style"||ko(t))&&((e||(e={}))[t]=n[t]);return e},dg=(n,e)=>{const t={};for(const r in n)(!oc(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function gg(n,e,t){const{props:r,children:s,component:i}=n,{props:o,children:a,patchFlag:u}=e,l=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&u>=0){if(u&1024)return!0;if(u&16)return r?au(r,o,l):!!o;if(u&8){const f=e.dynamicProps;for(let d=0;d<f.length;d++){const y=f[d];if(o[y]!==r[y]&&!Ro(l,y))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?au(r,o,l):!0:!!o;return!1}function au(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==n[i]&&!Ro(t,i))return!0}return!1}function mg({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const yf=n=>n.__isSuspense;function pg(n,e){e&&e.pendingBranch?H(n)?e.effects.push(...n):e.effects.push(n):xd(n)}const rt=Symbol.for("v-fgt"),Bo=Symbol.for("v-txt"),ii=Symbol.for("v-cmt"),ea=Symbol.for("v-stc"),Ys=[];let Ze=null;function en(n=!1){Ys.push(Ze=n?null:[])}function yg(){Ys.pop(),Ze=Ys[Ys.length-1]||null}let oi=1;function cu(n,e=!1){oi+=n,n<0&&Ze&&e&&(Ze.hasOnce=!0)}function vg(n){return n.dynamicChildren=oi>0?Ze||gs:null,yg(),oi>0&&Ze&&Ze.push(n),n}function tn(n,e,t,r,s,i){return vg(Be(n,e,t,r,s,i,!0))}function vf(n){return n?n.__v_isVNode===!0:!1}function Ms(n,e){return n.type===e.type&&n.key===e.key}const wf=({key:n})=>n??null,$i=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?Ae(n)||$e(n)||_(n)?{i:gt,r:n,k:e,f:!!t}:n:null);function Be(n,e=null,t=null,r=0,s=null,i=n===rt?0:1,o=!1,a=!1){const u={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&wf(e),ref:e&&$i(e),scopeId:Gl,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:gt};return a?(Tc(u,t),i&128&&n.normalize(u)):t&&(u.shapeFlag|=Ae(t)?8:16),oi>0&&!o&&Ze&&(u.patchFlag>0||i&6)&&u.patchFlag!==32&&Ze.push(u),u}const Zr=wg;function wg(n,e=null,t=null,r=0,s=null,i=!1){if((!n||n===qd)&&(n=ii),vf(n)){const a=Is(n,e,!0);return t&&Tc(a,t),oi>0&&!i&&Ze&&(a.shapeFlag&6?Ze[Ze.indexOf(n)]=a:Ze.push(a)),a.patchFlag=-2,a}if(Pg(n)&&(n=n.__vccOpts),e){e=bg(e);let{class:a,style:u}=e;a&&!Ae(a)&&(e.class=lc(a)),ye(u)&&(yc(u)&&!H(u)&&(u=Ue({},u)),e.style=uc(u))}const o=Ae(n)?1:yf(n)?128:Nd(n)?64:ye(n)?4:_(n)?2:0;return Be(n,e,t,r,s,o,i,!0)}function bg(n){return n?yc(n)||sf(n)?Ue({},n):n:null}function Is(n,e,t=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:u}=n,l=e?Tg(s||{},e):s,f={__v_isVNode:!0,__v_skip:!0,type:n.type,props:l,key:l&&wf(l),ref:e&&e.ref?t&&i?H(i)?i.concat($i(e)):[i,$i(e)]:$i(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==rt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:u,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Is(n.ssContent),ssFallback:n.ssFallback&&Is(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return u&&r&&wc(f,u.clone(f)),f}function bf(n=" ",e=0){return Zr(Bo,null,n,e)}function Lt(n){return n==null||typeof n=="boolean"?Zr(ii):H(n)?Zr(rt,null,n.slice()):vf(n)?Dr(n):Zr(Bo,null,String(n))}function Dr(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Is(n)}function Tc(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(H(e))t=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),Tc(n,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!sf(e)?e._ctx=gt:s===3&&gt&&(gt.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else _(e)?(e={default:e,_ctx:gt},t=32):(e=String(e),r&64?(t=16,e=[bf(e)]):t=8);n.children=e,n.shapeFlag|=t}function Tg(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=lc([e.class,r.class]));else if(s==="style")e.style=uc([e.style,r.style]);else if(ko(s)){const i=e[s],o=r[s];o&&i!==o&&!(H(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function Dt(n,e,t,r=null){_t(n,e,7,[t,r])}const Sg=tf();let Ig=0;function Ag(n,e,t){const r=n.type,s=(e?e.appContext:n.appContext)||Sg,i={uid:Ig++,vnode:n,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Gh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:af(r,s),emitsOptions:pf(r,s),emit:null,emitted:null,propsDefaults:ue,inheritAttrs:r.inheritAttrs,ctx:ue,data:ue,props:ue,attrs:ue,slots:ue,refs:ue,setupState:ue,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=fg.bind(null,i),n.ce&&n.ce(i),i}let Fe=null,Zi,Aa;{const n=Po(),e=(t,r)=>{let s;return(s=n[t])||(s=n[t]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};Zi=e("__VUE_INSTANCE_SETTERS__",t=>Fe=t),Aa=e("__VUE_SSR_SETTERS__",t=>ai=t)}const wi=n=>{const e=Fe;return Zi(n),n.scope.on(),()=>{n.scope.off(),Zi(e)}},uu=()=>{Fe&&Fe.scope.off(),Zi(null)};function Tf(n){return n.vnode.shapeFlag&4}let ai=!1;function xg(n,e=!1,t=!1){e&&Aa(e);const{props:r,children:s}=n.vnode,i=Tf(n);Xd(n,r,i,e),tg(n,s,t);const o=i?kg(n,e):void 0;return e&&Aa(!1),o}function kg(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,zd);const{setup:r}=t;if(r){Ur();const s=n.setupContext=r.length>1?Ng(n):null,i=wi(n),o=vi(r,n,0,[n.props,s]),a=wl(o);if(qr(),i(),(a||n.sp)&&!Gs(n)&&_l(n),a){if(o.then(uu,uu),e)return o.then(u=>{lu(n,u)}).catch(u=>{Do(u,n,0)});n.asyncDep=o}else lu(n,o)}else Sf(n)}function lu(n,e,t){_(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:ye(e)&&(n.setupState=Vl(e)),Sf(n)}function Sf(n,e,t){const r=n.type;n.render||(n.render=r.render||jt);{const s=wi(n);Ur();try{Vd(n)}finally{qr(),s()}}}const Eg={get(n,e){return Pe(n,"get",""),n[e]}};function Ng(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,Eg),slots:n.slots,emit:n.emit,expose:e}}function Lo(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Vl(md(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in _s)return _s[t](n)},has(e,t){return t in e||t in _s}})):n.proxy}function Pg(n){return _(n)&&"__vccOpts"in n}const Cg=(n,e)=>wd(n,e,ai),Dg="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let xa;const fu=typeof window<"u"&&window.trustedTypes;if(fu)try{xa=fu.createPolicy("vue",{createHTML:n=>n})}catch{}const If=xa?n=>xa.createHTML(n):n=>n,Og="http://www.w3.org/2000/svg",Rg="http://www.w3.org/1998/Math/MathML",rn=typeof document<"u"?document:null,hu=rn&&rn.createElement("template"),Bg={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const s=e==="svg"?rn.createElementNS(Og,n):e==="mathml"?rn.createElementNS(Rg,n):t?rn.createElement(n,{is:t}):rn.createElement(n);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>rn.createTextNode(n),createComment:n=>rn.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>rn.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{hu.innerHTML=If(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=hu.content;if(r==="svg"||r==="mathml"){const u=a.firstChild;for(;u.firstChild;)a.appendChild(u.firstChild);a.removeChild(u)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},Lg=Symbol("_vtc");function Jg(n,e,t){const r=n[Lg];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const du=Symbol("_vod"),Fg=Symbol("_vsh"),$g=Symbol(""),Mg=/(^|;)\s*display\s*:/;function Ug(n,e,t){const r=n.style,s=Ae(t);let i=!1;if(t&&!s){if(e)if(Ae(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&Mi(r,a,"")}else for(const o in e)t[o]==null&&Mi(r,o,"");for(const o in t)o==="display"&&(i=!0),Mi(r,o,t[o])}else if(s){if(e!==t){const o=r[$g];o&&(t+=";"+o),r.cssText=t,i=Mg.test(t)}}else e&&n.removeAttribute("style");du in n&&(n[du]=i?r.display:"",n[Fg]&&(r.display="none"))}const gu=/\s*!important$/;function Mi(n,e,t){if(H(t))t.forEach(r=>Mi(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=qg(n,e);gu.test(t)?n.setProperty(Mr(r),t.replace(gu,""),"important"):n[r]=t}}const mu=["Webkit","Moz","ms"],ta={};function qg(n,e){const t=ta[e];if(t)return t;let r=Jr(e);if(r!=="filter"&&r in n)return ta[e]=r;r=Sl(r);for(let s=0;s<mu.length;s++){const i=mu[s]+r;if(i in n)return ta[e]=i}return e}const pu="http://www.w3.org/1999/xlink";function yu(n,e,t,r,s,i=Wh(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(pu,e.slice(6,e.length)):n.setAttributeNS(pu,e,t):t==null||i&&!Al(t)?n.removeAttribute(e):n.setAttribute(e,i?"":$r(t)?String(t):t)}function vu(n,e,t,r,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?If(t):t);return}const i=n.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?n.getAttribute("value")||"":n.value,u=t==null?n.type==="checkbox"?"on":"":String(t);(a!==u||!("_value"in n))&&(n.value=u),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=Al(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(s||e)}function ls(n,e,t,r){n.addEventListener(e,t,r)}function zg(n,e,t,r){n.removeEventListener(e,t,r)}const wu=Symbol("_vei");function Vg(n,e,t,r,s=null){const i=n[wu]||(n[wu]={}),o=i[e];if(r&&o)o.value=r;else{const[a,u]=Kg(e);if(r){const l=i[e]=Wg(r,s);ls(n,a,l,u)}else o&&(zg(n,a,o,u),i[e]=void 0)}}const bu=/(?:Once|Passive|Capture)$/;function Kg(n){let e;if(bu.test(n)){e={};let r;for(;r=n.match(bu);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Mr(n.slice(2)),e]}let na=0;const jg=Promise.resolve(),Hg=()=>na||(jg.then(()=>na=0),na=Date.now());function Wg(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;_t(Gg(r,t.value),e,5,[r])};return t.value=n,t.attached=Hg(),t}function Gg(n,e){if(H(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Tu=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,_g=(n,e,t,r,s,i)=>{const o=s==="svg";e==="class"?Jg(n,r,o):e==="style"?Ug(n,t,r):ko(e)?oc(e)||Vg(n,e,t,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Yg(n,e,r,o))?(vu(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&yu(n,e,r,o,i,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!Ae(r))?vu(n,Jr(e),r,i,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),yu(n,e,r,o))};function Yg(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&Tu(e)&&_(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Tu(e)&&Ae(t)?!1:e in n}const Su=n=>{const e=n.props["onUpdate:modelValue"]||!1;return H(e)?t=>Ji(e,t):e};function Xg(n){n.target.composing=!0}function Iu(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ra=Symbol("_assign"),Au={created(n,{modifiers:{lazy:e,trim:t,number:r}},s){n[ra]=Su(s);const i=r||s.props&&s.props.type==="number";ls(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),i&&(a=da(a)),n[ra](a)}),t&&ls(n,"change",()=>{n.value=n.value.trim()}),e||(ls(n,"compositionstart",Xg),ls(n,"compositionend",Iu),ls(n,"change",Iu))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:s,number:i}},o){if(n[ra]=Su(o),n.composing)return;const a=(i||n.type==="number")&&!/^0\d/.test(n.value)?da(n.value):n.value,u=e??"";a!==u&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||s&&n.value.trim()===u)||(n.value=u))}},Zg={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Ci=(n,e)=>{const t=n._withKeys||(n._withKeys={}),r=e.join(".");return t[r]||(t[r]=s=>{if(!("key"in s))return;const i=Mr(s.key);if(e.some(o=>o===i||Zg[o]===i))return n(s)})},Qg=Ue({patchProp:_g},Bg);let xu;function em(){return xu||(xu=rg(Qg))}const tm=(...n)=>{const e=em().createApp(...n),{mount:t}=e;return e.mount=r=>{const s=rm(r);if(!s)return;const i=e._component;!_(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,nm(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function nm(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function rm(n){return Ae(n)?document.querySelector(n):n}var X;(function(n){n[n.Canceled=1]="Canceled",n[n.Unknown=2]="Unknown",n[n.InvalidArgument=3]="InvalidArgument",n[n.DeadlineExceeded=4]="DeadlineExceeded",n[n.NotFound=5]="NotFound",n[n.AlreadyExists=6]="AlreadyExists",n[n.PermissionDenied=7]="PermissionDenied",n[n.ResourceExhausted=8]="ResourceExhausted",n[n.FailedPrecondition=9]="FailedPrecondition",n[n.Aborted=10]="Aborted",n[n.OutOfRange=11]="OutOfRange",n[n.Unimplemented=12]="Unimplemented",n[n.Internal=13]="Internal",n[n.Unavailable=14]="Unavailable",n[n.DataLoss=15]="DataLoss",n[n.Unauthenticated=16]="Unauthenticated"})(X||(X={}));function ku(n){const e=X[n];return typeof e!="string"?n.toString():e[0].toLowerCase()+e.substring(1).replace(/[A-Z]/g,t=>"_"+t.toLowerCase())}class re extends Error{constructor(e,t=X.Unknown,r,s,i){super(sm(e,t)),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=e,this.code=t,this.metadata=new Headers(r??{}),this.details=s??[],this.cause=i}static from(e,t=X.Unknown){return e instanceof re?e:e instanceof Error?e.name=="AbortError"?new re(e.message,X.Canceled):new re(e.message,t,void 0,void 0,e):new re(String(e),t,void 0,void 0,e)}static[Symbol.hasInstance](e){return e instanceof Error?Object.getPrototypeOf(e)===re.prototype?!0:e.name==="ConnectError"&&"code"in e&&typeof e.code=="number"&&"metadata"in e&&"details"in e&&Array.isArray(e.details)&&"rawMessage"in e&&typeof e.rawMessage=="string"&&"cause"in e:!1}findDetails(e){const t="typeName"in e?{findMessage:s=>s===e.typeName?e:void 0}:e,r=[];for(const s of this.details){if("getType"in s){t.findMessage(s.getType().typeName)&&r.push(s);continue}const i=t.findMessage(s.type);if(i)try{r.push(i.fromBinary(s.value))}catch{}}return r}}function sm(n,e){return n.length?`[${ku(e)}] ${n}`:`[${ku(e)}]`}function be(n,e){if(!n)throw new Error(e)}const im=34028234663852886e22,om=-34028234663852886e22,am=4294967295,cm=2147483647,um=-2147483648;function Ui(n){if(typeof n!="number")throw new Error("invalid int 32: "+typeof n);if(!Number.isInteger(n)||n>cm||n<um)throw new Error("invalid int 32: "+n)}function ka(n){if(typeof n!="number")throw new Error("invalid uint 32: "+typeof n);if(!Number.isInteger(n)||n>am||n<0)throw new Error("invalid uint 32: "+n)}function Af(n){if(typeof n!="number")throw new Error("invalid float 32: "+typeof n);if(Number.isFinite(n)&&(n>im||n<om))throw new Error("invalid float 32: "+n)}const xf=Symbol("@bufbuild/protobuf/enum-type");function lm(n){const e=n[xf];return be(e,"missing enum type on enum object"),e}function kf(n,e,t,r){n[xf]=Ef(e,t.map(s=>({no:s.no,name:s.name,localName:n[s.no]})))}function Ef(n,e,t){const r=Object.create(null),s=Object.create(null),i=[];for(const o of e){const a=Nf(o);i.push(a),r[o.name]=a,s[o.no]=a}return{typeName:n,values:i,findName(o){return r[o]},findNumber(o){return s[o]}}}function fm(n,e,t){const r={};for(const s of e){const i=Nf(s);r[i.localName]=i.no,r[i.no]=i.localName}return kf(r,n,e),r}function Nf(n){return"localName"in n?n:Object.assign(Object.assign({},n),{localName:n.name})}class P{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const r=this.getType(),s=r.runtime.bin,i=s.makeReadOptions(t);return s.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,t){const r=this.getType(),s=r.runtime.json,i=s.makeReadOptions(t);return s.readMessage(r,e,i,this),this}fromJsonString(e,t){let r;try{r=JSON.parse(e)}catch(s){throw new Error(`cannot decode ${this.getType().typeName} from JSON: ${s instanceof Error?s.message:String(s)}`)}return this.fromJson(r,t)}toBinary(e){const t=this.getType(),r=t.runtime.bin,s=r.makeWriteOptions(e),i=s.writerFactory();return r.writeMessage(this,i,s),i.finish()}toJson(e){const t=this.getType(),r=t.runtime.json,s=r.makeWriteOptions(e);return r.writeMessage(this,s)}toJsonString(e){var t;const r=this.toJson(e);return JSON.stringify(r,null,(t=e==null?void 0:e.prettySpaces)!==null&&t!==void 0?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function hm(n,e,t,r){var s;const i=(s=r==null?void 0:r.localName)!==null&&s!==void 0?s:e.substring(e.lastIndexOf(".")+1),o={[i]:function(a){n.util.initFields(this),n.util.initPartial(a,this)}}[i];return Object.setPrototypeOf(o.prototype,new P),Object.assign(o,{runtime:n,typeName:e,fields:n.util.newFieldList(t),fromBinary(a,u){return new o().fromBinary(a,u)},fromJson(a,u){return new o().fromJson(a,u)},fromJsonString(a,u){return new o().fromJsonString(a,u)},equals(a,u){return n.util.equals(o,a,u)}}),o}function dm(){let n=0,e=0;for(let r=0;r<28;r+=7){let s=this.buf[this.pos++];if(n|=(s&127)<<r,!(s&128))return this.assertBounds(),[n,e]}let t=this.buf[this.pos++];if(n|=(t&15)<<28,e=(t&112)>>4,!(t&128))return this.assertBounds(),[n,e];for(let r=3;r<=31;r+=7){let s=this.buf[this.pos++];if(e|=(s&127)<<r,!(s&128))return this.assertBounds(),[n,e]}throw new Error("invalid varint")}function sa(n,e,t){for(let i=0;i<28;i=i+7){const o=n>>>i,a=!(!(o>>>7)&&e==0),u=(a?o|128:o)&255;if(t.push(u),!a)return}const r=n>>>28&15|(e&7)<<4,s=!!(e>>3);if(t.push((s?r|128:r)&255),!!s){for(let i=3;i<31;i=i+7){const o=e>>>i,a=!!(o>>>7),u=(a?o|128:o)&255;if(t.push(u),!a)return}t.push(e>>>31&1)}}const qi=4294967296;function Eu(n){const e=n[0]==="-";e&&(n=n.slice(1));const t=1e6;let r=0,s=0;function i(o,a){const u=Number(n.slice(o,a));s*=t,r=r*t+u,r>=qi&&(s=s+(r/qi|0),r=r%qi)}return i(-24,-18),i(-18,-12),i(-12,-6),i(-6),e?Cf(r,s):Sc(r,s)}function gm(n,e){let t=Sc(n,e);const r=t.hi&2147483648;r&&(t=Cf(t.lo,t.hi));const s=Pf(t.lo,t.hi);return r?"-"+s:s}function Pf(n,e){if({lo:n,hi:e}=mm(n,e),e<=2097151)return String(qi*e+n);const t=n&16777215,r=(n>>>24|e<<8)&16777215,s=e>>16&65535;let i=t+r*6777216+s*6710656,o=r+s*8147497,a=s*2;const u=1e7;return i>=u&&(o+=Math.floor(i/u),i%=u),o>=u&&(a+=Math.floor(o/u),o%=u),a.toString()+Nu(o)+Nu(i)}function mm(n,e){return{lo:n>>>0,hi:e>>>0}}function Sc(n,e){return{lo:n|0,hi:e|0}}function Cf(n,e){return e=~e,n?n=~n+1:e+=1,Sc(n,e)}const Nu=n=>{const e=String(n);return"0000000".slice(e.length)+e};function Pu(n,e){if(n>=0){for(;n>127;)e.push(n&127|128),n=n>>>7;e.push(n)}else{for(let t=0;t<9;t++)e.push(n&127|128),n=n>>7;e.push(1)}}function pm(){let n=this.buf[this.pos++],e=n&127;if(!(n&128))return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<7,!(n&128))return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<14,!(n&128))return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<21,!(n&128))return this.assertBounds(),e;n=this.buf[this.pos++],e|=(n&15)<<28;for(let t=5;n&128&&t<10;t++)n=this.buf[this.pos++];if(n&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}var Cu={};function ym(){const n=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof n.getBigInt64=="function"&&typeof n.getBigUint64=="function"&&typeof n.setBigInt64=="function"&&typeof n.setBigUint64=="function"&&(typeof process!="object"||typeof Cu!="object"||Cu.BUF_BIGINT_DISABLE!=="1")){const s=BigInt("-9223372036854775808"),i=BigInt("9223372036854775807"),o=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(u){const l=typeof u=="bigint"?u:BigInt(u);if(l>i||l<s)throw new Error(`int64 invalid: ${u}`);return l},uParse(u){const l=typeof u=="bigint"?u:BigInt(u);if(l>a||l<o)throw new Error(`uint64 invalid: ${u}`);return l},enc(u){return n.setBigInt64(0,this.parse(u),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},uEnc(u){return n.setBigInt64(0,this.uParse(u),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},dec(u,l){return n.setInt32(0,u,!0),n.setInt32(4,l,!0),n.getBigInt64(0,!0)},uDec(u,l){return n.setInt32(0,u,!0),n.setInt32(4,l,!0),n.getBigUint64(0,!0)}}}const t=s=>be(/^-?[0-9]+$/.test(s),`int64 invalid: ${s}`),r=s=>be(/^[0-9]+$/.test(s),`uint64 invalid: ${s}`);return{zero:"0",supported:!1,parse(s){return typeof s!="string"&&(s=s.toString()),t(s),s},uParse(s){return typeof s!="string"&&(s=s.toString()),r(s),s},enc(s){return typeof s!="string"&&(s=s.toString()),t(s),Eu(s)},uEnc(s){return typeof s!="string"&&(s=s.toString()),r(s),Eu(s)},dec(s,i){return gm(s,i)},uDec(s,i){return Pf(s,i)}}}const ge=ym();var b;(function(n){n[n.DOUBLE=1]="DOUBLE",n[n.FLOAT=2]="FLOAT",n[n.INT64=3]="INT64",n[n.UINT64=4]="UINT64",n[n.INT32=5]="INT32",n[n.FIXED64=6]="FIXED64",n[n.FIXED32=7]="FIXED32",n[n.BOOL=8]="BOOL",n[n.STRING=9]="STRING",n[n.BYTES=12]="BYTES",n[n.UINT32=13]="UINT32",n[n.SFIXED32=15]="SFIXED32",n[n.SFIXED64=16]="SFIXED64",n[n.SINT32=17]="SINT32",n[n.SINT64=18]="SINT64"})(b||(b={}));var Fr;(function(n){n[n.BIGINT=0]="BIGINT",n[n.STRING=1]="STRING"})(Fr||(Fr={}));function xr(n,e,t){if(e===t)return!0;if(n==b.BYTES){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}switch(n){case b.UINT64:case b.FIXED64:case b.INT64:case b.SFIXED64:case b.SINT64:return e==t}return!1}function As(n,e){switch(n){case b.BOOL:return!1;case b.UINT64:case b.FIXED64:case b.INT64:case b.SFIXED64:case b.SINT64:return e==0?ge.zero:"0";case b.DOUBLE:case b.FLOAT:return 0;case b.BYTES:return new Uint8Array(0);case b.STRING:return"";default:return 0}}function Df(n,e){switch(n){case b.BOOL:return e===!1;case b.STRING:return e==="";case b.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var Se;(function(n){n[n.Varint=0]="Varint",n[n.Bit64=1]="Bit64",n[n.LengthDelimited=2]="LengthDelimited",n[n.StartGroup=3]="StartGroup",n[n.EndGroup=4]="EndGroup",n[n.Bit32=5]="Bit32"})(Se||(Se={}));class vm{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let s=0;s<this.chunks.length;s++)e+=this.chunks[s].length;let t=new Uint8Array(e),r=0;for(let s=0;s<this.chunks.length;s++)t.set(this.chunks[s],r),r+=this.chunks[s].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(ka(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Ui(e),Pu(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){Af(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){ka(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){Ui(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return Ui(e),e=(e<<1^e>>31)>>>0,Pu(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),s=ge.enc(e);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),s=ge.uEnc(e);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(t)}int64(e){let t=ge.enc(e);return sa(t.lo,t.hi,this.buf),this}sint64(e){let t=ge.enc(e),r=t.hi>>31,s=t.lo<<1^r,i=(t.hi<<1|t.lo>>>31)^r;return sa(s,i,this.buf),this}uint64(e){let t=ge.uEnc(e);return sa(t.lo,t.hi,this.buf),this}}class wm{constructor(e,t){this.varint64=dm,this.uint32=pm,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,r=e&7;if(t<=0||r<0||r>5)throw new Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e,t){let r=this.pos;switch(e){case Se.Varint:for(;this.buf[this.pos++]&128;);break;case Se.Bit64:this.pos+=4;case Se.Bit32:this.pos+=4;break;case Se.LengthDelimited:let s=this.uint32();this.pos+=s;break;case Se.StartGroup:for(;;){const[i,o]=this.tag();if(o===Se.EndGroup){if(t!==void 0&&i!==t)throw new Error("invalid end group tag");break}this.skip(o,i)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return ge.dec(...this.varint64())}uint64(){return ge.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(e&1);return e=(e>>>1|(t&1)<<31)^r,t=t>>>1^r,ge.dec(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return ge.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return ge.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function bm(n,e,t,r){let s;return{typeName:e,extendee:t,get field(){if(!s){const i=typeof r=="function"?r():r;i.name=e.split(".").pop(),i.jsonName=`[${e}]`,s=n.util.newFieldList([i]).list()[0]}return s},runtime:n}}function Of(n){const e=n.field.localName,t=Object.create(null);return t[e]=Tm(n),[t,()=>t[e]]}function Tm(n){const e=n.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return As(e.T,e.L);case"message":const t=e.T,r=new t;return t.fieldWrapper?t.fieldWrapper.unwrapField(r):r;case"map":throw"map fields are not allowed to be extensions"}}function Sm(n,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let t=n.length-1;t>=0;--t)if(n[t].no==e.no)return[n[t]];return[]}return n.filter(t=>t.no===e.no)}let dr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Jo=[];for(let n=0;n<dr.length;n++)Jo[dr[n].charCodeAt(0)]=n;Jo[45]=dr.indexOf("+");Jo[95]=dr.indexOf("/");const Ic={dec(n){let e=n.length*3/4;n[n.length-2]=="="?e-=2:n[n.length-1]=="="&&(e-=1);let t=new Uint8Array(e),r=0,s=0,i,o=0;for(let a=0;a<n.length;a++){if(i=Jo[n.charCodeAt(a)],i===void 0)switch(n[a]){case"=":s=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(s){case 0:o=i,s=1;break;case 1:t[r++]=o<<2|(i&48)>>4,o=i,s=2;break;case 2:t[r++]=(o&15)<<4|(i&60)>>2,o=i,s=3;break;case 3:t[r++]=(o&3)<<6|i,s=0;break}}if(s==1)throw Error("invalid base64 string.");return t.subarray(0,r)},enc(n){let e="",t=0,r,s=0;for(let i=0;i<n.length;i++)switch(r=n[i],t){case 0:e+=dr[r>>2],s=(r&3)<<4,t=1;break;case 1:e+=dr[s|r>>4],s=(r&15)<<2,t=2;break;case 2:e+=dr[s|r>>6],e+=dr[r&63],t=0;break}return t&&(e+=dr[s],e+="=",t==1&&(e+="=")),e}};function Im(n,e,t){Bf(e,n);const r=e.runtime.bin.makeReadOptions(t),s=Sm(n.getType().runtime.bin.listUnknownFields(n),e.field),[i,o]=Of(e);for(const a of s)e.runtime.bin.readField(i,r.readerFactory(a.data),e.field,a.wireType,r);return o()}function Am(n,e,t,r){Bf(e,n);const s=e.runtime.bin.makeReadOptions(r),i=e.runtime.bin.makeWriteOptions(r);if(Rf(n,e)){const l=n.getType().runtime.bin.listUnknownFields(n).filter(f=>f.no!=e.field.no);n.getType().runtime.bin.discardUnknownFields(n);for(const f of l)n.getType().runtime.bin.onUnknownField(n,f.no,f.wireType,f.data)}const o=i.writerFactory();let a=e.field;!a.opt&&!a.repeated&&(a.kind=="enum"||a.kind=="scalar")&&(a=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(a,t,o,i);const u=s.readerFactory(o.finish());for(;u.pos<u.len;){const[l,f]=u.tag(),d=u.skip(f,l);n.getType().runtime.bin.onUnknownField(n,l,f,d)}}function Rf(n,e){const t=n.getType();return e.extendee.typeName===t.typeName&&!!t.runtime.bin.listUnknownFields(n).find(r=>r.no==e.field.no)}function Bf(n,e){be(n.extendee.typeName==e.getType().typeName,`extension ${n.typeName} can only be applied to message ${n.extendee.typeName}`)}function Lf(n,e){const t=n.localName;if(n.repeated)return e[t].length>0;if(n.oneof)return e[n.oneof.localName].case===t;switch(n.kind){case"enum":case"scalar":return n.opt||n.req?e[t]!==void 0:n.kind=="enum"?e[t]!==n.T.values[0].no:!Df(n.T,e[t]);case"message":return e[t]!==void 0;case"map":return Object.keys(e[t]).length>0}}function Du(n,e){const t=n.localName,r=!n.opt&&!n.req;if(n.repeated)e[t]=[];else if(n.oneof)e[n.oneof.localName]={case:void 0};else switch(n.kind){case"map":e[t]={};break;case"enum":e[t]=r?n.T.values[0].no:void 0;break;case"scalar":e[t]=r?As(n.T,n.L):void 0;break;case"message":e[t]=void 0;break}}function Qr(n,e){if(n===null||typeof n!="object"||!Object.getOwnPropertyNames(P.prototype).every(r=>r in n&&typeof n[r]=="function"))return!1;const t=n.getType();return t===null||typeof t!="function"||!("typeName"in t)||typeof t.typeName!="string"?!1:e===void 0?!0:t.typeName==e.typeName}function Jf(n,e){return Qr(e)||!n.fieldWrapper?e:n.fieldWrapper.wrapField(e)}b.DOUBLE,b.FLOAT,b.INT64,b.UINT64,b.INT32,b.UINT32,b.BOOL,b.STRING,b.BYTES;const Ou={ignoreUnknownFields:!1},Ru={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function xm(n){return n?Object.assign(Object.assign({},Ou),n):Ou}function km(n){return n?Object.assign(Object.assign({},Ru),n):Ru}const Qi=Symbol(),zi=Symbol();function Em(){return{makeReadOptions:xm,makeWriteOptions:km,readMessage(n,e,t,r){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error(`cannot decode message ${n.typeName} from JSON: ${Bt(e)}`);r=r??new n;const s=new Map,i=t.typeRegistry;for(const[o,a]of Object.entries(e)){const u=n.fields.findJsonName(o);if(u){if(u.oneof){if(a===null&&u.kind=="scalar")continue;const l=s.get(u.oneof);if(l!==void 0)throw new Error(`cannot decode message ${n.typeName} from JSON: multiple keys for oneof "${u.oneof.name}" present: "${l}", "${o}"`);s.set(u.oneof,o)}Bu(r,a,u,t,n)}else{let l=!1;if(i!=null&&i.findExtension&&o.startsWith("[")&&o.endsWith("]")){const f=i.findExtension(o.substring(1,o.length-1));if(f&&f.extendee.typeName==n.typeName){l=!0;const[d,y]=Of(f);Bu(d,a,f.field,t,f),Am(r,f,y(),t)}}if(!l&&!t.ignoreUnknownFields)throw new Error(`cannot decode message ${n.typeName} from JSON: key "${o}" is unknown`)}}return r},writeMessage(n,e){const t=n.getType(),r={};let s;try{for(s of t.fields.byNumber()){if(!Lf(s,n)){if(s.req)throw"required field not set";if(!e.emitDefaultValues||!Pm(s))continue}const o=s.oneof?n[s.oneof.localName].value:n[s.localName],a=Lu(s,o,e);a!==void 0&&(r[e.useProtoFieldName?s.name:s.jsonName]=a)}const i=e.typeRegistry;if(i!=null&&i.findExtensionFor)for(const o of t.runtime.bin.listUnknownFields(n)){const a=i.findExtensionFor(t.typeName,o.no);if(a&&Rf(n,a)){const u=Im(n,a,e),l=Lu(a.field,u,e);l!==void 0&&(r[a.field.jsonName]=l)}}}catch(i){const o=s?`cannot encode field ${t.typeName}.${s.name} to JSON`:`cannot encode message ${t.typeName} to JSON`,a=i instanceof Error?i.message:String(i);throw new Error(o+(a.length>0?`: ${a}`:""))}return r},readScalar(n,e,t){return Xs(n,e,t??Fr.BIGINT,!0)},writeScalar(n,e,t){if(e!==void 0&&(t||Df(n,e)))return Vi(n,e)},debug:Bt}}function Bt(n){if(n===null)return"null";switch(typeof n){case"object":return Array.isArray(n)?"array":"object";case"string":return n.length>100?"string":`"${n.split('"').join('\\"')}"`;default:return String(n)}}function Bu(n,e,t,r,s){let i=t.localName;if(t.repeated){if(be(t.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error(`cannot decode field ${s.typeName}.${t.name} from JSON: ${Bt(e)}`);const o=n[i];for(const a of e){if(a===null)throw new Error(`cannot decode field ${s.typeName}.${t.name} from JSON: ${Bt(a)}`);switch(t.kind){case"message":o.push(t.T.fromJson(a,r));break;case"enum":const u=ia(t.T,a,r.ignoreUnknownFields,!0);u!==zi&&o.push(u);break;case"scalar":try{o.push(Xs(t.T,a,t.L,!0))}catch(l){let f=`cannot decode field ${s.typeName}.${t.name} from JSON: ${Bt(a)}`;throw l instanceof Error&&l.message.length>0&&(f+=`: ${l.message}`),new Error(f)}break}}}else if(t.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error(`cannot decode field ${s.typeName}.${t.name} from JSON: ${Bt(e)}`);const o=n[i];for(const[a,u]of Object.entries(e)){if(u===null)throw new Error(`cannot decode field ${s.typeName}.${t.name} from JSON: map value null`);let l;try{l=Nm(t.K,a)}catch(f){let d=`cannot decode map key for field ${s.typeName}.${t.name} from JSON: ${Bt(e)}`;throw f instanceof Error&&f.message.length>0&&(d+=`: ${f.message}`),new Error(d)}switch(t.V.kind){case"message":o[l]=t.V.T.fromJson(u,r);break;case"enum":const f=ia(t.V.T,u,r.ignoreUnknownFields,!0);f!==zi&&(o[l]=f);break;case"scalar":try{o[l]=Xs(t.V.T,u,Fr.BIGINT,!0)}catch(d){let y=`cannot decode map value for field ${s.typeName}.${t.name} from JSON: ${Bt(e)}`;throw d instanceof Error&&d.message.length>0&&(y+=`: ${d.message}`),new Error(y)}break}}}else switch(t.oneof&&(n=n[t.oneof.localName]={case:i},i="value"),t.kind){case"message":const o=t.T;if(e===null&&o.typeName!="google.protobuf.Value")return;let a=n[i];Qr(a)?a.fromJson(e,r):(n[i]=a=o.fromJson(e,r),o.fieldWrapper&&!t.oneof&&(n[i]=o.fieldWrapper.unwrapField(a)));break;case"enum":const u=ia(t.T,e,r.ignoreUnknownFields,!1);switch(u){case Qi:Du(t,n);break;case zi:break;default:n[i]=u;break}break;case"scalar":try{const l=Xs(t.T,e,t.L,!1);switch(l){case Qi:Du(t,n);break;default:n[i]=l;break}}catch(l){let f=`cannot decode field ${s.typeName}.${t.name} from JSON: ${Bt(e)}`;throw l instanceof Error&&l.message.length>0&&(f+=`: ${l.message}`),new Error(f)}break}}function Nm(n,e){if(n===b.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Xs(n,e,Fr.BIGINT,!0).toString()}function Xs(n,e,t,r){if(e===null)return r?As(n,t):Qi;switch(n){case b.DOUBLE:case b.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const s=Number(e);if(Number.isNaN(s)||!Number.isFinite(s))break;return n==b.FLOAT&&Af(s),s;case b.INT32:case b.FIXED32:case b.SFIXED32:case b.SINT32:case b.UINT32:let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return n==b.UINT32||n==b.FIXED32?ka(i):Ui(i),i;case b.INT64:case b.SFIXED64:case b.SINT64:if(typeof e!="number"&&typeof e!="string")break;const o=ge.parse(e);return t?o.toString():o;case b.FIXED64:case b.UINT64:if(typeof e!="number"&&typeof e!="string")break;const a=ge.uParse(e);return t?a.toString():a;case b.BOOL:if(typeof e!="boolean")break;return e;case b.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case b.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return Ic.dec(e)}throw new Error}function ia(n,e,t,r){if(e===null)return n.typeName=="google.protobuf.NullValue"?0:r?n.values[0].no:Qi;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const s=n.findName(e);if(s!==void 0)return s.no;if(t)return zi;break}throw new Error(`cannot decode enum ${n.typeName} from JSON: ${Bt(e)}`)}function Pm(n){return n.repeated||n.kind=="map"?!0:!(n.oneof||n.kind=="message"||n.opt||n.req)}function Lu(n,e,t){if(n.kind=="map"){be(typeof e=="object"&&e!=null);const r={},s=Object.entries(e);switch(n.V.kind){case"scalar":for(const[o,a]of s)r[o.toString()]=Vi(n.V.T,a);break;case"message":for(const[o,a]of s)r[o.toString()]=a.toJson(t);break;case"enum":const i=n.V.T;for(const[o,a]of s)r[o.toString()]=oa(i,a,t.enumAsInteger);break}return t.emitDefaultValues||s.length>0?r:void 0}if(n.repeated){be(Array.isArray(e));const r=[];switch(n.kind){case"scalar":for(let s=0;s<e.length;s++)r.push(Vi(n.T,e[s]));break;case"enum":for(let s=0;s<e.length;s++)r.push(oa(n.T,e[s],t.enumAsInteger));break;case"message":for(let s=0;s<e.length;s++)r.push(e[s].toJson(t));break}return t.emitDefaultValues||r.length>0?r:void 0}switch(n.kind){case"scalar":return Vi(n.T,e);case"enum":return oa(n.T,e,t.enumAsInteger);case"message":return Jf(n.T,e).toJson(t)}}function oa(n,e,t){var r;if(be(typeof e=="number"),n.typeName=="google.protobuf.NullValue")return null;if(t)return e;const s=n.findNumber(e);return(r=s==null?void 0:s.name)!==null&&r!==void 0?r:e}function Vi(n,e){switch(n){case b.INT32:case b.SFIXED32:case b.SINT32:case b.FIXED32:case b.UINT32:return be(typeof e=="number"),e;case b.FLOAT:case b.DOUBLE:return be(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case b.STRING:return be(typeof e=="string"),e;case b.BOOL:return be(typeof e=="boolean"),e;case b.UINT64:case b.FIXED64:case b.INT64:case b.SFIXED64:case b.SINT64:return be(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case b.BYTES:return be(e instanceof Uint8Array),Ic.enc(e)}}const as=Symbol("@bufbuild/protobuf/unknown-fields"),Ju={readUnknownFields:!0,readerFactory:n=>new wm(n)},Fu={writeUnknownFields:!0,writerFactory:()=>new vm};function Cm(n){return n?Object.assign(Object.assign({},Ju),n):Ju}function Dm(n){return n?Object.assign(Object.assign({},Fu),n):Fu}function Om(){return{makeReadOptions:Cm,makeWriteOptions:Dm,listUnknownFields(n){var e;return(e=n[as])!==null&&e!==void 0?e:[]},discardUnknownFields(n){delete n[as]},writeUnknownFields(n,e){const r=n[as];if(r)for(const s of r)e.tag(s.no,s.wireType).raw(s.data)},onUnknownField(n,e,t,r){const s=n;Array.isArray(s[as])||(s[as]=[]),s[as].push({no:e,wireType:t,data:r})},readMessage(n,e,t,r,s){const i=n.getType(),o=s?e.len:e.pos+t;let a,u;for(;e.pos<o&&([a,u]=e.tag(),!(s===!0&&u==Se.EndGroup));){const l=i.fields.find(a);if(!l){const f=e.skip(u,a);r.readUnknownFields&&this.onUnknownField(n,a,u,f);continue}$u(n,e,l,u,r)}if(s&&(u!=Se.EndGroup||a!==t))throw new Error("invalid end group tag")},readField:$u,writeMessage(n,e,t){const r=n.getType();for(const s of r.fields.byNumber()){if(!Lf(s,n)){if(s.req)throw new Error(`cannot encode field ${r.typeName}.${s.name} to binary: required field not set`);continue}const i=s.oneof?n[s.oneof.localName].value:n[s.localName];Mu(s,i,e,t)}return t.writeUnknownFields&&this.writeUnknownFields(n,e),e},writeField(n,e,t,r){e!==void 0&&Mu(n,e,t,r)}}}function $u(n,e,t,r,s){let{repeated:i,localName:o}=t;switch(t.oneof&&(n=n[t.oneof.localName],n.case!=o&&delete n.value,n.case=o,o="value"),t.kind){case"scalar":case"enum":const a=t.kind=="enum"?b.INT32:t.T;let u=eo;if(t.kind=="scalar"&&t.L>0&&(u=Bm),i){let y=n[o];if(r==Se.LengthDelimited&&a!=b.STRING&&a!=b.BYTES){let S=e.uint32()+e.pos;for(;e.pos<S;)y.push(u(e,a))}else y.push(u(e,a))}else n[o]=u(e,a);break;case"message":const l=t.T;i?n[o].push(Ki(e,new l,s,t)):Qr(n[o])?Ki(e,n[o],s,t):(n[o]=Ki(e,new l,s,t),l.fieldWrapper&&!t.oneof&&!t.repeated&&(n[o]=l.fieldWrapper.unwrapField(n[o])));break;case"map":let[f,d]=Rm(t,e,s);n[o][f]=d;break}}function Ki(n,e,t,r){const s=e.getType().runtime.bin,i=r==null?void 0:r.delimited;return s.readMessage(e,n,i?r.no:n.uint32(),t,i),e}function Rm(n,e,t){const r=e.uint32(),s=e.pos+r;let i,o;for(;e.pos<s;){const[a]=e.tag();switch(a){case 1:i=eo(e,n.K);break;case 2:switch(n.V.kind){case"scalar":o=eo(e,n.V.T);break;case"enum":o=e.int32();break;case"message":o=Ki(e,new n.V.T,t,void 0);break}break}}if(i===void 0&&(i=As(n.K,Fr.BIGINT)),typeof i!="string"&&typeof i!="number"&&(i=i.toString()),o===void 0)switch(n.V.kind){case"scalar":o=As(n.V.T,Fr.BIGINT);break;case"enum":o=n.V.T.values[0].no;break;case"message":o=new n.V.T;break}return[i,o]}function Bm(n,e){const t=eo(n,e);return typeof t=="bigint"?t.toString():t}function eo(n,e){switch(e){case b.STRING:return n.string();case b.BOOL:return n.bool();case b.DOUBLE:return n.double();case b.FLOAT:return n.float();case b.INT32:return n.int32();case b.INT64:return n.int64();case b.UINT64:return n.uint64();case b.FIXED64:return n.fixed64();case b.BYTES:return n.bytes();case b.FIXED32:return n.fixed32();case b.SFIXED32:return n.sfixed32();case b.SFIXED64:return n.sfixed64();case b.SINT64:return n.sint64();case b.UINT32:return n.uint32();case b.SINT32:return n.sint32()}}function Mu(n,e,t,r){be(e!==void 0);const s=n.repeated;switch(n.kind){case"scalar":case"enum":let i=n.kind=="enum"?b.INT32:n.T;if(s)if(be(Array.isArray(e)),n.packed)Jm(t,i,n.no,e);else for(const o of e)Zs(t,i,n.no,o);else Zs(t,i,n.no,e);break;case"message":if(s){be(Array.isArray(e));for(const o of e)Uu(t,r,n,o)}else Uu(t,r,n,e);break;case"map":be(typeof e=="object"&&e!=null);for(const[o,a]of Object.entries(e))Lm(t,r,n,o,a);break}}function Lm(n,e,t,r,s){n.tag(t.no,Se.LengthDelimited),n.fork();let i=r;switch(t.K){case b.INT32:case b.FIXED32:case b.UINT32:case b.SFIXED32:case b.SINT32:i=Number.parseInt(r);break;case b.BOOL:be(r=="true"||r=="false"),i=r=="true";break}switch(Zs(n,t.K,1,i),t.V.kind){case"scalar":Zs(n,t.V.T,2,s);break;case"enum":Zs(n,b.INT32,2,s);break;case"message":be(s!==void 0),n.tag(2,Se.LengthDelimited).bytes(s.toBinary(e));break}n.join()}function Uu(n,e,t,r){const s=Jf(t.T,r);t.delimited?n.tag(t.no,Se.StartGroup).raw(s.toBinary(e)).tag(t.no,Se.EndGroup):n.tag(t.no,Se.LengthDelimited).bytes(s.toBinary(e))}function Zs(n,e,t,r){be(r!==void 0);let[s,i]=Ff(e);n.tag(t,s)[i](r)}function Jm(n,e,t,r){if(!r.length)return;n.tag(t,Se.LengthDelimited).fork();let[,s]=Ff(e);for(let i=0;i<r.length;i++)n[s](r[i]);n.join()}function Ff(n){let e=Se.Varint;switch(n){case b.BYTES:case b.STRING:e=Se.LengthDelimited;break;case b.DOUBLE:case b.FIXED64:case b.SFIXED64:e=Se.Bit64;break;case b.FIXED32:case b.SFIXED32:case b.FLOAT:e=Se.Bit32;break}const t=b[n].toLowerCase();return[e,t]}function Fm(){return{setEnumType:kf,initPartial(n,e){if(n===void 0)return;const t=e.getType();for(const r of t.fields.byMember()){const s=r.localName,i=e,o=n;if(o[s]!=null)switch(r.kind){case"oneof":const a=o[s].case;if(a===void 0)continue;const u=r.findField(a);let l=o[s].value;u&&u.kind=="message"&&!Qr(l,u.T)?l=new u.T(l):u&&u.kind==="scalar"&&u.T===b.BYTES&&(l=Us(l)),i[s]={case:a,value:l};break;case"scalar":case"enum":let f=o[s];r.T===b.BYTES&&(f=r.repeated?f.map(Us):Us(f)),i[s]=f;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===b.BYTES)for(const[m,S]of Object.entries(o[s]))i[s][m]=Us(S);else Object.assign(i[s],o[s]);break;case"message":const y=r.V.T;for(const m of Object.keys(o[s])){let S=o[s][m];y.fieldWrapper||(S=new y(S)),i[s][m]=S}break}break;case"message":const d=r.T;if(r.repeated)i[s]=o[s].map(y=>Qr(y,d)?y:new d(y));else{const y=o[s];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?i[s]=Us(y):i[s]=y:i[s]=Qr(y,d)?y:new d(y)}break}}},equals(n,e,t){return e===t?!0:!e||!t?!1:n.fields.byMember().every(r=>{const s=e[r.localName],i=t[r.localName];if(r.repeated){if(s.length!==i.length)return!1;switch(r.kind){case"message":return s.every((o,a)=>r.T.equals(o,i[a]));case"scalar":return s.every((o,a)=>xr(r.T,o,i[a]));case"enum":return s.every((o,a)=>xr(b.INT32,o,i[a]))}throw new Error(`repeated cannot contain ${r.kind}`)}switch(r.kind){case"message":return r.T.equals(s,i);case"enum":return xr(b.INT32,s,i);case"scalar":return xr(r.T,s,i);case"oneof":if(s.case!==i.case)return!1;const o=r.findField(s.case);if(o===void 0)return!0;switch(o.kind){case"message":return o.T.equals(s.value,i.value);case"enum":return xr(b.INT32,s.value,i.value);case"scalar":return xr(o.T,s.value,i.value)}throw new Error(`oneof cannot contain ${o.kind}`);case"map":const a=Object.keys(s).concat(Object.keys(i));switch(r.V.kind){case"message":const u=r.V.T;return a.every(f=>u.equals(s[f],i[f]));case"enum":return a.every(f=>xr(b.INT32,s[f],i[f]));case"scalar":const l=r.V.T;return a.every(f=>xr(l,s[f],i[f]))}break}})},clone(n){const e=n.getType(),t=new e,r=t;for(const s of e.fields.byMember()){const i=n[s.localName];let o;if(s.repeated)o=i.map(Di);else if(s.kind=="map"){o=r[s.localName];for(const[a,u]of Object.entries(i))o[a]=Di(u)}else s.kind=="oneof"?o=s.findField(i.case)?{case:i.case,value:Di(i.value)}:{case:void 0}:o=Di(i);r[s.localName]=o}for(const s of e.runtime.bin.listUnknownFields(n))e.runtime.bin.onUnknownField(r,s.no,s.wireType,s.data);return t}}}function Di(n){if(n===void 0)return n;if(Qr(n))return n.clone();if(n instanceof Uint8Array){const e=new Uint8Array(n.byteLength);return e.set(n),e}return n}function Us(n){return n instanceof Uint8Array?n:new Uint8Array(n)}function $m(n,e,t){return{syntax:n,json:Em(),bin:Om(),util:Object.assign(Object.assign({},Fm()),{newFieldList:e,initFields:t}),makeMessageType(r,s,i){return hm(this,r,s,i)},makeEnum:fm,makeEnumType:Ef,getEnumType:lm,makeExtension(r,s,i){return bm(this,r,s,i)}}}class Mm{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const t={};for(const r of this.list())t[r.jsonName]=t[r.name]=r;this.jsonNames=t}return this.jsonNames[e]}find(e){if(!this.numbers){const t={};for(const r of this.list())t[r.no]=r;this.numbers=t}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const r of this.list())r.oneof?r.oneof!==t&&(t=r.oneof,e.push(t)):e.push(r)}return this.members}}function $f(n,e){const t=Mf(n);return e?t:jm(Km(t))}function Um(n){return $f(n,!1)}const qm=Mf;function Mf(n){let e=!1;const t=[];for(let r=0;r<n.length;r++){let s=n.charAt(r);switch(s){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t.push(s),e=!1;break;default:e&&(e=!1,s=s.toUpperCase()),t.push(s);break}}return t.join("")}const zm=new Set(["constructor","toString","toJSON","valueOf"]),Vm=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Uf=n=>`${n}$`,Km=n=>Vm.has(n)?Uf(n):n,jm=n=>zm.has(n)?Uf(n):n;class Hm{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=Um(e)}addField(e){be(e.oneof===this,`field ${e.name} not one of ${this.name}`),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}function Wm(n,e){var t,r,s,i,o,a;const u=[];let l;for(const f of typeof n=="function"?n():n){const d=f;if(d.localName=$f(f.name,f.oneof!==void 0),d.jsonName=(t=f.jsonName)!==null&&t!==void 0?t:qm(f.name),d.repeated=(r=f.repeated)!==null&&r!==void 0?r:!1,f.kind=="scalar"&&(d.L=(s=f.L)!==null&&s!==void 0?s:Fr.BIGINT),d.delimited=(i=f.delimited)!==null&&i!==void 0?i:!1,d.req=(o=f.req)!==null&&o!==void 0?o:!1,d.opt=(a=f.opt)!==null&&a!==void 0?a:!1,f.packed===void 0&&(d.packed=f.kind=="enum"||f.kind=="scalar"&&f.T!=b.BYTES&&f.T!=b.STRING),f.oneof!==void 0){const y=typeof f.oneof=="string"?f.oneof:f.oneof.name;(!l||l.name!=y)&&(l=new Hm(y)),d.oneof=l,l.addField(d)}u.push(d)}return u}const h=$m("proto3",n=>new Mm(n,e=>Wm(e)),n=>{for(const e of n.getType().fields.byMember()){if(e.opt)continue;const t=e.localName,r=n;if(e.repeated){r[t]=[];continue}switch(e.kind){case"oneof":r[t]={case:void 0};break;case"enum":r[t]=0;break;case"map":r[t]={};break;case"scalar":r[t]=As(e.T,e.L);break}}});var Le;(function(n){n[n.Unary=0]="Unary",n[n.ServerStreaming=1]="ServerStreaming",n[n.ClientStreaming=2]="ClientStreaming",n[n.BiDiStreaming=3]="BiDiStreaming"})(Le||(Le={}));var qu;(function(n){n[n.NoSideEffects=1]="NoSideEffects",n[n.Idempotent=2]="Idempotent"})(qu||(qu={}));class ke extends P{constructor(e){super(),this.seconds=ge.zero,this.nanos=0,h.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error(`cannot decode google.protobuf.Timestamp from JSON: ${h.json.debug(e)}`);const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const s=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(s))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(s<Date.parse("0001-01-01T00:00:00Z")||s>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=ge.parse(s/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const t=Number(this.seconds)*1e3;if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const s=(this.nanos+1e9).toString().substring(1);s.substring(3)==="000000"?r="."+s.substring(0,3)+"Z":s.substring(6)==="000"?r="."+s.substring(0,6)+"Z":r="."+s+"Z"}return new Date(t).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return ke.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new ke({seconds:ge.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new ke().fromBinary(e,t)}static fromJson(e,t){return new ke().fromJson(e,t)}static fromJsonString(e,t){return new ke().fromJsonString(e,t)}static equals(e,t){return h.util.equals(ke,e,t)}}ke.runtime=h;ke.typeName="google.protobuf.Timestamp";ke.fields=h.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);class gr extends P{constructor(e){super(),this.seconds=ge.zero,this.nanos=0,h.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error(`cannot decode google.protobuf.Duration from JSON: ${h.json.debug(e)}`);const r=e.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(r===null)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${h.json.debug(e)}`);const s=Number(r[1]);if(s>315576e6||s<-315576e6)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${h.json.debug(e)}`);if(this.seconds=ge.parse(s),typeof r[2]=="string"){const i=r[2]+"0".repeat(9-r[2].length);this.nanos=parseInt(i),(s<0||Object.is(s,-0))&&(this.nanos=-this.nanos)}return this}toJson(e){if(Number(this.seconds)>315576e6||Number(this.seconds)<-315576e6)throw new Error("cannot encode google.protobuf.Duration to JSON: value out of range");let t=this.seconds.toString();if(this.nanos!==0){let r=Math.abs(this.nanos).toString();r="0".repeat(9-r.length)+r,r.substring(3)==="000000"?r=r.substring(0,3):r.substring(6)==="000"&&(r=r.substring(0,6)),t+="."+r,this.nanos<0&&Number(this.seconds)==0&&(t="-"+t)}return t+"s"}static fromBinary(e,t){return new gr().fromBinary(e,t)}static fromJson(e,t){return new gr().fromJson(e,t)}static fromJsonString(e,t){return new gr().fromJsonString(e,t)}static equals(e,t){return h.util.equals(gr,e,t)}}gr.runtime=h;gr.typeName="google.protobuf.Duration";gr.fields=h.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);class Jt extends P{constructor(e){super(),this.typeUrl="",this.value=new Uint8Array(0),h.util.initPartial(e,this)}toJson(e){var t;if(this.typeUrl==="")return{};const r=this.typeUrlToName(this.typeUrl),s=(t=e==null?void 0:e.typeRegistry)===null||t===void 0?void 0:t.findMessage(r);if(!s)throw new Error(`cannot encode message google.protobuf.Any to JSON: "${this.typeUrl}" is not in the type registry`);let o=s.fromBinary(this.value).toJson(e);return(r.startsWith("google.protobuf.")||o===null||Array.isArray(o)||typeof o!="object")&&(o={value:o}),o["@type"]=this.typeUrl,o}fromJson(e,t){var r;if(e===null||Array.isArray(e)||typeof e!="object")throw new Error(`cannot decode message google.protobuf.Any from JSON: expected object but got ${e===null?"null":Array.isArray(e)?"array":typeof e}`);if(Object.keys(e).length==0)return this;const s=e["@type"];if(typeof s!="string"||s=="")throw new Error('cannot decode message google.protobuf.Any from JSON: "@type" is empty');const i=this.typeUrlToName(s),o=(r=t==null?void 0:t.typeRegistry)===null||r===void 0?void 0:r.findMessage(i);if(!o)throw new Error(`cannot decode message google.protobuf.Any from JSON: ${s} is not in the type registry`);let a;if(i.startsWith("google.protobuf.")&&Object.prototype.hasOwnProperty.call(e,"value"))a=o.fromJson(e.value,t);else{const u=Object.assign({},e);delete u["@type"],a=o.fromJson(u,t)}return this.packFrom(a),this}packFrom(e){this.value=e.toBinary(),this.typeUrl=this.typeNameToUrl(e.getType().typeName)}unpackTo(e){return this.is(e.getType())?(e.fromBinary(this.value),!0):!1}unpack(e){if(this.typeUrl==="")return;const t=e.findMessage(this.typeUrlToName(this.typeUrl));if(t)return t.fromBinary(this.value)}is(e){if(this.typeUrl==="")return!1;const t=this.typeUrlToName(this.typeUrl);let r="";return typeof e=="string"?r=e:r=e.typeName,t===r}typeNameToUrl(e){return`type.googleapis.com/${e}`}typeUrlToName(e){if(!e.length)throw new Error(`invalid type url: ${e}`);const t=e.lastIndexOf("/"),r=t>=0?e.substring(t+1):e;if(!r.length)throw new Error(`invalid type url: ${e}`);return r}static pack(e){const t=new Jt;return t.packFrom(e),t}static fromBinary(e,t){return new Jt().fromBinary(e,t)}static fromJson(e,t){return new Jt().fromJson(e,t)}static fromJsonString(e,t){return new Jt().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Jt,e,t)}}Jt.runtime=h;Jt.typeName="google.protobuf.Any";Jt.fields=h.util.newFieldList(()=>[{no:1,name:"type_url",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:12}]);class Ft extends P{constructor(e){super(),this.value=0,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(b.DOUBLE,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(b.DOUBLE,e)}catch(r){let s='cannot decode message google.protobuf.DoubleValue from JSON"';throw r instanceof Error&&r.message.length>0&&(s+=`: ${r.message}`),new Error(s)}return this}static fromBinary(e,t){return new Ft().fromBinary(e,t)}static fromJson(e,t){return new Ft().fromJson(e,t)}static fromJsonString(e,t){return new Ft().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Ft,e,t)}}Ft.runtime=h;Ft.typeName="google.protobuf.DoubleValue";Ft.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:1}]);Ft.fieldWrapper={wrapField(n){return new Ft({value:n})},unwrapField(n){return n.value}};class $t extends P{constructor(e){super(),this.value=0,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(b.FLOAT,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(b.FLOAT,e)}catch(r){let s='cannot decode message google.protobuf.FloatValue from JSON"';throw r instanceof Error&&r.message.length>0&&(s+=`: ${r.message}`),new Error(s)}return this}static fromBinary(e,t){return new $t().fromBinary(e,t)}static fromJson(e,t){return new $t().fromJson(e,t)}static fromJsonString(e,t){return new $t().fromJsonString(e,t)}static equals(e,t){return h.util.equals($t,e,t)}}$t.runtime=h;$t.typeName="google.protobuf.FloatValue";$t.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:2}]);$t.fieldWrapper={wrapField(n){return new $t({value:n})},unwrapField(n){return n.value}};class Mt extends P{constructor(e){super(),this.value=ge.zero,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(b.INT64,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(b.INT64,e)}catch(r){let s='cannot decode message google.protobuf.Int64Value from JSON"';throw r instanceof Error&&r.message.length>0&&(s+=`: ${r.message}`),new Error(s)}return this}static fromBinary(e,t){return new Mt().fromBinary(e,t)}static fromJson(e,t){return new Mt().fromJson(e,t)}static fromJsonString(e,t){return new Mt().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Mt,e,t)}}Mt.runtime=h;Mt.typeName="google.protobuf.Int64Value";Mt.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:3}]);Mt.fieldWrapper={wrapField(n){return new Mt({value:n})},unwrapField(n){return n.value}};class Ut extends P{constructor(e){super(),this.value=ge.zero,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(b.UINT64,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(b.UINT64,e)}catch(r){let s='cannot decode message google.protobuf.UInt64Value from JSON"';throw r instanceof Error&&r.message.length>0&&(s+=`: ${r.message}`),new Error(s)}return this}static fromBinary(e,t){return new Ut().fromBinary(e,t)}static fromJson(e,t){return new Ut().fromJson(e,t)}static fromJsonString(e,t){return new Ut().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Ut,e,t)}}Ut.runtime=h;Ut.typeName="google.protobuf.UInt64Value";Ut.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:4}]);Ut.fieldWrapper={wrapField(n){return new Ut({value:n})},unwrapField(n){return n.value}};class Qe extends P{constructor(e){super(),this.value=0,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(b.INT32,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(b.INT32,e)}catch(r){let s='cannot decode message google.protobuf.Int32Value from JSON"';throw r instanceof Error&&r.message.length>0&&(s+=`: ${r.message}`),new Error(s)}return this}static fromBinary(e,t){return new Qe().fromBinary(e,t)}static fromJson(e,t){return new Qe().fromJson(e,t)}static fromJsonString(e,t){return new Qe().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Qe,e,t)}}Qe.runtime=h;Qe.typeName="google.protobuf.Int32Value";Qe.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:5}]);Qe.fieldWrapper={wrapField(n){return new Qe({value:n})},unwrapField(n){return n.value}};class qt extends P{constructor(e){super(),this.value=0,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(b.UINT32,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(b.UINT32,e)}catch(r){let s='cannot decode message google.protobuf.UInt32Value from JSON"';throw r instanceof Error&&r.message.length>0&&(s+=`: ${r.message}`),new Error(s)}return this}static fromBinary(e,t){return new qt().fromBinary(e,t)}static fromJson(e,t){return new qt().fromJson(e,t)}static fromJsonString(e,t){return new qt().fromJsonString(e,t)}static equals(e,t){return h.util.equals(qt,e,t)}}qt.runtime=h;qt.typeName="google.protobuf.UInt32Value";qt.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:13}]);qt.fieldWrapper={wrapField(n){return new qt({value:n})},unwrapField(n){return n.value}};class zt extends P{constructor(e){super(),this.value=!1,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(b.BOOL,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(b.BOOL,e)}catch(r){let s='cannot decode message google.protobuf.BoolValue from JSON"';throw r instanceof Error&&r.message.length>0&&(s+=`: ${r.message}`),new Error(s)}return this}static fromBinary(e,t){return new zt().fromBinary(e,t)}static fromJson(e,t){return new zt().fromJson(e,t)}static fromJsonString(e,t){return new zt().fromJsonString(e,t)}static equals(e,t){return h.util.equals(zt,e,t)}}zt.runtime=h;zt.typeName="google.protobuf.BoolValue";zt.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:8}]);zt.fieldWrapper={wrapField(n){return new zt({value:n})},unwrapField(n){return n.value}};class Ke extends P{constructor(e){super(),this.value="",h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(b.STRING,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(b.STRING,e)}catch(r){let s='cannot decode message google.protobuf.StringValue from JSON"';throw r instanceof Error&&r.message.length>0&&(s+=`: ${r.message}`),new Error(s)}return this}static fromBinary(e,t){return new Ke().fromBinary(e,t)}static fromJson(e,t){return new Ke().fromJson(e,t)}static fromJsonString(e,t){return new Ke().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Ke,e,t)}}Ke.runtime=h;Ke.typeName="google.protobuf.StringValue";Ke.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:9}]);Ke.fieldWrapper={wrapField(n){return new Ke({value:n})},unwrapField(n){return n.value}};class Vt extends P{constructor(e){super(),this.value=new Uint8Array(0),h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(b.BYTES,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(b.BYTES,e)}catch(r){let s='cannot decode message google.protobuf.BytesValue from JSON"';throw r instanceof Error&&r.message.length>0&&(s+=`: ${r.message}`),new Error(s)}return this}static fromBinary(e,t){return new Vt().fromBinary(e,t)}static fromJson(e,t){return new Vt().fromJson(e,t)}static fromJsonString(e,t){return new Vt().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Vt,e,t)}}Vt.runtime=h;Vt.typeName="google.protobuf.BytesValue";Vt.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:12}]);Vt.fieldWrapper={wrapField(n){return new Vt({value:n})},unwrapField(n){return n.value}};function Gm(n,e,t){try{const r=Ic.dec(n);return e?e.fromBinary(r,t):r}catch(r){throw re.from(r,X.DataLoss)}}function _m(n,e){const t={};for(const[r,s]of Object.entries(n.methods)){const i=e(Object.assign(Object.assign({},s),{localName:r,service:n}));i!=null&&(t[r]=i)}return t}const zu=1;function Vu(n){let e,t=new Uint8Array(0);function r(s){const i=new Uint8Array(t.length+s.length);i.set(t),i.set(s,t.length),t=i}return new ReadableStream({start(){e=n.getReader()},async pull(s){let i;for(;;){if(i===void 0&&t.byteLength>=5){let u=0;for(let l=1;l<5;l++)u=(u<<8)+t[l];i={flags:t[0],length:u}}if(i!==void 0&&t.byteLength>=i.length+5)break;const a=await e.read();if(a.done)break;r(a.value)}if(i===void 0){if(t.byteLength==0){s.close();return}s.error(new re("premature end of stream",X.DataLoss));return}const o=t.subarray(5,5+i.length);t=t.subarray(5+i.length),s.enqueue({flags:i.flags,data:o})}})}function Ku(n,e){const t=new Uint8Array(e.length+5);t.set(e,5);const r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.setUint8(0,n),r.setUint32(1,e.length),t}var Ym=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=n[i]&&function(o){return new Promise(function(a,u){o=n[i](o),s(a,u,o.done,o.value)})}}function s(i,o,a,u){Promise.resolve(u).then(function(l){i({value:l,done:a})},o)}},ci=function(n){return this instanceof ci?(this.v=n,this):new ci(n)},Xm=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,i=[];return s={},a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(S){return Promise.resolve(S).then(m,d)}}function a(m,S){r[m]&&(s[m]=function(I){return new Promise(function(C,R){i.push([m,I,C,R])>1||u(m,I)})},S&&(s[m]=S(s[m])))}function u(m,S){try{l(r[m](S))}catch(I){y(i[0][3],I)}}function l(m){m.value instanceof ci?Promise.resolve(m.value.v).then(f,d):y(i[0][2],m)}function f(m){u("next",m)}function d(m){u("throw",m)}function y(m,S){m(S),i.shift(),i.length&&u(i[0][0],i[0][1])}},Zm=function(n){var e,t;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=n[s]?function(o){return(t=!t)?{value:ci(n[s](o)),done:!1}:i?i(o):o}:i}};function Qm(n){return Xm(this,arguments,function*(){yield ci(yield*Zm(Ym(n)))})}var qf=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=n[i]&&function(o){return new Promise(function(a,u){o=n[i](o),s(a,u,o.done,o.value)})}}function s(i,o,a,u){Promise.resolve(u).then(function(l){i({value:l,done:a})},o)}},xs=function(n){return this instanceof xs?(this.v=n,this):new xs(n)},ep=function(n){var e,t;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=n[s]?function(o){return(t=!t)?{value:xs(n[s](o)),done:!1}:i?i(o):o}:i}},tp=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,i=[];return s={},a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(S){return Promise.resolve(S).then(m,d)}}function a(m,S){r[m]&&(s[m]=function(I){return new Promise(function(C,R){i.push([m,I,C,R])>1||u(m,I)})},S&&(s[m]=S(s[m])))}function u(m,S){try{l(r[m](S))}catch(I){y(i[0][3],I)}}function l(m){m.value instanceof xs?Promise.resolve(m.value.v).then(f,d):y(i[0][2],m)}function f(m){u("next",m)}function d(m){u("throw",m)}function y(m,S){m(S),i.shift(),i.length&&u(i[0][0],i[0][1])}};function np(n,e){return _m(n,t=>{switch(t.kind){case Le.Unary:return rp(e,n,t);case Le.ServerStreaming:return sp(e,n,t);case Le.ClientStreaming:return ip(e,n,t);case Le.BiDiStreaming:return op(e,n,t);default:return null}})}function rp(n,e,t){return async function(r,s){var i,o;const a=await n.unary(e,t,s==null?void 0:s.signal,s==null?void 0:s.timeoutMs,s==null?void 0:s.headers,r,s==null?void 0:s.contextValues);return(i=s==null?void 0:s.onHeader)===null||i===void 0||i.call(s,a.header),(o=s==null?void 0:s.onTrailer)===null||o===void 0||o.call(s,a.trailer),a.message}}function sp(n,e,t){return function(r,s){return zf(n.stream(e,t,s==null?void 0:s.signal,s==null?void 0:s.timeoutMs,s==null?void 0:s.headers,Qm([r]),s==null?void 0:s.contextValues),s)}}function ip(n,e,t){return async function(r,s){var i,o,a,u,l,f;const d=await n.stream(e,t,s==null?void 0:s.signal,s==null?void 0:s.timeoutMs,s==null?void 0:s.headers,r,s==null?void 0:s.contextValues);(l=s==null?void 0:s.onHeader)===null||l===void 0||l.call(s,d.header);let y,m=0;try{for(var S=!0,I=qf(d.message),C;C=await I.next(),i=C.done,!i;S=!0)u=C.value,S=!1,y=u,m++}catch(R){o={error:R}}finally{try{!S&&!i&&(a=I.return)&&await a.call(I)}finally{if(o)throw o.error}}if(!y)throw new re("protocol error: missing response message",X.Unimplemented);if(m>1)throw new re("protocol error: received extra messages for client streaming method",X.Unimplemented);return(f=s==null?void 0:s.onTrailer)===null||f===void 0||f.call(s,d.trailer),y}}function op(n,e,t){return function(r,s){return zf(n.stream(e,t,s==null?void 0:s.signal,s==null?void 0:s.timeoutMs,s==null?void 0:s.headers,r,s==null?void 0:s.contextValues),s)}}function zf(n,e){const t=function(){return tp(this,arguments,function*(){var r,s;const i=yield xs(n);(r=e==null?void 0:e.onHeader)===null||r===void 0||r.call(e,i.header),yield xs(yield*ep(qf(i.message))),(s=e==null?void 0:e.onTrailer)===null||s===void 0||s.call(e,i.trailer)})}()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>t.next()})}}function ap(...n){const e=new AbortController,t=n.filter(s=>s!==void 0).concat(e.signal);for(const s of t){if(s.aborted){r.apply(s);break}s.addEventListener("abort",r)}function r(){e.signal.aborted||e.abort(Vf(this));for(const s of t)s.removeEventListener("abort",r)}return e}function cp(n){const e=new AbortController,t=()=>{e.abort(new re("the operation timed out",X.DeadlineExceeded))};let r;return n!==void 0&&(n<=0?t():r=setTimeout(t,n)),{signal:e.signal,cleanup:()=>clearTimeout(r)}}function Vf(n){if(!n.aborted)return;if(n.reason!==void 0)return n.reason;const e=new Error("This operation was aborted");return e.name="AbortError",e}function ju(){return{get(n){return n.id in this?this[n.id]:n.defaultValue},set(n,e){return this[n.id]=e,this},delete(n){return delete this[n.id],this}}}const aa=128;function Hu(n){const e=new Headers,t=new TextDecoder().decode(n).split(`\r
`);for(const r of t){if(r==="")continue;const s=r.indexOf(":");if(s>0){const i=r.substring(0,s).trim(),o=r.substring(s+1).trim();e.append(i,o)}}return e}const up="Content-Type",lp="Grpc-Timeout",ks="Grpc-Status",Kf="Grpc-Message",fp="Grpc-Status-Details-Bin",hp="X-User-Agent",dp="X-Grpc-Web",gp="application/grpc-web+proto",mp="application/grpc-web+json";class mr extends P{constructor(e){super(),this.code=0,this.message="",this.details=[],h.util.initPartial(e,this)}static fromBinary(e,t){return new mr().fromBinary(e,t)}static fromJson(e,t){return new mr().fromJson(e,t)}static fromJsonString(e,t){return new mr().fromJsonString(e,t)}static equals(e,t){return h.util.equals(mr,e,t)}}mr.runtime=h;mr.typeName="google.rpc.Status";mr.fields=h.util.newFieldList(()=>[{no:1,name:"code",kind:"scalar",T:5},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"details",kind:"message",T:Jt,repeated:!0}]);const pp="0";function jf(n){var e;const t=n.get(fp);if(t!=null){const s=Gm(t,mr);if(s.code==0)return;const i=new re(s.message,s.code,n);return i.details=s.details.map(o=>({type:o.typeUrl.substring(o.typeUrl.lastIndexOf("/")+1),value:o.value})),i}const r=n.get(ks);if(r!=null){if(r===pp)return;const s=parseInt(r,10);return s in X?new re(decodeURIComponent((e=n.get(Kf))!==null&&e!==void 0?e:""),s,n):new re(`invalid grpc-status: ${r}`,X.Internal,n)}}function Wu(n,e,t){const r=typeof e=="string"?e:e.typeName,s=typeof t=="string"?t:t.name;return n.toString().replace(/\/?$/,`/${r}/${s}`)}function Hf(n,e){return e instanceof n?e:new n(e)}function yp(n,e){function t(r){return r.done===!0?r:{done:r.done,value:Hf(n,r.value)}}return{[Symbol.asyncIterator](){const r=e[Symbol.asyncIterator](),s={next:()=>r.next().then(t)};return r.throw!==void 0&&(s.throw=i=>r.throw(i).then(t)),r.return!==void 0&&(s.return=i=>r.return(i).then(t)),s}}}function Wf(n,e){var t;return(t=e==null?void 0:e.concat().reverse().reduce((r,s)=>s(r),n))!==null&&t!==void 0?t:n}function vp(n){var e;const t=Object.assign({},n);return(e=t.ignoreUnknownFields)!==null&&e!==void 0||(t.ignoreUnknownFields=!0),t}function Gu(n,e,t,r){const s=e?_u(n.I,r):Yu(n.I,t);return{parse:(e?_u(n.O,r):Yu(n.O,t)).parse,serialize:s.serialize}}function _u(n,e){return{parse(t){try{return n.fromBinary(t,e)}catch(r){const s=r instanceof Error?r.message:String(r);throw new re(`parse binary: ${s}`,X.Internal)}},serialize(t){try{return t.toBinary(e)}catch(r){const s=r instanceof Error?r.message:String(r);throw new re(`serialize binary: ${s}`,X.Internal)}}}}function Yu(n,e){var t,r;const s=(t=e==null?void 0:e.textEncoder)!==null&&t!==void 0?t:new TextEncoder,i=(r=e==null?void 0:e.textDecoder)!==null&&r!==void 0?r:new TextDecoder,o=vp(e);return{parse(a){try{const u=i.decode(a);return n.fromJsonString(u,o)}catch(u){throw re.from(u,X.InvalidArgument)}},serialize(a){try{const u=a.toJsonString(o);return s.encode(u)}catch(u){throw re.from(u,X.Internal)}}}}function wp(n){const e=Wf(n.next,n.interceptors),[t,r,s]=Gf(n),i=Object.assign(Object.assign({},n.req),{message:Hf(n.req.method.I,n.req.message),signal:t});return e(i).then(o=>(s(),o),r)}function bp(n){const e=Wf(n.next,n.interceptors),[t,r,s]=Gf(n),i=Object.assign(Object.assign({},n.req),{message:yp(n.req.method.I,n.req.message),signal:t});let o=!1;return t.addEventListener("abort",function(){var a,u;const l=n.req.message[Symbol.asyncIterator]();o||(a=l.throw)===null||a===void 0||a.call(l,this.reason).catch(()=>{}),(u=l.return)===null||u===void 0||u.call(l).catch(()=>{})}),e(i).then(a=>Object.assign(Object.assign({},a),{message:{[Symbol.asyncIterator](){const u=a.message[Symbol.asyncIterator]();return{next(){return u.next().then(l=>(l.done==!0&&(o=!0,s()),l),r)}}}}}),r)}function Gf(n){const{signal:e,cleanup:t}=cp(n.timeoutMs),r=ap(n.signal,e);return[r.signal,function(i){const o=re.from(e.aborted?Vf(e):i);return r.abort(o),t(),Promise.reject(o)},function(){t(),r.abort()}]}function Tp(){try{new Headers}catch{throw new Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}}function Xu(n,e){const t=jf(n);if(t)throw e.forEach((r,s)=>{t.metadata.append(s,r)}),t;if(!e.has(ks)&&!n.has(ks))throw new re("protocol error: missing status",X.Internal)}function Zu(n,e,t,r){const s=new Headers(t??{});return s.set(up,n?gp:mp),s.set(dp,"1"),s.set(hp,"connect-es/1.6.1"),e!==void 0&&s.set(lp,`${e}m`),s}function Sp(n){switch(n){case 400:return X.Internal;case 401:return X.Unauthenticated;case 403:return X.PermissionDenied;case 404:return X.Unimplemented;case 429:return X.Unavailable;case 502:return X.Unavailable;case 503:return X.Unavailable;case 504:return X.Unavailable;default:return X.Unknown}}function Qu(n,e){var t;if(n>=200&&n<300)return{foundStatus:e.has(ks),headerError:jf(e)};throw new re(decodeURIComponent((t=e.get(Kf))!==null&&t!==void 0?t:`HTTP ${n}`),Sp(n),e)}var _r=function(n){return this instanceof _r?(this.v=n,this):new _r(n)},Ip=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,i=[];return s={},a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(S){return Promise.resolve(S).then(m,d)}}function a(m,S){r[m]&&(s[m]=function(I){return new Promise(function(C,R){i.push([m,I,C,R])>1||u(m,I)})},S&&(s[m]=S(s[m])))}function u(m,S){try{l(r[m](S))}catch(I){y(i[0][3],I)}}function l(m){m.value instanceof _r?Promise.resolve(m.value.v).then(f,d):y(i[0][2],m)}function f(m){u("next",m)}function d(m){u("throw",m)}function y(m,S){m(S),i.shift(),i.length&&u(i[0][0],i[0][1])}};function Ap(n){var e;Tp();const t=(e=n.useBinaryFormat)!==null&&e!==void 0?e:!0;return{async unary(r,s,i,o,a,u,l){var f;const{serialize:d,parse:y}=Gu(s,t,n.jsonOptions,n.binaryOptions);return o=o===void 0?n.defaultTimeoutMs:o<=0?void 0:o,await wp({interceptors:n.interceptors,signal:i,timeoutMs:o,req:{stream:!1,service:r,method:s,url:Wu(n.baseUrl,r,s),init:{method:"POST",credentials:(f=n.credentials)!==null&&f!==void 0?f:"same-origin",redirect:"error",mode:"cors"},header:Zu(t,o,a),contextValues:l??ju(),message:u},next:async m=>{var S;const C=await((S=n.fetch)!==null&&S!==void 0?S:globalThis.fetch)(m.url,Object.assign(Object.assign({},m.init),{headers:m.header,signal:m.signal,body:Ku(0,d(m.message))})),{headerError:R}=Qu(C.status,C.headers);if(!C.body)throw R!==void 0?R:"missing response body";const $=Vu(C.body).getReader();let V,L;for(;;){const Y=await $.read();if(Y.done)break;const{flags:W,data:Q}=Y.value;if((W&zu)===zu)throw new re("protocol error: received unsupported compressed output",X.Internal);if(W===aa){if(V!==void 0)throw"extra trailer";V=Hu(Q);continue}if(L!==void 0)throw new re("extra message",X.Unimplemented);L=y(Q)}if(V===void 0)throw R!==void 0?R:new re("missing trailer",C.headers.has(ks)?X.Unimplemented:X.Unknown);if(Xu(V,C.headers),L===void 0)throw new re("missing message",V.has(ks)?X.Unimplemented:X.Unknown);return{stream:!1,service:r,method:s,header:C.headers,message:L,trailer:V}}})},async stream(r,s,i,o,a,u,l){var f;const{serialize:d,parse:y}=Gu(s,t,n.jsonOptions,n.binaryOptions);function m(I,C,R,$,V){return Ip(this,arguments,function*(){const Y=Vu(I).getReader();if(C){if(!(yield _r(Y.read())).done)throw"extra data for trailers-only";return yield _r(void 0)}let W=!1;for(;;){const Q=yield _r(Y.read());if(Q.done)break;const{flags:ie,data:ae}=Q.value;if((ie&aa)===aa){if(W)throw"extra trailer";W=!0;const Ie=Hu(ae);Xu(Ie,$),Ie.forEach((Zt,is)=>R.set(is,Zt));continue}if(W)throw"extra message";yield yield _r(y(ae))}if("throwIfAborted"in V&&V.throwIfAborted(),!W)throw"missing trailer"})}async function S(I){if(s.kind!=Le.ServerStreaming)throw"The fetch API does not support streaming request bodies";const C=await I[Symbol.asyncIterator]().next();if(C.done==!0)throw"missing request message";return Ku(0,d(C.value))}return o=o===void 0?n.defaultTimeoutMs:o<=0?void 0:o,bp({interceptors:n.interceptors,signal:i,timeoutMs:o,req:{stream:!0,service:r,method:s,url:Wu(n.baseUrl,r,s),init:{method:"POST",credentials:(f=n.credentials)!==null&&f!==void 0?f:"same-origin",redirect:"error",mode:"cors"},header:Zu(t,o,a),contextValues:l??ju(),message:u},next:async I=>{var C;const $=await((C=n.fetch)!==null&&C!==void 0?C:globalThis.fetch)(I.url,Object.assign(Object.assign({},I.init),{headers:I.header,signal:I.signal,body:await S(I.message)})),{foundStatus:V,headerError:L}=Qu($.status,$.headers);if(L!=null)throw L;if(!$.body)throw"missing response body";const Y=new Headers;return Object.assign(Object.assign({},I),{header:$.headers,trailer:Y,message:m($.body,V,Y,$.headers,I.signal)})}})}}}var G=(n=>(n[n.NULL=0]="NULL",n[n.BOOLEAN=1]="BOOLEAN",n[n.INTEGER=2]="INTEGER",n[n.LONG=3]="LONG",n[n.DOUBLE=4]="DOUBLE",n[n.STRING=5]="STRING",n[n.BYTES=6]="BYTES",n[n.DATE=7]="DATE",n[n.JSON_OBJECT=8]="JSON_OBJECT",n[n.JSON_ARRAY=9]="JSON_ARRAY",n[n.TEXT=10]="TEXT",n[n.INTEGER_CNT=11]="INTEGER_CNT",n[n.LONG_CNT=12]="LONG_CNT",n[n.TREE=13]="TREE",n))(G||{});h.util.setEnumType(G,"yorkie.v1.ValueType",[{no:0,name:"VALUE_TYPE_NULL"},{no:1,name:"VALUE_TYPE_BOOLEAN"},{no:2,name:"VALUE_TYPE_INTEGER"},{no:3,name:"VALUE_TYPE_LONG"},{no:4,name:"VALUE_TYPE_DOUBLE"},{no:5,name:"VALUE_TYPE_STRING"},{no:6,name:"VALUE_TYPE_BYTES"},{no:7,name:"VALUE_TYPE_DATE"},{no:8,name:"VALUE_TYPE_JSON_OBJECT"},{no:9,name:"VALUE_TYPE_JSON_ARRAY"},{no:10,name:"VALUE_TYPE_TEXT"},{no:11,name:"VALUE_TYPE_INTEGER_CNT"},{no:12,name:"VALUE_TYPE_LONG_CNT"},{no:13,name:"VALUE_TYPE_TREE"}]);var es=(n=>(n[n.DOCUMENT_CHANGED=0]="DOCUMENT_CHANGED",n[n.DOCUMENT_WATCHED=1]="DOCUMENT_WATCHED",n[n.DOCUMENT_UNWATCHED=2]="DOCUMENT_UNWATCHED",n[n.DOCUMENT_BROADCAST=3]="DOCUMENT_BROADCAST",n))(es||{});h.util.setEnumType(es,"yorkie.v1.DocEventType",[{no:0,name:"DOC_EVENT_TYPE_DOCUMENT_CHANGED"},{no:1,name:"DOC_EVENT_TYPE_DOCUMENT_WATCHED"},{no:2,name:"DOC_EVENT_TYPE_DOCUMENT_UNWATCHED"},{no:3,name:"DOC_EVENT_TYPE_DOCUMENT_BROADCAST"}]);const sn=class sn extends P{constructor(t){super();c(this,"root");c(this,"presences",{});h.util.initPartial(t,this)}static fromBinary(t,r){return new sn().fromBinary(t,r)}static fromJson(t,r){return new sn().fromJson(t,r)}static fromJsonString(t,r){return new sn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(sn,t,r)}};c(sn,"runtime",h),c(sn,"typeName","yorkie.v1.Snapshot"),c(sn,"fields",h.util.newFieldList(()=>[{no:1,name:"root",kind:"message",T:We},{no:2,name:"presences",kind:"map",K:9,V:{kind:"message",T:xc}}]));let Ea=sn;var it;let Ar=(it=class extends P{constructor(t){super();c(this,"documentKey","");c(this,"checkpoint");c(this,"snapshot",new Uint8Array(0));c(this,"changes",[]);c(this,"minSyncedTicket");c(this,"isRemoved",!1);c(this,"versionVector");h.util.initPartial(t,this)}static fromBinary(t,r){return new it().fromBinary(t,r)}static fromJson(t,r){return new it().fromJson(t,r)}static fromJsonString(t,r){return new it().fromJsonString(t,r)}static equals(t,r){return h.util.equals(it,t,r)}},c(it,"runtime",h),c(it,"typeName","yorkie.v1.ChangePack"),c(it,"fields",h.util.newFieldList(()=>[{no:1,name:"document_key",kind:"scalar",T:9},{no:2,name:"checkpoint",kind:"message",T:Xf},{no:3,name:"snapshot",kind:"scalar",T:12},{no:4,name:"changes",kind:"message",T:_f,repeated:!0},{no:5,name:"min_synced_ticket",kind:"message",T:F},{no:6,name:"is_removed",kind:"scalar",T:8},{no:7,name:"version_vector",kind:"message",T:$o}])),it);var ot;let _f=(ot=class extends P{constructor(t){super();c(this,"id");c(this,"message","");c(this,"operations",[]);c(this,"presenceChange");h.util.initPartial(t,this)}static fromBinary(t,r){return new ot().fromBinary(t,r)}static fromJson(t,r){return new ot().fromJson(t,r)}static fromJsonString(t,r){return new ot().fromJsonString(t,r)}static equals(t,r){return h.util.equals(ot,t,r)}},c(ot,"runtime",h),c(ot,"typeName","yorkie.v1.Change"),c(ot,"fields",h.util.newFieldList(()=>[{no:1,name:"id",kind:"message",T:Fo},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"operations",kind:"message",T:Ac,repeated:!0},{no:4,name:"presence_change",kind:"message",T:fi}])),ot);var at;let Fo=(at=class extends P{constructor(t){super();c(this,"clientSeq",0);c(this,"serverSeq",ge.zero);c(this,"lamport",ge.zero);c(this,"actorId",new Uint8Array(0));c(this,"versionVector");h.util.initPartial(t,this)}static fromBinary(t,r){return new at().fromBinary(t,r)}static fromJson(t,r){return new at().fromJson(t,r)}static fromJsonString(t,r){return new at().fromJsonString(t,r)}static equals(t,r){return h.util.equals(at,t,r)}},c(at,"runtime",h),c(at,"typeName","yorkie.v1.ChangeID"),c(at,"fields",h.util.newFieldList(()=>[{no:1,name:"client_seq",kind:"scalar",T:13},{no:2,name:"server_seq",kind:"scalar",T:3},{no:3,name:"lamport",kind:"scalar",T:3},{no:4,name:"actor_id",kind:"scalar",T:12},{no:5,name:"version_vector",kind:"message",T:$o}])),at);var ct;let $o=(ct=class extends P{constructor(t){super();c(this,"vector",{});h.util.initPartial(t,this)}static fromBinary(t,r){return new ct().fromBinary(t,r)}static fromJson(t,r){return new ct().fromJson(t,r)}static fromJsonString(t,r){return new ct().fromJsonString(t,r)}static equals(t,r){return h.util.equals(ct,t,r)}},c(ct,"runtime",h),c(ct,"typeName","yorkie.v1.VersionVector"),c(ct,"fields",h.util.newFieldList(()=>[{no:1,name:"vector",kind:"map",K:9,V:{kind:"scalar",T:3}}])),ct);var ut;let Ac=(ut=class extends P{constructor(t){super();c(this,"body",{case:void 0});h.util.initPartial(t,this)}static fromBinary(t,r){return new ut().fromBinary(t,r)}static fromJson(t,r){return new ut().fromJson(t,r)}static fromJsonString(t,r){return new ut().fromJsonString(t,r)}static equals(t,r){return h.util.equals(ut,t,r)}},c(ut,"runtime",h),c(ut,"typeName","yorkie.v1.Operation"),c(ut,"fields",h.util.newFieldList(()=>[{no:1,name:"set",kind:"message",T:to,oneof:"body"},{no:2,name:"add",kind:"message",T:no,oneof:"body"},{no:3,name:"move",kind:"message",T:ro,oneof:"body"},{no:4,name:"remove",kind:"message",T:so,oneof:"body"},{no:5,name:"edit",kind:"message",T:io,oneof:"body"},{no:6,name:"select",kind:"message",T:Na,oneof:"body"},{no:7,name:"style",kind:"message",T:oo,oneof:"body"},{no:8,name:"increase",kind:"message",T:ao,oneof:"body"},{no:9,name:"tree_edit",kind:"message",T:co,oneof:"body"},{no:10,name:"tree_style",kind:"message",T:uo,oneof:"body"},{no:11,name:"array_set",kind:"message",T:Pa,oneof:"body"}])),ut);const on=class on extends P{constructor(t){super();c(this,"parentCreatedAt");c(this,"key","");c(this,"value");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new on().fromBinary(t,r)}static fromJson(t,r){return new on().fromJson(t,r)}static fromJsonString(t,r){return new on().fromJsonString(t,r)}static equals(t,r){return h.util.equals(on,t,r)}};c(on,"runtime",h),c(on,"typeName","yorkie.v1.Operation.Set"),c(on,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"value",kind:"message",T:st},{no:4,name:"executed_at",kind:"message",T:F}]));let to=on;const an=class an extends P{constructor(t){super();c(this,"parentCreatedAt");c(this,"prevCreatedAt");c(this,"value");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new an().fromBinary(t,r)}static fromJson(t,r){return new an().fromJson(t,r)}static fromJsonString(t,r){return new an().fromJsonString(t,r)}static equals(t,r){return h.util.equals(an,t,r)}};c(an,"runtime",h),c(an,"typeName","yorkie.v1.Operation.Add"),c(an,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"prev_created_at",kind:"message",T:F},{no:3,name:"value",kind:"message",T:st},{no:4,name:"executed_at",kind:"message",T:F}]));let no=an;const cn=class cn extends P{constructor(t){super();c(this,"parentCreatedAt");c(this,"prevCreatedAt");c(this,"createdAt");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new cn().fromBinary(t,r)}static fromJson(t,r){return new cn().fromJson(t,r)}static fromJsonString(t,r){return new cn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(cn,t,r)}};c(cn,"runtime",h),c(cn,"typeName","yorkie.v1.Operation.Move"),c(cn,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"prev_created_at",kind:"message",T:F},{no:3,name:"created_at",kind:"message",T:F},{no:4,name:"executed_at",kind:"message",T:F}]));let ro=cn;const un=class un extends P{constructor(t){super();c(this,"parentCreatedAt");c(this,"createdAt");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new un().fromBinary(t,r)}static fromJson(t,r){return new un().fromJson(t,r)}static fromJsonString(t,r){return new un().fromJsonString(t,r)}static equals(t,r){return h.util.equals(un,t,r)}};c(un,"runtime",h),c(un,"typeName","yorkie.v1.Operation.Remove"),c(un,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"created_at",kind:"message",T:F},{no:3,name:"executed_at",kind:"message",T:F}]));let so=un;const ln=class ln extends P{constructor(t){super();c(this,"parentCreatedAt");c(this,"from");c(this,"to");c(this,"createdAtMapByActor",{});c(this,"content","");c(this,"executedAt");c(this,"attributes",{});h.util.initPartial(t,this)}static fromBinary(t,r){return new ln().fromBinary(t,r)}static fromJson(t,r){return new ln().fromJson(t,r)}static fromJsonString(t,r){return new ln().fromJsonString(t,r)}static equals(t,r){return h.util.equals(ln,t,r)}};c(ln,"runtime",h),c(ln,"typeName","yorkie.v1.Operation.Edit"),c(ln,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"from",kind:"message",T:br},{no:3,name:"to",kind:"message",T:br},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:F}},{no:5,name:"content",kind:"scalar",T:9},{no:6,name:"executed_at",kind:"message",T:F},{no:7,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}]));let io=ln;const fn=class fn extends P{constructor(t){super();c(this,"parentCreatedAt");c(this,"from");c(this,"to");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new fn().fromBinary(t,r)}static fromJson(t,r){return new fn().fromJson(t,r)}static fromJsonString(t,r){return new fn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(fn,t,r)}};c(fn,"runtime",h),c(fn,"typeName","yorkie.v1.Operation.Select"),c(fn,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"from",kind:"message",T:br},{no:3,name:"to",kind:"message",T:br},{no:4,name:"executed_at",kind:"message",T:F}]));let Na=fn;const hn=class hn extends P{constructor(t){super();c(this,"parentCreatedAt");c(this,"from");c(this,"to");c(this,"attributes",{});c(this,"executedAt");c(this,"createdAtMapByActor",{});h.util.initPartial(t,this)}static fromBinary(t,r){return new hn().fromBinary(t,r)}static fromJson(t,r){return new hn().fromJson(t,r)}static fromJsonString(t,r){return new hn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(hn,t,r)}};c(hn,"runtime",h),c(hn,"typeName","yorkie.v1.Operation.Style"),c(hn,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"from",kind:"message",T:br},{no:3,name:"to",kind:"message",T:br},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:F},{no:6,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:F}}]));let oo=hn;const dn=class dn extends P{constructor(t){super();c(this,"parentCreatedAt");c(this,"value");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new dn().fromBinary(t,r)}static fromJson(t,r){return new dn().fromJson(t,r)}static fromJsonString(t,r){return new dn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(dn,t,r)}};c(dn,"runtime",h),c(dn,"typeName","yorkie.v1.Operation.Increase"),c(dn,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"value",kind:"message",T:st},{no:3,name:"executed_at",kind:"message",T:F}]));let ao=dn;const gn=class gn extends P{constructor(t){super();c(this,"parentCreatedAt");c(this,"from");c(this,"to");c(this,"createdAtMapByActor",{});c(this,"contents",[]);c(this,"splitLevel",0);c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new gn().fromBinary(t,r)}static fromJson(t,r){return new gn().fromJson(t,r)}static fromJsonString(t,r){return new gn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(gn,t,r)}};c(gn,"runtime",h),c(gn,"typeName","yorkie.v1.Operation.TreeEdit"),c(gn,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"from",kind:"message",T:ts},{no:3,name:"to",kind:"message",T:ts},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:F}},{no:5,name:"contents",kind:"message",T:wo,repeated:!0},{no:7,name:"split_level",kind:"scalar",T:5},{no:6,name:"executed_at",kind:"message",T:F}]));let co=gn;const mn=class mn extends P{constructor(t){super();c(this,"parentCreatedAt");c(this,"from");c(this,"to");c(this,"attributes",{});c(this,"executedAt");c(this,"attributesToRemove",[]);c(this,"createdAtMapByActor",{});h.util.initPartial(t,this)}static fromBinary(t,r){return new mn().fromBinary(t,r)}static fromJson(t,r){return new mn().fromJson(t,r)}static fromJsonString(t,r){return new mn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(mn,t,r)}};c(mn,"runtime",h),c(mn,"typeName","yorkie.v1.Operation.TreeStyle"),c(mn,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"from",kind:"message",T:ts},{no:3,name:"to",kind:"message",T:ts},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:F},{no:6,name:"attributes_to_remove",kind:"scalar",T:9,repeated:!0},{no:7,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:F}}]));let uo=mn;const pn=class pn extends P{constructor(t){super();c(this,"parentCreatedAt");c(this,"createdAt");c(this,"value");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new pn().fromBinary(t,r)}static fromJson(t,r){return new pn().fromJson(t,r)}static fromJsonString(t,r){return new pn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(pn,t,r)}};c(pn,"runtime",h),c(pn,"typeName","yorkie.v1.Operation.ArraySet"),c(pn,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:F},{no:2,name:"created_at",kind:"message",T:F},{no:3,name:"value",kind:"message",T:st},{no:4,name:"executed_at",kind:"message",T:F}]));let Pa=pn;const yn=class yn extends P{constructor(t){super();c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");c(this,"type",0);c(this,"value",new Uint8Array(0));h.util.initPartial(t,this)}static fromBinary(t,r){return new yn().fromBinary(t,r)}static fromJson(t,r){return new yn().fromJson(t,r)}static fromJsonString(t,r){return new yn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(yn,t,r)}};c(yn,"runtime",h),c(yn,"typeName","yorkie.v1.JSONElementSimple"),c(yn,"fields",h.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:F},{no:2,name:"moved_at",kind:"message",T:F},{no:3,name:"removed_at",kind:"message",T:F},{no:4,name:"type",kind:"enum",T:h.getEnumType(G)},{no:5,name:"value",kind:"scalar",T:12}]));let st=yn;const vn=class vn extends P{constructor(t){super();c(this,"body",{case:void 0});h.util.initPartial(t,this)}static fromBinary(t,r){return new vn().fromBinary(t,r)}static fromJson(t,r){return new vn().fromJson(t,r)}static fromJsonString(t,r){return new vn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(vn,t,r)}};c(vn,"runtime",h),c(vn,"typeName","yorkie.v1.JSONElement"),c(vn,"fields",h.util.newFieldList(()=>[{no:1,name:"json_object",kind:"message",T:lo,oneof:"body"},{no:2,name:"json_array",kind:"message",T:fo,oneof:"body"},{no:3,name:"primitive",kind:"message",T:ho,oneof:"body"},{no:5,name:"text",kind:"message",T:go,oneof:"body"},{no:6,name:"counter",kind:"message",T:mo,oneof:"body"},{no:7,name:"tree",kind:"message",T:po,oneof:"body"}]));let We=vn;const wn=class wn extends P{constructor(t){super();c(this,"nodes",[]);c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new wn().fromBinary(t,r)}static fromJson(t,r){return new wn().fromJson(t,r)}static fromJsonString(t,r){return new wn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(wn,t,r)}};c(wn,"runtime",h),c(wn,"typeName","yorkie.v1.JSONElement.JSONObject"),c(wn,"fields",h.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:Yf,repeated:!0},{no:2,name:"created_at",kind:"message",T:F},{no:3,name:"moved_at",kind:"message",T:F},{no:4,name:"removed_at",kind:"message",T:F}]));let lo=wn;const bn=class bn extends P{constructor(t){super();c(this,"nodes",[]);c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new bn().fromBinary(t,r)}static fromJson(t,r){return new bn().fromJson(t,r)}static fromJsonString(t,r){return new bn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(bn,t,r)}};c(bn,"runtime",h),c(bn,"typeName","yorkie.v1.JSONElement.JSONArray"),c(bn,"fields",h.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:yo,repeated:!0},{no:2,name:"created_at",kind:"message",T:F},{no:3,name:"moved_at",kind:"message",T:F},{no:4,name:"removed_at",kind:"message",T:F}]));let fo=bn;const Tn=class Tn extends P{constructor(t){super();c(this,"type",0);c(this,"value",new Uint8Array(0));c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new Tn().fromBinary(t,r)}static fromJson(t,r){return new Tn().fromJson(t,r)}static fromJsonString(t,r){return new Tn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Tn,t,r)}};c(Tn,"runtime",h),c(Tn,"typeName","yorkie.v1.JSONElement.Primitive"),c(Tn,"fields",h.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:h.getEnumType(G)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:F},{no:4,name:"moved_at",kind:"message",T:F},{no:5,name:"removed_at",kind:"message",T:F}]));let ho=Tn;const Sn=class Sn extends P{constructor(t){super();c(this,"nodes",[]);c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new Sn().fromBinary(t,r)}static fromJson(t,r){return new Sn().fromJson(t,r)}static fromJsonString(t,r){return new Sn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Sn,t,r)}};c(Sn,"runtime",h),c(Sn,"typeName","yorkie.v1.JSONElement.Text"),c(Sn,"fields",h.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:vo,repeated:!0},{no:2,name:"created_at",kind:"message",T:F},{no:3,name:"moved_at",kind:"message",T:F},{no:4,name:"removed_at",kind:"message",T:F}]));let go=Sn;const In=class In extends P{constructor(t){super();c(this,"type",0);c(this,"value",new Uint8Array(0));c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new In().fromBinary(t,r)}static fromJson(t,r){return new In().fromJson(t,r)}static fromJsonString(t,r){return new In().fromJsonString(t,r)}static equals(t,r){return h.util.equals(In,t,r)}};c(In,"runtime",h),c(In,"typeName","yorkie.v1.JSONElement.Counter"),c(In,"fields",h.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:h.getEnumType(G)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:F},{no:4,name:"moved_at",kind:"message",T:F},{no:5,name:"removed_at",kind:"message",T:F}]));let mo=In;const An=class An extends P{constructor(t){super();c(this,"nodes",[]);c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new An().fromBinary(t,r)}static fromJson(t,r){return new An().fromJson(t,r)}static fromJsonString(t,r){return new An().fromJsonString(t,r)}static equals(t,r){return h.util.equals(An,t,r)}};c(An,"runtime",h),c(An,"typeName","yorkie.v1.JSONElement.Tree"),c(An,"fields",h.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:li,repeated:!0},{no:2,name:"created_at",kind:"message",T:F},{no:3,name:"moved_at",kind:"message",T:F},{no:4,name:"removed_at",kind:"message",T:F}]));let po=An;var lt;let Yf=(lt=class extends P{constructor(t){super();c(this,"key","");c(this,"element");h.util.initPartial(t,this)}static fromBinary(t,r){return new lt().fromBinary(t,r)}static fromJson(t,r){return new lt().fromJson(t,r)}static fromJsonString(t,r){return new lt().fromJsonString(t,r)}static equals(t,r){return h.util.equals(lt,t,r)}},c(lt,"runtime",h),c(lt,"typeName","yorkie.v1.RHTNode"),c(lt,"fields",h.util.newFieldList(()=>[{no:1,name:"key",kind:"scalar",T:9},{no:2,name:"element",kind:"message",T:We}])),lt);const Rt=class Rt extends P{constructor(t){super();c(this,"next");c(this,"element");h.util.initPartial(t,this)}static fromBinary(t,r){return new Rt().fromBinary(t,r)}static fromJson(t,r){return new Rt().fromJson(t,r)}static fromJsonString(t,r){return new Rt().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Rt,t,r)}};c(Rt,"runtime",h),c(Rt,"typeName","yorkie.v1.RGANode"),c(Rt,"fields",h.util.newFieldList(()=>[{no:1,name:"next",kind:"message",T:Rt},{no:2,name:"element",kind:"message",T:We}]));let yo=Rt;const xn=class xn extends P{constructor(t){super();c(this,"value","");c(this,"updatedAt");c(this,"isRemoved",!1);h.util.initPartial(t,this)}static fromBinary(t,r){return new xn().fromBinary(t,r)}static fromJson(t,r){return new xn().fromJson(t,r)}static fromJsonString(t,r){return new xn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(xn,t,r)}};c(xn,"runtime",h),c(xn,"typeName","yorkie.v1.NodeAttr"),c(xn,"fields",h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:9},{no:2,name:"updated_at",kind:"message",T:F},{no:3,name:"is_removed",kind:"scalar",T:8}]));let Es=xn;const kn=class kn extends P{constructor(t){super();c(this,"id");c(this,"value","");c(this,"removedAt");c(this,"insPrevId");c(this,"attributes",{});h.util.initPartial(t,this)}static fromBinary(t,r){return new kn().fromBinary(t,r)}static fromJson(t,r){return new kn().fromJson(t,r)}static fromJsonString(t,r){return new kn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(kn,t,r)}};c(kn,"runtime",h),c(kn,"typeName","yorkie.v1.TextNode"),c(kn,"fields",h.util.newFieldList(()=>[{no:1,name:"id",kind:"message",T:ui},{no:2,name:"value",kind:"scalar",T:9},{no:3,name:"removed_at",kind:"message",T:F},{no:4,name:"ins_prev_id",kind:"message",T:ui},{no:5,name:"attributes",kind:"map",K:9,V:{kind:"message",T:Es}}]));let vo=kn;const En=class En extends P{constructor(t){super();c(this,"createdAt");c(this,"offset",0);h.util.initPartial(t,this)}static fromBinary(t,r){return new En().fromBinary(t,r)}static fromJson(t,r){return new En().fromJson(t,r)}static fromJsonString(t,r){return new En().fromJsonString(t,r)}static equals(t,r){return h.util.equals(En,t,r)}};c(En,"runtime",h),c(En,"typeName","yorkie.v1.TextNodeID"),c(En,"fields",h.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:F},{no:2,name:"offset",kind:"scalar",T:5}]));let ui=En;const Nn=class Nn extends P{constructor(t){super();c(this,"id");c(this,"type","");c(this,"value","");c(this,"removedAt");c(this,"insPrevId");c(this,"insNextId");c(this,"depth",0);c(this,"attributes",{});h.util.initPartial(t,this)}static fromBinary(t,r){return new Nn().fromBinary(t,r)}static fromJson(t,r){return new Nn().fromJson(t,r)}static fromJsonString(t,r){return new Nn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Nn,t,r)}};c(Nn,"runtime",h),c(Nn,"typeName","yorkie.v1.TreeNode"),c(Nn,"fields",h.util.newFieldList(()=>[{no:1,name:"id",kind:"message",T:Rr},{no:2,name:"type",kind:"scalar",T:9},{no:3,name:"value",kind:"scalar",T:9},{no:4,name:"removed_at",kind:"message",T:F},{no:5,name:"ins_prev_id",kind:"message",T:Rr},{no:6,name:"ins_next_id",kind:"message",T:Rr},{no:7,name:"depth",kind:"scalar",T:5},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"message",T:Es}}]));let li=Nn;const Pn=class Pn extends P{constructor(t){super();c(this,"content",[]);h.util.initPartial(t,this)}static fromBinary(t,r){return new Pn().fromBinary(t,r)}static fromJson(t,r){return new Pn().fromJson(t,r)}static fromJsonString(t,r){return new Pn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Pn,t,r)}};c(Pn,"runtime",h),c(Pn,"typeName","yorkie.v1.TreeNodes"),c(Pn,"fields",h.util.newFieldList(()=>[{no:1,name:"content",kind:"message",T:li,repeated:!0}]));let wo=Pn;const Cn=class Cn extends P{constructor(t){super();c(this,"createdAt");c(this,"offset",0);h.util.initPartial(t,this)}static fromBinary(t,r){return new Cn().fromBinary(t,r)}static fromJson(t,r){return new Cn().fromJson(t,r)}static fromJsonString(t,r){return new Cn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Cn,t,r)}};c(Cn,"runtime",h),c(Cn,"typeName","yorkie.v1.TreeNodeID"),c(Cn,"fields",h.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:F},{no:2,name:"offset",kind:"scalar",T:5}]));let Rr=Cn;const Dn=class Dn extends P{constructor(t){super();c(this,"parentId");c(this,"leftSiblingId");h.util.initPartial(t,this)}static fromBinary(t,r){return new Dn().fromBinary(t,r)}static fromJson(t,r){return new Dn().fromJson(t,r)}static fromJsonString(t,r){return new Dn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Dn,t,r)}};c(Dn,"runtime",h),c(Dn,"typeName","yorkie.v1.TreePos"),c(Dn,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_id",kind:"message",T:Rr},{no:2,name:"left_sibling_id",kind:"message",T:Rr}]));let ts=Dn;const On=class On extends P{constructor(t){super();c(this,"id","");c(this,"authProvider","");c(this,"username","");c(this,"createdAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new On().fromBinary(t,r)}static fromJson(t,r){return new On().fromJson(t,r)}static fromJsonString(t,r){return new On().fromJsonString(t,r)}static equals(t,r){return h.util.equals(On,t,r)}};c(On,"runtime",h),c(On,"typeName","yorkie.v1.User"),c(On,"fields",h.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"auth_provider",kind:"scalar",T:9},{no:3,name:"username",kind:"scalar",T:9},{no:4,name:"created_at",kind:"message",T:ke}]));let el=On;const Rn=class Rn extends P{constructor(t){super();c(this,"id","");c(this,"name","");c(this,"publicKey","");c(this,"secretKey","");c(this,"authWebhookUrl","");c(this,"authWebhookMethods",[]);c(this,"eventWebhookUrl","");c(this,"eventWebhookEvents",[]);c(this,"clientDeactivateThreshold","");c(this,"maxSubscribersPerDocument",0);c(this,"maxAttachmentsPerDocument",0);c(this,"maxSizePerDocument",0);c(this,"allowedOrigins",[]);c(this,"createdAt");c(this,"updatedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new Rn().fromBinary(t,r)}static fromJson(t,r){return new Rn().fromJson(t,r)}static fromJsonString(t,r){return new Rn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Rn,t,r)}};c(Rn,"runtime",h),c(Rn,"typeName","yorkie.v1.Project"),c(Rn,"fields",h.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"public_key",kind:"scalar",T:9},{no:4,name:"secret_key",kind:"scalar",T:9},{no:5,name:"auth_webhook_url",kind:"scalar",T:9},{no:6,name:"auth_webhook_methods",kind:"scalar",T:9,repeated:!0},{no:7,name:"event_webhook_url",kind:"scalar",T:9},{no:8,name:"event_webhook_events",kind:"scalar",T:9,repeated:!0},{no:9,name:"client_deactivate_threshold",kind:"scalar",T:9},{no:10,name:"max_subscribers_per_document",kind:"scalar",T:5},{no:11,name:"max_attachments_per_document",kind:"scalar",T:5},{no:15,name:"max_size_per_document",kind:"scalar",T:5},{no:14,name:"allowed_origins",kind:"scalar",T:9,repeated:!0},{no:12,name:"created_at",kind:"message",T:ke},{no:13,name:"updated_at",kind:"message",T:ke}]));let tl=Rn;const Bn=class Bn extends P{constructor(t){super();c(this,"timestamp",ge.zero);c(this,"value",0);h.util.initPartial(t,this)}static fromBinary(t,r){return new Bn().fromBinary(t,r)}static fromJson(t,r){return new Bn().fromJson(t,r)}static fromJsonString(t,r){return new Bn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Bn,t,r)}};c(Bn,"runtime",h),c(Bn,"typeName","yorkie.v1.MetricPoint"),c(Bn,"fields",h.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"value",kind:"scalar",T:5}]));let nl=Bn;const Ln=class Ln extends P{constructor(t){super();c(this,"name");c(this,"authWebhookUrl");c(this,"authWebhookMethods");c(this,"eventWebhookUrl");c(this,"eventWebhookEvents");c(this,"clientDeactivateThreshold");c(this,"maxSubscribersPerDocument");c(this,"maxAttachmentsPerDocument");c(this,"maxSizePerDocument");c(this,"allowedOrigins");h.util.initPartial(t,this)}static fromBinary(t,r){return new Ln().fromBinary(t,r)}static fromJson(t,r){return new Ln().fromJson(t,r)}static fromJsonString(t,r){return new Ln().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Ln,t,r)}};c(Ln,"runtime",h),c(Ln,"typeName","yorkie.v1.UpdatableProjectFields"),c(Ln,"fields",h.util.newFieldList(()=>[{no:1,name:"name",kind:"message",T:Ke},{no:2,name:"auth_webhook_url",kind:"message",T:Ke},{no:3,name:"auth_webhook_methods",kind:"message",T:Ca},{no:4,name:"event_webhook_url",kind:"message",T:Ke},{no:5,name:"event_webhook_events",kind:"message",T:Da},{no:6,name:"client_deactivate_threshold",kind:"message",T:Ke},{no:7,name:"max_subscribers_per_document",kind:"message",T:Qe},{no:8,name:"max_attachments_per_document",kind:"message",T:Qe},{no:10,name:"max_size_per_document",kind:"message",T:Qe},{no:9,name:"allowed_origins",kind:"message",T:Oa}]));let rl=Ln;const Jn=class Jn extends P{constructor(t){super();c(this,"methods",[]);h.util.initPartial(t,this)}static fromBinary(t,r){return new Jn().fromBinary(t,r)}static fromJson(t,r){return new Jn().fromJson(t,r)}static fromJsonString(t,r){return new Jn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Jn,t,r)}};c(Jn,"runtime",h),c(Jn,"typeName","yorkie.v1.UpdatableProjectFields.AuthWebhookMethods"),c(Jn,"fields",h.util.newFieldList(()=>[{no:1,name:"methods",kind:"scalar",T:9,repeated:!0}]));let Ca=Jn;const Fn=class Fn extends P{constructor(t){super();c(this,"events",[]);h.util.initPartial(t,this)}static fromBinary(t,r){return new Fn().fromBinary(t,r)}static fromJson(t,r){return new Fn().fromJson(t,r)}static fromJsonString(t,r){return new Fn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Fn,t,r)}};c(Fn,"runtime",h),c(Fn,"typeName","yorkie.v1.UpdatableProjectFields.EventWebhookEvents"),c(Fn,"fields",h.util.newFieldList(()=>[{no:1,name:"events",kind:"scalar",T:9,repeated:!0}]));let Da=Fn;const $n=class $n extends P{constructor(t){super();c(this,"origins",[]);h.util.initPartial(t,this)}static fromBinary(t,r){return new $n().fromBinary(t,r)}static fromJson(t,r){return new $n().fromJson(t,r)}static fromJsonString(t,r){return new $n().fromJsonString(t,r)}static equals(t,r){return h.util.equals($n,t,r)}};c($n,"runtime",h),c($n,"typeName","yorkie.v1.UpdatableProjectFields.AllowedOrigins"),c($n,"fields",h.util.newFieldList(()=>[{no:1,name:"origins",kind:"scalar",T:9,repeated:!0}]));let Oa=$n;const Mn=class Mn extends P{constructor(t){super();c(this,"id","");c(this,"key","");c(this,"snapshot","");c(this,"attachedClients",0);c(this,"documentSize");c(this,"schemaKey","");c(this,"createdAt");c(this,"accessedAt");c(this,"updatedAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new Mn().fromBinary(t,r)}static fromJson(t,r){return new Mn().fromJson(t,r)}static fromJsonString(t,r){return new Mn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Mn,t,r)}};c(Mn,"runtime",h),c(Mn,"typeName","yorkie.v1.DocumentSummary"),c(Mn,"fields",h.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"snapshot",kind:"scalar",T:9},{no:7,name:"attached_clients",kind:"scalar",T:5},{no:8,name:"document_size",kind:"message",T:La},{no:9,name:"schema_key",kind:"scalar",T:9},{no:4,name:"created_at",kind:"message",T:ke},{no:5,name:"accessed_at",kind:"message",T:ke},{no:6,name:"updated_at",kind:"message",T:ke}]));let sl=Mn;const Un=class Un extends P{constructor(t){super();c(this,"type",0);c(this,"presence");h.util.initPartial(t,this)}static fromBinary(t,r){return new Un().fromBinary(t,r)}static fromJson(t,r){return new Un().fromJson(t,r)}static fromJsonString(t,r){return new Un().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Un,t,r)}};c(Un,"runtime",h),c(Un,"typeName","yorkie.v1.PresenceChange"),c(Un,"fields",h.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:h.getEnumType(ns)},{no:2,name:"presence",kind:"message",T:xc}]));let fi=Un;var ns=(n=>(n[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.PUT=1]="PUT",n[n.DELETE=2]="DELETE",n[n.CLEAR=3]="CLEAR",n))(ns||{});h.util.setEnumType(ns,"yorkie.v1.PresenceChange.ChangeType",[{no:0,name:"CHANGE_TYPE_UNSPECIFIED"},{no:1,name:"CHANGE_TYPE_PUT"},{no:2,name:"CHANGE_TYPE_DELETE"},{no:3,name:"CHANGE_TYPE_CLEAR"}]);var ft;let xc=(ft=class extends P{constructor(t){super();c(this,"data",{});h.util.initPartial(t,this)}static fromBinary(t,r){return new ft().fromBinary(t,r)}static fromJson(t,r){return new ft().fromJson(t,r)}static fromJsonString(t,r){return new ft().fromJsonString(t,r)}static equals(t,r){return h.util.equals(ft,t,r)}},c(ft,"runtime",h),c(ft,"typeName","yorkie.v1.Presence"),c(ft,"fields",h.util.newFieldList(()=>[{no:1,name:"data",kind:"map",K:9,V:{kind:"scalar",T:9}}])),ft);var ht;let Xf=(ht=class extends P{constructor(t){super();c(this,"serverSeq",ge.zero);c(this,"clientSeq",0);h.util.initPartial(t,this)}static fromBinary(t,r){return new ht().fromBinary(t,r)}static fromJson(t,r){return new ht().fromJson(t,r)}static fromJsonString(t,r){return new ht().fromJsonString(t,r)}static equals(t,r){return h.util.equals(ht,t,r)}},c(ht,"runtime",h),c(ht,"typeName","yorkie.v1.Checkpoint"),c(ht,"fields",h.util.newFieldList(()=>[{no:1,name:"server_seq",kind:"scalar",T:3},{no:2,name:"client_seq",kind:"scalar",T:13}])),ht);const qn=class qn extends P{constructor(t){super();c(this,"createdAt");c(this,"offset",0);c(this,"relativeOffset",0);h.util.initPartial(t,this)}static fromBinary(t,r){return new qn().fromBinary(t,r)}static fromJson(t,r){return new qn().fromJson(t,r)}static fromJsonString(t,r){return new qn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(qn,t,r)}};c(qn,"runtime",h),c(qn,"typeName","yorkie.v1.TextNodePos"),c(qn,"fields",h.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:F},{no:2,name:"offset",kind:"scalar",T:5},{no:3,name:"relative_offset",kind:"scalar",T:5}]));let br=qn;var dt;let F=(dt=class extends P{constructor(t){super();c(this,"lamport",ge.zero);c(this,"delimiter",0);c(this,"actorId",new Uint8Array(0));h.util.initPartial(t,this)}static fromBinary(t,r){return new dt().fromBinary(t,r)}static fromJson(t,r){return new dt().fromJson(t,r)}static fromJsonString(t,r){return new dt().fromJsonString(t,r)}static equals(t,r){return h.util.equals(dt,t,r)}},c(dt,"runtime",h),c(dt,"typeName","yorkie.v1.TimeTicket"),c(dt,"fields",h.util.newFieldList(()=>[{no:1,name:"lamport",kind:"scalar",T:3},{no:2,name:"delimiter",kind:"scalar",T:13},{no:3,name:"actor_id",kind:"scalar",T:12}])),dt);const zn=class zn extends P{constructor(t){super();c(this,"topic","");c(this,"payload",new Uint8Array(0));h.util.initPartial(t,this)}static fromBinary(t,r){return new zn().fromBinary(t,r)}static fromJson(t,r){return new zn().fromJson(t,r)}static fromJsonString(t,r){return new zn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(zn,t,r)}};c(zn,"runtime",h),c(zn,"typeName","yorkie.v1.DocEventBody"),c(zn,"fields",h.util.newFieldList(()=>[{no:1,name:"topic",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12}]));let Ra=zn;const Vn=class Vn extends P{constructor(t){super();c(this,"type",0);c(this,"publisher","");c(this,"body");h.util.initPartial(t,this)}static fromBinary(t,r){return new Vn().fromBinary(t,r)}static fromJson(t,r){return new Vn().fromJson(t,r)}static fromJsonString(t,r){return new Vn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Vn,t,r)}};c(Vn,"runtime",h),c(Vn,"typeName","yorkie.v1.DocEvent"),c(Vn,"fields",h.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:h.getEnumType(es)},{no:2,name:"publisher",kind:"scalar",T:9},{no:3,name:"body",kind:"message",T:Ra}]));let Ba=Vn;const Kn=class Kn extends P{constructor(t){super();c(this,"data",0);c(this,"meta",0);h.util.initPartial(t,this)}static fromBinary(t,r){return new Kn().fromBinary(t,r)}static fromJson(t,r){return new Kn().fromJson(t,r)}static fromJsonString(t,r){return new Kn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Kn,t,r)}};c(Kn,"runtime",h),c(Kn,"typeName","yorkie.v1.DataSize"),c(Kn,"fields",h.util.newFieldList(()=>[{no:1,name:"data",kind:"scalar",T:5},{no:2,name:"meta",kind:"scalar",T:5}]));let bo=Kn;const jn=class jn extends P{constructor(t){super();c(this,"live");c(this,"gc");h.util.initPartial(t,this)}static fromBinary(t,r){return new jn().fromBinary(t,r)}static fromJson(t,r){return new jn().fromJson(t,r)}static fromJsonString(t,r){return new jn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(jn,t,r)}};c(jn,"runtime",h),c(jn,"typeName","yorkie.v1.DocSize"),c(jn,"fields",h.util.newFieldList(()=>[{no:1,name:"live",kind:"message",T:bo},{no:2,name:"gc",kind:"message",T:bo}]));let La=jn;const Hn=class Hn extends P{constructor(t){super();c(this,"id","");c(this,"name","");c(this,"version",0);c(this,"body","");c(this,"rules",[]);c(this,"createdAt");h.util.initPartial(t,this)}static fromBinary(t,r){return new Hn().fromBinary(t,r)}static fromJson(t,r){return new Hn().fromJson(t,r)}static fromJsonString(t,r){return new Hn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Hn,t,r)}};c(Hn,"runtime",h),c(Hn,"typeName","yorkie.v1.Schema"),c(Hn,"fields",h.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"version",kind:"scalar",T:5},{no:4,name:"body",kind:"scalar",T:9},{no:5,name:"rules",kind:"message",T:To,repeated:!0},{no:6,name:"created_at",kind:"message",T:ke}]));let il=Hn;const Wn=class Wn extends P{constructor(t){super();c(this,"path","");c(this,"type","");h.util.initPartial(t,this)}static fromBinary(t,r){return new Wn().fromBinary(t,r)}static fromJson(t,r){return new Wn().fromJson(t,r)}static fromJsonString(t,r){return new Wn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Wn,t,r)}};c(Wn,"runtime",h),c(Wn,"typeName","yorkie.v1.Rule"),c(Wn,"fields",h.util.newFieldList(()=>[{no:1,name:"path",kind:"scalar",T:9},{no:2,name:"type",kind:"scalar",T:9}]));let To=Wn;const Gn=class Gn extends P{constructor(t){super();c(this,"clientKey","");c(this,"metadata",{});h.util.initPartial(t,this)}static fromBinary(t,r){return new Gn().fromBinary(t,r)}static fromJson(t,r){return new Gn().fromJson(t,r)}static fromJsonString(t,r){return new Gn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Gn,t,r)}};c(Gn,"runtime",h),c(Gn,"typeName","yorkie.v1.ActivateClientRequest"),c(Gn,"fields",h.util.newFieldList(()=>[{no:1,name:"client_key",kind:"scalar",T:9},{no:2,name:"metadata",kind:"map",K:9,V:{kind:"scalar",T:9}}]));let Ja=Gn;const _n=class _n extends P{constructor(t){super();c(this,"clientId","");h.util.initPartial(t,this)}static fromBinary(t,r){return new _n().fromBinary(t,r)}static fromJson(t,r){return new _n().fromJson(t,r)}static fromJsonString(t,r){return new _n().fromJsonString(t,r)}static equals(t,r){return h.util.equals(_n,t,r)}};c(_n,"runtime",h),c(_n,"typeName","yorkie.v1.ActivateClientResponse"),c(_n,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9}]));let Fa=_n;const Yn=class Yn extends P{constructor(t){super();c(this,"clientId","");h.util.initPartial(t,this)}static fromBinary(t,r){return new Yn().fromBinary(t,r)}static fromJson(t,r){return new Yn().fromJson(t,r)}static fromJsonString(t,r){return new Yn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Yn,t,r)}};c(Yn,"runtime",h),c(Yn,"typeName","yorkie.v1.DeactivateClientRequest"),c(Yn,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9}]));let $a=Yn;const Xn=class Xn extends P{constructor(e){super(),h.util.initPartial(e,this)}static fromBinary(e,t){return new Xn().fromBinary(e,t)}static fromJson(e,t){return new Xn().fromJson(e,t)}static fromJsonString(e,t){return new Xn().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Xn,e,t)}};c(Xn,"runtime",h),c(Xn,"typeName","yorkie.v1.DeactivateClientResponse"),c(Xn,"fields",h.util.newFieldList(()=>[]));let Ma=Xn;const Zn=class Zn extends P{constructor(t){super();c(this,"clientId","");c(this,"changePack");c(this,"schemaKey","");h.util.initPartial(t,this)}static fromBinary(t,r){return new Zn().fromBinary(t,r)}static fromJson(t,r){return new Zn().fromJson(t,r)}static fromJsonString(t,r){return new Zn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Zn,t,r)}};c(Zn,"runtime",h),c(Zn,"typeName","yorkie.v1.AttachDocumentRequest"),c(Zn,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:Ar},{no:3,name:"schema_key",kind:"scalar",T:9}]));let Ua=Zn;const Qn=class Qn extends P{constructor(t){super();c(this,"documentId","");c(this,"changePack");c(this,"maxSizePerDocument",0);c(this,"schemaRules",[]);h.util.initPartial(t,this)}static fromBinary(t,r){return new Qn().fromBinary(t,r)}static fromJson(t,r){return new Qn().fromJson(t,r)}static fromJsonString(t,r){return new Qn().fromJsonString(t,r)}static equals(t,r){return h.util.equals(Qn,t,r)}};c(Qn,"runtime",h),c(Qn,"typeName","yorkie.v1.AttachDocumentResponse"),c(Qn,"fields",h.util.newFieldList(()=>[{no:1,name:"document_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:Ar},{no:3,name:"max_size_per_document",kind:"scalar",T:5},{no:4,name:"schema_rules",kind:"message",T:To,repeated:!0}]));let qa=Qn;const er=class er extends P{constructor(t){super();c(this,"clientId","");c(this,"documentId","");c(this,"changePack");c(this,"removeIfNotAttached",!1);h.util.initPartial(t,this)}static fromBinary(t,r){return new er().fromBinary(t,r)}static fromJson(t,r){return new er().fromJson(t,r)}static fromJsonString(t,r){return new er().fromJsonString(t,r)}static equals(t,r){return h.util.equals(er,t,r)}};c(er,"runtime",h),c(er,"typeName","yorkie.v1.DetachDocumentRequest"),c(er,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:Ar},{no:4,name:"remove_if_not_attached",kind:"scalar",T:8}]));let za=er;const tr=class tr extends P{constructor(t){super();c(this,"changePack");h.util.initPartial(t,this)}static fromBinary(t,r){return new tr().fromBinary(t,r)}static fromJson(t,r){return new tr().fromJson(t,r)}static fromJsonString(t,r){return new tr().fromJsonString(t,r)}static equals(t,r){return h.util.equals(tr,t,r)}};c(tr,"runtime",h),c(tr,"typeName","yorkie.v1.DetachDocumentResponse"),c(tr,"fields",h.util.newFieldList(()=>[{no:2,name:"change_pack",kind:"message",T:Ar}]));let Va=tr;const nr=class nr extends P{constructor(t){super();c(this,"clientId","");c(this,"documentId","");h.util.initPartial(t,this)}static fromBinary(t,r){return new nr().fromBinary(t,r)}static fromJson(t,r){return new nr().fromJson(t,r)}static fromJsonString(t,r){return new nr().fromJsonString(t,r)}static equals(t,r){return h.util.equals(nr,t,r)}};c(nr,"runtime",h),c(nr,"typeName","yorkie.v1.WatchDocumentRequest"),c(nr,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9}]));let Ka=nr;const rr=class rr extends P{constructor(t){super();c(this,"body",{case:void 0});h.util.initPartial(t,this)}static fromBinary(t,r){return new rr().fromBinary(t,r)}static fromJson(t,r){return new rr().fromJson(t,r)}static fromJsonString(t,r){return new rr().fromJsonString(t,r)}static equals(t,r){return h.util.equals(rr,t,r)}};c(rr,"runtime",h),c(rr,"typeName","yorkie.v1.WatchDocumentResponse"),c(rr,"fields",h.util.newFieldList(()=>[{no:1,name:"initialization",kind:"message",T:Ha,oneof:"body"},{no:2,name:"event",kind:"message",T:Ba,oneof:"body"}]));let ja=rr;const sr=class sr extends P{constructor(t){super();c(this,"clientIds",[]);h.util.initPartial(t,this)}static fromBinary(t,r){return new sr().fromBinary(t,r)}static fromJson(t,r){return new sr().fromJson(t,r)}static fromJsonString(t,r){return new sr().fromJsonString(t,r)}static equals(t,r){return h.util.equals(sr,t,r)}};c(sr,"runtime",h),c(sr,"typeName","yorkie.v1.WatchDocumentResponse.Initialization"),c(sr,"fields",h.util.newFieldList(()=>[{no:1,name:"client_ids",kind:"scalar",T:9,repeated:!0}]));let Ha=sr;const ir=class ir extends P{constructor(t){super();c(this,"clientId","");c(this,"documentId","");c(this,"changePack");h.util.initPartial(t,this)}static fromBinary(t,r){return new ir().fromBinary(t,r)}static fromJson(t,r){return new ir().fromJson(t,r)}static fromJsonString(t,r){return new ir().fromJsonString(t,r)}static equals(t,r){return h.util.equals(ir,t,r)}};c(ir,"runtime",h),c(ir,"typeName","yorkie.v1.RemoveDocumentRequest"),c(ir,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:Ar}]));let Wa=ir;const or=class or extends P{constructor(t){super();c(this,"changePack");h.util.initPartial(t,this)}static fromBinary(t,r){return new or().fromBinary(t,r)}static fromJson(t,r){return new or().fromJson(t,r)}static fromJsonString(t,r){return new or().fromJsonString(t,r)}static equals(t,r){return h.util.equals(or,t,r)}};c(or,"runtime",h),c(or,"typeName","yorkie.v1.RemoveDocumentResponse"),c(or,"fields",h.util.newFieldList(()=>[{no:1,name:"change_pack",kind:"message",T:Ar}]));let Ga=or;const ar=class ar extends P{constructor(t){super();c(this,"clientId","");c(this,"documentId","");c(this,"changePack");c(this,"pushOnly",!1);h.util.initPartial(t,this)}static fromBinary(t,r){return new ar().fromBinary(t,r)}static fromJson(t,r){return new ar().fromJson(t,r)}static fromJsonString(t,r){return new ar().fromJsonString(t,r)}static equals(t,r){return h.util.equals(ar,t,r)}};c(ar,"runtime",h),c(ar,"typeName","yorkie.v1.PushPullChangesRequest"),c(ar,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:Ar},{no:4,name:"push_only",kind:"scalar",T:8}]));let _a=ar;const cr=class cr extends P{constructor(t){super();c(this,"changePack");h.util.initPartial(t,this)}static fromBinary(t,r){return new cr().fromBinary(t,r)}static fromJson(t,r){return new cr().fromJson(t,r)}static fromJsonString(t,r){return new cr().fromJsonString(t,r)}static equals(t,r){return h.util.equals(cr,t,r)}};c(cr,"runtime",h),c(cr,"typeName","yorkie.v1.PushPullChangesResponse"),c(cr,"fields",h.util.newFieldList(()=>[{no:1,name:"change_pack",kind:"message",T:Ar}]));let Ya=cr;const ur=class ur extends P{constructor(t){super();c(this,"clientId","");c(this,"documentId","");c(this,"topic","");c(this,"payload",new Uint8Array(0));h.util.initPartial(t,this)}static fromBinary(t,r){return new ur().fromBinary(t,r)}static fromJson(t,r){return new ur().fromJson(t,r)}static fromJsonString(t,r){return new ur().fromJsonString(t,r)}static equals(t,r){return h.util.equals(ur,t,r)}};c(ur,"runtime",h),c(ur,"typeName","yorkie.v1.BroadcastRequest"),c(ur,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"payload",kind:"scalar",T:12}]));let Xa=ur;const lr=class lr extends P{constructor(e){super(),h.util.initPartial(e,this)}static fromBinary(e,t){return new lr().fromBinary(e,t)}static fromJson(e,t){return new lr().fromJson(e,t)}static fromJsonString(e,t){return new lr().fromJsonString(e,t)}static equals(e,t){return h.util.equals(lr,e,t)}};c(lr,"runtime",h),c(lr,"typeName","yorkie.v1.BroadcastResponse"),c(lr,"fields",h.util.newFieldList(()=>[]));let Za=lr;const xp={typeName:"yorkie.v1.YorkieService",methods:{activateClient:{name:"ActivateClient",I:Ja,O:Fa,kind:Le.Unary},deactivateClient:{name:"DeactivateClient",I:$a,O:Ma,kind:Le.Unary},attachDocument:{name:"AttachDocument",I:Ua,O:qa,kind:Le.Unary},detachDocument:{name:"DetachDocument",I:za,O:Va,kind:Le.Unary},removeDocument:{name:"RemoveDocument",I:Wa,O:Ga,kind:Le.Unary},pushPullChanges:{name:"PushPullChanges",I:_a,O:Ya,kind:Le.Unary},watchDocument:{name:"WatchDocument",I:Ka,O:ja,kind:Le.ServerStreaming},broadcast:{name:"Broadcast",I:Xa,O:Za,kind:Le.Unary}}},kp=h.makeMessageType("google.rpc.ErrorInfo",()=>[{no:1,name:"reason",kind:"scalar",T:9},{no:2,name:"domain",kind:"scalar",T:9},{no:3,name:"metadata",kind:"map",K:9,V:{kind:"scalar",T:9}}]);h.makeMessageType("google.rpc.RetryInfo",()=>[{no:1,name:"retry_delay",kind:"message",T:gr}]);h.makeMessageType("google.rpc.DebugInfo",()=>[{no:1,name:"stack_entries",kind:"scalar",T:9,repeated:!0},{no:2,name:"detail",kind:"scalar",T:9}]);h.makeMessageType("google.rpc.QuotaFailure",()=>[{no:1,name:"violations",kind:"message",T:Ep,repeated:!0}]);const Ep=h.makeMessageType("google.rpc.QuotaFailure.Violation",()=>[{no:1,name:"subject",kind:"scalar",T:9},{no:2,name:"description",kind:"scalar",T:9}],{localName:"QuotaFailure_Violation"});h.makeMessageType("google.rpc.PreconditionFailure",()=>[{no:1,name:"violations",kind:"message",T:Np,repeated:!0}]);const Np=h.makeMessageType("google.rpc.PreconditionFailure.Violation",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"subject",kind:"scalar",T:9},{no:3,name:"description",kind:"scalar",T:9}],{localName:"PreconditionFailure_Violation"});h.makeMessageType("google.rpc.BadRequest",()=>[{no:1,name:"field_violations",kind:"message",T:Pp,repeated:!0}]);const Pp=h.makeMessageType("google.rpc.BadRequest.FieldViolation",()=>[{no:1,name:"field",kind:"scalar",T:9},{no:2,name:"description",kind:"scalar",T:9},{no:3,name:"reason",kind:"scalar",T:9},{no:4,name:"localized_message",kind:"message",T:Dp}],{localName:"BadRequest_FieldViolation"});h.makeMessageType("google.rpc.RequestInfo",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"serving_data",kind:"scalar",T:9}]);h.makeMessageType("google.rpc.ResourceInfo",()=>[{no:1,name:"resource_type",kind:"scalar",T:9},{no:2,name:"resource_name",kind:"scalar",T:9},{no:3,name:"owner",kind:"scalar",T:9},{no:4,name:"description",kind:"scalar",T:9}]);h.makeMessageType("google.rpc.Help",()=>[{no:1,name:"links",kind:"message",T:Cp,repeated:!0}]);const Cp=h.makeMessageType("google.rpc.Help.Link",()=>[{no:1,name:"description",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9}],{localName:"Help_Link"}),Dp=h.makeMessageType("google.rpc.LocalizedMessage",()=>[{no:1,name:"locale",kind:"scalar",T:9},{no:2,name:"message",kind:"scalar",T:9}]);var v=(n=>(n.Ok="ok",n.ErrClientNotActivated="ErrClientNotActivated",n.ErrClientNotFound="ErrClientNotFound",n.ErrUnimplemented="ErrUnimplemented",n.ErrInvalidType="ErrInvalidType",n.ErrDummy="ErrDummy",n.ErrDocumentNotAttached="ErrDocumentNotAttached",n.ErrDocumentNotDetached="ErrDocumentNotDetached",n.ErrDocumentRemoved="ErrDocumentRemoved",n.ErrDocumentSizeExceedsLimit="ErrDocumentSizeExceedsLimit",n.ErrDocumentSchemaValidationFailed="ErrDocumentSchemaValidationFailed",n.ErrInvalidObjectKey="ErrInvalidObjectKey",n.ErrInvalidArgument="ErrInvalidArgument",n.ErrNotInitialized="ErrNotInitialized",n.ErrNotReady="ErrNotReady",n.ErrRefused="ErrRefused",n.ErrContextNotProvided="ErrContextNotProvided",n.ErrPermissionDenied="ErrPermissionDenied",n.ErrUnauthenticated="ErrUnauthenticated",n.ErrTooManySubscribers="ErrTooManySubscribers",n.ErrTooManyAttachments="ErrTooManyAttachments",n))(v||{});class w extends Error{constructor(t,r){super(r);c(this,"name","YorkieError");c(this,"stack");this.code=t,this.message=r,this.toString=()=>`[code=${this.code}]: ${this.message}`}}var Yt=(n=>(n.Put="put",n.Clear="clear",n))(Yt||{});const Mo="000000000000000000000000",Ht=24;class yt{constructor(e,t,r){c(this,"lamport");c(this,"delimiter");c(this,"actorID");this.lamport=e,this.delimiter=t,this.actorID=r}static of(e,t,r){return new yt(e,t,r)}static fromStruct(e){return yt.of(BigInt(e.lamport),e.delimiter,e.actorID)}toIDString(){return`${this.lamport.toString()}:${this.actorID}:${this.delimiter}`}toStruct(){return{lamport:this.getLamportAsString(),delimiter:this.getDelimiter(),actorID:this.getActorID()}}toTestString(){return`${this.lamport.toString()}:${this.actorID.slice(-2)}:${this.delimiter}`}setActor(e){return new yt(this.lamport,this.delimiter,e)}getLamportAsString(){return this.lamport.toString()}getLamport(){return this.lamport}getDelimiter(){return this.delimiter}getActorID(){return this.actorID}after(e){return this.compare(e)>0}equals(e){return this.compare(e)===0}compare(e){if(this.lamport>e.lamport)return 1;if(e.lamport>this.lamport)return-1;const t=this.actorID.localeCompare(e.actorID);return t!==0?t:this.delimiter>e.delimiter?1:e.delimiter>this.delimiter?-1:0}}const Qa=0n,Zf=0,Qs=9223372036854775807n,Ns=new yt(Qa,Zf,Mo);function Kt(n){return n.replace(/["'\\\n\r\f\b\t\u2028\u2029]/g,function(e){switch(e){case'"':case"\\":return"\\"+e;case`
`:return"\\n";case"\r":return"\\r";case"\f":return"\\f";case"\b":return"\\b";case"	":return"\\t";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e}})}class bi{constructor(e){c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");this.createdAt=e}getCreatedAt(){return this.createdAt}getID(){return this.createdAt}getMovedAt(){return this.movedAt}getRemovedAt(){return this.removedAt}getPositionedAt(){return this.movedAt?this.movedAt:this.createdAt}setMovedAt(e){return!this.movedAt||e&&e.after(this.movedAt)?(this.movedAt=e,!0):!1}setRemovedAt(e){this.removedAt=e}remove(e){return e&&e.after(this.getPositionedAt())&&(!this.removedAt||e.after(this.removedAt))?(this.removedAt=e,!0):!1}isRemoved(){return!!this.removedAt}getMetaUsage(){let e=0;return this.getCreatedAt()&&(e+=Ht),this.getMovedAt()&&(e+=Ht),this.getRemovedAt()&&(e+=Ht),e}}class Br extends bi{constructor(e){super(e)}}class kc{constructor(e,t){c(this,"strKey");c(this,"value");this.strKey=e,this.value=t}static of(e,t){return new kc(e,t)}isRemoved(){return this.value.isRemoved()}getStrKey(){return this.strKey}getValue(){return this.value}remove(e){return this.value.remove(e)}}class hi{constructor(){c(this,"nodeMapByKey");c(this,"nodeMapByCreatedAt");this.nodeMapByKey=new Map,this.nodeMapByCreatedAt=new Map}static create(){return new hi}set(e,t,r){let s;const i=this.nodeMapByKey.get(e);i!=null&&!i.isRemoved()&&i.remove(r)&&(s=i.getValue());const o=kc.of(e,t);return this.nodeMapByCreatedAt.set(t.getCreatedAt().toIDString(),o),(i==null||r.after(i.getValue().getPositionedAt()))&&(this.nodeMapByKey.set(e,o),t.setMovedAt(r)),s}delete(e,t){if(!this.nodeMapByCreatedAt.has(e.toIDString()))throw new w(v.ErrInvalidArgument,`fail to find ${e.toIDString()}`);const r=this.nodeMapByCreatedAt.get(e.toIDString());return r.remove(t),r.getValue()}subPathOf(e){const t=this.nodeMapByCreatedAt.get(e.toIDString());if(t)return t.getStrKey()}purge(e){const t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!t)throw new w(v.ErrInvalidArgument,`fail to find ${e.getCreatedAt().toIDString()}`);const r=this.nodeMapByKey.get(t.getStrKey());t===r&&this.nodeMapByKey.delete(r.getStrKey()),this.nodeMapByCreatedAt.delete(t.getValue().getCreatedAt().toIDString())}deleteByKey(e,t){const r=this.nodeMapByKey.get(e);if(r!=null&&r.remove(t))return r.getValue()}has(e){const t=this.nodeMapByKey.get(e);return t==null?!1:!t.isRemoved()}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}get(e){const t=this.nodeMapByKey.get(e);if(!(!t||t.isRemoved()))return t}*[Symbol.iterator](){for(const[,e]of this.nodeMapByKey)yield e}}class Ce extends Br{constructor(t,r){super(t);c(this,"memberNodes");this.memberNodes=r}static create(t,r){if(!r)return new Ce(t,hi.create());const s=hi.create();for(const[i,o]of Object.entries(r))s.set(i,o.deepcopy(),o.getCreatedAt());return new Ce(t,s)}subPathOf(t){return this.memberNodes.subPathOf(t)}purge(t){this.memberNodes.purge(t)}set(t,r,s){return this.memberNodes.set(t,r,s)}delete(t,r){return this.memberNodes.delete(t,r)}deleteByKey(t,r){return this.memberNodes.deleteByKey(t,r)}get(t){const r=this.memberNodes.get(t);return r==null?void 0:r.getValue()}getByID(t){const r=this.memberNodes.getByID(t);return r==null?void 0:r.getValue()}has(t){return this.memberNodes.has(t)}getDataSize(){return{data:0,meta:this.getMetaUsage()}}toJSON(){const t=[];for(const[r,s]of this)t.push(`"${Kt(r)}":${s.toJSON()}`);return`{${t.join(",")}}`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const t={};for(const[r,s]of this){const{createdAt:i,value:o,type:a}=s.toJSForTest();t[r]={key:r,createdAt:i,value:o,type:a}}return{createdAt:this.getCreatedAt().toTestString(),value:t,type:"YORKIE_OBJECT"}}getKeys(){const t=Array();for(const[r]of this)t.push(r);return t}toSortedJSON(){var s;const t=Array();for(const[i]of this)t.push(i);const r=[];for(const i of t.sort()){const o=(s=this.memberNodes.get(i))==null?void 0:s.getValue();r.push(`"${Kt(i)}":${o.toSortedJSON()}`)}return`{${r.join(",")}}`}getRHT(){return this.memberNodes}deepcopy(){const t=Ce.create(this.getCreatedAt());for(const r of this.memberNodes)t.memberNodes.set(r.getStrKey(),r.getValue().deepcopy(),this.getPositionedAt());return t.remove(this.getRemovedAt()),t}getDescendants(t){for(const r of this.memberNodes){const s=r.getValue();if(t(s,this))return;s instanceof Br&&s.getDescendants(t)}}*[Symbol.iterator](){const t=new Set;for(const r of this.memberNodes)t.has(r.getStrKey())||(t.add(r.getStrKey()),r.isRemoved()||(yield[r.getStrKey(),r.getValue()]))}}var ce=(n=>(n.Local="local",n.Remote="remote",n.UndoRedo="undoredo",n))(ce||{});class kt{constructor(e,t){c(this,"parentCreatedAt");c(this,"executedAt");this.parentCreatedAt=e,this.executedAt=t}getParentCreatedAt(){return this.parentCreatedAt}getExecutedAt(){if(!this.executedAt)throw new w(v.ErrNotReady,"executedAt is not set yet");return this.executedAt}setActor(e){this.executedAt&&(this.executedAt=this.executedAt.setActor(e))}setExecutedAt(e){this.executedAt=e}}class Qf{constructor(e){c(this,"value");c(this,"left");c(this,"right");c(this,"parent");c(this,"weight");this.value=e,this.initWeight()}getNodeString(){return`${this.weight}${this.value}`}getValue(){return this.value}getLeftWeight(){return this.hasLeft()?this.left.getWeight():0}getRightWeight(){return this.hasRight()?this.right.getWeight():0}getWeight(){return this.weight}getLeft(){return this.left}getRight(){return this.right}getParent(){return this.parent}hasLeft(){return!!this.left}hasRight(){return!!this.right}hasParent(){return!!this.parent}setLeft(e){this.left=e}setRight(e){this.right=e}setParent(e){this.parent=e}unlink(){this.parent=void 0,this.right=void 0,this.left=void 0}hasLinks(){return this.hasParent()||this.hasLeft()||this.hasRight()}increaseWeight(e){this.weight+=e}initWeight(){this.weight=this.getLength()}}class di{constructor(e){c(this,"root");this.root=e}get length(){return this.root?this.root.getWeight():0}find(e){if(!this.root||e<0)return[void 0,0];let t=this.root;for(;;)if(t.hasLeft()&&e<=t.getLeftWeight())t=t.getLeft();else if(t.hasRight()&&t.getLeftWeight()+t.getLength()<e)e-=t.getLeftWeight()+t.getLength(),t=t.getRight();else{e-=t.getLeftWeight();break}if(e>t.getLength())throw new w(v.ErrInvalidArgument,`out of index range: pos: ${e} > node.length: ${t.getLength()}`);return this.splayNode(t),[t,e]}indexOf(e){return!e||e!==this.root&&!e.hasLinks()?-1:(this.splayNode(e),this.root.getLeftWeight())}getRoot(){return this.root}insert(e){return this.insertAfter(this.root,e)}insertAfter(e,t){return e?(this.splayNode(e),this.root=t,t.setRight(e.getRight()),e.hasRight()&&e.getRight().setParent(t),t.setLeft(e),e.setParent(t),e.setRight(),this.updateWeight(e),this.updateWeight(t),t):(this.root=t,t)}updateWeight(e){e.initWeight(),e.hasLeft()&&e.increaseWeight(e.getLeftWeight()),e.hasRight()&&e.increaseWeight(e.getRightWeight())}updateTreeWeight(e){for(;e;)this.updateWeight(e),e=e.getParent()}splayNode(e){if(e)for(;;)if(this.isLeftChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e),this.rotateLeft(e);else if(this.isLeftChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e.getParent()),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e.getParent()),this.rotateLeft(e);else{this.isLeftChild(e)?this.rotateRight(e):this.isRightChild(e)&&this.rotateLeft(e),this.updateWeight(e);return}}delete(e){this.splayNode(e);const t=new di(e.getLeft());t.root&&t.root.setParent();const r=new di(e.getRight());if(r.root&&r.root.setParent(),t.root){const s=t.getRightmost();t.splayNode(s),t.root.setRight(r.root),r.root&&r.root.setParent(t.root),this.root=t.root}else this.root=r.root;e.unlink(),this.root&&this.updateWeight(this.root)}deleteRange(e,t){if(!t){this.splayNode(e),this.cutOffRight(e);return}this.splayNode(e),this.splayNode(t),t.getLeft()!=e&&this.rotateRight(e),this.cutOffRight(e)}cutOffRight(e){const t=[];this.traversePostorder(e.getRight(),t);for(const r of t)r.initWeight();this.updateTreeWeight(e)}toTestString(){const e=[];return this.traverseInorder(this.root,e),e.map(t=>`[${t.getWeight()},${t.getLength()}]${t.getValue()||""}`).join("")}checkWeight(){const e=[];this.traverseInorder(this.root,e);for(const t of e)if(t.getWeight()!=t.getLength()+t.getLeftWeight()+t.getRightWeight())return!1;return!0}getRightmost(){let e=this.root;for(;e.hasRight();)e=e.getRight();return e}traverseInorder(e,t){e&&(this.traverseInorder(e.getLeft(),t),t.push(e),this.traverseInorder(e.getRight(),t))}traversePostorder(e,t){e&&(this.traversePostorder(e.getLeft(),t),this.traversePostorder(e.getRight(),t),t.push(e))}rotateLeft(e){const t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setRight(e.getLeft()),t.hasRight()&&t.getRight().setParent(t),e.setLeft(t),e.getLeft().setParent(e),this.updateWeight(t),this.updateWeight(e)}rotateRight(e){const t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setLeft(e.getRight()),t.hasLeft()&&t.getLeft().setParent(t),e.setRight(t),e.getRight().setParent(e),this.updateWeight(t),this.updateWeight(e)}isLeftChild(e){return e&&e.hasParent()?e.getParent().getLeft()===e:!1}isRightChild(e){return e&&e.hasParent()?e.getParent().getRight()===e:!1}}/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var mt=null;try{mt=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Z(n,e,t){this.low=n|0,this.high=e|0,this.unsigned=!!t}Z.prototype.__isLong__;Object.defineProperty(Z.prototype,"__isLong__",{value:!0});function De(n){return(n&&n.__isLong__)===!0}function ol(n){var e=Math.clz32(n&-n);return n?31-e:e}Z.isLong=De;var al={},cl={};function ss(n,e){var t,r,s;return e?(n>>>=0,(s=0<=n&&n<256)&&(r=cl[n],r)?r:(t=te(n,0,!0),s&&(cl[n]=t),t)):(n|=0,(s=-128<=n&&n<128)&&(r=al[n],r)?r:(t=te(n,n<0?-1:0,!1),s&&(al[n]=t),t))}Z.fromInt=ss;function pt(n,e){if(isNaN(n))return e?pr:Tt;if(e){if(n<0)return pr;if(n>=eh)return rh}else{if(n<=-9223372036854776e3)return je;if(n+1>=Rp)return nh}return n<0?pt(-n,e).neg():te(n%Ps|0,n/Ps|0,e)}Z.fromNumber=pt;function te(n,e,t){return new Z(n,e,t)}Z.fromBits=te;var So=Math.pow;function Ec(n,e,t){if(n.length===0)throw Error("empty string");if(typeof e=="number"?(t=e,e=!1):e=!!e,n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return e?pr:Tt;if(t=t||10,t<2||36<t)throw RangeError("radix");var r;if((r=n.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return Ec(n.substring(1),e,t).neg();for(var s=pt(So(t,8)),i=Tt,o=0;o<n.length;o+=8){var a=Math.min(8,n.length-o),u=parseInt(n.substring(o,o+a),t);if(a<8){var l=pt(So(t,a));i=i.mul(l).add(pt(u))}else i=i.mul(s),i=i.add(pt(u))}return i.unsigned=e,i}Z.fromString=Ec;function vt(n,e){return typeof n=="number"?pt(n,e):typeof n=="string"?Ec(n,e):te(n.low,n.high,typeof e=="boolean"?e:n.unsigned)}Z.fromValue=vt;var ul=65536,Op=1<<24,Ps=ul*ul,eh=Ps*Ps,Rp=eh/2,ll=ss(Op),Tt=ss(0);Z.ZERO=Tt;var pr=ss(0,!0);Z.UZERO=pr;var hs=ss(1);Z.ONE=hs;var th=ss(1,!0);Z.UONE=th;var ec=ss(-1);Z.NEG_ONE=ec;var nh=te(-1,2147483647,!1);Z.MAX_VALUE=nh;var rh=te(-1,-1,!0);Z.MAX_UNSIGNED_VALUE=rh;var je=te(0,-2147483648,!1);Z.MIN_VALUE=je;var k=Z.prototype;k.toInt=function(){return this.unsigned?this.low>>>0:this.low};k.toNumber=function(){return this.unsigned?(this.high>>>0)*Ps+(this.low>>>0):this.high*Ps+(this.low>>>0)};k.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(je)){var t=pt(e),r=this.div(t),s=r.mul(t).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=pt(So(e,6),this.unsigned),o=this,a="";;){var u=o.div(i),l=o.sub(u.mul(i)).toInt()>>>0,f=l.toString(e);if(o=u,o.isZero())return f+a;for(;f.length<6;)f="0"+f;a=""+f+a}};k.getHighBits=function(){return this.high};k.getHighBitsUnsigned=function(){return this.high>>>0};k.getLowBits=function(){return this.low};k.getLowBitsUnsigned=function(){return this.low>>>0};k.getNumBitsAbs=function(){if(this.isNegative())return this.eq(je)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};k.isSafeInteger=function(){var e=this.high>>21;return e?this.unsigned?!1:e===-1&&!(this.low===0&&this.high===-2097152):!0};k.isZero=function(){return this.high===0&&this.low===0};k.eqz=k.isZero;k.isNegative=function(){return!this.unsigned&&this.high<0};k.isPositive=function(){return this.unsigned||this.high>=0};k.isOdd=function(){return(this.low&1)===1};k.isEven=function(){return(this.low&1)===0};k.equals=function(e){return De(e)||(e=vt(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};k.eq=k.equals;k.notEquals=function(e){return!this.eq(e)};k.neq=k.notEquals;k.ne=k.notEquals;k.lessThan=function(e){return this.comp(e)<0};k.lt=k.lessThan;k.lessThanOrEqual=function(e){return this.comp(e)<=0};k.lte=k.lessThanOrEqual;k.le=k.lessThanOrEqual;k.greaterThan=function(e){return this.comp(e)>0};k.gt=k.greaterThan;k.greaterThanOrEqual=function(e){return this.comp(e)>=0};k.gte=k.greaterThanOrEqual;k.ge=k.greaterThanOrEqual;k.compare=function(e){if(De(e)||(e=vt(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};k.comp=k.compare;k.negate=function(){return!this.unsigned&&this.eq(je)?je:this.not().add(hs)};k.neg=k.negate;k.add=function(e){De(e)||(e=vt(e));var t=this.high>>>16,r=this.high&65535,s=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,u=e.low>>>16,l=e.low&65535,f=0,d=0,y=0,m=0;return m+=i+l,y+=m>>>16,m&=65535,y+=s+u,d+=y>>>16,y&=65535,d+=r+a,f+=d>>>16,d&=65535,f+=t+o,f&=65535,te(y<<16|m,f<<16|d,this.unsigned)};k.subtract=function(e){return De(e)||(e=vt(e)),this.add(e.neg())};k.sub=k.subtract;k.multiply=function(e){if(this.isZero())return this;if(De(e)||(e=vt(e)),mt){var t=mt.mul(this.low,this.high,e.low,e.high);return te(t,mt.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?pr:Tt;if(this.eq(je))return e.isOdd()?je:Tt;if(e.eq(je))return this.isOdd()?je:Tt;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(ll)&&e.lt(ll))return pt(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,u=e.high&65535,l=e.low>>>16,f=e.low&65535,d=0,y=0,m=0,S=0;return S+=o*f,m+=S>>>16,S&=65535,m+=i*f,y+=m>>>16,m&=65535,m+=o*l,y+=m>>>16,m&=65535,y+=s*f,d+=y>>>16,y&=65535,y+=i*l,d+=y>>>16,y&=65535,y+=o*u,d+=y>>>16,y&=65535,d+=r*f+s*l+i*u+o*a,d&=65535,te(m<<16|S,d<<16|y,this.unsigned)};k.mul=k.multiply;k.divide=function(e){if(De(e)||(e=vt(e)),e.isZero())throw Error("division by zero");if(mt){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?mt.div_u:mt.div_s)(this.low,this.high,e.low,e.high);return te(t,mt.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?pr:Tt;var r,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return pr;if(e.gt(this.shru(1)))return th;i=pr}else{if(this.eq(je)){if(e.eq(hs)||e.eq(ec))return je;if(e.eq(je))return hs;var o=this.shr(1);return r=o.div(e).shl(1),r.eq(Tt)?e.isNegative()?hs:ec:(s=this.sub(e.mul(r)),i=r.add(s.div(e)),i)}else if(e.eq(je))return this.unsigned?pr:Tt;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=Tt}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),u=a<=48?1:So(2,a-48),l=pt(r),f=l.mul(e);f.isNegative()||f.gt(s);)r-=u,l=pt(r,this.unsigned),f=l.mul(e);l.isZero()&&(l=hs),i=i.add(l),s=s.sub(f)}return i};k.div=k.divide;k.modulo=function(e){if(De(e)||(e=vt(e)),mt){var t=(this.unsigned?mt.rem_u:mt.rem_s)(this.low,this.high,e.low,e.high);return te(t,mt.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};k.mod=k.modulo;k.rem=k.modulo;k.not=function(){return te(~this.low,~this.high,this.unsigned)};k.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};k.clz=k.countLeadingZeros;k.countTrailingZeros=function(){return this.low?ol(this.low):ol(this.high)+32};k.ctz=k.countTrailingZeros;k.and=function(e){return De(e)||(e=vt(e)),te(this.low&e.low,this.high&e.high,this.unsigned)};k.or=function(e){return De(e)||(e=vt(e)),te(this.low|e.low,this.high|e.high,this.unsigned)};k.xor=function(e){return De(e)||(e=vt(e)),te(this.low^e.low,this.high^e.high,this.unsigned)};k.shiftLeft=function(e){return De(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?te(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):te(0,this.low<<e-32,this.unsigned)};k.shl=k.shiftLeft;k.shiftRight=function(e){return De(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?te(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):te(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};k.shr=k.shiftRight;k.shiftRightUnsigned=function(e){return De(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?te(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?te(this.high,0,this.unsigned):te(this.high>>>e-32,0,this.unsigned)};k.shru=k.shiftRightUnsigned;k.shr_u=k.shiftRightUnsigned;k.rotateLeft=function(e){var t;return De(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?te(this.high,this.low,this.unsigned):e<32?(t=32-e,te(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,te(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))};k.rotl=k.rotateLeft;k.rotateRight=function(e){var t;return De(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?te(this.high,this.low,this.unsigned):e<32?(t=32-e,te(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,te(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))};k.rotr=k.rotateRight;k.toSigned=function(){return this.unsigned?te(this.low,this.high,!1):this};k.toUnsigned=function(){return this.unsigned?this:te(this.low,this.high,!0)};k.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};k.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};k.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Z.fromBytes=function(e,t,r){return r?Z.fromBytesLE(e,t):Z.fromBytesBE(e,t)};Z.fromBytesLE=function(e,t){return new Z(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Z.fromBytesBE=function(e,t){return new Z(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};typeof BigInt=="function"&&(Z.fromBigInt=function(e,t){var r=Number(BigInt.asIntN(32,e)),s=Number(BigInt.asIntN(32,e>>BigInt(32)));return te(r,s,t)},Z.fromValue=function(e,t){return typeof e=="bigint"?fromBigInt(e,t):vt(e,t)},k.toBigInt=function(){var e=BigInt(this.low>>>0),t=BigInt(this.unsigned?this.high>>>0:this.high);return t<<BigInt(32)|e});var le=(n=>(n[n.Null=0]="Null",n[n.Boolean=1]="Boolean",n[n.Integer=2]="Integer",n[n.Long=3]="Long",n[n.Double=4]="Double",n[n.String=5]="String",n[n.Bytes=6]="Bytes",n[n.Date=7]="Date",n))(le||{});class pe extends bi{constructor(t,r){super(r);c(this,"valueType");c(this,"value");this.valueType=pe.getPrimitiveType(t),this.value=t===void 0?null:t}static of(t,r){return new pe(t,r)}static valueFromBytes(t,r){switch(t){case 0:return null;case 1:return!!r[0];case 2:return r[0]|r[1]<<8|r[2]<<16|r[3]<<24;case 4:{const s=new DataView(r.buffer);return r.forEach(function(i,o){s.setUint8(o,i)}),s.getFloat64(0,!0)}case 5:return new TextDecoder("utf-8").decode(r);case 3:return Z.fromBytesLE(Array.from(r));case 6:return r;case 7:return new Date(Z.fromBytesLE(Array.from(r),!0).toNumber());default:throw new w(v.ErrUnimplemented,`unimplemented type: ${t}`)}}getValueSize(){switch(this.valueType){case 0:return 8;case 1:return 4;case 2:return 4;case 3:return 8;case 4:return 8;case 5:return this.value.length*2;case 6:return this.value.length;case 7:return 8;default:throw new w(v.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}getDataSize(){return{data:this.getValueSize(),meta:this.getMetaUsage()}}toJSON(){return this.valueType===5?`"${Kt(this.value)}"`:`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_PRIMITIVE"}}deepcopy(){const t=pe.of(this.value,this.getCreatedAt());return t.setMovedAt(this.getMovedAt()),t.setRemovedAt(this.getRemovedAt()),t}getType(){return this.valueType}static getPrimitiveType(t){switch(typeof t){case"undefined":return 0;case"boolean":return 1;case"number":return this.isInteger(t)?2:4;case"string":return 5;case"object":if(t===null)return 0;if(t instanceof Z)return 3;if(t instanceof Uint8Array)return 6;if(t instanceof Date)return 7}}static isSupport(t){return pe.getPrimitiveType(t)!==void 0}static isInteger(t){return t%1===0}isNumericType(){const t=this.valueType;return t===2||t===3||t===4}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:return new Uint8Array;case 1:return this.value?new Uint8Array([1]):new Uint8Array([0]);case 2:{const t=this.value;return new Uint8Array([t&255,t>>8&255,t>>16&255,t>>24&255])}case 4:{const t=this.value,r=new Uint8Array(8);return new DataView(r.buffer).setFloat64(0,t,!0),r}case 5:return new TextEncoder().encode(this.value);case 3:{const r=this.value.toBytesLE();return Uint8Array.from(r)}case 6:return this.value;case 7:{const t=this.value,r=Z.fromNumber(t.getTime(),!0).toBytesLE();return Uint8Array.from(r)}default:throw new w(v.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}}class Io extends Qf{constructor(t){super(t);c(this,"prev");c(this,"next");this.value=t}static createAfter(t,r){const s=new Io(r),i=t.next;return t.next=s,s.prev=t,s.next=i,i&&(i.prev=s),s}remove(t){return this.value.remove(t)}getCreatedAt(){return this.value.getCreatedAt()}getPositionedAt(){return this.value.getPositionedAt()}release(){this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.prev=void 0,this.next=void 0}getLength(){return this.value.isRemoved()?0:1}getPrev(){return this.prev}getNext(){return this.next}getValue(){return this.value}isRemoved(){return this.value.isRemoved()}}class gi{constructor(){c(this,"dummyHead");c(this,"last");c(this,"nodeMapByIndex");c(this,"nodeMapByCreatedAt");const e=pe.of(0,Ns);e.setRemovedAt(Ns),this.dummyHead=new Io(e),this.last=this.dummyHead,this.nodeMapByIndex=new di,this.nodeMapByCreatedAt=new Map,this.nodeMapByIndex.insert(this.dummyHead),this.nodeMapByCreatedAt.set(this.dummyHead.getCreatedAt().toIDString(),this.dummyHead)}static create(){return new gi}get length(){return this.nodeMapByIndex.length}findNextBeforeExecutedAt(e,t){let r=this.nodeMapByCreatedAt.get(e.toIDString());if(!r)throw new w(v.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);for(;r.getNext()&&r.getNext().getPositionedAt().after(t);)r=r.getNext();return r}release(e){this.last===e&&(this.last=e.getPrev()),e.release(),this.nodeMapByIndex.delete(e),this.nodeMapByCreatedAt.delete(e.getValue().getCreatedAt().toIDString())}insertAfter(e,t,r=t.getCreatedAt()){const s=this.findNextBeforeExecutedAt(e,r),i=Io.createAfter(s,t);s===this.last&&(this.last=i),this.nodeMapByIndex.insertAfter(s,i),this.nodeMapByCreatedAt.set(i.getCreatedAt().toIDString(),i)}moveAfter(e,t,r){const s=this.nodeMapByCreatedAt.get(e.toIDString());if(!s)throw new w(v.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);const i=this.nodeMapByCreatedAt.get(t.toIDString());if(!i)throw new w(v.ErrInvalidArgument,`cant find the given node: ${t.toIDString()}`);s!==i&&(!i.getValue().getMovedAt()||r.after(i.getValue().getMovedAt()))&&(this.release(i),this.insertAfter(s.getCreatedAt(),i.getValue(),r),i.getValue().setMovedAt(r))}insert(e){this.insertAfter(this.last.getCreatedAt(),e)}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}subPathOf(e){const t=this.nodeMapByCreatedAt.get(e.toIDString());if(t)return String(this.nodeMapByIndex.indexOf(t))}purge(e){const t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!t)throw new w(v.ErrInvalidArgument,`fail to find the given createdAt: ${e.getCreatedAt().toIDString()}`);this.release(t)}getByIndex(e){if(e>=this.length)return;const[t,r]=this.nodeMapByIndex.find(e);let s=t;if(e===0&&t===this.dummyHead||r>0)do s&&(s=s.getNext());while(s&&s.isRemoved());return s}getPrevCreatedAt(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());do t=t.getPrev();while(this.dummyHead!==t&&t.isRemoved());return t.getValue().getCreatedAt()}delete(e,t){const r=this.nodeMapByCreatedAt.get(e.toIDString()),s=r.isRemoved();return r.remove(t)&&!s&&this.nodeMapByIndex.splayNode(r),r.getValue()}deleteByIndex(e,t){const r=this.getByIndex(e);if(r)return r.remove(t)&&this.nodeMapByIndex.splayNode(r),r.getValue()}getHead(){return this.dummyHead.getValue()}getLast(){return this.last.getValue()}getLastCreatedAt(){return this.last.getCreatedAt()}toTestString(){const e=[];for(const t of this){const r=`${t.getCreatedAt().toIDString()}:${t.getValue().toJSON()}`;t.isRemoved()?e.push(`{${r}}`):e.push(`[${r}]`)}return e.join("")}*[Symbol.iterator](){let e=this.dummyHead.getNext();for(;e;)yield e,e=e.getNext()}}class Me extends Br{constructor(t,r){super(t);c(this,"elements");this.elements=r}static create(t,r){if(!r)return new Me(t,gi.create());const s=gi.create();for(const i of r)s.insertAfter(s.getLastCreatedAt(),i.deepcopy());return new Me(t,s)}subPathOf(t){return this.elements.subPathOf(t)}purge(t){this.elements.purge(t)}insertAfter(t,r,s){this.elements.insertAfter(t,r,s)}moveAfter(t,r,s){this.elements.moveAfter(t,r,s)}get(t){const r=this.elements.getByIndex(t);return r==null?void 0:r.getValue()}getByID(t){const r=this.elements.getByID(t);return r==null?void 0:r.getValue()}getHead(){return this.elements.getHead()}getLast(){return this.elements.getLast()}getPrevCreatedAt(t){return this.elements.getPrevCreatedAt(t)}delete(t,r){return this.elements.delete(t,r)}deleteByIndex(t,r){return this.elements.deleteByIndex(t,r)}getLastCreatedAt(){return this.elements.getLastCreatedAt()}get length(){return this.elements.length}*[Symbol.iterator](){for(const t of this.elements)t.isRemoved()||(yield t.getValue())}toTestString(){return this.elements.toTestString()}getDescendants(t){for(const r of this.elements){const s=r.getValue();if(t(s,this))return;s instanceof Br&&s.getDescendants(t)}}getDataSize(){return{data:0,meta:this.getMetaUsage()}}toJSON(){const t=[];for(const r of this)t.push(r.toJSON());return`[${t.join(",")}]`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const t={};for(let r=0;r<this.length;r++){const{createdAt:s,value:i,type:o}=this.get(r).toJSForTest();t[r]={key:String(r),createdAt:s,value:i,type:o}}return{createdAt:this.getCreatedAt().toTestString(),value:t,type:"YORKIE_ARRAY"}}toSortedJSON(){return this.toJSON()}getElements(){return this.elements}deepcopy(){const t=Me.create(this.getCreatedAt());for(const r of this.elements)t.elements.insertAfter(t.getLastCreatedAt(),r.getValue().deepcopy());return t.remove(this.getRemovedAt()),t}}class Bs extends kt{constructor(t,r,s,i){super(t,i);c(this,"prevCreatedAt");c(this,"value");this.prevCreatedAt=r,this.value=s}static create(t,r,s,i){return new Bs(t,r,s,i)}execute(t){const r=t.findByCreatedAt(this.getParentCreatedAt());if(!r)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(r instanceof Me))throw new w(v.ErrInvalidArgument,"fail to execute, only array can execute add");const s=r,i=this.value.deepcopy();return s.insertAfter(this.prevCreatedAt,i,this.getExecutedAt()),t.registerElement(i,s),{opInfos:[{type:"add",path:t.createPath(this.getParentCreatedAt()),index:Number(s.subPathOf(this.getEffectedCreatedAt()))}],reverseOp:this.toReverseOperation()}}toReverseOperation(){return Tr.create(this.getParentCreatedAt(),this.value.getCreatedAt())}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.ADD.${this.value.toJSON()}`}getPrevCreatedAt(){return this.prevCreatedAt}getValue(){return this.value}}class Tr extends kt{constructor(t,r,s){super(t,s);c(this,"createdAt");this.createdAt=r}static create(t,r,s){return new Tr(t,r,s)}execute(t,r){var l;const s=t.findByCreatedAt(this.getParentCreatedAt());if(!s)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(s instanceof Br))throw new w(v.ErrInvalidArgument,`only object and array can execute remove: ${s}`);if(r===ce.UndoRedo){let f=s.getByID(this.createdAt);for(;f;){if(f.getRemovedAt())return;f=(l=t.findElementPairByCreatedAt(f.getCreatedAt()))==null?void 0:l.parent}}const i=s.subPathOf(this.createdAt),o=this.toReverseOperation(s),a=s.delete(this.createdAt,this.getExecutedAt());return t.registerRemovedElement(a),{opInfos:s instanceof Me?[{type:"remove",path:t.createPath(this.getParentCreatedAt()),index:Number(i)}]:[{type:"remove",path:t.createPath(this.getParentCreatedAt()),key:i}],reverseOp:o}}toReverseOperation(t){if(t instanceof Me){const r=t.getByID(this.createdAt);if(r!==void 0){const s=t.getPrevCreatedAt(this.createdAt);return Bs.create(this.getParentCreatedAt(),s,r.deepcopy())}}if(t instanceof Ce){const r=t.subPathOf(this.createdAt);if(r!==void 0){const s=t.get(r);if(s!==void 0)return rs.create(r,s.deepcopy(),this.getParentCreatedAt())}}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.REMOVE.${this.createdAt.toTestString()}`}getCreatedAt(){return this.createdAt}}class rs extends kt{constructor(t,r,s,i){super(s,i);c(this,"key");c(this,"value");this.key=t,this.value=r}static create(t,r,s,i){return new rs(t,r,s,i)}execute(t,r){var l;const s=t.findByCreatedAt(this.getParentCreatedAt());if(!s)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(s instanceof Ce))throw new w(v.ErrInvalidArgument,"fail to execute, only object can execute set");if(r===ce.UndoRedo){let f=s;for(;f;){if(f.getRemovedAt())return;f=(l=t.findElementPairByCreatedAt(f.getCreatedAt()))==null?void 0:l.parent}}const i=s.get(this.key),o=this.toReverseOperation(i),a=this.value.deepcopy(),u=s.set(this.key,a,this.getExecutedAt());return r===ce.UndoRedo&&t.findByCreatedAt(a.getCreatedAt())&&t.deregisterElement(a),t.registerElement(a,s),u&&t.registerRemovedElement(u),{opInfos:[{type:"set",path:t.createPath(this.getParentCreatedAt()),key:this.key}],reverseOp:o}}toReverseOperation(t){let r=Tr.create(this.getParentCreatedAt(),this.value.getCreatedAt());return t!==void 0&&!t.isRemoved()&&(r=rs.create(this.key,t.deepcopy(),this.getParentCreatedAt())),r}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.SET.${this.key}=${this.value.toSortedJSON()}`}getKey(){return this.key}getValue(){return this.value}}class yr extends kt{constructor(t,r,s,i){super(t,i);c(this,"prevCreatedAt");c(this,"createdAt");this.prevCreatedAt=r,this.createdAt=s}static create(t,r,s,i){return new yr(t,r,s,i)}execute(t){const r=t.findByCreatedAt(this.getParentCreatedAt());if(!r)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(r instanceof Me))throw new w(v.ErrInvalidArgument,"fail to execute, only array can execute move");const s=r,i=this.toReverseOperation(s),o=Number(s.subPathOf(this.createdAt));s.moveAfter(this.prevCreatedAt,this.createdAt,this.getExecutedAt());const a=Number(s.subPathOf(this.createdAt));return{opInfos:[{type:"move",path:t.createPath(this.getParentCreatedAt()),index:a,previousIndex:o}],reverseOp:i}}toReverseOperation(t){const r=t.getPrevCreatedAt(this.createdAt);return yr.create(this.getParentCreatedAt(),r,this.createdAt)}getEffectedCreatedAt(){return this.createdAt}toTestString(){return`${this.getParentCreatedAt().toTestString()}.MOVE`}getPrevCreatedAt(){return this.prevCreatedAt}getCreatedAt(){return this.createdAt}}class Or{constructor(e,t,r,s){c(this,"key");c(this,"value");c(this,"updatedAt");c(this,"_isRemoved");this.key=e,this.value=t,this.updatedAt=r,this._isRemoved=s}static of(e,t,r,s){return new Or(e,t,r,s)}getKey(){return this.key}getValue(){return this.value}getUpdatedAt(){return this.updatedAt}isRemoved(){return this._isRemoved}toIDString(){return`${this.updatedAt.toIDString()}:${this.key}`}getRemovedAt(){if(this._isRemoved)return this.updatedAt}getDataSize(){return{data:(this.key.length+this.value.length)*2,meta:Ht}}}class Sr{constructor(){c(this,"nodeMapByKey");c(this,"numberOfRemovedElement");this.nodeMapByKey=new Map,this.numberOfRemovedElement=0}static create(){return new Sr}getNodeMapByKey(){return this.nodeMapByKey}set(e,t,r){const s=this.nodeMapByKey.get(e);if(s&&s.isRemoved()&&r.after(s.getUpdatedAt())&&(this.numberOfRemovedElement-=1),s===void 0||r.after(s.getUpdatedAt())){const i=Or.of(e,t,r,!1);return this.nodeMapByKey.set(e,i),s!==void 0&&s.isRemoved()?[s,i]:[void 0,i]}return s.isRemoved()?[s,void 0]:[void 0,void 0]}setInternal(e,t,r,s){const i=Or.of(e,t,r,s);this.nodeMapByKey.set(e,i),s&&this.numberOfRemovedElement++}remove(e,t){const r=this.nodeMapByKey.get(e),s=[];if(r===void 0||t.after(r.getUpdatedAt())){if(r===void 0){this.numberOfRemovedElement+=1;const a=Or.of(e,"",t,!0);return this.nodeMapByKey.set(e,a),s.push(a),s}const i=r.isRemoved();i||(this.numberOfRemovedElement+=1),i&&s.push(r);const o=Or.of(e,r.getValue(),t,!0);return this.nodeMapByKey.set(e,o),s.push(o),s}return s}has(e){if(this.nodeMapByKey.has(e)){const t=this.nodeMapByKey.get(e);return t!==void 0&&!t.isRemoved()}return!1}get(e){if(this.nodeMapByKey.has(e))return this.nodeMapByKey.get(e).getValue()}deepcopy(){const e=new Sr;for(const[,t]of this.nodeMapByKey)e.setInternal(t.getKey(),t.getValue(),t.getUpdatedAt(),t.isRemoved());return e}toJSON(){if(!this.size())return"{}";const e=[];for(const[t,r]of this.nodeMapByKey)r.isRemoved()||e.push(`"${Kt(t)}":"${Kt(r.getValue())}"`);return`{${e.join(",")}}`}size(){return this.nodeMapByKey.size-this.numberOfRemovedElement}toObject(){const e={};for(const[t,r]of this.nodeMapByKey)r.isRemoved()||(e[t]=r.getValue());return e}*[Symbol.iterator](){for(const[,e]of this.nodeMapByKey)yield e}purge(e){const t=this.nodeMapByKey.get(e.getKey());t==null||t.toIDString()!=e.toIDString()||(this.nodeMapByKey.delete(e.getKey()),this.numberOfRemovedElement--)}}function wt(n){if(n instanceof Map){const e=Array.from(n);return new Map(JSON.parse(JSON.stringify(e)))}return JSON.parse(JSON.stringify(n))}const sh=n=>n?Object.entries(n).length===0:!0,Cs=n=>{const e={};for(const[t,r]of Object.entries(n))e[t]=JSON.stringify(r);return e},vr=n=>{const e={};for(const[t,r]of Object.entries(n))e[t]=JSON.parse(r);return e};function Bp(n){return n?fl(n.live)+fl(n.gc):0}function fl(n){return n.data+n.meta}function Ee(n,...e){for(const t of e)n.data+=t.data,n.meta+=t.meta}function ws(n,e){n.data-=e.data,n.meta-=e.meta}class mi{constructor(e){c(this,"attributes");c(this,"content");this.attributes=Sr.create(),this.content=e}static create(e){return new mi(e)}get length(){return this.content.length}substring(e,t){const r=new mi(this.content.substring(e,t));return r.attributes=this.attributes.deepcopy(),r}setAttr(e,t,r){return this.attributes.set(e,t,r)}getAttrs(){return this.attributes}toString(){return this.content}getDataSize(){const e={data:0,meta:0};e.data+=this.content.length*2;for(const t of this.attributes){const r=t.getDataSize();e.meta+=r.meta,e.data+=r.data}return e}toJSON(){const e=Kt(this.content),t=this.attributes.toObject(),r=[];for(const[s,i]of Object.entries(t)){const o=JSON.parse(i),a=typeof o=="string"?`"${Kt(s)}":"${Kt(o)}"`:`"${Kt(s)}":${String(o)}`;r.push(a)}return r.sort(),r.length===0?`{"val":"${e}"}`:`{"attrs":{${r.join(",")}},"val":"${e}"}`}getAttributes(){return this.attributes.toObject()}getContent(){return this.content}purge(e){this.attributes&&e instanceof Or&&this.attributes.purge(e)}getGCPairs(){const e=[];for(const t of this.attributes)t.getRemovedAt()&&e.push({parent:this,child:t});return e}}class tt extends bi{constructor(t,r){super(r);c(this,"rgaTreeSplit");this.rgaTreeSplit=t}static create(t,r){return new tt(t,r)}edit(t,r,s,i,o){const a=r?mi.create(r):void 0;if(a&&i)for(const[m,S]of Object.entries(i))a.setAttr(m,S,s);const[u,l,f,d]=this.rgaTreeSplit.edit(t,s,a,o);return[d.map(m=>({...m,value:m.value?{attributes:vr(m.value.getAttributes()),content:m.value.getContent()}:{attributes:void 0,content:""},type:"content"})),l,f,[u,u]]}setStyle(t,r,s,i){const o={data:0,meta:0},[,a,u]=this.rgaTreeSplit.findNodeWithSplit(t[1],s),[,l,f]=this.rgaTreeSplit.findNodeWithSplit(t[0],s);Ee(o,a,l);const d=[],y=this.rgaTreeSplit.findBetween(f,u),m=[];for(const I of y){const C=I.getCreatedAt().getActorID();let R=Qs;i!=null&&(R=i.get(C)?i.get(C):0n),I.canStyle(s,R)&&m.push(I)}const S=[];for(const I of m){if(I.isRemoved())continue;const[C,R]=this.rgaTreeSplit.findIndexesFromRange(I.createPosRange());d.push({type:"style",actor:s.getActorID(),from:C,to:R,value:{attributes:vr(r)}});for(const[$,V]of Object.entries(r)){const[L]=I.getValue().setAttr($,V,s);L!==void 0&&S.push({parent:I.getValue(),child:L});const Y=I.getValue().getAttrs().getNodeMapByKey().get($);Y!==void 0&&Ee(o,Y.getDataSize())}}return[S,o,d]}indexRangeToPosRange(t,r){const s=this.rgaTreeSplit.indexToPos(t);return t===r?[s,s]:[s,this.rgaTreeSplit.indexToPos(r)]}get length(){return this.rgaTreeSplit.length}getTreeByIndex(){return this.rgaTreeSplit.getTreeByIndex()}getTreeByID(){return this.rgaTreeSplit.getTreeByID()}getDataSize(){const t={data:0,meta:0};for(const r of this.rgaTreeSplit){if(r.isRemoved())continue;const s=r.getDataSize();t.data+=s.data,t.meta+=s.meta}return{data:t.data,meta:t.meta+this.getMetaUsage()}}toJSON(){const t=[];for(const r of this.rgaTreeSplit)r.isRemoved()||t.push(r.getValue().toJSON());return`[${t.join(",")}]`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TEXT"}}toString(){return this.rgaTreeSplit.toString()}values(){const t=[];for(const r of this.rgaTreeSplit)if(!r.isRemoved()){const s=r.getValue();t.push({attributes:vr(s.getAttributes()),content:s.getContent()})}return t}getRGATreeSplit(){return this.rgaTreeSplit}toTestString(){return this.rgaTreeSplit.toTestString()}deepcopy(){const t=new tt(this.rgaTreeSplit.deepcopy(),this.getCreatedAt());return t.remove(this.getRemovedAt()),t}findIndexesFromRange(t){return this.rgaTreeSplit.findIndexesFromRange(t)}getGCPairs(){const t=[];for(const r of this.rgaTreeSplit){r.getRemovedAt()&&t.push({parent:this.rgaTreeSplit,child:r});for(const s of r.getValue().getGCPairs())t.push(s)}return t}}class Ti extends kt{constructor(t,r,s,i,o,a){super(t,a);c(this,"fromPos");c(this,"toPos");c(this,"content");c(this,"attributes");this.fromPos=r,this.toPos=s,this.content=i,this.attributes=o}static create(t,r,s,i,o,a){return new Ti(t,r,s,i,o,a)}execute(t,r,s){const i=t.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof tt))throw new w(v.ErrInvalidArgument,"fail to execute, only Text can execute edit");const o=i,[a,u,l]=o.edit([this.fromPos,this.toPos],this.content,this.getExecutedAt(),Object.fromEntries(this.attributes),s);t.acc(l);for(const f of u)t.registerGCPair(f);return{opInfos:a.map(({from:f,to:d,value:y})=>({type:"edit",from:f,to:d,value:y,path:t.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const t=this.getParentCreatedAt().toTestString(),r=this.fromPos.toTestString(),s=this.toPos.toTestString(),i=this.content;return`${t}.EDIT(${r},${s},${i})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContent(){return this.content}getAttributes(){return this.attributes||new Map}}class Si extends kt{constructor(t,r,s,i,o){super(t,o);c(this,"fromPos");c(this,"toPos");c(this,"attributes");this.fromPos=r,this.toPos=s,this.attributes=i}static create(t,r,s,i,o){return new Si(t,r,s,i,o)}execute(t,r,s){const i=t.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof tt))throw new w(v.ErrInvalidArgument,"fail to execute, only Text can execute edit");const o=i,[a,u,l]=o.setStyle([this.fromPos,this.toPos],this.attributes?Object.fromEntries(this.attributes):{},this.getExecutedAt(),s);t.acc(u);for(const f of a)t.registerGCPair(f);return{opInfos:l.map(({from:f,to:d,value:y})=>({type:"style",from:f,to:d,value:y,path:t.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const t=this.getParentCreatedAt().toTestString(),r=this.fromPos.toTestString(),s=this.toPos.toTestString(),i=this.attributes;return`${t}.STYL(${r},${s},${JSON.stringify(i)})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}}const Lp=2,Jp="root",Wt="text";function qs(n,e){let t=0;const r=n.children;for(let s=0;s<e;s++){const i=r[s];!i||i.isRemoved||(t+=i.paddedSize)}return t}class Fp{constructor(e,t=[]){c(this,"type");c(this,"parent");c(this,"_children");c(this,"size");if(this.type=e,this.size=0,this._children=t,this.isText&&this._children.length>0)throw new w(v.ErrRefused,"Text node cannot have children")}updateAncestorsSize(){let e=this.parent;const t=this.isRemoved?-1:1;for(;e&&(e.size+=this.paddedSize*t,!e.isRemoved);)e=e.parent}updateDescendantsSize(){let e=0;for(const t of this._children){const r=t.updateDescendantsSize();t.isRemoved||(e+=r)}return this.size+=e,this.paddedSize}get isText(){return this.type===Wt}get paddedSize(){return this.size+(this.isText?0:Lp)}isAncestorOf(e){return $p(this,e)}get nextSibling(){const e=this.parent.findOffset(this),t=this.parent.children[e+1];if(t)return t}get prevSibling(){const e=this.parent.findOffset(this),t=this.parent.children[e-1];if(t)return t}splitText(e,t){const r={data:0,meta:0};if(e===0||e===this.size)return[void 0,r];const s=this.value.slice(0,e),i=this.value.slice(e);if(!i.length)return[void 0,r];const o=this.getDataSize();this.value=s;const a=this.cloneText(e+t);return a.value=i,this.parent.insertAfterInternal(a,this),Ee(r,this.getDataSize(),a.getDataSize()),ws(r,o),[a,r]}get children(){return this._children.filter(e=>!e.isRemoved)}get allChildren(){return[...this._children]}hasTextChild(){return this.children.length>0&&this.children.every(e=>e.isText)}getChildrenText(){return this.isText?this.value:this.hasTextChild()?this.children.map(e=>e.value).join(""):""}append(...e){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");this._children.push(...e);for(const t of e)t.parent=this,t.updateAncestorsSize()}prepend(...e){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");this._children.unshift(...e);for(const t of e)t.parent=this}insertBefore(e,t){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");const r=this._children.indexOf(t);if(r===-1)throw new w(v.ErrInvalidArgument,"child not found");this.insertAtInternal(e,r),e.updateAncestorsSize()}insertAfter(e,t){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");const r=this._children.indexOf(t);if(r===-1)throw new w(v.ErrInvalidArgument,"child not found");this.insertAtInternal(e,r+1),e.updateAncestorsSize()}insertAt(e,t){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");this.insertAtInternal(e,t),e.updateAncestorsSize()}removeChild(e){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");const t=this._children.indexOf(e);if(t===-1)throw new w(v.ErrInvalidArgument,"child not found");this._children.splice(t,1),e.parent=void 0}splitElement(e,t){const r={data:0,meta:0},s=this.getDataSize(),i=this.cloneElement(t);this.parent.insertAfterInternal(i,this),i.updateAncestorsSize();const o=this.children.slice(0,e),a=this.children.slice(e);this._children=o,i._children=a,this.size=this._children.reduce((u,l)=>u+l.paddedSize,0),i.size=i._children.reduce((u,l)=>u+l.paddedSize,0);for(const u of i._children)u.parent=i;return Ee(r,this.getDataSize(),i.getDataSize()),ws(r,s),[i,r]}insertAfterInternal(e,t){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");const r=this._children.indexOf(t);if(r===-1)throw new w(v.ErrInvalidArgument,"child not found");this.insertAtInternal(e,r+1)}insertAtInternal(e,t){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");this._children.splice(t,0,e),e.parent=this}findOffset(e){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");if(e.isRemoved){const t=this._children.indexOf(e);return this.allChildren.splice(0,t).filter(s=>!s.isRemoved).length}return this.children.indexOf(e)}findBranchOffset(e){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");let t=e;for(;t;){const r=this._children.indexOf(t);if(r!==-1)return r;t=t.parent}return-1}}function $p(n,e){if(n===e)return!1;for(;e.parent;){if(e.parent===n)return!0;e=e.parent}return!1}var Te=(n=>(n.Start="Start",n.End="End",n.Text="Text",n))(Te||{});function ih(n,e,t,r){if(e>t)throw new w(v.ErrInvalidArgument,`from is greater than to: ${e} > ${t}`);if(e>n.size)throw new w(v.ErrInvalidArgument,`from is out of range: ${e} > ${n.size}`);if(t>n.size)throw new w(v.ErrInvalidArgument,`to is out of range: ${t} > ${n.size}`);if(e===t)return;let s=0;for(const i of n.children){if(e-i.paddedSize<s&&s<t){const o=i.isText?e-s:e-s-1,a=i.isText?t-s:t-s-1,u=!i.isText&&o<0,l=!i.isText&&a>i.size;(i.isText||u)&&r([i,i.isText?"Text":"Start"],l),ih(i,Math.max(0,o),Math.min(a,i.size),r),l&&r([i,"End"],l)}s+=i.paddedSize}}function oh(n,e,t=0){for(const r of n.children)oh(r,e,t+1);e(n,t)}function Uo(n,e,t=0){for(const r of n._children)Uo(r,e,t+1);e(n,t)}function tc(n,e,t=!0){if(e>n.size)throw new w(v.ErrInvalidArgument,`index is out of range: ${e} > ${n.size}`);if(n.isText)return{node:n,offset:e};let r=0,s=0;for(const i of n.children){if(t&&i.isText&&i.size>=e-s)return tc(i,e-s,t);if(e===s)return{node:n,offset:r};if(!t&&i.paddedSize===e-s)return{node:n,offset:r+1};if(i.paddedSize>e-s)return tc(i,e-s-1,t);s+=i.paddedSize,r+=1}return{node:n,offset:r}}function ah(n){return n.isText||n.children.length===0?n:ah(n.children[0])}function Mp(n,e){if(n.size<e)throw new w(v.ErrInvalidArgument,"unacceptable path");for(let t=0;t<n.children.length;t++){const r=n.children[t];if(r.size<e)e-=r.size;else{n=r;break}}return{node:n,offset:e}}class Up{constructor(e){c(this,"root");this.root=e}tokensBetween(e,t,r){ih(this.root,e,t,r)}traverse(e){oh(this.root,e,0)}traverseAll(e){Uo(this.root,e,0)}findTreePos(e,t=!0){return tc(this.root,e,t)}treePosToPath(e){const t=[];let r=e.node;if(r.isText){const s=r.parent.findOffset(r);if(s===-1)throw new w(v.ErrInvalidArgument,"invalid treePos");const i=qs(r.parent,s);t.push(i+e.offset),r=r.parent}else if(r.hasTextChild()){const s=qs(r,e.offset);t.push(s)}else t.push(e.offset);for(;r.parent;){const s=r.parent.findOffset(r);if(s===-1)throw new w(v.ErrInvalidArgument,"invalid treePos");t.push(s),r=r.parent}return t.reverse()}pathToIndex(e){const t=this.pathToTreePos(e);return this.indexOf(t)}pathToTreePos(e){if(!e.length)throw new w(v.ErrInvalidArgument,"unacceptable path");let t=this.root;for(let r=0;r<e.length-1;r++){const s=e[r];if(t=t.children[s],!t)throw new w(v.ErrInvalidArgument,"unacceptable path")}if(t.hasTextChild())return Mp(t,e[e.length-1]);if(t.children.length<e[e.length-1])throw new w(v.ErrInvalidArgument,"unacceptable path");return{node:t,offset:e[e.length-1]}}getRoot(){return this.root}get size(){return this.root.size}findPostorderRight(e){const{node:t,offset:r}=e;if(t.isText){if(t.size===r){const s=t.nextSibling;return s||t.parent}return t}return t.children.length===r?t:ah(t.children[r])}indexOf(e){let{node:t}=e;const{offset:r}=e;let s=0,i=1;if(t.isText){s+=r;const o=t.parent,a=o.findOffset(t);if(a===-1)throw new w(v.ErrInvalidArgument,"invalid pos");s+=qs(o,a),t=t.parent}else s+=qs(t,r);for(;t!=null&&t.parent;){const o=t.parent,a=o.findOffset(t);if(a===-1)throw new w(v.ErrInvalidArgument,"invalid pos");s+=qs(o,a),i++,t=t.parent}return s+i-1}indexToPath(e){const t=this.findTreePos(e);return this.treePosToPath(t)}}const qp=(n,e)=>n===e?0:n<e?-1:1;class zp{constructor(e,t,r){c(this,"key");c(this,"value");c(this,"parent");c(this,"left");c(this,"right");c(this,"isRed");this.key=e,this.value=t,this.isRed=r}}class Vp{constructor(e){c(this,"stack");this.stack=[],this.traverseInorder(e)}traverseInorder(e){e&&(this.traverseInorder(e.left),this.stack.push({key:e.key,value:e.value}),this.traverseInorder(e.right))}}class ch{constructor(e){c(this,"root");c(this,"comparator");c(this,"counter");this.comparator=typeof e<"u"?e:qp,this.counter=0}put(e,t){return this.root=this.putInternal(e,t,this.root),this.root.isRed=!1,t}get(e){const t=this.getInternal(e,this.root);return t?t.value:void 0}remove(e){!this.isRed(this.root.left)&&!this.isRed(this.root.right)&&(this.root.isRed=!0),this.root=this.removeInternal(this.root,e),this.root&&(this.root.isRed=!1)}getIterator(){return new Vp(this.root)}values(){const e=[];for(const t of this.getIterator().stack)e.push(t.value);return e}floorEntry(e){let t=this.root;for(;t;){const r=this.comparator(e,t.key);if(r>0)if(t.right)t.right.parent=t,t=t.right;else return t;else if(r<0)if(t.left)t.left.parent=t,t=t.left;else{let s=t.parent,i=t;for(;s&&i===s.left;)i=s,s=s.parent;return s}else return t}}lastEntry(){if(!this.root)return this.root;let e=this.root;for(;e.right;)e=e.right;return e}size(){return this.counter}isEmpty(){return this.counter===0}getInternal(e,t){for(;t;){const r=this.comparator(e,t.key);if(r===0)return t;r<0?t=t.left:r>0&&(t=t.right)}}putInternal(e,t,r){if(!r)return this.counter+=1,new zp(e,t,!0);const s=this.comparator(e,r.key);return s<0?r.left=this.putInternal(e,t,r.left):s>0?r.right=this.putInternal(e,t,r.right):r.value=t,this.isRed(r.right)&&!this.isRed(r.left)&&(r=this.rotateLeft(r)),this.isRed(r.left)&&this.isRed(r.left.left)&&(r=this.rotateRight(r)),this.isRed(r.left)&&this.isRed(r.right)&&this.flipColors(r),r}removeInternal(e,t){if(this.comparator(t,e.key)<0)!this.isRed(e.left)&&!this.isRed(e.left.left)&&(e=this.moveRedLeft(e)),e.left=this.removeInternal(e.left,t);else{if(this.isRed(e.left)&&(e=this.rotateRight(e)),this.comparator(t,e.key)===0&&!e.right){this.counter-=1;return}if(!this.isRed(e.right)&&!this.isRed(e.right.left)&&(e=this.moveRedRight(e)),this.comparator(t,e.key)===0){this.counter-=1;const r=this.min(e.right);e.value=r.value,e.key=r.key,e.right=this.removeMin(e.right)}else e.right=this.removeInternal(e.right,t)}return this.fixUp(e)}min(e){return e.left?this.min(e.left):e}removeMin(e){if(e.left)return!this.isRed(e.left)&&!this.isRed(e.left.left)&&(e=this.moveRedLeft(e)),e.left=this.removeMin(e.left),this.fixUp(e)}fixUp(e){return this.isRed(e.right)&&(e=this.rotateLeft(e)),this.isRed(e.left)&&this.isRed(e.left.left)&&(e=this.rotateRight(e)),this.isRed(e.left)&&this.isRed(e.right)&&this.flipColors(e),e}moveRedLeft(e){return this.flipColors(e),this.isRed(e.right.left)&&(e.right=this.rotateRight(e.right),e=this.rotateLeft(e),this.flipColors(e)),e}moveRedRight(e){return this.flipColors(e),this.isRed(e.left.left)&&(e=this.rotateRight(e),this.flipColors(e)),e}isRed(e){return e&&e.isRed}rotateLeft(e){const t=e.right;return e.right=t.left,t.left=e,t.isRed=t.left.isRed,t.left.isRed=!0,t}rotateRight(e){const t=e.left;return e.left=t.right,t.right=e,t.isRed=t.right.isRed,t.right.isRed=!0,t}flipColors(e){e.isRed=!e.isRed,e.left.isRed=!e.left.isRed,e.right.isRed=!e.right.isRed}}class St{constructor(e,t){c(this,"parentID");c(this,"leftSiblingID");this.parentID=e,this.leftSiblingID=t}static of(e,t){return new St(e,t)}static fromTreePos(e){const{offset:t}=e;let{node:r}=e,s;return r.isText?(r.parent.children[0]===r&&t===0?s=r.parent:s=r,r=r.parent):t===0?s=r:s=r.children[t-1],St.of(r.id,Ne.of(s.getCreatedAt(),s.getOffset()+t))}getParentID(){return this.parentID}static fromStruct(e){return St.of(Ne.of(yt.fromStruct(e.parentID.createdAt),e.parentID.offset),Ne.of(yt.fromStruct(e.leftSiblingID.createdAt),e.leftSiblingID.offset))}toStruct(){return{parentID:{createdAt:this.getParentID().getCreatedAt().toStruct(),offset:this.getParentID().getOffset()},leftSiblingID:{createdAt:this.getLeftSiblingID().getCreatedAt().toStruct(),offset:this.getLeftSiblingID().getOffset()}}}toTreeNodePair(e){const t=this.getParentID(),r=this.getLeftSiblingID(),s=e.findFloorNode(t);let i=e.findFloorNode(r);if(!s||!i)throw new w(v.ErrRefused,`cannot find node of CRDTTreePos(${t.toTestString()}, ${r.toTestString()})`);return!r.equals(t)&&r.getOffset()>0&&r.getOffset()===i.id.getOffset()&&i.insPrevID&&(i=e.findFloorNode(i.insPrevID)),[s,i]}getLeftSiblingID(){return this.leftSiblingID}equals(e){return this.getParentID().getCreatedAt().equals(e.getParentID().getCreatedAt())&&this.getParentID().getOffset()===e.getParentID().getOffset()&&this.getLeftSiblingID().getCreatedAt().equals(e.getLeftSiblingID().getCreatedAt())&&this.getLeftSiblingID().getOffset()===e.getLeftSiblingID().getOffset()}}class Ne{constructor(e,t){c(this,"createdAt");c(this,"offset");this.createdAt=e,this.offset=t}static of(e,t){return new Ne(e,t)}static fromStruct(e){return Ne.of(yt.fromStruct(e.createdAt),e.offset)}static createComparator(){return(e,t)=>{const r=e.getCreatedAt().compare(t.getCreatedAt());return r!==0?r:e.getOffset()>t.getOffset()?1:e.getOffset()<t.getOffset()?-1:0}}getCreatedAt(){return this.createdAt}equals(e){return this.createdAt.compare(e.createdAt)===0&&this.offset===e.offset}getOffset(){return this.offset}setOffset(e){this.offset=e}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}toTestString(){return`${this.createdAt.toTestString()}/${this.offset}`}}class et extends Fp{constructor(t,r,s,i,o){super(r);c(this,"id");c(this,"removedAt");c(this,"attrs");c(this,"insPrevID");c(this,"insNextID");c(this,"_value","");this.id=t,this.removedAt=o,i&&(this.attrs=i),typeof s=="string"?this.value=s:Array.isArray(s)&&(this._children=s)}toIDString(){return this.id.toIDString()}getRemovedAt(){return this.removedAt}static create(t,r,s,i){return new et(t,r,s,i)}deepcopy(){var r;const t=new et(this.id,this.type);return t.removedAt=this.removedAt,t._value=this._value,t.size=this.size,t.attrs=(r=this.attrs)==null?void 0:r.deepcopy(),t._children=this._children.map(s=>{const i=s.deepcopy();return i.parent=t,i}),t.insPrevID=this.insPrevID,t.insNextID=this.insNextID,t}get value(){if(!this.isText)throw new w(v.ErrInvalidType,`cannot get value of element node: ${this.type}`);return this._value}set value(t){if(!this.isText)throw new w(v.ErrInvalidType,`cannot set value of element node: ${this.type}`);this._value=t,this.size=t.length}get isRemoved(){return!!this.removedAt}remove(t){const r=!this.removedAt;(!this.removedAt||this.removedAt.compare(t)>0)&&(this.removedAt=t),r&&this.updateAncestorsSize()}cloneText(t){return new et(Ne.of(this.id.getCreatedAt(),t),this.type,void 0,void 0,this.removedAt)}cloneElement(t){return new et(Ne.of(t(),0),this.type,void 0,void 0,this.removedAt)}split(t,r,s){const[i,o]=this.isText?this.splitText(r,this.id.getOffset()):this.splitElement(r,s);if(i){if(i.insPrevID=this.id,this.insNextID){const a=t.findFloorNode(this.insNextID);a.insPrevID=i.id,i.insNextID=this.insNextID}this.insNextID=i.id,t.registerNode(i)}return[i,o]}getCreatedAt(){return this.id.getCreatedAt()}getOffset(){return this.id.getOffset()}canDelete(t,r){return this.getCreatedAt().getLamport()<=r&&(!this.removedAt||t.after(this.removedAt))}canStyle(t,r){return this.isText?!1:this.getCreatedAt().getLamport()<=r&&(!this.removedAt||t.after(this.removedAt))}setAttrs(t,r){this.attrs||(this.attrs=new Sr);const s=[];for(const[i,o]of Object.entries(t))s.push(this.attrs.set(i,o,r));return s}purge(t){this.attrs&&this.attrs.purge(t)}getDataSize(){const t={data:0,meta:0};if(this.isText&&(t.data+=this.size*2),this.id&&(t.meta+=Ht),this.removedAt&&(t.meta+=Ht),this.attrs)for(const r of this.attrs){if(r.getRemovedAt())continue;const s=r.getDataSize();t.meta+=s.meta,t.data+=s.data}return t}getGCPairs(){const t=[];if(!this.attrs)return t;for(const r of this.attrs)r.getRemovedAt()&&t.push({parent:this,child:r});return t}}function nc(n){var t;if(n.isText){const r=n;return{type:r.type,value:r.value}}const e={type:n.type,children:n.children.map(nc)};return n.attrs&&(e.attributes=vr((t=n.attrs)==null?void 0:t.toObject())),e}function Nc(n){if(n.isText)return n.value;let e="";return n.attrs&&n.attrs.size()&&(e=" "+Array.from(n.attrs).filter(t=>!t.isRemoved()).sort((t,r)=>t.getKey().localeCompare(r.getKey())).map(t=>{const r=JSON.parse(t.getValue());return typeof r=="string"?`${t.getKey()}="${r}"`:`${t.getKey()}="${Kt(t.getValue())}"`}).join(" ")),`<${n.type}${e}>${n.children.map(t=>Nc(t)).join("")}</${n.type}>`}function uh(n){if(n.isText){const e=n;return{type:e.type,value:e.value,size:e.size,isRemoved:e.isRemoved}}return{type:n.type,children:n.children.map(uh),size:n.size,isRemoved:n.isRemoved}}class nt extends bi{constructor(t,r){super(r);c(this,"indexTree");c(this,"nodeMapByID");this.indexTree=new Up(t),this.nodeMapByID=new ch(Ne.createComparator()),this.indexTree.traverseAll(s=>{this.nodeMapByID.put(s.id,s)})}static create(t,r){return new nt(t,r)}findFloorNode(t){const r=this.nodeMapByID.floorEntry(t);if(!(!r||!r.key.getCreatedAt().equals(t.getCreatedAt())))return r.value}registerNode(t){this.nodeMapByID.put(t.id,t)}findNodesAndSplitText(t,r){let s={data:0,meta:0};const[i,o]=t.toTreeNodePair(this);let a=o;const u=i===a,l=a.parent&&!u?a.parent:i;if(a.isText){const[,f]=a.split(this,t.getLeftSiblingID().getOffset()-a.id.getOffset());s=f}if(r){const f=l.allChildren,d=u?0:f.indexOf(a)+1;for(let y=d;y<f.length;y++){const m=f[y];if(!m.id.getCreatedAt().after(r))break;a=m}}return[[l,a],s]}style(t,r,s,i){const o={data:0,meta:0},[[a,u],l]=this.findNodesAndSplitText(t[0],s),[[f,d],y]=this.findNodesAndSplitText(t[1],s);Ee(o,y,l);const m=[],S=r?vr(r):{},I=[];return this.traverseInPosRange(a,u,f,d,([C,R])=>{var L;const $=C.getCreatedAt().getActorID();let V=Qs;if(i!=null&&(V=i.get($)?i.get($):0n),C.canStyle(s,V)&&r){const Y=C.setAttrs(r,s),W=Y.reduce((ae,[,Ie])=>(Ie&&(ae[Ie.getKey()]=S[Ie.getKey()]),ae),{}),Q=C.parent,ie=C.prevSibling||C.parent;Object.keys(W).length>0&&m.push({type:"style",from:this.toIndex(Q,ie),to:this.toIndex(C,C),fromPath:this.toPath(Q,ie),toPath:this.toPath(C,C),actor:s.getActorID(),value:W});for(const[ae]of Y)ae&&I.push({parent:C,child:ae});for(const[ae]of Object.entries(S)){const Ie=(L=C.attrs)==null?void 0:L.getNodeMapByKey().get(ae);Ie!==void 0&&R!==Te.End&&Ee(o,Ie.getDataSize())}}}),[I,m,o]}removeStyle(t,r,s,i){const o={data:0,meta:0},[[a,u],l]=this.findNodesAndSplitText(t[0],s),[[f,d],y]=this.findNodesAndSplitText(t[1],s);Ee(o,y,l);const m=[],S=[];return this.traverseInPosRange(a,u,f,d,([I])=>{const C=I.getCreatedAt().getActorID();let R=Qs;if(i!=null&&(R=i.get(C)?i.get(C):0n),I.canStyle(s,R)&&r){I.attrs||(I.attrs=new Sr);for(const L of r){const Y=I.attrs.remove(L,s);for(const W of Y)S.push({parent:I,child:W})}const $=I.parent,V=I.prevSibling||I.parent;m.push({actor:s.getActorID(),type:"removeStyle",from:this.toIndex($,V),to:this.toIndex(I,I),fromPath:this.toPath($,V),toPath:this.toPath(I,I),value:r})}}),[S,m,o]}edit(t,r,s,i,o,a){const u={data:0,meta:0},[[l,f],d]=this.findNodesAndSplitText(t[0],i),[[y,m],S]=this.findNodesAndSplitText(t[1],i);Ee(u,S,d);const I=this.toIndex(l,f),C=this.toPath(l,f),R=[],$=[],V=[];this.traverseInPosRange(l,f,y,m,([W,Q],ie)=>{if(Q===Te.Start&&!ie)for(const Zt of W.children)V.push(Zt);const ae=W.getCreatedAt().getActorID();let Ie=Qs;a!=null&&(Ie=a.get(ae)?a.get(ae):0n),(W.canDelete(i,Ie)||R.includes(W.parent))&&((Q===Te.Text||Q===Te.Start)&&R.push(W),$.push([W,Q]))});const L=this.makeDeletionChanges($,i),Y=[];for(const W of R)W.remove(i),W.isRemoved&&Y.push({parent:this,child:W});for(const W of V)W.removedAt||l.append(W);if(s>0){let W=0,Q=l,ie=f;for(;W<s;)Q.split(this,Q.findOffset(ie)+1,o),ie=Q,Q=Q.parent,W++;L.push({type:"content",from:I,to:I,fromPath:C,toPath:C,actor:i.getActorID()})}if(r!=null&&r.length){const W=[];let Q=f;for(const ie of r)Q===l?l.insertAt(ie,0):l.insertAfter(ie,Q),Q=ie,Uo(ie,ae=>{l.isRemoved?(ae.remove(i),Y.push({parent:this,child:ae})):Ee(u,ae.getDataSize()),this.nodeMapByID.put(ae.id,ae)}),ie.isRemoved||W.push(ie);if(W.length){const ie=W.map(ae=>nc(ae));L.length&&L[L.length-1].from===I?L[L.length-1].value=ie:L.push({type:"content",from:I,to:I,fromPath:C,toPath:C,actor:i.getActorID(),value:ie})}}return[L,Y,u]}editT(t,r,s,i,o){const a=this.findPos(t[0]),u=this.findPos(t[1]);this.edit([a,u],r,s,i,o)}move(t,r,s){throw new w(v.ErrUnimplemented,`not implemented: ${t}, ${r}, ${s}`)}pathToTreePos(t){return this.indexTree.pathToTreePos(t)}purge(t){var i;(i=t.parent)==null||i.removeChild(t),this.nodeMapByID.remove(t.id);const r=t.insPrevID,s=t.insNextID;if(r){const o=this.findFloorNode(r);o.insNextID=s}if(s){const o=this.findFloorNode(s);o.insPrevID=r}t.insPrevID=void 0,t.insNextID=void 0}getGCPairs(){const t=[];return this.indexTree.traverse(r=>{r.getRemovedAt()&&t.push({parent:this,child:r});for(const s of r.getGCPairs())t.push(s)}),t}findPos(t,r=!0){const s=this.indexTree.findTreePos(t,r);return St.fromTreePos(s)}pathToPosRange(t){const r=this.pathToIndex(t);return[this.findPos(r),this.findPos(r+1)]}pathToPos(t){const r=this.indexTree.pathToIndex(t);return this.findPos(r)}getRoot(){return this.indexTree.getRoot()}getSize(){return this.indexTree.size}getNodeSize(){return this.nodeMapByID.size()}getIndexTree(){return this.indexTree}toXML(){return Nc(this.indexTree.getRoot())}getDataSize(){const t={data:0,meta:0};return this.indexTree.traverse(r=>{if(r.getRemovedAt())return;const s=r.getDataSize();t.data+=s.data,t.meta+=s.meta}),{data:t.data,meta:t.meta+this.getMetaUsage()}}toJSON(){return JSON.stringify(this.getRootTreeNode())}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TREE"}}toJSInfoForTest(){const t=this.indexTree.getRoot(),r=(s,i=void 0,o=void 0,a=0)=>{var m,S,I,C;let u,l,f;const d=s.isText?{node:s,offset:0}:i&&o?this.toTreePos(i,o):null;d&&(u=this.indexTree.indexOf(d),l=this.indexTree.treePosToPath(d),f=St.fromTreePos(d).toStruct());const y={type:s.type,parent:i==null?void 0:i.id.toTestString(),size:s.size,id:s.id.toTestString(),removedAt:(m=s.removedAt)==null?void 0:m.toTestString(),insPrev:(S=s.insPrevID)==null?void 0:S.toTestString(),insNext:(I=s.insNextID)==null?void 0:I.toTestString(),value:s.isText?s.value:void 0,isRemoved:s.isRemoved,children:[],depth:a,attributes:s.attrs?vr((C=s.attrs)==null?void 0:C.toObject()):void 0,index:u,path:l,pos:f};for(let R=0;R<s.allChildren.length;R++){const $=R===0?s:s.allChildren[R-1];y.children.push(r(s.allChildren[R],s,$,a+1))}return y};return r(t)}getRootTreeNode(){return nc(this.indexTree.getRoot())}toTestTreeNode(){return uh(this.indexTree.getRoot())}toSortedJSON(){return this.toJSON()}deepcopy(){const t=this.getRoot();return new nt(t.deepcopy(),this.getCreatedAt())}toPath(t,r){const s=this.toTreePos(t,r);return s?this.indexTree.treePosToPath(s):[]}toIndex(t,r){const s=this.toTreePos(t,r);return s?this.indexTree.indexOf(s):-1}indexToPath(t){return this.indexTree.indexToPath(t)}pathToIndex(t){return this.indexTree.pathToIndex(t)}indexRangeToPosRange(t){const r=this.findPos(t[0]);return t[0]===t[1]?[r,r]:[r,this.findPos(t[1])]}indexRangeToPosStructRange(t){const[r,s]=t,i=this.findPos(r);return r===s?[i.toStruct(),i.toStruct()]:[i.toStruct(),this.findPos(s).toStruct()]}posRangeToPathRange(t){const[[r,s]]=this.findNodesAndSplitText(t[0]),[[i,o]]=this.findNodesAndSplitText(t[1]);return[this.toPath(r,s),this.toPath(i,o)]}posRangeToIndexRange(t){const[[r,s]]=this.findNodesAndSplitText(t[0]),[[i,o]]=this.findNodesAndSplitText(t[1]);return[this.toIndex(r,s),this.toIndex(i,o)]}traverseInPosRange(t,r,s,i,o){const a=this.toIndex(t,r),u=this.toIndex(s,i);return this.indexTree.tokensBetween(a,u,o)}toTreePos(t,r){if(!t||!r)return;if(t.isRemoved){let i;for(;t.isRemoved;)i=t,t=i.parent;const o=t.findOffset(i);return{node:t,offset:o}}if(t===r)return{node:t,offset:0};let s=t.findOffset(r);if(!r.isRemoved){if(r.isText)return{node:r,offset:r.paddedSize};s++}return{node:t,offset:s}}makeDeletionChanges(t,r){const s=[],i=[];let o=null,a=null;for(let u=0;u<t.length;u++){const l=t[u],f=t[u+1];o||(o=l),a=l;const d=this.findRightToken(l);(!d||!f||d[0]!==f[0]||d[1]!==f[1])&&(i.push([o,a]),o=null,a=null)}for(const u of i){const[l,f]=u,[d,y]=this.findLeftToken(l),[m,S]=f,I=y===Te.Start?d:d.parent,C=S===Te.Start?m:m.parent,R=this.toIndex(I,d),$=this.toIndex(C,m);R<$&&(s.length>0&&R===s[s.length-1].to?(s[s.length-1].to=$,s[s.length-1].toPath=this.toPath(C,m)):s.push({type:"content",from:R,to:$,fromPath:this.toPath(I,d),toPath:this.toPath(C,m),actor:r.getActorID()}))}return s.reverse()}findRightToken([t,r]){if(r===Te.Start){const u=t.allChildren;return u.length>0?[u[0],u[0].isText?Te.Text:Te.Start]:[t,Te.End]}const s=t.parent,i=s.allChildren,o=i.indexOf(t);if(s&&o===i.length-1)return[s,Te.End];const a=i[o+1];return[a,a.isText?Te.Text:Te.Start]}findLeftToken([t,r]){if(r===Te.End){const u=t.allChildren;if(u.length>0){const l=u[u.length-1];return[l,l.isText?Te.Text:Te.End]}return[t,Te.Start]}const s=t.parent,i=s.allChildren,o=i.indexOf(t);if(s&&o===0)return[s,Te.Start];const a=i[o-1];return[a,a.isText?Te.Text:Te.End]}}class Ii extends kt{constructor(t,r,s,i,o,a){super(t,a);c(this,"fromPos");c(this,"toPos");c(this,"contents");c(this,"splitLevel");this.fromPos=r,this.toPos=s,this.contents=i,this.splitLevel=o}static create(t,r,s,i,o,a){return new Ii(t,r,s,i,o,a)}execute(t,r,s){var d;const i=t.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof nt))throw new w(v.ErrInvalidArgument,"fail to execute, only Tree can execute edit");const o=this.getExecutedAt(),a=i,[u,l,f]=a.edit([this.fromPos,this.toPos],(d=this.contents)==null?void 0:d.map(y=>y.deepcopy()),this.splitLevel,o,(()=>{let y=o.getDelimiter();return this.contents!==void 0&&(y+=this.contents.length),()=>yt.of(o.getLamport(),++y,o.getActorID())})(),s);t.acc(f);for(const y of l)t.registerGCPair(y);return{opInfos:u.map(({from:y,to:m,value:S,splitLevel:I,fromPath:C,toPath:R})=>({type:"tree-edit",path:t.createPath(this.getParentCreatedAt()),from:y,to:m,value:S,splitLevel:I,fromPath:C,toPath:R}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const t=this.getParentCreatedAt().toTestString(),r=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.fromPos.getLeftSiblingID().getOffset()}`,s=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.toPos.getLeftSiblingID().getOffset()}`,i=this.contents||[];return`${t}.EDIT(${r},${s},${i.map(o=>Nc(o)).join("")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContents(){return this.contents}getSplitLevel(){return this.splitLevel}}class bs{constructor(e){c(this,"vector");this.vector=e||new Map}set(e,t){this.vector.set(e,t)}unset(e){this.vector.delete(e)}get(e){return this.vector.get(e)}maxLamport(){let e=BigInt(0);for(const[,t]of this)t>e&&(e=t);return e}max(e){const t=new Map;for(const[r,s]of e){const i=this.vector.get(r),o=i&&i>s?i:s;t.set(r,o)}for(const[r,s]of this){const i=e.get(r),o=i&&i>s?i:s;t.set(r,o)}return new bs(t)}afterOrEqual(e){const t=this.vector.get(e.getActorID());return t===void 0?!1:t>=e.getLamport()}deepcopy(){const e=new Map;for(const[t,r]of this.vector)e.set(t,r);return new bs(e)}filter(e){const t=new Map;for(const[r]of e){const s=this.vector.get(r);s!==void 0&&t.set(r,s)}return new bs(t)}size(){return this.vector.size}*[Symbol.iterator](){for(const[e,t]of this.vector)yield[e,t]}}const lh=new bs(new Map);class bt{constructor(e,t,r,s,i){c(this,"clientSeq");c(this,"serverSeq");c(this,"actor");c(this,"lamport");c(this,"versionVector");this.clientSeq=e,this.serverSeq=i,this.lamport=t,this.versionVector=s,this.actor=r}hasClocks(){return this.versionVector.size()>0&&this.lamport!=Qa}static of(e,t,r,s,i){return new bt(e,t,r,s,i)}next(e=!1){if(e)return new bt(this.clientSeq+1,this.lamport,this.actor,lh,Qa);const t=this.versionVector.deepcopy();return t.set(this.actor,this.lamport+1n),new bt(this.clientSeq+1,this.lamport+1n,this.actor,t)}syncClocks(e){if(!e.hasClocks())return this;const t=e.lamport>this.lamport?e.lamport+1n:this.lamport+1n,r=this.versionVector.max(e.versionVector),s=new bt(this.clientSeq,t,this.actor,r);return s.versionVector.set(this.actor,t),s}setClocks(e,t){const r=e>this.lamport?e+1n:this.lamport+1n;t.unset(Mo);const s=this.versionVector.max(t);return s.set(this.actor,r),bt.of(this.clientSeq,r,this.actor,s)}createTimeTicket(e){return yt.of(this.lamport,e,this.actor)}setActor(e){return new bt(this.clientSeq,this.lamport,e,this.versionVector,this.serverSeq)}setLamport(e){return new bt(this.clientSeq,e,this.actor,this.versionVector,this.serverSeq)}setVersionVector(e){return new bt(this.clientSeq,this.lamport,this.actor,e,this.serverSeq)}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq?this.serverSeq.toString():""}getLamport(){return this.lamport}getLamportAsString(){return this.lamport.toString()}getActorID(){return this.actor}getVersionVector(){return this.versionVector}toTestString(){return`${this.lamport.toString()}:${this.actor.slice(-2)}:${this.clientSeq}`}}const Kp=new bt(0,0n,Mo,lh);class Ds{constructor({id:e,operations:t,presenceChange:r,message:s}){c(this,"id");c(this,"operations");c(this,"presenceChange");c(this,"message");this.id=e,this.operations=t||[],this.presenceChange=r,this.message=s}static create({id:e,operations:t,presenceChange:r,message:s}){return new Ds({id:e,operations:t,presenceChange:r,message:s})}getID(){return this.id}getMessage(){return this.message}hasOperations(){return this.operations.length>0}getOperations(){return this.operations}setActor(e){for(const t of this.operations)t.setActor(e);this.id=this.id.setActor(e)}hasPresenceChange(){return this.presenceChange!==void 0}getPresenceChange(){return this.presenceChange}execute(e,t,r){const s=[],i=[];for(const o of this.operations){const a=o.execute(e,r,this.id.getVersionVector());if(!a)continue;const{opInfos:u,reverseOp:l}=a;s.push(...u),l&&i.unshift(l)}return this.presenceChange&&(this.presenceChange.type===Yt.Put?t.set(this.id.getActorID(),wt(this.presenceChange.presence)):t.delete(this.id.getActorID())),{opInfos:s,reverseOps:i}}toTestString(){return`${this.operations.map(e=>e.toTestString()).join(",")}`}toStruct(){return{changeID:we.bytesToHex(we.toChangeID(this.getID()).toBinary()),message:this.getMessage(),operations:this.getOperations().map(e=>we.bytesToHex(we.toOperation(e).toBinary())),presenceChange:this.getPresenceChange()}}static fromStruct(e){const{changeID:t,operations:r,presenceChange:s,message:i}=e;return Ds.create({id:we.bytesToChangeID(we.hexToBytes(t)),operations:r==null?void 0:r.map(o=>we.bytesToOperation(we.hexToBytes(o))),presenceChange:s,message:i})}}class qo{constructor(e,t,r,s,i,o){c(this,"documentKey");c(this,"checkpoint");c(this,"isRemoved");c(this,"changes");c(this,"snapshot");c(this,"versionVector");this.documentKey=e,this.checkpoint=t,this.isRemoved=r,this.changes=s,this.snapshot=o,this.versionVector=i}static create(e,t,r,s,i,o){return new qo(e,t,r,s,i,o)}getDocumentKey(){return this.documentKey}getCheckpoint(){return this.checkpoint}getIsRemoved(){return this.isRemoved}getChanges(){return this.changes}hasChanges(){return this.changes.length>0}getChangeSize(){return this.changes.length}hasSnapshot(){return!!this.snapshot&&!!this.snapshot.length}getSnapshot(){return this.snapshot}getVersionVector(){return this.versionVector}}class Ts{constructor(e,t){c(this,"serverSeq");c(this,"clientSeq");this.serverSeq=e,this.clientSeq=t}static of(e,t){return new Ts(e,t)}increaseClientSeq(e){return e===0?this:new Ts(this.serverSeq,this.clientSeq+e)}forward(e){if(this.equals(e))return this;const t=this.serverSeq>e.serverSeq?this.serverSeq:e.serverSeq,r=Math.max(this.clientSeq,e.clientSeq);return Ts.of(t,r)}getServerSeqAsString(){return this.serverSeq.toString()}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq}equals(e){return this.clientSeq===e.clientSeq&&this.serverSeq==e.serverSeq}toTestString(){return`serverSeq=${this.serverSeq}, clientSeq=${this.clientSeq}`}}const jp=new Ts(0n,0);class Gt{constructor(e,t){c(this,"createdAt");c(this,"offset");this.createdAt=e,this.offset=t}static of(e,t){return new Gt(e,t)}static fromStruct(e){return Gt.of(yt.fromStruct(e.createdAt),e.offset)}getCreatedAt(){return this.createdAt}getOffset(){return this.offset}equals(e){return this.createdAt.compare(e.createdAt)===0&&this.offset===e.offset}hasSameCreatedAt(e){return this.createdAt.compare(e.createdAt)===0}split(e){return new Gt(this.createdAt,this.offset+e)}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toTestString(){return`${this.createdAt.toTestString()}:${this.offset}`}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}}const Hp=Gt.of(Ns,0);class xt{constructor(e,t){c(this,"id");c(this,"relativeOffset");this.id=e,this.relativeOffset=t}static of(e,t){return new xt(e,t)}static fromStruct(e){const t=Gt.fromStruct(e.id);return xt.of(t,e.relativeOffset)}getID(){return this.id}getRelativeOffset(){return this.relativeOffset}getAbsoluteID(){return Gt.of(this.id.getCreatedAt(),this.id.getOffset()+this.relativeOffset)}toTestString(){return`${this.id.toTestString()}:${this.relativeOffset}`}toStruct(){return{id:this.id.toStruct(),relativeOffset:this.relativeOffset}}equals(e){return this.id.equals(e.id)?this.relativeOffset===e.relativeOffset:!1}}class Lr extends Qf{constructor(t,r,s){super(r);c(this,"id");c(this,"removedAt");c(this,"prev");c(this,"next");c(this,"insPrev");c(this,"insNext");this.id=t,this.removedAt=s}static create(t,r){return new Lr(t,r)}static createComparator(){return(t,r)=>{const s=t.getCreatedAt().compare(r.getCreatedAt());return s!==0?s:t.getOffset()>r.getOffset()?1:t.getOffset()<r.getOffset()?-1:0}}getID(){return this.id}getCreatedAt(){return this.id.getCreatedAt()}getLength(){return this.removedAt?0:this.getContentLength()}getContentLength(){return this.value&&this.value.length||0}getPrev(){return this.prev}getNext(){return this.next}getInsPrev(){return this.insPrev}getInsNext(){return this.insNext}getInsPrevID(){return this.insPrev.getID()}setPrev(t){this.prev=t,t&&(t.next=this)}setNext(t){this.next=t,t&&(t.prev=this)}setInsPrev(t){this.insPrev=t,t&&(t.insNext=this)}setInsNext(t){this.insNext=t,t&&(t.insPrev=this)}hasNext(){return!!this.next}hasInsPrev(){return!!this.insPrev}isRemoved(){return!!this.removedAt}getRemovedAt(){return this.removedAt}split(t){return new Lr(this.id.split(t),this.splitValue(t),this.removedAt)}canDelete(t,r){const s=!this.removedAt;return this.getCreatedAt().getLamport()<=r&&(!this.removedAt||t.after(this.removedAt))?s:!1}canStyle(t,r){return this.getCreatedAt().getLamport()<=r&&(!this.removedAt||t.after(this.removedAt))}remove(t){this.removedAt=t}createPosRange(){return[xt.of(this.id,0),xt.of(this.id,this.getLength())]}getDataSize(){const t=this.value.getDataSize();return this.id&&(t.meta+=Ht),this.removedAt&&(t.meta+=Ht),t}deepcopy(){return new Lr(this.id,this.value,this.removedAt)}toTestString(){return`${this.id.toTestString()} ${this.value?this.value:""}`}splitValue(t){const r=this.value;return this.value=r.substring(0,t),r.substring(t,r.length)}toIDString(){return this.id.toIDString()}}class Os{constructor(){c(this,"head");c(this,"treeByIndex");c(this,"treeByID");this.head=Lr.create(Hp),this.treeByIndex=new di,this.treeByID=new ch(Lr.createComparator()),this.treeByIndex.insert(this.head),this.treeByID.put(this.head.getID(),this.head)}static create(){return new Os}edit(e,t,r,s){const i={data:0,meta:0},[o,a,u]=this.findNodeWithSplit(e[1],t),[l,f,d]=this.findNodeWithSplit(e[0],t);Ee(i,a,f);const y=this.findBetween(d,u),[m,S]=this.deleteNodes(y,t,s),I=u?u.getID():o.getID();let C=xt.of(I,0);if(r){const $=this.posToIndex(l.createPosRange()[1],!0),V=this.insertAfter(l,Lr.create(Gt.of(t,0),r));Ee(i,V.getDataSize()),m.length&&m[m.length-1].from===$?m[m.length-1].value=r:m.push({actor:t.getActorID(),from:$,to:$,value:r}),C=xt.of(V.getID(),V.getContentLength())}const R=[];for(const[,$]of S)R.push({parent:this,child:$});return[C,R,i,m]}indexToPos(e){const[t,r]=this.treeByIndex.find(e),s=t;return xt.of(s.getID(),r)}findIndexesFromRange(e){const[t,r]=e;return[this.posToIndex(t,!1),this.posToIndex(r,!0)]}posToIndex(e,t){const r=e.getAbsoluteID(),s=t?this.findFloorNodePreferToLeft(r):this.findFloorNode(r);if(!s)throw new w(v.ErrInvalidArgument,`the node of the given id should be found: ${r.toTestString()}`);const i=this.treeByIndex.indexOf(s),o=s.isRemoved()?0:r.getOffset()-s.getID().getOffset();return i+o}findNode(e){return this.findFloorNode(e)}get length(){return this.treeByIndex.length}getTreeByIndex(){return this.treeByIndex}getTreeByID(){return this.treeByID}toString(){const e=[];for(const t of this)t.isRemoved()||e.push(t.getValue());return e.join("")}*[Symbol.iterator](){let e=this.head.getNext();for(;e;)yield e,e=e.getNext()}getHead(){return this.head}deepcopy(){const e=new Os;let t=this.head.getNext(),r=e.head,s;for(;t;){if(s=e.insertAfter(r,t.deepcopy()),t.hasInsPrev()){const i=e.findNode(t.getInsPrevID());s.setInsPrev(i)}r=s,t=t.getNext()}return e}toTestString(){const e=[];let t=this.head;for(;t;)t.isRemoved()?e.push(`{${t.toTestString()}}`):e.push(`[${t.toTestString()}]`),t=t.getNext();return e.join("")}insertAfter(e,t){const r=e.getNext();return t.setPrev(e),r&&r.setPrev(t),this.treeByID.put(t.getID(),t),this.treeByIndex.insertAfter(e,t),t}findNodeWithSplit(e,t){const r=e.getAbsoluteID();let s=this.findFloorNodePreferToLeft(r);const i=r.getOffset()-s.getID().getOffset(),[,o]=this.splitNode(s,i);for(;s.hasNext()&&s.getNext().getCreatedAt().after(t);)s=s.getNext();return[s,o,s.getNext()]}findFloorNodePreferToLeft(e){let t=this.findFloorNode(e);if(!t)throw new w(v.ErrInvalidArgument,`the node of the given id should be found: ${e.toTestString()}`);if(e.getOffset()>0&&t.getID().getOffset()==e.getOffset()){if(!t.hasInsPrev())return t;t=t.getInsPrev()}return t}findFloorNode(e){const t=this.treeByID.floorEntry(e);if(t&&!(!t.key.equals(e)&&!t.key.hasSameCreatedAt(e)))return t.value}findBetween(e,t){const r=[];let s=e;for(;s&&s!==t;)r.push(s),s=s.getNext();return r}splitNode(e,t){const r={data:0,meta:0};if(t>e.getContentLength())throw new w(v.ErrInvalidArgument,"offset should be less than or equal to length");if(t===0)return[e,r];if(t===e.getContentLength())return[e.getNext(),r];const s=e.getDataSize(),i=e.split(t);this.treeByIndex.updateWeight(i),this.insertAfter(e,i);const o=e.getInsNext();return o&&o.setInsPrev(i),i.setInsPrev(e),Ee(r,e.getDataSize(),i.getDataSize()),ws(r,s),[i,r]}deleteNodes(e,t,r){if(!e.length)return[[],new Map];const[s,i]=this.filterNodes(e,t,r),o=new Map,a=this.makeChanges(i,t);for(const u of s)o.set(u.getID().toIDString(),u),u.remove(t);return this.deleteIndexNodes(i),[a,o]}filterNodes(e,t,r){const s=[],i=[],[o,a]=this.findEdgesOfCandidates(e);i.push(o);for(const u of e){const l=u.getCreatedAt().getActorID();let f=Qs;r!=null&&(f=r.get(l)?r.get(l):0n),u.canDelete(t,f)?s.push(u):i.push(u)}return i.push(a),[s,i]}findEdgesOfCandidates(e){return[e[0].getPrev(),e[e.length-1].getNext()]}makeChanges(e,t){const r=[];let s,i;for(let o=0;o<e.length-1;o++){const a=e[o],u=e[o+1];a.getNext()!=u&&([s]=this.findIndexesFromRange(a.getNext().createPosRange()),u?[,i]=this.findIndexesFromRange(u.getPrev().createPosRange()):i=this.treeByIndex.length,s<i&&r.push({actor:t.getActorID(),from:s,to:i}))}return r.reverse()}deleteIndexNodes(e){for(let t=0;t<e.length-1;t++){const r=e[t],s=e[t+1];r.getNext()!=s&&this.treeByIndex.deleteRange(r,s)}}purge(e){this.treeByIndex.delete(e),this.treeByID.remove(e.getID());const t=e.getPrev(),r=e.getNext(),s=e.getInsPrev(),i=e.getInsNext();t&&t.setNext(r),r&&r.setPrev(t),e.setPrev(void 0),e.setNext(void 0),s&&s.setInsNext(i),i&&i.setInsPrev(s),e.setInsPrev(void 0),e.setInsNext(void 0)}}const hl=n=>n<0?Math.ceil(n):Math.floor(n);var Xt=(n=>(n[n.Int=0]="Int",n[n.Long=1]="Long",n))(Xt||{});class He extends bi{constructor(t,r,s){super(s);c(this,"valueType");c(this,"value");switch(this.valueType=t,t){case 0:typeof r=="number"?r>Math.pow(2,31)-1||r<-Math.pow(2,31)?this.value=Z.fromNumber(r).toInt():this.value=hl(r):this.value=r.toInt();break;case 1:typeof r=="number"?this.value=Z.fromNumber(r):this.value=r;break;default:throw new w(v.ErrUnimplemented,`unimplemented type: ${t}`)}}static create(t,r,s){return new He(t,r,s)}static valueFromBytes(t,r){switch(t){case 0:return r[0]|r[1]<<8|r[2]<<16|r[3]<<24;case 1:return Z.fromBytesLE(Array.from(r));default:throw new w(v.ErrUnimplemented,`unimplemented type: ${t}`)}}getDataSize(){return{data:this.valueType===0?4:8,meta:this.getMetaUsage()}}toJSON(){return`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_COUNTER"}}deepcopy(){const t=He.create(this.valueType,this.value,this.getCreatedAt());return t.setMovedAt(this.getMovedAt()),t}getType(){return this.valueType}static getCounterType(t){switch(typeof t){case"object":return t instanceof Z?1:void 0;case"number":return t>Math.pow(2,31)-1||t<-Math.pow(2,31)?1:0;default:return}}static isSupport(t){return!!He.getCounterType(t)}static isInteger(t){return t%1===0}isNumericType(){const t=this.valueType;return t===0||t===1}getValueType(){return this.valueType}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:{const t=this.value;return new Uint8Array([t&255,t>>8&255,t>>16&255,t>>24&255])}case 1:{const r=this.value.toBytesLE();return Uint8Array.from(r)}default:throw new w(v.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}increase(t){function r(s){if(!s.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof s.getValue()}`)}return r(this),r(t),this.valueType===1?this.value=this.value.add(t.getValue()):t.getType()===le.Long?this.value=this.value+t.getValue().toInt():this.value=Z.fromNumber(this.value+hl(t.getValue())).toInt(),this}}class Rs extends kt{constructor(t,r,s){super(t,s);c(this,"value");this.value=r}static create(t,r,s){return new Rs(t,r,s)}execute(t){const r=t.findByCreatedAt(this.getParentCreatedAt());if(!r)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(r instanceof He))throw new w(v.ErrInvalidArgument,"fail to execute, only Counter can execute increase");const s=r,i=this.value.deepcopy();return s.increase(i),{opInfos:[{type:"increase",path:t.createPath(this.getParentCreatedAt()),value:i.getValue()}],reverseOp:this.toReverseOperation()}}toReverseOperation(){const t=this.value.deepcopy(),s=t.getType()===le.Long?t.getValue().multiply(-1):t.getValue()*-1;return Rs.create(this.getParentCreatedAt(),pe.of(s,t.getCreatedAt()))}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.INCREASE.${this.value.toJSON()}`}getValue(){return this.value}}class wr extends kt{constructor(t,r,s,i,o,a){super(t,a);c(this,"fromPos");c(this,"toPos");c(this,"attributes");c(this,"attributesToRemove");this.fromPos=r,this.toPos=s,this.attributes=i,this.attributesToRemove=o}static create(t,r,s,i,o){return new wr(t,r,s,i,[],o)}static createTreeRemoveStyleOperation(t,r,s,i,o){return new wr(t,r,s,new Map,i,o)}execute(t,r,s){const i=t.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof nt))throw new w(v.ErrInvalidArgument,"fail to execute, only Tree can execute edit");const o=i;let a,u,l={data:0,meta:0};if(this.attributes.size){const f={};[...this.attributes].forEach(([d,y])=>f[d]=y),[u,a,l]=o.style([this.fromPos,this.toPos],f,this.getExecutedAt(),s)}else{const f=this.attributesToRemove;[u,a,l]=o.removeStyle([this.fromPos,this.toPos],f,this.getExecutedAt(),s)}t.acc(l);for(const f of u)t.registerGCPair(f);return{opInfos:a.map(({from:f,to:d,value:y,fromPath:m,toPath:S})=>({type:"tree-style",from:f,to:d,value:this.attributes.size?{attributes:y}:{attributesToRemove:y},fromPath:m,toPath:S,path:t.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const t=this.getParentCreatedAt().toTestString(),r=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.fromPos.getLeftSiblingID().getOffset()}`,s=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.toPos.getLeftSiblingID().getOffset()}`;return`${t}.STYLE(${r},${s},${Object.entries(this.attributes||{}).map(([i,o])=>`${i}:"${o}"`).join(" ")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getAttributesToRemove(){return this.attributesToRemove}}function Wp(n){const e=new xc,t=e.data;for(const[r,s]of Object.entries(n))t[r]=JSON.stringify(s);return e}function Gp(n){if(n.type===Yt.Put)return new fi({type:ns.PUT,presence:Wp(n.presence)});if(n.type===Yt.Clear)return new fi({type:ns.CLEAR});throw new w(v.ErrUnimplemented,"unimplemented type")}function _p(n){return new Xf({serverSeq:n.getServerSeq(),clientSeq:n.getClientSeq()})}function fh(n){return new Fo({clientSeq:n.getClientSeq(),lamport:n.getLamport(),actorId:Vo(n.getActorID()),versionVector:Pc(n.getVersionVector())})}function U(n){if(n)return new F({lamport:n.getLamport(),delimiter:n.getDelimiter(),actorId:Vo(n.getActorID())})}function Pc(n){if(!n)return;const e=new $o;for(const[t,r]of n){const s=Dy(Vo(t));e.vector[s]=BigInt(r.toString())}return e}function hh(n){switch(n){case le.Null:return G.NULL;case le.Boolean:return G.BOOLEAN;case le.Integer:return G.INTEGER;case le.Long:return G.LONG;case le.Double:return G.DOUBLE;case le.String:return G.STRING;case le.Bytes:return G.BYTES;case le.Date:return G.DATE;default:throw new w(v.ErrInvalidType,`unsupported type: ${n}`)}}function dh(n){switch(n){case Xt.Int:return G.INTEGER_CNT;case Xt.Long:return G.LONG_CNT;default:throw new w(v.ErrInvalidType,`unsupported type: ${n}`)}}function ca(n){if(n instanceof Ce)return new st({type:G.JSON_OBJECT,createdAt:U(n.getCreatedAt()),value:kh(n)});if(n instanceof Me)return new st({type:G.JSON_ARRAY,createdAt:U(n.getCreatedAt()),value:Ey(n)});if(n instanceof tt)return new st({type:G.TEXT,createdAt:U(n.getCreatedAt())});if(n instanceof pe)return new st({type:hh(n.getType()),createdAt:U(n.getCreatedAt()),value:n.toBytes()});if(n instanceof He)return new st({type:dh(n.getType()),createdAt:U(n.getCreatedAt()),value:n.toBytes()});if(n instanceof nt)return new st({type:G.TREE,createdAt:U(n.getCreatedAt()),value:Py(n)});throw new w(v.ErrUnimplemented,"unimplemented element")}function Yp(n){return new ui({createdAt:U(n.getCreatedAt()),offset:n.getOffset()})}function Oi(n){return new br({createdAt:U(n.getID().getCreatedAt()),offset:n.getID().getOffset(),relativeOffset:n.getRelativeOffset()})}function Ri(n){return new ts({parentId:ei(n.getParentID()),leftSiblingId:ei(n.getLeftSiblingID())})}function ei(n){return new Rr({createdAt:U(n.getCreatedAt()),offset:n.getOffset()})}function gh(n){const e=new Ac;if(n instanceof rs){const t=n,r=new to;r.parentCreatedAt=U(t.getParentCreatedAt()),r.key=t.getKey(),r.value=ca(t.getValue()),r.executedAt=U(t.getExecutedAt()),e.body.case="set",e.body.value=r}else if(n instanceof Bs){const t=n,r=new no;r.parentCreatedAt=U(t.getParentCreatedAt()),r.prevCreatedAt=U(t.getPrevCreatedAt()),r.value=ca(t.getValue()),r.executedAt=U(t.getExecutedAt()),e.body.case="add",e.body.value=r}else if(n instanceof yr){const t=n,r=new ro;r.parentCreatedAt=U(t.getParentCreatedAt()),r.prevCreatedAt=U(t.getPrevCreatedAt()),r.createdAt=U(t.getCreatedAt()),r.executedAt=U(t.getExecutedAt()),e.body.case="move",e.body.value=r}else if(n instanceof Tr){const t=n,r=new so;r.parentCreatedAt=U(t.getParentCreatedAt()),r.createdAt=U(t.getCreatedAt()),r.executedAt=U(t.getExecutedAt()),e.body.case="remove",e.body.value=r}else if(n instanceof Ti){const t=n,r=new io;r.parentCreatedAt=U(t.getParentCreatedAt()),r.from=Oi(t.getFromPos()),r.to=Oi(t.getToPos()),r.content=t.getContent();const s=r.attributes;for(const[i,o]of t.getAttributes())s[i]=o;r.executedAt=U(t.getExecutedAt()),e.body.case="edit",e.body.value=r}else if(n instanceof Si){const t=n,r=new oo;r.parentCreatedAt=U(t.getParentCreatedAt()),r.from=Oi(t.getFromPos()),r.to=Oi(t.getToPos());const s=r.attributes;for(const[i,o]of t.getAttributes())s[i]=o;r.executedAt=U(t.getExecutedAt()),e.body.case="style",e.body.value=r}else if(n instanceof Rs){const t=n,r=new ao;r.parentCreatedAt=U(t.getParentCreatedAt()),r.value=ca(t.getValue()),r.executedAt=U(t.getExecutedAt()),e.body.case="increase",e.body.value=r}else if(n instanceof Ii){const t=n,r=new co;r.parentCreatedAt=U(t.getParentCreatedAt()),r.from=Ri(t.getFromPos()),r.to=Ri(t.getToPos()),r.contents=ry(t.getContents()),r.splitLevel=t.getSplitLevel(),r.executedAt=U(t.getExecutedAt()),e.body.case="treeEdit",e.body.value=r}else if(n instanceof wr){const t=n,r=new uo;r.parentCreatedAt=U(t.getParentCreatedAt()),r.from=Ri(t.getFromPos()),r.to=Ri(t.getToPos());const s=t.getAttributesToRemove();if(s.length>0)r.attributesToRemove=s;else{const i=r.attributes;for(const[o,a]of t.getAttributes())i[o]=a}r.executedAt=U(t.getExecutedAt()),e.body.case="treeStyle",e.body.value=r}else throw new w(v.ErrUnimplemented,"unimplemented operation");return e}function Xp(n){const e=[];for(const t of n)e.push(gh(t));return e}function Zp(n){const e=new _f({id:fh(n.getID()),message:n.getMessage()});return n.hasOperations()&&(e.operations=Xp(n.getOperations())),n.hasPresenceChange()&&(e.presenceChange=Gp(n.getPresenceChange())),e}function Qp(n){const e=[];for(const t of n)e.push(Zp(t));return e}function ey(n){const e=[];for(const t of n)e.push(new Yf({key:t.getStrKey(),element:Dc(t.getValue())}));return e}function ty(n){const e=[];for(const t of n)e.push(new yo({element:Dc(t.getValue())}));return e}function ny(n){const e=[];for(const t of n){const r=new vo;r.id=Yp(t.getID()),r.value=t.getValue().getContent(),r.removedAt=U(t.getRemovedAt());const s=r.attributes,i=t.getValue().getAttrs();for(const o of i){const a=new Es;a.value=o.getValue(),a.updatedAt=U(o.getUpdatedAt()),s[o.getKey()]=a}e.push(r)}return e}function ry(n){const e=[];if(!n||!n.length)return e;for(const t of n)e.push(new wo({content:Cc(t)}));return e}function sy(n){const e={};for(const t of n)e[t.getKey()]=new Es({value:t.getValue(),updatedAt:U(t.getUpdatedAt()),isRemoved:t.isRemoved()});return e}function Cc(n){if(!n)return[];const e=[];return Uo(n,(t,r)=>{const s=new li({id:ei(t.id),type:t.type,removedAt:U(t.removedAt),depth:r});t.isText&&(s.value=t.value),t.insPrevID&&(s.insPrevId=ei(t.insPrevID)),t.insNextID&&(s.insNextId=ei(t.insNextID)),t.attrs&&(s.attributes=sy(t.attrs)),e.push(s)}),e}function iy(n){const e=new We;return e.body.case="jsonObject",e.body.value=new lo({nodes:ey(n.getRHT()),createdAt:U(n.getCreatedAt()),movedAt:U(n.getMovedAt()),removedAt:U(n.getRemovedAt())}),e}function mh(n){const e=new We;return e.body.case="jsonArray",e.body.value=new fo({nodes:ty(n.getElements()),createdAt:U(n.getCreatedAt()),movedAt:U(n.getMovedAt()),removedAt:U(n.getRemovedAt())}),e}function oy(n){const e=new We;return e.body.case="primitive",e.body.value=new ho({type:hh(n.getType()),value:n.toBytes(),createdAt:U(n.getCreatedAt()),movedAt:U(n.getMovedAt()),removedAt:U(n.getRemovedAt())}),e}function ay(n){const e=new We;return e.body.case="text",e.body.value=new go({nodes:ny(n.getRGATreeSplit()),createdAt:U(n.getCreatedAt()),movedAt:U(n.getMovedAt()),removedAt:U(n.getRemovedAt())}),e}function cy(n){const e=new We;return e.body.case="counter",e.body.value=new mo({type:dh(n.getType()),value:n.toBytes(),createdAt:U(n.getCreatedAt()),movedAt:U(n.getMovedAt()),removedAt:U(n.getRemovedAt())}),e}function ph(n){const e=new We;return e.body.case="tree",e.body.value=new po({nodes:Cc(n.getRoot()),createdAt:U(n.getCreatedAt()),movedAt:U(n.getMovedAt()),removedAt:U(n.getRemovedAt())}),e}function Dc(n){if(n instanceof Ce)return iy(n);if(n instanceof Me)return mh(n);if(n instanceof pe)return oy(n);if(n instanceof tt)return ay(n);if(n instanceof He)return cy(n);if(n instanceof nt)return ph(n);throw new w(v.ErrUnimplemented,"unimplemented element")}function uy(n){return new Ar({documentKey:n.getDocumentKey(),checkpoint:_p(n.getCheckpoint()),isRemoved:n.getIsRemoved(),changes:Qp(n.getChanges()),snapshot:n.getSnapshot(),versionVector:Pc(n.getVersionVector())})}function Ks(n){if(!(n instanceof re))return{};const e=n.findDetails(kp);for(const t of e)return t.metadata;return{}}function kr(n){return Ks(n).code??""}function yh(n){return bt.of(n.clientSeq,BigInt(n.lamport),Jc(n.actorId),Oc(n.versionVector),BigInt(n.serverSeq))}function Oc(n){if(!n)return;const e=new bs;return Object.entries(n.vector).forEach(([t,r])=>{const s=zo(Cy(t));e.set(s,BigInt(r.toString()))}),e}function z(n){if(n)return yt.of(BigInt(n.lamport),n.delimiter,Jc(n.actorId))}function Rc(n){const e={};return Object.entries(n.data).forEach(([t,r])=>{e[t]=JSON.parse(r)}),e}function ly(n){const e=n.type;if(e===ns.PUT){const t=Rc(n.presence);return{type:Yt.Put,presence:t}}if(e===ns.CLEAR)return{type:Yt.Clear};throw new w(v.ErrInvalidType,`unsupported type: ${e}`)}function fy(n){const e=new Map;return Object.entries(n).forEach(([t,r])=>{e.set(t,Rc(r))}),e}function vh(n){switch(n){case G.NULL:return le.Null;case G.BOOLEAN:return le.Boolean;case G.INTEGER:return le.Integer;case G.LONG:return le.Long;case G.DOUBLE:return le.Double;case G.STRING:return le.String;case G.BYTES:return le.Bytes;case G.DATE:return le.Date}throw new w(v.ErrUnimplemented,`unimplemented value type: ${n}`)}function Ao(n){switch(n){case G.INTEGER_CNT:return Xt.Int;case G.LONG_CNT:return Xt.Long}throw new w(v.ErrUnimplemented,`unimplemented value type: ${n}`)}function ua(n){switch(n.type){case G.JSON_OBJECT:return n.value?xh(n.value):Ce.create(z(n.createdAt));case G.JSON_ARRAY:return n.value?ky(n.value):Me.create(z(n.createdAt));case G.TEXT:return tt.create(Os.create(),z(n.createdAt));case G.TREE:return Ny(n.value);case G.NULL:case G.BOOLEAN:case G.INTEGER:case G.LONG:case G.DOUBLE:case G.STRING:case G.BYTES:case G.DATE:return pe.of(pe.valueFromBytes(vh(n.type),n.value),z(n.createdAt));case G.INTEGER_CNT:case G.LONG_CNT:return He.create(Ao(n.type),He.valueFromBytes(Ao(n.type),n.value),z(n.createdAt))}}function Bi(n){return xt.of(Gt.of(z(n.createdAt),n.offset),n.relativeOffset)}function wh(n){return Gt.of(z(n.createdAt),n.offset)}function hy(n){const e=mi.create(n.value);Object.entries(n.attributes).forEach(([r,s])=>{e.setAttr(r,s.value,z(s.updatedAt))});const t=Lr.create(wh(n.id),e);return t.remove(z(n.removedAt)),t}function cs(n){return St.of(ti(n.parentId),ti(n.leftSiblingId))}function ti(n){return Ne.of(z(n.createdAt),n.offset)}function dy(n){if(!n.length)return;const e=[];return n.forEach(t=>{const r=Bc(t.content);e.push(r)}),e}function Bc(n){if(n.length===0)return;const e=[];for(const s of n)e.push(my(s));const t=e[e.length-1],r=new Map;r.set(n[e.length-1].depth,e[e.length-1]);for(let s=e.length-2;s>=0;s--)r.get(n[s].depth-1).prepend(e[s]),r.set(n[s].depth,e[s]);return t.updateDescendantsSize(),nt.create(t,Ns).getRoot()}function gy(n){const e=Sr.create();for(const[t,r]of Object.entries(n))e.setInternal(t,r.value,z(r.updatedAt),r.isRemoved);return e}function my(n){const e=ti(n.id),t=et.create(e,n.type),r=Object.entries(n.attributes);return t.isText?t.value=n.value:r.length&&(t.attrs=gy(n.attributes)),n.insPrevId&&(t.insPrevID=ti(n.insPrevId)),n.insNextId&&(t.insNextID=ti(n.insNextId)),t.removedAt=z(n.removedAt),t}function bh(n){if(n.body.case==="set"){const e=n.body.value;return rs.create(e.key,ua(e.value),z(e.parentCreatedAt),z(e.executedAt))}else if(n.body.case==="add"){const e=n.body.value;return Bs.create(z(e.parentCreatedAt),z(e.prevCreatedAt),ua(e.value),z(e.executedAt))}else if(n.body.case==="move"){const e=n.body.value;return yr.create(z(e.parentCreatedAt),z(e.prevCreatedAt),z(e.createdAt),z(e.executedAt))}else if(n.body.case==="remove"){const e=n.body.value;return Tr.create(z(e.parentCreatedAt),z(e.createdAt),z(e.executedAt))}else if(n.body.case==="edit"){const e=n.body.value,t=new Map;return Object.entries(e.attributes).forEach(([r,s])=>{t.set(r,s)}),Ti.create(z(e.parentCreatedAt),Bi(e.from),Bi(e.to),e.content,t,z(e.executedAt))}else if(n.body.case==="style"){const e=n.body.value,t=new Map;return Object.entries(e.attributes).forEach(([r,s])=>{t.set(r,s)}),Si.create(z(e.parentCreatedAt),Bi(e.from),Bi(e.to),t,z(e.executedAt))}else{if(n.body.case==="select")return;if(n.body.case==="increase"){const e=n.body.value;return Rs.create(z(e.parentCreatedAt),ua(e.value),z(e.executedAt))}else if(n.body.case==="treeEdit"){const e=n.body.value;return Ii.create(z(e.parentCreatedAt),cs(e.from),cs(e.to),dy(e.contents),e.splitLevel,z(e.executedAt))}else if(n.body.case==="treeStyle"){const e=n.body.value,t=new Map,r=e.attributesToRemove;return(r==null?void 0:r.length)>0?wr.createTreeRemoveStyleOperation(z(e.parentCreatedAt),cs(e.from),cs(e.to),r,z(e.executedAt)):(Object.entries(e.attributes).forEach(([s,i])=>{t.set(s,i)}),wr.create(z(e.parentCreatedAt),cs(e.from),cs(e.to),t,z(e.executedAt)))}else throw new w(v.ErrUnimplemented,"unimplemented operation")}}function py(n){const e=[];for(const t of n){const r=bh(t);r&&e.push(r)}return e}function Th(n){const e=[];for(const t of n)e.push(Ds.create({id:yh(t.id),operations:py(t.operations),presenceChange:t.presenceChange?ly(t.presenceChange):void 0,message:t.message}));return e}function yy(n){return Ts.of(BigInt(n.serverSeq),n.clientSeq)}function vy(n){return qo.create(n.documentKey,yy(n.checkpoint),n.isRemoved,Th(n.changes),Oc(n.versionVector),n.snapshot)}function Sh(n){const e=new hi;for(const r of n.nodes){const s=Lc(r.element);e.set(r.key,s,s.getPositionedAt())}const t=new Ce(z(n.createdAt),e);return t.setMovedAt(z(n.movedAt)),t.setRemovedAt(z(n.removedAt)),t}function Ih(n){const e=new gi;for(const r of n.nodes)e.insert(Lc(r.element));const t=new Me(z(n.createdAt),e);return t.setMovedAt(z(n.movedAt)),t.setRemovedAt(z(n.removedAt)),t}function wy(n){const e=pe.of(pe.valueFromBytes(vh(n.type),n.value),z(n.createdAt));return e.setMovedAt(z(n.movedAt)),e.setRemovedAt(z(n.removedAt)),e}function by(n){const e=new Os;let t=e.getHead();for(const s of n.nodes){const i=e.insertAfter(t,hy(s));s.insPrevId&&i.setInsPrev(e.findNode(wh(s.insPrevId))),t=i}const r=new tt(e,z(n.createdAt));return r.setMovedAt(z(n.movedAt)),r.setRemovedAt(z(n.removedAt)),r}function Ty(n){const e=He.create(Ao(n.type),He.valueFromBytes(Ao(n.type),n.value),z(n.createdAt));return e.setMovedAt(z(n.movedAt)),e.setRemovedAt(z(n.removedAt)),e}function Ah(n){const e=Bc(n.nodes);return nt.create(e,z(n.createdAt))}function Lc(n){if(n.body.case==="jsonObject")return Sh(n.body.value);if(n.body.case==="jsonArray")return Ih(n.body.value);if(n.body.case==="primitive")return wy(n.body.value);if(n.body.case==="text")return by(n.body.value);if(n.body.case==="counter")return Ty(n.body.value);if(n.body.case==="tree")return Ah(n.body.value);throw new w(v.ErrUnimplemented,"unimplemented element")}function Sy(n){return n.map(e=>({path:e.path,type:e.type}))}function Iy(n){if(!n)return{root:Ce.create(Ns),presences:new Map};const e=Ea.fromBinary(n);return{root:Lc(e.root),presences:fy(e.presences)}}function Ay(n){const e=Pc(n);return zo(e.toBinary())}function xy(n){const e=Fc(n),t=$o.fromBinary(e);return Oc(t)}function xh(n){if(!n)throw new w(v.ErrInvalidArgument,"bytes is empty");const e=We.fromBinary(n);return Sh(e.body.value)}function kh(n){return Dc(n).toBinary()}function ky(n){if(!n)throw new w(v.ErrInvalidArgument,"bytes is empty");const e=We.fromBinary(n);return Ih(e.body.value)}function Ey(n){return mh(n).toBinary()}function Ny(n){if(!n)throw new w(v.ErrInvalidArgument,"bytes is empty");const e=We.fromBinary(n);return Ah(e.body.value)}function Py(n){return ph(n).toBinary()}function zo(n){return n?Array.from(n).map(e=>e.toString(16).padStart(2,"0")).join(""):""}function Jc(n){return zo(n)}function Fc(n){return new Uint8Array(n.match(/.{1,2}/g).map(e=>parseInt(e,16)))}function Cy(n){if(typeof window<"u"&&typeof window.atob=="function"){const e=window.atob(n),t=e.length,r=new Uint8Array(t);for(let s=0;s<t;s++)r[s]=e.charCodeAt(s);return r}else if(typeof globalThis<"u"&&typeof globalThis.Buffer<"u"){const e=globalThis.Buffer;return new Uint8Array(e.from(n,"base64"))}else throw new Error("No base64 decoder available")}function Vo(n){return Fc(n)}function Dy(n){if(typeof window<"u"&&typeof window.btoa=="function"){let e="";for(let t=0;t<n.byteLength;t++)e+=String.fromCharCode(n[t]);return window.btoa(e)}else{if(typeof globalThis<"u"&&typeof globalThis.Buffer<"u")return globalThis.Buffer.from(n).toString("base64");throw new Error("No base64 encoder available")}}function Oy(n){const e=Fo.fromBinary(n);return yh(e)}function Ry(n){const e=Ac.fromBinary(n);return bh(e)}const we={fromPresence:Rc,toChangePack:uy,fromChangePack:vy,fromChanges:Th,toTreeNodes:Cc,fromTreeNodes:Bc,objectToBytes:kh,bytesToObject:xh,bytesToSnapshot:Iy,bytesToHex:zo,hexToBytes:Fc,toHexString:Jc,toUint8Array:Vo,toOperation:gh,toChangeID:fh,PbChangeID:Fo,bytesToChangeID:Oy,bytesToOperation:Ry,versionVectorToHex:Ay,hexToVersionVector:xy,fromSchemaRules:Sy};var Ve=(n=>(n[n.Trivial=0]="Trivial",n[n.Debug=1]="Debug",n[n.Info=2]="Info",n[n.Warn=3]="Warn",n[n.Error=4]="Error",n[n.Fatal=5]="Fatal",n))(Ve||{});let Wr=3;function By(n){Wr=n}const M={trivial:(...n)=>{Wr>0||typeof console<"u"&&console.log("YORKIE T:",...n)},debug:(...n)=>{Wr>1||typeof console<"u"&&console.log("YORKIE D:",...n)},info:(...n)=>{Wr>2||typeof console<"u"&&console.log("YORKIE I:",...n)},warn:(...n)=>{Wr>3||typeof console<"u"&&(typeof console.warn<"u"?console.warn("YORKIE W:",...n):console.log("YORKIE W:",...n))},error:(...n)=>{Wr>4||typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE E:",...n):console.log("YORKIE E:",...n))},fatal:(...n)=>{typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE F:",...n):console.log("YORKIE F:",...n))},isEnabled:n=>Wr<=n};function Eh(){return"xxxxxxxx-xxxx-4xxxy-xxxx-xxxxxxxxxxx".replace(/[xy]/g,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)})}class Ly{constructor(e,t,r,s,i){c(this,"reconnectStreamDelay");c(this,"doc");c(this,"docID");c(this,"syncMode");c(this,"remoteChangeEventReceived");c(this,"watchStream");c(this,"watchLoopTimerID");c(this,"watchAbortController");c(this,"unsubscribeBroadcastEvent");this.reconnectStreamDelay=e,this.doc=t,this.docID=r,this.syncMode=s,this.remoteChangeEventReceived=!1,this.unsubscribeBroadcastEvent=i}changeSyncMode(e){this.syncMode=e}needRealtimeSync(){return this.syncMode===Hi.RealtimeSyncOff?!1:this.syncMode===Hi.RealtimePushOnly?this.doc.hasLocalChanges():this.syncMode!==Hi.Manual&&(this.doc.hasLocalChanges()||this.remoteChangeEventReceived)}async runWatchLoop(e){const t=async()=>{if(this.watchStream)return Promise.resolve();this.watchLoopTimerID&&(clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0);try{[this.watchStream,this.watchAbortController]=await e(()=>{this.watchStream=void 0,this.watchAbortController=void 0,this.watchLoopTimerID=setTimeout(t,this.reconnectStreamDelay)})}catch{}};await t()}cancelWatchStream(){this.watchStream&&this.watchAbortController&&(this.watchAbortController.abort(),this.watchStream=void 0,this.watchAbortController=void 0),clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0}}function Jy(n,e){const t=[];for(const r of e){const s=Fy(n,r.path),i=$y(s,r);if(!i.valid)for(const o of i.errors||[])t.push(o)}return{valid:t.length===0,errors:t}}function Fy(n,e){if(!e.startsWith("$"))throw new Error(`Path must start with $, got ${e}`);const t=e.split(".");let r=n;for(let s=1;s<t.length;s++){const i=t[s];if(!(r instanceof Ce))return;r=r.get(i)}return r}function $y(n,e){switch(e.type){case"string":case"boolean":case"integer":case"double":case"long":case"date":case"bytes":case"null":return Uy(n,e);case"object":if(!(n instanceof Ce))return{valid:!1,errors:[{path:e.path,message:`Expected object at path ${e.path}`}]};break;case"array":if(!(n instanceof Me))return{valid:!1,errors:[{path:e.path,message:`Expected array at path ${e.path}`}]};break;case"yorkie.Text":if(!(n instanceof tt))return{valid:!1,errors:[{path:e.path,message:`Expected yorkie.Text at path ${e.path}`}]};break;case"yorkie.Tree":if(!(n instanceof nt))return{valid:!1,errors:[{path:e.path,message:`Expected yorkie.Tree at path ${e.path}`}]};break;case"yorkie.Counter":if(!(n instanceof He))return{valid:!1,errors:[{path:e.path,message:`Expected yorkie.Counter at path ${e.path}`}]};break;default:throw new Error(`Unknown rule type: ${e.type}`)}return{valid:!0}}function My(n){switch(n){case"null":return le.Null;case"boolean":return le.Boolean;case"integer":return le.Integer;case"long":return le.Long;case"double":return le.Double;case"string":return le.String;case"bytes":return le.Bytes;case"date":return le.Date;default:throw new Error(`Unknown primitive type: ${n}`)}}function Uy(n,e){return n instanceof pe&&n.getType()===My(e.type)?{valid:!0}:{valid:!1,errors:[{path:e.path,message:`Expected ${e.type} at path ${e.path}`}]}}const la=()=>{};class qy{constructor(e){c(this,"finalized",!1);c(this,"observers",[]);c(this,"finalError");try{e(this)}catch(t){this.error(t)}}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(!e)throw new w(v.ErrInvalidArgument,"missing observer");if(this.finalized)throw new w(v.ErrRefused,"observable is finalized due to previous error");typeof e=="object"?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=la),s.error===void 0&&(s.error=la),s.complete===void 0&&(s.complete=la);const i=Eh(),o=this.unsubscribeOne.bind(this,i);if(this.observers.push({subscriptionID:i,observer:s}),this.finalized)try{this.finalError?s.error(this.finalError):s.complete()}catch(a){M.warn(a)}return o}unsubscribeOne(e){var t;this.observers=(t=this.observers)==null?void 0:t.filter(r=>r.subscriptionID!==e)}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e].observer)}catch(r){M.error(r)}}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.observers=void 0)}}function zy(n){const e=new qy(n);return{subscribe:e.subscribe.bind(e),getProxy:()=>e}}class ds{constructor(e,t,r,s){c(this,"prevID");c(this,"nextID");c(this,"delimiter");c(this,"message");c(this,"root");c(this,"operations");c(this,"presenceChange");c(this,"previousPresence");c(this,"reversePresenceKeys");this.prevID=e,this.nextID=e.next(),this.delimiter=Zf,this.root=t,this.operations=[],this.previousPresence=wt(r),this.presenceChange=void 0,this.reversePresenceKeys=new Set,this.message=s}static create(e,t,r,s){return new ds(e,t,r,s)}push(e){this.operations.push(e)}registerElement(e,t){this.root.registerElement(e,t)}registerRemovedElement(e){this.root.registerRemovedElement(e)}registerGCPair(e){this.root.registerGCPair(e)}getNextID(){return this.isPresenceOnlyChange()?this.prevID.next(!0).setLamport(this.prevID.getLamport()).setVersionVector(this.prevID.getVersionVector()):this.nextID}toChange(){const e=this.isPresenceOnlyChange()?this.prevID.next(!0):this.nextID;return Ds.create({id:e,operations:this.operations,presenceChange:this.presenceChange,message:this.message})}isPresenceOnlyChange(){return this.operations.length===0}hasChange(){return this.operations.length>0||this.presenceChange!==void 0}setPresenceChange(e){this.presenceChange=e}setReversePresence(e,t){for(const r of Object.keys(e))t!=null&&t.addToHistory?this.reversePresenceKeys.add(r):this.reversePresenceKeys.delete(r)}getReversePresence(){if(this.reversePresenceKeys.size===0)return;const e={};for(const t of this.reversePresenceKeys)e[t]=this.previousPresence[t];return e}issueTimeTicket(){return this.delimiter+=1,this.nextID.createTimeTicket(this.delimiter)}getLastTimeTicket(){return this.nextID.createTimeTicket(this.delimiter)}acc(e){this.root.acc(e)}}class pi{constructor(e){c(this,"rootObject");c(this,"elementPairMapByCreatedAt");c(this,"gcElementSetByCreatedAt");c(this,"gcPairMap");c(this,"docSize");this.rootObject=e,this.elementPairMapByCreatedAt=new Map,this.gcElementSetByCreatedAt=new Set,this.gcPairMap=new Map,this.docSize={live:{data:0,meta:0},gc:{data:0,meta:0}},this.registerElement(e,void 0),e.getDescendants(t=>{if(t.getRemovedAt()&&this.registerRemovedElement(t),t instanceof tt||t instanceof nt)for(const r of t.getGCPairs())this.registerGCPair(r);return!1})}static create(){return new pi(Ce.create(Ns))}findByCreatedAt(e){const t=this.elementPairMapByCreatedAt.get(e.toIDString());if(t)return t.element}findElementPairByCreatedAt(e){return this.elementPairMapByCreatedAt.get(e.toIDString())}createSubPaths(e){let t=this.elementPairMapByCreatedAt.get(e.toIDString());if(!t)return[];const r=[];for(;t.parent;){const s=t.element.getCreatedAt(),i=t.parent.subPathOf(s);if(i===void 0)throw new w(v.ErrInvalidArgument,`cant find the given element: ${s.toIDString()}`);r.unshift(i),t=this.elementPairMapByCreatedAt.get(t.parent.getCreatedAt().toIDString())}return r.unshift("$"),r}createPath(e){return this.createSubPaths(e).join(".")}registerElement(e,t){this.elementPairMapByCreatedAt.set(e.getCreatedAt().toIDString(),{parent:t,element:e}),Ee(this.docSize.live,e.getDataSize()),e instanceof Br&&e.getDescendants((r,s)=>(this.elementPairMapByCreatedAt.set(r.getCreatedAt().toIDString(),{parent:s,element:r}),Ee(this.docSize.live,r.getDataSize()),!1))}deregisterElement(e){let t=0;const r=s=>{const i=s.getCreatedAt().toIDString();ws(this.docSize.gc,s.getDataSize()),this.elementPairMapByCreatedAt.delete(i),this.gcElementSetByCreatedAt.delete(i),t++};return r(e),e instanceof Br&&e.getDescendants(s=>(r(s),!1)),t}registerRemovedElement(e){Ee(this.docSize.gc,e.getDataSize()),ws(this.docSize.live,e.getDataSize()),this.docSize.live.meta+=Ht,this.gcElementSetByCreatedAt.add(e.getCreatedAt().toIDString())}registerGCPair(e){if(this.gcPairMap.get(e.child.toIDString())){this.gcPairMap.delete(e.child.toIDString());return}this.gcPairMap.set(e.child.toIDString(),e);const r=this.gcPairMap.get(e.child.toIDString()).child.getDataSize();Ee(this.docSize.gc,r),ws(this.docSize.live,r),e.child instanceof Or||(this.docSize.live.meta+=Ht)}getElementMapSize(){return this.elementPairMapByCreatedAt.size}getGarbageElementSetSize(){const e=new Set;for(const t of this.gcElementSetByCreatedAt){e.add(t);const r=this.elementPairMapByCreatedAt.get(t);r.element instanceof Br&&r.element.getDescendants(s=>(e.add(s.getCreatedAt().toIDString()),!1))}return e.size}getObject(){return this.rootObject}getGarbageLen(){return this.getGarbageElementSetSize()+this.gcPairMap.size}getDocSize(){return this.docSize}deepcopy(){return new pi(this.rootObject.deepcopy())}garbageCollect(e){let t=0;for(const r of this.gcElementSetByCreatedAt){const s=this.elementPairMapByCreatedAt.get(r),i=s.element.getRemovedAt();i&&(e!=null&&e.afterOrEqual(i))&&(s.parent.purge(s.element),t+=this.deregisterElement(s.element))}for(const[,r]of this.gcPairMap){const s=r.child.getRemovedAt();s&&(e!=null&&e.afterOrEqual(s))&&(r.parent.purge(r.child),this.gcPairMap.delete(r.child.toIDString()),t+=1)}return t}toJSON(){return this.rootObject.toJSON()}toSortedJSON(){return this.rootObject.toSortedJSON()}getStats(){return{elements:this.getElementMapSize(),gcPairs:this.gcPairMap.size,gcElements:this.getGarbageElementSetSize()}}acc(e){Ee(this.docSize.live,e)}}function Nh(n,e){const t=new yi(n);return new Proxy(e,t.getHandlers())}class yi{constructor(e){c(this,"context");c(this,"handlers");this.context=e,this.handlers={set:(t,r,s)=>(M.isEnabled(Ve.Trivial)&&M.trivial(`obj[${r}]=${JSON.stringify(s)}`),yi.setInternal(e,t,r,s),!0),get:(t,r)=>(M.isEnabled(Ve.Trivial)&&M.trivial(`obj[${r}]`),r==="getID"?()=>t.getCreatedAt():r==="toJSON"||r==="toString"?()=>t.toJSON():r==="toJS"?()=>t.toJS():r==="toJSForTest"?()=>t.toJSForTest():Gr(e,t.get(r))),ownKeys:t=>t.getKeys(),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),deleteProperty:(t,r)=>(M.isEnabled(Ve.Trivial)&&M.trivial(`obj[${r}]`),yi.deleteInternal(e,t,r),!0)}}static setInternal(e,t,r,s){if(r.includes("."))throw new w(v.ErrInvalidObjectKey,"key must not contain the '.'.");const i=e.issueTimeTicket(),o=xo(e,s,i),a=t.set(r,o,i);e.registerElement(o,t),a&&e.registerRemovedElement(a),e.push(rs.create(r,o.deepcopy(),t.getCreatedAt(),i))}static buildObjectMembers(e,t){const r={};for(const[s,i]of Object.entries(t)){if(s.includes("."))throw new w(v.ErrInvalidObjectKey,"key must not contain the '.'.");const o=e.issueTimeTicket(),a=xo(e,i,o);r[s]=a}return r}static deleteInternal(e,t,r){const s=e.issueTimeTicket(),i=t.deleteByKey(r,s);i&&(e.push(Tr.create(t.getCreatedAt(),i.getCreatedAt(),s)),e.registerRemovedElement(i))}getHandlers(){return this.handlers}}function Vy(n,e){const t=new ve(n,e);return new Proxy(e,t.getHandlers())}function Ky(n){return typeof n=="string"||n instanceof String?!isNaN(n):!1}function jy(n){return["concat","entries","every","filter","find","findIndex","forEach","join","keys","map","reduce","reduceRight","slice","some","toLocaleString","toString","values"].includes(n)}class ve{constructor(e,t){c(this,"context");c(this,"handlers");c(this,"array");this.context=e,this.array=t,this.handlers={get:(r,s,i)=>s==="getID"?()=>r.getCreatedAt():s==="getElementByID"?o=>{const a=r.getByID(o);if(!(!a||a.isRemoved()))return Nr(e,a)}:s==="getElementByIndex"?o=>{const a=r.get(o);return Nr(e,a)}:s==="getLast"?()=>Nr(e,r.getLast()):s==="deleteByID"?o=>{const a=ve.deleteInternalByID(e,r,o);return Nr(e,a)}:s==="insertAfter"?(o,a)=>{const u=ve.insertAfterInternal(e,r,o,a);return Nr(e,u)}:s==="insertBefore"?(o,a)=>{const u=ve.insertBeforeInternal(e,r,o,a);return Nr(e,u)}:s==="moveBefore"?(o,a)=>{ve.moveBeforeInternal(e,r,o,a)}:s==="moveAfter"?(o,a)=>{ve.moveAfterInternal(e,r,o,a)}:s==="moveFront"?o=>{ve.moveFrontInternal(e,r,o)}:s==="moveLast"?o=>{ve.moveLastInternal(e,r,o)}:Ky(s)?Gr(e,r.get(Number(s))):s==="push"?o=>ve.pushInternal(e,r,o):s==="splice"?(o,a,...u)=>ve.splice(e,r,o,a,...u):s==="length"?r.length:typeof s=="symbol"&&s===Symbol.iterator?ve.iteratorInternal.bind(this,e,r):s==="includes"?(o,a)=>ve.includes(e,r,o,a):s==="indexOf"?(o,a)=>ve.indexOf(e,r,o,a):s==="lastIndexOf"?(o,a)=>ve.lastIndexOf(e,r,o,a):s==="toJSForTest"?()=>r.toJSForTest():s==="toTestString"?()=>ve.toTestString(r):typeof s=="string"&&jy(s)?(...o)=>{const a=Array.from(r).map(u=>Gr(e,u));return Array.prototype[s].apply(a,o)}:Reflect.get(r,s,i),deleteProperty:(r,s)=>(M.isEnabled(Ve.Trivial)&&M.trivial(`array[${s}]`),ve.deleteInternalByIndex(e,r,Number.parseInt(s)),!0)}}static*iteratorInternal(e,t){for(const r of t)yield Nr(e,r)}static buildArrayElements(e,t){const r=[];for(const s of t){const i=e.issueTimeTicket(),o=xo(e,s,i);r.push(o)}return r}static pushInternal(e,t,r){return ve.insertAfterInternal(e,t,t.getLastCreatedAt(),r),t.length}static moveBeforeInternal(e,t,r,s){const i=e.issueTimeTicket(),o=t.getPrevCreatedAt(r);t.moveAfter(o,s,i),e.push(yr.create(t.getCreatedAt(),o,s,i))}static moveAfterInternal(e,t,r,s){const i=e.issueTimeTicket();t.moveAfter(r,s,i),e.push(yr.create(t.getCreatedAt(),r,s,i))}static moveFrontInternal(e,t,r){const s=e.issueTimeTicket(),i=t.getHead();t.moveAfter(i.getCreatedAt(),r,s),e.push(yr.create(t.getCreatedAt(),i.getCreatedAt(),r,s))}static moveLastInternal(e,t,r){const s=e.issueTimeTicket(),i=t.getLastCreatedAt();t.moveAfter(i,r,s),e.push(yr.create(t.getCreatedAt(),i,r,s))}static insertAfterInternal(e,t,r,s){const i=e.issueTimeTicket(),o=xo(e,s,i);return t.insertAfter(r,o),e.registerElement(o,t),e.push(Bs.create(t.getCreatedAt(),r,o.deepcopy(),i)),o}static insertBeforeInternal(e,t,r,s){return ve.insertAfterInternal(e,t,t.getPrevCreatedAt(r),s)}static deleteInternalByIndex(e,t,r){const s=e.issueTimeTicket(),i=t.deleteByIndex(r,s);if(i)return e.push(Tr.create(t.getCreatedAt(),i.getCreatedAt(),s)),e.registerRemovedElement(i),i}static deleteInternalByID(e,t,r){const s=e.issueTimeTicket(),i=t.delete(r,s);return e.push(Tr.create(t.getCreatedAt(),i.getCreatedAt(),s)),e.registerRemovedElement(i),i}static splice(e,t,r,s,...i){const o=t.length,a=r>=0?Math.min(r,o):Math.max(o+r,0),u=s===void 0?o:s<0?a:Math.min(a+s,o),l=[];for(let f=a;f<u;f++){const d=ve.deleteInternalByIndex(e,t,a);if(d){const y=d.deepcopy();y.setRemovedAt(),l.push(Gr(e,y))}}if(i){let f=a===0?t.getHead().getID():t.get(a-1).getID();for(const d of i)f=ve.insertAfterInternal(e,t,f,d).getID()}return l}static includes(e,t,r,s){var a;const i=t.length,o=s===void 0?0:s<0?Math.max(s+i,0):s;if(o>=i)return!1;if(pe.isSupport(r))return Array.from(t).map(l=>Gr(e,l)).includes(r,o);for(let u=o;u<i;u++)if(((a=t.get(u))==null?void 0:a.getID())===r.getID())return!0;return!1}static indexOf(e,t,r,s){var a;const i=t.length,o=s===void 0?0:s<0?Math.max(s+i,0):s;if(o>=i)return-1;if(pe.isSupport(r))return Array.from(t).map(l=>Gr(e,l)).indexOf(r,o);for(let u=o;u<i;u++)if(((a=t.get(u))==null?void 0:a.getID())===r.getID())return u;return-1}static lastIndexOf(e,t,r,s){var a;const i=t.length,o=s===void 0||s>=i?i-1:s<0?s+i:s;if(o<0)return-1;if(pe.isSupport(r))return Array.from(t).map(l=>Gr(e,l)).lastIndexOf(r,o);for(let u=o;u>0;u--)if(((a=t.get(u))==null?void 0:a.getID())===r.getID())return u;return-1}static toTestString(e){return e.toTestString()}getHandlers(){return this.handlers}}class $c{constructor(e,t){c(this,"context");c(this,"text");this.context=e,this.text=t}initialize(e,t){this.context=e,this.text=t}getID(){return this.text.getID()}edit(e,t,r,s){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");if(e>t)throw new w(v.ErrInvalidArgument,"from should be less than or equal to to");const i=this.text.indexRangeToPosRange(e,t);M.isEnabled(Ve.Debug)&&M.debug(`EDIT: f:${e}->${i[0].toTestString()}, t:${t}->${i[1].toTestString()} c:${r}`);const o=s?Cs(s):void 0,a=this.context.issueTimeTicket(),[,u,l,f]=this.text.edit(i,r,a,o);this.context.acc(l);for(const d of u)this.context.registerGCPair(d);return this.context.push(new Ti(this.text.getCreatedAt(),i[0],i[1],r,o?new Map(Object.entries(o)):new Map,a)),this.text.findIndexesFromRange(f)}delete(e,t){return this.edit(e,t,"")}empty(){return this.edit(0,this.length,"")}setStyle(e,t,r){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");if(e>t)throw new w(v.ErrInvalidArgument,"from should be less than or equal to to");const s=this.text.indexRangeToPosRange(e,t);M.isEnabled(Ve.Debug)&&M.debug(`STYL: f:${e}->${s[0].toTestString()}, t:${t}->${s[1].toTestString()} a:${JSON.stringify(r)}`);const i=Cs(r),o=this.context.issueTimeTicket(),[a,u]=this.text.setStyle(s,i,o);this.context.acc(u);for(const l of a)this.context.registerGCPair(l);return this.context.push(new Si(this.text.getCreatedAt(),s[0],s[1],new Map(Object.entries(i)),o)),!0}indexRangeToPosRange(e){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");const t=this.text.indexRangeToPosRange(e[0],e[1]);return[t[0].toStruct(),t[1].toStruct()]}posRangeToIndexRange(e){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");const t=this.text.findIndexesFromRange([xt.fromStruct(e[0]),xt.fromStruct(e[1])]);return[t[0],t[1]]}toTestString(){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");return this.text.toTestString()}values(){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");return this.text.values()}get length(){return this.text.length}getTreeByIndex(){return this.text.getTreeByIndex()}getTreeByID(){return this.text.getTreeByID()}toString(){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");return this.text.toString()}toJSON(){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");return this.text.toJSON()}toJSForTest(){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");return this.text.toJSForTest()}createRangeForTest(e,t){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");return this.text.indexRangeToPosRange(e,t)}}class Mc{constructor(e,t){c(this,"valueType");c(this,"value");c(this,"context");c(this,"counter");this.valueType=e,this.value=t}initialize(e,t){this.valueType=t.getValueType(),this.context=e,this.counter=t,this.value=t.getValue()}getID(){return this.counter.getID()}getValue(){return this.value}getValueType(){return this.valueType}increase(e){if(!this.context||!this.counter)throw new w(v.ErrNotInitialized,"Counter is not initialized yet");const t=this.context.issueTimeTicket(),r=pe.of(e,t);if(!r.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof r.getValue()}`);return this.counter.increase(r),this.context.push(Rs.create(this.counter.getCreatedAt(),r,t)),this}toJSForTest(){if(!this.context||!this.counter)throw new w(v.ErrNotInitialized,"Counter is not initialized yet");return this.counter.toJSForTest()}}function Uc(n){if(n.isText)return{type:n.type,value:n.value};const e={type:n.type,children:n.children.map(t=>Uc(t))};return n.attrs&&(e.attributes=vr(n.attrs.toObject())),e}function Hy(n,e){const t={type:n.isText?n.parent.type:n.type,children:n.isText?n.parent.getChildrenText().length===e?[]:[{type:Wt,value:n.parent.getChildrenText().slice(e)}]:n.children.slice(e).map(r=>Uc(r))};return n.attrs?t.attributes=vr(n.attrs.toObject()):n.isText&&n.parent.attrs&&(t.attributes=vr(n.parent.attrs.toObject())),t}function Wy(n,e){const{node:t}=n,r=[...e].slice(0,-1),s=t.isText?t.parent.getChildrenText().length:t.children.length,i=[...r,s],o=[...r],a=[];o[o.length-1]+=1,e.every((l,f)=>l===i[f])||a.push({fromPath:[...e],toPath:i});const u=Hy(t,e[e.length-1]);return u&&a.push({fromPath:o,toPath:o,content:u}),a}function Gy(n,e){const{node:t,offset:r}=n,s=t.children[r],i=t.children[r-1],{children:o}=s,a=[...e].slice(0,-1),u=[{fromPath:[...e],toPath:[...a,r+1]}];if(!s.children.length)return u;const l=[...a,r-1,i.hasTextChild()?i.getChildrenText().length:i.children.length],f=o.map(d=>Uc(d));return u.push({fromPath:l,toPath:l,content:f}),u}function qc(n,e,t){const{type:r}=n,s=t.issueTimeTicket();if(r===Wt){Ph(n);const{value:i}=n,o=et.create(Ne.of(s,0),r,i);e.append(o)}else{const{children:i=[]}=n,{attributes:o}=n;let a;if(typeof o=="object"&&!sh(o)){const l=Cs(o);a=new Sr;for(const[f,d]of Object.entries(l))a.set(f,d,s)}const u=et.create(Ne.of(s,0),r,void 0,a);e.append(u);for(const l of i)qc(l,u,t)}}function _y(n,e){const{type:t}=e,r=n.issueTimeTicket();let s;if(e.type===Wt){const{value:i}=e;s=et.create(Ne.of(r,0),t,i)}else if(e){const{children:i=[]}=e,{attributes:o}=e;let a;if(typeof o=="object"&&!sh(o)){const u=Cs(o);a=new Sr;for(const[l,f]of Object.entries(u))a.set(l,f,r)}s=et.create(Ne.of(n.issueTimeTicket(),0),t,void 0,a);for(const u of i)qc(u,s,n)}return s}function Ph(n){if(!n.value.length)throw new w(v.ErrInvalidArgument,"text node cannot have empty value");return!0}function dl(n){if(!n.length)return!0;if(n[0].type===Wt)for(const t of n){const{type:r}=t;if(r!==Wt)throw new w(v.ErrInvalidArgument,"element node and text node cannot be passed together");Ph(t)}else for(const t of n){const{type:r}=t;if(r===Wt)throw new w(v.ErrInvalidArgument,"element node and text node cannot be passed together")}return!0}class zc{constructor(e){c(this,"initialRoot");c(this,"context");c(this,"tree");this.initialRoot=e}initialize(e,t){this.context=e,this.tree=t}getID(){return this.tree.getID()}buildRoot(e){if(!this.initialRoot)return et.create(Ne.of(e.issueTimeTicket(),0),Jp);const t=et.create(Ne.of(e.issueTimeTicket(),0),this.initialRoot.type);for(const r of this.initialRoot.children)qc(r,t,e);return t}getSize(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getSize()}getNodeSize(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getNodeSize()}getIndexTree(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getIndexTree()}splitByPath(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(!e.length)throw new w(v.ErrInvalidArgument,"path should not be empty");const t=this.tree.pathToTreePos(e),r=Wy(t,e);for(const s of r){const{fromPath:i,toPath:o,content:a}=s,u=this.tree.pathToPos(i),l=this.tree.pathToPos(o);this.editInternal(u,l,a?[a]:[],0)}}mergeByPath(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(!e.length)throw new w(v.ErrInvalidArgument,"path should not be empty");const t=this.tree.pathToTreePos(e);if(t.node.isText)throw new w(v.ErrInvalidArgument,"text node cannot be merged");const r=Gy(t,e);for(const s of r){const{fromPath:i,toPath:o,content:a}=s,u=this.tree.pathToPos(i),l=this.tree.pathToPos(o);this.editInternal(u,l,a??[],0)}}styleByPath(e,t){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(!e.length)throw new w(v.ErrInvalidArgument,"path should not be empty");const[r,s]=this.tree.pathToPosRange(e),i=this.context.issueTimeTicket(),o=t?Cs(t):void 0,[a,,u]=this.tree.style([r,s],o,i);this.context.acc(u);for(const l of a)this.context.registerGCPair(l);this.context.push(wr.create(this.tree.getCreatedAt(),r,s,o?new Map(Object.entries(o)):new Map,i))}style(e,t,r){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new w(v.ErrInvalidArgument,"from should be less than or equal to to");const s=this.tree.findPos(e),i=this.tree.findPos(t),o=this.context.issueTimeTicket(),a=r?Cs(r):void 0,[u,,l]=this.tree.style([s,i],a,o);this.context.acc(l);for(const f of u)this.context.registerGCPair(f);this.context.push(wr.create(this.tree.getCreatedAt(),s,i,a?new Map(Object.entries(a)):new Map,o))}removeStyle(e,t,r){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new w(v.ErrInvalidArgument,"from should be less than or equal to to");const s=this.tree.findPos(e),i=this.tree.findPos(t),o=this.context.issueTimeTicket(),[a,,u]=this.tree.removeStyle([s,i],r,o);this.context.acc(u);for(const l of a)this.context.registerGCPair(l);this.context.push(wr.createTreeRemoveStyleOperation(this.tree.getCreatedAt(),s,i,r,o))}editInternal(e,t,r,s=0){var l;if(r.length!==0&&r[0]&&(dl(r),r[0].type!==Wt))for(const f of r){const{children:d=[]}=f;dl(d)}const i=this.context.getLastTimeTicket();let o=new Array;if(((l=r[0])==null?void 0:l.type)===Wt){let f="";for(const d of r){const{value:y}=d;f+=y}o.push(et.create(Ne.of(this.context.issueTimeTicket(),0),Wt,f))}else o=r.map(f=>f&&_y(this.context,f)).filter(f=>f);const[,a,u]=this.tree.edit([e,t],o.length?o.map(f=>f==null?void 0:f.deepcopy()):void 0,s,i,()=>this.context.issueTimeTicket());this.context.acc(u);for(const f of a)this.context.registerGCPair(f);return this.context.push(Ii.create(this.tree.getCreatedAt(),e,t,o.length?o:void 0,s,i)),!0}editByPath(e,t,r,s=0){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(e.length!==t.length)throw new w(v.ErrInvalidArgument,"path length should be equal");if(!e.length||!t.length)throw new w(v.ErrInvalidArgument,"path should not be empty");const i=this.tree.pathToPos(e),o=this.tree.pathToPos(t);return this.editInternal(i,o,r?[r]:[],s)}editBulkByPath(e,t,r,s=0){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(e.length!==t.length)throw new w(v.ErrInvalidArgument,"path length should be equal");if(!e.length||!t.length)throw new w(v.ErrInvalidArgument,"path should not be empty");const i=this.tree.pathToPos(e),o=this.tree.pathToPos(t);return this.editInternal(i,o,r,s)}edit(e,t,r,s=0){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new w(v.ErrInvalidArgument,"from should be less than or equal to to");const i=this.tree.findPos(e),o=this.tree.findPos(t);return this.editInternal(i,o,r?[r]:[],s)}editBulk(e,t,r,s=0){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new w(v.ErrInvalidArgument,"from should be less than or equal to to");const i=this.tree.findPos(e),o=this.tree.findPos(t);return this.editInternal(i,o,r,s)}toXML(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toXML()}toJSON(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSON()}toJSForTest(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSForTest()}toJSInfoForTest(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSInfoForTest()}getRootTreeNode(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getRootTreeNode()}indexToPath(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.indexToPath(e)}pathToIndex(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.pathToIndex(e)}pathRangeToPosRange(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");const t=[this.tree.pathToIndex(e[0]),this.tree.pathToIndex(e[1])],r=this.tree.indexRangeToPosRange(t);return[r[0].toStruct(),r[1].toStruct()]}indexRangeToPosRange(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.indexRangeToPosStructRange(e)}posRangeToIndexRange(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");const t=[St.fromStruct(e[0]),St.fromStruct(e[1])];return this.tree.posRangeToIndexRange(t)}posRangeToPathRange(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");const t=[St.fromStruct(e[0]),St.fromStruct(e[1])];return this.tree.posRangeToPathRange(t)}}function gl(n,e){return Nh(n,e)}function Nr(n,e){if(e){if(e instanceof pe)return e;if(e instanceof Ce)return Nh(n,e);if(e instanceof Me)return Vy(n,e);if(e instanceof tt)return new $c(n,e);if(e instanceof He){const t=new Mc(Xt.Int,0);return t.initialize(n,e),t}else if(e instanceof nt){const t=new zc;return t.initialize(n,e),t}}else return;throw new TypeError(`Unsupported type of element: ${typeof e}`)}function Gr(n,e){const t=Nr(n,e);return t instanceof pe?t.getValue():t}function xo(n,e,t){let r;if(pe.isSupport(e))r=pe.of(e,t);else if(Array.isArray(e))r=Me.create(t,ve.buildArrayElements(n,e));else if(typeof e=="object")e instanceof $c?(r=tt.create(Os.create(),t),e.initialize(n,r)):e instanceof Mc?(r=He.create(e.getValueType(),e.getValue(),t),e.initialize(n,r)):e instanceof zc?(r=nt.create(e.buildRoot(n),t),e.initialize(n,r)):r=Ce.create(t,yi.buildObjectMembers(n,e));else throw new TypeError(`Unsupported type of value: ${typeof e}`);return r}class fa{constructor(e,t){c(this,"context");c(this,"presence");this.context=e,this.presence=t}set(e,t){for(const r of Object.keys(e))this.presence[r]=e[r];this.context.setPresenceChange({type:Yt.Put,presence:wt(this.presence)}),this.context.setReversePresence(e,t)}get(e){return this.presence[e]}clear(){this.presence={},this.context.setPresenceChange({type:Yt.Clear})}}const ml=50;class Yy{constructor(){c(this,"undoStack",[]);c(this,"redoStack",[])}hasUndo(){return this.undoStack.length>0}hasRedo(){return this.redoStack.length>0}pushUndo(e){this.undoStack.length>=ml&&this.undoStack.shift(),this.undoStack.push(e)}popUndo(){return this.undoStack.pop()}pushRedo(e){this.redoStack.length>=ml&&this.redoStack.shift(),this.redoStack.push(e)}popRedo(){return this.redoStack.pop()}clearRedo(){this.redoStack=[]}getUndoStackForTest(){return this.undoStack}getRedoStackForTest(){return this.redoStack}}const Xy="yorkie-devtools-panel",Zy="yorkie-devtools-sdk";function Qy(n){return[xe.StatusChanged,xe.Snapshot,xe.LocalChange,xe.RemoteChange,xe.Initialized,xe.Watched,xe.Unwatched,xe.PresenceChanged].includes(n.type)}function ev(n){return n.every(Qy)}let fs="disconnected";const pl=new Map,ji=new Map;typeof window<"u"&&(window.docEventsForReplayByDocKey=ji);function Li(n,e){(e!=null&&e.force||fs!=="disconnected")&&window.postMessage({source:Zy,...n},"*")}function tv(n){if(!n.isEnableDevtools()||typeof window>"u"||pl.has(n.getKey()))return;ji.set(n.getKey(),[]);const e=n.subscribe("all",t=>{ev(t)&&(ji.get(n.getKey()).push(t),fs==="synced"&&Li({msg:"doc::sync::partial",docKey:n.getKey(),event:t}))});pl.set(n.getKey(),[e]),Li({msg:"refresh-devtools"},{force:!0}),window.addEventListener("message",t=>{var s;if(((s=t.data)==null?void 0:s.source)!==Xy)return;switch(t.data.msg){case"devtools::connect":if(fs!=="disconnected")break;fs="connected",Li({msg:"doc::available",docKey:n.getKey()}),M.info(`[YD] Devtools connected. Doc: ${n.getKey()}`);break;case"devtools::disconnect":fs="disconnected",M.info(`[YD] Devtools disconnected. Doc: ${n.getKey()}`);break;case"devtools::subscribe":fs="synced",Li({msg:"doc::sync::full",docKey:n.getKey(),events:ji.get(n.getKey())}),M.info(`[YD] Devtools subscribed. Doc: ${n.getKey()}`);break}})}var Pr=(n=>(n.Detached="detached",n.Attached="attached",n.Removed="removed",n))(Pr||{}),xe=(n=>(n.StatusChanged="status-changed",n.ConnectionChanged="connection-changed",n.SyncStatusChanged="sync-status-changed",n.Snapshot="snapshot",n.LocalChange="local-change",n.RemoteChange="remote-change",n.Initialized="initialized",n.Watched="watched",n.Unwatched="unwatched",n.PresenceChanged="presence-changed",n.Broadcast="broadcast",n.LocalBroadcast="local-broadcast",n.AuthError="auth-error",n))(xe||{}),rc=(n=>(n.Connected="connected",n.Disconnected="disconnected",n))(rc||{}),sc=(n=>(n.Synced="synced",n.SyncFailed="sync-failed",n))(sc||{});class Ch{constructor(e,t){c(this,"key");c(this,"status");c(this,"opts");c(this,"changeID");c(this,"checkpoint");c(this,"localChanges");c(this,"maxSizeLimit");c(this,"schemaRules");c(this,"root");c(this,"clone");c(this,"eventStream");c(this,"eventStreamObserver");c(this,"onlineClients");c(this,"presences");c(this,"history");c(this,"internalHistory");c(this,"isUpdating");this.opts=t||{},this.key=e,this.status="detached",this.root=pi.create(),this.changeID=Kp,this.checkpoint=jp,this.localChanges=[],this.maxSizeLimit=0,this.schemaRules=[],this.eventStream=zy(r=>{this.eventStreamObserver=r}),this.onlineClients=new Set,this.presences=new Map,this.isUpdating=!1,this.internalHistory=new Yy,this.history={canUndo:this.canUndo.bind(this),canRedo:this.canRedo.bind(this),undo:this.undo.bind(this),redo:this.redo.bind(this)},tv(this)}update(e,t){var a,u,l;if(this.getStatus()==="removed")throw new w(v.ErrDocumentRemoved,`${this.key} is removed`);this.ensureClone();const r=this.changeID.getActorID(),s=ds.create(this.changeID,this.clone.root,this.clone.presences.get(r)||{},t);try{const f=gl(s,this.clone.root.getObject());this.presences.has(r)||this.clone.presences.set(r,{}),this.isUpdating=!0,e(f,new fa(s,this.clone.presences.get(r)))}catch(f){throw this.clone=void 0,f}finally{this.isUpdating=!1}const i=this.getSchemaRules();if(!s.isPresenceOnlyChange()&&i.length>0){const f=Jy((a=this.clone)==null?void 0:a.root.getObject(),i);if(!f.valid)throw this.clone=void 0,new w(v.ErrDocumentSchemaValidationFailed,`schema validation failed: ${(u=f.errors)==null?void 0:u.map(d=>d.message).join(", ")}`)}const o=Bp((l=this.clone)==null?void 0:l.root.getDocSize());if(!s.isPresenceOnlyChange()&&this.maxSizeLimit>0&&this.maxSizeLimit<o)throw this.clone=void 0,new w(v.ErrDocumentSizeExceedsLimit,`document size exceeded: ${o} > ${this.maxSizeLimit}`);if(s.hasChange()){M.isEnabled(Ve.Trivial)&&M.trivial(`trying to update a local change: ${this.toJSON()}`);const f=s.toChange(),{opInfos:d,reverseOps:y}=f.execute(this.root,this.presences,ce.Local),m=s.getReversePresence();m&&y.push({type:"presence",value:m}),this.localChanges.push(f),y.length>0&&this.internalHistory.pushUndo(y),d.length>0&&this.internalHistory.clearRedo(),this.changeID=s.getNextID();const S=[];d.length>0&&S.push({type:"local-change",source:ce.Local,value:{message:f.getMessage()||"",operations:d,actor:r,clientSeq:f.getID().getClientSeq(),serverSeq:f.getID().getServerSeq()},rawChange:this.isEnableDevtools()?f.toStruct():void 0}),f.hasPresenceChange()&&S.push({type:"presence-changed",source:ce.Local,value:{clientID:r,presence:this.getPresence(r)}}),this.publish(S),M.isEnabled(Ve.Trivial)&&M.trivial(`after update a local change: ${this.toJSON()}`)}}subscribe(e,t,r,s){if(typeof e=="string"){if(typeof t!="function")throw new w(v.ErrInvalidArgument,"Second argument must be a callback function");if(e==="presence"){const a=t;return this.eventStream.subscribe(u=>{for(const l of u)l.type!=="initialized"&&l.type!=="watched"&&l.type!=="unwatched"&&l.type!=="presence-changed"||a(l)},r,s)}if(e==="my-presence"){const a=t;return this.eventStream.subscribe(u=>{for(const l of u)l.type!=="initialized"&&l.type!=="presence-changed"||l.type==="presence-changed"&&l.value.clientID!==this.changeID.getActorID()||a(l)},r,s)}if(e==="others"){const a=t;return this.eventStream.subscribe(u=>{for(const l of u)l.type!=="watched"&&l.type!=="unwatched"&&l.type!=="presence-changed"||l.value.clientID!==this.changeID.getActorID()&&a(l)},r,s)}if(e==="connection"){const a=t;return this.eventStream.subscribe(u=>{for(const l of u)l.type==="connection-changed"&&a(l)},r,s)}if(e==="status"){const a=t;return this.eventStream.subscribe(u=>{for(const l of u)l.type==="status-changed"&&a(l)},r,s)}if(e==="sync"){const a=t;return this.eventStream.subscribe(u=>{for(const l of u)l.type==="sync-status-changed"&&a(l)},r,s)}if(e==="local-broadcast"){const a=t;return this.eventStream.subscribe(u=>{for(const l of u)l.type==="local-broadcast"&&a(l)},r)}if(e==="broadcast"){const a=t;return this.eventStream.subscribe(u=>{for(const l of u)l.type==="broadcast"&&a(l)},r)}if(e==="auth-error"){const a=t;return this.eventStream.subscribe(u=>{for(const l of u)l.type==="auth-error"&&a(l)},r)}if(e==="all"){const a=t;return this.eventStream.subscribe(a,r,s)}const i=e,o=t;return this.eventStream.subscribe(a=>{for(const u of a){if(u.type!=="local-change"&&u.type!=="remote-change")continue;const l=[];for(const f of u.value.operations)this.isSameElementOrChildOf(f.path,i)&&l.push(f);l.length&&o({...u,value:{...u.value,operations:l}})}},r,s)}if(typeof e=="function"){const i=e,o=t,a=r;return this.eventStream.subscribe(u=>{for(const l of u)l.type!=="snapshot"&&l.type!=="local-change"&&l.type!=="remote-change"||i(l)},o,a)}throw new w(v.ErrInvalidArgument,`"${e}" is not a valid`)}publish(e){this.eventStreamObserver&&this.eventStreamObserver.next(e)}isSameElementOrChildOf(e,t){if(t===e)return!0;const r=e.split(".");return t.split(".").every((i,o)=>i===r[o])}removePushedLocalChanges(e){for(;this.localChanges.length&&!(this.localChanges[0].getID().getClientSeq()>e);)this.localChanges.shift()}applyChangePack(e){const t=e.hasSnapshot();t?this.applySnapshot(e.getCheckpoint().getServerSeq(),e.getVersionVector(),e.getSnapshot(),e.getCheckpoint().getClientSeq()):(this.applyChanges(e.getChanges(),ce.Remote),this.removePushedLocalChanges(e.getCheckpoint().getClientSeq())),this.checkpoint=this.checkpoint.forward(e.getCheckpoint()),t||this.garbageCollect(e.getVersionVector()),e.getIsRemoved()&&this.applyStatus("removed"),M.isEnabled(Ve.Trivial)&&M.trivial(`${this.root.toJSON()}`)}getCheckpoint(){return this.checkpoint}getChangeID(){return this.changeID}hasLocalChanges(){return this.localChanges.length>0}ensureClone(){this.clone||(this.clone={root:this.root.deepcopy(),presences:wt(this.presences)})}createChangePack(){const e=Array.from(this.localChanges),t=this.checkpoint.increaseClientSeq(e.length);return qo.create(this.key,t,!1,e,this.getVersionVector())}setActor(e){for(const t of this.localChanges)t.setActor(e);this.changeID=this.changeID.setActor(e)}isEnableDevtools(){return!!this.opts.enableDevtools}getKey(){return this.key}getStatus(){return this.status}getClone(){return this.clone}getCloneRoot(){if(this.clone)return this.clone.root.getObject()}getRoot(){this.ensureClone();const e=ds.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});return gl(e,this.clone.root.getObject())}getDocSize(){return this.root.getDocSize()}getMaxSizePerDocument(){return this.maxSizeLimit}setMaxSizePerDocument(e){this.maxSizeLimit=e}getSchemaRules(){return this.schemaRules}setSchemaRules(e){this.schemaRules=e}garbageCollect(e){return this.opts.disableGC?0:(this.clone&&this.clone.root.garbageCollect(e),this.root.garbageCollect(e))}getRootObject(){return this.root.getObject()}getGarbageLen(){return this.root.getGarbageLen()}getGarbageLenFromClone(){return this.clone.root.getGarbageLen()}toJSON(){return this.root.toJSON()}toSortedJSON(){return this.root.toSortedJSON()}getStats(){return this.root.getStats()}toJSForTest(){return{...this.getRoot().toJSForTest(),key:"root"}}applySnapshot(e,t,r,s=-1){const{root:i,presences:o}=we.bytesToSnapshot(r);this.root=new pi(i),this.presences=o,this.changeID=this.changeID.setClocks(t.maxLamport(),t),this.clone=void 0,this.removePushedLocalChanges(s),this.applyChanges(this.localChanges,ce.Local),this.publish([{type:"snapshot",source:ce.Remote,value:{serverSeq:e.toString(),snapshot:this.isEnableDevtools()?we.bytesToHex(r):void 0,snapshotVector:we.versionVectorToHex(t)}}])}applyChanges(e,t){M.isEnabled(Ve.Debug)&&M.debug(`trying to apply ${e.length} remote changes.elements:${this.root.getElementMapSize()}, removeds:${this.root.getGarbageElementSetSize()}`),M.isEnabled(Ve.Trivial)&&M.trivial(e.map(r=>`${r.getID().toTestString()}	${r.toTestString()}`).join(`
`));for(const r of e)this.applyChange(r,t);M.isEnabled(Ve.Debug)&&M.debug(`after appling ${e.length} remote changes.elements:${this.root.getElementMapSize()},  removeds:${this.root.getGarbageElementSetSize()}`)}applyChange(e,t){this.ensureClone(),e.execute(this.clone.root,this.clone.presences,t);const r=[],s=e.getID().getActorID();if(e.hasPresenceChange()&&this.onlineClients.has(s)){const o=e.getPresenceChange();switch(o.type){case Yt.Put:r.push(this.presences.has(s)?{type:"presence-changed",source:t,value:{clientID:s,presence:o.presence}}:{type:"watched",source:ce.Remote,value:{clientID:s,presence:o.presence}});break;case Yt.Clear:r.push({type:"unwatched",source:ce.Remote,value:{clientID:s,presence:this.getPresence(s)}}),this.removeOnlineClient(s);break}}const{opInfos:i}=e.execute(this.root,this.presences,t);if(this.changeID=this.changeID.syncClocks(e.getID()),i.length>0){const o=this.isEnableDevtools()?e.toStruct():void 0;r.push(t===ce.Remote?{type:"remote-change",source:t,value:{actor:s,clientSeq:e.getID().getClientSeq(),serverSeq:e.getID().getServerSeq(),message:e.getMessage()||"",operations:i},rawChange:o}:{type:"local-change",source:t,value:{actor:s,clientSeq:e.getID().getClientSeq(),serverSeq:e.getID().getServerSeq(),message:e.getMessage()||"",operations:i},rawChange:o})}r.length>0&&this.publish(r)}applyWatchStream(e){if(e.body.case==="initialization"){const t=e.body.value.clientIds,r=new Set;for(const s of t)s!==this.changeID.getActorID()&&r.add(s);this.setOnlineClients(r),this.publish([{type:"initialized",source:ce.Local,value:this.getPresences()}]);return}if(e.body.case==="event"){const{type:t,publisher:r}=e.body.value,s=[];if(t===es.DOCUMENT_WATCHED){if(this.onlineClients.has(r)&&this.hasPresence(r))return;this.addOnlineClient(r),this.hasPresence(r)&&s.push({type:"watched",source:ce.Remote,value:{clientID:r,presence:this.getPresence(r)}})}else if(t===es.DOCUMENT_UNWATCHED){const i=this.getPresence(r);this.removeOnlineClient(r),i&&s.push({type:"unwatched",source:ce.Remote,value:{clientID:r,presence:i}})}else if(t===es.DOCUMENT_BROADCAST&&e.body.value.body){const{topic:i,payload:o}=e.body.value.body,a=new TextDecoder;s.push({type:"broadcast",value:{clientID:r,topic:i,payload:JSON.parse(a.decode(o))}})}s.length>0&&this.publish(s)}}applyStatus(e){this.status=e,e==="detached"&&this.setActor(Mo),this.publish([{source:e==="removed"?ce.Remote:ce.Local,type:"status-changed",value:e==="attached"?{status:e,actorID:this.changeID.getActorID()}:{status:e}}])}applyDocEventForReplay(e){if(e.type==="status-changed"){this.applyStatus(e.value.status),e.value.status==="attached"&&this.setActor(e.value.actorID);return}if(e.type==="snapshot"){const{snapshot:t,serverSeq:r,snapshotVector:s}=e.value;if(!t)return;this.applySnapshot(BigInt(r),we.hexToVersionVector(s),we.hexToBytes(t));return}if(e.type==="local-change"||e.type==="remote-change"){if(!e.rawChange)return;const t=Ds.fromStruct(e.rawChange);this.applyChange(t,e.source)}if(e.type==="initialized"){const t=new Set;for(const{clientID:r,presence:s}of e.value)t.add(r),this.presences.set(r,s);this.setOnlineClients(t);return}if(e.type==="watched"){const{clientID:t,presence:r}=e.value;this.addOnlineClient(t),this.presences.set(t,r);return}if(e.type==="unwatched"){const{clientID:t}=e.value;this.removeOnlineClient(t),this.presences.delete(t)}if(e.type==="presence-changed"){const{clientID:t,presence:r}=e.value;this.presences.set(t,r)}}applyDocEventsForReplay(e){for(const t of e)this.applyDocEventForReplay(t)}getValueByPath(e){if(!e.startsWith("$"))throw new w(v.ErrInvalidArgument,'path must start with "$"');const t=e.split(".");t.shift();let r=this.getRoot();for(const s of t)if(r=r[s],r===void 0)return;return r}setOnlineClients(e){this.onlineClients=e}resetOnlineClients(){this.onlineClients=new Set}addOnlineClient(e){this.onlineClients.add(e)}removeOnlineClient(e){this.onlineClients.delete(e)}hasPresence(e){return this.presences.has(e)}getMyPresence(){if(this.status!=="attached")return{};const e=this.presences.get(this.changeID.getActorID());return e?wt(e):{}}getPresence(e){if(e===this.changeID.getActorID())return this.getMyPresence();if(!this.onlineClients.has(e))return;const t=this.presences.get(e);return t?wt(t):void 0}getPresenceForTest(e){const t=this.presences.get(e);return t?wt(t):void 0}getPresences(){const e=[];e.push({clientID:this.changeID.getActorID(),presence:wt(this.getMyPresence())});for(const t of this.onlineClients)this.presences.has(t)&&e.push({clientID:t,presence:wt(this.presences.get(t))});return e}getSelfForTest(){return{clientID:this.getChangeID().getActorID(),presence:this.getMyPresence()}}getOthersForTest(){const e=this.getChangeID().getActorID();return this.getPresences().filter(t=>t.clientID!==e).sort((t,r)=>t.clientID>r.clientID?1:-1)}canUndo(){return this.internalHistory.hasUndo()&&!this.isUpdating}canRedo(){return this.internalHistory.hasRedo()&&!this.isUpdating}undo(){if(this.isUpdating)throw new w(v.ErrRefused,"Undo is not allowed during an update");const e=this.internalHistory.popUndo();if(e===void 0)throw new w(v.ErrRefused,"There is no operation to be undone");this.ensureClone();const t=ds.create(this.changeID,this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(const l of e){if(!(l instanceof kt)){new fa(t,wt(this.clone.presences.get(this.changeID.getActorID()))).set(l.value,{addToHistory:!0});continue}const f=t.issueTimeTicket();l.setExecutedAt(f),t.push(l)}const r=t.toChange();r.execute(this.clone.root,this.clone.presences,ce.UndoRedo);const{opInfos:s,reverseOps:i}=r.execute(this.root,this.presences,ce.UndoRedo),o=t.getReversePresence();if(o&&i.push({type:"presence",value:o}),i.length>0&&this.internalHistory.pushRedo(i),!r.hasPresenceChange()&&s.length===0)return;this.localChanges.push(r),this.changeID=t.getNextID();const a=this.changeID.getActorID(),u=[];s.length>0&&u.push({type:"local-change",source:ce.UndoRedo,value:{message:r.getMessage()||"",operations:s,actor:a,clientSeq:r.getID().getClientSeq(),serverSeq:r.getID().getServerSeq()},rawChange:this.isEnableDevtools()?r.toStruct():void 0}),r.hasPresenceChange()&&u.push({type:"presence-changed",source:ce.UndoRedo,value:{clientID:a,presence:this.getPresence(a)}}),this.publish(u)}redo(){if(this.isUpdating)throw new w(v.ErrRefused,"Redo is not allowed during an update");const e=this.internalHistory.popRedo();if(e===void 0)throw new w(v.ErrRefused,"There is no operation to be redone");this.ensureClone();const t=ds.create(this.changeID,this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(const l of e){if(!(l instanceof kt)){new fa(t,wt(this.clone.presences.get(this.changeID.getActorID()))).set(l.value,{addToHistory:!0});continue}const f=t.issueTimeTicket();l.setExecutedAt(f),t.push(l)}const r=t.toChange();r.execute(this.clone.root,this.clone.presences,ce.UndoRedo);const{opInfos:s,reverseOps:i}=r.execute(this.root,this.presences,ce.UndoRedo),o=t.getReversePresence();if(o&&i.push({type:"presence",value:o}),i.length>0&&this.internalHistory.pushUndo(i),!r.hasPresenceChange()&&s.length===0)return;this.localChanges.push(r),this.changeID=t.getNextID();const a=this.changeID.getActorID(),u=[];s.length>0&&u.push({type:"local-change",source:ce.UndoRedo,value:{message:r.getMessage()||"",operations:s,actor:a,clientSeq:r.getID().getClientSeq(),serverSeq:r.getID().getServerSeq()},rawChange:this.isEnableDevtools()?r.toStruct():void 0}),r.hasPresenceChange()&&u.push({type:"presence-changed",source:ce.UndoRedo,value:{clientID:a,presence:this.getPresence(a)}}),this.publish(u)}getUndoStackForTest(){return this.internalHistory.getUndoStackForTest()}getRedoStackForTest(){return this.internalHistory.getRedoStackForTest()}broadcast(e,t,r){const s={type:"local-broadcast",value:{topic:e,payload:t},options:r};this.publish([s])}getVersionVector(){return this.changeID.getVersionVector()}}function nv(n,e){let t=e;return{authInterceptor:i=>async o=>(n&&o.header.set("x-api-key",n),t&&o.header.set("authorization",t),await i(o)),setToken:i=>{t=i}}}const rv="@yorkie-js/sdk",sv="0.6.22",yl={name:rv,version:sv};function iv(n){return e=>async t=>(n?t.header.set("x-yorkie-user-agent",n):t.header.set("x-yorkie-user-agent",yl.name+"/"+yl.version),await e(t))}const ov=n=>{try{if(JSON.stringify(n)===void 0)return!1}catch{return!1}return!0};var Hi=(n=>(n.Manual="manual",n.Realtime="realtime",n.RealtimePushOnly="realtime-pushonly",n.RealtimeSyncOff="realtime-syncoff",n))(Hi||{});const zs={rpcAddr:"https://api.yorkie.dev",syncLoopDuration:50,retrySyncLoopDelay:1e3,reconnectStreamDelay:1e3},ha={maxRetries:1/0,initialRetryInterval:1e3,maxBackoff:2e4};class Dh{constructor(e){c(this,"id");c(this,"key");c(this,"metadata");c(this,"status");c(this,"attachmentMap");c(this,"apiKey");c(this,"authTokenInjector");c(this,"conditions");c(this,"syncLoopDuration");c(this,"reconnectStreamDelay");c(this,"retrySyncLoopDelay");c(this,"rpcClient");c(this,"setAuthToken");c(this,"taskQueue");c(this,"processing",!1);c(this,"keepalive",!1);e=e||zs;const t=e.rpcAddr||zs.rpcAddr;this.key=e.key||Eh(),this.metadata=e.metadata||{},this.status="deactivated",this.attachmentMap=new Map,this.apiKey=e.apiKey||"",this.authTokenInjector=e.authTokenInjector,this.conditions={SyncLoop:!1,WatchLoop:!1},this.syncLoopDuration=e.syncLoopDuration??zs.syncLoopDuration,this.reconnectStreamDelay=e.reconnectStreamDelay??zs.reconnectStreamDelay,this.retrySyncLoopDelay=e.retrySyncLoopDelay??zs.retrySyncLoopDelay;const{authInterceptor:r,setToken:s}=nv(this.apiKey);this.setAuthToken=s,this.rpcClient=np(xp,Ap({baseUrl:t,interceptors:[r,iv(e==null?void 0:e.userAgent)],fetch:(i,o)=>{const a={...o,keepalive:this.keepalive};return fetch(i,a)}})),this.taskQueue=[]}async activate(){if(this.isActive())return Promise.resolve();if(this.authTokenInjector){const e=await this.authTokenInjector();this.setAuthToken(e)}return this.enqueueTask(async()=>{try{const e=await this.rpcClient.activateClient({clientKey:this.key,metadata:this.metadata},{headers:{"x-shard-key":`${this.apiKey}/${this.key}`}});this.id=e.clientId,this.status="activated",this.runSyncLoop(),M.info(`[AC] c:"${this.getKey()}" activated, id:"${this.id}"`),typeof window<"u"&&window.addEventListener("beforeunload",async()=>{await this.deactivate({keepalive:!0})})}catch(e){throw M.error(`[AC] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}})}deactivate(e={keepalive:!1}){if(this.status==="deactivated")return Promise.resolve();const t=async()=>{try{await this.rpcClient.deactivateClient({clientId:this.id},{headers:{"x-shard-key":`${this.apiKey}/${this.key}`}}),this.deactivateInternal(),M.info(`[DC] c"${this.getKey()}" deactivated`)}catch(r){throw M.error(`[DC] c:"${this.getKey()}" err :`,r),await this.handleConnectError(r),r}};if(e.keepalive){this.keepalive=!0;const r=t();return this.keepalive=!1,r}return this.enqueueTask(t)}hasDocument(e){return this.attachmentMap.has(e)}attach(e,t={}){if(!this.isActive())throw new w(v.ErrClientNotActivated,`${this.key} is not active`);if(e.getStatus()!==Pr.Detached)throw new w(v.ErrDocumentNotDetached,`${e.getKey()} is not detached`);e.setActor(this.id),e.update((i,o)=>o.set(t.initialPresence||{}));const r=e.subscribe("local-broadcast",async i=>{var f;const{topic:o,payload:a}=i.value,u=(f=i.options)==null?void 0:f.error,l=i.options;try{await this.broadcast(e.getKey(),o,a,l)}catch(d){d instanceof Error&&(u==null||u(d))}}),s=t.syncMode??"realtime";return this.enqueueTask(async()=>{try{const i=await this.rpcClient.attachDocument({clientId:this.id,changePack:we.toChangePack(e.createChangePack()),schemaKey:t.schema},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}});(i.maxSizePerDocument??0)>0&&e.setMaxSizePerDocument(i.maxSizePerDocument),i.schemaRules.length>0&&e.setSchemaRules(we.fromSchemaRules(i.schemaRules));const a=we.fromChangePack(i.changePack);if(e.applyChangePack(a),e.getStatus()===Pr.Removed)return e;e.applyStatus(Pr.Attached),this.attachmentMap.set(e.getKey(),new Ly(this.reconnectStreamDelay,e,i.documentId,s,r)),s!=="manual"&&await this.runWatchLoop(e.getKey()),M.info(`[AD] c:"${this.getKey()}" attaches d:"${e.getKey()}"`);const u=e.getRootObject();if(t.initialRoot){const l=t.initialRoot;e.update(f=>{for(const[d,y]of Object.entries(l))if(!u.has(d)){const m=d;f[m]=y}})}return e}catch(i){throw M.error(`[AD] c:"${this.getKey()}" err :`,i),await this.handleConnectError(i),i}})}detach(e,t={keepalive:!1}){if(!this.isActive())throw new w(v.ErrClientNotActivated,`${this.key} is not active`);const r=this.attachmentMap.get(e.getKey());if(!r)throw new w(v.ErrDocumentNotAttached,`${e.getKey()} is not attached`);e.update((i,o)=>o.clear());const s=async()=>{try{const i=await this.rpcClient.detachDocument({clientId:this.id,documentId:r.docID,changePack:we.toChangePack(e.createChangePack()),removeIfNotAttached:t.removeIfNotAttached??!1},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),o=we.fromChangePack(i.changePack);return e.applyChangePack(o),e.getStatus()!==Pr.Removed&&e.applyStatus(Pr.Detached),this.detachInternal(e.getKey()),M.info(`[DD] c:"${this.getKey()}" detaches d:"${e.getKey()}"`),e}catch(i){throw M.error(`[DD] c:"${this.getKey()}" err :`,i),await this.handleConnectError(i),i}};if(t.keepalive){this.keepalive=!0;const i=s();return this.keepalive=!1,i}return this.enqueueTask(s)}async changeSyncMode(e,t){if(!this.isActive())throw new w(v.ErrClientNotActivated,`${this.key} is not active`);const r=this.attachmentMap.get(e.getKey());if(!r)throw new w(v.ErrDocumentNotAttached,`${e.getKey()} is not attached`);const s=r.syncMode;return s===t?e:(r.changeSyncMode(t),t==="manual"?(r.cancelWatchStream(),e):(t==="realtime"&&(r.remoteChangeEventReceived=!0),s==="manual"&&await this.runWatchLoop(e.getKey()),e))}sync(e){if(!this.isActive())throw new w(v.ErrClientNotActivated,`${this.key} is not active`);if(e){const t=this.attachmentMap.get(e.getKey());if(!t)throw new w(v.ErrDocumentNotAttached,`${e.getKey()} is not attached`);return this.enqueueTask(async()=>this.syncInternal(t,"realtime").catch(async r=>{throw M.error(`[SY] c:"${this.getKey()}" err :`,r),await this.handleConnectError(r),r}))}return this.enqueueTask(async()=>{const t=[];for(const[,r]of this.attachmentMap)t.push(this.syncInternal(r,r.syncMode));return Promise.all(t).catch(async r=>{throw M.error(`[SY] c:"${this.getKey()}" err :`,r),await this.handleConnectError(r),r})})}remove(e){if(!this.isActive())throw new w(v.ErrClientNotActivated,`${this.key} is not active`);const t=this.attachmentMap.get(e.getKey());if(!t)throw new w(v.ErrDocumentNotAttached,`${e.getKey()} is not attached`);e.setActor(this.id);const r=we.toChangePack(e.createChangePack());return r.isRemoved=!0,this.enqueueTask(async()=>{try{const s=await this.rpcClient.removeDocument({clientId:this.id,documentId:t.docID,changePack:r},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),i=we.fromChangePack(s.changePack);e.applyChangePack(i),this.detachInternal(e.getKey()),M.info(`[RD] c:"${this.getKey()}" removes d:"${e.getKey()}"`)}catch(s){throw M.error(`[RD] c:"${this.getKey()}" err :`,s),await this.handleConnectError(s),s}})}getID(){return this.id}getKey(){return this.key}isActive(){return this.status==="activated"}getStatus(){return this.status}getCondition(e){return this.conditions[e]}broadcast(e,t,r,s){if(!this.isActive())throw new w(v.ErrClientNotActivated,`${this.key} is not active`);const i=this.attachmentMap.get(e);if(!i)throw new w(v.ErrDocumentNotAttached,`${e} is not attached`);if(!ov(r))throw new w(v.ErrInvalidArgument,"payload is not serializable");const o=(s==null?void 0:s.maxRetries)??ha.maxRetries,a=ha.maxBackoff;let u=0;const l=d=>Math.min(ha.initialRetryInterval*2**d,a),f=async()=>this.enqueueTask(async()=>{try{await this.rpcClient.broadcast({clientId:this.id,documentId:i.docID,topic:t,payload:new TextEncoder().encode(JSON.stringify(r))},{headers:{"x-shard-key":`${this.apiKey}/${e}`}}),M.info(`[BC] c:"${this.getKey()}" broadcasts d:"${e}" t:"${t}"`)}catch(d){if(M.error(`[BC] c:"${this.getKey()}" err:`,d),await this.handleConnectError(d))if(d instanceof re&&kr(d)===v.ErrUnauthenticated&&i.doc.publish([{type:xe.AuthError,value:{reason:Ks(d).reason,method:"Broadcast"}}]),u<o)u++,setTimeout(()=>f(),l(u-1)),M.info(`[BC] c:"${this.getKey()}" retry attempt ${u}/${o}`);else throw M.error(`[BC] c:"${this.getKey()}" exceeded maximum retry attempts`),d;else throw d}});return f()}runSyncLoop(){const e=()=>{if(!this.isActive()){M.debug(`[SL] c:"${this.getKey()}" exit sync loop`),this.conditions.SyncLoop=!1;return}const t=[];for(const[,r]of this.attachmentMap)r.needRealtimeSync()&&(r.remoteChangeEventReceived=!1,t.push(this.syncInternal(r,r.syncMode).catch(async s=>{throw s instanceof re&&kr(s)===v.ErrUnauthenticated&&r.doc.publish([{type:xe.AuthError,value:{reason:Ks(s).reason,method:"PushPull"}}]),s})));Promise.all(t).then(()=>setTimeout(e,this.syncLoopDuration)).catch(async r=>{M.error(`[SL] c:"${this.getKey()}" sync failed:`,r),await this.handleConnectError(r)?setTimeout(e,this.retrySyncLoopDelay):this.conditions.SyncLoop=!1})};M.debug(`[SL] c:"${this.getKey()}" run sync loop`),this.conditions.SyncLoop=!0,e()}async runWatchLoop(e){const t=this.attachmentMap.get(e);if(!t)throw new w(v.ErrDocumentNotAttached,`${e} is not attached`);return this.conditions.WatchLoop=!0,t.runWatchLoop(r=>{if(!this.isActive())return this.conditions.WatchLoop=!1,Promise.reject(new w(v.ErrClientNotActivated,`${this.key} is not active`));const s=new AbortController,i=this.rpcClient.watchDocument({clientId:this.id,documentId:t.docID},{headers:{"x-shard-key":`${this.apiKey}/${e}`},signal:s.signal});return t.doc.publish([{type:xe.ConnectionChanged,value:rc.Connected}]),M.info(`[WD] c:"${this.getKey()}" watches d:"${e}"`),new Promise((o,a)=>{(async()=>{try{for await(const l of i)this.handleWatchDocumentsResponse(t,l),l.body.case==="initialization"&&o([i,s])}catch(l){t.doc.resetOnlineClients(),t.doc.publish([{type:xe.Initialized,source:ce.Local,value:t.doc.getPresences()}]),t.doc.publish([{type:xe.ConnectionChanged,value:rc.Disconnected}]),M.debug(`[WD] c:"${this.getKey()}" unwatches`),await this.handleConnectError(l)?(l instanceof re&&kr(l)===v.ErrUnauthenticated&&t.doc.publish([{type:xe.AuthError,value:{reason:Ks(l).reason,method:"WatchDocuments"}}]),r()):this.conditions.WatchLoop=!1,a(l)}})()})})}handleWatchDocumentsResponse(e,t){if(t.body.case==="event"&&t.body.value.type===es.DOCUMENT_CHANGED){e.remoteChangeEventReceived=!0;return}e.doc.applyWatchStream(t)}deactivateInternal(){this.status="deactivated";for(const[e,t]of this.attachmentMap)this.detachInternal(e),t.doc.applyStatus(Pr.Detached)}detachInternal(e){const t=this.attachmentMap.get(e);t&&(t.cancelWatchStream(),t.unsubscribeBroadcastEvent(),this.attachmentMap.delete(e))}async syncInternal(e,t){const{doc:r,docID:s}=e,i=r.createChangePack();try{const o=await this.rpcClient.pushPullChanges({clientId:this.id,documentId:s,changePack:we.toChangePack(i),pushOnly:t==="realtime-pushonly"},{headers:{"x-shard-key":`${this.apiKey}/${r.getKey()}`}}),a=we.fromChangePack(o.changePack);if(a.hasChanges()&&(e.syncMode==="realtime-pushonly"||e.syncMode==="realtime-syncoff"))return r;r.applyChangePack(a),e.doc.publish([{type:xe.SyncStatusChanged,value:sc.Synced}]),r.getStatus()===Pr.Removed&&this.detachInternal(r.getKey());const u=r.getKey(),l=a.getChangeSize();return M.info(`[PP] c:"${this.getKey()}" sync d:"${u}", push:${i.getChangeSize()} pull:${l} cp:${a.getCheckpoint().toTestString()}`),r}catch(o){throw r.publish([{type:xe.SyncStatusChanged,value:sc.SyncFailed}]),M.error(`[PP] c:"${this.getKey()}" err :`,o),o}}async handleConnectError(e){if(!(e instanceof re))return!1;if(e.code===X.Canceled||e.code===X.Unknown||e.code===X.ResourceExhausted||e.code===X.Unavailable)return!0;if(kr(e)===v.ErrUnauthenticated){if(this.authTokenInjector){const t=await this.authTokenInjector(Ks(e).reason);this.setAuthToken(t)}return!0}return kr(e)===v.ErrTooManySubscribers?(M.error(`[WD] c:"${this.getKey()}" err :`,e.rawMessage),!0):(kr(e)===v.ErrTooManyAttachments||(kr(e)===v.ErrClientNotActivated||kr(e)===v.ErrClientNotFound)&&this.deactivateInternal(),!1)}enqueueTask(e){return new Promise((t,r)=>{this.taskQueue.push(()=>e().then(t).catch(r)),this.processing||this.processNext()})}async processNext(){if(this.taskQueue.length===0){this.processing=!1;return}try{this.processing=!0,await this.taskQueue.shift()()}catch{M.error(`[TQ] c:"${this.getKey()}" process failed, id:"${this.id}"`)}this.processNext()}}const Oh={Client:Dh,Document:Ch,IntType:Xt.Int,LongType:Xt.Long};typeof globalThis<"u"&&(globalThis.yorkie={Client:Dh,Document:Ch,Primitive:pe,Text:$c,Counter:Mc,Tree:zc,LogLevel:Ve,setLogLevel:By,IntType:Xt.Int,LongType:Xt.Long});const av=(n,e)=>{const t=n.__vccOpts||n;for(const[r,s]of e)t[r]=s;return t},cv=[{title:"Todo",cards:[{title:"Pruning document"},{title:"Clean up codes"}]},{title:"Doing",cards:[{title:"Array operations"}]},{title:"Done",cards:[{title:"Create a sample page"},{title:"Launch demo site"}]}],Er=new Oh.Client({rpcAddr:"https://api.yorkie.dev",apiKey:"D6sd9E5ehtXBssmeRZ4QQP"}),nn=new Oh.Document(`vuejs-kanban-${new Date().toISOString().substring(0,10).replace(/-/g,"")}`,{enableDevtools:!0}),uv={data(){return{lists:[],title:"",opened:null}},created(){this.fetchDoc()},beforeUnmount(){this.disconnect()},watch:{opened(n){this.$nextTick(function(){n===0?this.$refs.addListForm.querySelector("input").focus():n&&this.$refs.addCardForm[n-1].querySelector("input").focus(),this.title=""})}},methods:{async fetchDoc(){await Er.activate(),await Er.attach(nn),nn.update(n=>{n.lists||(n.lists=cv)},"create default list if not exists"),nn.subscribe(n=>{this.lists=nn.getRoot().lists}),await Er.sync(),this.lists=nn.getRoot().lists},async disconnect(){await Er.deactivate({keepalive:!0})},isOpened(n){return this.opened===n},openForm(n){this.opened=n},closeForm(){this.opened=null},addCard(n){this.title!==""&&nn.update(e=>{e.lists.getElementByID(n.getID()).cards.push({title:this.title}),this.title=""},`add new card by ${Er.getID()}`)},deleteCard(n,e){nn.update(t=>{t.lists.getElementByID(n.getID()).cards.deleteByID(e.getID())},`delete a card by ${Er.getID()}`)},addList(){this.title!==""&&nn.update(n=>{n.lists.push({title:this.title,cards:[]}),this.title=""},`add new list by ${Er.getID()}`)},deleteList(n){nn.update(e=>{e.lists.deleteByID(n.getID())},`delete a list by ${Er.getID()}`)}}},lv={class:"list"},fv=["onClick"],hv={class:"title"},dv={class:"card"},gv=["onClick"],mv={key:0,class:"add-form"},pv=["onKeyup"],yv={class:"buttons"},vv=["onClick"],wv=["onClick"],bv={class:"add-list",ref:"addListForm"},Tv={key:0,class:"add-form"},Sv={class:"buttons"};function Iv(n,e,t,r,s,i){return en(),tn(rt,null,[(en(!0),tn(rt,null,Qc(s.lists,(o,a)=>(en(),tn("div",lv,[Be("span",{class:"delete",onClick:u=>i.deleteList(o)},"❌",8,fv),Be("div",hv,ga(o.title),1),(en(!0),tn(rt,null,Qc(o.cards,u=>(en(),tn("div",dv,[Be("span",{class:"delete",onClick:l=>i.deleteCard(o,u)},"❌",8,gv),bf(" "+ga(u.title),1)]))),256)),Be("div",{class:"add-card",ref_for:!0,ref:"addCardForm"},[i.isOpened(a+1)?(en(),tn("div",mv,[Zc(Be("input",{type:"text",placeholder:"Enter card title","onUpdate:modelValue":e[0]||(e[0]=u=>s.title=u),onKeyup:[Ci(u=>i.addCard(o),["enter"]),e[1]||(e[1]=Ci(u=>i.closeForm(),["esc"]))]},null,40,pv),[[Au,s.title]]),Be("div",yv,[Be("input",{type:"button",value:"Add",onClick:u=>i.addCard(o)},null,8,vv),Be("input",{type:"button",value:"Close",class:"pull-right",onClick:e[2]||(e[2]=u=>i.closeForm())})])])):(en(),tn("div",{key:1,class:"add-card-opener",onClick:u=>i.openForm(a+1)}," Add another card ",8,wv))],512)]))),256)),Be("div",bv,[i.isOpened(0)?(en(),tn("div",Tv,[Zc(Be("input",{type:"text",placeholder:"Enter list title","onUpdate:modelValue":e[3]||(e[3]=o=>s.title=o),onKeyup:[e[4]||(e[4]=Ci(o=>i.addList(),["enter"])),e[5]||(e[5]=Ci(o=>i.closeForm(),["esc"]))]},null,544),[[Au,s.title]]),Be("div",Sv,[Be("input",{type:"button",value:"Add",onClick:e[6]||(e[6]=o=>i.addList())}),Be("input",{type:"button",value:"Close",class:"pull-right",onClick:e[7]||(e[7]=o=>i.closeForm())})])])):(en(),tn("div",{key:1,class:"add-list-opener",onClick:e[8]||(e[8]=o=>i.openForm(0))}," Add another list "))],512)],64)}const Av=av(uv,[["render",Iv]]);tm(Av).mount("#app");
