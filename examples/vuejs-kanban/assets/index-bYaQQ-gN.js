(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function co(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const ae={},$n=[],wt=()=>{},Rl=()=>!1,Ks=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),lo=t=>t.startsWith("onUpdate:"),Pe=Object.assign,uo=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Sh=Object.prototype.hasOwnProperty,te=(t,e)=>Sh.call(t,e),K=Array.isArray,Xn=t=>Js(t)==="[object Map]",Cl=t=>Js(t)==="[object Set]",J=t=>typeof t=="function",ve=t=>typeof t=="string",pn=t=>typeof t=="symbol",pe=t=>t!==null&&typeof t=="object",Tl=t=>(pe(t)||J(t))&&J(t.then)&&J(t.catch),xl=Object.prototype.toString,Js=t=>xl.call(t),Ih=t=>Js(t).slice(8,-1),Vl=t=>Js(t)==="[object Object]",fo=t=>ve(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Rr=co(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),$s=t=>{const e=Object.create(null);return(n=>e[n]||(e[n]=t(n)))},Eh=/-\w/g,un=$s(t=>t.replace(Eh,e=>e.slice(1).toUpperCase())),wh=/\B([A-Z])/g,mn=$s(t=>t.replace(wh,"-$1").toLowerCase()),Dl=$s(t=>t.charAt(0).toUpperCase()+t.slice(1)),di=$s(t=>t?`on${Dl(t)}`:""),xn=(t,e)=>!Object.is(t,e),Is=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},Ol=(t,e,n,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:n})},ho=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Ea;const Xs=()=>Ea||(Ea=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function go(t){if(K(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],s=ve(r)?Th(r):go(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(ve(t)||pe(t))return t}const Nh=/;(?![^(]*\))/g,Rh=/:([^]+)/,Ch=/\/\*[^]*?\*\//g;function Th(t){const e={};return t.replace(Ch,"").split(Nh).forEach(n=>{if(n){const r=n.split(Rh);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function po(t){let e="";if(ve(t))e=t;else if(K(t))for(let n=0;n<t.length;n++){const r=po(t[n]);r&&(e+=r+" ")}else if(pe(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const xh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Vh=co(xh);function Ll(t){return!!t||t===""}const Bl=t=>!!(t&&t.__v_isRef===!0),Pi=t=>ve(t)?t:t==null?"":K(t)||pe(t)&&(t.toString===xl||!J(t.toString))?Bl(t)?Pi(t.value):JSON.stringify(t,Wl,2):String(t),Wl=(t,e)=>Bl(e)?Wl(t,e.value):Xn(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,s],i)=>(n[gi(r,i)+" =>"]=s,n),{})}:Cl(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>gi(n))}:pn(e)?gi(e):pe(e)&&!K(e)&&!Vl(e)?String(e):e,gi=(t,e="")=>{var n;return pn(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};let ke;class Dh{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ke,!e&&ke&&(this.index=(ke.scopes||(ke.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=ke;try{return ke=this,e()}finally{ke=n}}}on(){++this._on===1&&(this.prevScope=ke,ke=this)}off(){this._on>0&&--this._on===0&&(ke=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Oh(){return ke}let fe;const pi=new WeakSet;class Pl{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ke&&ke.active&&ke.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,pi.has(this)&&(pi.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ul(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,wa(this),kl(this);const e=fe,n=dt;fe=this,dt=!0;try{return this.fn()}finally{Fl(this),fe=e,dt=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)yo(e);this.deps=this.depsTail=void 0,wa(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?pi.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){_i(this)&&this.run()}get dirty(){return _i(this)}}let _l=0,Cr,Tr;function Ul(t,e=!1){if(t.flags|=8,e){t.next=Tr,Tr=t;return}t.next=Cr,Cr=t}function mo(){_l++}function bo(){if(--_l>0)return;if(Tr){let e=Tr;for(Tr=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Cr;){let e=Cr;for(Cr=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=n}}if(t)throw t}function kl(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Fl(t){let e,n=t.depsTail,r=n;for(;r;){const s=r.prevDep;r.version===-1?(r===n&&(n=s),yo(r),Lh(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}t.deps=e,t.depsTail=n}function _i(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Zl(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function Zl(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Ur)||(t.globalVersion=Ur,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!_i(t))))return;t.flags|=2;const e=t.dep,n=fe,r=dt;fe=t,dt=!0;try{kl(t);const s=t.fn(t._value);(e.version===0||xn(s,t._value))&&(t.flags|=128,t._value=s,e.version++)}catch(s){throw e.version++,s}finally{fe=n,dt=r,Fl(t),t.flags&=-3}}function yo(t,e=!1){const{dep:n,prevSub:r,nextSub:s}=t;if(r&&(r.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=r,t.nextSub=void 0),n.subs===t&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)yo(i,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function Lh(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let dt=!0;const Gl=[];function Kt(){Gl.push(dt),dt=!1}function Jt(){const t=Gl.pop();dt=t===void 0?!0:t}function wa(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=fe;fe=void 0;try{e()}finally{fe=n}}}let Ur=0;class Bh{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ml{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!fe||!dt||fe===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==fe)n=this.activeLink=new Bh(fe,this),fe.deps?(n.prevDep=fe.depsTail,fe.depsTail.nextDep=n,fe.depsTail=n):fe.deps=fe.depsTail=n,Yl(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=fe.depsTail,n.nextDep=void 0,fe.depsTail.nextDep=n,fe.depsTail=n,fe.deps===n&&(fe.deps=r)}return n}trigger(e){this.version++,Ur++,this.notify(e)}notify(e){mo();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{bo()}}}function Yl(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)Yl(r)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Ui=new WeakMap,Vn=Symbol(""),ki=Symbol(""),kr=Symbol("");function Re(t,e,n){if(dt&&fe){let r=Ui.get(t);r||Ui.set(t,r=new Map);let s=r.get(n);s||(r.set(n,s=new Ml),s.map=r,s.key=n),s.track()}}function kt(t,e,n,r,s,i){const o=Ui.get(t);if(!o){Ur++;return}const a=c=>{c&&c.trigger()};if(mo(),e==="clear")o.forEach(a);else{const c=K(t),l=c&&fo(n);if(c&&n==="length"){const u=Number(r);o.forEach((f,b)=>{(b==="length"||b===kr||!pn(b)&&b>=u)&&a(f)})}else switch((n!==void 0||o.has(void 0))&&a(o.get(n)),l&&a(o.get(kr)),e){case"add":c?l&&a(o.get("length")):(a(o.get(Vn)),Xn(t)&&a(o.get(ki)));break;case"delete":c||(a(o.get(Vn)),Xn(t)&&a(o.get(ki)));break;case"set":Xn(t)&&a(o.get(Vn));break}}bo()}function Pn(t){const e=oe(t);return e===t?e:(Re(e,"iterate",kr),gt(t)?e:e.map($t))}function zs(t){return Re(t=oe(t),"iterate",kr),t}function nn(t,e){return fn(t)?Dn(t)?qn($t(e)):qn(e):$t(e)}const Wh={__proto__:null,[Symbol.iterator](){return mi(this,Symbol.iterator,t=>nn(this,t))},concat(...t){return Pn(this).concat(...t.map(e=>K(e)?Pn(e):e))},entries(){return mi(this,"entries",t=>(t[1]=nn(this,t[1]),t))},every(t,e){return Bt(this,"every",t,e,void 0,arguments)},filter(t,e){return Bt(this,"filter",t,e,n=>n.map(r=>nn(this,r)),arguments)},find(t,e){return Bt(this,"find",t,e,n=>nn(this,n),arguments)},findIndex(t,e){return Bt(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Bt(this,"findLast",t,e,n=>nn(this,n),arguments)},findLastIndex(t,e){return Bt(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Bt(this,"forEach",t,e,void 0,arguments)},includes(...t){return bi(this,"includes",t)},indexOf(...t){return bi(this,"indexOf",t)},join(t){return Pn(this).join(t)},lastIndexOf(...t){return bi(this,"lastIndexOf",t)},map(t,e){return Bt(this,"map",t,e,void 0,arguments)},pop(){return br(this,"pop")},push(...t){return br(this,"push",t)},reduce(t,...e){return Na(this,"reduce",t,e)},reduceRight(t,...e){return Na(this,"reduceRight",t,e)},shift(){return br(this,"shift")},some(t,e){return Bt(this,"some",t,e,void 0,arguments)},splice(...t){return br(this,"splice",t)},toReversed(){return Pn(this).toReversed()},toSorted(t){return Pn(this).toSorted(t)},toSpliced(...t){return Pn(this).toSpliced(...t)},unshift(...t){return br(this,"unshift",t)},values(){return mi(this,"values",t=>nn(this,t))}};function mi(t,e,n){const r=zs(t),s=r[e]();return r!==t&&!gt(t)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.done||(i.value=n(i.value)),i}),s}const Ph=Array.prototype;function Bt(t,e,n,r,s,i){const o=zs(t),a=o!==t&&!gt(t),c=o[e];if(c!==Ph[e]){const f=c.apply(t,i);return a?$t(f):f}let l=n;o!==t&&(a?l=function(f,b){return n.call(this,nn(t,f),b,t)}:n.length>2&&(l=function(f,b){return n.call(this,f,b,t)}));const u=c.call(o,l,r);return a&&s?s(u):u}function Na(t,e,n,r){const s=zs(t);let i=n;return s!==t&&(gt(t)?n.length>3&&(i=function(o,a,c){return n.call(this,o,a,c,t)}):i=function(o,a,c){return n.call(this,o,nn(t,a),c,t)}),s[e](i,...r)}function bi(t,e,n){const r=oe(t);Re(r,"iterate",kr);const s=r[e](...n);return(s===-1||s===!1)&&Io(n[0])?(n[0]=oe(n[0]),r[e](...n)):s}function br(t,e,n=[]){Kt(),mo();const r=oe(t)[e].apply(t,n);return bo(),Jt(),r}const _h=co("__proto__,__v_isRef,__isVue"),Kl=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(pn));function Uh(t){pn(t)||(t=String(t));const e=oe(this);return Re(e,"has",t),e.hasOwnProperty(t)}class Jl{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,r){if(n==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return i;if(n==="__v_raw")return r===(s?i?Xh:jl:i?zl:Xl).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=K(e);if(!s){let c;if(o&&(c=Wh[n]))return c;if(n==="hasOwnProperty")return Uh}const a=Reflect.get(e,n,We(e)?e:r);if((pn(n)?Kl.has(n):_h(n))||(s||Re(e,"get",n),i))return a;if(We(a)){const c=o&&fo(n)?a:a.value;return s&&pe(c)?Zi(c):c}return pe(a)?s?Zi(a):vo(a):a}}class $l extends Jl{constructor(e=!1){super(!1,e)}set(e,n,r,s){let i=e[n];const o=K(e)&&fo(n);if(!this._isShallow){const l=fn(i);if(!gt(r)&&!fn(r)&&(i=oe(i),r=oe(r)),!o&&We(i)&&!We(r))return l||(i.value=r),!0}const a=o?Number(n)<e.length:te(e,n),c=Reflect.set(e,n,r,We(e)?e:s);return e===oe(s)&&(a?xn(r,i)&&kt(e,"set",n,r):kt(e,"add",n,r)),c}deleteProperty(e,n){const r=te(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&r&&kt(e,"delete",n,void 0),s}has(e,n){const r=Reflect.has(e,n);return(!pn(n)||!Kl.has(n))&&Re(e,"has",n),r}ownKeys(e){return Re(e,"iterate",K(e)?"length":Vn),Reflect.ownKeys(e)}}class kh extends Jl{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const Fh=new $l,Zh=new kh,Gh=new $l(!0);const Fi=t=>t,us=t=>Reflect.getPrototypeOf(t);function Mh(t,e,n){return function(...r){const s=this.__v_raw,i=oe(s),o=Xn(i),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,l=s[t](...r),u=n?Fi:e?qn:$t;return!e&&Re(i,"iterate",c?ki:Vn),{next(){const{value:f,done:b}=l.next();return b?{value:f,done:b}:{value:a?[u(f[0]),u(f[1])]:u(f),done:b}},[Symbol.iterator](){return this}}}}function fs(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Yh(t,e){const n={get(s){const i=this.__v_raw,o=oe(i),a=oe(s);t||(xn(s,a)&&Re(o,"get",s),Re(o,"get",a));const{has:c}=us(o),l=e?Fi:t?qn:$t;if(c.call(o,s))return l(i.get(s));if(c.call(o,a))return l(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!t&&Re(oe(s),"iterate",Vn),s.size},has(s){const i=this.__v_raw,o=oe(i),a=oe(s);return t||(xn(s,a)&&Re(o,"has",s),Re(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,c=oe(a),l=e?Fi:t?qn:$t;return!t&&Re(c,"iterate",Vn),a.forEach((u,f)=>s.call(i,l(u),l(f),o))}};return Pe(n,t?{add:fs("add"),set:fs("set"),delete:fs("delete"),clear:fs("clear")}:{add(s){!e&&!gt(s)&&!fn(s)&&(s=oe(s));const i=oe(this);return us(i).has.call(i,s)||(i.add(s),kt(i,"add",s,s)),this},set(s,i){!e&&!gt(i)&&!fn(i)&&(i=oe(i));const o=oe(this),{has:a,get:c}=us(o);let l=a.call(o,s);l||(s=oe(s),l=a.call(o,s));const u=c.call(o,s);return o.set(s,i),l?xn(i,u)&&kt(o,"set",s,i):kt(o,"add",s,i),this},delete(s){const i=oe(this),{has:o,get:a}=us(i);let c=o.call(i,s);c||(s=oe(s),c=o.call(i,s)),a&&a.call(i,s);const l=i.delete(s);return c&&kt(i,"delete",s,void 0),l},clear(){const s=oe(this),i=s.size!==0,o=s.clear();return i&&kt(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=Mh(s,t,e)}),n}function Ao(t,e){const n=Yh(t,e);return(r,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?r:Reflect.get(te(n,s)&&s in r?n:r,s,i)}const Kh={get:Ao(!1,!1)},Jh={get:Ao(!1,!0)},$h={get:Ao(!0,!1)};const Xl=new WeakMap,zl=new WeakMap,jl=new WeakMap,Xh=new WeakMap;function zh(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function jh(t){return t.__v_skip||!Object.isExtensible(t)?0:zh(Ih(t))}function vo(t){return fn(t)?t:So(t,!1,Fh,Kh,Xl)}function Hh(t){return So(t,!1,Gh,Jh,zl)}function Zi(t){return So(t,!0,Zh,$h,jl)}function So(t,e,n,r,s){if(!pe(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=jh(t);if(i===0)return t;const o=s.get(t);if(o)return o;const a=new Proxy(t,i===2?r:n);return s.set(t,a),a}function Dn(t){return fn(t)?Dn(t.__v_raw):!!(t&&t.__v_isReactive)}function fn(t){return!!(t&&t.__v_isReadonly)}function gt(t){return!!(t&&t.__v_isShallow)}function Io(t){return t?!!t.__v_raw:!1}function oe(t){const e=t&&t.__v_raw;return e?oe(e):t}function Qh(t){return!te(t,"__v_skip")&&Object.isExtensible(t)&&Ol(t,"__v_skip",!0),t}const $t=t=>pe(t)?vo(t):t,qn=t=>pe(t)?Zi(t):t;function We(t){return t?t.__v_isRef===!0:!1}function qh(t){return We(t)?t.value:t}const ed={get:(t,e,n)=>e==="__v_raw"?t:qh(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const s=t[e];return We(s)&&!We(n)?(s.value=n,!0):Reflect.set(t,e,n,r)}};function Hl(t){return Dn(t)?t:new Proxy(t,ed)}class td{constructor(e,n,r){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Ml(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Ur-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&fe!==this)return Ul(this,!0),!0}get value(){const e=this.dep.track();return Zl(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function nd(t,e,n=!1){let r,s;return J(t)?r=t:(r=t.get,s=t.set),new td(r,s,n)}const hs={},Ds=new WeakMap;let En;function rd(t,e=!1,n=En){if(n){let r=Ds.get(n);r||Ds.set(n,r=[]),r.push(t)}}function sd(t,e,n=ae){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:c}=n,l=D=>s?D:gt(D)||s===!1||s===0?Ft(D,1):Ft(D);let u,f,b,d,A=!1,S=!1;if(We(t)?(f=()=>t.value,A=gt(t)):Dn(t)?(f=()=>l(t),A=!0):K(t)?(S=!0,A=t.some(D=>Dn(D)||gt(D)),f=()=>t.map(D=>{if(We(D))return D.value;if(Dn(D))return l(D);if(J(D))return c?c(D,2):D()})):J(t)?e?f=c?()=>c(t,2):t:f=()=>{if(b){Kt();try{b()}finally{Jt()}}const D=En;En=u;try{return c?c(t,3,[d]):t(d)}finally{En=D}}:f=wt,e&&s){const D=f,U=s===!0?1/0:s;f=()=>Ft(D(),U)}const W=Oh(),L=()=>{u.stop(),W&&W.active&&uo(W.effects,u)};if(i&&e){const D=e;e=(...U)=>{D(...U),L()}}let G=S?new Array(t.length).fill(hs):hs;const _=D=>{if(!(!(u.flags&1)||!u.dirty&&!D))if(e){const U=u.run();if(s||A||(S?U.some((ie,j)=>xn(ie,G[j])):xn(U,G))){b&&b();const ie=En;En=u;try{const j=[U,G===hs?void 0:S&&G[0]===hs?[]:G,d];G=U,c?c(e,3,j):e(...j)}finally{En=ie}}}else u.run()};return a&&a(_),u=new Pl(f),u.scheduler=o?()=>o(_,!1):_,d=D=>rd(D,!1,u),b=u.onStop=()=>{const D=Ds.get(u);if(D){if(c)c(D,4);else for(const U of D)U();Ds.delete(u)}},e?r?_(!0):G=u.run():o?o(_.bind(null,!0),!0):u.run(),L.pause=u.pause.bind(u),L.resume=u.resume.bind(u),L.stop=L,L}function Ft(t,e=1/0,n){if(e<=0||!pe(t)||t.__v_skip||(n=n||new Map,(n.get(t)||0)>=e))return t;if(n.set(t,e),e--,We(t))Ft(t.value,e,n);else if(K(t))for(let r=0;r<t.length;r++)Ft(t[r],e,n);else if(Cl(t)||Xn(t))t.forEach(r=>{Ft(r,e,n)});else if(Vl(t)){for(const r in t)Ft(t[r],e,n);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&Ft(t[r],e,n)}return t}function es(t,e,n,r){try{return r?t(...r):t()}catch(s){js(s,e,n)}}function Tt(t,e,n,r){if(J(t)){const s=es(t,e,n,r);return s&&Tl(s)&&s.catch(i=>{js(i,e,n)}),s}if(K(t)){const s=[];for(let i=0;i<t.length;i++)s.push(Tt(t[i],e,n,r));return s}}function js(t,e,n,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||ae;if(e){let a=e.parent;const c=e.proxy,l=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const u=a.ec;if(u){for(let f=0;f<u.length;f++)if(u[f](t,c,l)===!1)return}a=a.parent}if(i){Kt(),es(i,null,10,[t,c,l]),Jt();return}}id(t,n,s,r,o)}function id(t,e,n,r=!0,s=!1){if(s)throw t;console.error(t)}const Le=[];let St=-1;const zn=[];let rn=null,Zn=0;const Ql=Promise.resolve();let Os=null;function od(t){const e=Os||Ql;return t?e.then(this?t.bind(this):t):e}function ad(t){let e=St+1,n=Le.length;for(;e<n;){const r=e+n>>>1,s=Le[r],i=Fr(s);i<t||i===t&&s.flags&2?e=r+1:n=r}return e}function Eo(t){if(!(t.flags&1)){const e=Fr(t),n=Le[Le.length-1];!n||!(t.flags&2)&&e>=Fr(n)?Le.push(t):Le.splice(ad(e),0,t),t.flags|=1,ql()}}function ql(){Os||(Os=Ql.then(tu))}function cd(t){K(t)?zn.push(...t):rn&&t.id===-1?rn.splice(Zn+1,0,t):t.flags&1||(zn.push(t),t.flags|=1),ql()}function Ra(t,e,n=St+1){for(;n<Le.length;n++){const r=Le[n];if(r&&r.flags&2){if(t&&r.id!==t.uid)continue;Le.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function eu(t){if(zn.length){const e=[...new Set(zn)].sort((n,r)=>Fr(n)-Fr(r));if(zn.length=0,rn){rn.push(...e);return}for(rn=e,Zn=0;Zn<rn.length;Zn++){const n=rn[Zn];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}rn=null,Zn=0}}const Fr=t=>t.id==null?t.flags&2?-1:1/0:t.id;function tu(t){try{for(St=0;St<Le.length;St++){const e=Le[St];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),es(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;St<Le.length;St++){const e=Le[St];e&&(e.flags&=-2)}St=-1,Le.length=0,eu(),Os=null,(Le.length||zn.length)&&tu()}}let Qe=null,nu=null;function Ls(t){const e=Qe;return Qe=t,nu=t&&t.type.__scopeId||null,e}function ld(t,e=Qe,n){if(!e||t._n)return t;const r=(...s)=>{r._d&&Ua(-1);const i=Ls(e);let o;try{o=t(...s)}finally{Ls(i),r._d&&Ua(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function Ca(t,e){if(Qe===null)return t;const n=ei(Qe),r=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,c=ae]=e[s];i&&(J(i)&&(i={mounted:i,updated:i}),i.deep&&Ft(o),r.push({dir:i,instance:n,value:o,oldValue:void 0,arg:a,modifiers:c}))}return t}function vn(t,e,n,r){const s=t.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let c=a.dir[r];c&&(Kt(),Tt(c,n,8,[t.el,a,t,e]),Jt())}}const ud=Symbol("_vte"),fd=t=>t.__isTeleport,hd=Symbol("_leaveCb");function wo(t,e){t.shapeFlag&6&&t.component?(t.transition=e,wo(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function ru(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const Bs=new WeakMap;function xr(t,e,n,r,s=!1){if(K(t)){t.forEach((A,S)=>xr(A,e&&(K(e)?e[S]:e),n,r,s));return}if(Vr(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&xr(t,e,n,r.component.subTree);return}const i=r.shapeFlag&4?ei(r.component):r.el,o=s?null:i,{i:a,r:c}=t,l=e&&e.r,u=a.refs===ae?a.refs={}:a.refs,f=a.setupState,b=oe(f),d=f===ae?Rl:A=>te(b,A);if(l!=null&&l!==c){if(Ta(e),ve(l))u[l]=null,d(l)&&(f[l]=null);else if(We(l)){l.value=null;const A=e;A.k&&(u[A.k]=null)}}if(J(c))es(c,a,12,[o,u]);else{const A=ve(c),S=We(c);if(A||S){const W=()=>{if(t.f){const L=A?d(c)?f[c]:u[c]:c.value;if(s)K(L)&&uo(L,i);else if(K(L))L.includes(i)||L.push(i);else if(A)u[c]=[i],d(c)&&(f[c]=u[c]);else{const G=[i];c.value=G,t.k&&(u[t.k]=G)}}else A?(u[c]=o,d(c)&&(f[c]=o)):S&&(c.value=o,t.k&&(u[t.k]=o))};if(o){const L=()=>{W(),Bs.delete(t)};L.id=-1,Bs.set(t,L),Je(L,n)}else Ta(t),W()}}}function Ta(t){const e=Bs.get(t);e&&(e.flags|=8,Bs.delete(t))}Xs().requestIdleCallback;Xs().cancelIdleCallback;const Vr=t=>!!t.type.__asyncLoader,su=t=>t.type.__isKeepAlive;function dd(t,e){iu(t,"a",e)}function gd(t,e){iu(t,"da",e)}function iu(t,e,n=Be){const r=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Hs(e,r,n),n){let s=n.parent;for(;s&&s.parent;)su(s.parent.vnode)&&pd(r,e,n,s),s=s.parent}}function pd(t,e,n,r){const s=Hs(e,t,r,!0);ou(()=>{uo(r[e],s)},n)}function Hs(t,e,n=Be,r=!1){if(n){const s=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{Kt();const a=ts(n),c=Tt(e,n,t,o);return a(),Jt(),c});return r?s.unshift(i):s.push(i),i}}const jt=t=>(e,n=Be)=>{(!Gr||t==="sp")&&Hs(t,(...r)=>e(...r),n)},md=jt("bm"),bd=jt("m"),yd=jt("bu"),Ad=jt("u"),vd=jt("bum"),ou=jt("um"),Sd=jt("sp"),Id=jt("rtg"),Ed=jt("rtc");function wd(t,e=Be){Hs("ec",t,e)}const Nd=Symbol.for("v-ndc");function xa(t,e,n,r){let s;const i=n,o=K(t);if(o||ve(t)){const a=o&&Dn(t);let c=!1,l=!1;a&&(c=!gt(t),l=fn(t),t=zs(t)),s=new Array(t.length);for(let u=0,f=t.length;u<f;u++)s[u]=e(c?l?qn($t(t[u])):$t(t[u]):t[u],u,void 0,i)}else if(typeof t=="number"){s=new Array(t);for(let a=0;a<t;a++)s[a]=e(a+1,a,void 0,i)}else if(pe(t))if(t[Symbol.iterator])s=Array.from(t,(a,c)=>e(a,c,void 0,i));else{const a=Object.keys(t);s=new Array(a.length);for(let c=0,l=a.length;c<l;c++){const u=a[c];s[c]=e(t[u],u,c,i)}}else s=[];return s}const Gi=t=>t?Cu(t)?ei(t):Gi(t.parent):null,Dr=Pe(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Gi(t.parent),$root:t=>Gi(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>cu(t),$forceUpdate:t=>t.f||(t.f=()=>{Eo(t.update)}),$nextTick:t=>t.n||(t.n=od.bind(t.proxy)),$watch:t=>_d.bind(t)}),yi=(t,e)=>t!==ae&&!t.__isScriptSetup&&te(t,e),Rd={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:c}=t;if(e[0]!=="$"){const b=o[e];if(b!==void 0)switch(b){case 1:return r[e];case 2:return s[e];case 4:return n[e];case 3:return i[e]}else{if(yi(r,e))return o[e]=1,r[e];if(s!==ae&&te(s,e))return o[e]=2,s[e];if(te(i,e))return o[e]=3,i[e];if(n!==ae&&te(n,e))return o[e]=4,n[e];Mi&&(o[e]=0)}}const l=Dr[e];let u,f;if(l)return e==="$attrs"&&Re(t.attrs,"get",""),l(t);if((u=a.__cssModules)&&(u=u[e]))return u;if(n!==ae&&te(n,e))return o[e]=4,n[e];if(f=c.config.globalProperties,te(f,e))return f[e]},set({_:t},e,n){const{data:r,setupState:s,ctx:i}=t;return yi(s,e)?(s[e]=n,!0):r!==ae&&te(r,e)?(r[e]=n,!0):te(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:s,props:i,type:o}},a){let c;return!!(n[a]||t!==ae&&a[0]!=="$"&&te(t,a)||yi(e,a)||te(i,a)||te(r,a)||te(Dr,a)||te(s.config.globalProperties,a)||(c=o.__cssModules)&&c[a])},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:te(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Va(t){return K(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let Mi=!0;function Cd(t){const e=cu(t),n=t.proxy,r=t.ctx;Mi=!1,e.beforeCreate&&Da(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:o,watch:a,provide:c,inject:l,created:u,beforeMount:f,mounted:b,beforeUpdate:d,updated:A,activated:S,deactivated:W,beforeDestroy:L,beforeUnmount:G,destroyed:_,unmounted:D,render:U,renderTracked:ie,renderTriggered:j,errorCaptured:ne,serverPrefetch:Ot,expose:je,inheritAttrs:Qt,components:Lt,directives:as,filters:fi}=e;if(l&&Td(l,r,null),o)for(const me in o){const le=o[me];J(le)&&(r[me]=le.bind(n))}if(s){const me=s.call(n,n);pe(me)&&(t.data=vo(me))}if(Mi=!0,i)for(const me in i){const le=i[me],yn=J(le)?le.bind(n,n):J(le.get)?le.get.bind(n,n):wt,cs=!J(le)&&J(le.set)?le.set.bind(n):wt,An=mg({get:yn,set:cs});Object.defineProperty(r,me,{enumerable:!0,configurable:!0,get:()=>An.value,set:mt=>An.value=mt})}if(a)for(const me in a)au(a[me],r,n,me);if(c){const me=J(c)?c.call(n):c;Reflect.ownKeys(me).forEach(le=>{Bd(le,me[le])})}u&&Da(u,t,"c");function Ve(me,le){K(le)?le.forEach(yn=>me(yn.bind(n))):le&&me(le.bind(n))}if(Ve(md,f),Ve(bd,b),Ve(yd,d),Ve(Ad,A),Ve(dd,S),Ve(gd,W),Ve(wd,ne),Ve(Ed,ie),Ve(Id,j),Ve(vd,G),Ve(ou,D),Ve(Sd,Ot),K(je))if(je.length){const me=t.exposed||(t.exposed={});je.forEach(le=>{Object.defineProperty(me,le,{get:()=>n[le],set:yn=>n[le]=yn,enumerable:!0})})}else t.exposed||(t.exposed={});U&&t.render===wt&&(t.render=U),Qt!=null&&(t.inheritAttrs=Qt),Lt&&(t.components=Lt),as&&(t.directives=as),Ot&&ru(t)}function Td(t,e,n=wt){K(t)&&(t=Yi(t));for(const r in t){const s=t[r];let i;pe(s)?"default"in s?i=Es(s.from||r,s.default,!0):i=Es(s.from||r):i=Es(s),We(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function Da(t,e,n){Tt(K(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function au(t,e,n,r){let s=r.includes(".")?fu(n,r):()=>n[r];if(ve(t)){const i=e[t];J(i)&&Ai(s,i)}else if(J(t))Ai(s,t.bind(n));else if(pe(t))if(K(t))t.forEach(i=>au(i,e,n,r));else{const i=J(t.handler)?t.handler.bind(n):e[t.handler];J(i)&&Ai(s,i,t)}}function cu(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let c;return a?c=a:!s.length&&!n&&!r?c=e:(c={},s.length&&s.forEach(l=>Ws(c,l,o,!0)),Ws(c,e,o)),pe(e)&&i.set(e,c),c}function Ws(t,e,n,r=!1){const{mixins:s,extends:i}=e;i&&Ws(t,i,n,!0),s&&s.forEach(o=>Ws(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const a=xd[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const xd={data:Oa,props:La,emits:La,methods:Ir,computed:Ir,beforeCreate:De,created:De,beforeMount:De,mounted:De,beforeUpdate:De,updated:De,beforeDestroy:De,beforeUnmount:De,destroyed:De,unmounted:De,activated:De,deactivated:De,errorCaptured:De,serverPrefetch:De,components:Ir,directives:Ir,watch:Dd,provide:Oa,inject:Vd};function Oa(t,e){return e?t?function(){return Pe(J(t)?t.call(this,this):t,J(e)?e.call(this,this):e)}:e:t}function Vd(t,e){return Ir(Yi(t),Yi(e))}function Yi(t){if(K(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function De(t,e){return t?[...new Set([].concat(t,e))]:e}function Ir(t,e){return t?Pe(Object.create(null),t,e):e}function La(t,e){return t?K(t)&&K(e)?[...new Set([...t,...e])]:Pe(Object.create(null),Va(t),Va(e??{})):e}function Dd(t,e){if(!t)return e;if(!e)return t;const n=Pe(Object.create(null),t);for(const r in e)n[r]=De(t[r],e[r]);return n}function lu(){return{app:null,config:{isNativeTag:Rl,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Od=0;function Ld(t,e){return function(r,s=null){J(r)||(r=Pe({},r)),s!=null&&!pe(s)&&(s=null);const i=lu(),o=new WeakSet,a=[];let c=!1;const l=i.app={_uid:Od++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:bg,get config(){return i.config},set config(u){},use(u,...f){return o.has(u)||(u&&J(u.install)?(o.add(u),u.install(l,...f)):J(u)&&(o.add(u),u(l,...f))),l},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),l},component(u,f){return f?(i.components[u]=f,l):i.components[u]},directive(u,f){return f?(i.directives[u]=f,l):i.directives[u]},mount(u,f,b){if(!c){const d=l._ceVNode||On(r,s);return d.appContext=i,b===!0?b="svg":b===!1&&(b=void 0),t(d,u,b),c=!0,l._container=u,u.__vue_app__=l,ei(d.component)}},onUnmount(u){a.push(u)},unmount(){c&&(Tt(a,l._instance,16),t(null,l._container),delete l._container.__vue_app__)},provide(u,f){return i.provides[u]=f,l},runWithContext(u){const f=jn;jn=l;try{return u()}finally{jn=f}}};return l}}let jn=null;function Bd(t,e){if(Be){let n=Be.provides;const r=Be.parent&&Be.parent.provides;r===n&&(n=Be.provides=Object.create(r)),n[t]=e}}function Es(t,e,n=!1){const r=ug();if(r||jn){let s=jn?jn._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return n&&J(e)?e.call(r&&r.proxy):e}}const Wd=Symbol.for("v-scx"),Pd=()=>Es(Wd);function Ai(t,e,n){return uu(t,e,n)}function uu(t,e,n=ae){const{immediate:r,deep:s,flush:i,once:o}=n,a=Pe({},n),c=e&&r||!e&&i!=="post";let l;if(Gr){if(i==="sync"){const d=Pd();l=d.__watcherHandles||(d.__watcherHandles=[])}else if(!c){const d=()=>{};return d.stop=wt,d.resume=wt,d.pause=wt,d}}const u=Be;a.call=(d,A,S)=>Tt(d,u,A,S);let f=!1;i==="post"?a.scheduler=d=>{Je(d,u&&u.suspense)}:i!=="sync"&&(f=!0,a.scheduler=(d,A)=>{A?d():Eo(d)}),a.augmentJob=d=>{e&&(d.flags|=4),f&&(d.flags|=2,u&&(d.id=u.uid,d.i=u))};const b=sd(t,e,a);return Gr&&(l?l.push(b):c&&b()),b}function _d(t,e,n){const r=this.proxy,s=ve(t)?t.includes(".")?fu(r,t):()=>r[t]:t.bind(r,r);let i;J(e)?i=e:(i=e.handler,n=e);const o=ts(this),a=uu(s,i.bind(r),n);return o(),a}function fu(t,e){const n=e.split(".");return()=>{let r=t;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}const Ud=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${un(e)}Modifiers`]||t[`${mn(e)}Modifiers`];function kd(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||ae;let s=n;const i=e.startsWith("update:"),o=i&&Ud(r,e.slice(7));o&&(o.trim&&(s=n.map(u=>ve(u)?u.trim():u)),o.number&&(s=n.map(ho)));let a,c=r[a=di(e)]||r[a=di(un(e))];!c&&i&&(c=r[a=di(mn(e))]),c&&Tt(c,t,6,s);const l=r[a+"Once"];if(l){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Tt(l,t,6,s)}}const Fd=new WeakMap;function hu(t,e,n=!1){const r=n?Fd:e.emitsCache,s=r.get(t);if(s!==void 0)return s;const i=t.emits;let o={},a=!1;if(!J(t)){const c=l=>{const u=hu(l,e,!0);u&&(a=!0,Pe(o,u))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!a?(pe(t)&&r.set(t,null),null):(K(i)?i.forEach(c=>o[c]=null):Pe(o,i),pe(t)&&r.set(t,o),o)}function Qs(t,e){return!t||!Ks(e)?!1:(e=e.slice(2).replace(/Once$/,""),te(t,e[0].toLowerCase()+e.slice(1))||te(t,mn(e))||te(t,e))}function Ba(t){const{type:e,vnode:n,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:c,render:l,renderCache:u,props:f,data:b,setupState:d,ctx:A,inheritAttrs:S}=t,W=Ls(t);let L,G;try{if(n.shapeFlag&4){const D=s||r,U=D;L=It(l.call(U,D,u,f,d,b,A)),G=a}else{const D=e;L=It(D.length>1?D(f,{attrs:a,slots:o,emit:c}):D(f,null)),G=e.props?a:Zd(a)}}catch(D){Or.length=0,js(D,t,1),L=On(er)}let _=L;if(G&&S!==!1){const D=Object.keys(G),{shapeFlag:U}=_;D.length&&U&7&&(i&&D.some(lo)&&(G=Gd(G,i)),_=tr(_,G,!1,!0))}return n.dirs&&(_=tr(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(n.dirs):n.dirs),n.transition&&wo(_,n.transition),L=_,Ls(W),L}const Zd=t=>{let e;for(const n in t)(n==="class"||n==="style"||Ks(n))&&((e||(e={}))[n]=t[n]);return e},Gd=(t,e)=>{const n={};for(const r in t)(!lo(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function Md(t,e,n){const{props:r,children:s,component:i}=t,{props:o,children:a,patchFlag:c}=e,l=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?Wa(r,o,l):!!o;if(c&8){const u=e.dynamicProps;for(let f=0;f<u.length;f++){const b=u[f];if(o[b]!==r[b]&&!Qs(l,b))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Wa(r,o,l):!0:!!o;return!1}function Wa(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==t[i]&&!Qs(n,i))return!0}return!1}function Yd({vnode:t,parent:e},n){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=n,e=e.parent;else break}}const du={},gu=()=>Object.create(du),pu=t=>Object.getPrototypeOf(t)===du;function Kd(t,e,n,r=!1){const s={},i=gu();t.propsDefaults=Object.create(null),mu(t,e,s,i);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=r?s:Hh(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function Jd(t,e,n,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=t,a=oe(s),[c]=t.propsOptions;let l=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let f=0;f<u.length;f++){let b=u[f];if(Qs(t.emitsOptions,b))continue;const d=e[b];if(c)if(te(i,b))d!==i[b]&&(i[b]=d,l=!0);else{const A=un(b);s[A]=Ki(c,a,A,d,t,!1)}else d!==i[b]&&(i[b]=d,l=!0)}}}else{mu(t,e,s,i)&&(l=!0);let u;for(const f in a)(!e||!te(e,f)&&((u=mn(f))===f||!te(e,u)))&&(c?n&&(n[f]!==void 0||n[u]!==void 0)&&(s[f]=Ki(c,a,f,void 0,t,!0)):delete s[f]);if(i!==a)for(const f in i)(!e||!te(e,f))&&(delete i[f],l=!0)}l&&kt(t.attrs,"set","")}function mu(t,e,n,r){const[s,i]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(Rr(c))continue;const l=e[c];let u;s&&te(s,u=un(c))?!i||!i.includes(u)?n[u]=l:(a||(a={}))[u]=l:Qs(t.emitsOptions,c)||(!(c in r)||l!==r[c])&&(r[c]=l,o=!0)}if(i){const c=oe(n),l=a||ae;for(let u=0;u<i.length;u++){const f=i[u];n[f]=Ki(s,c,f,l[f],t,!te(l,f))}}return o}function Ki(t,e,n,r,s,i){const o=t[n];if(o!=null){const a=te(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&J(c)){const{propsDefaults:l}=s;if(n in l)r=l[n];else{const u=ts(s);r=l[n]=c.call(null,e),u()}}else r=c;s.ce&&s.ce._setProp(n,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===mn(n))&&(r=!0))}return r}const $d=new WeakMap;function bu(t,e,n=!1){const r=n?$d:e.propsCache,s=r.get(t);if(s)return s;const i=t.props,o={},a=[];let c=!1;if(!J(t)){const u=f=>{c=!0;const[b,d]=bu(f,e,!0);Pe(o,b),d&&a.push(...d)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!c)return pe(t)&&r.set(t,$n),$n;if(K(i))for(let u=0;u<i.length;u++){const f=un(i[u]);Pa(f)&&(o[f]=ae)}else if(i)for(const u in i){const f=un(u);if(Pa(f)){const b=i[u],d=o[f]=K(b)||J(b)?{type:b}:Pe({},b),A=d.type;let S=!1,W=!0;if(K(A))for(let L=0;L<A.length;++L){const G=A[L],_=J(G)&&G.name;if(_==="Boolean"){S=!0;break}else _==="String"&&(W=!1)}else S=J(A)&&A.name==="Boolean";d[0]=S,d[1]=W,(S||te(d,"default"))&&a.push(f)}}const l=[o,a];return pe(t)&&r.set(t,l),l}function Pa(t){return t[0]!=="$"&&!Rr(t)}const No=t=>t==="_"||t==="_ctx"||t==="$stable",Ro=t=>K(t)?t.map(It):[It(t)],Xd=(t,e,n)=>{if(e._n)return e;const r=ld((...s)=>Ro(e(...s)),n);return r._c=!1,r},yu=(t,e,n)=>{const r=t._ctx;for(const s in t){if(No(s))continue;const i=t[s];if(J(i))e[s]=Xd(s,i,r);else if(i!=null){const o=Ro(i);e[s]=()=>o}}},Au=(t,e)=>{const n=Ro(e);t.slots.default=()=>n},vu=(t,e,n)=>{for(const r in e)(n||!No(r))&&(t[r]=e[r])},zd=(t,e,n)=>{const r=t.slots=gu();if(t.vnode.shapeFlag&32){const s=e._;s?(vu(r,e,n),n&&Ol(r,"_",s,!0)):yu(e,r)}else e&&Au(t,e)},jd=(t,e,n)=>{const{vnode:r,slots:s}=t;let i=!0,o=ae;if(r.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:vu(s,e,n):(i=!e.$stable,yu(e,s)),o=e}else e&&(Au(t,e),o={default:1});if(i)for(const a in s)!No(a)&&o[a]==null&&delete s[a]},Je=tg;function Hd(t){return Qd(t)}function Qd(t,e){const n=Xs();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:c,setText:l,setElementText:u,parentNode:f,nextSibling:b,setScopeId:d=wt,insertStaticContent:A}=t,S=(h,m,v,R=null,I=null,E=null,V=void 0,T=null,C=!!m.dynamicChildren)=>{if(h===m)return;h&&!yr(h,m)&&(R=ls(h),mt(h,I,E,!0),h=null),m.patchFlag===-2&&(C=!1,m.dynamicChildren=null);const{type:w,ref:Z,shapeFlag:O}=m;switch(w){case qs:W(h,m,v,R);break;case er:L(h,m,v,R);break;case Si:h==null&&G(m,v,R,V);break;case He:Lt(h,m,v,R,I,E,V,T,C);break;default:O&1?U(h,m,v,R,I,E,V,T,C):O&6?as(h,m,v,R,I,E,V,T,C):(O&64||O&128)&&w.process(h,m,v,R,I,E,V,T,C,pr)}Z!=null&&I?xr(Z,h&&h.ref,E,m||h,!m):Z==null&&h&&h.ref!=null&&xr(h.ref,null,E,h,!0)},W=(h,m,v,R)=>{if(h==null)r(m.el=a(m.children),v,R);else{const I=m.el=h.el;m.children!==h.children&&l(I,m.children)}},L=(h,m,v,R)=>{h==null?r(m.el=c(m.children||""),v,R):m.el=h.el},G=(h,m,v,R)=>{[h.el,h.anchor]=A(h.children,m,v,R,h.el,h.anchor)},_=({el:h,anchor:m},v,R)=>{let I;for(;h&&h!==m;)I=b(h),r(h,v,R),h=I;r(m,v,R)},D=({el:h,anchor:m})=>{let v;for(;h&&h!==m;)v=b(h),s(h),h=v;s(m)},U=(h,m,v,R,I,E,V,T,C)=>{if(m.type==="svg"?V="svg":m.type==="math"&&(V="mathml"),h==null)ie(m,v,R,I,E,V,T,C);else{const w=h.el&&h.el._isVueCE?h.el:null;try{w&&w._beginPatch(),Ot(h,m,I,E,V,T,C)}finally{w&&w._endPatch()}}},ie=(h,m,v,R,I,E,V,T)=>{let C,w;const{props:Z,shapeFlag:O,transition:F,dirs:M}=h;if(C=h.el=o(h.type,E,Z&&Z.is,Z),O&8?u(C,h.children):O&16&&ne(h.children,C,null,R,I,vi(h,E),V,T),M&&vn(h,null,R,"created"),j(C,h,h.scopeId,V,R),Z){for(const ue in Z)ue!=="value"&&!Rr(ue)&&i(C,ue,null,Z[ue],E,R);"value"in Z&&i(C,"value",null,Z.value,E),(w=Z.onVnodeBeforeMount)&&vt(w,R,h)}M&&vn(h,null,R,"beforeMount");const Q=qd(I,F);Q&&F.beforeEnter(C),r(C,m,v),((w=Z&&Z.onVnodeMounted)||Q||M)&&Je(()=>{w&&vt(w,R,h),Q&&F.enter(C),M&&vn(h,null,R,"mounted")},I)},j=(h,m,v,R,I)=>{if(v&&d(h,v),R)for(let E=0;E<R.length;E++)d(h,R[E]);if(I){let E=I.subTree;if(m===E||Eu(E.type)&&(E.ssContent===m||E.ssFallback===m)){const V=I.vnode;j(h,V,V.scopeId,V.slotScopeIds,I.parent)}}},ne=(h,m,v,R,I,E,V,T,C=0)=>{for(let w=C;w<h.length;w++){const Z=h[w]=T?sn(h[w]):It(h[w]);S(null,Z,m,v,R,I,E,V,T)}},Ot=(h,m,v,R,I,E,V)=>{const T=m.el=h.el;let{patchFlag:C,dynamicChildren:w,dirs:Z}=m;C|=h.patchFlag&16;const O=h.props||ae,F=m.props||ae;let M;if(v&&Sn(v,!1),(M=F.onVnodeBeforeUpdate)&&vt(M,v,m,h),Z&&vn(m,h,v,"beforeUpdate"),v&&Sn(v,!0),(O.innerHTML&&F.innerHTML==null||O.textContent&&F.textContent==null)&&u(T,""),w?je(h.dynamicChildren,w,T,v,R,vi(m,I),E):V||le(h,m,T,null,v,R,vi(m,I),E,!1),C>0){if(C&16)Qt(T,O,F,v,I);else if(C&2&&O.class!==F.class&&i(T,"class",null,F.class,I),C&4&&i(T,"style",O.style,F.style,I),C&8){const Q=m.dynamicProps;for(let ue=0;ue<Q.length;ue++){const re=Q[ue],_e=O[re],Ue=F[re];(Ue!==_e||re==="value")&&i(T,re,_e,Ue,I,v)}}C&1&&h.children!==m.children&&u(T,m.children)}else!V&&w==null&&Qt(T,O,F,v,I);((M=F.onVnodeUpdated)||Z)&&Je(()=>{M&&vt(M,v,m,h),Z&&vn(m,h,v,"updated")},R)},je=(h,m,v,R,I,E,V)=>{for(let T=0;T<m.length;T++){const C=h[T],w=m[T],Z=C.el&&(C.type===He||!yr(C,w)||C.shapeFlag&198)?f(C.el):v;S(C,w,Z,null,R,I,E,V,!0)}},Qt=(h,m,v,R,I)=>{if(m!==v){if(m!==ae)for(const E in m)!Rr(E)&&!(E in v)&&i(h,E,m[E],null,I,R);for(const E in v){if(Rr(E))continue;const V=v[E],T=m[E];V!==T&&E!=="value"&&i(h,E,T,V,I,R)}"value"in v&&i(h,"value",m.value,v.value,I)}},Lt=(h,m,v,R,I,E,V,T,C)=>{const w=m.el=h?h.el:a(""),Z=m.anchor=h?h.anchor:a("");let{patchFlag:O,dynamicChildren:F,slotScopeIds:M}=m;M&&(T=T?T.concat(M):M),h==null?(r(w,v,R),r(Z,v,R),ne(m.children||[],v,Z,I,E,V,T,C)):O>0&&O&64&&F&&h.dynamicChildren?(je(h.dynamicChildren,F,v,I,E,V,T),(m.key!=null||I&&m===I.subTree)&&Su(h,m,!0)):le(h,m,v,Z,I,E,V,T,C)},as=(h,m,v,R,I,E,V,T,C)=>{m.slotScopeIds=T,h==null?m.shapeFlag&512?I.ctx.activate(m,v,R,V,C):fi(m,v,R,I,E,V,C):ba(h,m,C)},fi=(h,m,v,R,I,E,V)=>{const T=h.component=lg(h,R,I);if(su(h)&&(T.ctx.renderer=pr),fg(T,!1,V),T.asyncDep){if(I&&I.registerDep(T,Ve,V),!h.el){const C=T.subTree=On(er);L(null,C,m,v),h.placeholder=C.el}}else Ve(T,h,m,v,I,E,V)},ba=(h,m,v)=>{const R=m.component=h.component;if(Md(h,m,v))if(R.asyncDep&&!R.asyncResolved){me(R,m,v);return}else R.next=m,R.update();else m.el=h.el,R.vnode=m},Ve=(h,m,v,R,I,E,V)=>{const T=()=>{if(h.isMounted){let{next:O,bu:F,u:M,parent:Q,vnode:ue}=h;{const yt=Iu(h);if(yt){O&&(O.el=ue.el,me(h,O,V)),yt.asyncDep.then(()=>{h.isUnmounted||T()});return}}let re=O,_e;Sn(h,!1),O?(O.el=ue.el,me(h,O,V)):O=ue,F&&Is(F),(_e=O.props&&O.props.onVnodeBeforeUpdate)&&vt(_e,Q,O,ue),Sn(h,!0);const Ue=Ba(h),bt=h.subTree;h.subTree=Ue,S(bt,Ue,f(bt.el),ls(bt),h,I,E),O.el=Ue.el,re===null&&Yd(h,Ue.el),M&&Je(M,I),(_e=O.props&&O.props.onVnodeUpdated)&&Je(()=>vt(_e,Q,O,ue),I)}else{let O;const{el:F,props:M}=m,{bm:Q,m:ue,parent:re,root:_e,type:Ue}=h,bt=Vr(m);Sn(h,!1),Q&&Is(Q),!bt&&(O=M&&M.onVnodeBeforeMount)&&vt(O,re,m),Sn(h,!0);{_e.ce&&_e.ce._def.shadowRoot!==!1&&_e.ce._injectChildStyle(Ue);const yt=h.subTree=Ba(h);S(null,yt,v,R,h,I,E),m.el=yt.el}if(ue&&Je(ue,I),!bt&&(O=M&&M.onVnodeMounted)){const yt=m;Je(()=>vt(O,re,yt),I)}(m.shapeFlag&256||re&&Vr(re.vnode)&&re.vnode.shapeFlag&256)&&h.a&&Je(h.a,I),h.isMounted=!0,m=v=R=null}};h.scope.on();const C=h.effect=new Pl(T);h.scope.off();const w=h.update=C.run.bind(C),Z=h.job=C.runIfDirty.bind(C);Z.i=h,Z.id=h.uid,C.scheduler=()=>Eo(Z),Sn(h,!0),w()},me=(h,m,v)=>{m.component=h;const R=h.vnode.props;h.vnode=m,h.next=null,Jd(h,m.props,R,v),jd(h,m.children,v),Kt(),Ra(h),Jt()},le=(h,m,v,R,I,E,V,T,C=!1)=>{const w=h&&h.children,Z=h?h.shapeFlag:0,O=m.children,{patchFlag:F,shapeFlag:M}=m;if(F>0){if(F&128){cs(w,O,v,R,I,E,V,T,C);return}else if(F&256){yn(w,O,v,R,I,E,V,T,C);return}}M&8?(Z&16&&gr(w,I,E),O!==w&&u(v,O)):Z&16?M&16?cs(w,O,v,R,I,E,V,T,C):gr(w,I,E,!0):(Z&8&&u(v,""),M&16&&ne(O,v,R,I,E,V,T,C))},yn=(h,m,v,R,I,E,V,T,C)=>{h=h||$n,m=m||$n;const w=h.length,Z=m.length,O=Math.min(w,Z);let F;for(F=0;F<O;F++){const M=m[F]=C?sn(m[F]):It(m[F]);S(h[F],M,v,null,I,E,V,T,C)}w>Z?gr(h,I,E,!0,!1,O):ne(m,v,R,I,E,V,T,C,O)},cs=(h,m,v,R,I,E,V,T,C)=>{let w=0;const Z=m.length;let O=h.length-1,F=Z-1;for(;w<=O&&w<=F;){const M=h[w],Q=m[w]=C?sn(m[w]):It(m[w]);if(yr(M,Q))S(M,Q,v,null,I,E,V,T,C);else break;w++}for(;w<=O&&w<=F;){const M=h[O],Q=m[F]=C?sn(m[F]):It(m[F]);if(yr(M,Q))S(M,Q,v,null,I,E,V,T,C);else break;O--,F--}if(w>O){if(w<=F){const M=F+1,Q=M<Z?m[M].el:R;for(;w<=F;)S(null,m[w]=C?sn(m[w]):It(m[w]),v,Q,I,E,V,T,C),w++}}else if(w>F)for(;w<=O;)mt(h[w],I,E,!0),w++;else{const M=w,Q=w,ue=new Map;for(w=Q;w<=F;w++){const Ke=m[w]=C?sn(m[w]):It(m[w]);Ke.key!=null&&ue.set(Ke.key,w)}let re,_e=0;const Ue=F-Q+1;let bt=!1,yt=0;const mr=new Array(Ue);for(w=0;w<Ue;w++)mr[w]=0;for(w=M;w<=O;w++){const Ke=h[w];if(_e>=Ue){mt(Ke,I,E,!0);continue}let At;if(Ke.key!=null)At=ue.get(Ke.key);else for(re=Q;re<=F;re++)if(mr[re-Q]===0&&yr(Ke,m[re])){At=re;break}At===void 0?mt(Ke,I,E,!0):(mr[At-Q]=w+1,At>=yt?yt=At:bt=!0,S(Ke,m[At],v,null,I,E,V,T,C),_e++)}const va=bt?eg(mr):$n;for(re=va.length-1,w=Ue-1;w>=0;w--){const Ke=Q+w,At=m[Ke],Sa=m[Ke+1],Ia=Ke+1<Z?Sa.el||Sa.placeholder:R;mr[w]===0?S(null,At,v,Ia,I,E,V,T,C):bt&&(re<0||w!==va[re]?An(At,v,Ia,2):re--)}}},An=(h,m,v,R,I=null)=>{const{el:E,type:V,transition:T,children:C,shapeFlag:w}=h;if(w&6){An(h.component.subTree,m,v,R);return}if(w&128){h.suspense.move(m,v,R);return}if(w&64){V.move(h,m,v,pr);return}if(V===He){r(E,m,v);for(let O=0;O<C.length;O++)An(C[O],m,v,R);r(h.anchor,m,v);return}if(V===Si){_(h,m,v);return}if(R!==2&&w&1&&T)if(R===0)T.beforeEnter(E),r(E,m,v),Je(()=>T.enter(E),I);else{const{leave:O,delayLeave:F,afterLeave:M}=T,Q=()=>{h.ctx.isUnmounted?s(E):r(E,m,v)},ue=()=>{E._isLeaving&&E[hd](!0),O(E,()=>{Q(),M&&M()})};F?F(E,Q,ue):ue()}else r(E,m,v)},mt=(h,m,v,R=!1,I=!1)=>{const{type:E,props:V,ref:T,children:C,dynamicChildren:w,shapeFlag:Z,patchFlag:O,dirs:F,cacheIndex:M}=h;if(O===-2&&(I=!1),T!=null&&(Kt(),xr(T,null,v,h,!0),Jt()),M!=null&&(m.renderCache[M]=void 0),Z&256){m.ctx.deactivate(h);return}const Q=Z&1&&F,ue=!Vr(h);let re;if(ue&&(re=V&&V.onVnodeBeforeUnmount)&&vt(re,m,h),Z&6)vh(h.component,v,R);else{if(Z&128){h.suspense.unmount(v,R);return}Q&&vn(h,null,m,"beforeUnmount"),Z&64?h.type.remove(h,m,v,pr,R):w&&!w.hasOnce&&(E!==He||O>0&&O&64)?gr(w,m,v,!1,!0):(E===He&&O&384||!I&&Z&16)&&gr(C,m,v),R&&ya(h)}(ue&&(re=V&&V.onVnodeUnmounted)||Q)&&Je(()=>{re&&vt(re,m,h),Q&&vn(h,null,m,"unmounted")},v)},ya=h=>{const{type:m,el:v,anchor:R,transition:I}=h;if(m===He){Ah(v,R);return}if(m===Si){D(h);return}const E=()=>{s(v),I&&!I.persisted&&I.afterLeave&&I.afterLeave()};if(h.shapeFlag&1&&I&&!I.persisted){const{leave:V,delayLeave:T}=I,C=()=>V(v,E);T?T(h.el,E,C):C()}else E()},Ah=(h,m)=>{let v;for(;h!==m;)v=b(h),s(h),h=v;s(m)},vh=(h,m,v)=>{const{bum:R,scope:I,job:E,subTree:V,um:T,m:C,a:w}=h;_a(C),_a(w),R&&Is(R),I.stop(),E&&(E.flags|=8,mt(V,h,m,v)),T&&Je(T,m),Je(()=>{h.isUnmounted=!0},m)},gr=(h,m,v,R=!1,I=!1,E=0)=>{for(let V=E;V<h.length;V++)mt(h[V],m,v,R,I)},ls=h=>{if(h.shapeFlag&6)return ls(h.component.subTree);if(h.shapeFlag&128)return h.suspense.next();const m=b(h.anchor||h.el),v=m&&m[ud];return v?b(v):m};let hi=!1;const Aa=(h,m,v)=>{h==null?m._vnode&&mt(m._vnode,null,null,!0):S(m._vnode||null,h,m,null,null,null,v),m._vnode=h,hi||(hi=!0,Ra(),eu(),hi=!1)},pr={p:S,um:mt,m:An,r:ya,mt:fi,mc:ne,pc:le,pbc:je,n:ls,o:t};return{render:Aa,hydrate:void 0,createApp:Ld(Aa)}}function vi({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Sn({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function qd(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Su(t,e,n=!1){const r=t.children,s=e.children;if(K(r)&&K(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=sn(s[i]),a.el=o.el),!n&&a.patchFlag!==-2&&Su(o,a)),a.type===qs&&a.patchFlag!==-1&&(a.el=o.el),a.type===er&&!a.el&&(a.el=o.el)}}function eg(t){const e=t.slice(),n=[0];let r,s,i,o,a;const c=t.length;for(r=0;r<c;r++){const l=t[r];if(l!==0){if(s=n[n.length-1],t[s]<l){e[r]=s,n.push(r);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<l?i=a+1:o=a;l<t[n[i]]&&(i>0&&(e[r]=n[i-1]),n[i]=r)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}function Iu(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Iu(e)}function _a(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Eu=t=>t.__isSuspense;function tg(t,e){e&&e.pendingBranch?K(t)?e.effects.push(...t):e.effects.push(t):cd(t)}const He=Symbol.for("v-fgt"),qs=Symbol.for("v-txt"),er=Symbol.for("v-cmt"),Si=Symbol.for("v-stc"),Or=[];let $e=null;function Wt(t=!1){Or.push($e=t?null:[])}function ng(){Or.pop(),$e=Or[Or.length-1]||null}let Zr=1;function Ua(t,e=!1){Zr+=t,t<0&&$e&&e&&($e.hasOnce=!0)}function rg(t){return t.dynamicChildren=Zr>0?$e||$n:null,ng(),Zr>0&&$e&&$e.push(t),t}function Pt(t,e,n,r,s,i){return rg(Oe(t,e,n,r,s,i,!0))}function wu(t){return t?t.__v_isVNode===!0:!1}function yr(t,e){return t.type===e.type&&t.key===e.key}const Nu=({key:t})=>t??null,ws=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?ve(t)||We(t)||J(t)?{i:Qe,r:t,k:e,f:!!n}:t:null);function Oe(t,e=null,n=null,r=0,s=null,i=t===He?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Nu(e),ref:e&&ws(e),scopeId:nu,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Qe};return a?(Co(c,n),i&128&&t.normalize(c)):n&&(c.shapeFlag|=ve(n)?8:16),Zr>0&&!o&&$e&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&$e.push(c),c}const On=sg;function sg(t,e=null,n=null,r=0,s=null,i=!1){if((!t||t===Nd)&&(t=er),wu(t)){const a=tr(t,e,!0);return n&&Co(a,n),Zr>0&&!i&&$e&&(a.shapeFlag&6?$e[$e.indexOf(t)]=a:$e.push(a)),a.patchFlag=-2,a}if(pg(t)&&(t=t.__vccOpts),e){e=ig(e);let{class:a,style:c}=e;a&&!ve(a)&&(e.class=po(a)),pe(c)&&(Io(c)&&!K(c)&&(c=Pe({},c)),e.style=go(c))}const o=ve(t)?1:Eu(t)?128:fd(t)?64:pe(t)?4:J(t)?2:0;return Oe(t,e,n,r,s,o,i,!0)}function ig(t){return t?Io(t)||pu(t)?Pe({},t):t:null}function tr(t,e,n=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:c}=t,l=e?og(s||{},e):s,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:l,key:l&&Nu(l),ref:e&&e.ref?n&&i?K(i)?i.concat(ws(e)):[i,ws(e)]:ws(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==He?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&tr(t.ssContent),ssFallback:t.ssFallback&&tr(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&r&&wo(u,c.clone(u)),u}function Ru(t=" ",e=0){return On(qs,null,t,e)}function It(t){return t==null||typeof t=="boolean"?On(er):K(t)?On(He,null,t.slice()):wu(t)?sn(t):On(qs,null,String(t))}function sn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:tr(t)}function Co(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(K(e))n=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),Co(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!pu(e)?e._ctx=Qe:s===3&&Qe&&(Qe.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else J(e)?(e={default:e,_ctx:Qe},n=32):(e=String(e),r&64?(n=16,e=[Ru(e)]):n=8);t.children=e,t.shapeFlag|=n}function og(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=po([e.class,r.class]));else if(s==="style")e.style=go([e.style,r.style]);else if(Ks(s)){const i=e[s],o=r[s];o&&i!==o&&!(K(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function vt(t,e,n,r=null){Tt(t,e,7,[n,r])}const ag=lu();let cg=0;function lg(t,e,n){const r=t.type,s=(e?e.appContext:t.appContext)||ag,i={uid:cg++,vnode:t,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Dh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:bu(r,s),emitsOptions:hu(r,s),emit:null,emitted:null,propsDefaults:ae,inheritAttrs:r.inheritAttrs,ctx:ae,data:ae,props:ae,attrs:ae,slots:ae,refs:ae,setupState:ae,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=kd.bind(null,i),t.ce&&t.ce(i),i}let Be=null;const ug=()=>Be||Qe;let Ps,Ji;{const t=Xs(),e=(n,r)=>{let s;return(s=t[n])||(s=t[n]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};Ps=e("__VUE_INSTANCE_SETTERS__",n=>Be=n),Ji=e("__VUE_SSR_SETTERS__",n=>Gr=n)}const ts=t=>{const e=Be;return Ps(t),t.scope.on(),()=>{t.scope.off(),Ps(e)}},ka=()=>{Be&&Be.scope.off(),Ps(null)};function Cu(t){return t.vnode.shapeFlag&4}let Gr=!1;function fg(t,e=!1,n=!1){e&&Ji(e);const{props:r,children:s}=t.vnode,i=Cu(t);Kd(t,r,i,e),zd(t,s,n||e);const o=i?hg(t,e):void 0;return e&&Ji(!1),o}function hg(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Rd);const{setup:r}=n;if(r){Kt();const s=t.setupContext=r.length>1?gg(t):null,i=ts(t),o=es(r,t,0,[t.props,s]),a=Tl(o);if(Jt(),i(),(a||t.sp)&&!Vr(t)&&ru(t),a){if(o.then(ka,ka),e)return o.then(c=>{Fa(t,c)}).catch(c=>{js(c,t,0)});t.asyncDep=o}else Fa(t,o)}else Tu(t)}function Fa(t,e,n){J(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:pe(e)&&(t.setupState=Hl(e)),Tu(t)}function Tu(t,e,n){const r=t.type;t.render||(t.render=r.render||wt);{const s=ts(t);Kt();try{Cd(t)}finally{Jt(),s()}}}const dg={get(t,e){return Re(t,"get",""),t[e]}};function gg(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,dg),slots:t.slots,emit:t.emit,expose:e}}function ei(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Hl(Qh(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Dr)return Dr[n](t)},has(e,n){return n in e||n in Dr}})):t.proxy}function pg(t){return J(t)&&"__vccOpts"in t}const mg=(t,e)=>nd(t,e,Gr),bg="3.5.25";let $i;const Za=typeof window<"u"&&window.trustedTypes;if(Za)try{$i=Za.createPolicy("vue",{createHTML:t=>t})}catch{}const xu=$i?t=>$i.createHTML(t):t=>t,yg="http://www.w3.org/2000/svg",Ag="http://www.w3.org/1998/Math/MathML",_t=typeof document<"u"?document:null,Ga=_t&&_t.createElement("template"),vg={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const s=e==="svg"?_t.createElementNS(yg,t):e==="mathml"?_t.createElementNS(Ag,t):n?_t.createElement(t,{is:n}):_t.createElement(t);return t==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:t=>_t.createTextNode(t),createComment:t=>_t.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>_t.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,s,i){const o=n?n.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{Ga.innerHTML=xu(r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t);const a=Ga.content;if(r==="svg"||r==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},Sg=Symbol("_vtc");function Ig(t,e,n){const r=t[Sg];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Ma=Symbol("_vod"),Eg=Symbol("_vsh"),wg=Symbol(""),Ng=/(?:^|;)\s*display\s*:/;function Rg(t,e,n){const r=t.style,s=ve(n);let i=!1;if(n&&!s){if(e)if(ve(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&Ns(r,a,"")}else for(const o in e)n[o]==null&&Ns(r,o,"");for(const o in n)o==="display"&&(i=!0),Ns(r,o,n[o])}else if(s){if(e!==n){const o=r[wg];o&&(n+=";"+o),r.cssText=n,i=Ng.test(n)}}else e&&t.removeAttribute("style");Ma in t&&(t[Ma]=i?r.display:"",t[Eg]&&(r.display="none"))}const Ya=/\s*!important$/;function Ns(t,e,n){if(K(n))n.forEach(r=>Ns(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=Cg(t,e);Ya.test(n)?t.setProperty(mn(r),n.replace(Ya,""),"important"):t[r]=n}}const Ka=["Webkit","Moz","ms"],Ii={};function Cg(t,e){const n=Ii[e];if(n)return n;let r=un(e);if(r!=="filter"&&r in t)return Ii[e]=r;r=Dl(r);for(let s=0;s<Ka.length;s++){const i=Ka[s]+r;if(i in t)return Ii[e]=i}return e}const Ja="http://www.w3.org/1999/xlink";function $a(t,e,n,r,s,i=Vh(e)){r&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Ja,e.slice(6,e.length)):t.setAttributeNS(Ja,e,n):n==null||i&&!Ll(n)?t.removeAttribute(e):t.setAttribute(e,i?"":pn(n)?String(n):n)}function Xa(t,e,n,r,s){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?xu(n):n);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?t.getAttribute("value")||"":t.value,c=n==null?t.type==="checkbox"?"on":"":String(n);(a!==c||!("_value"in t))&&(t.value=c),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const a=typeof t[e];a==="boolean"?n=Ll(n):n==null&&a==="string"?(n="",o=!0):a==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(s||e)}function Gn(t,e,n,r){t.addEventListener(e,n,r)}function Tg(t,e,n,r){t.removeEventListener(e,n,r)}const za=Symbol("_vei");function xg(t,e,n,r,s=null){const i=t[za]||(t[za]={}),o=i[e];if(r&&o)o.value=r;else{const[a,c]=Vg(e);if(r){const l=i[e]=Lg(r,s);Gn(t,a,l,c)}else o&&(Tg(t,a,o,c),i[e]=void 0)}}const ja=/(?:Once|Passive|Capture)$/;function Vg(t){let e;if(ja.test(t)){e={};let r;for(;r=t.match(ja);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):mn(t.slice(2)),e]}let Ei=0;const Dg=Promise.resolve(),Og=()=>Ei||(Dg.then(()=>Ei=0),Ei=Date.now());function Lg(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;Tt(Bg(r,n.value),e,5,[r])};return n.value=t,n.attached=Og(),n}function Bg(t,e){if(K(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Ha=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Wg=(t,e,n,r,s,i)=>{const o=s==="svg";e==="class"?Ig(t,r,o):e==="style"?Rg(t,n,r):Ks(e)?lo(e)||xg(t,e,n,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Pg(t,e,r,o))?(Xa(t,e,r),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&$a(t,e,r,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!ve(r))?Xa(t,un(e),r,i,e):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),$a(t,e,r,o))};function Pg(t,e,n,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&Ha(e)&&J(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&t.tagName==="IFRAME"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Ha(e)&&ve(n)?!1:e in t}const Qa=t=>{const e=t.props["onUpdate:modelValue"]||!1;return K(e)?n=>Is(e,n):e};function _g(t){t.target.composing=!0}function qa(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const wi=Symbol("_assign");function ec(t,e,n){return e&&(t=t.trim()),n&&(t=ho(t)),t}const tc={created(t,{modifiers:{lazy:e,trim:n,number:r}},s){t[wi]=Qa(s);const i=r||s.props&&s.props.type==="number";Gn(t,e?"change":"input",o=>{o.target.composing||t[wi](ec(t.value,n,i))}),(n||i)&&Gn(t,"change",()=>{t.value=ec(t.value,n,i)}),e||(Gn(t,"compositionstart",_g),Gn(t,"compositionend",qa),Gn(t,"change",qa))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:r,trim:s,number:i}},o){if(t[wi]=Qa(o),t.composing)return;const a=(i||t.type==="number")&&!/^0\d/.test(t.value)?ho(t.value):t.value,c=e??"";a!==c&&(document.activeElement===t&&t.type!=="range"&&(r&&e===n||s&&t.value.trim()===c)||(t.value=c))}},Ug={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ds=(t,e)=>{const n=t._withKeys||(t._withKeys={}),r=e.join(".");return n[r]||(n[r]=(s=>{if(!("key"in s))return;const i=mn(s.key);if(e.some(o=>o===i||Ug[o]===i))return t(s)}))},kg=Pe({patchProp:Wg},vg);let nc;function Fg(){return nc||(nc=Hd(kg))}const Zg=((...t)=>{const e=Fg().createApp(...t),{mount:n}=e;return e.mount=r=>{const s=Mg(r);if(!s)return;const i=e._component;!J(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=n(s,!1,Gg(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e});function Gg(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Mg(t){return ve(t)?document.querySelector(t):t}var z;(function(t){t[t.Canceled=1]="Canceled",t[t.Unknown=2]="Unknown",t[t.InvalidArgument=3]="InvalidArgument",t[t.DeadlineExceeded=4]="DeadlineExceeded",t[t.NotFound=5]="NotFound",t[t.AlreadyExists=6]="AlreadyExists",t[t.PermissionDenied=7]="PermissionDenied",t[t.ResourceExhausted=8]="ResourceExhausted",t[t.FailedPrecondition=9]="FailedPrecondition",t[t.Aborted=10]="Aborted",t[t.OutOfRange=11]="OutOfRange",t[t.Unimplemented=12]="Unimplemented",t[t.Internal=13]="Internal",t[t.Unavailable=14]="Unavailable",t[t.DataLoss=15]="DataLoss",t[t.Unauthenticated=16]="Unauthenticated"})(z||(z={}));function To(t,e){return t!==null&&typeof t=="object"&&"$typeName"in t&&typeof t.$typeName=="string"?e===void 0?!0:e.typeName===t.$typeName:!1}var y;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(y||(y={}));function Yg(){let t=0,e=0;for(let r=0;r<28;r+=7){let s=this.buf[this.pos++];if(t|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,(n&128)==0)return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let s=this.buf[this.pos++];if(e|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Ni(t,e,n){for(let i=0;i<28;i=i+7){const o=t>>>i,a=!(!(o>>>7)&&e==0),c=(a?o|128:o)&255;if(n.push(c),!a)return}const r=t>>>28&15|(e&7)<<4,s=e>>3!=0;if(n.push((s?r|128:r)&255),!!s){for(let i=3;i<31;i=i+7){const o=e>>>i,a=!!(o>>>7),c=(a?o|128:o)&255;if(n.push(c),!a)return}n.push(e>>>31&1)}}const Rs=4294967296;function rc(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,s=0;function i(o,a){const c=Number(t.slice(o,a));s*=n,r=r*n+c,r>=Rs&&(s=s+(r/Rs|0),r=r%Rs)}return i(-24,-18),i(-18,-12),i(-12,-6),i(-6),e?Du(r,s):xo(r,s)}function Kg(t,e){let n=xo(t,e);const r=n.hi&2147483648;r&&(n=Du(n.lo,n.hi));const s=Vu(n.lo,n.hi);return r?"-"+s:s}function Vu(t,e){if({lo:t,hi:e}=Jg(t,e),e<=2097151)return String(Rs*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,s=e>>16&65535;let i=n+r*6777216+s*6710656,o=r+s*8147497,a=s*2;const c=1e7;return i>=c&&(o+=Math.floor(i/c),i%=c),o>=c&&(a+=Math.floor(o/c),o%=c),a.toString()+sc(o)+sc(i)}function Jg(t,e){return{lo:t>>>0,hi:e>>>0}}function xo(t,e){return{lo:t|0,hi:e|0}}function Du(t,e){return e=~e,t?t=~t+1:e+=1,xo(t,e)}const sc=t=>{const e=String(t);return"0000000".slice(e.length)+e};function Xi(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function $g(){let t=this.buf[this.pos++],e=t&127;if((t&128)==0)return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,(t&128)==0)return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,(t&128)==0)return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,(t&128)==0)return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;(t&128)!==0&&n<10;n++)t=this.buf[this.pos++];if((t&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}var ic={};const ge=Xg();function Xg(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(!!globalThis.Deno||typeof process!="object"||typeof ic!="object"||ic.BUF_BIGINT_DISABLE!=="1")){const n=BigInt("-9223372036854775808"),r=BigInt("9223372036854775807"),s=BigInt("0"),i=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(o){const a=typeof o=="bigint"?o:BigInt(o);if(a>r||a<n)throw new Error(`invalid int64: ${o}`);return a},uParse(o){const a=typeof o=="bigint"?o:BigInt(o);if(a>i||a<s)throw new Error(`invalid uint64: ${o}`);return a},enc(o){return t.setBigInt64(0,this.parse(o),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(o){return t.setBigInt64(0,this.uParse(o),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(o,a){return t.setInt32(0,o,!0),t.setInt32(4,a,!0),t.getBigInt64(0,!0)},uDec(o,a){return t.setInt32(0,o,!0),t.setInt32(4,a,!0),t.getBigUint64(0,!0)}}}return{zero:"0",supported:!1,parse(n){return typeof n!="string"&&(n=n.toString()),oc(n),n},uParse(n){return typeof n!="string"&&(n=n.toString()),ac(n),n},enc(n){return typeof n!="string"&&(n=n.toString()),oc(n),rc(n)},uEnc(n){return typeof n!="string"&&(n=n.toString()),ac(n),rc(n)},dec(n,r){return Kg(n,r)},uDec(n,r){return Vu(n,r)}}}function oc(t){if(!/^-?[0-9]+$/.test(t))throw new Error("invalid int64: "+t)}function ac(t){if(!/^[0-9]+$/.test(t))throw new Error("invalid uint64: "+t)}function Ln(t,e){switch(t){case y.STRING:return"";case y.BOOL:return!1;case y.DOUBLE:case y.FLOAT:return 0;case y.INT64:case y.UINT64:case y.SFIXED64:case y.FIXED64:case y.SINT64:return e?"0":ge.zero;case y.BYTES:return new Uint8Array(0);default:return 0}}function zg(t,e){switch(t){case y.BOOL:return e===!1;case y.STRING:return e==="";case y.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}const Ou=2,Zt=Symbol.for("reflect unsafe local");function Lu(t,e){const n=t[e.localName].case;return n===void 0?n:e.fields.find(r=>r.localName===n)}function jg(t,e){const n=e.localName;if(e.oneof)return t[e.oneof.localName].case===n;if(e.presence!=Ou)return t[n]!==void 0&&Object.prototype.hasOwnProperty.call(t,n);switch(e.fieldKind){case"list":return t[n].length>0;case"map":return Object.keys(t[n]).length>0;case"scalar":return!zg(e.scalar,t[n]);case"enum":return t[n]!==e.enum.values[0].number}throw new Error("message field with implicit presence")}function Mr(t,e){return Object.prototype.hasOwnProperty.call(t,e)&&t[e]!==void 0}function Bu(t,e){if(e.oneof){const n=t[e.oneof.localName];return n.case===e.localName?n.value:void 0}return t[e.localName]}function Wu(t,e,n){e.oneof?t[e.oneof.localName]={case:e.localName,value:n}:t[e.localName]=n}function Hg(t,e){const n=e.localName;if(e.oneof){const r=e.oneof.localName;t[r].case===n&&(t[r]={case:void 0})}else if(e.presence!=Ou)delete t[n];else switch(e.fieldKind){case"map":t[n]={};break;case"list":t[n]=[];break;case"enum":t[n]=e.enum.values[0].number;break;case"scalar":t[n]=Ln(e.scalar,e.longAsString);break}}function hn(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function Vo(t,e){var n,r,s,i;if(hn(t)&&Zt in t&&"add"in t&&"field"in t&&typeof t.field=="function"){if(e!==void 0){const o=e,a=t.field();return o.listKind==a.listKind&&o.scalar===a.scalar&&((n=o.message)===null||n===void 0?void 0:n.typeName)===((r=a.message)===null||r===void 0?void 0:r.typeName)&&((s=o.enum)===null||s===void 0?void 0:s.typeName)===((i=a.enum)===null||i===void 0?void 0:i.typeName)}return!0}return!1}function Do(t,e){var n,r,s,i;if(hn(t)&&Zt in t&&"has"in t&&"field"in t&&typeof t.field=="function"){if(e!==void 0){const o=e,a=t.field();return o.mapKey===a.mapKey&&o.mapKind==a.mapKind&&o.scalar===a.scalar&&((n=o.message)===null||n===void 0?void 0:n.typeName)===((r=a.message)===null||r===void 0?void 0:r.typeName)&&((s=o.enum)===null||s===void 0?void 0:s.typeName)===((i=a.enum)===null||i===void 0?void 0:i.typeName)}return!0}return!1}function Oo(t,e){return hn(t)&&Zt in t&&"desc"in t&&hn(t.desc)&&t.desc.kind==="message"&&(e===void 0||t.desc.typeName==e.typeName)}function Qg(t){return Pu(t.$typeName)}function ns(t){const e=t.fields[0];return Pu(t.typeName)&&e!==void 0&&e.fieldKind=="scalar"&&e.name=="value"&&e.number==1}function Pu(t){return t.startsWith("google.protobuf.")&&["DoubleValue","FloatValue","Int64Value","UInt64Value","Int32Value","UInt32Value","BoolValue","StringValue","BytesValue"].includes(t.substring(16))}const qg=999,ep=998,Cs=2;function B(t,e){if(To(e,t))return e;const n=ip(t);return e!==void 0&&tp(t,n,e),n}function tp(t,e,n){for(const r of t.members){let s=n[r.localName];if(s==null)continue;let i;if(r.kind=="oneof"){const o=Lu(n,r);if(!o)continue;i=o,s=Bu(n,o)}else i=r;switch(i.fieldKind){case"message":s=Lo(i,s);break;case"scalar":s=_u(i,s);break;case"list":s=rp(i,s);break;case"map":s=np(i,s);break}Wu(e,i,s)}return e}function _u(t,e){return t.scalar==y.BYTES?Bo(e):e}function np(t,e){if(hn(e)){if(t.scalar==y.BYTES)return cc(e,Bo);if(t.mapKind=="message")return cc(e,n=>Lo(t,n))}return e}function rp(t,e){if(Array.isArray(e)){if(t.scalar==y.BYTES)return e.map(Bo);if(t.listKind=="message")return e.map(n=>Lo(t,n))}return e}function Lo(t,e){if(t.fieldKind=="message"&&!t.oneof&&ns(t.message))return _u(t.message.fields[0],e);if(hn(e)){if(t.message.typeName=="google.protobuf.Struct"&&t.parent.typeName!=="google.protobuf.Value")return e;if(!To(e,t.message))return B(t.message,e)}return e}function Bo(t){return Array.isArray(t)?new Uint8Array(t):t}function cc(t,e){const n={};for(const r of Object.entries(t))n[r[0]]=e(r[1]);return n}const sp=Symbol(),lc=new WeakMap;function ip(t){let e;if(op(t)){const n=lc.get(t);let r,s;if(n)({prototype:r,members:s}=n);else{r={},s=new Set;for(const i of t.members)i.kind!="oneof"&&(i.fieldKind!="scalar"&&i.fieldKind!="enum"||i.presence!=Cs&&(s.add(i),r[i.localName]=Ri(i)));lc.set(t,{prototype:r,members:s})}e=Object.create(r),e.$typeName=t.typeName;for(const i of t.members)s.has(i)||i.kind=="field"&&(i.fieldKind=="message"||(i.fieldKind=="scalar"||i.fieldKind=="enum")&&i.presence!=Cs)||(e[i.localName]=Ri(i))}else{e={$typeName:t.typeName};for(const n of t.members)(n.kind=="oneof"||n.presence==Cs)&&(e[n.localName]=Ri(n))}return e}function op(t){switch(t.file.edition){case qg:return!1;case ep:return!0;default:return t.fields.some(e=>e.presence!=Cs&&e.fieldKind!="message"&&!e.oneof)}}function Ri(t){if(t.kind=="oneof")return{case:void 0};if(t.fieldKind=="list")return[];if(t.fieldKind=="map")return{};if(t.fieldKind=="message")return sp;const e=t.getDefaultValue();return e!==void 0?t.fieldKind=="scalar"&&t.longAsString?e.toString():e:t.fieldKind=="scalar"?Ln(t.scalar,t.longAsString):t.enum.values[0].number}const ap=["FieldValueInvalidError","FieldListRangeError","ForeignFieldError"];class Ge extends Error{constructor(e,n,r="FieldValueInvalidError"){super(n),this.name=r,this.field=()=>e}}function cp(t){return t instanceof Error&&ap.includes(t.name)&&"field"in t&&typeof t.field=="function"}const Ci=Symbol.for("@bufbuild/protobuf/text-encoding");function Wo(){if(globalThis[Ci]==null){const t=new globalThis.TextEncoder,e=new globalThis.TextDecoder;globalThis[Ci]={encodeUtf8(n){return t.encode(n)},decodeUtf8(n){return e.decode(n)},checkUtf8(n){try{return encodeURIComponent(n),!0}catch{return!1}}}}return globalThis[Ci]}var Ae;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(Ae||(Ae={}));const Uu=34028234663852886e22,ku=-34028234663852886e22,Fu=4294967295,Zu=2147483647,Gu=-2147483648;class Mu{constructor(e=Wo().encodeUtf8){this.encodeUtf8=e,this.stack=[],this.chunks=[],this.buf=[]}finish(){this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]);let e=0;for(let s=0;s<this.chunks.length;s++)e+=this.chunks[s].length;let n=new Uint8Array(e),r=0;for(let s=0;s<this.chunks.length;s++)n.set(this.chunks[s],r),r+=this.chunks[s].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(uc(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Ti(e),Xi(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.encodeUtf8(e);return this.uint32(n.byteLength),this.raw(n)}float(e){lp(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){uc(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Ti(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Ti(e),e=(e<<1^e>>31)>>>0,Xi(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),s=ge.enc(e);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),s=ge.uEnc(e);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}int64(e){let n=ge.enc(e);return Ni(n.lo,n.hi,this.buf),this}sint64(e){const n=ge.enc(e),r=n.hi>>31,s=n.lo<<1^r,i=(n.hi<<1|n.lo>>>31)^r;return Ni(s,i,this.buf),this}uint64(e){const n=ge.uEnc(e);return Ni(n.lo,n.hi,this.buf),this}}class Po{constructor(e,n=Wo().decodeUtf8){this.decodeUtf8=n,this.varint64=Yg,this.uint32=$g,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength)}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e,n){let r=this.pos;switch(e){case Ae.Varint:for(;this.buf[this.pos++]&128;);break;case Ae.Bit64:this.pos+=4;case Ae.Bit32:this.pos+=4;break;case Ae.LengthDelimited:let s=this.uint32();this.pos+=s;break;case Ae.StartGroup:for(;;){const[i,o]=this.tag();if(o===Ae.EndGroup){if(n!==void 0&&i!==n)throw new Error("invalid end group tag");break}this.skip(o,i)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return ge.dec(...this.varint64())}uint64(){return ge.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,ge.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return ge.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return ge.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.decodeUtf8(this.bytes())}}function Ti(t){if(typeof t=="string")t=Number(t);else if(typeof t!="number")throw new Error("invalid int32: "+typeof t);if(!Number.isInteger(t)||t>Zu||t<Gu)throw new Error("invalid int32: "+t)}function uc(t){if(typeof t=="string")t=Number(t);else if(typeof t!="number")throw new Error("invalid uint32: "+typeof t);if(!Number.isInteger(t)||t>Fu||t<0)throw new Error("invalid uint32: "+t)}function lp(t){if(typeof t=="string"){const e=t;if(t=Number(t),Number.isNaN(t)&&e!=="NaN")throw new Error("invalid float32: "+e)}else if(typeof t!="number")throw new Error("invalid float32: "+typeof t);if(Number.isFinite(t)&&(t>Uu||t<ku))throw new Error("invalid float32: "+t)}function wn(t,e){const n=t.fieldKind=="list"?Vo(e,t):t.fieldKind=="map"?Do(e,t):_o(t,e);if(n===!0)return;let r;switch(t.fieldKind){case"list":r=`expected ${Ju(t)}, got ${Ie(e)}`;break;case"map":r=`expected ${$u(t)}, got ${Ie(e)}`;break;default:r=_s(t,e,n)}return new Ge(t,r)}function fc(t,e,n){const r=_o(t,n);if(r!==!0)return new Ge(t,`list item #${e+1}: ${_s(t,n,r)}`)}function up(t,e,n){const r=Yu(e,t.mapKey);if(r!==!0)return new Ge(t,`invalid map key: ${_s({scalar:t.mapKey},e,r)}`);const s=_o(t,n);if(s!==!0)return new Ge(t,`map entry ${Ie(e)}: ${_s(t,n,s)}`)}function _o(t,e){return t.scalar!==void 0?Yu(e,t.scalar):t.enum!==void 0?t.enum.open?Number.isInteger(e):t.enum.values.some(n=>n.number===e):Oo(e,t.message)}function Yu(t,e){switch(e){case y.DOUBLE:return typeof t=="number";case y.FLOAT:return typeof t!="number"?!1:Number.isNaN(t)||!Number.isFinite(t)?!0:t>Uu||t<ku?`${t.toFixed()} out of range`:!0;case y.INT32:case y.SFIXED32:case y.SINT32:return typeof t!="number"||!Number.isInteger(t)?!1:t>Zu||t<Gu?`${t.toFixed()} out of range`:!0;case y.FIXED32:case y.UINT32:return typeof t!="number"||!Number.isInteger(t)?!1:t>Fu||t<0?`${t.toFixed()} out of range`:!0;case y.BOOL:return typeof t=="boolean";case y.STRING:return typeof t!="string"?!1:Wo().checkUtf8(t)||"invalid UTF8";case y.BYTES:return t instanceof Uint8Array;case y.INT64:case y.SFIXED64:case y.SINT64:if(typeof t=="bigint"||typeof t=="number"||typeof t=="string"&&t.length>0)try{return ge.parse(t),!0}catch{return`${t} out of range`}return!1;case y.FIXED64:case y.UINT64:if(typeof t=="bigint"||typeof t=="number"||typeof t=="string"&&t.length>0)try{return ge.uParse(t),!0}catch{return`${t} out of range`}return!1}}function _s(t,e,n){return n=typeof n=="string"?`: ${n}`:`, got ${Ie(e)}`,t.scalar!==void 0?`expected ${fp(t.scalar)}`+n:t.enum!==void 0?`expected ${t.enum.toString()}`+n:`expected ${Ku(t.message)}`+n}function Ie(t){switch(typeof t){case"object":return t===null?"null":t instanceof Uint8Array?`Uint8Array(${t.length})`:Array.isArray(t)?`Array(${t.length})`:Vo(t)?Ju(t.field()):Do(t)?$u(t.field()):Oo(t)?Ku(t.desc):To(t)?`message ${t.$typeName}`:"object";case"string":return t.length>30?"string":`"${t.split('"').join('\\"')}"`;case"boolean":return String(t);case"number":return String(t);case"bigint":return String(t)+"n";default:return typeof t}}function Ku(t){return`ReflectMessage (${t.typeName})`}function Ju(t){switch(t.listKind){case"message":return`ReflectList (${t.message.toString()})`;case"enum":return`ReflectList (${t.enum.toString()})`;case"scalar":return`ReflectList (${y[t.scalar]})`}}function $u(t){switch(t.mapKind){case"message":return`ReflectMap (${y[t.mapKey]}, ${t.message.toString()})`;case"enum":return`ReflectMap (${y[t.mapKey]}, ${t.enum.toString()})`;case"scalar":return`ReflectMap (${y[t.mapKey]}, ${y[t.scalar]})`}}function fp(t){switch(t){case y.STRING:return"string";case y.BOOL:return"boolean";case y.INT64:case y.SINT64:case y.SFIXED64:return"bigint (int64)";case y.UINT64:case y.FIXED64:return"bigint (uint64)";case y.BYTES:return"Uint8Array";case y.DOUBLE:return"number (float64)";case y.FLOAT:return"number (float32)";case y.FIXED32:case y.UINT32:return"number (uint32)";case y.INT32:case y.SFIXED32:case y.SINT32:return"number (int32)"}}function nt(t,e,n=!0){return new Xu(t,e,n)}const hc=new WeakMap;class Xu{get sortedFields(){const e=hc.get(this.desc);if(e)return e;const n=this.desc.fields.concat().sort((r,s)=>r.number-s.number);return hc.set(this.desc,n),n}constructor(e,n,r=!0){this.lists=new Map,this.maps=new Map,this.check=r,this.desc=e,this.message=this[Zt]=n??B(e),this.fields=e.fields,this.oneofs=e.oneofs,this.members=e.members}findNumber(e){return this._fieldsByNumber||(this._fieldsByNumber=new Map(this.desc.fields.map(n=>[n.number,n]))),this._fieldsByNumber.get(e)}oneofCase(e){return Ar(this.message,e),Lu(this.message,e)}isSet(e){return Ar(this.message,e),jg(this.message,e)}clear(e){Ar(this.message,e),Hg(this.message,e)}get(e){Ar(this.message,e);const n=Bu(this.message,e);switch(e.fieldKind){case"list":let r=this.lists.get(e);return(!r||r[Zt]!==n)&&this.lists.set(e,r=new hp(e,n,this.check)),r;case"map":let s=this.maps.get(e);return(!s||s[Zt]!==n)&&this.maps.set(e,s=new dp(e,n,this.check)),s;case"message":return ko(e,n,this.check);case"scalar":return n===void 0?Ln(e.scalar,!1):Fo(e,n);case"enum":return n??e.enum.values[0].number}}set(e,n){if(Ar(this.message,e),this.check){const s=wn(e,n);if(s)throw s}let r;e.fieldKind=="message"?r=Uo(e,n):Do(n)||Vo(n)?r=n[Zt]:r=Zo(e,n),Wu(this.message,e,r)}getUnknown(){return this.message.$unknown}setUnknown(e){this.message.$unknown=e}}function Ar(t,e){if(e.parent.typeName!==t.$typeName)throw new Ge(e,`cannot use ${e.toString()} with message ${t.$typeName}`,"ForeignFieldError")}class hp{field(){return this._field}get size(){return this._arr.length}constructor(e,n,r){this._field=e,this._arr=this[Zt]=n,this.check=r}get(e){const n=this._arr[e];return n===void 0?void 0:xi(this._field,n,this.check)}set(e,n){if(e<0||e>=this._arr.length)throw new Ge(this._field,`list item #${e+1}: out of range`);if(this.check){const r=fc(this._field,e,n);if(r)throw r}this._arr[e]=dc(this._field,n)}add(e){if(this.check){const n=fc(this._field,this._arr.length,e);if(n)throw n}this._arr.push(dc(this._field,e))}clear(){this._arr.splice(0,this._arr.length)}[Symbol.iterator](){return this.values()}keys(){return this._arr.keys()}*values(){for(const e of this._arr)yield xi(this._field,e,this.check)}*entries(){for(let e=0;e<this._arr.length;e++)yield[e,xi(this._field,this._arr[e],this.check)]}}class dp{constructor(e,n,r=!0){this.obj=this[Zt]=n??{},this.check=r,this._field=e}field(){return this._field}set(e,n){if(this.check){const r=up(this._field,e,n);if(r)throw r}return this.obj[gs(e)]=gp(this._field,n),this}delete(e){const n=gs(e),r=Object.prototype.hasOwnProperty.call(this.obj,n);return r&&delete this.obj[n],r}clear(){for(const e of Object.keys(this.obj))delete this.obj[e]}get(e){let n=this.obj[gs(e)];return n!==void 0&&(n=Vi(this._field,n,this.check)),n}has(e){return Object.prototype.hasOwnProperty.call(this.obj,gs(e))}*keys(){for(const e of Object.keys(this.obj))yield gc(e,this._field.mapKey)}*entries(){for(const e of Object.entries(this.obj))yield[gc(e[0],this._field.mapKey),Vi(this._field,e[1],this.check)]}[Symbol.iterator](){return this.entries()}get size(){return Object.keys(this.obj).length}*values(){for(const e of Object.values(this.obj))yield Vi(this._field,e,this.check)}forEach(e,n){for(const r of this.entries())e.call(n,r[1],r[0],this)}}function Uo(t,e){return Oo(e)?Qg(e.message)&&!t.oneof&&t.fieldKind=="message"?e.message.value:e.desc.typeName=="google.protobuf.Struct"&&t.parent.typeName!="google.protobuf.Value"?ju(e.message):e.message:e}function ko(t,e,n){return e!==void 0&&(ns(t.message)&&!t.oneof&&t.fieldKind=="message"?e={$typeName:t.message.typeName,value:Fo(t.message.fields[0],e)}:t.message.typeName=="google.protobuf.Struct"&&t.parent.typeName!="google.protobuf.Value"&&hn(e)&&(e=zu(e))),new Xu(t.message,e,n)}function dc(t,e){return t.listKind=="message"?Uo(t,e):Zo(t,e)}function xi(t,e,n){return t.listKind=="message"?ko(t,e,n):Fo(t,e)}function gp(t,e){return t.mapKind=="message"?Uo(t,e):Zo(t,e)}function Vi(t,e,n){return t.mapKind=="message"?ko(t,e,n):e}function gs(t){return typeof t=="string"||typeof t=="number"?t:String(t)}function gc(t,e){switch(e){case y.STRING:return t;case y.INT32:case y.FIXED32:case y.UINT32:case y.SFIXED32:case y.SINT32:{const n=Number.parseInt(t);if(Number.isFinite(n))return n;break}case y.BOOL:switch(t){case"true":return!0;case"false":return!1}break;case y.UINT64:case y.FIXED64:try{return ge.uParse(t)}catch{}break;default:try{return ge.parse(t)}catch{}break}return t}function Fo(t,e){switch(t.scalar){case y.INT64:case y.SFIXED64:case y.SINT64:"longAsString"in t&&t.longAsString&&typeof e=="string"&&(e=ge.parse(e));break;case y.FIXED64:case y.UINT64:"longAsString"in t&&t.longAsString&&typeof e=="string"&&(e=ge.uParse(e));break}return e}function Zo(t,e){switch(t.scalar){case y.INT64:case y.SFIXED64:case y.SINT64:"longAsString"in t&&t.longAsString?e=String(e):(typeof e=="string"||typeof e=="number")&&(e=ge.parse(e));break;case y.FIXED64:case y.UINT64:"longAsString"in t&&t.longAsString?e=String(e):(typeof e=="string"||typeof e=="number")&&(e=ge.uParse(e));break}return e}function zu(t){const e={$typeName:"google.protobuf.Struct",fields:{}};if(hn(t))for(const[n,r]of Object.entries(t))e.fields[n]=Qu(r);return e}function ju(t){const e={};for(const[n,r]of Object.entries(t.fields))e[n]=Hu(r);return e}function Hu(t){switch(t.kind.case){case"structValue":return ju(t.kind.value);case"listValue":return t.kind.value.values.map(Hu);case"nullValue":case void 0:return null;default:return t.kind.value}}function Qu(t){const e={$typeName:"google.protobuf.Value",kind:{case:void 0}};switch(typeof t){case"number":e.kind={case:"numberValue",value:t};break;case"string":e.kind={case:"stringValue",value:t};break;case"boolean":e.kind={case:"boolValue",value:t};break;case"object":if(t===null)e.kind={case:"nullValue",value:0};else if(Array.isArray(t)){const n={$typeName:"google.protobuf.ListValue",values:[]};if(Array.isArray(t))for(const r of t)n.values.push(Qu(r));e.kind={case:"listValue",value:n}}else e.kind={case:"structValue",value:zu(t)};break}return e}function Go(t){const e=mp();let n=t.length*3/4;t[t.length-2]=="="?n-=2:t[t.length-1]=="="&&(n-=1);let r=new Uint8Array(n),s=0,i=0,o,a=0;for(let c=0;c<t.length;c++){if(o=e[t.charCodeAt(c)],o===void 0)switch(t[c]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string")}switch(i){case 0:a=o,i=1;break;case 1:r[s++]=a<<2|(o&48)>>4,a=o,i=2;break;case 2:r[s++]=(a&15)<<4|(o&60)>>2,a=o,i=3;break;case 3:r[s++]=(a&3)<<6|o,i=0;break}}if(i==1)throw Error("invalid base64 string");return r.subarray(0,s)}function pp(t,e="std"){const n=qu(e),r=e=="std";let s="",i=0,o,a=0;for(let c=0;c<t.length;c++)switch(o=t[c],i){case 0:s+=n[o>>2],a=(o&3)<<4,i=1;break;case 1:s+=n[a|o>>4],a=(o&15)<<2,i=2;break;case 2:s+=n[a|o>>6],s+=n[o&63],i=0;break}return i&&(s+=n[a],r&&(s+="=",i==1&&(s+="="))),s}let ps,pc,_n;function qu(t){return ps||(ps="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),pc=ps.slice(0,-2).concat("-","_")),t=="url"?pc:ps}function mp(){if(!_n){_n=[];const t=qu("std");for(let e=0;e<t.length;e++)_n[t[e].charCodeAt(0)]=e;_n[45]=t.indexOf("+"),_n[95]=t.indexOf("/")}return _n}function Yr(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let s=t.charAt(r);switch(s){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(s),e=!1;break;default:e&&(e=!1,s=s.toUpperCase()),n.push(s);break}}return n.join("")}const bp=new Set(["constructor","toString","toJSON","valueOf"]);function Kr(t){return bp.has(t)?t+"$":t}function Mo(t){for(const e of t.field)Mr(e,"jsonName")||(e.jsonName=Yr(e.name));t.nestedType.forEach(Mo)}function yp(t,e){const n=t.values.find(r=>r.name===e);if(!n)throw new Error(`cannot parse ${t} default value: ${e}`);return n.number}function Ap(t,e){switch(t){case y.STRING:return e;case y.BYTES:{const n=vp(e);if(n===!1)throw new Error(`cannot parse ${y[t]} default value: ${e}`);return n}case y.INT64:case y.SFIXED64:case y.SINT64:return ge.parse(e);case y.UINT64:case y.FIXED64:return ge.uParse(e);case y.DOUBLE:case y.FLOAT:switch(e){case"inf":return Number.POSITIVE_INFINITY;case"-inf":return Number.NEGATIVE_INFINITY;case"nan":return Number.NaN;default:return parseFloat(e)}case y.BOOL:return e==="true";case y.INT32:case y.UINT32:case y.SINT32:case y.FIXED32:case y.SFIXED32:return parseInt(e,10)}}function vp(t){const e=[],n={tail:t,c:"",next(){return this.tail.length==0?!1:(this.c=this.tail[0],this.tail=this.tail.substring(1),!0)},take(r){if(this.tail.length>=r){const s=this.tail.substring(0,r);return this.tail=this.tail.substring(r),s}return!1}};for(;n.next();)switch(n.c){case"\\":if(n.next())switch(n.c){case"\\":e.push(n.c.charCodeAt(0));break;case"b":e.push(8);break;case"f":e.push(12);break;case"n":e.push(10);break;case"r":e.push(13);break;case"t":e.push(9);break;case"v":e.push(11);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":{const r=n.c,s=n.take(2);if(s===!1)return!1;const i=parseInt(r+s,8);if(Number.isNaN(i))return!1;e.push(i);break}case"x":{const r=n.c,s=n.take(2);if(s===!1)return!1;const i=parseInt(r+s,16);if(Number.isNaN(i))return!1;e.push(i);break}case"u":{const r=n.c,s=n.take(4);if(s===!1)return!1;const i=parseInt(r+s,16);if(Number.isNaN(i))return!1;const o=new Uint8Array(4);new DataView(o.buffer).setInt32(0,i,!0),e.push(o[0],o[1],o[2],o[3]);break}case"U":{const r=n.c,s=n.take(8);if(s===!1)return!1;const i=ge.uEnc(r+s),o=new Uint8Array(8),a=new DataView(o.buffer);a.setInt32(0,i.lo,!0),a.setInt32(4,i.hi,!0),e.push(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7]);break}}break;default:e.push(n.c.charCodeAt(0))}return new Uint8Array(e)}function*zi(t){switch(t.kind){case"file":for(const e of t.messages)yield e,yield*zi(e);yield*t.enums,yield*t.services,yield*t.extensions;break;case"message":for(const e of t.nestedMessages)yield e,yield*zi(e);yield*t.nestedEnums,yield*t.nestedExtensions;break}}function ef(...t){const e=Sp();if(!t.length)return e;if("$typeName"in t[0]&&t[0].$typeName=="google.protobuf.FileDescriptorSet"){for(const r of t[0].file)Ac(r,e);return e}if("$typeName"in t[0]){let o=function(a){const c=[];for(const l of a.dependency){if(e.getFile(l)!=null||i.has(l))continue;const u=s(l);if(!u)throw new Error(`Unable to resolve ${l}, imported by ${a.name}`);"kind"in u?e.addFile(u,!1,!0):(i.add(u.name),c.push(u))}return c.concat(...c.map(o))};var n=o;const r=t[0],s=t[1],i=new Set;for(const a of[r,...o(r)].reverse())Ac(a,e)}else for(const r of t)for(const s of r.files)e.addFile(s);return e}function Sp(){const t=new Map,e=new Map,n=new Map;return{kind:"registry",types:t,extendees:e,[Symbol.iterator](){return t.values()},get files(){return n.values()},addFile(r,s,i){if(n.set(r.proto.name,r),!s)for(const o of zi(r))this.add(o);if(i)for(const o of r.dependencies)this.addFile(o,s,i)},add(r){if(r.kind=="extension"){let s=e.get(r.extendee.typeName);s||e.set(r.extendee.typeName,s=new Map),s.set(r.number,r)}t.set(r.typeName,r)},get(r){return t.get(r)},getFile(r){return n.get(r)},getMessage(r){const s=t.get(r);return s?.kind=="message"?s:void 0},getEnum(r){const s=t.get(r);return s?.kind=="enum"?s:void 0},getExtension(r){const s=t.get(r);return s?.kind=="extension"?s:void 0},getExtensionFor(r,s){var i;return(i=e.get(r.typeName))===null||i===void 0?void 0:i.get(s)},getService(r){const s=t.get(r);return s?.kind=="service"?s:void 0}}}const Ip=998,Ep=999,wp=9,Jr=10,Lr=11,Np=12,mc=14,Yo=3,Rp=2,bc=1,Cp=0,Di=1,yc=2,Tp=3,xp=1,Vp=2,Dp=1,tf={998:{fieldPresence:1,enumType:2,repeatedFieldEncoding:2,utf8Validation:3,messageEncoding:1,jsonFormat:2,enforceNamingStyle:2,defaultSymbolVisibility:1},999:{fieldPresence:2,enumType:1,repeatedFieldEncoding:1,utf8Validation:2,messageEncoding:1,jsonFormat:1,enforceNamingStyle:2,defaultSymbolVisibility:1},1e3:{fieldPresence:1,enumType:1,repeatedFieldEncoding:1,utf8Validation:2,messageEncoding:1,jsonFormat:1,enforceNamingStyle:2,defaultSymbolVisibility:1},1001:{fieldPresence:1,enumType:1,repeatedFieldEncoding:1,utf8Validation:2,messageEncoding:1,jsonFormat:1,enforceNamingStyle:1,defaultSymbolVisibility:2}};function Ac(t,e){var n,r;const s={kind:"file",proto:t,deprecated:(r=(n=t.options)===null||n===void 0?void 0:n.deprecated)!==null&&r!==void 0?r:!1,edition:Wp(t),name:t.name.replace(/\.proto$/,""),dependencies:Pp(t,e),enums:[],messages:[],extensions:[],services:[],toString(){return`file ${t.name}`}},i=new Map,o={get(a){return i.get(a)},add(a){var c;lt(((c=a.proto.options)===null||c===void 0?void 0:c.mapEntry)===!0),i.set(a.typeName,a)}};for(const a of t.enumType)nf(a,s,void 0,e);for(const a of t.messageType)rf(a,s,void 0,e,o);for(const a of t.service)Op(a,s,e);ji(s,e);for(const a of i.values())Hi(a,e,o);for(const a of s.messages)Hi(a,e,o),ji(a,e);e.addFile(s,!0)}function ji(t,e){switch(t.kind){case"file":for(const n of t.proto.extension){const r=Qi(n,t,e);t.extensions.push(r),e.add(r)}break;case"message":for(const n of t.proto.extension){const r=Qi(n,t,e);t.nestedExtensions.push(r),e.add(r)}for(const n of t.nestedMessages)ji(n,e);break}}function Hi(t,e,n){const r=t.proto.oneofDecl.map(i=>Bp(i,t)),s=new Set;for(const i of t.proto.field){const o=kp(i,r),a=Qi(i,t,e,o,n);t.fields.push(a),t.field[a.localName]=a,o===void 0?t.members.push(a):(o.fields.push(a),s.has(o)||(s.add(o),t.members.push(o)))}for(const i of r.filter(o=>s.has(o)))t.oneofs.push(i);for(const i of t.nestedMessages)Hi(i,e,n)}function nf(t,e,n,r){var s,i,o,a,c;const l=_p(t.name,t.value),u={kind:"enum",proto:t,deprecated:(i=(s=t.options)===null||s===void 0?void 0:s.deprecated)!==null&&i!==void 0?i:!1,file:e,parent:n,open:!0,name:t.name,typeName:ti(t,n,e),value:{},values:[],sharedPrefix:l,toString(){return`enum ${this.typeName}`}};u.open=Mp(u),r.add(u);for(const f of t.value){const b=f.name;u.values.push(u.value[f.number]={kind:"enum_value",proto:f,deprecated:(a=(o=f.options)===null||o===void 0?void 0:o.deprecated)!==null&&a!==void 0?a:!1,parent:u,name:b,localName:Kr(l==null?b:b.substring(l.length)),number:f.number,toString(){return`enum value ${u.typeName}.${b}`}})}((c=n?.nestedEnums)!==null&&c!==void 0?c:e.enums).push(u)}function rf(t,e,n,r,s){var i,o,a,c;const l={kind:"message",proto:t,deprecated:(o=(i=t.options)===null||i===void 0?void 0:i.deprecated)!==null&&o!==void 0?o:!1,file:e,parent:n,name:t.name,typeName:ti(t,n,e),fields:[],field:{},oneofs:[],members:[],nestedEnums:[],nestedMessages:[],nestedExtensions:[],toString(){return`message ${this.typeName}`}};((a=t.options)===null||a===void 0?void 0:a.mapEntry)===!0?s.add(l):(((c=n?.nestedMessages)!==null&&c!==void 0?c:e.messages).push(l),r.add(l));for(const u of t.enumType)nf(u,e,l,r);for(const u of t.nestedType)rf(u,e,l,r,s)}function Op(t,e,n){var r,s;const i={kind:"service",proto:t,deprecated:(s=(r=t.options)===null||r===void 0?void 0:r.deprecated)!==null&&s!==void 0?s:!1,file:e,name:t.name,typeName:ti(t,void 0,e),methods:[],method:{},toString(){return`service ${this.typeName}`}};e.services.push(i),n.add(i);for(const o of t.method){const a=Lp(o,i,n);i.methods.push(a),i.method[a.localName]=a}}function Lp(t,e,n){var r,s,i,o;let a;t.clientStreaming&&t.serverStreaming?a="bidi_streaming":t.clientStreaming?a="client_streaming":t.serverStreaming?a="server_streaming":a="unary";const c=n.getMessage(Ut(t.inputType)),l=n.getMessage(Ut(t.outputType));lt(c,`invalid MethodDescriptorProto: input_type ${t.inputType} not found`),lt(l,`invalid MethodDescriptorProto: output_type ${t.inputType} not found`);const u=t.name;return{kind:"rpc",proto:t,deprecated:(s=(r=t.options)===null||r===void 0?void 0:r.deprecated)!==null&&s!==void 0?s:!1,parent:e,name:u,localName:Kr(u.length?Kr(u[0].toLowerCase()+u.substring(1)):u),methodKind:a,input:c,output:l,idempotency:(o=(i=t.options)===null||i===void 0?void 0:i.idempotencyLevel)!==null&&o!==void 0?o:Cp,toString(){return`rpc ${e.typeName}.${u}`}}}function Bp(t,e){return{kind:"oneof",proto:t,deprecated:!1,parent:e,fields:[],name:t.name,localName:Kr(Yr(t.name)),toString(){return`oneof ${e.typeName}.${this.name}`}}}function Qi(t,e,n,r,s){var i,o,a;const c=s===void 0,l={kind:"field",proto:t,deprecated:(o=(i=t.options)===null||i===void 0?void 0:i.deprecated)!==null&&o!==void 0?o:!1,name:t.name,number:t.number,scalar:void 0,message:void 0,enum:void 0,presence:Fp(t,r,c,e),listKind:void 0,mapKind:void 0,mapKey:void 0,delimitedEncoding:void 0,packed:void 0,longAsString:!1,getDefaultValue:void 0};if(c){const d=e.kind=="file"?e:e.file,A=e.kind=="file"?void 0:e,S=ti(t,A,d);l.kind="extension",l.file=d,l.parent=A,l.oneof=void 0,l.typeName=S,l.jsonName=`[${S}]`,l.toString=()=>`extension ${S}`;const W=n.getMessage(Ut(t.extendee));lt(W,`invalid FieldDescriptorProto: extendee ${t.extendee} not found`),l.extendee=W}else{const d=e;lt(d.kind=="message"),l.parent=d,l.oneof=r,l.localName=r?Yr(t.name):Kr(Yr(t.name)),l.jsonName=t.jsonName,l.toString=()=>`field ${d.typeName}.${t.name}`}const u=t.label,f=t.type,b=(a=t.options)===null||a===void 0?void 0:a.jstype;if(u===Yo){const d=f==Lr?s?.get(Ut(t.typeName)):void 0;if(d){l.fieldKind="map";const{key:A,value:S}=Gp(d);return l.mapKey=A.scalar,l.mapKind=S.fieldKind,l.message=S.message,l.delimitedEncoding=!1,l.enum=S.enum,l.scalar=S.scalar,l}switch(l.fieldKind="list",f){case Lr:case Jr:l.listKind="message",l.message=n.getMessage(Ut(t.typeName)),lt(l.message),l.delimitedEncoding=vc(t,e);break;case mc:l.listKind="enum",l.enum=n.getEnum(Ut(t.typeName)),lt(l.enum);break;default:l.listKind="scalar",l.scalar=f,l.longAsString=b==bc;break}return l.packed=Zp(t,e),l}switch(f){case Lr:case Jr:l.fieldKind="message",l.message=n.getMessage(Ut(t.typeName)),lt(l.message,`invalid FieldDescriptorProto: type_name ${t.typeName} not found`),l.delimitedEncoding=vc(t,e),l.getDefaultValue=()=>{};break;case mc:{const d=n.getEnum(Ut(t.typeName));lt(d!==void 0,`invalid FieldDescriptorProto: type_name ${t.typeName} not found`),l.fieldKind="enum",l.enum=n.getEnum(Ut(t.typeName)),l.getDefaultValue=()=>Mr(t,"defaultValue")?yp(d,t.defaultValue):void 0;break}default:{l.fieldKind="scalar",l.scalar=f,l.longAsString=b==bc,l.getDefaultValue=()=>Mr(t,"defaultValue")?Ap(f,t.defaultValue):void 0;break}}return l}function Wp(t){switch(t.syntax){case"":case"proto2":return Ip;case"proto3":return Ep;case"editions":if(t.edition in tf)return t.edition;throw new Error(`${t.name}: unsupported edition`);default:throw new Error(`${t.name}: unsupported syntax "${t.syntax}"`)}}function Pp(t,e){return t.dependency.map(n=>{const r=e.getFile(n);if(!r)throw new Error(`Cannot find ${n}, imported by ${t.name}`);return r})}function _p(t,e){const n=Up(t)+"_";for(const r of e){if(!r.name.toLowerCase().startsWith(n))return;const s=r.name.substring(n.length);if(s.length==0||/^\d/.test(s))return}return n}function Up(t){return(t.substring(0,1)+t.substring(1).replace(/[A-Z]/g,e=>"_"+e)).toLowerCase()}function ti(t,e,n){let r;return e?r=`${e.typeName}.${t.name}`:n.proto.package.length>0?r=`${n.proto.package}.${t.name}`:r=`${t.name}`,r}function Ut(t){return t.startsWith(".")?t.substring(1):t}function kp(t,e){if(!Mr(t,"oneofIndex")||t.proto3Optional)return;const n=e[t.oneofIndex];return lt(n,`invalid FieldDescriptorProto: oneof #${t.oneofIndex} for field #${t.number} not found`),n}function Fp(t,e,n,r){if(t.label==Rp)return Tp;if(t.label==Yo)return yc;if(e||t.proto3Optional||n)return Di;const s=nr("fieldPresence",{proto:t,parent:r});return s==yc&&(t.type==Lr||t.type==Jr)?Di:s}function Zp(t,e){if(t.label!=Yo)return!1;switch(t.type){case wp:case Np:case Jr:case Lr:return!1}const n=t.options;return n&&Mr(n,"packed")?n.packed:xp==nr("repeatedFieldEncoding",{proto:t,parent:e})}function Gp(t){const e=t.fields.find(r=>r.number===1),n=t.fields.find(r=>r.number===2);return lt(e&&e.fieldKind=="scalar"&&e.scalar!=y.BYTES&&e.scalar!=y.FLOAT&&e.scalar!=y.DOUBLE&&n&&n.fieldKind!="list"&&n.fieldKind!="map"),{key:e,value:n}}function Mp(t){var e;return Dp==nr("enumType",{proto:t.proto,parent:(e=t.parent)!==null&&e!==void 0?e:t.file})}function vc(t,e){return t.type==Jr?!0:Vp==nr("messageEncoding",{proto:t,parent:e})}function nr(t,e){var n,r;const s=(n=e.proto.options)===null||n===void 0?void 0:n.features;if(s){const i=s[t];if(i!=0)return i}if("kind"in e){if(e.kind=="message")return nr(t,(r=e.parent)!==null&&r!==void 0?r:e.file);const i=tf[e.edition];if(!i)throw new Error(`feature default for edition ${e.edition} not found`);return i[t]}return nr(t,e.parent)}function lt(t,e){if(!t)throw new Error(e)}function Yp(t){const e=Kp(t);return e.messageType.forEach(Mo),ef(e,()=>{}).getFile(e.name)}function Kp(t){return Object.assign(Object.create({syntax:"",edition:0}),Object.assign(Object.assign({$typeName:"google.protobuf.FileDescriptorProto",dependency:[],publicDependency:[],weakDependency:[],optionDependency:[],service:[],extension:[]},t),{messageType:t.messageType.map(sf),enumType:t.enumType.map(of)}))}function sf(t){var e,n,r,s,i,o,a,c;return Object.assign(Object.create({visibility:0}),{$typeName:"google.protobuf.DescriptorProto",name:t.name,field:(n=(e=t.field)===null||e===void 0?void 0:e.map(Jp))!==null&&n!==void 0?n:[],extension:[],nestedType:(s=(r=t.nestedType)===null||r===void 0?void 0:r.map(sf))!==null&&s!==void 0?s:[],enumType:(o=(i=t.enumType)===null||i===void 0?void 0:i.map(of))!==null&&o!==void 0?o:[],extensionRange:(c=(a=t.extensionRange)===null||a===void 0?void 0:a.map(u=>Object.assign({$typeName:"google.protobuf.DescriptorProto.ExtensionRange"},u)))!==null&&c!==void 0?c:[],oneofDecl:[],reservedRange:[],reservedName:[]})}function Jp(t){return Object.assign(Object.create({label:1,typeName:"",extendee:"",defaultValue:"",oneofIndex:0,jsonName:"",proto3Optional:!1}),Object.assign(Object.assign({$typeName:"google.protobuf.FieldDescriptorProto"},t),{options:t.options?$p(t.options):void 0}))}function $p(t){var e,n,r;return Object.assign(Object.create({ctype:0,packed:!1,jstype:0,lazy:!1,unverifiedLazy:!1,deprecated:!1,weak:!1,debugRedact:!1,retention:0}),Object.assign(Object.assign({$typeName:"google.protobuf.FieldOptions"},t),{targets:(e=t.targets)!==null&&e!==void 0?e:[],editionDefaults:(r=(n=t.editionDefaults)===null||n===void 0?void 0:n.map(i=>Object.assign({$typeName:"google.protobuf.FieldOptions.EditionDefault"},i)))!==null&&r!==void 0?r:[],uninterpretedOption:[]}))}function of(t){return Object.assign(Object.create({visibility:0}),{$typeName:"google.protobuf.EnumDescriptorProto",name:t.name,reservedName:[],reservedRange:[],value:t.value.map(n=>Object.assign({$typeName:"google.protobuf.EnumValueDescriptorProto"},n))})}function Y(t,e,...n){return n.reduce((r,s)=>r.nestedMessages[s],t.messages[e])}const Xp=Yp({name:"google/protobuf/descriptor.proto",package:"google.protobuf",messageType:[{name:"FileDescriptorSet",field:[{name:"file",number:1,type:11,label:3,typeName:".google.protobuf.FileDescriptorProto"}],extensionRange:[{start:536e6,end:536000001}]},{name:"FileDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"package",number:2,type:9,label:1},{name:"dependency",number:3,type:9,label:3},{name:"public_dependency",number:10,type:5,label:3},{name:"weak_dependency",number:11,type:5,label:3},{name:"option_dependency",number:15,type:9,label:3},{name:"message_type",number:4,type:11,label:3,typeName:".google.protobuf.DescriptorProto"},{name:"enum_type",number:5,type:11,label:3,typeName:".google.protobuf.EnumDescriptorProto"},{name:"service",number:6,type:11,label:3,typeName:".google.protobuf.ServiceDescriptorProto"},{name:"extension",number:7,type:11,label:3,typeName:".google.protobuf.FieldDescriptorProto"},{name:"options",number:8,type:11,label:1,typeName:".google.protobuf.FileOptions"},{name:"source_code_info",number:9,type:11,label:1,typeName:".google.protobuf.SourceCodeInfo"},{name:"syntax",number:12,type:9,label:1},{name:"edition",number:14,type:14,label:1,typeName:".google.protobuf.Edition"}]},{name:"DescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"field",number:2,type:11,label:3,typeName:".google.protobuf.FieldDescriptorProto"},{name:"extension",number:6,type:11,label:3,typeName:".google.protobuf.FieldDescriptorProto"},{name:"nested_type",number:3,type:11,label:3,typeName:".google.protobuf.DescriptorProto"},{name:"enum_type",number:4,type:11,label:3,typeName:".google.protobuf.EnumDescriptorProto"},{name:"extension_range",number:5,type:11,label:3,typeName:".google.protobuf.DescriptorProto.ExtensionRange"},{name:"oneof_decl",number:8,type:11,label:3,typeName:".google.protobuf.OneofDescriptorProto"},{name:"options",number:7,type:11,label:1,typeName:".google.protobuf.MessageOptions"},{name:"reserved_range",number:9,type:11,label:3,typeName:".google.protobuf.DescriptorProto.ReservedRange"},{name:"reserved_name",number:10,type:9,label:3},{name:"visibility",number:11,type:14,label:1,typeName:".google.protobuf.SymbolVisibility"}],nestedType:[{name:"ExtensionRange",field:[{name:"start",number:1,type:5,label:1},{name:"end",number:2,type:5,label:1},{name:"options",number:3,type:11,label:1,typeName:".google.protobuf.ExtensionRangeOptions"}]},{name:"ReservedRange",field:[{name:"start",number:1,type:5,label:1},{name:"end",number:2,type:5,label:1}]}]},{name:"ExtensionRangeOptions",field:[{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"},{name:"declaration",number:2,type:11,label:3,typeName:".google.protobuf.ExtensionRangeOptions.Declaration",options:{retention:2}},{name:"features",number:50,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"verification",number:3,type:14,label:1,typeName:".google.protobuf.ExtensionRangeOptions.VerificationState",defaultValue:"UNVERIFIED",options:{retention:2}}],nestedType:[{name:"Declaration",field:[{name:"number",number:1,type:5,label:1},{name:"full_name",number:2,type:9,label:1},{name:"type",number:3,type:9,label:1},{name:"reserved",number:5,type:8,label:1},{name:"repeated",number:6,type:8,label:1}]}],enumType:[{name:"VerificationState",value:[{name:"DECLARATION",number:0},{name:"UNVERIFIED",number:1}]}],extensionRange:[{start:1e3,end:536870912}]},{name:"FieldDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"number",number:3,type:5,label:1},{name:"label",number:4,type:14,label:1,typeName:".google.protobuf.FieldDescriptorProto.Label"},{name:"type",number:5,type:14,label:1,typeName:".google.protobuf.FieldDescriptorProto.Type"},{name:"type_name",number:6,type:9,label:1},{name:"extendee",number:2,type:9,label:1},{name:"default_value",number:7,type:9,label:1},{name:"oneof_index",number:9,type:5,label:1},{name:"json_name",number:10,type:9,label:1},{name:"options",number:8,type:11,label:1,typeName:".google.protobuf.FieldOptions"},{name:"proto3_optional",number:17,type:8,label:1}],enumType:[{name:"Type",value:[{name:"TYPE_DOUBLE",number:1},{name:"TYPE_FLOAT",number:2},{name:"TYPE_INT64",number:3},{name:"TYPE_UINT64",number:4},{name:"TYPE_INT32",number:5},{name:"TYPE_FIXED64",number:6},{name:"TYPE_FIXED32",number:7},{name:"TYPE_BOOL",number:8},{name:"TYPE_STRING",number:9},{name:"TYPE_GROUP",number:10},{name:"TYPE_MESSAGE",number:11},{name:"TYPE_BYTES",number:12},{name:"TYPE_UINT32",number:13},{name:"TYPE_ENUM",number:14},{name:"TYPE_SFIXED32",number:15},{name:"TYPE_SFIXED64",number:16},{name:"TYPE_SINT32",number:17},{name:"TYPE_SINT64",number:18}]},{name:"Label",value:[{name:"LABEL_OPTIONAL",number:1},{name:"LABEL_REPEATED",number:3},{name:"LABEL_REQUIRED",number:2}]}]},{name:"OneofDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"options",number:2,type:11,label:1,typeName:".google.protobuf.OneofOptions"}]},{name:"EnumDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"value",number:2,type:11,label:3,typeName:".google.protobuf.EnumValueDescriptorProto"},{name:"options",number:3,type:11,label:1,typeName:".google.protobuf.EnumOptions"},{name:"reserved_range",number:4,type:11,label:3,typeName:".google.protobuf.EnumDescriptorProto.EnumReservedRange"},{name:"reserved_name",number:5,type:9,label:3},{name:"visibility",number:6,type:14,label:1,typeName:".google.protobuf.SymbolVisibility"}],nestedType:[{name:"EnumReservedRange",field:[{name:"start",number:1,type:5,label:1},{name:"end",number:2,type:5,label:1}]}]},{name:"EnumValueDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"number",number:2,type:5,label:1},{name:"options",number:3,type:11,label:1,typeName:".google.protobuf.EnumValueOptions"}]},{name:"ServiceDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"method",number:2,type:11,label:3,typeName:".google.protobuf.MethodDescriptorProto"},{name:"options",number:3,type:11,label:1,typeName:".google.protobuf.ServiceOptions"}]},{name:"MethodDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"input_type",number:2,type:9,label:1},{name:"output_type",number:3,type:9,label:1},{name:"options",number:4,type:11,label:1,typeName:".google.protobuf.MethodOptions"},{name:"client_streaming",number:5,type:8,label:1,defaultValue:"false"},{name:"server_streaming",number:6,type:8,label:1,defaultValue:"false"}]},{name:"FileOptions",field:[{name:"java_package",number:1,type:9,label:1},{name:"java_outer_classname",number:8,type:9,label:1},{name:"java_multiple_files",number:10,type:8,label:1,defaultValue:"false"},{name:"java_generate_equals_and_hash",number:20,type:8,label:1,options:{deprecated:!0}},{name:"java_string_check_utf8",number:27,type:8,label:1,defaultValue:"false"},{name:"optimize_for",number:9,type:14,label:1,typeName:".google.protobuf.FileOptions.OptimizeMode",defaultValue:"SPEED"},{name:"go_package",number:11,type:9,label:1},{name:"cc_generic_services",number:16,type:8,label:1,defaultValue:"false"},{name:"java_generic_services",number:17,type:8,label:1,defaultValue:"false"},{name:"py_generic_services",number:18,type:8,label:1,defaultValue:"false"},{name:"deprecated",number:23,type:8,label:1,defaultValue:"false"},{name:"cc_enable_arenas",number:31,type:8,label:1,defaultValue:"true"},{name:"objc_class_prefix",number:36,type:9,label:1},{name:"csharp_namespace",number:37,type:9,label:1},{name:"swift_prefix",number:39,type:9,label:1},{name:"php_class_prefix",number:40,type:9,label:1},{name:"php_namespace",number:41,type:9,label:1},{name:"php_metadata_namespace",number:44,type:9,label:1},{name:"ruby_package",number:45,type:9,label:1},{name:"features",number:50,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],enumType:[{name:"OptimizeMode",value:[{name:"SPEED",number:1},{name:"CODE_SIZE",number:2},{name:"LITE_RUNTIME",number:3}]}],extensionRange:[{start:1e3,end:536870912}]},{name:"MessageOptions",field:[{name:"message_set_wire_format",number:1,type:8,label:1,defaultValue:"false"},{name:"no_standard_descriptor_accessor",number:2,type:8,label:1,defaultValue:"false"},{name:"deprecated",number:3,type:8,label:1,defaultValue:"false"},{name:"map_entry",number:7,type:8,label:1},{name:"deprecated_legacy_json_field_conflicts",number:11,type:8,label:1,options:{deprecated:!0}},{name:"features",number:12,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:536870912}]},{name:"FieldOptions",field:[{name:"ctype",number:1,type:14,label:1,typeName:".google.protobuf.FieldOptions.CType",defaultValue:"STRING"},{name:"packed",number:2,type:8,label:1},{name:"jstype",number:6,type:14,label:1,typeName:".google.protobuf.FieldOptions.JSType",defaultValue:"JS_NORMAL"},{name:"lazy",number:5,type:8,label:1,defaultValue:"false"},{name:"unverified_lazy",number:15,type:8,label:1,defaultValue:"false"},{name:"deprecated",number:3,type:8,label:1,defaultValue:"false"},{name:"weak",number:10,type:8,label:1,defaultValue:"false",options:{deprecated:!0}},{name:"debug_redact",number:16,type:8,label:1,defaultValue:"false"},{name:"retention",number:17,type:14,label:1,typeName:".google.protobuf.FieldOptions.OptionRetention"},{name:"targets",number:19,type:14,label:3,typeName:".google.protobuf.FieldOptions.OptionTargetType"},{name:"edition_defaults",number:20,type:11,label:3,typeName:".google.protobuf.FieldOptions.EditionDefault"},{name:"features",number:21,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"feature_support",number:22,type:11,label:1,typeName:".google.protobuf.FieldOptions.FeatureSupport"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],nestedType:[{name:"EditionDefault",field:[{name:"edition",number:3,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"value",number:2,type:9,label:1}]},{name:"FeatureSupport",field:[{name:"edition_introduced",number:1,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"edition_deprecated",number:2,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"deprecation_warning",number:3,type:9,label:1},{name:"edition_removed",number:4,type:14,label:1,typeName:".google.protobuf.Edition"}]}],enumType:[{name:"CType",value:[{name:"STRING",number:0},{name:"CORD",number:1},{name:"STRING_PIECE",number:2}]},{name:"JSType",value:[{name:"JS_NORMAL",number:0},{name:"JS_STRING",number:1},{name:"JS_NUMBER",number:2}]},{name:"OptionRetention",value:[{name:"RETENTION_UNKNOWN",number:0},{name:"RETENTION_RUNTIME",number:1},{name:"RETENTION_SOURCE",number:2}]},{name:"OptionTargetType",value:[{name:"TARGET_TYPE_UNKNOWN",number:0},{name:"TARGET_TYPE_FILE",number:1},{name:"TARGET_TYPE_EXTENSION_RANGE",number:2},{name:"TARGET_TYPE_MESSAGE",number:3},{name:"TARGET_TYPE_FIELD",number:4},{name:"TARGET_TYPE_ONEOF",number:5},{name:"TARGET_TYPE_ENUM",number:6},{name:"TARGET_TYPE_ENUM_ENTRY",number:7},{name:"TARGET_TYPE_SERVICE",number:8},{name:"TARGET_TYPE_METHOD",number:9}]}],extensionRange:[{start:1e3,end:536870912}]},{name:"OneofOptions",field:[{name:"features",number:1,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:536870912}]},{name:"EnumOptions",field:[{name:"allow_alias",number:2,type:8,label:1},{name:"deprecated",number:3,type:8,label:1,defaultValue:"false"},{name:"deprecated_legacy_json_field_conflicts",number:6,type:8,label:1,options:{deprecated:!0}},{name:"features",number:7,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:536870912}]},{name:"EnumValueOptions",field:[{name:"deprecated",number:1,type:8,label:1,defaultValue:"false"},{name:"features",number:2,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"debug_redact",number:3,type:8,label:1,defaultValue:"false"},{name:"feature_support",number:4,type:11,label:1,typeName:".google.protobuf.FieldOptions.FeatureSupport"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:536870912}]},{name:"ServiceOptions",field:[{name:"features",number:34,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"deprecated",number:33,type:8,label:1,defaultValue:"false"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:536870912}]},{name:"MethodOptions",field:[{name:"deprecated",number:33,type:8,label:1,defaultValue:"false"},{name:"idempotency_level",number:34,type:14,label:1,typeName:".google.protobuf.MethodOptions.IdempotencyLevel",defaultValue:"IDEMPOTENCY_UNKNOWN"},{name:"features",number:35,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],enumType:[{name:"IdempotencyLevel",value:[{name:"IDEMPOTENCY_UNKNOWN",number:0},{name:"NO_SIDE_EFFECTS",number:1},{name:"IDEMPOTENT",number:2}]}],extensionRange:[{start:1e3,end:536870912}]},{name:"UninterpretedOption",field:[{name:"name",number:2,type:11,label:3,typeName:".google.protobuf.UninterpretedOption.NamePart"},{name:"identifier_value",number:3,type:9,label:1},{name:"positive_int_value",number:4,type:4,label:1},{name:"negative_int_value",number:5,type:3,label:1},{name:"double_value",number:6,type:1,label:1},{name:"string_value",number:7,type:12,label:1},{name:"aggregate_value",number:8,type:9,label:1}],nestedType:[{name:"NamePart",field:[{name:"name_part",number:1,type:9,label:2},{name:"is_extension",number:2,type:8,label:2}]}]},{name:"FeatureSet",field:[{name:"field_presence",number:1,type:14,label:1,typeName:".google.protobuf.FeatureSet.FieldPresence",options:{retention:1,targets:[4,1],editionDefaults:[{value:"EXPLICIT",edition:900},{value:"IMPLICIT",edition:999},{value:"EXPLICIT",edition:1e3}]}},{name:"enum_type",number:2,type:14,label:1,typeName:".google.protobuf.FeatureSet.EnumType",options:{retention:1,targets:[6,1],editionDefaults:[{value:"CLOSED",edition:900},{value:"OPEN",edition:999}]}},{name:"repeated_field_encoding",number:3,type:14,label:1,typeName:".google.protobuf.FeatureSet.RepeatedFieldEncoding",options:{retention:1,targets:[4,1],editionDefaults:[{value:"EXPANDED",edition:900},{value:"PACKED",edition:999}]}},{name:"utf8_validation",number:4,type:14,label:1,typeName:".google.protobuf.FeatureSet.Utf8Validation",options:{retention:1,targets:[4,1],editionDefaults:[{value:"NONE",edition:900},{value:"VERIFY",edition:999}]}},{name:"message_encoding",number:5,type:14,label:1,typeName:".google.protobuf.FeatureSet.MessageEncoding",options:{retention:1,targets:[4,1],editionDefaults:[{value:"LENGTH_PREFIXED",edition:900}]}},{name:"json_format",number:6,type:14,label:1,typeName:".google.protobuf.FeatureSet.JsonFormat",options:{retention:1,targets:[3,6,1],editionDefaults:[{value:"LEGACY_BEST_EFFORT",edition:900},{value:"ALLOW",edition:999}]}},{name:"enforce_naming_style",number:7,type:14,label:1,typeName:".google.protobuf.FeatureSet.EnforceNamingStyle",options:{retention:2,targets:[1,2,3,4,5,6,7,8,9],editionDefaults:[{value:"STYLE_LEGACY",edition:900},{value:"STYLE2024",edition:1001}]}},{name:"default_symbol_visibility",number:8,type:14,label:1,typeName:".google.protobuf.FeatureSet.VisibilityFeature.DefaultSymbolVisibility",options:{retention:2,targets:[1],editionDefaults:[{value:"EXPORT_ALL",edition:900},{value:"EXPORT_TOP_LEVEL",edition:1001}]}}],nestedType:[{name:"VisibilityFeature",enumType:[{name:"DefaultSymbolVisibility",value:[{name:"DEFAULT_SYMBOL_VISIBILITY_UNKNOWN",number:0},{name:"EXPORT_ALL",number:1},{name:"EXPORT_TOP_LEVEL",number:2},{name:"LOCAL_ALL",number:3},{name:"STRICT",number:4}]}]}],enumType:[{name:"FieldPresence",value:[{name:"FIELD_PRESENCE_UNKNOWN",number:0},{name:"EXPLICIT",number:1},{name:"IMPLICIT",number:2},{name:"LEGACY_REQUIRED",number:3}]},{name:"EnumType",value:[{name:"ENUM_TYPE_UNKNOWN",number:0},{name:"OPEN",number:1},{name:"CLOSED",number:2}]},{name:"RepeatedFieldEncoding",value:[{name:"REPEATED_FIELD_ENCODING_UNKNOWN",number:0},{name:"PACKED",number:1},{name:"EXPANDED",number:2}]},{name:"Utf8Validation",value:[{name:"UTF8_VALIDATION_UNKNOWN",number:0},{name:"VERIFY",number:2},{name:"NONE",number:3}]},{name:"MessageEncoding",value:[{name:"MESSAGE_ENCODING_UNKNOWN",number:0},{name:"LENGTH_PREFIXED",number:1},{name:"DELIMITED",number:2}]},{name:"JsonFormat",value:[{name:"JSON_FORMAT_UNKNOWN",number:0},{name:"ALLOW",number:1},{name:"LEGACY_BEST_EFFORT",number:2}]},{name:"EnforceNamingStyle",value:[{name:"ENFORCE_NAMING_STYLE_UNKNOWN",number:0},{name:"STYLE2024",number:1},{name:"STYLE_LEGACY",number:2}]}],extensionRange:[{start:1e3,end:9995},{start:9995,end:1e4},{start:1e4,end:10001}]},{name:"FeatureSetDefaults",field:[{name:"defaults",number:1,type:11,label:3,typeName:".google.protobuf.FeatureSetDefaults.FeatureSetEditionDefault"},{name:"minimum_edition",number:4,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"maximum_edition",number:5,type:14,label:1,typeName:".google.protobuf.Edition"}],nestedType:[{name:"FeatureSetEditionDefault",field:[{name:"edition",number:3,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"overridable_features",number:4,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"fixed_features",number:5,type:11,label:1,typeName:".google.protobuf.FeatureSet"}]}]},{name:"SourceCodeInfo",field:[{name:"location",number:1,type:11,label:3,typeName:".google.protobuf.SourceCodeInfo.Location"}],nestedType:[{name:"Location",field:[{name:"path",number:1,type:5,label:3,options:{packed:!0}},{name:"span",number:2,type:5,label:3,options:{packed:!0}},{name:"leading_comments",number:3,type:9,label:1},{name:"trailing_comments",number:4,type:9,label:1},{name:"leading_detached_comments",number:6,type:9,label:3}]}],extensionRange:[{start:536e6,end:536000001}]},{name:"GeneratedCodeInfo",field:[{name:"annotation",number:1,type:11,label:3,typeName:".google.protobuf.GeneratedCodeInfo.Annotation"}],nestedType:[{name:"Annotation",field:[{name:"path",number:1,type:5,label:3,options:{packed:!0}},{name:"source_file",number:2,type:9,label:1},{name:"begin",number:3,type:5,label:1},{name:"end",number:4,type:5,label:1},{name:"semantic",number:5,type:14,label:1,typeName:".google.protobuf.GeneratedCodeInfo.Annotation.Semantic"}],enumType:[{name:"Semantic",value:[{name:"NONE",number:0},{name:"SET",number:1},{name:"ALIAS",number:2}]}]}]}],enumType:[{name:"Edition",value:[{name:"EDITION_UNKNOWN",number:0},{name:"EDITION_LEGACY",number:900},{name:"EDITION_PROTO2",number:998},{name:"EDITION_PROTO3",number:999},{name:"EDITION_2023",number:1e3},{name:"EDITION_2024",number:1001},{name:"EDITION_1_TEST_ONLY",number:1},{name:"EDITION_2_TEST_ONLY",number:2},{name:"EDITION_99997_TEST_ONLY",number:99997},{name:"EDITION_99998_TEST_ONLY",number:99998},{name:"EDITION_99999_TEST_ONLY",number:99999},{name:"EDITION_MAX",number:2147483647}]},{name:"SymbolVisibility",value:[{name:"VISIBILITY_UNSET",number:0},{name:"VISIBILITY_LOCAL",number:1},{name:"VISIBILITY_EXPORT",number:2}]}]}),zp=Y(Xp,1);var Sc;(function(t){t[t.DECLARATION=0]="DECLARATION",t[t.UNVERIFIED=1]="UNVERIFIED"})(Sc||(Sc={}));var Ic;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.GROUP=10]="GROUP",t[t.MESSAGE=11]="MESSAGE",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.ENUM=14]="ENUM",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(Ic||(Ic={}));var Ec;(function(t){t[t.OPTIONAL=1]="OPTIONAL",t[t.REPEATED=3]="REPEATED",t[t.REQUIRED=2]="REQUIRED"})(Ec||(Ec={}));var wc;(function(t){t[t.SPEED=1]="SPEED",t[t.CODE_SIZE=2]="CODE_SIZE",t[t.LITE_RUNTIME=3]="LITE_RUNTIME"})(wc||(wc={}));var Nc;(function(t){t[t.STRING=0]="STRING",t[t.CORD=1]="CORD",t[t.STRING_PIECE=2]="STRING_PIECE"})(Nc||(Nc={}));var Rc;(function(t){t[t.JS_NORMAL=0]="JS_NORMAL",t[t.JS_STRING=1]="JS_STRING",t[t.JS_NUMBER=2]="JS_NUMBER"})(Rc||(Rc={}));var Cc;(function(t){t[t.RETENTION_UNKNOWN=0]="RETENTION_UNKNOWN",t[t.RETENTION_RUNTIME=1]="RETENTION_RUNTIME",t[t.RETENTION_SOURCE=2]="RETENTION_SOURCE"})(Cc||(Cc={}));var Tc;(function(t){t[t.TARGET_TYPE_UNKNOWN=0]="TARGET_TYPE_UNKNOWN",t[t.TARGET_TYPE_FILE=1]="TARGET_TYPE_FILE",t[t.TARGET_TYPE_EXTENSION_RANGE=2]="TARGET_TYPE_EXTENSION_RANGE",t[t.TARGET_TYPE_MESSAGE=3]="TARGET_TYPE_MESSAGE",t[t.TARGET_TYPE_FIELD=4]="TARGET_TYPE_FIELD",t[t.TARGET_TYPE_ONEOF=5]="TARGET_TYPE_ONEOF",t[t.TARGET_TYPE_ENUM=6]="TARGET_TYPE_ENUM",t[t.TARGET_TYPE_ENUM_ENTRY=7]="TARGET_TYPE_ENUM_ENTRY",t[t.TARGET_TYPE_SERVICE=8]="TARGET_TYPE_SERVICE",t[t.TARGET_TYPE_METHOD=9]="TARGET_TYPE_METHOD"})(Tc||(Tc={}));var xc;(function(t){t[t.IDEMPOTENCY_UNKNOWN=0]="IDEMPOTENCY_UNKNOWN",t[t.NO_SIDE_EFFECTS=1]="NO_SIDE_EFFECTS",t[t.IDEMPOTENT=2]="IDEMPOTENT"})(xc||(xc={}));var Vc;(function(t){t[t.DEFAULT_SYMBOL_VISIBILITY_UNKNOWN=0]="DEFAULT_SYMBOL_VISIBILITY_UNKNOWN",t[t.EXPORT_ALL=1]="EXPORT_ALL",t[t.EXPORT_TOP_LEVEL=2]="EXPORT_TOP_LEVEL",t[t.LOCAL_ALL=3]="LOCAL_ALL",t[t.STRICT=4]="STRICT"})(Vc||(Vc={}));var Dc;(function(t){t[t.FIELD_PRESENCE_UNKNOWN=0]="FIELD_PRESENCE_UNKNOWN",t[t.EXPLICIT=1]="EXPLICIT",t[t.IMPLICIT=2]="IMPLICIT",t[t.LEGACY_REQUIRED=3]="LEGACY_REQUIRED"})(Dc||(Dc={}));var Oc;(function(t){t[t.ENUM_TYPE_UNKNOWN=0]="ENUM_TYPE_UNKNOWN",t[t.OPEN=1]="OPEN",t[t.CLOSED=2]="CLOSED"})(Oc||(Oc={}));var Lc;(function(t){t[t.REPEATED_FIELD_ENCODING_UNKNOWN=0]="REPEATED_FIELD_ENCODING_UNKNOWN",t[t.PACKED=1]="PACKED",t[t.EXPANDED=2]="EXPANDED"})(Lc||(Lc={}));var Bc;(function(t){t[t.UTF8_VALIDATION_UNKNOWN=0]="UTF8_VALIDATION_UNKNOWN",t[t.VERIFY=2]="VERIFY",t[t.NONE=3]="NONE"})(Bc||(Bc={}));var Wc;(function(t){t[t.MESSAGE_ENCODING_UNKNOWN=0]="MESSAGE_ENCODING_UNKNOWN",t[t.LENGTH_PREFIXED=1]="LENGTH_PREFIXED",t[t.DELIMITED=2]="DELIMITED"})(Wc||(Wc={}));var Pc;(function(t){t[t.JSON_FORMAT_UNKNOWN=0]="JSON_FORMAT_UNKNOWN",t[t.ALLOW=1]="ALLOW",t[t.LEGACY_BEST_EFFORT=2]="LEGACY_BEST_EFFORT"})(Pc||(Pc={}));var _c;(function(t){t[t.ENFORCE_NAMING_STYLE_UNKNOWN=0]="ENFORCE_NAMING_STYLE_UNKNOWN",t[t.STYLE2024=1]="STYLE2024",t[t.STYLE_LEGACY=2]="STYLE_LEGACY"})(_c||(_c={}));var Uc;(function(t){t[t.NONE=0]="NONE",t[t.SET=1]="SET",t[t.ALIAS=2]="ALIAS"})(Uc||(Uc={}));var kc;(function(t){t[t.EDITION_UNKNOWN=0]="EDITION_UNKNOWN",t[t.EDITION_LEGACY=900]="EDITION_LEGACY",t[t.EDITION_PROTO2=998]="EDITION_PROTO2",t[t.EDITION_PROTO3=999]="EDITION_PROTO3",t[t.EDITION_2023=1e3]="EDITION_2023",t[t.EDITION_2024=1001]="EDITION_2024",t[t.EDITION_1_TEST_ONLY=1]="EDITION_1_TEST_ONLY",t[t.EDITION_2_TEST_ONLY=2]="EDITION_2_TEST_ONLY",t[t.EDITION_99997_TEST_ONLY=99997]="EDITION_99997_TEST_ONLY",t[t.EDITION_99998_TEST_ONLY=99998]="EDITION_99998_TEST_ONLY",t[t.EDITION_99999_TEST_ONLY=99999]="EDITION_99999_TEST_ONLY",t[t.EDITION_MAX=2147483647]="EDITION_MAX"})(kc||(kc={}));var Fc;(function(t){t[t.VISIBILITY_UNSET=0]="VISIBILITY_UNSET",t[t.VISIBILITY_LOCAL=1]="VISIBILITY_LOCAL",t[t.VISIBILITY_EXPORT=2]="VISIBILITY_EXPORT"})(Fc||(Fc={}));const Zc={readUnknownFields:!0};function jp(t){return t?Object.assign(Object.assign({},Zc),t):Zc}function rt(t,e,n){const r=nt(t,void 0,!1);return af(r,new Po(e),jp(n),!1,e.byteLength),r.message}function af(t,e,n,r,s){var i;const o=r?e.len:e.pos+s;let a,c;const l=(i=t.getUnknown())!==null&&i!==void 0?i:[];for(;e.pos<o&&([a,c]=e.tag(),!(r&&c==Ae.EndGroup));){const u=t.findNumber(a);if(!u){const f=e.skip(c,a);n.readUnknownFields&&l.push({no:a,wireType:c,data:f});continue}cf(t,e,u,c,n)}if(r&&(c!=Ae.EndGroup||a!==s))throw new Error("invalid end group tag");l.length>0&&t.setUnknown(l)}function cf(t,e,n,r,s){var i;switch(n.fieldKind){case"scalar":t.set(n,rr(e,n.scalar));break;case"enum":const o=rr(e,y.INT32);if(n.enum.open)t.set(n,o);else if(n.enum.values.some(c=>c.number===o))t.set(n,o);else if(s.readUnknownFields){const c=[];Xi(o,c);const l=(i=t.getUnknown())!==null&&i!==void 0?i:[];l.push({no:n.number,wireType:r,data:new Uint8Array(c)}),t.setUnknown(l)}break;case"message":t.set(n,Ko(e,s,n,t.get(n)));break;case"list":Qp(e,r,t.get(n),s);break;case"map":Hp(e,t.get(n),s);break}}function Hp(t,e,n){const r=e.field();let s,i;const o=t.uint32(),a=t.pos+o;for(;t.pos<a;){const[c]=t.tag();switch(c){case 1:s=rr(t,r.mapKey);break;case 2:switch(r.mapKind){case"scalar":i=rr(t,r.scalar);break;case"enum":i=t.int32();break;case"message":i=Ko(t,n,r);break}break}}if(s===void 0&&(s=Ln(r.mapKey,!1)),i===void 0)switch(r.mapKind){case"scalar":i=Ln(r.scalar,!1);break;case"enum":i=r.enum.values[0].number;break;case"message":i=nt(r.message,void 0,!1);break}e.set(s,i)}function Qp(t,e,n,r){var s;const i=n.field();if(i.listKind==="message"){n.add(Ko(t,r,i));return}const o=(s=i.scalar)!==null&&s!==void 0?s:y.INT32;if(!(e==Ae.LengthDelimited&&o!=y.STRING&&o!=y.BYTES)){n.add(rr(t,o));return}const c=t.uint32()+t.pos;for(;t.pos<c;)n.add(rr(t,o))}function Ko(t,e,n,r){const s=n.delimitedEncoding,i=r??nt(n.message,void 0,!1);return af(i,t,e,s,s?n.number:t.uint32()),i}function rr(t,e){switch(e){case y.STRING:return t.string();case y.BOOL:return t.bool();case y.DOUBLE:return t.double();case y.FLOAT:return t.float();case y.INT32:return t.int32();case y.INT64:return t.int64();case y.UINT64:return t.uint64();case y.FIXED64:return t.fixed64();case y.BYTES:return t.bytes();case y.FIXED32:return t.fixed32();case y.SFIXED32:return t.sfixed32();case y.SFIXED64:return t.sfixed64();case y.SINT64:return t.sint64();case y.UINT32:return t.uint32();case y.SINT32:return t.sint32()}}function Ht(t,e){var n;const r=rt(zp,Go(t));return r.messageType.forEach(Mo),r.dependency=(n=e?.map(i=>i.proto.name))!==null&&n!==void 0?n:[],ef(r,i=>e?.find(o=>o.proto.name===i)).getFile(r.name)}const qp=Ht("Ch9nb29nbGUvcHJvdG9idWYvdGltZXN0YW1wLnByb3RvEg9nb29nbGUucHJvdG9idWYiKwoJVGltZXN0YW1wEg8KB3NlY29uZHMYASABKAMSDQoFbmFub3MYAiABKAVChQEKE2NvbS5nb29nbGUucHJvdG9idWZCDlRpbWVzdGFtcFByb3RvUAFaMmdvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL3RpbWVzdGFtcHBi+AEBogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM");function em(t){return new Date(tm(t))}function tm(t){return Number(t.seconds)*1e3+Math.round(t.nanos/1e6)}const nm=Ht("Ch5nb29nbGUvcHJvdG9idWYvZHVyYXRpb24ucHJvdG8SD2dvb2dsZS5wcm90b2J1ZiIqCghEdXJhdGlvbhIPCgdzZWNvbmRzGAEgASgDEg0KBW5hbm9zGAIgASgFQoMBChNjb20uZ29vZ2xlLnByb3RvYnVmQg1EdXJhdGlvblByb3RvUAFaMWdvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL2R1cmF0aW9ucGL4AQGiAgNHUEKqAh5Hb29nbGUuUHJvdG9idWYuV2VsbEtub3duVHlwZXNiBnByb3RvMw"),lf=Ht("Chlnb29nbGUvcHJvdG9idWYvYW55LnByb3RvEg9nb29nbGUucHJvdG9idWYiJgoDQW55EhAKCHR5cGVfdXJsGAEgASgJEg0KBXZhbHVlGAIgASgMQnYKE2NvbS5nb29nbGUucHJvdG9idWZCCEFueVByb3RvUAFaLGdvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL2FueXBiogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM"),rm=Y(lf,0),sm=3,Gc={writeUnknownFields:!0};function im(t){return t?Object.assign(Object.assign({},Gc),t):Gc}function dn(t,e,n){return Us(new Mu,im(n),nt(t,e)).finish()}function Us(t,e,n){var r;for(const s of n.sortedFields){if(!n.isSet(s)){if(s.presence==sm)throw new Error(`cannot encode ${s} to binary: required field not set`);continue}uf(t,e,n,s)}if(e.writeUnknownFields)for(const{no:s,wireType:i,data:o}of(r=n.getUnknown())!==null&&r!==void 0?r:[])t.tag(s,i).raw(o);return t}function uf(t,e,n,r){var s;switch(r.fieldKind){case"scalar":case"enum":ks(t,n.desc.typeName,r.name,(s=r.scalar)!==null&&s!==void 0?s:y.INT32,r.number,n.get(r));break;case"list":om(t,e,r,n.get(r));break;case"message":ff(t,e,r,n.get(r));break;case"map":for(const[i,o]of n.get(r))am(t,e,r,i,o);break}}function ks(t,e,n,r,s,i){hf(t.tag(s,cm(r)),e,n,r,i)}function ff(t,e,n,r){n.delimitedEncoding?Us(t.tag(n.number,Ae.StartGroup),e,r).tag(n.number,Ae.EndGroup):Us(t.tag(n.number,Ae.LengthDelimited).fork(),e,r).join()}function om(t,e,n,r){var s;if(n.listKind=="message"){for(const o of r)ff(t,e,n,o);return}const i=(s=n.scalar)!==null&&s!==void 0?s:y.INT32;if(n.packed){if(!r.size)return;t.tag(n.number,Ae.LengthDelimited).fork();for(const o of r)hf(t,n.parent.typeName,n.name,i,o);t.join();return}for(const o of r)ks(t,n.parent.typeName,n.name,i,n.number,o)}function am(t,e,n,r,s){var i;switch(t.tag(n.number,Ae.LengthDelimited).fork(),ks(t,n.parent.typeName,n.name,n.mapKey,1,r),n.mapKind){case"scalar":case"enum":ks(t,n.parent.typeName,n.name,(i=n.scalar)!==null&&i!==void 0?i:y.INT32,2,s);break;case"message":Us(t.tag(2,Ae.LengthDelimited).fork(),e,s).join();break}t.join()}function hf(t,e,n,r,s){try{switch(r){case y.STRING:t.string(s);break;case y.BOOL:t.bool(s);break;case y.DOUBLE:t.double(s);break;case y.FLOAT:t.float(s);break;case y.INT32:t.int32(s);break;case y.INT64:t.int64(s);break;case y.UINT64:t.uint64(s);break;case y.FIXED64:t.fixed64(s);break;case y.BYTES:t.bytes(s);break;case y.FIXED32:t.fixed32(s);break;case y.SFIXED32:t.sfixed32(s);break;case y.SFIXED64:t.sfixed64(s);break;case y.SINT64:t.sint64(s);break;case y.UINT32:t.uint32(s);break;case y.SINT32:t.sint32(s);break}}catch(i){throw i instanceof Error?new Error(`cannot encode field ${e}.${n} to binary: ${i.message}`):i}}function cm(t){switch(t){case y.BYTES:case y.STRING:return Ae.LengthDelimited;case y.DOUBLE:case y.FIXED64:case y.SFIXED64:return Ae.Bit64;case y.FIXED32:case y.SFIXED32:case y.FLOAT:return Ae.Bit32;default:return Ae.Varint}}function lm(t,e,n){let r=!1;return n||(n=B(rm),r=!0),n.value=dn(t,e),n.typeUrl=hm(e.$typeName),r?n:void 0}function um(t,e){if(t.typeUrl==="")return!1;const n=typeof e=="string"?e:e.typeName,r=df(t.typeUrl);return n===r}function fm(t,e){if(t.typeUrl==="")return;const n=e.kind=="message"?e:e.getMessage(df(t.typeUrl));if(!(!n||!um(t,n)))return rt(n,t.value)}function hm(t){return`type.googleapis.com/${t}`}function df(t){const e=t.lastIndexOf("/"),n=e>=0?t.substring(e+1):t;if(!n.length)throw new Error(`invalid type url: ${t}`);return n}const Jo=Ht("Chxnb29nbGUvcHJvdG9idWYvc3RydWN0LnByb3RvEg9nb29nbGUucHJvdG9idWYihAEKBlN0cnVjdBIzCgZmaWVsZHMYASADKAsyIy5nb29nbGUucHJvdG9idWYuU3RydWN0LkZpZWxkc0VudHJ5GkUKC0ZpZWxkc0VudHJ5EgsKA2tleRgBIAEoCRIlCgV2YWx1ZRgCIAEoCzIWLmdvb2dsZS5wcm90b2J1Zi5WYWx1ZToCOAEi6gEKBVZhbHVlEjAKCm51bGxfdmFsdWUYASABKA4yGi5nb29nbGUucHJvdG9idWYuTnVsbFZhbHVlSAASFgoMbnVtYmVyX3ZhbHVlGAIgASgBSAASFgoMc3RyaW5nX3ZhbHVlGAMgASgJSAASFAoKYm9vbF92YWx1ZRgEIAEoCEgAEi8KDHN0cnVjdF92YWx1ZRgFIAEoCzIXLmdvb2dsZS5wcm90b2J1Zi5TdHJ1Y3RIABIwCgpsaXN0X3ZhbHVlGAYgASgLMhouZ29vZ2xlLnByb3RvYnVmLkxpc3RWYWx1ZUgAQgYKBGtpbmQiMwoJTGlzdFZhbHVlEiYKBnZhbHVlcxgBIAMoCzIWLmdvb2dsZS5wcm90b2J1Zi5WYWx1ZSobCglOdWxsVmFsdWUSDgoKTlVMTF9WQUxVRRAAQn8KE2NvbS5nb29nbGUucHJvdG9idWZCC1N0cnVjdFByb3RvUAFaL2dvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL3N0cnVjdHBi+AEBogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM"),dm=Y(Jo,0),gf=Y(Jo,1),gm=Y(Jo,2);var qi;(function(t){t[t.NULL_VALUE=0]="NULL_VALUE"})(qi||(qi={}));const pm=Ht("Ch5nb29nbGUvcHJvdG9idWYvd3JhcHBlcnMucHJvdG8SD2dvb2dsZS5wcm90b2J1ZiIcCgtEb3VibGVWYWx1ZRINCgV2YWx1ZRgBIAEoASIbCgpGbG9hdFZhbHVlEg0KBXZhbHVlGAEgASgCIhsKCkludDY0VmFsdWUSDQoFdmFsdWUYASABKAMiHAoLVUludDY0VmFsdWUSDQoFdmFsdWUYASABKAQiGwoKSW50MzJWYWx1ZRINCgV2YWx1ZRgBIAEoBSIcCgtVSW50MzJWYWx1ZRINCgV2YWx1ZRgBIAEoDSIaCglCb29sVmFsdWUSDQoFdmFsdWUYASABKAgiHAoLU3RyaW5nVmFsdWUSDQoFdmFsdWUYASABKAkiGwoKQnl0ZXNWYWx1ZRINCgV2YWx1ZRgBIAEoDEKDAQoTY29tLmdvb2dsZS5wcm90b2J1ZkINV3JhcHBlcnNQcm90b1ABWjFnb29nbGUuZ29sYW5nLm9yZy9wcm90b2J1Zi90eXBlcy9rbm93bi93cmFwcGVyc3Bi+AEBogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM");function mm(t,e){pf(e,t);const n=ym(t.$unknown,e),[r,s,i]=ni(e);for(const o of n)cf(r,new Po(o.data),s,o.wireType,{readUnknownFields:!0});return i()}function bm(t,e,n){var r;pf(e,t);const s=((r=t.$unknown)!==null&&r!==void 0?r:[]).filter(l=>l.no!==e.number),[i,o]=ni(e,n),a=new Mu;uf(a,{writeUnknownFields:!0},i,o);const c=new Po(a.finish());for(;c.pos<c.len;){const[l,u]=c.tag(),f=c.skip(u,l);s.push({no:l,wireType:u,data:f})}t.$unknown=s}function ym(t,e){if(t===void 0)return[];if(e.fieldKind==="enum"||e.fieldKind==="scalar"){for(let n=t.length-1;n>=0;--n)if(t[n].no==e.number)return[t[n]];return[]}return t.filter(n=>n.no===e.number)}function ni(t,e){const n=t.typeName,r=Object.assign(Object.assign({},t),{kind:"field",parent:t.extendee,localName:n}),s=Object.assign(Object.assign({},t.extendee),{fields:[r],members:[r],oneofs:[]}),i=B(s,e!==void 0?{[n]:e}:void 0);return[nt(s,i),r,()=>{const o=i[n];if(o===void 0){const a=t.message;return ns(a)?Ln(a.fields[0].scalar,a.fields[0].longAsString):B(a)}return o}]}function pf(t,e){if(t.extendee.typeName!=e.$typeName)throw new Error(`extension ${t.typeName} can only be applied to message ${t.extendee.typeName}`)}const Am=3,vm=2,Mc={alwaysEmitImplicit:!1,enumAsInteger:!1,useProtoFieldName:!1};function Sm(t){return t?Object.assign(Object.assign({},Mc),t):Mc}function Im(t,e,n){return rs(nt(t,e),Sm(n))}function Em(t,e,n){var r;const s=Im(t,e,n);return JSON.stringify(s,null,(r=n?.prettySpaces)!==null&&r!==void 0?r:0)}function rs(t,e){var n;const r=Cm(t,e);if(r!==void 0)return r;const s={};for(const i of t.sortedFields){if(!t.isSet(i)){if(i.presence==Am)throw new Error(`cannot encode ${i} to JSON: required field not set`);if(!e.alwaysEmitImplicit||i.presence!==vm)continue}const o=Yc(i,t.get(i),e);o!==void 0&&(s[Rm(i,e)]=o)}if(e.registry){const i=new Set;for(const{no:o}of(n=t.getUnknown())!==null&&n!==void 0?n:[])if(!i.has(o)){i.add(o);const a=e.registry.getExtensionFor(t.desc,o);if(!a)continue;const c=mm(t.message,a),[l,u]=ni(a,c),f=Yc(u,l.get(u),e);f!==void 0&&(s[a.jsonName]=f)}}return s}function Yc(t,e,n){switch(t.fieldKind){case"scalar":return ri(t,e);case"message":return rs(e,n);case"enum":return $o(t.enum,e,n.enumAsInteger);case"list":return Nm(e,n);case"map":return wm(e,n)}}function wm(t,e){const n=t.field(),r={};switch(n.mapKind){case"scalar":for(const[s,i]of t)r[s]=ri(n,i);break;case"message":for(const[s,i]of t)r[s]=rs(i,e);break;case"enum":for(const[s,i]of t)r[s]=$o(n.enum,i,e.enumAsInteger);break}return e.alwaysEmitImplicit||t.size>0?r:void 0}function Nm(t,e){const n=t.field(),r=[];switch(n.listKind){case"scalar":for(const s of t)r.push(ri(n,s));break;case"enum":for(const s of t)r.push($o(n.enum,s,e.enumAsInteger));break;case"message":for(const s of t)r.push(rs(s,e));break}return e.alwaysEmitImplicit||r.length>0?r:void 0}function $o(t,e,n){var r;if(typeof e!="number")throw new Error(`cannot encode ${t} to JSON: expected number, got ${Ie(e)}`);if(t.typeName=="google.protobuf.NullValue")return null;if(n)return e;const s=t.value[e];return(r=s?.name)!==null&&r!==void 0?r:e}function ri(t,e){var n,r,s,i,o,a;switch(t.scalar){case y.INT32:case y.SFIXED32:case y.SINT32:case y.FIXED32:case y.UINT32:if(typeof e!="number")throw new Error(`cannot encode ${t} to JSON: ${(n=wn(t,e))===null||n===void 0?void 0:n.message}`);return e;case y.FLOAT:case y.DOUBLE:if(typeof e!="number")throw new Error(`cannot encode ${t} to JSON: ${(r=wn(t,e))===null||r===void 0?void 0:r.message}`);return Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case y.STRING:if(typeof e!="string")throw new Error(`cannot encode ${t} to JSON: ${(s=wn(t,e))===null||s===void 0?void 0:s.message}`);return e;case y.BOOL:if(typeof e!="boolean")throw new Error(`cannot encode ${t} to JSON: ${(i=wn(t,e))===null||i===void 0?void 0:i.message}`);return e;case y.UINT64:case y.FIXED64:case y.INT64:case y.SFIXED64:case y.SINT64:if(typeof e!="bigint"&&typeof e!="string")throw new Error(`cannot encode ${t} to JSON: ${(o=wn(t,e))===null||o===void 0?void 0:o.message}`);return e.toString();case y.BYTES:if(e instanceof Uint8Array)return pp(e);throw new Error(`cannot encode ${t} to JSON: ${(a=wn(t,e))===null||a===void 0?void 0:a.message}`)}}function Rm(t,e){return e.useProtoFieldName?t.name:t.jsonName}function Cm(t,e){if(t.desc.typeName.startsWith("google.protobuf."))switch(t.desc.typeName){case"google.protobuf.Any":return Tm(t.message,e);case"google.protobuf.Timestamp":return Dm(t.message);case"google.protobuf.Duration":return xm(t.message);case"google.protobuf.FieldMask":return Vm(t.message);case"google.protobuf.Struct":return mf(t.message);case"google.protobuf.Value":return Xo(t.message);case"google.protobuf.ListValue":return bf(t.message);default:if(ns(t.desc)){const n=t.desc.fields[0];return ri(n,t.get(n))}return}}function Tm(t,e){if(t.typeUrl==="")return{};const{registry:n}=e;let r,s;if(n&&(r=fm(t,n),r&&(s=n.getMessage(r.$typeName))),!s||!r)throw new Error(`cannot encode message ${t.$typeName} to JSON: "${t.typeUrl}" is not in the type registry`);let i=rs(nt(s,r),e);return(s.typeName.startsWith("google.protobuf.")||i===null||Array.isArray(i)||typeof i!="object")&&(i={value:i}),i["@type"]=t.typeUrl,i}function xm(t){const e=Number(t.seconds),n=t.nanos;if(e>315576e6||e<-315576e6)throw new Error(`cannot encode message ${t.$typeName} to JSON: value out of range`);if(e>0&&n<0||e<0&&n>0)throw new Error(`cannot encode message ${t.$typeName} to JSON: nanos sign must match seconds sign`);let r=t.seconds.toString();if(n!==0){let s=Math.abs(n).toString();s="0".repeat(9-s.length)+s,s.substring(3)==="000000"?s=s.substring(0,3):s.substring(6)==="000"&&(s=s.substring(0,6)),r+="."+s,n<0&&e==0&&(r="-"+r)}return r+"s"}function Vm(t){return t.paths.map(e=>{if(e.match(/_[0-9]?_/g)||e.match(/[A-Z]/g))throw new Error(`cannot encode message ${t.$typeName} to JSON: lowerCamelCase of path name "`+e+'" is irreversible');return Yr(e)}).join(",")}function mf(t){const e={};for(const[n,r]of Object.entries(t.fields))e[n]=Xo(r);return e}function Xo(t){switch(t.kind.case){case"nullValue":return null;case"numberValue":if(!Number.isFinite(t.kind.value))throw new Error(`${t.$typeName} cannot be NaN or Infinity`);return t.kind.value;case"boolValue":return t.kind.value;case"stringValue":return t.kind.value;case"structValue":return mf(t.kind.value);case"listValue":return bf(t.kind.value);default:throw new Error(`${t.$typeName} must have a value`)}}function bf(t){return t.values.map(Xo)}function Dm(t){const e=Number(t.seconds)*1e3;if(e<Date.parse("0001-01-01T00:00:00Z")||e>Date.parse("9999-12-31T23:59:59Z"))throw new Error(`cannot encode message ${t.$typeName} to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive`);if(t.nanos<0)throw new Error(`cannot encode message ${t.$typeName} to JSON: nanos must not be negative`);if(t.nanos>999999999)throw new Error(`cannot encode message ${t.$typeName} to JSON: nanos must not be greater than 99999999`);let n="Z";if(t.nanos>0){const r=(t.nanos+1e9).toString().substring(1);r.substring(3)==="000000"?n="."+r.substring(0,3)+"Z":r.substring(6)==="000"?n="."+r.substring(0,6)+"Z":n="."+r+"Z"}return new Date(e).toISOString().replace(".000Z",n)}const Kc={ignoreUnknownFields:!1};function Om(t){return t?Object.assign(Object.assign({},Kc),t):Kc}function Lm(t,e,n){return Bm(t,Zm(e,t.typeName),n)}function Bm(t,e,n){const r=nt(t);try{sr(r,e,Om(n))}catch(s){throw cp(s)?new Error(`cannot decode ${s.field()} from JSON: ${s.message}`,{cause:s}):s}return r.message}function sr(t,e,n){var r;if(Gm(t,e,n))return;if(e==null||Array.isArray(e)||typeof e!="object")throw new Error(`cannot decode ${t.desc} from JSON: ${Ie(e)}`);const s=new Map,i=new Map;for(const o of t.desc.fields)i.set(o.name,o).set(o.jsonName,o);for(const[o,a]of Object.entries(e)){const c=i.get(o);if(c){if(c.oneof){if(a===null&&c.fieldKind=="scalar")continue;const l=s.get(c.oneof);if(l!==void 0)throw new Ge(c.oneof,`oneof set multiple times by ${l.name} and ${c.name}`);s.set(c.oneof,c)}Jc(t,c,a,n)}else{let l;if(o.startsWith("[")&&o.endsWith("]")&&(l=(r=n.registry)===null||r===void 0?void 0:r.getExtension(o.substring(1,o.length-1)))&&l.extendee.typeName===t.desc.typeName){const[u,f,b]=ni(l);Jc(u,f,a,n),bm(t.message,l,b())}if(!l&&!n.ignoreUnknownFields)throw new Error(`cannot decode ${t.desc} from JSON: key "${o}" is unknown`)}}}function Jc(t,e,n,r){switch(e.fieldKind){case"scalar":km(t,e,n);break;case"enum":Um(t,e,n,r);break;case"message":_m(t,e,n,r);break;case"list":Pm(t.get(e),n,r);break;case"map":Wm(t.get(e),n,r);break}}function Wm(t,e,n){if(e===null)return;const r=t.field();if(typeof e!="object"||Array.isArray(e))throw new Ge(r,"expected object, got "+Ie(e));for(const[s,i]of Object.entries(e)){if(i===null)throw new Ge(r,"map value must not be null");let o;switch(r.mapKind){case"message":const c=nt(r.message);sr(c,i,n),o=c;break;case"enum":if(o=zo(r.enum,i,n.ignoreUnknownFields,!0),o===si)return;break;case"scalar":o=oi(r,i,!0);break}const a=Fm(r.mapKey,s);t.set(a,o)}}function Pm(t,e,n){if(e===null)return;const r=t.field();if(!Array.isArray(e))throw new Ge(r,"expected Array, got "+Ie(e));for(const s of e){if(s===null)throw new Ge(r,"list item must not be null");switch(r.listKind){case"message":const i=nt(r.message);sr(i,s,n),t.add(i);break;case"enum":const o=zo(r.enum,s,n.ignoreUnknownFields,!0);o!==si&&t.add(o);break;case"scalar":t.add(oi(r,s,!0));break}}}function _m(t,e,n,r){if(n===null&&e.message.typeName!="google.protobuf.Value"){t.clear(e);return}const s=t.isSet(e)?t.get(e):nt(e.message);sr(s,n,r),t.set(e,s)}function Um(t,e,n,r){const s=zo(e.enum,n,r.ignoreUnknownFields,!1);s===ii?t.clear(e):s!==si&&t.set(e,s)}function km(t,e,n){const r=oi(e,n,!1);r===ii?t.clear(e):t.set(e,r)}const si=Symbol();function zo(t,e,n,r){if(e===null)return t.typeName=="google.protobuf.NullValue"?0:r?t.values[0].number:ii;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const s=t.values.find(i=>i.name===e);if(s!==void 0)return s.number;if(n)return si;break}throw new Error(`cannot decode ${t} from JSON: ${Ie(e)}`)}const ii=Symbol();function oi(t,e,n){if(e===null)return n?Ln(t.scalar,!1):ii;switch(t.scalar){case y.DOUBLE:case y.FLOAT:if(e==="NaN")return NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(typeof e=="number"){if(Number.isNaN(e))throw new Ge(t,"unexpected NaN number");if(!Number.isFinite(e))throw new Ge(t,"unexpected infinite number");break}if(typeof e=="string"){if(e===""||e.trim().length!==e.length)break;const r=Number(e);if(!Number.isFinite(r))break;return r}break;case y.INT32:case y.FIXED32:case y.SFIXED32:case y.SINT32:case y.UINT32:return yf(e);case y.BYTES:if(typeof e=="string"){if(e==="")return new Uint8Array(0);try{return Go(e)}catch(r){const s=r instanceof Error?r.message:String(r);throw new Ge(t,s)}}break}return e}function Fm(t,e){switch(t){case y.BOOL:switch(e){case"true":return!0;case"false":return!1}return e;case y.INT32:case y.FIXED32:case y.UINT32:case y.SFIXED32:case y.SINT32:return yf(e);default:return e}}function yf(t){if(typeof t=="string"){if(t===""||t.trim().length!==t.length)return t;const e=Number(t);return Number.isNaN(e)?t:e}return t}function Zm(t,e){try{return JSON.parse(t)}catch(n){const r=n instanceof Error?n.message:String(n);throw new Error(`cannot decode message ${e} from JSON: ${r}`,{cause:n})}}function Gm(t,e,n){if(!t.desc.typeName.startsWith("google.protobuf."))return!1;switch(t.desc.typeName){case"google.protobuf.Any":return Mm(t.message,e,n),!0;case"google.protobuf.Timestamp":return Ym(t.message,e),!0;case"google.protobuf.Duration":return Km(t.message,e),!0;case"google.protobuf.FieldMask":return Jm(t.message,e),!0;case"google.protobuf.Struct":return Af(t.message,e),!0;case"google.protobuf.Value":return jo(t.message,e),!0;case"google.protobuf.ListValue":return vf(t.message,e),!0;default:if(ns(t.desc)){const r=t.desc.fields[0];return e===null?t.clear(r):t.set(r,oi(r,e,!0)),!0}return!1}}function Mm(t,e,n){var r;if(e===null||Array.isArray(e)||typeof e!="object")throw new Error(`cannot decode message ${t.$typeName} from JSON: expected object but got ${Ie(e)}`);if(Object.keys(e).length==0)return;const s=e["@type"];if(typeof s!="string"||s=="")throw new Error(`cannot decode message ${t.$typeName} from JSON: "@type" is empty`);const i=s.includes("/")?s.substring(s.lastIndexOf("/")+1):s;if(!i.length)throw new Error(`cannot decode message ${t.$typeName} from JSON: "@type" is invalid`);const o=(r=n.registry)===null||r===void 0?void 0:r.getMessage(i);if(!o)throw new Error(`cannot decode message ${t.$typeName} from JSON: ${s} is not in the type registry`);const a=nt(o);if(i.startsWith("google.protobuf.")&&Object.prototype.hasOwnProperty.call(e,"value")){const c=e.value;sr(a,c,n)}else{const c=Object.assign({},e);delete c["@type"],sr(a,c,n)}lm(a.desc,a.message,t)}function Ym(t,e){if(typeof e!="string")throw new Error(`cannot decode message ${t.$typeName} from JSON: ${Ie(e)}`);const n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:\.([0-9]{1,9}))?(?:Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error(`cannot decode message ${t.$typeName} from JSON: invalid RFC 3339 string`);const r=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(r))throw new Error(`cannot decode message ${t.$typeName} from JSON: invalid RFC 3339 string`);if(r<Date.parse("0001-01-01T00:00:00Z")||r>Date.parse("9999-12-31T23:59:59Z"))throw new Error(`cannot decode message ${t.$typeName} from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive`);t.seconds=ge.parse(r/1e3),t.nanos=0,n[7]&&(t.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9)}function Km(t,e){if(typeof e!="string")throw new Error(`cannot decode message ${t.$typeName} from JSON: ${Ie(e)}`);const n=e.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(n===null)throw new Error(`cannot decode message ${t.$typeName} from JSON: ${Ie(e)}`);const r=Number(n[1]);if(r>315576e6||r<-315576e6)throw new Error(`cannot decode message ${t.$typeName} from JSON: ${Ie(e)}`);if(t.seconds=ge.parse(r),typeof n[2]!="string")return;const s=n[2]+"0".repeat(9-n[2].length);t.nanos=parseInt(s),(r<0||Object.is(r,-0))&&(t.nanos=-t.nanos)}function Jm(t,e){if(typeof e!="string")throw new Error(`cannot decode message ${t.$typeName} from JSON: ${Ie(e)}`);if(e==="")return;function n(r){if(r.includes("_"))throw new Error(`cannot decode message ${t.$typeName} from JSON: path names must be lowerCamelCase`);const s=r.replace(/[A-Z]/g,i=>"_"+i.toLowerCase());return s[0]==="_"?s.substring(1):s}t.paths=e.split(",").map(n)}function Af(t,e){if(typeof e!="object"||e==null||Array.isArray(e))throw new Error(`cannot decode message ${t.$typeName} from JSON ${Ie(e)}`);for(const[n,r]of Object.entries(e)){const s=B(gf);jo(s,r),t.fields[n]=s}}function jo(t,e){switch(typeof e){case"number":t.kind={case:"numberValue",value:e};break;case"string":t.kind={case:"stringValue",value:e};break;case"boolean":t.kind={case:"boolValue",value:e};break;case"object":if(e===null)t.kind={case:"nullValue",value:qi.NULL_VALUE};else if(Array.isArray(e)){const n=B(gm);vf(n,e),t.kind={case:"listValue",value:n}}else{const n=B(dm);Af(n,e),t.kind={case:"structValue",value:n}}break;default:throw new Error(`cannot decode message ${t.$typeName} from JSON ${Ie(e)}`)}return t}function vf(t,e){if(!Array.isArray(e))throw new Error(`cannot decode message ${t.$typeName} from JSON ${Ie(e)}`);for(const n of e){const r=B(gf);jo(r,n),t.values.push(r)}}function $c(t){const e=z[t];return typeof e!="string"?t.toString():e[0].toLowerCase()+e.substring(1).replace(/[A-Z]/g,n=>"_"+n.toLowerCase())}class se extends Error{constructor(e,n=z.Unknown,r,s,i){super($m(e,n)),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=e,this.code=n,this.metadata=new Headers(r??{}),this.details=s??[],this.cause=i}static from(e,n=z.Unknown){return e instanceof se?e:e instanceof Error?e.name=="AbortError"||e.name=="TimeoutError"?new se(e.message,z.Canceled):new se(e.message,n,void 0,void 0,e):new se(String(e),n,void 0,void 0,e)}static[Symbol.hasInstance](e){return e instanceof Error?Object.getPrototypeOf(e)===se.prototype?!0:e.name==="ConnectError"&&"code"in e&&typeof e.code=="number"&&"metadata"in e&&"details"in e&&Array.isArray(e.details)&&"rawMessage"in e&&typeof e.rawMessage=="string"&&"cause"in e:!1}findDetails(e){const n=e.kind==="message"?{getMessage:s=>s===e.typeName?e:void 0}:e,r=[];for(const s of this.details){if("desc"in s){n.getMessage(s.desc.typeName)&&r.push(B(s.desc,s.value));continue}const i=n.getMessage(s.type);if(i)try{r.push(rt(i,s.value))}catch{}}return r}}function $m(t,e){return t.length?`[${$c(e)}] ${t}`:`[${$c(e)}]`}function Xm(t,e,n){try{const r=Go(t);return e?rt(e,r,n):r}catch(r){throw se.from(r,z.DataLoss)}}function zm(t,e){const n={};for(const r of t.methods){const s=e(r);s!=null&&(n[r.localName]=s)}return n}const Xc=1;function jm(t,e,n=!1){if(e>t){let r=`message size is larger than configured readMaxBytes ${t}`;throw n&&(r=`message size ${e} is larger than configured readMaxBytes ${t}`),new se(r,z.ResourceExhausted)}}function Hm(t){return new Qm(t)}class Qm{constructor(e){this.readMaxBytes=e,this.header=new Uint8Array(5),this.headerView=new DataView(this.header.buffer),this.buf=[]}get byteLength(){return this.buf.reduce((e,n)=>e+n.byteLength,0)}decode(e){this.buf.push(e);const n=[];for(;;){let r=this.pop();if(!r)break;n.push(r)}return n}pop(){if(!(!this.env&&(this.env=this.head(),!this.env))&&this.cons(this.env.data)){const e=this.env;return this.env=void 0,e}}head(){if(!this.cons(this.header))return;const e=this.headerView.getUint8(0),n=this.headerView.getUint32(1);return jm(this.readMaxBytes,n,!0),{flags:e,data:new Uint8Array(n)}}cons(e){const n=e.byteLength;if(this.byteLength<n)return!1;let r=0;for(;r<n;){const s=this.buf.shift();s.byteLength>n-r?(e.set(s.subarray(0,n-r),r),this.buf.unshift(s.subarray(n-r)),r+=n-r):(e.set(s,r),r+=s.byteLength)}return!0}}function zc(t){let e;const n=Hm(4294967295);return new ReadableStream({start(){e=t.getReader()},async pull(r){let s=!1;for(;!s;){const i=await e.read();if(i.done)n.byteLength>0&&r.error(new se("protocol error: incomplete envelope",z.InvalidArgument)),r.close();else for(const o of n.decode(i.value))r.enqueue(o),s=!0}}})}function jc(t,e){const n=new Uint8Array(e.length+5);n.set(e,5);const r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.setUint8(0,t),r.setUint32(1,e.length),n}var qm=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}},$r=function(t){return this instanceof $r?(this.v=t,this):new $r(t)},eb=function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(d){return function(A){return Promise.resolve(A).then(d,f)}}function a(d,A){r[d]&&(s[d]=function(S){return new Promise(function(W,L){i.push([d,S,W,L])>1||c(d,S)})},A&&(s[d]=A(s[d])))}function c(d,A){try{l(r[d](A))}catch(S){b(i[0][3],S)}}function l(d){d.value instanceof $r?Promise.resolve(d.value.v).then(u,f):b(i[0][2],d)}function u(d){c("next",d)}function f(d){c("throw",d)}function b(d,A){d(A),i.shift(),i.length&&c(i[0][0],i[0][1])}},tb=function(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:$r(t[s](o)),done:!1}:i?i(o):o}:i}};function nb(t){return eb(this,arguments,function*(){yield $r(yield*tb(qm(t)))})}var Sf=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}},ir=function(t){return this instanceof ir?(this.v=t,this):new ir(t)},rb=function(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:ir(t[s](o)),done:!1}:i?i(o):o}:i}},sb=function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(d){return function(A){return Promise.resolve(A).then(d,f)}}function a(d,A){r[d]&&(s[d]=function(S){return new Promise(function(W,L){i.push([d,S,W,L])>1||c(d,S)})},A&&(s[d]=A(s[d])))}function c(d,A){try{l(r[d](A))}catch(S){b(i[0][3],S)}}function l(d){d.value instanceof ir?Promise.resolve(d.value.v).then(u,f):b(i[0][2],d)}function u(d){c("next",d)}function f(d){c("throw",d)}function b(d,A){d(A),i.shift(),i.length&&c(i[0][0],i[0][1])}};function ib(t,e){return zm(t,n=>{switch(n.methodKind){case"unary":return ob(e,n);case"server_streaming":return ab(e,n);case"client_streaming":return cb(e,n);case"bidi_streaming":return lb(e,n);default:return null}})}function ob(t,e){return async(n,r)=>{var s,i;const o=await t.unary(e,r?.signal,r?.timeoutMs,r?.headers,n,r?.contextValues);return(s=r?.onHeader)===null||s===void 0||s.call(r,o.header),(i=r?.onTrailer)===null||i===void 0||i.call(r,o.trailer),o.message}}function ab(t,e){return(n,r)=>If(t.stream(e,r?.signal,r?.timeoutMs,r?.headers,nb([n]),r?.contextValues),r)}function cb(t,e){return async(n,r)=>{var s,i,o,a,c,l;const u=await t.stream(e,r?.signal,r?.timeoutMs,r?.headers,n,r?.contextValues);(c=r?.onHeader)===null||c===void 0||c.call(r,u.header);let f,b=0;try{for(var d=!0,A=Sf(u.message),S;S=await A.next(),s=S.done,!s;d=!0)a=S.value,d=!1,f=a,b++}catch(W){i={error:W}}finally{try{!d&&!s&&(o=A.return)&&await o.call(A)}finally{if(i)throw i.error}}if(!f)throw new se("protocol error: missing response message",z.Unimplemented);if(b>1)throw new se("protocol error: received extra messages for client streaming method",z.Unimplemented);return(l=r?.onTrailer)===null||l===void 0||l.call(r,u.trailer),f}}function lb(t,e){return(n,r)=>If(t.stream(e,r?.signal,r?.timeoutMs,r?.headers,n,r?.contextValues),r)}function If(t,e){const n=(function(){return sb(this,arguments,function*(){var r,s;const i=yield ir(t);(r=e?.onHeader)===null||r===void 0||r.call(e,i.header),yield ir(yield*rb(Sf(i.message))),(s=e?.onTrailer)===null||s===void 0||s.call(e,i.trailer)})})()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>n.next()})}}function ub(...t){const e=new AbortController,n=t.filter(s=>s!==void 0).concat(e.signal);for(const s of n){if(s.aborted){r.apply(s);break}s.addEventListener("abort",r)}function r(){e.signal.aborted||e.abort(Ef(this));for(const s of n)s.removeEventListener("abort",r)}return e}function fb(t){const e=new AbortController,n=()=>{e.abort(new se("the operation timed out",z.DeadlineExceeded))};let r;return t!==void 0&&(t<=0?n():r=setTimeout(n,t)),{signal:e.signal,cleanup:()=>clearTimeout(r)}}function Ef(t){if(!t.aborted)return;if(t.reason!==void 0)return t.reason;const e=new Error("This operation was aborted");return e.name="AbortError",e}function Hc(){return{get(t){return t.id in this?this[t.id]:t.defaultValue},set(t,e){return this[t.id]=e,this},delete(t){return delete this[t.id],this}}}const Oi=128;function Qc(t){const e=new Headers,n=new TextDecoder().decode(t).split(`\r
`);for(const r of n){if(r==="")continue;const s=r.indexOf(":");if(s>0){const i=r.substring(0,s).trim(),o=r.substring(s+1).trim();e.append(i,o)}}return e}const hb="Content-Type",db="Grpc-Timeout",or="Grpc-Status",wf="Grpc-Message",gb="Grpc-Status-Details-Bin",pb="User-Agent",qc="X-User-Agent",mb="X-Grpc-Web",bb="application/grpc-web+proto",yb="application/grpc-web+json";function Ab(t,e,...n){if(n.length>0)throw new Error;return t.services[e]}const vb=Ht("CgxzdGF0dXMucHJvdG8SCmdvb2dsZS5ycGMiTgoGU3RhdHVzEgwKBGNvZGUYASABKAUSDwoHbWVzc2FnZRgCIAEoCRIlCgdkZXRhaWxzGAMgAygLMhQuZ29vZ2xlLnByb3RvYnVmLkFueUJeCg5jb20uZ29vZ2xlLnJwY0ILU3RhdHVzUHJvdG9QAVo3Z29vZ2xlLmdvbGFuZy5vcmcvZ2VucHJvdG8vZ29vZ2xlYXBpcy9ycGMvc3RhdHVzO3N0YXR1c6ICA1JQQ2IGcHJvdG8z",[lf]),Sb=Y(vb,0),Ib="0";function Nf(t){var e;const n=t.get(gb);if(n!=null){const s=Xm(n,Sb);if(s.code==0)return;const i=new se(s.message,s.code,t);return i.details=s.details.map(o=>({type:o.typeUrl.substring(o.typeUrl.lastIndexOf("/")+1),value:o.value})),i}const r=t.get(or);if(r!=null){if(r===Ib)return;const s=parseInt(r,10);return s in z?new se(decodeURIComponent((e=t.get(wf))!==null&&e!==void 0?e:""),s,t):new se(`invalid grpc-status: ${r}`,z.Internal,t)}}function el(t,e){return t.toString().replace(/\/?$/,`/${e.parent.typeName}/${e.name}`)}function Rf(t,e){return B(t,e)}function Eb(t,e){function n(r){return r.done===!0?r:{done:r.done,value:Rf(t,r.value)}}return{[Symbol.asyncIterator](){const r=e[Symbol.asyncIterator](),s={next:()=>r.next().then(n)};return r.throw!==void 0&&(s.throw=i=>r.throw(i).then(n)),r.return!==void 0&&(s.return=i=>r.return(i).then(n)),s}}}function Cf(t,e){if(!e)return t;for(const n of e.concat().reverse())t=n(t);return t}function wb(t){var e;const n=Object.assign({},t);return(e=n.ignoreUnknownFields)!==null&&e!==void 0||(n.ignoreUnknownFields=!0),n}function tl(t,e,n,r){const s=e?nl(t.input,r):rl(t.input,n);return{parse:(e?nl(t.output,r):rl(t.output,n)).parse,serialize:s.serialize}}function nl(t,e){return{parse(n){try{return rt(t,n,e)}catch(r){const s=r instanceof Error?r.message:String(r);throw new se(`parse binary: ${s}`,z.Internal)}},serialize(n){try{return dn(t,n,e)}catch(r){const s=r instanceof Error?r.message:String(r);throw new se(`serialize binary: ${s}`,z.Internal)}}}}function rl(t,e){var n,r;const s=(n=e?.textEncoder)!==null&&n!==void 0?n:new TextEncoder,i=(r=e?.textDecoder)!==null&&r!==void 0?r:new TextDecoder,o=wb(e);return{parse(a){try{const c=i.decode(a);return Lm(t,c,o)}catch(c){throw se.from(c,z.InvalidArgument)}},serialize(a){try{const c=Em(t,a,o);return s.encode(c)}catch(c){throw se.from(c,z.Internal)}}}}function Nb(t){const e=Cf(t.next,t.interceptors),[n,r,s]=Tf(t),i=Object.assign(Object.assign({},t.req),{message:Rf(t.req.method.input,t.req.message),signal:n});return e(i).then(o=>(s(),o),r)}function Rb(t){const e=Cf(t.next,t.interceptors),[n,r,s]=Tf(t),i=Object.assign(Object.assign({},t.req),{message:Eb(t.req.method.input,t.req.message),signal:n});let o=!1;return n.addEventListener("abort",function(){var a,c;const l=t.req.message[Symbol.asyncIterator]();o||(a=l.throw)===null||a===void 0||a.call(l,this.reason).catch(()=>{}),(c=l.return)===null||c===void 0||c.call(l).catch(()=>{})}),e(i).then(a=>Object.assign(Object.assign({},a),{message:{[Symbol.asyncIterator](){const c=a.message[Symbol.asyncIterator]();return{next(){return c.next().then(l=>(l.done==!0&&(o=!0,s()),l),r)}}}}}),r)}function Tf(t){const{signal:e,cleanup:n}=fb(t.timeoutMs),r=ub(t.signal,e);return[r.signal,function(i){const o=se.from(e.aborted?Ef(e):i);return r.abort(o),n(),Promise.reject(o)},function(){n(),r.abort()}]}function Cb(){try{new Headers}catch{throw new Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}}function sl(t,e){const n=Nf(t);if(n)throw e.forEach((r,s)=>{n.metadata.append(s,r)}),n;if(!e.has(or)&&!t.has(or))throw new se("protocol error: missing status",z.Internal)}function il(t,e,n,r){var s,i;const o=new Headers(n??{});o.set(hb,t?bb:yb),o.set(mb,"1");const a=(i=(s=o.get(pb))!==null&&s!==void 0?s:o.get(qc))!==null&&i!==void 0?i:"connect-es/2.1.1";return o.set(qc,a),e!==void 0&&o.set(db,`${e}m`),o}function Tb(t){switch(t){case 400:return z.Internal;case 401:return z.Unauthenticated;case 403:return z.PermissionDenied;case 404:return z.Unimplemented;case 429:return z.Unavailable;case 502:return z.Unavailable;case 503:return z.Unavailable;case 504:return z.Unavailable;default:return z.Unknown}}function ol(t,e){var n;if(t>=200&&t<300)return{foundStatus:e.has(or),headerError:Nf(e)};throw new se(decodeURIComponent((n=e.get(wf))!==null&&n!==void 0?n:`HTTP ${t}`),Tb(t),e)}var Cn=function(t){return this instanceof Cn?(this.v=t,this):new Cn(t)},xb=function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(d){return function(A){return Promise.resolve(A).then(d,f)}}function a(d,A){r[d]&&(s[d]=function(S){return new Promise(function(W,L){i.push([d,S,W,L])>1||c(d,S)})},A&&(s[d]=A(s[d])))}function c(d,A){try{l(r[d](A))}catch(S){b(i[0][3],S)}}function l(d){d.value instanceof Cn?Promise.resolve(d.value.v).then(u,f):b(i[0][2],d)}function u(d){c("next",d)}function f(d){c("throw",d)}function b(d,A){d(A),i.shift(),i.length&&c(i[0][0],i[0][1])}};const al={redirect:"error"};function Vb(t){var e;Cb();const n=(e=t.useBinaryFormat)!==null&&e!==void 0?e:!0;return{async unary(r,s,i,o,a,c){const{serialize:l,parse:u}=tl(r,n,t.jsonOptions,t.binaryOptions);return i=i===void 0?t.defaultTimeoutMs:i<=0?void 0:i,await Nb({interceptors:t.interceptors,signal:s,timeoutMs:i,req:{stream:!1,service:r.parent,method:r,requestMethod:"POST",url:el(t.baseUrl,r),header:il(n,i,o),contextValues:c??Hc(),message:a},next:async f=>{var b;const A=await((b=t.fetch)!==null&&b!==void 0?b:globalThis.fetch)(f.url,Object.assign(Object.assign({},al),{method:f.requestMethod,headers:f.header,signal:f.signal,body:jc(0,l(f.message))})),{headerError:S}=ol(A.status,A.headers);if(!A.body)throw S!==void 0?S:"missing response body";const W=zc(A.body).getReader();let L,G;for(;;){const _=await W.read();if(_.done)break;const{flags:D,data:U}=_.value;if((D&Xc)===Xc)throw new se("protocol error: received unsupported compressed output",z.Internal);if(D===Oi){if(L!==void 0)throw"extra trailer";L=Qc(U);continue}if(G!==void 0)throw new se("extra message",z.Unimplemented);G=u(U)}if(L===void 0)throw S!==void 0?S:new se("missing trailer",A.headers.has(or)?z.Unimplemented:z.Unknown);if(sl(L,A.headers),G===void 0)throw new se("missing message",L.has(or)?z.Unimplemented:z.Unknown);return{stream:!1,service:r.parent,method:r,header:A.headers,message:G,trailer:L}}})},async stream(r,s,i,o,a,c){const{serialize:l,parse:u}=tl(r,n,t.jsonOptions,t.binaryOptions);function f(d,A,S,W,L){return xb(this,arguments,function*(){const _=zc(d).getReader();if(A){if(!(yield Cn(_.read())).done)throw"extra data for trailers-only";return yield Cn(void 0)}let D=!1;for(;;){const U=yield Cn(_.read());if(U.done)break;const{flags:ie,data:j}=U.value;if((ie&Oi)===Oi){if(D)throw"extra trailer";D=!0;const ne=Qc(j);sl(ne,W),ne.forEach((Ot,je)=>S.set(je,Ot));continue}if(D)throw"extra message";yield yield Cn(u(j))}if("throwIfAborted"in L&&L.throwIfAborted(),!D)throw"missing trailer"})}async function b(d){if(r.methodKind!="server_streaming")throw"The fetch API does not support streaming request bodies";const A=await d[Symbol.asyncIterator]().next();if(A.done==!0)throw"missing request message";return jc(0,l(A.value))}return i=i===void 0?t.defaultTimeoutMs:i<=0?void 0:i,Rb({interceptors:t.interceptors,signal:s,timeoutMs:i,req:{stream:!0,service:r.parent,method:r,requestMethod:"POST",url:el(t.baseUrl,r),header:il(n,i,o),contextValues:c??Hc(),message:a},next:async d=>{var A;const W=await((A=t.fetch)!==null&&A!==void 0?A:globalThis.fetch)(d.url,Object.assign(Object.assign({},al),{method:d.requestMethod,headers:d.header,signal:d.signal,body:await b(d.message)})),{foundStatus:L,headerError:G}=ol(W.status,W.headers);if(G!=null)throw G;if(!W.body)throw"missing response body";const _=new Headers;return Object.assign(Object.assign({},d),{header:W.headers,trailer:_,message:f(W.body,L,_,W.headers,d.signal)})}})}}}const X=Ht("CiFzcmMvYXBpL3lvcmtpZS92MS9yZXNvdXJjZXMucHJvdG8SCXlvcmtpZS52MSKuAQoIU25hcHNob3QSJAoEcm9vdBgBIAEoCzIWLnlvcmtpZS52MS5KU09ORWxlbWVudBI1CglwcmVzZW5jZXMYAiADKAsyIi55b3JraWUudjEuU25hcHNob3QuUHJlc2VuY2VzRW50cnkaRQoOUHJlc2VuY2VzRW50cnkSCwoDa2V5GAEgASgJEiIKBXZhbHVlGAIgASgLMhMueW9ya2llLnYxLlByZXNlbmNlOgI4ASL7AQoKQ2hhbmdlUGFjaxIUCgxkb2N1bWVudF9rZXkYASABKAkSKQoKY2hlY2twb2ludBgCIAEoCzIVLnlvcmtpZS52MS5DaGVja3BvaW50EhAKCHNuYXBzaG90GAMgASgMEiIKB2NoYW5nZXMYBCADKAsyES55b3JraWUudjEuQ2hhbmdlEjAKEW1pbl9zeW5jZWRfdGlja2V0GAUgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSEgoKaXNfcmVtb3ZlZBgGIAEoCBIwCg52ZXJzaW9uX3ZlY3RvchgHIAEoCzIYLnlvcmtpZS52MS5WZXJzaW9uVmVjdG9yIpgBCgZDaGFuZ2USHwoCaWQYASABKAsyEy55b3JraWUudjEuQ2hhbmdlSUQSDwoHbWVzc2FnZRgCIAEoCRIoCgpvcGVyYXRpb25zGAMgAygLMhQueW9ya2llLnYxLk9wZXJhdGlvbhIyCg9wcmVzZW5jZV9jaGFuZ2UYBCABKAsyGS55b3JraWUudjEuUHJlc2VuY2VDaGFuZ2UihwEKCENoYW5nZUlEEhIKCmNsaWVudF9zZXEYASABKA0SEgoKc2VydmVyX3NlcRgCIAEoAxIPCgdsYW1wb3J0GAMgASgDEhAKCGFjdG9yX2lkGAQgASgMEjAKDnZlcnNpb25fdmVjdG9yGAUgASgLMhgueW9ya2llLnYxLlZlcnNpb25WZWN0b3IidAoNVmVyc2lvblZlY3RvchI0CgZ2ZWN0b3IYASADKAsyJC55b3JraWUudjEuVmVyc2lvblZlY3Rvci5WZWN0b3JFbnRyeRotCgtWZWN0b3JFbnRyeRILCgNrZXkYASABKAkSDQoFdmFsdWUYAiABKAM6AjgBIqwaCglPcGVyYXRpb24SJwoDc2V0GAEgASgLMhgueW9ya2llLnYxLk9wZXJhdGlvbi5TZXRIABInCgNhZGQYAiABKAsyGC55b3JraWUudjEuT3BlcmF0aW9uLkFkZEgAEikKBG1vdmUYAyABKAsyGS55b3JraWUudjEuT3BlcmF0aW9uLk1vdmVIABItCgZyZW1vdmUYBCABKAsyGy55b3JraWUudjEuT3BlcmF0aW9uLlJlbW92ZUgAEikKBGVkaXQYBSABKAsyGS55b3JraWUudjEuT3BlcmF0aW9uLkVkaXRIABIrCgVzdHlsZRgHIAEoCzIaLnlvcmtpZS52MS5PcGVyYXRpb24uU3R5bGVIABIxCghpbmNyZWFzZRgIIAEoCzIdLnlvcmtpZS52MS5PcGVyYXRpb24uSW5jcmVhc2VIABIyCgl0cmVlX2VkaXQYCSABKAsyHS55b3JraWUudjEuT3BlcmF0aW9uLlRyZWVFZGl0SAASNAoKdHJlZV9zdHlsZRgKIAEoCzIeLnlvcmtpZS52MS5PcGVyYXRpb24uVHJlZVN0eWxlSAASMgoJYXJyYXlfc2V0GAsgASgLMh0ueW9ya2llLnYxLk9wZXJhdGlvbi5BcnJheVNldEgAGp0BCgNTZXQSMAoRcGFyZW50X2NyZWF0ZWRfYXQYASABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBILCgNrZXkYAiABKAkSKwoFdmFsdWUYAyABKAsyHC55b3JraWUudjEuSlNPTkVsZW1lbnRTaW1wbGUSKgoLZXhlY3V0ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBrAAQoDQWRkEjAKEXBhcmVudF9jcmVhdGVkX2F0GAEgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSLgoPcHJldl9jcmVhdGVkX2F0GAIgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSKwoFdmFsdWUYAyABKAsyHC55b3JraWUudjEuSlNPTkVsZW1lbnRTaW1wbGUSKgoLZXhlY3V0ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBq/AQoETW92ZRIwChFwYXJlbnRfY3JlYXRlZF9hdBgBIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0Ei4KD3ByZXZfY3JlYXRlZF9hdBgCIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EikKCmNyZWF0ZWRfYXQYAyABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIqCgtleGVjdXRlZF9hdBgEIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0GpEBCgZSZW1vdmUSMAoRcGFyZW50X2NyZWF0ZWRfYXQYASABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIpCgpjcmVhdGVkX2F0GAIgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSKgoLZXhlY3V0ZWRfYXQYAyABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBrZAwoERWRpdBIwChFwYXJlbnRfY3JlYXRlZF9hdBgBIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EiQKBGZyb20YAiABKAsyFi55b3JraWUudjEuVGV4dE5vZGVQb3MSIgoCdG8YAyABKAsyFi55b3JraWUudjEuVGV4dE5vZGVQb3MSUwoXY3JlYXRlZF9hdF9tYXBfYnlfYWN0b3IYBCADKAsyMi55b3JraWUudjEuT3BlcmF0aW9uLkVkaXQuQ3JlYXRlZEF0TWFwQnlBY3RvckVudHJ5Eg8KB2NvbnRlbnQYBSABKAkSKgoLZXhlY3V0ZWRfYXQYBiABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBI9CgphdHRyaWJ1dGVzGAcgAygLMikueW9ya2llLnYxLk9wZXJhdGlvbi5FZGl0LkF0dHJpYnV0ZXNFbnRyeRpRChhDcmVhdGVkQXRNYXBCeUFjdG9yRW50cnkSCwoDa2V5GAEgASgJEiQKBXZhbHVlGAIgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQ6AjgBGjEKD0F0dHJpYnV0ZXNFbnRyeRILCgNrZXkYASABKAkSDQoFdmFsdWUYAiABKAk6AjgBGssDCgVTdHlsZRIwChFwYXJlbnRfY3JlYXRlZF9hdBgBIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EiQKBGZyb20YAiABKAsyFi55b3JraWUudjEuVGV4dE5vZGVQb3MSIgoCdG8YAyABKAsyFi55b3JraWUudjEuVGV4dE5vZGVQb3MSPgoKYXR0cmlidXRlcxgEIAMoCzIqLnlvcmtpZS52MS5PcGVyYXRpb24uU3R5bGUuQXR0cmlidXRlc0VudHJ5EioKC2V4ZWN1dGVkX2F0GAUgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSVAoXY3JlYXRlZF9hdF9tYXBfYnlfYWN0b3IYBiADKAsyMy55b3JraWUudjEuT3BlcmF0aW9uLlN0eWxlLkNyZWF0ZWRBdE1hcEJ5QWN0b3JFbnRyeRoxCg9BdHRyaWJ1dGVzRW50cnkSCwoDa2V5GAEgASgJEg0KBXZhbHVlGAIgASgJOgI4ARpRChhDcmVhdGVkQXRNYXBCeUFjdG9yRW50cnkSCwoDa2V5GAEgASgJEiQKBXZhbHVlGAIgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQ6AjgBGpUBCghJbmNyZWFzZRIwChFwYXJlbnRfY3JlYXRlZF9hdBgBIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EisKBXZhbHVlGAIgASgLMhwueW9ya2llLnYxLkpTT05FbGVtZW50U2ltcGxlEioKC2V4ZWN1dGVkX2F0GAMgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQakwMKCFRyZWVFZGl0EjAKEXBhcmVudF9jcmVhdGVkX2F0GAEgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSIAoEZnJvbRgCIAEoCzISLnlvcmtpZS52MS5UcmVlUG9zEh4KAnRvGAMgASgLMhIueW9ya2llLnYxLlRyZWVQb3MSVwoXY3JlYXRlZF9hdF9tYXBfYnlfYWN0b3IYBCADKAsyNi55b3JraWUudjEuT3BlcmF0aW9uLlRyZWVFZGl0LkNyZWF0ZWRBdE1hcEJ5QWN0b3JFbnRyeRImCghjb250ZW50cxgFIAMoCzIULnlvcmtpZS52MS5UcmVlTm9kZXMSEwoLc3BsaXRfbGV2ZWwYByABKAUSKgoLZXhlY3V0ZWRfYXQYBiABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBpRChhDcmVhdGVkQXRNYXBCeUFjdG9yRW50cnkSCwoDa2V5GAEgASgJEiQKBXZhbHVlGAIgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQ6AjgBGu0DCglUcmVlU3R5bGUSMAoRcGFyZW50X2NyZWF0ZWRfYXQYASABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIgCgRmcm9tGAIgASgLMhIueW9ya2llLnYxLlRyZWVQb3MSHgoCdG8YAyABKAsyEi55b3JraWUudjEuVHJlZVBvcxJCCgphdHRyaWJ1dGVzGAQgAygLMi4ueW9ya2llLnYxLk9wZXJhdGlvbi5UcmVlU3R5bGUuQXR0cmlidXRlc0VudHJ5EioKC2V4ZWN1dGVkX2F0GAUgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSHAoUYXR0cmlidXRlc190b19yZW1vdmUYBiADKAkSWAoXY3JlYXRlZF9hdF9tYXBfYnlfYWN0b3IYByADKAsyNy55b3JraWUudjEuT3BlcmF0aW9uLlRyZWVTdHlsZS5DcmVhdGVkQXRNYXBCeUFjdG9yRW50cnkaMQoPQXR0cmlidXRlc0VudHJ5EgsKA2tleRgBIAEoCRINCgV2YWx1ZRgCIAEoCToCOAEaUQoYQ3JlYXRlZEF0TWFwQnlBY3RvckVudHJ5EgsKA2tleRgBIAEoCRIkCgV2YWx1ZRgCIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0OgI4ARrAAQoIQXJyYXlTZXQSMAoRcGFyZW50X2NyZWF0ZWRfYXQYASABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIpCgpjcmVhdGVkX2F0GAIgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSKwoFdmFsdWUYAyABKAsyHC55b3JraWUudjEuSlNPTkVsZW1lbnRTaW1wbGUSKgoLZXhlY3V0ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldEIGCgRib2R5IsUBChFKU09ORWxlbWVudFNpbXBsZRIpCgpjcmVhdGVkX2F0GAEgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSJwoIbW92ZWRfYXQYAiABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIpCgpyZW1vdmVkX2F0GAMgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSIgoEdHlwZRgEIAEoDjIULnlvcmtpZS52MS5WYWx1ZVR5cGUSDQoFdmFsdWUYBSABKAwiggsKC0pTT05FbGVtZW50EjgKC2pzb25fb2JqZWN0GAEgASgLMiEueW9ya2llLnYxLkpTT05FbGVtZW50LkpTT05PYmplY3RIABI2Cgpqc29uX2FycmF5GAIgASgLMiAueW9ya2llLnYxLkpTT05FbGVtZW50LkpTT05BcnJheUgAEjUKCXByaW1pdGl2ZRgDIAEoCzIgLnlvcmtpZS52MS5KU09ORWxlbWVudC5QcmltaXRpdmVIABIrCgR0ZXh0GAUgASgLMhsueW9ya2llLnYxLkpTT05FbGVtZW50LlRleHRIABIxCgdjb3VudGVyGAYgASgLMh4ueW9ya2llLnYxLkpTT05FbGVtZW50LkNvdW50ZXJIABIrCgR0cmVlGAcgASgLMhsueW9ya2llLnYxLkpTT05FbGVtZW50LlRyZWVIABquAQoKSlNPTk9iamVjdBIhCgVub2RlcxgBIAMoCzISLnlvcmtpZS52MS5SSFROb2RlEikKCmNyZWF0ZWRfYXQYAiABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBInCghtb3ZlZF9hdBgDIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EikKCnJlbW92ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBqtAQoJSlNPTkFycmF5EiEKBW5vZGVzGAEgAygLMhIueW9ya2llLnYxLlJHQU5vZGUSKQoKY3JlYXRlZF9hdBgCIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EicKCG1vdmVkX2F0GAMgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSKQoKcmVtb3ZlZF9hdBgEIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0Gr0BCglQcmltaXRpdmUSIgoEdHlwZRgBIAEoDjIULnlvcmtpZS52MS5WYWx1ZVR5cGUSDQoFdmFsdWUYAiABKAwSKQoKY3JlYXRlZF9hdBgDIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EicKCG1vdmVkX2F0GAQgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSKQoKcmVtb3ZlZF9hdBgFIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0GqkBCgRUZXh0EiIKBW5vZGVzGAEgAygLMhMueW9ya2llLnYxLlRleHROb2RlEikKCmNyZWF0ZWRfYXQYAiABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBInCghtb3ZlZF9hdBgDIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EikKCnJlbW92ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBq7AQoHQ291bnRlchIiCgR0eXBlGAEgASgOMhQueW9ya2llLnYxLlZhbHVlVHlwZRINCgV2YWx1ZRgCIAEoDBIpCgpjcmVhdGVkX2F0GAMgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSJwoIbW92ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIpCgpyZW1vdmVkX2F0GAUgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQaqQEKBFRyZWUSIgoFbm9kZXMYASADKAsyEy55b3JraWUudjEuVHJlZU5vZGUSKQoKY3JlYXRlZF9hdBgCIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EicKCG1vdmVkX2F0GAMgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSKQoKcmVtb3ZlZF9hdBgEIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0QgYKBGJvZHkiPwoHUkhUTm9kZRILCgNrZXkYASABKAkSJwoHZWxlbWVudBgCIAEoCzIWLnlvcmtpZS52MS5KU09ORWxlbWVudCJUCgdSR0FOb2RlEiAKBG5leHQYASABKAsyEi55b3JraWUudjEuUkdBTm9kZRInCgdlbGVtZW50GAIgASgLMhYueW9ya2llLnYxLkpTT05FbGVtZW50IlgKCE5vZGVBdHRyEg0KBXZhbHVlGAEgASgJEikKCnVwZGF0ZWRfYXQYAiABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBISCgppc19yZW1vdmVkGAMgASgIIpQCCghUZXh0Tm9kZRIhCgJpZBgBIAEoCzIVLnlvcmtpZS52MS5UZXh0Tm9kZUlEEg0KBXZhbHVlGAIgASgJEikKCnJlbW92ZWRfYXQYAyABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIqCgtpbnNfcHJldl9pZBgEIAEoCzIVLnlvcmtpZS52MS5UZXh0Tm9kZUlEEjcKCmF0dHJpYnV0ZXMYBSADKAsyIy55b3JraWUudjEuVGV4dE5vZGUuQXR0cmlidXRlc0VudHJ5GkYKD0F0dHJpYnV0ZXNFbnRyeRILCgNrZXkYASABKAkSIgoFdmFsdWUYAiABKAsyEy55b3JraWUudjEuTm9kZUF0dHI6AjgBIkcKClRleHROb2RlSUQSKQoKY3JlYXRlZF9hdBgBIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0Eg4KBm9mZnNldBgCIAEoBSLdAgoIVHJlZU5vZGUSIQoCaWQYASABKAsyFS55b3JraWUudjEuVHJlZU5vZGVJRBIMCgR0eXBlGAIgASgJEg0KBXZhbHVlGAMgASgJEikKCnJlbW92ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIqCgtpbnNfcHJldl9pZBgFIAEoCzIVLnlvcmtpZS52MS5UcmVlTm9kZUlEEioKC2luc19uZXh0X2lkGAYgASgLMhUueW9ya2llLnYxLlRyZWVOb2RlSUQSDQoFZGVwdGgYByABKAUSNwoKYXR0cmlidXRlcxgIIAMoCzIjLnlvcmtpZS52MS5UcmVlTm9kZS5BdHRyaWJ1dGVzRW50cnkaRgoPQXR0cmlidXRlc0VudHJ5EgsKA2tleRgBIAEoCRIiCgV2YWx1ZRgCIAEoCzITLnlvcmtpZS52MS5Ob2RlQXR0cjoCOAEiMQoJVHJlZU5vZGVzEiQKB2NvbnRlbnQYASADKAsyEy55b3JraWUudjEuVHJlZU5vZGUiRwoKVHJlZU5vZGVJRBIpCgpjcmVhdGVkX2F0GAEgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSDgoGb2Zmc2V0GAIgASgFImMKB1RyZWVQb3MSKAoJcGFyZW50X2lkGAEgASgLMhUueW9ya2llLnYxLlRyZWVOb2RlSUQSLgoPbGVmdF9zaWJsaW5nX2lkGAIgASgLMhUueW9ya2llLnYxLlRyZWVOb2RlSUQiawoEVXNlchIKCgJpZBgBIAEoCRIVCg1hdXRoX3Byb3ZpZGVyGAIgASgJEhAKCHVzZXJuYW1lGAMgASgJEi4KCmNyZWF0ZWRfYXQYBCABKAsyGi5nb29nbGUucHJvdG9idWYuVGltZXN0YW1wIukGCgdQcm9qZWN0EgoKAmlkGAEgASgJEgwKBG5hbWUYAiABKAkSEgoKcHVibGljX2tleRgDIAEoCRISCgpzZWNyZXRfa2V5GAQgASgJEhgKEGF1dGhfd2ViaG9va191cmwYBSABKAkSHAoUYXV0aF93ZWJob29rX21ldGhvZHMYBiADKAkSIAoYYXV0aF93ZWJob29rX21heF9yZXRyaWVzGBEgASgEEiYKHmF1dGhfd2ViaG9va19taW5fd2FpdF9pbnRlcnZhbBgSIAEoCRImCh5hdXRoX3dlYmhvb2tfbWF4X3dhaXRfaW50ZXJ2YWwYEyABKAkSJAocYXV0aF93ZWJob29rX3JlcXVlc3RfdGltZW91dBgUIAEoCRIZChFldmVudF93ZWJob29rX3VybBgHIAEoCRIcChRldmVudF93ZWJob29rX2V2ZW50cxgIIAMoCRIhChlldmVudF93ZWJob29rX21heF9yZXRyaWVzGBUgASgEEicKH2V2ZW50X3dlYmhvb2tfbWluX3dhaXRfaW50ZXJ2YWwYFiABKAkSJwofZXZlbnRfd2ViaG9va19tYXhfd2FpdF9pbnRlcnZhbBgXIAEoCRIlCh1ldmVudF93ZWJob29rX3JlcXVlc3RfdGltZW91dBgYIAEoCRIjChtjbGllbnRfZGVhY3RpdmF0ZV90aHJlc2hvbGQYCSABKAkSGgoSc25hcHNob3RfdGhyZXNob2xkGBkgASgDEhkKEXNuYXBzaG90X2ludGVydmFsGBogASgDEiQKHG1heF9zdWJzY3JpYmVyc19wZXJfZG9jdW1lbnQYCiABKAUSJAocbWF4X2F0dGFjaG1lbnRzX3Blcl9kb2N1bWVudBgLIAEoBRIdChVtYXhfc2l6ZV9wZXJfZG9jdW1lbnQYDyABKAUSGAoQcmVtb3ZlX29uX2RldGFjaBgQIAEoCBIdChVhdXRvX3JldmlzaW9uX2VuYWJsZWQYGyABKAgSFwoPYWxsb3dlZF9vcmlnaW5zGA4gAygJEi4KCmNyZWF0ZWRfYXQYDCABKAsyGi5nb29nbGUucHJvdG9idWYuVGltZXN0YW1wEi4KCnVwZGF0ZWRfYXQYDSABKAsyGi5nb29nbGUucHJvdG9idWYuVGltZXN0YW1wIi8KC01ldHJpY1BvaW50EhEKCXRpbWVzdGFtcBgBIAEoAxINCgV2YWx1ZRgCIAEoBSKjDAoWVXBkYXRhYmxlUHJvamVjdEZpZWxkcxIqCgRuYW1lGAEgASgLMhwuZ29vZ2xlLnByb3RvYnVmLlN0cmluZ1ZhbHVlEjYKEGF1dGhfd2ViaG9va191cmwYAiABKAsyHC5nb29nbGUucHJvdG9idWYuU3RyaW5nVmFsdWUSUgoUYXV0aF93ZWJob29rX21ldGhvZHMYAyABKAsyNC55b3JraWUudjEuVXBkYXRhYmxlUHJvamVjdEZpZWxkcy5BdXRoV2ViaG9va01ldGhvZHMSPgoYYXV0aF93ZWJob29rX21heF9yZXRyaWVzGAwgASgLMhwuZ29vZ2xlLnByb3RvYnVmLlVJbnQ2NFZhbHVlEkQKHmF1dGhfd2ViaG9va19taW5fd2FpdF9pbnRlcnZhbBgNIAEoCzIcLmdvb2dsZS5wcm90b2J1Zi5TdHJpbmdWYWx1ZRJECh5hdXRoX3dlYmhvb2tfbWF4X3dhaXRfaW50ZXJ2YWwYDiABKAsyHC5nb29nbGUucHJvdG9idWYuU3RyaW5nVmFsdWUSQgocYXV0aF93ZWJob29rX3JlcXVlc3RfdGltZW91dBgPIAEoCzIcLmdvb2dsZS5wcm90b2J1Zi5TdHJpbmdWYWx1ZRI3ChFldmVudF93ZWJob29rX3VybBgEIAEoCzIcLmdvb2dsZS5wcm90b2J1Zi5TdHJpbmdWYWx1ZRJSChRldmVudF93ZWJob29rX2V2ZW50cxgFIAEoCzI0LnlvcmtpZS52MS5VcGRhdGFibGVQcm9qZWN0RmllbGRzLkV2ZW50V2ViaG9va0V2ZW50cxI/ChlldmVudF93ZWJob29rX21heF9yZXRyaWVzGBAgASgLMhwuZ29vZ2xlLnByb3RvYnVmLlVJbnQ2NFZhbHVlEkUKH2V2ZW50X3dlYmhvb2tfbWluX3dhaXRfaW50ZXJ2YWwYESABKAsyHC5nb29nbGUucHJvdG9idWYuU3RyaW5nVmFsdWUSRQofZXZlbnRfd2ViaG9va19tYXhfd2FpdF9pbnRlcnZhbBgSIAEoCzIcLmdvb2dsZS5wcm90b2J1Zi5TdHJpbmdWYWx1ZRJDCh1ldmVudF93ZWJob29rX3JlcXVlc3RfdGltZW91dBgTIAEoCzIcLmdvb2dsZS5wcm90b2J1Zi5TdHJpbmdWYWx1ZRI3ChJzbmFwc2hvdF90aHJlc2hvbGQYFCABKAsyGy5nb29nbGUucHJvdG9idWYuSW50NjRWYWx1ZRI2ChFzbmFwc2hvdF9pbnRlcnZhbBgVIAEoCzIbLmdvb2dsZS5wcm90b2J1Zi5JbnQ2NFZhbHVlEkEKG2NsaWVudF9kZWFjdGl2YXRlX3RocmVzaG9sZBgGIAEoCzIcLmdvb2dsZS5wcm90b2J1Zi5TdHJpbmdWYWx1ZRJBChxtYXhfc3Vic2NyaWJlcnNfcGVyX2RvY3VtZW50GAcgASgLMhsuZ29vZ2xlLnByb3RvYnVmLkludDMyVmFsdWUSQQocbWF4X2F0dGFjaG1lbnRzX3Blcl9kb2N1bWVudBgIIAEoCzIbLmdvb2dsZS5wcm90b2J1Zi5JbnQzMlZhbHVlEjoKFW1heF9zaXplX3Blcl9kb2N1bWVudBgKIAEoCzIbLmdvb2dsZS5wcm90b2J1Zi5JbnQzMlZhbHVlEjQKEHJlbW92ZV9vbl9kZXRhY2gYCyABKAsyGi5nb29nbGUucHJvdG9idWYuQm9vbFZhbHVlEjkKFWF1dG9fcmV2aXNpb25fZW5hYmxlZBgWIAEoCzIaLmdvb2dsZS5wcm90b2J1Zi5Cb29sVmFsdWUSSQoPYWxsb3dlZF9vcmlnaW5zGAkgASgLMjAueW9ya2llLnYxLlVwZGF0YWJsZVByb2plY3RGaWVsZHMuQWxsb3dlZE9yaWdpbnMaJQoSQXV0aFdlYmhvb2tNZXRob2RzEg8KB21ldGhvZHMYASADKAkaJAoSRXZlbnRXZWJob29rRXZlbnRzEg4KBmV2ZW50cxgBIAMoCRohCg5BbGxvd2VkT3JpZ2lucxIPCgdvcmlnaW5zGAEgAygJIqcDCg9Eb2N1bWVudFN1bW1hcnkSCgoCaWQYASABKAkSCwoDa2V5GAIgASgJEgwKBHJvb3QYAyABKAkSGAoQYXR0YWNoZWRfY2xpZW50cxgHIAEoBRIpCg1kb2N1bWVudF9zaXplGAggASgLMhIueW9ya2llLnYxLkRvY1NpemUSEgoKc2NoZW1hX2tleRgJIAEoCRI8CglwcmVzZW5jZXMYCiADKAsyKS55b3JraWUudjEuRG9jdW1lbnRTdW1tYXJ5LlByZXNlbmNlc0VudHJ5Ei4KCmNyZWF0ZWRfYXQYBCABKAsyGi5nb29nbGUucHJvdG9idWYuVGltZXN0YW1wEi8KC2FjY2Vzc2VkX2F0GAUgASgLMhouZ29vZ2xlLnByb3RvYnVmLlRpbWVzdGFtcBIuCgp1cGRhdGVkX2F0GAYgASgLMhouZ29vZ2xlLnByb3RvYnVmLlRpbWVzdGFtcBpFCg5QcmVzZW5jZXNFbnRyeRILCgNrZXkYASABKAkSIgoFdmFsdWUYAiABKAsyEy55b3JraWUudjEuUHJlc2VuY2U6AjgBItoBCg5QcmVzZW5jZUNoYW5nZRIyCgR0eXBlGAEgASgOMiQueW9ya2llLnYxLlByZXNlbmNlQ2hhbmdlLkNoYW5nZVR5cGUSJQoIcHJlc2VuY2UYAiABKAsyEy55b3JraWUudjEuUHJlc2VuY2UibQoKQ2hhbmdlVHlwZRIbChdDSEFOR0VfVFlQRV9VTlNQRUNJRklFRBAAEhMKD0NIQU5HRV9UWVBFX1BVVBABEhYKEkNIQU5HRV9UWVBFX0RFTEVURRACEhUKEUNIQU5HRV9UWVBFX0NMRUFSEAMiZAoIUHJlc2VuY2USKwoEZGF0YRgBIAMoCzIdLnlvcmtpZS52MS5QcmVzZW5jZS5EYXRhRW50cnkaKwoJRGF0YUVudHJ5EgsKA2tleRgBIAEoCRINCgV2YWx1ZRgCIAEoCToCOAEiNAoOQ2hhbm5lbFN1bW1hcnkSCwoDa2V5GAEgASgJEhUKDXNlc3Npb25fY291bnQYAiABKAUiNAoKQ2hlY2twb2ludBISCgpzZXJ2ZXJfc2VxGAEgASgDEhIKCmNsaWVudF9zZXEYAiABKA0iYQoLVGV4dE5vZGVQb3MSKQoKY3JlYXRlZF9hdBgBIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0Eg4KBm9mZnNldBgCIAEoBRIXCg9yZWxhdGl2ZV9vZmZzZXQYAyABKAUiQgoKVGltZVRpY2tldBIPCgdsYW1wb3J0GAEgASgDEhEKCWRlbGltaXRlchgCIAEoDRIQCghhY3Rvcl9pZBgDIAEoDCIuCgxEb2NFdmVudEJvZHkSDQoFdG9waWMYASABKAkSDwoHcGF5bG9hZBgCIAEoDCJrCghEb2NFdmVudBIlCgR0eXBlGAEgASgOMhcueW9ya2llLnYxLkRvY0V2ZW50VHlwZRIRCglwdWJsaXNoZXIYAiABKAkSJQoEYm9keRgDIAEoCzIXLnlvcmtpZS52MS5Eb2NFdmVudEJvZHkizgEKDENoYW5uZWxFdmVudBIqCgR0eXBlGAEgASgOMhwueW9ya2llLnYxLkNoYW5uZWxFdmVudC5UeXBlEhEKCXB1Ymxpc2hlchgCIAEoCRINCgVjb3VudBgDIAEoAxILCgNzZXEYBCABKAMSDQoFdG9waWMYBSABKAkSDwoHcGF5bG9hZBgGIAEoDCJDCgRUeXBlEhQKEFRZUEVfVU5TUEVDSUZJRUQQABIRCg1UWVBFX1BSRVNFTkNFEAESEgoOVFlQRV9CUk9BRENBU1QQAiImCghEYXRhU2l6ZRIMCgRkYXRhGAEgASgFEgwKBG1ldGEYAiABKAUiTQoHRG9jU2l6ZRIhCgRsaXZlGAEgASgLMhMueW9ya2llLnYxLkRhdGFTaXplEh8KAmdjGAIgASgLMhMueW9ya2llLnYxLkRhdGFTaXplIpEBCgZTY2hlbWESCgoCaWQYASABKAkSDAoEbmFtZRgCIAEoCRIPCgd2ZXJzaW9uGAMgASgFEgwKBGJvZHkYBCABKAkSHgoFcnVsZXMYBSADKAsyDy55b3JraWUudjEuUnVsZRIuCgpjcmVhdGVkX2F0GAYgASgLMhouZ29vZ2xlLnByb3RvYnVmLlRpbWVzdGFtcCIiCgRSdWxlEgwKBHBhdGgYASABKAkSDAoEdHlwZRgCIAEoCSKDAQoPUmV2aXNpb25TdW1tYXJ5EgoKAmlkGAEgASgJEg0KBWxhYmVsGAIgASgJEhMKC2Rlc2NyaXB0aW9uGAMgASgJEhAKCHNuYXBzaG90GAQgASgJEi4KCmNyZWF0ZWRfYXQYBSABKAsyGi5nb29nbGUucHJvdG9idWYuVGltZXN0YW1wKtQCCglWYWx1ZVR5cGUSEwoPVkFMVUVfVFlQRV9OVUxMEAASFgoSVkFMVUVfVFlQRV9CT09MRUFOEAESFgoSVkFMVUVfVFlQRV9JTlRFR0VSEAISEwoPVkFMVUVfVFlQRV9MT05HEAMSFQoRVkFMVUVfVFlQRV9ET1VCTEUQBBIVChFWQUxVRV9UWVBFX1NUUklORxAFEhQKEFZBTFVFX1RZUEVfQllURVMQBhITCg9WQUxVRV9UWVBFX0RBVEUQBxIaChZWQUxVRV9UWVBFX0pTT05fT0JKRUNUEAgSGQoVVkFMVUVfVFlQRV9KU09OX0FSUkFZEAkSEwoPVkFMVUVfVFlQRV9URVhUEAoSGgoWVkFMVUVfVFlQRV9JTlRFR0VSX0NOVBALEhcKE1ZBTFVFX1RZUEVfTE9OR19DTlQQDBITCg9WQUxVRV9UWVBFX1RSRUUQDSqmAQoMRG9jRXZlbnRUeXBlEiMKH0RPQ19FVkVOVF9UWVBFX0RPQ1VNRU5UX0NIQU5HRUQQABIjCh9ET0NfRVZFTlRfVFlQRV9ET0NVTUVOVF9XQVRDSEVEEAESJQohRE9DX0VWRU5UX1RZUEVfRE9DVU1FTlRfVU5XQVRDSEVEEAISJQohRE9DX0VWRU5UX1RZUEVfRE9DVU1FTlRfQlJPQURDQVNUEANCRQoRZGV2LnlvcmtpZS5hcGkudjFQAVouZ2l0aHViLmNvbS95b3JraWUtdGVhbS95b3JraWUvYXBpL3lvcmtpZS92MTt2MWIGcHJvdG8z",[qp,pm]),Db=Y(X,0),Ob=Y(X,1),Lb=Y(X,2),Ho=Y(X,3),Qo=Y(X,4),qo=Y(X,5),Bb=Y(X,5,0),Wb=Y(X,5,1),Pb=Y(X,5,2),_b=Y(X,5,3),Ub=Y(X,5,4),kb=Y(X,5,5),Fb=Y(X,5,6),Zb=Y(X,5,7),Gb=Y(X,5,8),Mb=Y(X,5,9),Un=Y(X,6),st=Y(X,7),Yb=Y(X,7,0),Kb=Y(X,7,1),Jb=Y(X,7,2),$b=Y(X,7,3),Xb=Y(X,7,4),zb=Y(X,7,5),jb=Y(X,8),Hb=Y(X,9),xf=Y(X,10),Qb=Y(X,11),qb=Y(X,12),ey=Y(X,13),ty=Y(X,14),ny=Y(X,15),ry=Y(X,16),cl=Y(X,22);var Xr=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.PUT=1]="PUT",t[t.DELETE=2]="DELETE",t[t.CLEAR=3]="CLEAR",t))(Xr||{});const sy=Y(X,23),iy=Y(X,25),oy=Y(X,26),ay=Y(X,27);var Vf=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.PRESENCE=1]="PRESENCE",t[t.BROADCAST=2]="BROADCAST",t))(Vf||{}),$=(t=>(t[t.NULL=0]="NULL",t[t.BOOLEAN=1]="BOOLEAN",t[t.INTEGER=2]="INTEGER",t[t.LONG=3]="LONG",t[t.DOUBLE=4]="DOUBLE",t[t.STRING=5]="STRING",t[t.BYTES=6]="BYTES",t[t.DATE=7]="DATE",t[t.JSON_OBJECT=8]="JSON_OBJECT",t[t.JSON_ARRAY=9]="JSON_ARRAY",t[t.TEXT=10]="TEXT",t[t.INTEGER_CNT=11]="INTEGER_CNT",t[t.LONG_CNT=12]="LONG_CNT",t[t.TREE=13]="TREE",t))($||{}),Fs=(t=>(t[t.DOCUMENT_CHANGED=0]="DOCUMENT_CHANGED",t[t.DOCUMENT_WATCHED=1]="DOCUMENT_WATCHED",t[t.DOCUMENT_UNWATCHED=2]="DOCUMENT_UNWATCHED",t[t.DOCUMENT_BROADCAST=3]="DOCUMENT_BROADCAST",t))(Fs||{});const cy=Ht("Ch5zcmMvYXBpL3lvcmtpZS92MS95b3JraWUucHJvdG8SCXlvcmtpZS52MSKeAQoVQWN0aXZhdGVDbGllbnRSZXF1ZXN0EhIKCmNsaWVudF9rZXkYASABKAkSQAoIbWV0YWRhdGEYAiADKAsyLi55b3JraWUudjEuQWN0aXZhdGVDbGllbnRSZXF1ZXN0Lk1ldGFkYXRhRW50cnkaLwoNTWV0YWRhdGFFbnRyeRILCgNrZXkYASABKAkSDQoFdmFsdWUYAiABKAk6AjgBIisKFkFjdGl2YXRlQ2xpZW50UmVzcG9uc2USEQoJY2xpZW50X2lkGAEgASgJIkEKF0RlYWN0aXZhdGVDbGllbnRSZXF1ZXN0EhEKCWNsaWVudF9pZBgBIAEoCRITCgtzeW5jaHJvbm91cxgCIAEoCCIaChhEZWFjdGl2YXRlQ2xpZW50UmVzcG9uc2UiagoVQXR0YWNoRG9jdW1lbnRSZXF1ZXN0EhEKCWNsaWVudF9pZBgBIAEoCRIqCgtjaGFuZ2VfcGFjaxgCIAEoCzIVLnlvcmtpZS52MS5DaGFuZ2VQYWNrEhIKCnNjaGVtYV9rZXkYAyABKAkinwEKFkF0dGFjaERvY3VtZW50UmVzcG9uc2USEwoLZG9jdW1lbnRfaWQYASABKAkSKgoLY2hhbmdlX3BhY2sYAiABKAsyFS55b3JraWUudjEuQ2hhbmdlUGFjaxIdChVtYXhfc2l6ZV9wZXJfZG9jdW1lbnQYAyABKAUSJQoMc2NoZW1hX3J1bGVzGAQgAygLMg8ueW9ya2llLnYxLlJ1bGUiiwEKFURldGFjaERvY3VtZW50UmVxdWVzdBIRCgljbGllbnRfaWQYASABKAkSEwoLZG9jdW1lbnRfaWQYAiABKAkSKgoLY2hhbmdlX3BhY2sYAyABKAsyFS55b3JraWUudjEuQ2hhbmdlUGFjaxIeChZyZW1vdmVfaWZfbm90X2F0dGFjaGVkGAQgASgIIkQKFkRldGFjaERvY3VtZW50UmVzcG9uc2USKgoLY2hhbmdlX3BhY2sYAiABKAsyFS55b3JraWUudjEuQ2hhbmdlUGFjayI+ChRXYXRjaERvY3VtZW50UmVxdWVzdBIRCgljbGllbnRfaWQYASABKAkSEwoLZG9jdW1lbnRfaWQYAiABKAkitgEKFVdhdGNoRG9jdW1lbnRSZXNwb25zZRJJCg5pbml0aWFsaXphdGlvbhgBIAEoCzIvLnlvcmtpZS52MS5XYXRjaERvY3VtZW50UmVzcG9uc2UuSW5pdGlhbGl6YXRpb25IABIkCgVldmVudBgCIAEoCzITLnlvcmtpZS52MS5Eb2NFdmVudEgAGiQKDkluaXRpYWxpemF0aW9uEhIKCmNsaWVudF9pZHMYASADKAlCBgoEYm9keSJrChVSZW1vdmVEb2N1bWVudFJlcXVlc3QSEQoJY2xpZW50X2lkGAEgASgJEhMKC2RvY3VtZW50X2lkGAIgASgJEioKC2NoYW5nZV9wYWNrGAMgASgLMhUueW9ya2llLnYxLkNoYW5nZVBhY2siRAoWUmVtb3ZlRG9jdW1lbnRSZXNwb25zZRIqCgtjaGFuZ2VfcGFjaxgBIAEoCzIVLnlvcmtpZS52MS5DaGFuZ2VQYWNrIn8KFlB1c2hQdWxsQ2hhbmdlc1JlcXVlc3QSEQoJY2xpZW50X2lkGAEgASgJEhMKC2RvY3VtZW50X2lkGAIgASgJEioKC2NoYW5nZV9wYWNrGAMgASgLMhUueW9ya2llLnYxLkNoYW5nZVBhY2sSEQoJcHVzaF9vbmx5GAQgASgIIkUKF1B1c2hQdWxsQ2hhbmdlc1Jlc3BvbnNlEioKC2NoYW5nZV9wYWNrGAEgASgLMhUueW9ya2llLnYxLkNoYW5nZVBhY2siYwoVQ3JlYXRlUmV2aXNpb25SZXF1ZXN0EhEKCWNsaWVudF9pZBgBIAEoCRITCgtkb2N1bWVudF9pZBgCIAEoCRINCgVsYWJlbBgDIAEoCRITCgtkZXNjcmlwdGlvbhgEIAEoCSJGChZDcmVhdGVSZXZpc2lvblJlc3BvbnNlEiwKCHJldmlzaW9uGAEgASgLMhoueW9ya2llLnYxLlJldmlzaW9uU3VtbWFyeSJRChJHZXRSZXZpc2lvblJlcXVlc3QSEQoJY2xpZW50X2lkGAEgASgJEhMKC2RvY3VtZW50X2lkGAIgASgJEhMKC3JldmlzaW9uX2lkGAMgASgJIkMKE0dldFJldmlzaW9uUmVzcG9uc2USLAoIcmV2aXNpb24YASABKAsyGi55b3JraWUudjEuUmV2aXNpb25TdW1tYXJ5InUKFExpc3RSZXZpc2lvbnNSZXF1ZXN0EhEKCWNsaWVudF9pZBgBIAEoCRITCgtkb2N1bWVudF9pZBgCIAEoCRIRCglwYWdlX3NpemUYAyABKAUSDgoGb2Zmc2V0GAQgASgFEhIKCmlzX2ZvcndhcmQYBSABKAgiRgoVTGlzdFJldmlzaW9uc1Jlc3BvbnNlEi0KCXJldmlzaW9ucxgBIAMoCzIaLnlvcmtpZS52MS5SZXZpc2lvblN1bW1hcnkiVQoWUmVzdG9yZVJldmlzaW9uUmVxdWVzdBIRCgljbGllbnRfaWQYASABKAkSEwoLZG9jdW1lbnRfaWQYAiABKAkSEwoLcmV2aXNpb25faWQYBCABKAkiGQoXUmVzdG9yZVJldmlzaW9uUmVzcG9uc2UiPgoUQXR0YWNoQ2hhbm5lbFJlcXVlc3QSEQoJY2xpZW50X2lkGAEgASgJEhMKC2NoYW5uZWxfa2V5GAIgASgJIjoKFUF0dGFjaENoYW5uZWxSZXNwb25zZRISCgpzZXNzaW9uX2lkGAEgASgJEg0KBWNvdW50GAIgASgDIlIKFERldGFjaENoYW5uZWxSZXF1ZXN0EhEKCWNsaWVudF9pZBgBIAEoCRITCgtjaGFubmVsX2tleRgCIAEoCRISCgpzZXNzaW9uX2lkGAMgASgJIiYKFURldGFjaENoYW5uZWxSZXNwb25zZRINCgVjb3VudBgBIAEoAyJTChVSZWZyZXNoQ2hhbm5lbFJlcXVlc3QSEQoJY2xpZW50X2lkGAEgASgJEhMKC2NoYW5uZWxfa2V5GAIgASgJEhIKCnNlc3Npb25faWQYAyABKAkiJwoWUmVmcmVzaENoYW5uZWxSZXNwb25zZRINCgVjb3VudBgBIAEoAyI9ChNXYXRjaENoYW5uZWxSZXF1ZXN0EhEKCWNsaWVudF9pZBgBIAEoCRITCgtjaGFubmVsX2tleRgCIAEoCSKDAQoUV2F0Y2hDaGFubmVsUmVzcG9uc2USOQoLaW5pdGlhbGl6ZWQYASABKAsyIi55b3JraWUudjEuV2F0Y2hDaGFubmVsSW5pdGlhbGl6ZWRIABIoCgVldmVudBgCIAEoCzIXLnlvcmtpZS52MS5DaGFubmVsRXZlbnRIAEIGCgRib2R5IjUKF1dhdGNoQ2hhbm5lbEluaXRpYWxpemVkEg0KBWNvdW50GAEgASgDEgsKA3NlcRgCIAEoAyJaChBCcm9hZGNhc3RSZXF1ZXN0EhEKCWNsaWVudF9pZBgBIAEoCRITCgtjaGFubmVsX2tleRgCIAEoCRINCgV0b3BpYxgDIAEoCRIPCgdwYXlsb2FkGAQgASgMIhMKEUJyb2FkY2FzdFJlc3BvbnNlMoULCg1Zb3JraWVTZXJ2aWNlElcKDkFjdGl2YXRlQ2xpZW50EiAueW9ya2llLnYxLkFjdGl2YXRlQ2xpZW50UmVxdWVzdBohLnlvcmtpZS52MS5BY3RpdmF0ZUNsaWVudFJlc3BvbnNlIgASXQoQRGVhY3RpdmF0ZUNsaWVudBIiLnlvcmtpZS52MS5EZWFjdGl2YXRlQ2xpZW50UmVxdWVzdBojLnlvcmtpZS52MS5EZWFjdGl2YXRlQ2xpZW50UmVzcG9uc2UiABJXCg5BdHRhY2hEb2N1bWVudBIgLnlvcmtpZS52MS5BdHRhY2hEb2N1bWVudFJlcXVlc3QaIS55b3JraWUudjEuQXR0YWNoRG9jdW1lbnRSZXNwb25zZSIAElcKDkRldGFjaERvY3VtZW50EiAueW9ya2llLnYxLkRldGFjaERvY3VtZW50UmVxdWVzdBohLnlvcmtpZS52MS5EZXRhY2hEb2N1bWVudFJlc3BvbnNlIgASVwoOUmVtb3ZlRG9jdW1lbnQSIC55b3JraWUudjEuUmVtb3ZlRG9jdW1lbnRSZXF1ZXN0GiEueW9ya2llLnYxLlJlbW92ZURvY3VtZW50UmVzcG9uc2UiABJaCg9QdXNoUHVsbENoYW5nZXMSIS55b3JraWUudjEuUHVzaFB1bGxDaGFuZ2VzUmVxdWVzdBoiLnlvcmtpZS52MS5QdXNoUHVsbENoYW5nZXNSZXNwb25zZSIAElYKDVdhdGNoRG9jdW1lbnQSHy55b3JraWUudjEuV2F0Y2hEb2N1bWVudFJlcXVlc3QaIC55b3JraWUudjEuV2F0Y2hEb2N1bWVudFJlc3BvbnNlIgAwARJXCg5DcmVhdGVSZXZpc2lvbhIgLnlvcmtpZS52MS5DcmVhdGVSZXZpc2lvblJlcXVlc3QaIS55b3JraWUudjEuQ3JlYXRlUmV2aXNpb25SZXNwb25zZSIAEk4KC0dldFJldmlzaW9uEh0ueW9ya2llLnYxLkdldFJldmlzaW9uUmVxdWVzdBoeLnlvcmtpZS52MS5HZXRSZXZpc2lvblJlc3BvbnNlIgASVAoNTGlzdFJldmlzaW9ucxIfLnlvcmtpZS52MS5MaXN0UmV2aXNpb25zUmVxdWVzdBogLnlvcmtpZS52MS5MaXN0UmV2aXNpb25zUmVzcG9uc2UiABJaCg9SZXN0b3JlUmV2aXNpb24SIS55b3JraWUudjEuUmVzdG9yZVJldmlzaW9uUmVxdWVzdBoiLnlvcmtpZS52MS5SZXN0b3JlUmV2aXNpb25SZXNwb25zZSIAElQKDUF0dGFjaENoYW5uZWwSHy55b3JraWUudjEuQXR0YWNoQ2hhbm5lbFJlcXVlc3QaIC55b3JraWUudjEuQXR0YWNoQ2hhbm5lbFJlc3BvbnNlIgASVAoNRGV0YWNoQ2hhbm5lbBIfLnlvcmtpZS52MS5EZXRhY2hDaGFubmVsUmVxdWVzdBogLnlvcmtpZS52MS5EZXRhY2hDaGFubmVsUmVzcG9uc2UiABJXCg5SZWZyZXNoQ2hhbm5lbBIgLnlvcmtpZS52MS5SZWZyZXNoQ2hhbm5lbFJlcXVlc3QaIS55b3JraWUudjEuUmVmcmVzaENoYW5uZWxSZXNwb25zZSIAElMKDFdhdGNoQ2hhbm5lbBIeLnlvcmtpZS52MS5XYXRjaENoYW5uZWxSZXF1ZXN0Gh8ueW9ya2llLnYxLldhdGNoQ2hhbm5lbFJlc3BvbnNlIgAwARJICglCcm9hZGNhc3QSGy55b3JraWUudjEuQnJvYWRjYXN0UmVxdWVzdBocLnlvcmtpZS52MS5Ccm9hZGNhc3RSZXNwb25zZSIAQkUKEWRldi55b3JraWUuYXBpLnYxUAFaLmdpdGh1Yi5jb20veW9ya2llLXRlYW0veW9ya2llL2FwaS95b3JraWUvdjE7djFiBnByb3RvMw",[X]),ly=Ab(cy,0),uy=Ht("Ch5nb29nbGUvcnBjL2Vycm9yX2RldGFpbHMucHJvdG8SCmdvb2dsZS5ycGMikwEKCUVycm9ySW5mbxIOCgZyZWFzb24YASABKAkSDgoGZG9tYWluGAIgASgJEjUKCG1ldGFkYXRhGAMgAygLMiMuZ29vZ2xlLnJwYy5FcnJvckluZm8uTWV0YWRhdGFFbnRyeRovCg1NZXRhZGF0YUVudHJ5EgsKA2tleRgBIAEoCRINCgV2YWx1ZRgCIAEoCToCOAEiOwoJUmV0cnlJbmZvEi4KC3JldHJ5X2RlbGF5GAEgASgLMhkuZ29vZ2xlLnByb3RvYnVmLkR1cmF0aW9uIjIKCURlYnVnSW5mbxIVCg1zdGFja19lbnRyaWVzGAEgAygJEg4KBmRldGFpbBgCIAEoCSKPAwoMUXVvdGFGYWlsdXJlEjYKCnZpb2xhdGlvbnMYASADKAsyIi5nb29nbGUucnBjLlF1b3RhRmFpbHVyZS5WaW9sYXRpb24axgIKCVZpb2xhdGlvbhIPCgdzdWJqZWN0GAEgASgJEhMKC2Rlc2NyaXB0aW9uGAIgASgJEhMKC2FwaV9zZXJ2aWNlGAMgASgJEhQKDHF1b3RhX21ldHJpYxgEIAEoCRIQCghxdW90YV9pZBgFIAEoCRJRChBxdW90YV9kaW1lbnNpb25zGAYgAygLMjcuZ29vZ2xlLnJwYy5RdW90YUZhaWx1cmUuVmlvbGF0aW9uLlF1b3RhRGltZW5zaW9uc0VudHJ5EhMKC3F1b3RhX3ZhbHVlGAcgASgDEh8KEmZ1dHVyZV9xdW90YV92YWx1ZRgIIAEoA0gAiAEBGjYKFFF1b3RhRGltZW5zaW9uc0VudHJ5EgsKA2tleRgBIAEoCRINCgV2YWx1ZRgCIAEoCToCOAFCFQoTX2Z1dHVyZV9xdW90YV92YWx1ZSKVAQoTUHJlY29uZGl0aW9uRmFpbHVyZRI9Cgp2aW9sYXRpb25zGAEgAygLMikuZ29vZ2xlLnJwYy5QcmVjb25kaXRpb25GYWlsdXJlLlZpb2xhdGlvbho/CglWaW9sYXRpb24SDAoEdHlwZRgBIAEoCRIPCgdzdWJqZWN0GAIgASgJEhMKC2Rlc2NyaXB0aW9uGAMgASgJIswBCgpCYWRSZXF1ZXN0Ej8KEGZpZWxkX3Zpb2xhdGlvbnMYASADKAsyJS5nb29nbGUucnBjLkJhZFJlcXVlc3QuRmllbGRWaW9sYXRpb24afQoORmllbGRWaW9sYXRpb24SDQoFZmllbGQYASABKAkSEwoLZGVzY3JpcHRpb24YAiABKAkSDgoGcmVhc29uGAMgASgJEjcKEWxvY2FsaXplZF9tZXNzYWdlGAQgASgLMhwuZ29vZ2xlLnJwYy5Mb2NhbGl6ZWRNZXNzYWdlIjcKC1JlcXVlc3RJbmZvEhIKCnJlcXVlc3RfaWQYASABKAkSFAoMc2VydmluZ19kYXRhGAIgASgJImAKDFJlc291cmNlSW5mbxIVCg1yZXNvdXJjZV90eXBlGAEgASgJEhUKDXJlc291cmNlX25hbWUYAiABKAkSDQoFb3duZXIYAyABKAkSEwoLZGVzY3JpcHRpb24YBCABKAkiVgoESGVscBIkCgVsaW5rcxgBIAMoCzIVLmdvb2dsZS5ycGMuSGVscC5MaW5rGigKBExpbmsSEwoLZGVzY3JpcHRpb24YASABKAkSCwoDdXJsGAIgASgJIjMKEExvY2FsaXplZE1lc3NhZ2USDgoGbG9jYWxlGAEgASgJEg8KB21lc3NhZ2UYAiABKAlCbAoOY29tLmdvb2dsZS5ycGNCEUVycm9yRGV0YWlsc1Byb3RvUAFaP2dvb2dsZS5nb2xhbmcub3JnL2dlbnByb3RvL2dvb2dsZWFwaXMvcnBjL2VycmRldGFpbHM7ZXJyZGV0YWlsc6ICA1JQQ2IGcHJvdG8z",[nm]),fy=Y(uy,0);var g=(t=>(t.Ok="ok",t.ErrClientNotActivated="ErrClientNotActivated",t.ErrClientNotFound="ErrClientNotFound",t.ErrUnimplemented="ErrUnimplemented",t.ErrInvalidType="ErrInvalidType",t.ErrDummy="ErrDummy",t.ErrNotAttached="ErrNotAttached",t.ErrNotDetached="ErrNotDetached",t.ErrDocumentRemoved="ErrDocumentRemoved",t.ErrDocumentSizeExceedsLimit="ErrDocumentSizeExceedsLimit",t.ErrDocumentSchemaValidationFailed="ErrDocumentSchemaValidationFailed",t.ErrInvalidObjectKey="ErrInvalidObjectKey",t.ErrInvalidArgument="ErrInvalidArgument",t.ErrNotInitialized="ErrNotInitialized",t.ErrNotReady="ErrNotReady",t.ErrRefused="ErrRefused",t.ErrContextNotProvided="ErrContextNotProvided",t.ErrPermissionDenied="ErrPermissionDenied",t.ErrUnauthenticated="ErrUnauthenticated",t.ErrTooManySubscribers="ErrTooManySubscribers",t.ErrTooManyAttachments="ErrTooManyAttachments",t))(g||{});class p extends Error{constructor(e,n){super(n),this.code=e,this.message=n,this.toString=()=>`[code=${this.code}]: ${this.message}`}name="YorkieError";stack}var xt=(t=>(t.Put="put",t.Clear="clear",t))(xt||{});const ea="000000000000000000000000",Nt=24;class tt{lamport;delimiter;actorID;constructor(e,n,r){this.lamport=e,this.delimiter=n,this.actorID=r}static of(e,n,r){return new tt(e,n,r)}static fromStruct(e){return tt.of(BigInt(e.lamport),e.delimiter,e.actorID)}toIDString(){return`${this.lamport.toString()}:${this.actorID}:${this.delimiter}`}toStruct(){return{lamport:this.getLamportAsString(),delimiter:this.getDelimiter(),actorID:this.getActorID()}}toTestString(){return`${this.lamport.toString()}:${this.actorID.slice(-2)}:${this.delimiter}`}setActor(e){return new tt(this.lamport,this.delimiter,e)}getLamportAsString(){return this.lamport.toString()}getLamport(){return this.lamport}getDelimiter(){return this.delimiter}getActorID(){return this.actorID}after(e){return this.compare(e)>0}equals(e){return this.compare(e)===0}compare(e){if(this.lamport>e.lamport)return 1;if(e.lamport>this.lamport)return-1;const n=this.actorID.localeCompare(e.actorID);return n!==0?n:this.delimiter>e.delimiter?1:e.delimiter>this.delimiter?-1:0}}const eo=0n,Df=0,to=9223372036854775807n,ar=new tt(eo,Df,ea);function Et(t){return t.replace(/["'\\\n\r\f\b\t\u2028\u2029]/g,function(e){switch(e){case'"':case"\\":return"\\"+e;case`
`:return"\\n";case"\r":return"\\r";case"\f":return"\\f";case"\b":return"\\b";case"	":return"\\t";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e}})}class ss{createdAt;movedAt;removedAt;constructor(e){this.createdAt=e}getCreatedAt(){return this.createdAt}getID(){return this.createdAt}getMovedAt(){return this.movedAt}getRemovedAt(){return this.removedAt}getPositionedAt(){return this.movedAt?this.movedAt:this.createdAt}setCreatedAt(e){this.createdAt=e}setMovedAt(e){return!this.movedAt||e&&e.after(this.movedAt)?(this.movedAt=e,!0):!1}setRemovedAt(e){this.removedAt=e}remove(e){return e&&e.after(this.createdAt)&&(!this.removedAt||e.after(this.removedAt))?(this.removedAt=e,!0):!1}isRemoved(){return!!this.removedAt}getMetaUsage(){let e=0;return this.getCreatedAt()&&(e+=Nt),this.getMovedAt()&&(e+=Nt),this.getRemovedAt()&&(e+=Nt),e}}class cn extends ss{constructor(e){super(e)}}class Zs{strKey;value;constructor(e,n){this.strKey=e,this.value=n}static of(e,n){return new Zs(e,n)}isRemoved(){return this.value.isRemoved()}getStrKey(){return this.strKey}getValue(){return this.value}remove(e){return this.value.remove(e)}}class cr{nodeMapByKey;nodeMapByCreatedAt;constructor(){this.nodeMapByKey=new Map,this.nodeMapByCreatedAt=new Map}static create(){return new cr}set(e,n,r){let s;const i=this.nodeMapByKey.get(e);i&&!i.isRemoved()&&i.remove(r)&&(s=i.getValue());const o=Zs.of(e,n);return this.nodeMapByCreatedAt.set(n.getCreatedAt().toIDString(),o),(!i||r.after(i.getValue().getPositionedAt()))&&(this.nodeMapByKey.set(e,o),n.setMovedAt(r)),s}delete(e,n){if(!this.nodeMapByCreatedAt.has(e.toIDString()))throw new p(g.ErrInvalidArgument,`fail to find ${e.toIDString()}`);const r=this.nodeMapByCreatedAt.get(e.toIDString());return r.remove(n),r.getValue()}subPathOf(e){const n=this.nodeMapByCreatedAt.get(e.toIDString());if(n)return n.getStrKey()}purge(e){const n=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!n)throw new p(g.ErrInvalidArgument,`fail to find ${e.getCreatedAt().toIDString()}`);const r=this.nodeMapByKey.get(n.getStrKey());n===r&&this.nodeMapByKey.delete(r.getStrKey()),this.nodeMapByCreatedAt.delete(n.getValue().getCreatedAt().toIDString())}deleteByKey(e,n){const r=this.nodeMapByKey.get(e);if(r&&r.remove(n))return r.getValue()}has(e){const n=this.nodeMapByKey.get(e);return n?!n.isRemoved():!1}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}get(e){const n=this.nodeMapByKey.get(e);if(!(!n||n.isRemoved()))return n}deepcopy(){const e=cr.create();for(const[,n]of this.nodeMapByCreatedAt)e.nodeMapByCreatedAt.set(n.getValue().getCreatedAt().toIDString(),Zs.of(n.getStrKey(),n.getValue().deepcopy()));for(const[n,r]of this.nodeMapByKey)e.nodeMapByKey.set(n,e.nodeMapByCreatedAt.get(r.getValue().getCreatedAt().toIDString()));return e}*[Symbol.iterator](){for(const[,e]of this.nodeMapByCreatedAt)yield e}}class Ce extends cn{memberNodes;constructor(e,n){super(e),this.memberNodes=n}static create(e,n){if(!n)return new Ce(e,cr.create());const r=cr.create();for(const[s,i]of Object.entries(n))r.set(s,i.deepcopy(),i.getCreatedAt());return new Ce(e,r)}subPathOf(e){return this.memberNodes.subPathOf(e)}purge(e){this.memberNodes.purge(e)}set(e,n,r){return this.memberNodes.set(e,n,r)}delete(e,n){return this.memberNodes.delete(e,n)}deleteByKey(e,n){return this.memberNodes.deleteByKey(e,n)}get(e){return this.memberNodes.get(e)?.getValue()}getByID(e){return this.memberNodes.getByID(e)?.getValue()}has(e){return this.memberNodes.has(e)}getDataSize(){return{data:0,meta:this.getMetaUsage()}}toJSON(){const e=[];for(const[n,r]of this)e.push(`"${Et(n)}":${r.toJSON()}`);return`{${e.join(",")}}`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const e={};for(const[n,r]of this){const{createdAt:s,value:i,type:o}=r.toJSForTest();e[n]={key:n,createdAt:s,value:i,type:o}}return{createdAt:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_OBJECT"}}getKeys(){const e=Array();for(const[n]of this)e.push(n);return e}toSortedJSON(){const e=new Set;for(const[r]of this)e.add(r);const n=[];for(const r of Array.from(e).sort()){const s=this.memberNodes.get(r)?.getValue();n.push(`"${Et(r)}":${s.toSortedJSON()}`)}return`{${n.join(",")}}`}getRHT(){return this.memberNodes}deepcopy(){const e=Ce.create(this.getCreatedAt());return e.memberNodes=this.memberNodes.deepcopy(),e.setRemovedAt(this.getRemovedAt()),e.setMovedAt(this.getMovedAt()),e}getDescendants(e){for(const n of this.memberNodes){const r=n.getValue();if(e(r,this))return;r instanceof cn&&r.getDescendants(e)}}*[Symbol.iterator](){for(const e of this.memberNodes)e.isRemoved()||(yield[e.getStrKey(),e.getValue()])}}var de=(t=>(t.Local="local",t.Remote="remote",t.UndoRedo="undoredo",t))(de||{});class pt{parentCreatedAt;executedAt;constructor(e,n){this.parentCreatedAt=e,this.executedAt=n}getParentCreatedAt(){return this.parentCreatedAt}getExecutedAt(){if(!this.executedAt)throw new p(g.ErrNotReady,"executedAt is not set yet");return this.executedAt}setActor(e){this.executedAt&&(this.executedAt=this.executedAt.setActor(e))}setExecutedAt(e){this.executedAt=e}}class Of{value;left;right;parent;weight;constructor(e){this.value=e,this.initWeight()}getNodeString(){return`${this.weight}${this.value}`}getValue(){return this.value}getLeftWeight(){return this.hasLeft()?this.left.getWeight():0}getRightWeight(){return this.hasRight()?this.right.getWeight():0}getWeight(){return this.weight}getLeft(){return this.left}getRight(){return this.right}getParent(){return this.parent}hasLeft(){return!!this.left}hasRight(){return!!this.right}hasParent(){return!!this.parent}setLeft(e){this.left=e}setRight(e){this.right=e}setParent(e){this.parent=e}unlink(){this.parent=void 0,this.right=void 0,this.left=void 0}hasLinks(){return this.hasParent()||this.hasLeft()||this.hasRight()}increaseWeight(e){this.weight+=e}initWeight(){this.weight=this.getLength()}}class zr{root;constructor(e){this.root=e}get length(){return this.root?this.root.getWeight():0}findForText(e){if(!this.root||e<0)return[void 0,0];let n=this.root;for(;;)if(n.hasLeft()&&e<=n.getLeftWeight())n=n.getLeft();else if(n.hasRight()&&n.getLeftWeight()+n.getLength()<e)e-=n.getLeftWeight()+n.getLength(),n=n.getRight();else{e-=n.getLeftWeight();break}if(e>n.getLength())throw new p(g.ErrInvalidArgument,`out of index range: pos: ${e} > node.length: ${n.getLength()}`);return this.splayNode(n),[n,e]}findForArray(e){if(!this.root)return;if(e<0||e>=this.length)throw new p(g.ErrInvalidArgument,`out of index range: idx: ${e}, length: ${this.length}`);let n=this.root;for(;;)if(n.hasLeft()&&e<n.getLeftWeight())n=n.getLeft();else if(n.hasRight()&&n.getLeftWeight()+n.getLength()<=e)e-=n.getLeftWeight()+n.getLength(),n=n.getRight();else break;return this.splayNode(n),n}indexOf(e){return!e||e!==this.root&&!e.hasLinks()?-1:(this.splayNode(e),this.root.getLeftWeight())}getRoot(){return this.root}insert(e){return this.insertAfter(this.root,e)}insertAfter(e,n){return e?(this.splayNode(e),this.root=n,n.setRight(e.getRight()),e.hasRight()&&e.getRight().setParent(n),n.setLeft(e),e.setParent(n),e.setRight(),this.updateWeight(e),this.updateWeight(n),n):(this.root=n,n)}updateWeight(e){e.initWeight(),e.hasLeft()&&e.increaseWeight(e.getLeftWeight()),e.hasRight()&&e.increaseWeight(e.getRightWeight())}updateTreeWeight(e){for(;e;)this.updateWeight(e),e=e.getParent()}splayNode(e){if(e)for(;;)if(this.isLeftChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e),this.rotateLeft(e);else if(this.isLeftChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e.getParent()),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e.getParent()),this.rotateLeft(e);else{this.isLeftChild(e)?this.rotateRight(e):this.isRightChild(e)&&this.rotateLeft(e),this.updateWeight(e);return}}delete(e){this.splayNode(e);const n=new zr(e.getLeft());n.root&&n.root.setParent();const r=new zr(e.getRight());if(r.root&&r.root.setParent(),n.root){const s=n.getRightmost();n.splayNode(s),n.root.setRight(r.root),r.root&&r.root.setParent(n.root),this.root=n.root}else this.root=r.root;e.unlink(),this.root&&this.updateWeight(this.root)}deleteRange(e,n){if(!n){this.splayNode(e),this.cutOffRight(e);return}this.splayNode(e),this.splayNode(n),n.getLeft()!=e&&this.rotateRight(e),this.cutOffRight(e)}cutOffRight(e){const n=[];this.traversePostorder(e.getRight(),n);for(const r of n)r.initWeight();this.updateTreeWeight(e)}toTestString(){const e=[];return this.traverseInorder(this.root,e),e.map(n=>`[${n.getWeight()},${n.getLength()}]${n.getValue()||""}`).join("")}checkWeight(){const e=[];this.traverseInorder(this.root,e);for(const n of e)if(n.getWeight()!=n.getLength()+n.getLeftWeight()+n.getRightWeight())return!1;return!0}getRightmost(){let e=this.root;for(;e.hasRight();)e=e.getRight();return e}traverseInorder(e,n){e&&(this.traverseInorder(e.getLeft(),n),n.push(e),this.traverseInorder(e.getRight(),n))}traversePostorder(e,n){e&&(this.traversePostorder(e.getLeft(),n),this.traversePostorder(e.getRight(),n),n.push(e))}rotateLeft(e){const n=e.getParent();n.hasParent()?n===n.getParent().getLeft()?n.getParent().setLeft(e):n.getParent().setRight(e):this.root=e,e.setParent(n.getParent()),n.setRight(e.getLeft()),n.hasRight()&&n.getRight().setParent(n),e.setLeft(n),e.getLeft().setParent(e),this.updateWeight(n),this.updateWeight(e)}rotateRight(e){const n=e.getParent();n.hasParent()?n===n.getParent().getLeft()?n.getParent().setLeft(e):n.getParent().setRight(e):this.root=e,e.setParent(n.getParent()),n.setLeft(e.getRight()),n.hasLeft()&&n.getLeft().setParent(n),e.setRight(n),e.getRight().setParent(e),this.updateWeight(n),this.updateWeight(e)}isLeftChild(e){return e&&e.hasParent()?e.getParent().getLeft()===e:!1}isRightChild(e){return e&&e.hasParent()?e.getParent().getRight()===e:!1}}var qe=null;try{qe=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function H(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}H.prototype.__isLong__;Object.defineProperty(H.prototype,"__isLong__",{value:!0});function xe(t){return(t&&t.__isLong__)===!0}function ll(t){var e=Math.clz32(t&-t);return t?31-e:e}H.isLong=xe;var ul={},fl={};function Wn(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=fl[t],r)?r:(n=q(t,0,!0),s&&(fl[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=ul[t],r)?r:(n=q(t,t<0?-1:0,!1),s&&(ul[t]=n),n))}H.fromInt=Wn;function et(t,e){if(isNaN(t))return e?Gt:ut;if(e){if(t<0)return Gt;if(t>=Lf)return Pf}else{if(t<=-dl)return Ze;if(t+1>=dl)return Wf}return t<0?et(-t,e).neg():q(t%lr|0,t/lr|0,e)}H.fromNumber=et;function q(t,e,n){return new H(t,e,n)}H.fromBits=q;var Gs=Math.pow;function ta(t,e,n){if(t.length===0)throw Error("empty string");if(typeof e=="number"?(n=e,e=!1):e=!!e,t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return e?Gt:ut;if(n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return ta(t.substring(1),e,n).neg();for(var s=et(Gs(n,8)),i=ut,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+a),n);if(a<8){var l=et(Gs(n,a));i=i.mul(l).add(et(c))}else i=i.mul(s),i=i.add(et(c))}return i.unsigned=e,i}H.fromString=ta;function it(t,e){return typeof t=="number"?et(t,e):typeof t=="string"?ta(t,e):q(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}H.fromValue=it;var hl=65536,hy=1<<24,lr=hl*hl,Lf=lr*lr,dl=Lf/2,gl=Wn(hy),ut=Wn(0);H.ZERO=ut;var Gt=Wn(0,!0);H.UZERO=Gt;var Kn=Wn(1);H.ONE=Kn;var Bf=Wn(1,!0);H.UONE=Bf;var no=Wn(-1);H.NEG_ONE=no;var Wf=q(-1,2147483647,!1);H.MAX_VALUE=Wf;var Pf=q(-1,-1,!0);H.MAX_UNSIGNED_VALUE=Pf;var Ze=q(0,-2147483648,!1);H.MIN_VALUE=Ze;var N=H.prototype;N.toInt=function(){return this.unsigned?this.low>>>0:this.low};N.toNumber=function(){return this.unsigned?(this.high>>>0)*lr+(this.low>>>0):this.high*lr+(this.low>>>0)};N.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Ze)){var n=et(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=et(Gs(e,6),this.unsigned),o=this,a="";;){var c=o.div(i),l=o.sub(c.mul(i)).toInt()>>>0,u=l.toString(e);if(o=c,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};N.getHighBits=function(){return this.high};N.getHighBitsUnsigned=function(){return this.high>>>0};N.getLowBits=function(){return this.low};N.getLowBitsUnsigned=function(){return this.low>>>0};N.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ze)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&(e&1<<n)==0;n--);return this.high!=0?n+33:n+1};N.isSafeInteger=function(){var e=this.high>>21;return e?this.unsigned?!1:e===-1&&!(this.low===0&&this.high===-2097152):!0};N.isZero=function(){return this.high===0&&this.low===0};N.eqz=N.isZero;N.isNegative=function(){return!this.unsigned&&this.high<0};N.isPositive=function(){return this.unsigned||this.high>=0};N.isOdd=function(){return(this.low&1)===1};N.isEven=function(){return(this.low&1)===0};N.equals=function(e){return xe(e)||(e=it(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};N.eq=N.equals;N.notEquals=function(e){return!this.eq(e)};N.neq=N.notEquals;N.ne=N.notEquals;N.lessThan=function(e){return this.comp(e)<0};N.lt=N.lessThan;N.lessThanOrEqual=function(e){return this.comp(e)<=0};N.lte=N.lessThanOrEqual;N.le=N.lessThanOrEqual;N.greaterThan=function(e){return this.comp(e)>0};N.gt=N.greaterThan;N.greaterThanOrEqual=function(e){return this.comp(e)>=0};N.gte=N.greaterThanOrEqual;N.ge=N.greaterThanOrEqual;N.compare=function(e){if(xe(e)||(e=it(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};N.comp=N.compare;N.negate=function(){return!this.unsigned&&this.eq(Ze)?Ze:this.not().add(Kn)};N.neg=N.negate;N.add=function(e){xe(e)||(e=it(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,c=e.low>>>16,l=e.low&65535,u=0,f=0,b=0,d=0;return d+=i+l,b+=d>>>16,d&=65535,b+=s+c,f+=b>>>16,b&=65535,f+=r+a,u+=f>>>16,f&=65535,u+=n+o,u&=65535,q(b<<16|d,u<<16|f,this.unsigned)};N.subtract=function(e){return xe(e)||(e=it(e)),this.add(e.neg())};N.sub=N.subtract;N.multiply=function(e){if(this.isZero())return this;if(xe(e)||(e=it(e)),qe){var n=qe.mul(this.low,this.high,e.low,e.high);return q(n,qe.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?Gt:ut;if(this.eq(Ze))return e.isOdd()?Ze:ut;if(e.eq(Ze))return this.isOdd()?Ze:ut;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(gl)&&e.lt(gl))return et(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,c=e.high&65535,l=e.low>>>16,u=e.low&65535,f=0,b=0,d=0,A=0;return A+=o*u,d+=A>>>16,A&=65535,d+=i*u,b+=d>>>16,d&=65535,d+=o*l,b+=d>>>16,d&=65535,b+=s*u,f+=b>>>16,b&=65535,b+=i*l,f+=b>>>16,b&=65535,b+=o*c,f+=b>>>16,b&=65535,f+=r*u+s*l+i*c+o*a,f&=65535,q(d<<16|A,f<<16|b,this.unsigned)};N.mul=N.multiply;N.divide=function(e){if(xe(e)||(e=it(e)),e.isZero())throw Error("division by zero");if(qe){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?qe.div_u:qe.div_s)(this.low,this.high,e.low,e.high);return q(n,qe.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Gt:ut;var r,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Gt;if(e.gt(this.shru(1)))return Bf;i=Gt}else{if(this.eq(Ze)){if(e.eq(Kn)||e.eq(no))return Ze;if(e.eq(Ze))return Kn;var o=this.shr(1);return r=o.div(e).shl(1),r.eq(ut)?e.isNegative()?Kn:no:(s=this.sub(e.mul(r)),i=r.add(s.div(e)),i)}else if(e.eq(Ze))return this.unsigned?Gt:ut;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=ut}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),c=a<=48?1:Gs(2,a-48),l=et(r),u=l.mul(e);u.isNegative()||u.gt(s);)r-=c,l=et(r,this.unsigned),u=l.mul(e);l.isZero()&&(l=Kn),i=i.add(l),s=s.sub(u)}return i};N.div=N.divide;N.modulo=function(e){if(xe(e)||(e=it(e)),qe){var n=(this.unsigned?qe.rem_u:qe.rem_s)(this.low,this.high,e.low,e.high);return q(n,qe.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};N.mod=N.modulo;N.rem=N.modulo;N.not=function(){return q(~this.low,~this.high,this.unsigned)};N.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};N.clz=N.countLeadingZeros;N.countTrailingZeros=function(){return this.low?ll(this.low):ll(this.high)+32};N.ctz=N.countTrailingZeros;N.and=function(e){return xe(e)||(e=it(e)),q(this.low&e.low,this.high&e.high,this.unsigned)};N.or=function(e){return xe(e)||(e=it(e)),q(this.low|e.low,this.high|e.high,this.unsigned)};N.xor=function(e){return xe(e)||(e=it(e)),q(this.low^e.low,this.high^e.high,this.unsigned)};N.shiftLeft=function(e){return xe(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?q(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):q(0,this.low<<e-32,this.unsigned)};N.shl=N.shiftLeft;N.shiftRight=function(e){return xe(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?q(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):q(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};N.shr=N.shiftRight;N.shiftRightUnsigned=function(e){return xe(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?q(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?q(this.high,0,this.unsigned):q(this.high>>>e-32,0,this.unsigned)};N.shru=N.shiftRightUnsigned;N.shr_u=N.shiftRightUnsigned;N.rotateLeft=function(e){var n;return xe(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?q(this.high,this.low,this.unsigned):e<32?(n=32-e,q(this.low<<e|this.high>>>n,this.high<<e|this.low>>>n,this.unsigned)):(e-=32,n=32-e,q(this.high<<e|this.low>>>n,this.low<<e|this.high>>>n,this.unsigned))};N.rotl=N.rotateLeft;N.rotateRight=function(e){var n;return xe(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?q(this.high,this.low,this.unsigned):e<32?(n=32-e,q(this.high<<n|this.low>>>e,this.low<<n|this.high>>>e,this.unsigned)):(e-=32,n=32-e,q(this.low<<n|this.high>>>e,this.high<<n|this.low>>>e,this.unsigned))};N.rotr=N.rotateRight;N.toSigned=function(){return this.unsigned?q(this.low,this.high,!1):this};N.toUnsigned=function(){return this.unsigned?this:q(this.low,this.high,!0)};N.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};N.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};N.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};H.fromBytes=function(e,n,r){return r?H.fromBytesLE(e,n):H.fromBytesBE(e,n)};H.fromBytesLE=function(e,n){return new H(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};H.fromBytesBE=function(e,n){return new H(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};typeof BigInt=="function"&&(H.fromBigInt=function(e,n){var r=Number(BigInt.asIntN(32,e)),s=Number(BigInt.asIntN(32,e>>BigInt(32)));return q(r,s,n)},H.fromValue=function(e,n){return typeof e=="bigint"?H.fromBigInt(e,n):it(e,n)},N.toBigInt=function(){var e=BigInt(this.low>>>0),n=BigInt(this.unsigned?this.high>>>0:this.high);return n<<BigInt(32)|e});var ce=(t=>(t[t.Null=0]="Null",t[t.Boolean=1]="Boolean",t[t.Integer=2]="Integer",t[t.Long=3]="Long",t[t.Double=4]="Double",t[t.String=5]="String",t[t.Bytes=6]="Bytes",t[t.Date=7]="Date",t))(ce||{});class be extends ss{valueType;value;constructor(e,n){super(n),this.valueType=be.getPrimitiveType(e),this.value=e===void 0?null:e}static of(e,n){return new be(e,n)}static valueFromBytes(e,n){switch(e){case 0:return null;case 1:return!!n[0];case 2:return n[0]|n[1]<<8|n[2]<<16|n[3]<<24;case 4:{const r=new DataView(n.buffer);return n.forEach(function(s,i){r.setUint8(i,s)}),r.getFloat64(0,!0)}case 5:return new TextDecoder("utf-8").decode(n);case 3:return H.fromBytesLE(Array.from(n));case 6:return n;case 7:return new Date(H.fromBytesLE(Array.from(n),!0).toNumber());default:throw new p(g.ErrUnimplemented,`unimplemented type: ${e}`)}}getValueSize(){switch(this.valueType){case 0:return 8;case 1:return 4;case 2:return 4;case 3:return 8;case 4:return 8;case 5:return this.value.length*2;case 6:return this.value.length;case 7:return 8;default:throw new p(g.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}getDataSize(){return{data:this.getValueSize(),meta:this.getMetaUsage()}}toJSON(){return this.valueType===5?`"${Et(this.value)}"`:`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_PRIMITIVE"}}deepcopy(){const e=be.of(this.value,this.getCreatedAt());return e.setMovedAt(this.getMovedAt()),e.setRemovedAt(this.getRemovedAt()),e}getType(){return this.valueType}static getPrimitiveType(e){switch(typeof e){case"undefined":return 0;case"boolean":return 1;case"number":return this.isInteger(e)?2:4;case"string":return 5;case"object":if(e===null)return 0;if(e instanceof H)return 3;if(e instanceof Uint8Array)return 6;if(e instanceof Date)return 7}}static isSupport(e){return be.getPrimitiveType(e)!==void 0}static isInteger(e){return e%1===0}isNumericType(){const e=this.valueType;return e===2||e===3||e===4}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:return new Uint8Array;case 1:return this.value?new Uint8Array([1]):new Uint8Array([0]);case 2:{const e=this.value;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}case 4:{const e=this.value,n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),n}case 5:return new TextEncoder().encode(this.value);case 3:{const n=this.value.toBytesLE();return Uint8Array.from(n)}case 6:return this.value;case 7:{const e=this.value,n=H.fromNumber(e.getTime(),!0).toBytesLE();return Uint8Array.from(n)}default:throw new p(g.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}}class Ms extends Of{prev;next;movedFrom;constructor(e){super(e),this.value=e}static createAfter(e,n){const r=new Ms(n),s=e.next;return e.next=r,r.prev=e,r.next=s,s&&(s.prev=r),r}remove(e){return this.value.remove(e)}getCreatedAt(){return this.value.getCreatedAt()}getPositionedAt(){return this.value.getPositionedAt()}release(){this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.prev=void 0,this.next=void 0}getLength(){return this.value.isRemoved()?0:1}getPrev(){return this.prev}getNext(){return this.next}getMovedFrom(){return this.movedFrom}setMovedFrom(e){this.movedFrom=e}getValue(){return this.value}isRemoved(){return this.value.isRemoved()}}class jr{dummyHead;last;nodeMapByIndex;nodeMapByCreatedAt;constructor(){const e=be.of(0,ar);e.setRemovedAt(ar),this.dummyHead=new Ms(e),this.last=this.dummyHead,this.nodeMapByIndex=new zr,this.nodeMapByCreatedAt=new Map,this.nodeMapByIndex.insert(this.dummyHead),this.nodeMapByCreatedAt.set(this.dummyHead.getCreatedAt().toIDString(),this.dummyHead)}static create(){return new jr}get length(){return this.nodeMapByIndex.length}findNextBeforeExecutedAt(e,n){let r=this.nodeMapByCreatedAt.get(e.toIDString());if(!r)throw new p(g.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);for(;r.getValue().getMovedAt()&&r.getValue().getMovedAt().after(n)&&r.getMovedFrom();)r=r.getMovedFrom();for(;r.getNext()&&r.getNext().getPositionedAt().after(n);)r=r.getNext();return r}release(e){this.last===e&&(this.last=e.getPrev()),e.release(),this.nodeMapByIndex.delete(e),this.nodeMapByCreatedAt.delete(e.getValue().getCreatedAt().toIDString())}insertAfter(e,n,r=n.getCreatedAt()){const s=this.findNextBeforeExecutedAt(e,r),i=Ms.createAfter(s,n);return s===this.last&&(this.last=i),this.nodeMapByIndex.insertAfter(s,i),this.nodeMapByCreatedAt.set(i.getCreatedAt().toIDString(),i),i}moveAfter(e,n,r){let s=this.nodeMapByCreatedAt.get(e.toIDString());if(!s)throw new p(g.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);let i=this.nodeMapByCreatedAt.get(n.toIDString());if(!i)throw new p(g.ErrInvalidArgument,`cant find the given node: ${n.toIDString()}`);if(s!==i&&r.after(i.getPositionedAt())){const o=i.getPrev();let a=i.getNext();for(this.release(i),i=this.insertAfter(s.getCreatedAt(),i.getValue(),r),i.getValue().setMovedAt(r),i.setMovedFrom(o);a&&a.getPositionedAt().after(r);)s=i,i=a,a=i.getNext(),this.release(i),i=this.insertAfter(s.getCreatedAt(),i.getValue(),r),i.getValue().setMovedAt(r),i.setMovedFrom(o)}}insert(e){this.insertAfter(this.last.getCreatedAt(),e)}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}subPathOf(e){const n=this.nodeMapByCreatedAt.get(e.toIDString());if(n)return String(this.nodeMapByIndex.indexOf(n))}purge(e){const n=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!n)throw new p(g.ErrInvalidArgument,`fail to find the given createdAt: ${e.getCreatedAt().toIDString()}`);this.release(n)}getByIndex(e){return e>=this.length?void 0:this.nodeMapByIndex.findForArray(e)}getPrevCreatedAt(e){let n=this.nodeMapByCreatedAt.get(e.toIDString());do n=n.getPrev();while(this.dummyHead!==n&&n.isRemoved());return n.getValue().getCreatedAt()}delete(e,n){const r=this.nodeMapByCreatedAt.get(e.toIDString()),s=r.isRemoved();return r.remove(n)&&!s&&this.nodeMapByIndex.splayNode(r),r.getValue()}set(e,n,r){const s=this.nodeMapByCreatedAt.get(e.toIDString());if(!s)throw new p(g.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);return this.insertAfter(s.getCreatedAt(),n,r),this.delete(e,r)}deleteByIndex(e,n){const r=this.getByIndex(e);if(r)return r.remove(n)&&this.nodeMapByIndex.splayNode(r),r.getValue()}getHead(){return this.dummyHead.getValue()}getLast(){return this.last.getValue()}getLastCreatedAt(){return this.last.getCreatedAt()}toTestString(){const e=[];for(const n of this){const r=`${n.getCreatedAt().toIDString()}:${n.getValue().toJSON()}`;n.isRemoved()?e.push(`{${r}}`):e.push(`[${r}]`)}return e.join("")}*[Symbol.iterator](){let e=this.dummyHead.getNext();for(;e;)yield e,e=e.getNext()}}class Te extends cn{elements;constructor(e,n){super(e),this.elements=n}static create(e,n){if(!n)return new Te(e,jr.create());const r=jr.create();for(const s of n)r.insertAfter(r.getLastCreatedAt(),s.deepcopy());return new Te(e,r)}subPathOf(e){return this.elements.subPathOf(e)}purge(e){this.elements.purge(e)}insertAfter(e,n,r){this.elements.insertAfter(e,n,r)}moveAfter(e,n,r){this.elements.moveAfter(e,n,r)}get(e){return this.elements.getByIndex(e)?.getValue()}getByID(e){return this.elements.getByID(e)?.getValue()}getHead(){return this.elements.getHead()}getLast(){return this.elements.getLast()}getPrevCreatedAt(e){return this.elements.getPrevCreatedAt(e)}delete(e,n){return this.elements.delete(e,n)}deleteByIndex(e,n){return this.elements.deleteByIndex(e,n)}set(e,n,r){return this.elements.set(e,n,r)}getLastCreatedAt(){return this.elements.getLastCreatedAt()}get length(){return this.elements.length}*[Symbol.iterator](){for(const e of this.elements)e.isRemoved()||(yield e.getValue())}toTestString(){return this.elements.toTestString()}getDescendants(e){for(const n of this.elements){const r=n.getValue();if(e(r,this))return;r instanceof cn&&r.getDescendants(e)}}getDataSize(){return{data:0,meta:this.getMetaUsage()}}toJSON(){const e=[];for(const n of this)e.push(n.toJSON());return`[${e.join(",")}]`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const e={};for(let n=0;n<this.length;n++){const{createdAt:r,value:s,type:i}=this.get(n).toJSForTest();e[n]={key:String(n),createdAt:r,value:s,type:i}}return{createdAt:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_ARRAY"}}toSortedJSON(){return this.toJSON()}getElements(){return this.elements}deepcopy(){const e=Te.create(this.getCreatedAt());for(const n of this.elements)e.elements.insertAfter(e.getLastCreatedAt(),n.getValue().deepcopy());return e.setRemovedAt(this.getRemovedAt()),e.setMovedAt(this.getMovedAt()),e}}class bn extends pt{prevCreatedAt;value;constructor(e,n,r,s){super(e,s),this.prevCreatedAt=n,this.value=r}static create(e,n,r,s){return new bn(e,n,r,s)}execute(e){const n=e.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new p(g.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof Te))throw new p(g.ErrInvalidArgument,"fail to execute, only array can execute add");const r=n,s=this.value.deepcopy();return r.insertAfter(this.prevCreatedAt,s,this.getExecutedAt()),e.registerElement(s,r),{opInfos:[{type:"add",path:e.createPath(this.getParentCreatedAt()),index:Number(r.subPathOf(this.getEffectedCreatedAt()))}],reverseOp:this.toReverseOperation()}}toReverseOperation(){return Vt.create(this.getParentCreatedAt(),this.value.getCreatedAt())}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.ADD.${this.value.toJSON()}`}getPrevCreatedAt(){return this.prevCreatedAt}getValue(){return this.value}setPrevCreatedAt(e){this.prevCreatedAt=e}}class Vt extends pt{createdAt;constructor(e,n,r){super(e,r),this.createdAt=n}static create(e,n,r){return new Vt(e,n,r)}execute(e,n){const r=e.findByCreatedAt(this.getParentCreatedAt());if(!r)throw new p(g.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(r instanceof cn))throw new p(g.ErrInvalidArgument,`only object and array can execute remove: ${r}`);if(n===de.UndoRedo){let c=r.getByID(this.createdAt);for(;c;){if(c.getRemovedAt())return;c=e.findElementPairByCreatedAt(c.getCreatedAt())?.parent}}const s=r.subPathOf(this.createdAt),i=this.toReverseOperation(r),o=r.delete(this.createdAt,this.getExecutedAt());return e.registerRemovedElement(o),{opInfos:r instanceof Te?[{type:"remove",path:e.createPath(this.getParentCreatedAt()),index:Number(s)}]:[{type:"remove",path:e.createPath(this.getParentCreatedAt()),key:s}],reverseOp:i}}toReverseOperation(e){if(e instanceof Te){const n=e.getByID(this.createdAt);if(n!==void 0){const r=e.getPrevCreatedAt(this.createdAt);return bn.create(this.getParentCreatedAt(),r,n.deepcopy())}}if(e instanceof Ce){const n=e.subPathOf(this.createdAt);if(n!==void 0){const r=e.get(n);if(r!==void 0)return Bn.create(n,r.deepcopy(),this.getParentCreatedAt())}}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.REMOVE.${this.createdAt.toTestString()}`}getCreatedAt(){return this.createdAt}setCreatedAt(e){this.createdAt=e}}class Bn extends pt{key;value;constructor(e,n,r,s){super(r,s),this.key=e,this.value=n}static create(e,n,r,s){return new Bn(e,n,r,s)}execute(e,n){const r=e.findByCreatedAt(this.getParentCreatedAt());if(!r)throw new p(g.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(r instanceof Ce))throw new p(g.ErrInvalidArgument,"fail to execute, only object can execute set");if(n===de.UndoRedo){let c=r;for(;c;){if(c.getRemovedAt())return;c=e.findElementPairByCreatedAt(c.getCreatedAt())?.parent}}const s=r.get(this.key),i=this.toReverseOperation(s),o=this.value.deepcopy(),a=r.set(this.key,o,this.getExecutedAt());return n===de.UndoRedo&&e.findByCreatedAt(o.getCreatedAt())&&e.deregisterElement(o),e.registerElement(o,r),a&&e.registerRemovedElement(a),{opInfos:[{type:"set",path:e.createPath(this.getParentCreatedAt()),key:this.key}],reverseOp:i}}toReverseOperation(e){let n=Vt.create(this.getParentCreatedAt(),this.value.getCreatedAt());return e!==void 0&&!e.isRemoved()&&(n=Bn.create(this.key,e.deepcopy(),this.getParentCreatedAt())),n}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.SET.${this.key}=${this.value.toSortedJSON()}`}getKey(){return this.key}getValue(){return this.value}}class ft extends pt{prevCreatedAt;createdAt;constructor(e,n,r,s){super(e,s),this.prevCreatedAt=n,this.createdAt=r}static create(e,n,r,s){return new ft(e,n,r,s)}execute(e){const n=e.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new p(g.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof Te))throw new p(g.ErrInvalidArgument,"fail to execute, only array can execute move");const r=n,s=this.toReverseOperation(r),i=Number(r.subPathOf(this.createdAt));r.moveAfter(this.prevCreatedAt,this.createdAt,this.getExecutedAt());const o=Number(r.subPathOf(this.createdAt));return{opInfos:[{type:"move",path:e.createPath(this.getParentCreatedAt()),index:o,previousIndex:i}],reverseOp:s}}toReverseOperation(e){const n=e.getPrevCreatedAt(this.createdAt);return ft.create(this.getParentCreatedAt(),n,this.createdAt)}getEffectedCreatedAt(){return this.createdAt}toTestString(){return`${this.getParentCreatedAt().toTestString()}.MOVE`}getPrevCreatedAt(){return this.prevCreatedAt}getCreatedAt(){return this.createdAt}setPrevCreatedAt(e){this.prevCreatedAt=e}setCreatedAt(e){this.createdAt=e}}const dy=(t,e)=>t===e?0:t<e?-1:1;class gy{key;value;left;right;isRed;constructor(e,n,r){this.key=e,this.value=n,this.isRed=r}}class py{stack;constructor(e){this.stack=[],this.traverseInorder(e)}traverseInorder(e){e&&(this.traverseInorder(e.left),this.stack.push({key:e.key,value:e.value}),this.traverseInorder(e.right))}}class _f{root;comparator;counter;constructor(e){this.comparator=typeof e<"u"?e:dy,this.counter=0}put(e,n){return this.root=this.putInternal(e,n,this.root),this.root.isRed=!1,n}get(e){const n=this.getInternal(e,this.root);return n?n.value:void 0}remove(e){!this.isRed(this.root.left)&&!this.isRed(this.root.right)&&(this.root.isRed=!0),this.root=this.removeInternal(this.root,e),this.root&&(this.root.isRed=!1)}getIterator(){return new py(this.root)}values(){const e=[];for(const n of this.getIterator().stack)e.push(n.value);return e}floorEntry(e){let n=this.root,r;for(;n;){const s=this.comparator(e,n.key);if(s===0)return n;s<0?n=n.left:(r=n,n=n.right)}return r}lastEntry(){if(!this.root)return this.root;let e=this.root;for(;e.right;)e=e.right;return e}size(){return this.counter}isEmpty(){return this.counter===0}getInternal(e,n){for(;n;){const r=this.comparator(e,n.key);if(r===0)return n;r<0?n=n.left:r>0&&(n=n.right)}}putInternal(e,n,r){if(!r)return this.counter+=1,new gy(e,n,!0);const s=this.comparator(e,r.key);return s<0?r.left=this.putInternal(e,n,r.left):s>0?r.right=this.putInternal(e,n,r.right):r.value=n,this.isRed(r.right)&&!this.isRed(r.left)&&(r=this.rotateLeft(r)),this.isRed(r.left)&&this.isRed(r.left.left)&&(r=this.rotateRight(r)),this.isRed(r.left)&&this.isRed(r.right)&&this.flipColors(r),r}removeInternal(e,n){if(this.comparator(n,e.key)<0)!this.isRed(e.left)&&!this.isRed(e.left.left)&&(e=this.moveRedLeft(e)),e.left=this.removeInternal(e.left,n);else{if(this.isRed(e.left)&&(e=this.rotateRight(e)),this.comparator(n,e.key)===0&&!e.right){this.counter-=1;return}if(!this.isRed(e.right)&&!this.isRed(e.right.left)&&(e=this.moveRedRight(e)),this.comparator(n,e.key)===0){this.counter-=1;const r=this.min(e.right);e.value=r.value,e.key=r.key,e.right=this.removeMin(e.right)}else e.right=this.removeInternal(e.right,n)}return this.fixUp(e)}min(e){return e.left?this.min(e.left):e}removeMin(e){if(e.left)return!this.isRed(e.left)&&!this.isRed(e.left.left)&&(e=this.moveRedLeft(e)),e.left=this.removeMin(e.left),this.fixUp(e)}fixUp(e){return this.isRed(e.right)&&(e=this.rotateLeft(e)),this.isRed(e.left)&&this.isRed(e.left.left)&&(e=this.rotateRight(e)),this.isRed(e.left)&&this.isRed(e.right)&&this.flipColors(e),e}moveRedLeft(e){return this.flipColors(e),this.isRed(e.right.left)&&(e.right=this.rotateRight(e.right),e=this.rotateLeft(e),this.flipColors(e)),e}moveRedRight(e){return this.flipColors(e),this.isRed(e.left.left)&&(e=this.rotateRight(e),this.flipColors(e)),e}isRed(e){return e&&e.isRed}rotateLeft(e){const n=e.right;return e.right=n.left,n.left=e,n.isRed=n.left.isRed,n.left.isRed=!0,n}rotateRight(e){const n=e.left;return e.left=n.right,n.right=e,n.isRed=n.right.isRed,n.right.isRed=!0,n}flipColors(e){e.isRed=!e.isRed,e.left.isRed=!e.left.isRed,e.right.isRed=!e.right.isRed}}function my(t){return t?pl(t.live)+pl(t.gc):0}function pl(t){return t.data+t.meta}function we(t,...e){for(const n of e)t.data+=n.data,t.meta+=n.meta}function Tn(t,e){t.data-=e.data,t.meta-=e.meta}class Rt{createdAt;offset;constructor(e,n){this.createdAt=e,this.offset=n}static of(e,n){return new Rt(e,n)}static fromStruct(e){return Rt.of(tt.fromStruct(e.createdAt),e.offset)}getCreatedAt(){return this.createdAt}getOffset(){return this.offset}equals(e){return this.createdAt.compare(e.createdAt)===0&&this.offset===e.offset}hasSameCreatedAt(e){return this.createdAt.compare(e.createdAt)===0}split(e){return new Rt(this.createdAt,this.offset+e)}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toTestString(){return`${this.createdAt.toTestString()}:${this.offset}`}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}}const by=Rt.of(ar,0);class Ee{id;relativeOffset;constructor(e,n){this.id=e,this.relativeOffset=n}static of(e,n){return new Ee(e,n)}static fromStruct(e){const n=Rt.fromStruct(e.id);return Ee.of(n,e.relativeOffset)}getID(){return this.id}getRelativeOffset(){return this.relativeOffset}getAbsoluteID(){return Rt.of(this.id.getCreatedAt(),this.id.getOffset()+this.relativeOffset)}toTestString(){return`${this.id.toTestString()}:${this.relativeOffset}`}toStruct(){return{id:this.id.toStruct(),relativeOffset:this.relativeOffset}}equals(e){return this.id.equals(e.id)?this.relativeOffset===e.relativeOffset:!1}}class ln extends Of{id;removedAt;prev;next;insPrev;insNext;constructor(e,n,r){super(n),this.id=e,this.removedAt=r}static create(e,n){return new ln(e,n)}static createComparator(){return(e,n)=>{const r=e.getCreatedAt().compare(n.getCreatedAt());return r!==0?r:e.getOffset()>n.getOffset()?1:e.getOffset()<n.getOffset()?-1:0}}getID(){return this.id}getCreatedAt(){return this.id.getCreatedAt()}getLength(){return this.removedAt?0:this.getContentLength()}getContentLength(){return this.value&&this.value.length||0}getPrev(){return this.prev}getNext(){return this.next}getInsPrev(){return this.insPrev}getInsNext(){return this.insNext}getInsPrevID(){return this.insPrev.getID()}setPrev(e){this.prev=e,e&&(e.next=this)}setNext(e){this.next=e,e&&(e.prev=this)}setInsPrev(e){this.insPrev=e,e&&(e.insNext=this)}setInsNext(e){this.insNext=e,e&&(e.insPrev=this)}hasNext(){return!!this.next}hasInsPrev(){return!!this.insPrev}isRemoved(){return!!this.removedAt}getRemovedAt(){return this.removedAt}split(e){return new ln(this.id.split(e),this.splitValue(e),this.removedAt)}canRemove(e,n,r){return n?!!(!this.removedAt||!r&&e?.after(this.removedAt)):!1}canStyle(e,n){return this.getCreatedAt().getLamport()<=n&&(!this.removedAt||e.after(this.removedAt))}setRemovedAt(e){this.removedAt=e}remove(e){if(!this.removedAt){this.removedAt=e;return}e.after(this.removedAt)&&(this.removedAt=e)}createPosRange(){return[Ee.of(this.id,0),Ee.of(this.id,this.getLength())]}getDataSize(){const e=this.value.getDataSize();return this.id&&(e.meta+=Nt),this.removedAt&&(e.meta+=Nt),e}deepcopy(){return new ln(this.id,this.value,this.removedAt)}toTestString(){return`${this.id.toTestString()} ${this.value?this.value:""}`}splitValue(e){const n=this.value;return this.value=n.substring(0,e),n.substring(e,n.length)}toIDString(){return this.id.toIDString()}}class ur{head;treeByIndex;treeByID;constructor(){this.head=ln.create(by),this.treeByIndex=new zr,this.treeByID=new _f(ln.createComparator()),this.treeByIndex.insert(this.head),this.treeByID.put(this.head.getID(),this.head)}static create(){return new ur}edit(e,n,r,s){const i={data:0,meta:0},[o,a,c]=this.findNodeWithSplit(e[1],n),[l,u,f]=this.findNodeWithSplit(e[0],n);we(i,a,u);const b=this.findBetween(f,c),[d,A]=this.deleteNodes(b,n,s),S=c?c.getID():o.getID();let W=Ee.of(S,0);if(r){const _=this.posToIndex(l.createPosRange()[1],!0),D=this.insertAfter(l,ln.create(Rt.of(n,0),r));we(i,D.getDataSize()),d.length&&d[d.length-1].from===_?d[d.length-1].value=r:d.push({actor:n.getActorID(),from:_,to:_,value:r}),W=Ee.of(D.getID(),D.getContentLength())}const L=[],G=[];for(const[,_]of A)L.push({parent:this,child:_}),G.push(_.getValue());return[W,L,i,d,G]}indexToPos(e){const[n,r]=this.treeByIndex.findForText(e),s=n;return Ee.of(s.getID(),r)}findIndexesFromRange(e){const[n,r]=e;return[this.posToIndex(n,!1),this.posToIndex(r,!0)]}posToIndex(e,n){const r=e.getAbsoluteID(),s=n?this.findFloorNodePreferToLeft(r):this.findFloorNode(r);if(!s)throw new p(g.ErrInvalidArgument,`the node of the given id should be found: ${r.toTestString()}`);const i=this.treeByIndex.indexOf(s),o=s.isRemoved()?0:r.getOffset()-s.getID().getOffset();return i+o}findNode(e){return this.findFloorNode(e)}get length(){return this.treeByIndex.length}getTreeByIndex(){return this.treeByIndex}getTreeByID(){return this.treeByID}toString(){const e=[];for(const n of this)n.isRemoved()||e.push(n.getValue());return e.join("")}*[Symbol.iterator](){let e=this.head.getNext();for(;e;)yield e,e=e.getNext()}getHead(){return this.head}deepcopy(){const e=new ur;let n=this.head.getNext(),r=e.head,s;for(;n;){if(s=e.insertAfter(r,n.deepcopy()),n.hasInsPrev()){const i=e.findNode(n.getInsPrevID());s.setInsPrev(i)}r=s,n=n.getNext()}return e}normalizePos(e){const n=this.findFloorNode(e.getID());if(!n)throw new p(g.ErrInvalidArgument,`the node of the given id should be found: ${e.getID().toTestString()}`);let r=e.getRelativeOffset(),s=n,i=n.getPrev();for(;i;)r+=i.getLength(),s=i,i=i.getPrev();return Ee.of(s.getID(),r)}refinePos(e){let n=this.findFloorNode(e.getID());if(!n)throw new p(g.ErrInvalidArgument,`the node of the given id should be found: ${e.getID().toTestString()}`);let r=e.getRelativeOffset(),s=n.getContentLength();for(;r>s;){r-=s;const i=n.getNext();if(!i)return Ee.of(n.getID(),s);n=i,s=n.getLength()}return Ee.of(n.getID(),r)}toTestString(){const e=[];let n=this.head;for(;n;)n.isRemoved()?e.push(`{${n.toTestString()}}`):e.push(`[${n.toTestString()}]`),n=n.getNext();return e.join("")}insertAfter(e,n){const r=e.getNext();return n.setPrev(e),r&&r.setPrev(n),this.treeByID.put(n.getID(),n),this.treeByIndex.insertAfter(e,n),n}findNodeWithSplit(e,n){const r=e.getAbsoluteID();let s=this.findFloorNodePreferToLeft(r);const i=r.getOffset()-s.getID().getOffset(),[,o]=this.splitNode(s,i);for(;s.hasNext()&&s.getNext().getCreatedAt().after(n);)s=s.getNext();return[s,o,s.getNext()]}findFloorNodePreferToLeft(e){let n=this.findFloorNode(e);if(!n)throw new p(g.ErrInvalidArgument,`the node of the given id should be found: ${e.toTestString()}`);if(e.getOffset()>0&&n.getID().getOffset()==e.getOffset()){if(!n.hasInsPrev())return n;n=n.getInsPrev()}return n}findFloorNode(e){const n=this.treeByID.floorEntry(e);if(n&&!(!n.key.equals(e)&&!n.key.hasSameCreatedAt(e)))return n.value}findBetween(e,n){const r=[];let s=e;for(;s&&s!==n;)r.push(s),s=s.getNext();return r}splitNode(e,n){const r={data:0,meta:0};if(n>e.getContentLength())throw new p(g.ErrInvalidArgument,"offset should be less than or equal to length");if(n===0)return[e,r];if(n===e.getContentLength())return[e.getNext(),r];const s=e.getDataSize(),i=e.split(n);this.treeByIndex.updateWeight(i),this.insertAfter(e,i);const o=e.getInsNext();return o&&o.setInsPrev(i),i.setInsPrev(e),we(r,e.getDataSize(),i.getDataSize()),Tn(r,s),[i,r]}deleteNodes(e,n,r){if(!e.length)return[[],new Map];const s=r===void 0||r.size()===0,i=[],o=[],[a,c]=this.findEdgesOfCandidates(e);o.push(a);for(const f of e){let b=!1;if(s)b=!0;else{const A=r?.get(f.getCreatedAt().getActorID());A&&A>=f.getCreatedAt().getLamport()&&(b=!0)}let d=!1;if(f.getRemovedAt()){const A=r?.get(f.getRemovedAt().getActorID());(s||A&&A>=f.getRemovedAt().getLamport())&&(d=!0)}f.canRemove(n,b,d)?i.push(f):o.push(f)}o.push(c);const l=this.makeChanges(o,n),u=new Map;for(const f of i)u.set(f.getID().toIDString(),f),f.remove(n);return this.deleteIndexNodes(o),[l,u]}findEdgesOfCandidates(e){return[e[0].getPrev(),e[e.length-1].getNext()]}makeChanges(e,n){const r=[];let s,i;for(let o=0;o<e.length-1;o++){const a=e[o],c=e[o+1];a.getNext()!=c&&([s]=this.findIndexesFromRange(a.getNext().createPosRange()),c?[,i]=this.findIndexesFromRange(c.getPrev().createPosRange()):i=this.treeByIndex.length,s<i&&r.push({actor:n.getActorID(),from:s,to:i}))}return r.reverse()}deleteIndexNodes(e){for(let n=0;n<e.length-1;n++){const r=e[n],s=e[n+1];r.getNext()!=s&&this.treeByIndex.deleteRange(r,s)}}purge(e){this.treeByIndex.delete(e),this.treeByID.remove(e.getID());const n=e.getPrev(),r=e.getNext(),s=e.getInsPrev(),i=e.getInsNext();n&&n.setNext(r),r&&r.setPrev(n),e.setPrev(void 0),e.setNext(void 0),s&&s.setInsNext(i),i&&i.setInsPrev(s),e.setInsPrev(void 0),e.setInsNext(void 0)}}class an{key;value;updatedAt;_isRemoved;constructor(e,n,r,s){this.key=e,this.value=n,this.updatedAt=r,this._isRemoved=s}static of(e,n,r,s){return new an(e,n,r,s)}getKey(){return this.key}getValue(){return this.value}getUpdatedAt(){return this.updatedAt}isRemoved(){return this._isRemoved}toIDString(){return`${this.updatedAt.toIDString()}:${this.key}`}getRemovedAt(){if(this._isRemoved)return this.updatedAt}getDataSize(){return{data:(this.key.length+this.value.length)*2,meta:Nt}}}class Xt{nodeMapByKey;numberOfRemovedElement;constructor(){this.nodeMapByKey=new Map,this.numberOfRemovedElement=0}static create(){return new Xt}getNodeMapByKey(){return this.nodeMapByKey}set(e,n,r){const s=this.nodeMapByKey.get(e);if(s&&s.isRemoved()&&r.after(s.getUpdatedAt())&&(this.numberOfRemovedElement-=1),s===void 0||r.after(s.getUpdatedAt())){const i=an.of(e,n,r,!1);return this.nodeMapByKey.set(e,i),s!==void 0&&s.isRemoved()?[s,i]:[void 0,i]}return s.isRemoved()?[s,void 0]:[void 0,void 0]}setInternal(e,n,r,s){const i=an.of(e,n,r,s);this.nodeMapByKey.set(e,i),s&&this.numberOfRemovedElement++}remove(e,n){const r=this.nodeMapByKey.get(e),s=[];if(r===void 0||n.after(r.getUpdatedAt())){if(r===void 0){this.numberOfRemovedElement+=1;const a=an.of(e,"",n,!0);return this.nodeMapByKey.set(e,a),s.push(a),s}const i=r.isRemoved();i||(this.numberOfRemovedElement+=1),i&&s.push(r);const o=an.of(e,r.getValue(),n,!0);return this.nodeMapByKey.set(e,o),s.push(o),s}return s}has(e){if(this.nodeMapByKey.has(e)){const n=this.nodeMapByKey.get(e);return n!==void 0&&!n.isRemoved()}return!1}get(e){if(this.nodeMapByKey.has(e))return this.nodeMapByKey.get(e).getValue()}deepcopy(){const e=new Xt;for(const[,n]of this.nodeMapByKey)e.setInternal(n.getKey(),n.getValue(),n.getUpdatedAt(),n.isRemoved());return e}toJSON(){if(!this.size())return"{}";const e=[];for(const[n,r]of this.nodeMapByKey)r.isRemoved()||e.push(`"${Et(n)}":"${Et(r.getValue())}"`);return`{${e.join(",")}}`}size(){return this.nodeMapByKey.size-this.numberOfRemovedElement}toObject(){const e={};for(const[n,r]of this.nodeMapByKey)r.isRemoved()||(e[n]=r.getValue());return e}*[Symbol.iterator](){for(const[,e]of this.nodeMapByKey)yield e}purge(e){const n=this.nodeMapByKey.get(e.getKey());n==null||n.toIDString()!=e.toIDString()||(this.nodeMapByKey.delete(e.getKey()),this.numberOfRemovedElement--)}}function at(t){if(t instanceof Map){const e=Array.from(t);return new Map(JSON.parse(JSON.stringify(e)))}return JSON.parse(JSON.stringify(t))}const Uf=t=>t?Object.entries(t).length===0:!0,fr=t=>{const e={};for(const[n,r]of Object.entries(t))e[n]=JSON.stringify(r);return e},Mt=t=>{const e={};for(const[n,r]of Object.entries(t))e[n]=JSON.parse(r);return e};class Hr{attributes;content;constructor(e){this.attributes=Xt.create(),this.content=e}static create(e){return new Hr(e)}get length(){return this.content.length}substring(e,n){const r=new Hr(this.content.substring(e,n));return r.attributes=this.attributes.deepcopy(),r}setAttr(e,n,r){return this.attributes.set(e,n,r)}getAttrs(){return this.attributes}toString(){return this.content}getDataSize(){const e={data:0,meta:0};e.data+=this.content.length*2;for(const n of this.attributes){const r=n.getDataSize();e.meta+=r.meta,e.data+=r.data}return e}toJSON(){const e=Et(this.content),n=this.attributes.toObject(),r=[];for(const[s,i]of Object.entries(n)){const o=JSON.parse(i),a=typeof o=="string"?`"${Et(s)}":"${Et(o)}"`:`"${Et(s)}":${String(o)}`;r.push(a)}return r.sort(),r.length===0?`{"val":"${e}"}`:`{"attrs":{${r.join(",")}},"val":"${e}"}`}getAttributes(){return this.attributes.toObject()}getContent(){return this.content}purge(e){this.attributes&&e instanceof an&&this.attributes.purge(e)}getGCPairs(){const e=[];for(const n of this.attributes)n.getRemovedAt()&&e.push({parent:this,child:n});return e}}class Ye extends ss{rgaTreeSplit;constructor(e,n){super(n),this.rgaTreeSplit=e}static create(e,n){return new Ye(e,n)}edit(e,n,r,s,i){const o=n?Hr.create(n):void 0;if(o&&s)for(const[d,A]of Object.entries(s))o.setAttr(d,A,r);const[a,c,l,u,f]=this.rgaTreeSplit.edit(e,r,o,i);return[u.map(d=>({...d,value:d.value?{attributes:Mt(d.value.getAttributes()),content:d.value.getContent()}:{attributes:void 0,content:""},type:"content"})),c,l,[a,a],f]}setStyle(e,n,r,s){const i={data:0,meta:0},[,o,a]=this.rgaTreeSplit.findNodeWithSplit(e[1],r),[,c,l]=this.rgaTreeSplit.findNodeWithSplit(e[0],r);we(i,o,c);const u=[],f=this.rgaTreeSplit.findBetween(l,a),b=[];for(const A of f){const S=A.getCreatedAt().getActorID();let W=to;s!=null&&(W=s.get(S)?s.get(S):0n),A.canStyle(r,W)&&b.push(A)}const d=[];for(const A of b){if(A.isRemoved())continue;const[S,W]=this.rgaTreeSplit.findIndexesFromRange(A.createPosRange());u.push({type:"style",actor:r.getActorID(),from:S,to:W,value:{attributes:Mt(n)}});for(const[L,G]of Object.entries(n)){const[_]=A.getValue().setAttr(L,G,r);_!==void 0&&d.push({parent:A.getValue(),child:_});const D=A.getValue().getAttrs().getNodeMapByKey().get(L);D!==void 0&&we(i,D.getDataSize())}}return[d,i,u]}indexRangeToPosRange(e,n){const r=this.rgaTreeSplit.indexToPos(e);return e===n?[r,r]:[r,this.rgaTreeSplit.indexToPos(n)]}get length(){return this.rgaTreeSplit.length}getTreeByIndex(){return this.rgaTreeSplit.getTreeByIndex()}getTreeByID(){return this.rgaTreeSplit.getTreeByID()}refinePos(e){return this.rgaTreeSplit.refinePos(e)}normalizePos(e){return this.rgaTreeSplit.normalizePos(e)}getDataSize(){const e={data:0,meta:0};for(const n of this.rgaTreeSplit){if(n.isRemoved())continue;const r=n.getDataSize();e.data+=r.data,e.meta+=r.meta}return{data:e.data,meta:e.meta+this.getMetaUsage()}}toJSON(){const e=[];for(const n of this.rgaTreeSplit)n.isRemoved()||e.push(n.getValue().toJSON());return`[${e.join(",")}]`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TEXT"}}toString(){return this.rgaTreeSplit.toString()}values(){const e=[];for(const n of this.rgaTreeSplit)if(!n.isRemoved()){const r=n.getValue();e.push({attributes:Mt(r.getAttributes()),content:r.getContent()})}return e}getRGATreeSplit(){return this.rgaTreeSplit}toTestString(){return this.rgaTreeSplit.toTestString()}deepcopy(){const e=new Ye(this.rgaTreeSplit.deepcopy(),this.getCreatedAt());return e.setRemovedAt(this.getRemovedAt()),e.setMovedAt(this.getMovedAt()),e}findIndexesFromRange(e){return this.rgaTreeSplit.findIndexesFromRange(e)}posToIndex(e,n=!1){return this.rgaTreeSplit.posToIndex(e,n)}getGCPairs(){const e=[];for(const n of this.rgaTreeSplit){n.getRemovedAt()&&e.push({parent:this.rgaTreeSplit,child:n});for(const r of n.getValue().getGCPairs())e.push(r)}return e}}class gn extends pt{fromPos;toPos;content;attributes;isUndoOp;constructor(e,n,r,s,i,o,a){super(e,o),this.fromPos=n,this.toPos=r,this.content=s,this.attributes=i,this.isUndoOp=a}static create(e,n,r,s,i,o,a){return new gn(e,n,r,s,i,o,a)}execute(e,n,r){const s=e.findByCreatedAt(this.getParentCreatedAt());if(!s)throw new p(g.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(s instanceof Ye))throw new p(g.ErrInvalidArgument,"fail to execute, only Text can execute edit");const i=s;this.isUndoOp&&(this.fromPos=i.refinePos(this.fromPos),this.toPos=i.refinePos(this.toPos));const[o,a,c,,l]=i.edit([this.fromPos,this.toPos],this.content,this.getExecutedAt(),Object.fromEntries(this.attributes),r),u=this.toReverseOperation(l,i.normalizePos(this.fromPos));e.acc(c);for(const f of a)e.registerGCPair(f);return{opInfos:o.map(({from:f,to:b,value:d})=>({type:"edit",from:f,to:b,value:d,path:e.createPath(this.getParentCreatedAt())})),reverseOp:u}}toReverseOperation(e,n){const r=e?.length?e.map(i=>i.getContent()).join(""):"";let s;if(e.length===1){const i=e[0].getAttributes();i&&(s=Array.from(Object.entries(i)))}return gn.create(this.getParentCreatedAt(),n,Ee.of(n.getID(),n.getRelativeOffset()+(this.content?.length??0)),r,s?new Map(s):new Map,void 0,!0)}normalizePos(e){const n=e.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new p(g.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof Ye))throw new p(g.ErrInvalidArgument,"only Text can normalize edit");const r=n,s=r.normalizePos(this.fromPos).getRelativeOffset(),i=r.normalizePos(this.toPos).getRelativeOffset();return[s,i]}reconcileOperation(e,n,r){if(!this.isUndoOp||e>n)return;const s=n-e,i=this.fromPos.getRelativeOffset(),o=this.toPos.getRelativeOffset(),a=(c,l)=>{this.fromPos=Ee.of(this.fromPos.getID(),Math.max(0,c)),this.toPos=Ee.of(this.toPos.getID(),Math.max(0,l))};if(n<=i){a(i-s+r,o-s+r);return}if(!(o<=e)){if(e<=i&&o<=n&&e!==n){a(e,e);return}if(i<=e&&n<=o&&i!==o){a(i,o-s+r);return}if(e<i&&i<n&&n<o){a(e,e+(o-n));return}if(i<e&&e<o&&o<n){a(i,e);return}}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),n=this.fromPos.toTestString(),r=this.toPos.toTestString(),s=this.content;return`${e}.EDIT(${n},${r},${s})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContent(){return this.content}getAttributes(){return this.attributes||new Map}}class is extends pt{fromPos;toPos;attributes;constructor(e,n,r,s,i){super(e,i),this.fromPos=n,this.toPos=r,this.attributes=s}static create(e,n,r,s,i){return new is(e,n,r,s,i)}execute(e,n,r){const s=e.findByCreatedAt(this.getParentCreatedAt());if(!s)throw new p(g.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(s instanceof Ye))throw new p(g.ErrInvalidArgument,"fail to execute, only Text can execute edit");const i=s,[o,a,c]=i.setStyle([this.fromPos,this.toPos],this.attributes?Object.fromEntries(this.attributes):{},this.getExecutedAt(),r);e.acc(a);for(const l of o)e.registerGCPair(l);return{opInfos:c.map(({from:l,to:u,value:f})=>({type:"style",from:l,to:u,value:f,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),n=this.fromPos.toTestString(),r=this.toPos.toTestString(),s=this.attributes;return`${e}.STYL(${n},${r},${JSON.stringify(s)})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}}const yy=2,Ay="root",Ct="text";function vr(t,e,n=!1){let r=0;const s=n?t.allChildren:t.children;for(let i=0;i<e;i++){const o=s[i];!o||!n&&o.isRemoved||(r+=o.paddedSize(n))}return r}class vy{type;parent;_children;visibleSize;totalSize;constructor(e,n=[]){if(this.type=e,this.visibleSize=0,this.totalSize=0,this._children=n,this.isText&&this._children.length>0)throw new p(g.ErrRefused,"Text node cannot have children")}updateAncestorsSize(e,n=!1){let r=this.parent;for(;r;){if(n)r.totalSize+=e;else if(r.visibleSize+=e,r.isRemoved)break;r=r.parent}}updateDescendantsSize(e=!1){let n=0;for(const r of this._children){const s=r.updateDescendantsSize(e);!e&&r.isRemoved||(n+=s)}return e?this.totalSize+=n:this.visibleSize+=n,this.paddedSize(e)}get isText(){return this.type===Ct}paddedSize(e=!1){let n=this.visibleSize;return e&&(n=this.totalSize),this.isText||(n+=yy),n}isAncestorOf(e){return Sy(this,e)}get nextSibling(){const e=this.parent.findOffset(this),n=this.parent.children[e+1];if(n)return n}get prevSibling(){const e=this.parent.findOffset(this),n=this.parent.children[e-1];if(n)return n}splitText(e,n){const r={data:0,meta:0};if(e===0||e===this.visibleSize)return[void 0,r];const s=this.value.slice(0,e),i=this.value.slice(e);if(!i.length)return[void 0,r];const o=this.getDataSize();this.value=s;const a=this.cloneText(e+n);return a.value=i,this.parent.insertAfterInternal(a,this),we(r,this.getDataSize(),a.getDataSize()),Tn(r,o),[a,r]}get children(){return this._children.filter(e=>!e.isRemoved)}get allChildren(){return[...this._children]}hasTextChild(){return this.children.length>0&&this.children.every(e=>e.isText)}getChildrenText(){return this.isText?this.value:this.hasTextChild()?this.children.map(e=>e.value).join(""):""}append(...e){if(this.isText)throw new p(g.ErrRefused,"Text node cannot have children");this._children.push(...e);for(const n of e)n.parent=this,n.updateAncestorsSize(n.paddedSize()),n.updateAncestorsSize(n.paddedSize(!0),!0)}prepend(...e){if(this.isText)throw new p(g.ErrRefused,"Text node cannot have children");this._children.unshift(...e);for(const n of e)n.parent=this}insertBefore(e,n){if(this.isText)throw new p(g.ErrRefused,"Text node cannot have children");const r=this._children.indexOf(n);if(r===-1)throw new p(g.ErrInvalidArgument,"child not found");this.insertAtInternal(e,r),e.updateAncestorsSize(e.paddedSize()),e.updateAncestorsSize(e.paddedSize(!0),!0)}insertAfter(e,n){if(this.isText)throw new p(g.ErrRefused,"Text node cannot have children");const r=this._children.indexOf(n);if(r===-1)throw new p(g.ErrInvalidArgument,"child not found");this.insertAtInternal(e,r+1),e.updateAncestorsSize(e.paddedSize()),e.updateAncestorsSize(e.paddedSize(!0),!0)}insertAt(e,n){if(this.isText)throw new p(g.ErrRefused,"Text node cannot have children");this.insertAtInternal(e,n),e.updateAncestorsSize(e.paddedSize()),e.updateAncestorsSize(e.paddedSize(!0),!0)}removeChild(e){if(this.isText)throw new p(g.ErrRefused,"Text node cannot have children");const n=this._children.indexOf(e);if(n===-1)throw new p(g.ErrInvalidArgument,"child not found");this._children.splice(n,1),e.updateAncestorsSize(-e.paddedSize(!0),!0),e.parent=void 0}splitElement(e,n){const r={data:0,meta:0},s=this.getDataSize(),i=this.cloneElement(n);this.parent.insertAfterInternal(i,this),i.updateAncestorsSize(i.paddedSize()),i.updateAncestorsSize(i.paddedSize(!0),!0);const o=this.children.slice(0,e),a=this.children.slice(e);this._children=o,i._children=a,this.visibleSize=this._children.reduce((c,l)=>c+l.paddedSize(),0),this.totalSize=this._children.reduce((c,l)=>c+l.paddedSize(!0),0),i.visibleSize=i._children.reduce((c,l)=>c+l.paddedSize(!0),0),i.totalSize=i._children.reduce((c,l)=>c+l.paddedSize(!0),0);for(const c of i._children)c.parent=i;return we(r,this.getDataSize(),i.getDataSize()),Tn(r,s),[i,r]}insertAfterInternal(e,n){if(this.isText)throw new p(g.ErrRefused,"Text node cannot have children");const r=this._children.indexOf(n);if(r===-1)throw new p(g.ErrInvalidArgument,"child not found");this.insertAtInternal(e,r+1)}insertAtInternal(e,n){if(this.isText)throw new p(g.ErrRefused,"Text node cannot have children");this._children.splice(n,0,e),e.parent=this}findOffset(e,n=!1){if(this.isText)throw new p(g.ErrRefused,"Text node cannot have children");if(n)return this._children.indexOf(e);if(e.isRemoved){const r=this._children.indexOf(e);return this.allChildren.splice(0,r).filter(i=>!i.isRemoved).length}return this.children.indexOf(e)}findBranchOffset(e){if(this.isText)throw new p(g.ErrRefused,"Text node cannot have children");let n=e;for(;n;){const r=this._children.indexOf(n);if(r!==-1)return r;n=n.parent}return-1}}function Sy(t,e){if(t===e)return!1;for(;e.parent;){if(e.parent===t)return!0;e=e.parent}return!1}var ye=(t=>(t.Start="Start",t.End="End",t.Text="Text",t))(ye||{});function kf(t,e,n,r,s=!1){if(e>n)throw new p(g.ErrInvalidArgument,`from is greater than to: ${e} > ${n}`);const i=s?t.totalSize:t.visibleSize;if(e>i)throw new p(g.ErrInvalidArgument,`from is out of range: ${e} > ${i}`);if(n>i)throw new p(g.ErrInvalidArgument,`to is out of range: ${n} > ${i}`);if(e===n)return;let o=0;const a=s?t._children:t.children;for(const c of a){if(e-c.paddedSize(s)<o&&o<n){const l=c.isText?e-o:e-o-1,u=c.isText?n-o:n-o-1,f=s?c.totalSize:c.visibleSize,b=!c.isText&&l<0,d=!c.isText&&u>f;(c.isText||b)&&r([c,c.isText?"Text":"Start"],d),kf(c,Math.max(0,l),Math.min(u,f),r,s),d&&r([c,"End"],d)}o+=c.paddedSize(s)}}function Ff(t,e,n=0){for(const r of t.children)Ff(r,e,n+1);e(t,n)}function ai(t,e,n=0){for(const r of t._children)ai(r,e,n+1);e(t,n)}function ro(t,e,n=!0){if(e>t.visibleSize)throw new p(g.ErrInvalidArgument,`index is out of range: ${e} > ${t.visibleSize}`);if(t.isText)return{node:t,offset:e};let r=0,s=0;for(const i of t.children){if(n&&i.isText&&i.visibleSize>=e-s)return ro(i,e-s,n);if(e===s)return{node:t,offset:r};if(!n&&i.paddedSize()===e-s)return{node:t,offset:r+1};if(i.paddedSize()>e-s)return ro(i,e-s-1,n);s+=i.paddedSize(),r+=1}return{node:t,offset:r}}function Zf(t){return t.isText||t.children.length===0?t:Zf(t.children[0])}function Iy(t,e){if(t.visibleSize<e)throw new p(g.ErrInvalidArgument,"unacceptable path");for(let n=0;n<t.children.length;n++){const r=t.children[n];if(r.visibleSize<e)e-=r.visibleSize;else{t=r;break}}return{node:t,offset:e}}class Ey{root;constructor(e){this.root=e}tokensBetween(e,n,r,s=!1){kf(this.root,e,n,r,s)}traverse(e){Ff(this.root,e,0)}traverseAll(e){ai(this.root,e,0)}findTreePos(e,n=!0){return ro(this.root,e,n)}treePosToPath(e){const n=[];let r=e.node;if(r.isText){const s=r.parent.findOffset(r);if(s===-1)throw new p(g.ErrInvalidArgument,"invalid treePos");const i=vr(r.parent,s);n.push(i+e.offset),r=r.parent}else if(r.hasTextChild()){const s=vr(r,e.offset);n.push(s)}else n.push(e.offset);for(;r.parent;){const s=r.parent.findOffset(r);if(s===-1)throw new p(g.ErrInvalidArgument,"invalid treePos");n.push(s),r=r.parent}return n.reverse()}pathToIndex(e){const n=this.pathToTreePos(e);return this.indexOf(n)}pathToTreePos(e){if(!e.length)throw new p(g.ErrInvalidArgument,"unacceptable path");let n=this.root;for(let r=0;r<e.length-1;r++){const s=e[r];if(n=n.children[s],!n)throw new p(g.ErrInvalidArgument,"unacceptable path")}if(n.hasTextChild())return Iy(n,e[e.length-1]);if(n.children.length<e[e.length-1])throw new p(g.ErrInvalidArgument,"unacceptable path");return{node:n,offset:e[e.length-1]}}getRoot(){return this.root}get size(){return this.root.visibleSize}findPostorderRight(e){const{node:n,offset:r}=e;if(n.isText){if(n.visibleSize===r){const s=n.nextSibling;return s||n.parent}return n}return n.children.length===r?n:Zf(n.children[r])}indexOf(e,n=!1){let{node:r}=e;const{offset:s}=e;let i=0,o=1;if(r.isText){i+=s;const a=r.parent,c=a.findOffset(r,n);if(c===-1)throw new p(g.ErrInvalidArgument,"invalid pos");i+=vr(a,c,n),r=r.parent}else i+=vr(r,s,n);for(;r?.parent;){const a=r.parent,c=a.findOffset(r,n);if(c===-1)throw new p(g.ErrInvalidArgument,"invalid pos");i+=vr(a,c,n),o++,r=r.parent}return i+o-1}indexToPath(e){const n=this.findTreePos(e);return this.treePosToPath(n)}}class ht{parentID;leftSiblingID;constructor(e,n){this.parentID=e,this.leftSiblingID=n}static of(e,n){return new ht(e,n)}static fromTreePos(e){const{offset:n}=e;let{node:r}=e,s;return r.isText?(r.parent.children[0]===r&&n===0?s=r.parent:s=r,r=r.parent):n===0?s=r:s=r.children[n-1],ht.of(r.id,Ne.of(s.getCreatedAt(),s.getOffset()+n))}getParentID(){return this.parentID}static fromStruct(e){return ht.of(Ne.of(tt.fromStruct(e.parentID.createdAt),e.parentID.offset),Ne.of(tt.fromStruct(e.leftSiblingID.createdAt),e.leftSiblingID.offset))}toStruct(){return{parentID:{createdAt:this.getParentID().getCreatedAt().toStruct(),offset:this.getParentID().getOffset()},leftSiblingID:{createdAt:this.getLeftSiblingID().getCreatedAt().toStruct(),offset:this.getLeftSiblingID().getOffset()}}}toTreeNodePair(e){const n=this.getParentID(),r=this.getLeftSiblingID(),s=e.findFloorNode(n);let i=e.findFloorNode(r);if(!s||!i)throw new p(g.ErrRefused,`cannot find node of CRDTTreePos(${n.toTestString()}, ${r.toTestString()})`);return!r.equals(n)&&r.getOffset()>0&&r.getOffset()===i.id.getOffset()&&i.insPrevID&&(i=e.findFloorNode(i.insPrevID)),[s,i]}getLeftSiblingID(){return this.leftSiblingID}equals(e){return this.getParentID().getCreatedAt().equals(e.getParentID().getCreatedAt())&&this.getParentID().getOffset()===e.getParentID().getOffset()&&this.getLeftSiblingID().getCreatedAt().equals(e.getLeftSiblingID().getCreatedAt())&&this.getLeftSiblingID().getOffset()===e.getLeftSiblingID().getOffset()}}class Ne{createdAt;offset;constructor(e,n){this.createdAt=e,this.offset=n}static of(e,n){return new Ne(e,n)}static fromStruct(e){return Ne.of(tt.fromStruct(e.createdAt),e.offset)}static createComparator(){return(e,n)=>{const r=e.getCreatedAt().compare(n.getCreatedAt());return r!==0?r:e.getOffset()>n.getOffset()?1:e.getOffset()<n.getOffset()?-1:0}}getCreatedAt(){return this.createdAt}equals(e){return this.createdAt.compare(e.createdAt)===0&&this.offset===e.offset}getOffset(){return this.offset}setOffset(e){this.offset=e}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}toTestString(){return`${this.createdAt.toTestString()}/${this.offset}`}}class Xe extends vy{id;removedAt;attrs;insPrevID;insNextID;_value="";constructor(e,n,r,s,i){super(n),this.id=e,this.removedAt=i,s&&(this.attrs=s),typeof r=="string"?this.value=r:Array.isArray(r)&&(this._children=r)}toIDString(){return this.id.toIDString()}getRemovedAt(){return this.removedAt}static create(e,n,r,s){return new Xe(e,n,r,s)}deepcopy(){const e=new Xe(this.id,this.type);return e.removedAt=this.removedAt,e._value=this._value,e.visibleSize=this.visibleSize,e.totalSize=this.totalSize,e.attrs=this.attrs?.deepcopy(),e._children=this._children.map(n=>{const r=n.deepcopy();return r.parent=e,r}),e.insPrevID=this.insPrevID,e.insNextID=this.insNextID,e}get value(){if(!this.isText)throw new p(g.ErrInvalidType,`cannot get value of element node: ${this.type}`);return this._value}set value(e){if(!this.isText)throw new p(g.ErrInvalidType,`cannot set value of element node: ${this.type}`);this._value=e,this.visibleSize=e.length,this.totalSize=e.length}get isRemoved(){return!!this.removedAt}remove(e){return this.removedAt?(e.after(this.removedAt)&&(this.removedAt=e),!1):(this.removedAt=e,this.updateAncestorsSize(-this.paddedSize()),!0)}cloneText(e){return new Xe(Ne.of(this.id.getCreatedAt(),e),this.type,void 0,void 0,this.removedAt)}cloneElement(e){return new Xe(Ne.of(e(),0),this.type,void 0,void 0,this.removedAt)}split(e,n,r){const[s,i]=this.isText?this.splitText(n,this.id.getOffset()):this.splitElement(n,r);if(s){if(s.insPrevID=this.id,this.insNextID){const o=e.findFloorNode(this.insNextID);o.insPrevID=s.id,s.insNextID=this.insNextID}this.insNextID=s.id,e.registerNode(s)}return[s,i]}getCreatedAt(){return this.id.getCreatedAt()}getOffset(){return this.id.getOffset()}canDelete(e,n,r){return n?!!(!this.removedAt||!r&&e?.after(this.removedAt)):!1}canStyle(e,n){return this.isText?!1:this.getCreatedAt().getLamport()<=n&&(!this.removedAt||e.after(this.removedAt))}setAttrs(e,n){this.attrs||(this.attrs=new Xt);const r=[];for(const[s,i]of Object.entries(e))r.push(this.attrs.set(s,i,n));return r}purge(e){this.attrs&&this.attrs.purge(e)}getDataSize(){const e={data:0,meta:0};if(this.isText&&(e.data+=this.visibleSize*2),this.id&&(e.meta+=Nt),this.removedAt&&(e.meta+=Nt),this.attrs)for(const n of this.attrs){if(n.getRemovedAt())continue;const r=n.getDataSize();e.meta+=r.meta,e.data+=r.data}return e}getGCPairs(){const e=[];if(!this.attrs)return e;for(const n of this.attrs)n.getRemovedAt()&&e.push({parent:this,child:n});return e}}function so(t){if(t.isText){const n=t;return{type:n.type,value:n.value}}const e={type:t.type,children:t.children.map(so)};return t.attrs&&(e.attributes=Mt(t.attrs?.toObject())),e}function na(t){if(t.isText)return t.value;let e="";return t.attrs&&t.attrs.size()&&(e=" "+Array.from(t.attrs).filter(n=>!n.isRemoved()).sort((n,r)=>n.getKey().localeCompare(r.getKey())).map(n=>{const r=JSON.parse(n.getValue());return typeof r=="string"?`${n.getKey()}="${r}"`:`${n.getKey()}="${Et(n.getValue())}"`}).join(" ")),`<${t.type}${e}>${t.children.map(n=>na(n)).join("")}</${t.type}>`}function Gf(t){if(t.isText){const e=t;return{type:e.type,value:e.value,visibleSize:e.visibleSize,isRemoved:e.isRemoved}}return{type:t.type,children:t.children.map(Gf),visibleSize:t.visibleSize,isRemoved:t.isRemoved}}class ze extends ss{indexTree;nodeMapByID;constructor(e,n){super(n),this.indexTree=new Ey(e),this.nodeMapByID=new _f(Ne.createComparator()),this.indexTree.traverseAll(r=>{this.nodeMapByID.put(r.id,r)})}static create(e,n){return new ze(e,n)}findFloorNode(e){const n=this.nodeMapByID.floorEntry(e);if(!(!n||!n.key.getCreatedAt().equals(e.getCreatedAt())))return n.value}registerNode(e){this.nodeMapByID.put(e.id,e)}findNodesAndSplitText(e,n){let r={data:0,meta:0};const[s,i]=e.toTreeNodePair(this);let o=i;const a=s===o,c=o.parent&&!a?o.parent:s;if(o.isText){const[,l]=o.split(this,e.getLeftSiblingID().getOffset()-o.id.getOffset());r=l}if(n){const l=c.allChildren,u=a?0:l.indexOf(o)+1;for(let f=u;f<l.length;f++){const b=l[f];if(!b.id.getCreatedAt().after(n))break;o=b}}return[[c,o],r]}style(e,n,r,s){const i={data:0,meta:0},[[o,a],c]=this.findNodesAndSplitText(e[0],r),[[l,u],f]=this.findNodesAndSplitText(e[1],r);we(i,f,c);const b=[],d=n?Mt(n):{},A=[];return this.traverseInPosRange(o,a,l,u,([S,W])=>{const L=S.getCreatedAt().getActorID();let G=to;if(s!=null&&(G=s.get(L)?s.get(L):0n),S.canStyle(r,G)&&n){const _=S.setAttrs(n,r),D=_.reduce((j,[,ne])=>(ne&&(j[ne.getKey()]=d[ne.getKey()]),j),{}),U=S.parent,ie=S.prevSibling||S.parent;Object.keys(D).length>0&&b.push({type:"style",from:this.toIndex(U,ie),to:this.toIndex(S,S),fromPath:this.toPath(U,ie),toPath:this.toPath(S,S),actor:r.getActorID(),value:D});for(const[j]of _)j&&A.push({parent:S,child:j});for(const[j]of Object.entries(d)){const ne=S.attrs?.getNodeMapByKey().get(j);ne!==void 0&&W!==ye.End&&we(i,ne.getDataSize())}}}),[A,b,i]}removeStyle(e,n,r,s){const i={data:0,meta:0},[[o,a],c]=this.findNodesAndSplitText(e[0],r),[[l,u],f]=this.findNodesAndSplitText(e[1],r);we(i,f,c);const b=[],d=[];return this.traverseInPosRange(o,a,l,u,([A])=>{const S=A.getCreatedAt().getActorID();let W=to;if(s!=null&&(W=s.get(S)?s.get(S):0n),A.canStyle(r,W)&&n){A.attrs||(A.attrs=new Xt);for(const _ of n){const D=A.attrs.remove(_,r);for(const U of D)d.push({parent:A,child:U})}const L=A.parent,G=A.prevSibling||A.parent;b.push({actor:r.getActorID(),type:"removeStyle",from:this.toIndex(L,G),to:this.toIndex(A,A),fromPath:this.toPath(L,G),toPath:this.toPath(A,A),value:n})}}),[d,b,i]}edit(e,n,r,s,i,o){const a={data:0,meta:0},[[c,l],u]=this.findNodesAndSplitText(e[0],s),[[f,b],d]=this.findNodesAndSplitText(e[1],s);we(a,d,u);const A=this.toIndex(c,l),S=this.toPath(c,l),W=[],L=[],G=[];this.traverseInPosRange(c,l,f,b,([U,ie],j)=>{if(ie===ye.Start&&!j)for(const Lt of U.children)G.push(Lt);const ne=o===void 0;let Ot=!1;const je=o?.get(U.id.getCreatedAt().getActorID());Ot=ne||je!==void 0&&je>=U.id.getCreatedAt().getLamport();let Qt=!1;if(U.removedAt){const Lt=o?.get(U.removedAt.getActorID());Qt=ne||Lt!==void 0&&Lt>=U.removedAt.getLamport()}(U.canDelete(s,Ot,Qt)||W.includes(U.parent))&&((ie===ye.Text||ie===ye.Start)&&W.push(U),L.push([U,ie]))},!0);const _=this.makeDeletionChanges(L,s),D=[];for(const U of W)U.remove(s),U.isRemoved&&D.push({parent:this,child:U});for(const U of G)U.removedAt||c.append(U);if(r>0){let U=0,ie=c,j=l;for(;U<r;)ie.split(this,ie.findOffset(j)+1,i),j=ie,ie=ie.parent,U++;_.push({type:"content",from:A,to:A,fromPath:S,toPath:S,actor:s.getActorID()})}if(n?.length){const U=[];let ie=l;for(const j of n)ie===c?c.insertAt(j,0):c.insertAfter(j,ie),ie=j,ai(j,ne=>{c.isRemoved?(ne.remove(s),D.push({parent:this,child:ne})):we(a,ne.getDataSize()),this.nodeMapByID.put(ne.id,ne)}),j.isRemoved||U.push(j);if(U.length){const j=U.map(ne=>so(ne));_.length&&_[_.length-1].from===A?_[_.length-1].value=j:_.push({type:"content",from:A,to:A,fromPath:S,toPath:S,actor:s.getActorID(),value:j})}}return[_,D,a]}editT(e,n,r,s,i){const o=this.findPos(e[0]),a=this.findPos(e[1]);return this.edit([o,a],n,r,s,i)}move(e,n,r){throw new p(g.ErrUnimplemented,`not implemented: ${e}, ${n}, ${r}`)}pathToTreePos(e){return this.indexTree.pathToTreePos(e)}purge(e){e.parent?.removeChild(e),this.nodeMapByID.remove(e.id);const n=e.insPrevID,r=e.insNextID;if(n){const s=this.findFloorNode(n);s.insNextID=r}if(r){const s=this.findFloorNode(r);s.insPrevID=n}e.insPrevID=void 0,e.insNextID=void 0}getGCPairs(){const e=[];return this.indexTree.traverse(n=>{n.getRemovedAt()&&e.push({parent:this,child:n});for(const r of n.getGCPairs())e.push(r)}),e}findPos(e,n=!0){const r=this.indexTree.findTreePos(e,n);return ht.fromTreePos(r)}pathToPosRange(e){const n=this.pathToIndex(e);return[this.findPos(n),this.findPos(n+1)]}pathToPos(e){const n=this.indexTree.pathToIndex(e);return this.findPos(n)}getRoot(){return this.indexTree.getRoot()}getSize(){return this.indexTree.size}getNodeSize(){return this.nodeMapByID.size()}getIndexTree(){return this.indexTree}toXML(){return na(this.indexTree.getRoot())}getDataSize(){const e={data:0,meta:0};return this.indexTree.traverse(n=>{if(n.getRemovedAt())return;const r=n.getDataSize();e.data+=r.data,e.meta+=r.meta}),{data:e.data,meta:e.meta+this.getMetaUsage()}}toJSON(){return JSON.stringify(this.getRootTreeNode())}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TREE"}}toJSInfoForTest(){const e=this.indexTree.getRoot(),n=(r,s=void 0,i=void 0,o=0)=>{let a,c,l;const u=r.isText?{node:r,offset:0}:s&&i?this.toTreePos(s,i):null;u&&(a=this.indexTree.indexOf(u),c=this.indexTree.treePosToPath(u),l=ht.fromTreePos(u).toStruct());const f={type:r.type,parent:s?.id.toTestString(),size:r.visibleSize,id:r.id.toTestString(),removedAt:r.removedAt?.toTestString(),insPrev:r.insPrevID?.toTestString(),insNext:r.insNextID?.toTestString(),value:r.isText?r.value:void 0,isRemoved:r.isRemoved,children:[],depth:o,attributes:r.attrs?Mt(r.attrs?.toObject()):void 0,index:a,path:c,pos:l};for(let b=0;b<r.allChildren.length;b++){const d=b===0?r:r.allChildren[b-1];f.children.push(n(r.allChildren[b],r,d,o+1))}return f};return n(e)}getRootTreeNode(){return so(this.indexTree.getRoot())}toTestTreeNode(){return Gf(this.indexTree.getRoot())}toSortedJSON(){return this.toJSON()}deepcopy(){const e=this.getRoot(),n=new ze(e.deepcopy(),this.getCreatedAt());return n.setRemovedAt(this.getRemovedAt()),n.setMovedAt(this.getMovedAt()),n}toPath(e,n){const r=this.toTreePos(e,n);return r?this.indexTree.treePosToPath(r):[]}toIndex(e,n,r=!1){const s=this.toTreePos(e,n,r);return s?this.indexTree.indexOf(s,r):-1}indexToPath(e){return this.indexTree.indexToPath(e)}pathToIndex(e){return this.indexTree.pathToIndex(e)}indexRangeToPosRange(e){const n=this.findPos(e[0]);return e[0]===e[1]?[n,n]:[n,this.findPos(e[1])]}indexRangeToPosStructRange(e){const[n,r]=e,s=this.findPos(n);return n===r?[s.toStruct(),s.toStruct()]:[s.toStruct(),this.findPos(r).toStruct()]}posRangeToPathRange(e){const[[n,r]]=this.findNodesAndSplitText(e[0]),[[s,i]]=this.findNodesAndSplitText(e[1]);return[this.toPath(n,r),this.toPath(s,i)]}posRangeToIndexRange(e){const[[n,r]]=this.findNodesAndSplitText(e[0]),[[s,i]]=this.findNodesAndSplitText(e[1]);return[this.toIndex(n,r),this.toIndex(s,i)]}traverseInPosRange(e,n,r,s,i,o=!1){const a=this.toIndex(e,n,o),c=this.toIndex(r,s,o);this.indexTree.tokensBetween(a,c,i,o)}toTreePos(e,n,r=!1){if(!e||!n)return;if(!r&&e.isRemoved){let i;for(;e.isRemoved;)i=e,e=i.parent;const o=e.findOffset(i,r);return{node:e,offset:o}}if(e===n)return{node:e,offset:0};let s=e.findOffset(n,r);if(r||!n.isRemoved){if(n.isText)return{node:n,offset:n.paddedSize(r)};s++}return{node:e,offset:s}}makeDeletionChanges(e,n){const r=[],s=[];let i=null,o=null;for(let a=0;a<e.length;a++){const c=e[a],l=e[a+1];i||(i=c),o=c;const u=this.findRightToken(c);(!u||!l||u[0]!==l[0]||u[1]!==l[1])&&(s.push([i,o]),i=null,o=null)}for(const a of s){const[c,l]=a,[u,f]=this.findLeftToken(c),[b,d]=l,A=f===ye.Start?u:u.parent,S=d===ye.Start?b:b.parent,W=this.toIndex(A,u),L=this.toIndex(S,b);W<L&&(r.length>0&&W===r[r.length-1].to?(r[r.length-1].to=L,r[r.length-1].toPath=this.toPath(S,b)):r.push({type:"content",from:W,to:L,fromPath:this.toPath(A,u),toPath:this.toPath(S,b),actor:n.getActorID()}))}return r.reverse()}findRightToken([e,n]){if(n===ye.Start){const a=e.allChildren;return a.length>0?[a[0],a[0].isText?ye.Text:ye.Start]:[e,ye.End]}const r=e.parent,s=r.allChildren,i=s.indexOf(e);if(r&&i===s.length-1)return[r,ye.End];const o=s[i+1];return[o,o.isText?ye.Text:ye.Start]}findLeftToken([e,n]){if(n===ye.End){const a=e.allChildren;if(a.length>0){const c=a[a.length-1];return[c,c.isText?ye.Text:ye.End]}return[e,ye.Start]}const r=e.parent,s=r.allChildren,i=s.indexOf(e);if(r&&i===0)return[r,ye.Start];const o=s[i-1];return[o,o.isText?ye.Text:ye.End]}}class os extends pt{fromPos;toPos;contents;splitLevel;constructor(e,n,r,s,i,o){super(e,o),this.fromPos=n,this.toPos=r,this.contents=s,this.splitLevel=i}static create(e,n,r,s,i,o){return new os(e,n,r,s,i,o)}execute(e,n,r){const s=e.findByCreatedAt(this.getParentCreatedAt());if(!s)throw new p(g.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(s instanceof ze))throw new p(g.ErrInvalidArgument,"fail to execute, only Tree can execute edit");const i=this.getExecutedAt(),o=s,[a,c,l]=o.edit([this.fromPos,this.toPos],this.contents?.map(u=>u.deepcopy()),this.splitLevel,i,(()=>{let u=i.getDelimiter();return this.contents!==void 0&&(u+=this.contents.length),()=>tt.of(i.getLamport(),++u,i.getActorID())})(),r);e.acc(l);for(const u of c)e.registerGCPair(u);return{opInfos:a.map(({from:u,to:f,value:b,splitLevel:d,fromPath:A,toPath:S})=>({type:"tree-edit",path:e.createPath(this.getParentCreatedAt()),from:u,to:f,value:b,splitLevel:d,fromPath:A,toPath:S}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),n=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.fromPos.getLeftSiblingID().getOffset()}`,r=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.toPos.getLeftSiblingID().getOffset()}`,s=this.contents||[];return`${e}.EDIT(${n},${r},${s.map(i=>na(i)).join("")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContents(){return this.contents}getSplitLevel(){return this.splitLevel}}class Hn{vector;constructor(e){this.vector=e||new Map}set(e,n){this.vector.set(e,n)}unset(e){this.vector.delete(e)}get(e){return this.vector.get(e)}has(e){return this.vector.has(e)}maxLamport(){let e=BigInt(0);for(const[,n]of this)n>e&&(e=n);return e}max(e){const n=new Map;for(const[r,s]of e){const i=this.vector.get(r),o=i&&i>s?i:s;n.set(r,o)}for(const[r,s]of this){const i=e.get(r),o=i&&i>s?i:s;n.set(r,o)}return new Hn(n)}afterOrEqual(e){const n=this.vector.get(e.getActorID());return n===void 0?!1:n>=e.getLamport()}deepcopy(){const e=new Map;for(const[n,r]of this.vector)e.set(n,r);return new Hn(e)}filter(e){const n=new Map;for(const[r]of e){const s=this.vector.get(r);s!==void 0&&n.set(r,s)}return new Hn(n)}size(){return this.vector.size}*[Symbol.iterator](){for(const[e,n]of this.vector)yield[e,n]}}const Mf=new Hn(new Map);class ct{clientSeq;serverSeq;actor;lamport;versionVector;constructor(e,n,r,s,i){this.clientSeq=e,this.serverSeq=i,this.lamport=n,this.versionVector=s,this.actor=r}hasClocks(){return this.versionVector.size()>0&&this.lamport!=eo}static of(e,n,r,s,i){return new ct(e,n,r,s,i)}next(e=!1){if(e)return new ct(this.clientSeq+1,this.lamport,this.actor,Mf,eo);const n=this.versionVector.deepcopy();return n.set(this.actor,this.lamport+1n),new ct(this.clientSeq+1,this.lamport+1n,this.actor,n)}syncClocks(e){if(!e.hasClocks())return this;const n=e.lamport>this.lamport?e.lamport+1n:this.lamport+1n,r=this.versionVector.max(e.versionVector),s=new ct(this.clientSeq,n,this.actor,r);return s.versionVector.set(this.actor,n),s}setClocks(e,n){const r=e>this.lamport?e+1n:this.lamport+1n,s=this.versionVector.max(n);return s.set(this.actor,r),ct.of(this.clientSeq,r,this.actor,s)}createTimeTicket(e){return tt.of(this.lamport,e,this.actor)}setActor(e){return new ct(this.clientSeq,this.lamport,e,this.versionVector,this.serverSeq)}setLamport(e){return new ct(this.clientSeq,e,this.actor,this.versionVector,this.serverSeq)}setVersionVector(e){return new ct(this.clientSeq,this.lamport,this.actor,e,this.serverSeq)}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq?this.serverSeq.toString():""}getLamport(){return this.lamport}getLamportAsString(){return this.lamport.toString()}getActorID(){return this.actor}getVersionVector(){return this.versionVector}toTestString(){return`${this.lamport.toString()}:${this.actor.slice(-2)}:${this.clientSeq}`}}const wy=new ct(0,0n,ea,Mf);class hr{id;operations;presenceChange;message;constructor({id:e,operations:n,presenceChange:r,message:s}){this.id=e,this.operations=n||[],this.presenceChange=r,this.message=s}static create({id:e,operations:n,presenceChange:r,message:s}){return new hr({id:e,operations:n,presenceChange:r,message:s})}getID(){return this.id}getMessage(){return this.message}hasOperations(){return this.operations.length>0}getOperations(){return this.operations}setActor(e){for(const n of this.operations)n.setActor(e);this.id=this.id.setActor(e)}hasPresenceChange(){return this.presenceChange!==void 0}getPresenceChange(){return this.presenceChange}execute(e,n,r){const s=[],i=[],o=[];for(const a of this.operations){const c=a.execute(e,r,this.id.getVersionVector());if(!c)continue;const{opInfos:l,reverseOp:u}=c;s.push(...l),i.push(a),u&&o.unshift(u)}return this.presenceChange&&(this.presenceChange.type===xt.Put?n.set(this.id.getActorID(),at(this.presenceChange.presence)):n.delete(this.id.getActorID())),{operations:i,opInfos:s,reverseOps:o}}toTestString(){return`${this.operations.map(e=>e.toTestString()).join(",")}`}toStruct(){return{changeID:he.bytesToHex(he.changeIDToBinary(this.getID())),message:this.getMessage(),operations:this.getOperations().map(e=>he.bytesToHex(he.operationToBinary(e))),presenceChange:this.getPresenceChange()}}static fromStruct(e){const{changeID:n,operations:r,presenceChange:s,message:i}=e;return hr.create({id:he.bytesToChangeID(he.hexToBytes(n)),operations:r?.map(o=>he.bytesToOperation(he.hexToBytes(o))),presenceChange:s,message:i})}}class ci{documentKey;checkpoint;isRemoved;changes;snapshot;versionVector;constructor(e,n,r,s,i,o){this.documentKey=e,this.checkpoint=n,this.isRemoved=r,this.changes=s,this.snapshot=o,this.versionVector=i}static create(e,n,r,s,i,o){return new ci(e,n,r,s,i,o)}getDocumentKey(){return this.documentKey}getCheckpoint(){return this.checkpoint}getIsRemoved(){return this.isRemoved}getChanges(){return this.changes}hasChanges(){return this.changes.length>0}getChangeSize(){return this.changes.length}hasSnapshot(){return!!this.snapshot&&!!this.snapshot.length}getSnapshot(){return this.snapshot}getVersionVector(){return this.versionVector}}class Qn{serverSeq;clientSeq;constructor(e,n){this.serverSeq=e,this.clientSeq=n}static of(e,n){return new Qn(e,n)}increaseClientSeq(e){return e===0?this:new Qn(this.serverSeq,this.clientSeq+e)}forward(e){if(this.equals(e))return this;const n=this.serverSeq>e.serverSeq?this.serverSeq:e.serverSeq,r=Math.max(this.clientSeq,e.clientSeq);return Qn.of(n,r)}getServerSeqAsString(){return this.serverSeq.toString()}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq}equals(e){return this.clientSeq===e.clientSeq&&this.serverSeq==e.serverSeq}toTestString(){return`serverSeq=${this.serverSeq}, clientSeq=${this.clientSeq}`}}const Ny=new Qn(0n,0),ml=t=>t<0?Math.ceil(t):Math.floor(t);var Dt=(t=>(t[t.Int=0]="Int",t[t.Long=1]="Long",t))(Dt||{});class Me extends ss{valueType;value;constructor(e,n,r){switch(super(r),this.valueType=e,e){case 0:typeof n=="number"?n>Math.pow(2,31)-1||n<-Math.pow(2,31)?this.value=H.fromNumber(n).toInt():this.value=ml(n):this.value=n.toInt();break;case 1:typeof n=="number"?this.value=H.fromNumber(n):this.value=n;break;default:throw new p(g.ErrUnimplemented,`unimplemented type: ${e}`)}}static create(e,n,r){return new Me(e,n,r)}static valueFromBytes(e,n){switch(e){case 0:return n[0]|n[1]<<8|n[2]<<16|n[3]<<24;case 1:return H.fromBytesLE(Array.from(n));default:throw new p(g.ErrUnimplemented,`unimplemented type: ${e}`)}}getDataSize(){return{data:this.valueType===0?4:8,meta:this.getMetaUsage()}}toJSON(){return`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_COUNTER"}}deepcopy(){const e=Me.create(this.valueType,this.value,this.getCreatedAt());return e.setRemovedAt(this.getRemovedAt()),e.setMovedAt(this.getMovedAt()),e}getType(){return this.valueType}static getCounterType(e){switch(typeof e){case"object":return e instanceof H?1:void 0;case"number":return e>Math.pow(2,31)-1||e<-Math.pow(2,31)?1:0;default:return}}static isSupport(e){return!!Me.getCounterType(e)}static isInteger(e){return e%1===0}isNumericType(){const e=this.valueType;return e===0||e===1}getValueType(){return this.valueType}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:{const e=this.value;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}case 1:{const n=this.value.toBytesLE();return Uint8Array.from(n)}default:throw new p(g.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}increase(e){function n(r){if(!r.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof r.getValue()}`)}return n(this),n(e),this.valueType===1?this.value=this.value.add(e.getValue()):e.getType()===ce.Long?this.value=this.value+e.getValue().toInt():this.value=H.fromNumber(this.value+ml(e.getValue())).toInt(),this}}class dr extends pt{value;constructor(e,n,r){super(e,r),this.value=n}static create(e,n,r){return new dr(e,n,r)}execute(e){const n=e.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new p(g.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof Me))throw new p(g.ErrInvalidArgument,"fail to execute, only Counter can execute increase");const r=n,s=this.value.deepcopy();return r.increase(s),{opInfos:[{type:"increase",path:e.createPath(this.getParentCreatedAt()),value:s.getValue()}],reverseOp:this.toReverseOperation()}}toReverseOperation(){const e=this.value.deepcopy(),r=e.getType()===ce.Long?e.getValue().multiply(-1):e.getValue()*-1;return dr.create(this.getParentCreatedAt(),be.of(r,e.getCreatedAt()))}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.INCREASE.${this.value.toJSON()}`}getValue(){return this.value}}class Yt extends pt{fromPos;toPos;attributes;attributesToRemove;constructor(e,n,r,s,i,o){super(e,o),this.fromPos=n,this.toPos=r,this.attributes=s,this.attributesToRemove=i}static create(e,n,r,s,i){return new Yt(e,n,r,s,[],i)}static createTreeRemoveStyleOperation(e,n,r,s,i){return new Yt(e,n,r,new Map,s,i)}execute(e,n,r){const s=e.findByCreatedAt(this.getParentCreatedAt());if(!s)throw new p(g.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(s instanceof ze))throw new p(g.ErrInvalidArgument,"fail to execute, only Tree can execute edit");const i=s;let o,a,c={data:0,meta:0};if(this.attributes.size){const l={};[...this.attributes].forEach(([u,f])=>l[u]=f),[a,o,c]=i.style([this.fromPos,this.toPos],l,this.getExecutedAt(),r)}else{const l=this.attributesToRemove;[a,o,c]=i.removeStyle([this.fromPos,this.toPos],l,this.getExecutedAt(),r)}e.acc(c);for(const l of a)e.registerGCPair(l);return{opInfos:o.map(({from:l,to:u,value:f,fromPath:b,toPath:d})=>({type:"tree-style",from:l,to:u,value:this.attributes.size?{attributes:f}:{attributesToRemove:f},fromPath:b,toPath:d,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),n=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.fromPos.getLeftSiblingID().getOffset()}`,r=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.toPos.getLeftSiblingID().getOffset()}`;return`${e}.STYLE(${n},${r},${Object.entries(this.attributes||{}).map(([s,i])=>`${s}:"${i}"`).join(" ")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getAttributesToRemove(){return this.attributesToRemove}}class zt extends pt{createdAt;value;constructor(e,n,r,s){super(e,s),this.createdAt=n,this.value=r}static create(e,n,r,s){return new zt(e,n,r,s)}execute(e){const n=e.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new p(g.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof Te))throw new p(g.ErrInvalidArgument,"fail to execute, only array can execute set");const r=n.getByID(this.createdAt).deepcopy(),s=this.toReverseOperation(this.value,r),i=this.value.deepcopy();return n.insertAfter(this.createdAt,i,this.getExecutedAt()),n.delete(this.createdAt,this.getExecutedAt()),e.registerElement(i),{opInfos:[{type:"array-set",path:e.createPath(this.getParentCreatedAt())}],reverseOp:s}}toReverseOperation(e,n){return zt.create(this.getParentCreatedAt(),e.getCreatedAt(),n)}getEffectedCreatedAt(){return this.createdAt}toTestString(){return`${this.getParentCreatedAt().toTestString()}.ARRAY_SET.${this.createdAt.toTestString()}=${this.value.toSortedJSON()}`}getCreatedAt(){return this.createdAt}getValue(){return this.value}setCreatedAt(e){this.createdAt=e}}function Ry(t){const e={};for(const[n,r]of Object.entries(t))e[n]=JSON.stringify(r);return B(sy,{data:e})}function Cy(t){if(t.type===xt.Put)return B(cl,{type:Xr.PUT,presence:Ry(t.presence)});if(t.type===xt.Clear)return B(cl,{type:Xr.CLEAR});throw new p(g.ErrUnimplemented,"unimplemented type")}function Ty(t){return B(iy,{serverSeq:t.getServerSeq(),clientSeq:t.getClientSeq()})}function io(t){return B(Ho,{clientSeq:t.getClientSeq(),lamport:t.getLamport(),actorId:ui(t.getActorID()),versionVector:ra(t.getVersionVector())})}function P(t){if(t)return B(ay,{lamport:t.getLamport(),delimiter:t.getDelimiter(),actorId:ui(t.getActorID())})}function ra(t){if(!t)return;const e=B(Qo);for(const[n,r]of t){const s=fA(ui(n));e.vector[s]=BigInt(r.toString())}return e}function Yf(t){switch(t){case ce.Null:return $.NULL;case ce.Boolean:return $.BOOLEAN;case ce.Integer:return $.INTEGER;case ce.Long:return $.LONG;case ce.Double:return $.DOUBLE;case ce.String:return $.STRING;case ce.Bytes:return $.BYTES;case ce.Date:return $.DATE;default:throw new p(g.ErrInvalidType,`unsupported type: ${t}`)}}function Kf(t){switch(t){case Dt.Int:return $.INTEGER_CNT;case Dt.Long:return $.LONG_CNT;default:throw new p(g.ErrInvalidType,`unsupported type: ${t}`)}}function ms(t){if(t instanceof Ce)return B(Un,{type:$.JSON_OBJECT,createdAt:P(t.getCreatedAt()),value:rh(t)});if(t instanceof Te)return B(Un,{type:$.JSON_ARRAY,createdAt:P(t.getCreatedAt()),value:aA(t)});if(t instanceof Ye)return B(Un,{type:$.TEXT,createdAt:P(t.getCreatedAt())});if(t instanceof be)return B(Un,{type:Yf(t.getType()),createdAt:P(t.getCreatedAt()),value:t.toBytes()});if(t instanceof Me)return B(Un,{type:Kf(t.getType()),createdAt:P(t.getCreatedAt()),value:t.toBytes()});if(t instanceof ze)return B(Un,{type:$.TREE,createdAt:P(t.getCreatedAt()),value:lA(t)});throw new p(g.ErrUnimplemented,"unimplemented element")}function xy(t){return B(qb,{createdAt:P(t.getCreatedAt()),offset:t.getOffset()})}function bs(t){return B(oy,{createdAt:P(t.getID().getCreatedAt()),offset:t.getID().getOffset(),relativeOffset:t.getRelativeOffset()})}function ys(t){return B(ry,{parentId:Br(t.getParentID()),leftSiblingId:Br(t.getLeftSiblingID())})}function Br(t){return B(ny,{createdAt:P(t.getCreatedAt()),offset:t.getOffset()})}function oo(t){const e=B(qo);if(t instanceof Bn){const n=t,r=B(Bb);r.parentCreatedAt=P(n.getParentCreatedAt()),r.key=n.getKey(),r.value=ms(n.getValue()),r.executedAt=P(n.getExecutedAt()),e.body.case="set",e.body.value=r}else if(t instanceof bn){const n=t,r=B(Wb);r.parentCreatedAt=P(n.getParentCreatedAt()),r.prevCreatedAt=P(n.getPrevCreatedAt()),r.value=ms(n.getValue()),r.executedAt=P(n.getExecutedAt()),e.body.case="add",e.body.value=r}else if(t instanceof ft){const n=t,r=B(Pb);r.parentCreatedAt=P(n.getParentCreatedAt()),r.prevCreatedAt=P(n.getPrevCreatedAt()),r.createdAt=P(n.getCreatedAt()),r.executedAt=P(n.getExecutedAt()),e.body.case="move",e.body.value=r}else if(t instanceof Vt){const n=t,r=B(_b);r.parentCreatedAt=P(n.getParentCreatedAt()),r.createdAt=P(n.getCreatedAt()),r.executedAt=P(n.getExecutedAt()),e.body.case="remove",e.body.value=r}else if(t instanceof gn){const n=t,r=B(Ub);r.parentCreatedAt=P(n.getParentCreatedAt()),r.from=bs(n.getFromPos()),r.to=bs(n.getToPos()),r.content=n.getContent();const s=r.attributes;for(const[i,o]of n.getAttributes())s[i]=o;r.executedAt=P(n.getExecutedAt()),e.body.case="edit",e.body.value=r}else if(t instanceof is){const n=t,r=B(kb);r.parentCreatedAt=P(n.getParentCreatedAt()),r.from=bs(n.getFromPos()),r.to=bs(n.getToPos());const s=r.attributes;for(const[i,o]of n.getAttributes())s[i]=o;r.executedAt=P(n.getExecutedAt()),e.body.case="style",e.body.value=r}else if(t instanceof dr){const n=t,r=B(Fb);r.parentCreatedAt=P(n.getParentCreatedAt()),r.value=ms(n.getValue()),r.executedAt=P(n.getExecutedAt()),e.body.case="increase",e.body.value=r}else if(t instanceof os){const n=t,r=B(Zb);r.parentCreatedAt=P(n.getParentCreatedAt()),r.from=ys(n.getFromPos()),r.to=ys(n.getToPos()),r.contents=Py(n.getContents()),r.splitLevel=n.getSplitLevel(),r.executedAt=P(n.getExecutedAt()),e.body.case="treeEdit",e.body.value=r}else if(t instanceof Yt){const n=t,r=B(Gb);r.parentCreatedAt=P(n.getParentCreatedAt()),r.from=ys(n.getFromPos()),r.to=ys(n.getToPos());const s=n.getAttributesToRemove();if(s.length>0)r.attributesToRemove=s;else{const i=r.attributes;for(const[o,a]of n.getAttributes())i[o]=a}r.executedAt=P(n.getExecutedAt()),e.body.case="treeStyle",e.body.value=r}else if(t instanceof zt){const n=t,r=B(Mb);r.parentCreatedAt=P(n.getParentCreatedAt()),r.createdAt=P(n.getCreatedAt()),r.value=ms(n.getValue()),r.executedAt=P(n.getExecutedAt()),e.body.case="arraySet",e.body.value=r}else throw new p(g.ErrUnimplemented,"unimplemented operation");return e}function Vy(t){const e=[];for(const n of t)e.push(oo(n));return e}function Dy(t){const e=B(Lb,{id:io(t.getID()),message:t.getMessage()});return t.hasOperations()&&(e.operations=Vy(t.getOperations())),t.hasPresenceChange()&&(e.presenceChange=Cy(t.getPresenceChange())),e}function Oy(t){const e=[];for(const n of t)e.push(Dy(n));return e}function Ly(t){const e=[];for(const n of t)e.push(B(jb,{key:n.getStrKey(),element:ia(n.getValue())}));return e}function By(t){const e=[];for(const n of t)e.push(B(Hb,{element:ia(n.getValue())}));return e}function Wy(t){const e=[];for(const n of t){const r=B(Qb);r.id=xy(n.getID()),r.value=n.getValue().getContent(),r.removedAt=P(n.getRemovedAt());const s=r.attributes,i=n.getValue().getAttrs();for(const o of i){const a=B(xf);a.value=o.getValue(),a.updatedAt=P(o.getUpdatedAt()),s[o.getKey()]=a}e.push(r)}return e}function Py(t){const e=[];if(!t||!t.length)return e;for(const n of t)e.push(B(ty,{content:sa(n)}));return e}function _y(t){const e={};for(const n of t)e[n.getKey()]=B(xf,{value:n.getValue(),updatedAt:P(n.getUpdatedAt()),isRemoved:n.isRemoved()});return e}function sa(t){if(!t)return[];const e=[];return ai(t,(n,r)=>{const s=B(ey,{id:Br(n.id),type:n.type,removedAt:P(n.removedAt),depth:r});n.isText&&(s.value=n.value),n.insPrevID&&(s.insPrevId=Br(n.insPrevID)),n.insNextID&&(s.insNextId=Br(n.insNextID)),n.attrs&&(s.attributes=_y(n.attrs)),e.push(s)}),e}function Uy(t){return B(st,{body:{case:"jsonObject",value:B(Yb,{nodes:Ly(t.getRHT()),createdAt:P(t.getCreatedAt()),movedAt:P(t.getMovedAt()),removedAt:P(t.getRemovedAt())})}})}function Jf(t){return B(st,{body:{case:"jsonArray",value:B(Kb,{nodes:By(t.getElements()),createdAt:P(t.getCreatedAt()),movedAt:P(t.getMovedAt()),removedAt:P(t.getRemovedAt())})}})}function ky(t){return B(st,{body:{case:"primitive",value:B(Jb,{type:Yf(t.getType()),value:t.toBytes(),createdAt:P(t.getCreatedAt()),movedAt:P(t.getMovedAt()),removedAt:P(t.getRemovedAt())})}})}function Fy(t){return B(st,{body:{case:"text",value:B($b,{nodes:Wy(t.getRGATreeSplit()),createdAt:P(t.getCreatedAt()),movedAt:P(t.getMovedAt()),removedAt:P(t.getRemovedAt())})}})}function Zy(t){return B(st,{body:{case:"counter",value:B(Xb,{type:Kf(t.getType()),value:t.toBytes(),createdAt:P(t.getCreatedAt()),movedAt:P(t.getMovedAt()),removedAt:P(t.getRemovedAt())})}})}function $f(t){return B(st,{body:{case:"tree",value:B(zb,{nodes:sa(t.getRoot()),createdAt:P(t.getCreatedAt()),movedAt:P(t.getMovedAt()),removedAt:P(t.getRemovedAt())})}})}function ia(t){if(t instanceof Ce)return Uy(t);if(t instanceof Te)return Jf(t);if(t instanceof be)return ky(t);if(t instanceof Ye)return Fy(t);if(t instanceof Me)return Zy(t);if(t instanceof ze)return $f(t);throw new p(g.ErrUnimplemented,"unimplemented element")}function Gy(t){return B(Ob,{documentKey:t.getDocumentKey(),checkpoint:Ty(t.getCheckpoint()),isRemoved:t.getIsRemoved(),changes:Oy(t.getChanges()),snapshot:t.getSnapshot(),versionVector:ra(t.getVersionVector())})}function My(t){return{id:t.id,label:t.label,description:t.description,snapshot:t.snapshot,createdAt:t.createdAt?em(t.createdAt):new Date}}function Er(t){if(!(t instanceof se))return{};const e=t.findDetails(fy);for(const n of e)return n.metadata;return{}}function Mn(t){return Er(t).code??""}function Li(t,e){return t instanceof se&&Mn(t)===e}function Xf(t){return ct.of(t.clientSeq,BigInt(t.lamport),ua(t.actorId),oa(t.versionVector),BigInt(t.serverSeq))}function oa(t){if(!t)return;const e=new Hn;return Object.entries(t.vector).forEach(([n,r])=>{const s=li(uA(n));e.set(s,BigInt(r.toString()))}),e}function k(t){if(t)return tt.of(BigInt(t.lamport),t.delimiter,ua(t.actorId))}function aa(t){const e={};return Object.entries(t.data).forEach(([n,r])=>{e[n]=JSON.parse(r)}),e}function Yy(t){const e=t.type;if(e===Xr.PUT){const n=aa(t.presence);return{type:xt.Put,presence:n}}if(e===Xr.CLEAR)return{type:xt.Clear};throw new p(g.ErrInvalidType,`unsupported type: ${e}`)}function Ky(t){const e=new Map;return Object.entries(t).forEach(([n,r])=>{e.set(n,aa(r))}),e}function zf(t){switch(t){case $.NULL:return ce.Null;case $.BOOLEAN:return ce.Boolean;case $.INTEGER:return ce.Integer;case $.LONG:return ce.Long;case $.DOUBLE:return ce.Double;case $.STRING:return ce.String;case $.BYTES:return ce.Bytes;case $.DATE:return ce.Date}throw new p(g.ErrUnimplemented,`unimplemented value type: ${t}`)}function Ys(t){switch(t){case $.INTEGER_CNT:return Dt.Int;case $.LONG_CNT:return Dt.Long}throw new p(g.ErrUnimplemented,`unimplemented value type: ${t}`)}function As(t){switch(t.type){case $.JSON_OBJECT:return t.value?nh(t.value):Ce.create(k(t.createdAt));case $.JSON_ARRAY:return t.value?oA(t.value):Te.create(k(t.createdAt));case $.TEXT:return Ye.create(ur.create(),k(t.createdAt));case $.TREE:return cA(t.value);case $.NULL:case $.BOOLEAN:case $.INTEGER:case $.LONG:case $.DOUBLE:case $.STRING:case $.BYTES:case $.DATE:return be.of(be.valueFromBytes(zf(t.type),t.value),k(t.createdAt));case $.INTEGER_CNT:case $.LONG_CNT:return Me.create(Ys(t.type),Me.valueFromBytes(Ys(t.type),t.value),k(t.createdAt))}}function vs(t){return Ee.of(Rt.of(k(t.createdAt),t.offset),t.relativeOffset)}function jf(t){return Rt.of(k(t.createdAt),t.offset)}function Jy(t){const e=Hr.create(t.value);Object.entries(t.attributes).forEach(([r,s])=>{e.setAttr(r,s.value,k(s.updatedAt))});const n=ln.create(jf(t.id),e);return n.setRemovedAt(k(t.removedAt)),n}function kn(t){return ht.of(Wr(t.parentId),Wr(t.leftSiblingId))}function Wr(t){return Ne.of(k(t.createdAt),t.offset)}function $y(t){if(!t.length)return;const e=[];return t.forEach(n=>{const r=ca(n.content);e.push(r)}),e}function ca(t){if(t.length===0)return;const e=[];for(const s of t)e.push(zy(s));const n=e[e.length-1],r=new Map;r.set(t[e.length-1].depth,e[e.length-1]);for(let s=e.length-2;s>=0;s--)r.get(t[s].depth-1).prepend(e[s]),r.set(t[s].depth,e[s]);return n.updateDescendantsSize(),n.updateDescendantsSize(!0),ze.create(n,ar).getRoot()}function Xy(t){const e=Xt.create();for(const[n,r]of Object.entries(t))e.setInternal(n,r.value,k(r.updatedAt),r.isRemoved);return e}function zy(t){const e=Wr(t.id),n=Xe.create(e,t.type),r=Object.entries(t.attributes);return n.isText?n.value=t.value:r.length&&(n.attrs=Xy(t.attributes)),t.insPrevId&&(n.insPrevID=Wr(t.insPrevId)),t.insNextId&&(n.insNextID=Wr(t.insNextId)),n.removedAt=k(t.removedAt),n}function Hf(t){if(t.body.case==="set"){const e=t.body.value;return Bn.create(e.key,As(e.value),k(e.parentCreatedAt),k(e.executedAt))}else if(t.body.case==="add"){const e=t.body.value;return bn.create(k(e.parentCreatedAt),k(e.prevCreatedAt),As(e.value),k(e.executedAt))}else if(t.body.case==="move"){const e=t.body.value;return ft.create(k(e.parentCreatedAt),k(e.prevCreatedAt),k(e.createdAt),k(e.executedAt))}else if(t.body.case==="remove"){const e=t.body.value;return Vt.create(k(e.parentCreatedAt),k(e.createdAt),k(e.executedAt))}else if(t.body.case==="edit"){const e=t.body.value,n=new Map;return Object.entries(e.attributes).forEach(([r,s])=>{n.set(r,s)}),gn.create(k(e.parentCreatedAt),vs(e.from),vs(e.to),e.content,n,k(e.executedAt))}else if(t.body.case==="style"){const e=t.body.value,n=new Map;return Object.entries(e.attributes).forEach(([r,s])=>{n.set(r,s)}),is.create(k(e.parentCreatedAt),vs(e.from),vs(e.to),n,k(e.executedAt))}else if(t.body.case==="increase"){const e=t.body.value;return dr.create(k(e.parentCreatedAt),As(e.value),k(e.executedAt))}else if(t.body.case==="treeEdit"){const e=t.body.value;return os.create(k(e.parentCreatedAt),kn(e.from),kn(e.to),$y(e.contents),e.splitLevel,k(e.executedAt))}else if(t.body.case==="treeStyle"){const e=t.body.value,n=new Map,r=e.attributesToRemove;return r?.length>0?Yt.createTreeRemoveStyleOperation(k(e.parentCreatedAt),kn(e.from),kn(e.to),r,k(e.executedAt)):(Object.entries(e.attributes).forEach(([s,i])=>{n.set(s,i)}),Yt.create(k(e.parentCreatedAt),kn(e.from),kn(e.to),n,k(e.executedAt)))}else if(t.body.case==="arraySet"){const e=t.body.value;return zt.create(k(e.parentCreatedAt),k(e.createdAt),As(e.value),k(e.executedAt))}else throw new p(g.ErrUnimplemented,"unimplemented operation")}function jy(t){const e=[];for(const n of t){const r=Hf(n);r&&e.push(r)}return e}function Qf(t){const e=[];for(const n of t)e.push(hr.create({id:Xf(n.id),operations:jy(n.operations),presenceChange:n.presenceChange?Yy(n.presenceChange):void 0,message:n.message}));return e}function Hy(t){return Qn.of(BigInt(t.serverSeq),t.clientSeq)}function Qy(t){return ci.create(t.documentKey,Hy(t.checkpoint),t.isRemoved,Qf(t.changes),oa(t.versionVector),t.snapshot)}function qf(t){const e=new cr;for(const r of t.nodes){const s=la(r.element);e.set(r.key,s,s.getPositionedAt())}const n=new Ce(k(t.createdAt),e);return n.setMovedAt(k(t.movedAt)),n.setRemovedAt(k(t.removedAt)),n}function eh(t){const e=new jr;for(const r of t.nodes)e.insert(la(r.element));const n=new Te(k(t.createdAt),e);return n.setMovedAt(k(t.movedAt)),n.setRemovedAt(k(t.removedAt)),n}function qy(t){const e=be.of(be.valueFromBytes(zf(t.type),t.value),k(t.createdAt));return e.setMovedAt(k(t.movedAt)),e.setRemovedAt(k(t.removedAt)),e}function eA(t){const e=new ur;let n=e.getHead();for(const s of t.nodes){const i=e.insertAfter(n,Jy(s));s.insPrevId&&i.setInsPrev(e.findNode(jf(s.insPrevId))),n=i}const r=new Ye(e,k(t.createdAt));return r.setMovedAt(k(t.movedAt)),r.setRemovedAt(k(t.removedAt)),r}function tA(t){const e=Me.create(Ys(t.type),Me.valueFromBytes(Ys(t.type),t.value),k(t.createdAt));return e.setMovedAt(k(t.movedAt)),e.setRemovedAt(k(t.removedAt)),e}function th(t){const e=ca(t.nodes);return ze.create(e,k(t.createdAt))}function la(t){if(t.body.case==="jsonObject")return qf(t.body.value);if(t.body.case==="jsonArray")return eh(t.body.value);if(t.body.case==="primitive")return qy(t.body.value);if(t.body.case==="text")return eA(t.body.value);if(t.body.case==="counter")return tA(t.body.value);if(t.body.case==="tree")return th(t.body.value);throw new p(g.ErrUnimplemented,"unimplemented element")}function nA(t){return t.map(e=>({path:e.path,type:e.type}))}function rA(t){if(!t)return{root:Ce.create(ar),presences:new Map};const e=rt(Db,t);return{root:la(e.root),presences:Ky(e.presences)}}function sA(t){const e=ra(t);return li(dn(Qo,e))}function iA(t){const e=fa(t),n=rt(Qo,e);return oa(n)}function nh(t){if(!t)throw new p(g.ErrInvalidArgument,"bytes is empty");const e=rt(st,t);return qf(e.body.value)}function rh(t){return dn(st,ia(t))}function oA(t){if(!t)throw new p(g.ErrInvalidArgument,"bytes is empty");const e=rt(st,t);return eh(e.body.value)}function aA(t){return dn(st,Jf(t))}function cA(t){if(!t)throw new p(g.ErrInvalidArgument,"bytes is empty");const e=rt(st,t);return th(e.body.value)}function lA(t){return dn(st,$f(t))}function li(t){return t?Array.from(t).map(e=>e.toString(16).padStart(2,"0")).join(""):""}function ua(t){return li(t)}function fa(t){return new Uint8Array(t.match(/.{1,2}/g).map(e=>parseInt(e,16)))}function uA(t){if(typeof window<"u"&&typeof window.atob=="function"){const e=window.atob(t),n=e.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=e.charCodeAt(s);return r}else if(typeof globalThis<"u"&&typeof globalThis.Buffer<"u"){const e=globalThis.Buffer;return new Uint8Array(e.from(t,"base64"))}else throw new Error("No base64 decoder available")}function ui(t){return fa(t)}function fA(t){if(typeof window<"u"&&typeof window.btoa=="function"){let e="";for(let n=0;n<t.byteLength;n++)e+=String.fromCharCode(t[n]);return window.btoa(e)}else{if(typeof globalThis<"u"&&typeof globalThis.Buffer<"u")return globalThis.Buffer.from(t).toString("base64");throw new Error("No base64 encoder available")}}function hA(t){const e=rt(Ho,t);return Xf(e)}function dA(t){const e=rt(qo,t);return Hf(e)}const he={fromPresence:aa,toChangePack:Gy,fromChangePack:Qy,fromChanges:Qf,toTreeNodes:sa,fromTreeNodes:ca,objectToBytes:rh,bytesToObject:nh,bytesToSnapshot:rA,bytesToHex:li,hexToBytes:fa,toHexString:ua,toUint8Array:ui,toOperation:oo,toChangeID:io,bytesToChangeID:hA,bytesToOperation:dA,versionVectorToHex:sA,hexToVersionVector:iA,fromSchemaRules:nA,toRevisionSummary:My,changeIDToBinary:t=>dn(Ho,io(t)),operationToBinary:t=>dn(qo,oo(t))};var Fe=(t=>(t[t.Trivial=0]="Trivial",t[t.Debug=1]="Debug",t[t.Info=2]="Info",t[t.Warn=3]="Warn",t[t.Error=4]="Error",t[t.Fatal=5]="Fatal",t))(Fe||{});let Nn=3;function gA(t){Nn=t}const x={trivial:(...t)=>{Nn>0||typeof console<"u"&&console.log("YORKIE T:",...t)},debug:(...t)=>{Nn>1||typeof console<"u"&&console.log("YORKIE D:",...t)},info:(...t)=>{Nn>2||typeof console<"u"&&console.log("YORKIE I:",...t)},warn:(...t)=>{Nn>3||typeof console<"u"&&(typeof console.warn<"u"?console.warn("YORKIE W:",...t):console.log("YORKIE W:",...t))},error:(...t)=>{Nn>4||typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE E:",...t):console.log("YORKIE E:",...t))},fatal:(...t)=>{typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE F:",...t):console.log("YORKIE F:",...t))},isEnabled:t=>Nn<=t};function sh(){return"xxxxxxxx-xxxx-4xxxy-xxxx-xxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}const Bi=()=>{};class pA{finalized=!1;observers=[];finalError;constructor(e){try{e(this)}catch(n){this.error(n)}}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(!e)throw new p(g.ErrInvalidArgument,"missing observer");if(this.finalized)throw new p(g.ErrRefused,"observable is finalized due to previous error");typeof e=="object"?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Bi),s.error===void 0&&(s.error=Bi),s.complete===void 0&&(s.complete=Bi);const i=sh(),o=this.unsubscribeOne.bind(this,i);if(this.observers.push({subscriptionID:i,observer:s}),this.finalized)try{this.finalError?s.error(this.finalError):s.complete()}catch(a){x.warn(a)}return o}unsubscribeOne(e){this.observers=this.observers?.filter(n=>n.subscriptionID!==e)}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e].observer)}catch(r){x.error(r)}}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.observers=void 0)}}function ih(t){const e=new pA(t);return{subscribe:e.subscribe.bind(e),getProxy:()=>e}}class Pr{prevID;nextID;delimiter;message;root;operations;presenceChange;previousPresence;reversePresenceKeys;constructor(e,n,r,s){this.prevID=e,this.nextID=e.next(),this.delimiter=Df,this.root=n,this.operations=[],this.previousPresence=at(r),this.presenceChange=void 0,this.reversePresenceKeys=new Set,this.message=s}static create(e,n,r,s){return new Pr(e,n,r,s)}push(e){this.operations.push(e)}registerElement(e,n){this.root.registerElement(e,n)}registerRemovedElement(e){this.root.registerRemovedElement(e)}registerGCPair(e){this.root.registerGCPair(e)}getNextID(){return this.isPresenceOnlyChange()?this.prevID.next(!0).setLamport(this.prevID.getLamport()).setVersionVector(this.prevID.getVersionVector()):this.nextID}toChange(){const e=this.isPresenceOnlyChange()?this.prevID.next(!0):this.nextID;return hr.create({id:e,operations:this.operations,presenceChange:this.presenceChange,message:this.message})}isPresenceOnlyChange(){return this.operations.length===0}hasChange(){return this.operations.length>0||this.presenceChange!==void 0}setPresenceChange(e){this.presenceChange=e}setReversePresence(e,n){for(const r of Object.keys(e))n?.addToHistory?this.reversePresenceKeys.add(r):this.reversePresenceKeys.delete(r)}getReversePresence(){if(this.reversePresenceKeys.size===0)return;const e={};for(const n of this.reversePresenceKeys)e[n]=this.previousPresence[n];return e}issueTimeTicket(){return this.delimiter+=1,this.nextID.createTimeTicket(this.delimiter)}getLastTimeTicket(){return this.nextID.createTimeTicket(this.delimiter)}acc(e){this.root.acc(e)}}function oh(t,e){const n=new Qr(t);return new Proxy(e,n.getHandlers())}class Qr{context;handlers;constructor(e){this.context=e,this.handlers={set:(n,r,s)=>(x.isEnabled(Fe.Trivial)&&x.trivial(`obj[${r}]=${JSON.stringify(s)}`),Qr.setInternal(e,n,r,s),!0),get:(n,r)=>(x.isEnabled(Fe.Trivial)&&x.trivial(`obj[${r}]`),r==="getID"?()=>n.getCreatedAt():r==="toJSON"||r==="toString"?()=>n.toJSON():r==="toJS"?()=>n.toJS():r==="toJSForTest"?()=>n.toJSForTest():Rn(e,n.get(r))),ownKeys:n=>n.getKeys(),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),deleteProperty:(n,r)=>(x.isEnabled(Fe.Trivial)&&x.trivial(`obj[${r}]`),Qr.deleteInternal(e,n,r),!0)}}static setInternal(e,n,r,s){if(r.includes("."))throw new p(g.ErrInvalidObjectKey,"key must not contain the '.'.");const i=e.issueTimeTicket(),o=_r(e,s,i),a=n.set(r,o,i);e.registerElement(o,n),a&&e.registerRemovedElement(a),e.push(Bn.create(r,o.deepcopy(),n.getCreatedAt(),i))}static buildObjectMembers(e,n){const r={};for(const[s,i]of Object.entries(n)){if(s.includes("."))throw new p(g.ErrInvalidObjectKey,"key must not contain the '.'.");const o=e.issueTimeTicket(),a=_r(e,i,o);r[s]=a}return r}static deleteInternal(e,n,r){const s=e.issueTimeTicket(),i=n.deleteByKey(r,s);i&&(e.push(Vt.create(n.getCreatedAt(),i.getCreatedAt(),s)),e.registerRemovedElement(i))}getHandlers(){return this.handlers}}function mA(t,e){const n=new ee(t,e);return new Proxy(e,n.getHandlers())}function bl(t){return typeof t=="string"||t instanceof String?!isNaN(t):!1}function bA(t){return["concat","entries","every","filter","find","findIndex","forEach","join","keys","map","reduce","reduceRight","slice","some","toLocaleString","toString","values"].includes(t)}class ee{context;handlers;array;constructor(e,n){this.context=e,this.array=n,this.handlers={get:(r,s,i)=>s==="getID"?()=>r.getCreatedAt():s==="getElementByID"?o=>{const a=r.getByID(o);if(!(!a||a.isRemoved()))return ot(e,a)}:s==="getElementByIndex"?o=>{const a=r.get(o);return ot(e,a)}:s==="getLast"?()=>ot(e,r.getLast()):s==="delete"?o=>{const a=ee.deleteInternalByIndex(e,r,o);return ot(e,a)}:s==="deleteByID"?o=>{const a=ee.deleteInternalByID(e,r,o);return ot(e,a)}:s==="insertAfter"?(o,a)=>{const c=ee.insertAfterInternal(e,r,o,a);return ot(e,c)}:s==="insertIntegerAfter"?(o,a)=>{const c=ee.insertIntegerAfterInternal(e,r,o,a);return ot(e,c)}:s==="insertBefore"?(o,a)=>{const c=ee.insertBeforeInternal(e,r,o,a);return ot(e,c)}:s==="setValue"?(o,a)=>{const c=ee.setValueInternal(e,r,o,a);return ot(e,c)}:s==="moveBefore"?(o,a)=>{ee.moveBeforeInternal(e,r,o,a)}:s==="moveAfter"?(o,a)=>{ee.moveAfterInternal(e,r,o,a)}:s==="moveAfterByIndex"?(o,a)=>{ee.moveAfterByIndexInternal(e,r,o,a)}:s==="moveFront"?o=>{ee.moveFrontInternal(e,r,o)}:s==="moveLast"?o=>{ee.moveLastInternal(e,r,o)}:bl(s)?Rn(e,r.get(Number(s))):s==="push"?o=>ee.pushInternal(e,r,o):s==="splice"?(o,a,...c)=>ee.splice(e,r,o,a,...c):s==="length"?r.length:typeof s=="symbol"&&s===Symbol.iterator?ee.iteratorInternal.bind(this,e,r):s==="includes"?(o,a)=>ee.includes(e,r,o,a):s==="indexOf"?(o,a)=>ee.indexOf(e,r,o,a):s==="lastIndexOf"?(o,a)=>ee.lastIndexOf(e,r,o,a):s==="toJSForTest"?()=>r.toJSForTest():s==="toTestString"?()=>ee.toTestString(r):typeof s=="string"&&bA(s)?(...o)=>{const a=Array.from(r).map(c=>Rn(e,c));return Array.prototype[s].apply(a,o)}:Reflect.get(r,s,i),set:(r,s,i)=>{if(bl(s)){const o=Number(s);return ee.setValueInternal(e,r,o,i),!0}return Reflect.set(r,s,i)},deleteProperty:(r,s)=>(x.isEnabled(Fe.Trivial)&&x.trivial(`array[${s}]`),ee.deleteInternalByIndex(e,r,Number.parseInt(s)),!0)}}static*iteratorInternal(e,n){for(const r of n)yield ot(e,r)}static buildArrayElements(e,n){const r=[];for(const s of n){const i=e.issueTimeTicket(),o=_r(e,s,i);r.push(o)}return r}static pushInternal(e,n,r){return ee.insertAfterInternal(e,n,n.getLastCreatedAt(),r),n.length}static moveBeforeInternal(e,n,r,s){const i=e.issueTimeTicket(),o=n.getPrevCreatedAt(r);n.moveAfter(o,s,i),e.push(ft.create(n.getCreatedAt(),o,s,i))}static moveAfterInternal(e,n,r,s){const i=e.issueTimeTicket();e.push(ft.create(n.getCreatedAt(),r,s,i)),n.moveAfter(r,s,i)}static moveAfterByIndexInternal(e,n,r,s){const i=n.get(r);if(!i)throw new p(g.ErrInvalidArgument,`index out of bounds: ${r}`);const o=n.get(s);if(!o)throw new p(g.ErrInvalidArgument,`index out of bounds: ${s}`);ee.moveAfterInternal(e,n,i.getCreatedAt(),o.getCreatedAt())}static moveFrontInternal(e,n,r){const s=e.issueTimeTicket(),i=n.getHead();n.moveAfter(i.getCreatedAt(),r,s),e.push(ft.create(n.getCreatedAt(),i.getCreatedAt(),r,s))}static moveLastInternal(e,n,r){const s=e.issueTimeTicket(),i=n.getLastCreatedAt();n.moveAfter(i,r,s),e.push(ft.create(n.getCreatedAt(),i,r,s))}static insertAfterInternal(e,n,r,s){const i=e.issueTimeTicket(),o=_r(e,s,i);return n.insertAfter(r,o),e.registerElement(o,n),e.push(bn.create(n.getCreatedAt(),r,o.deepcopy(),i)),o}static insertIntegerAfterInternal(e,n,r,s){const i=n.get(r);if(!i)throw new p(g.ErrInvalidArgument,`index out of bounds: ${r}`);return ee.insertAfterInternal(e,n,i.getCreatedAt(),s),n}static insertBeforeInternal(e,n,r,s){return ee.insertAfterInternal(e,n,n.getPrevCreatedAt(r),s)}static setValueInternal(e,n,r,s){const i=n.get(r);if(!i)throw new p(g.ErrInvalidArgument,`index out of bounds: ${r}`);return ee.setByIndexInternal(e,n,i.getCreatedAt(),s),n}static setByIndexInternal(e,n,r,s){const i=e.issueTimeTicket(),o=_r(e,s,i),a=o.deepcopy();return e.push(zt.create(n.getCreatedAt(),r,a,i)),n.set(r,o,i),e.registerElement(o,n),o}static deleteInternalByIndex(e,n,r){const s=e.issueTimeTicket(),i=n.deleteByIndex(r,s);if(i)return e.push(Vt.create(n.getCreatedAt(),i.getCreatedAt(),s)),e.registerRemovedElement(i),i}static deleteInternalByID(e,n,r){const s=e.issueTimeTicket(),i=n.delete(r,s);return e.push(Vt.create(n.getCreatedAt(),i.getCreatedAt(),s)),e.registerRemovedElement(i),i}static splice(e,n,r,s,...i){const o=n.length,a=r>=0?Math.min(r,o):Math.max(o+r,0),c=s===void 0?o:s<0?a:Math.min(a+s,o),l=[];for(let u=a;u<c;u++){const f=ee.deleteInternalByIndex(e,n,a);if(f){const b=f.deepcopy();b.setRemovedAt(),l.push(Rn(e,b))}}if(i){let u=a===0?n.getHead().getID():n.get(a-1).getID();for(const f of i)u=ee.insertAfterInternal(e,n,u,f).getID()}return l}static includes(e,n,r,s){const i=n.length,o=s===void 0?0:s<0?Math.max(s+i,0):s;if(o>=i)return!1;if(be.isSupport(r))return Array.from(n).map(c=>Rn(e,c)).includes(r,o);for(let a=o;a<i;a++)if(n.get(a)?.getID()===r.getID())return!0;return!1}static indexOf(e,n,r,s){const i=n.length,o=s===void 0?0:s<0?Math.max(s+i,0):s;if(o>=i)return-1;if(be.isSupport(r))return Array.from(n).map(c=>Rn(e,c)).indexOf(r,o);for(let a=o;a<i;a++)if(n.get(a)?.getID()===r.getID())return a;return-1}static lastIndexOf(e,n,r,s){const i=n.length,o=s===void 0||s>=i?i-1:s<0?s+i:s;if(o<0)return-1;if(be.isSupport(r))return Array.from(n).map(c=>Rn(e,c)).lastIndexOf(r,o);for(let a=o;a>0;a--)if(n.get(a)?.getID()===r.getID())return a;return-1}static toTestString(e){return e.toTestString()}getHandlers(){return this.handlers}}class ha{context;text;constructor(e,n){this.context=e,this.text=n}initialize(e,n){this.context=e,this.text=n}getID(){return this.text.getID()}edit(e,n,r,s){if(!this.context||!this.text)throw new p(g.ErrNotInitialized,"Text is not initialized yet");if(e>n)throw new p(g.ErrInvalidArgument,"from should be less than or equal to to");const i=this.text.indexRangeToPosRange(e,n);x.isEnabled(Fe.Debug)&&x.debug(`EDIT: f:${e}->${i[0].toTestString()}, t:${n}->${i[1].toTestString()} c:${r}`);const o=s?fr(s):void 0,a=this.context.issueTimeTicket(),[,c,l,u]=this.text.edit(i,r,a,o);this.context.acc(l);for(const f of c)this.context.registerGCPair(f);return this.context.push(new gn(this.text.getCreatedAt(),i[0],i[1],r,o?new Map(Object.entries(o)):new Map,a)),this.text.findIndexesFromRange(u)}delete(e,n){return this.edit(e,n,"")}empty(){return this.edit(0,this.length,"")}setStyle(e,n,r){if(!this.context||!this.text)throw new p(g.ErrNotInitialized,"Text is not initialized yet");if(e>n)throw new p(g.ErrInvalidArgument,"from should be less than or equal to to");const s=this.text.indexRangeToPosRange(e,n);x.isEnabled(Fe.Debug)&&x.debug(`STYL: f:${e}->${s[0].toTestString()}, t:${n}->${s[1].toTestString()} a:${JSON.stringify(r)}`);const i=fr(r),o=this.context.issueTimeTicket(),[a,c]=this.text.setStyle(s,i,o);this.context.acc(c);for(const l of a)this.context.registerGCPair(l);return this.context.push(new is(this.text.getCreatedAt(),s[0],s[1],new Map(Object.entries(i)),o)),!0}indexRangeToPosRange(e){if(!this.context||!this.text)throw new p(g.ErrNotInitialized,"Text is not initialized yet");const n=this.text.indexRangeToPosRange(e[0],e[1]);return[n[0].toStruct(),n[1].toStruct()]}posRangeToIndexRange(e){if(!this.context||!this.text)throw new p(g.ErrNotInitialized,"Text is not initialized yet");const n=this.text.findIndexesFromRange([Ee.fromStruct(e[0]),Ee.fromStruct(e[1])]);return[n[0],n[1]]}toTestString(){if(!this.context||!this.text)throw new p(g.ErrNotInitialized,"Text is not initialized yet");return this.text.toTestString()}values(){if(!this.context||!this.text)throw new p(g.ErrNotInitialized,"Text is not initialized yet");return this.text.values()}get length(){return this.text.length}getTreeByIndex(){return this.text.getTreeByIndex()}getTreeByID(){return this.text.getTreeByID()}toString(){if(!this.context||!this.text)throw new p(g.ErrNotInitialized,"Text is not initialized yet");return this.text.toString()}toJSON(){if(!this.context||!this.text)throw new p(g.ErrNotInitialized,"Text is not initialized yet");return this.text.toJSON()}toJSForTest(){if(!this.context||!this.text)throw new p(g.ErrNotInitialized,"Text is not initialized yet");return this.text.toJSForTest()}createRangeForTest(e,n){if(!this.context||!this.text)throw new p(g.ErrNotInitialized,"Text is not initialized yet");return this.text.indexRangeToPosRange(e,n)}}class da{valueType;value;context;counter;constructor(e,n){this.valueType=e,this.value=n}initialize(e,n){this.valueType=n.getValueType(),this.context=e,this.counter=n,this.value=n.getValue()}getID(){return this.counter.getID()}getValue(){return this.value}getValueType(){return this.valueType}increase(e){if(!this.context||!this.counter)throw new p(g.ErrNotInitialized,"Counter is not initialized yet");const n=this.context.issueTimeTicket(),r=be.of(e,n);if(!r.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof r.getValue()}`);return this.counter.increase(r),this.context.push(dr.create(this.counter.getCreatedAt(),r,n)),this}toJSForTest(){if(!this.context||!this.counter)throw new p(g.ErrNotInitialized,"Counter is not initialized yet");return this.counter.toJSForTest()}}function ga(t){if(t.isText)return{type:t.type,value:t.value};const e={type:t.type,children:t.children.map(n=>ga(n))};return t.attrs&&(e.attributes=Mt(t.attrs.toObject())),e}function yA(t,e){const n={type:t.isText?t.parent.type:t.type,children:t.isText?t.parent.getChildrenText().length===e?[]:[{type:Ct,value:t.parent.getChildrenText().slice(e)}]:t.children.slice(e).map(r=>ga(r))};return t.attrs?n.attributes=Mt(t.attrs.toObject()):t.isText&&t.parent.attrs&&(n.attributes=Mt(t.parent.attrs.toObject())),n}function AA(t,e){const{node:n}=t,r=[...e].slice(0,-1),s=n.isText?n.parent.getChildrenText().length:n.children.length,i=[...r,s],o=[...r],a=[];o[o.length-1]+=1,e.every((l,u)=>l===i[u])||a.push({fromPath:[...e],toPath:i});const c=yA(n,e[e.length-1]);return c&&a.push({fromPath:o,toPath:o,content:c}),a}function vA(t,e){const{node:n,offset:r}=t,s=n.children[r],i=n.children[r-1],{children:o}=s,a=[...e].slice(0,-1),c=[{fromPath:[...e],toPath:[...a,r+1]}];if(!s.children.length)return c;const l=[...a,r-1,i.hasTextChild()?i.getChildrenText().length:i.children.length],u=o.map(f=>ga(f));return c.push({fromPath:l,toPath:l,content:u}),c}function pa(t,e,n){const{type:r}=t,s=n.issueTimeTicket();if(r===Ct){ah(t);const{value:i}=t,o=Xe.create(Ne.of(s,0),r,i);e.append(o)}else{const{children:i=[]}=t,{attributes:o}=t;let a;if(typeof o=="object"&&!Uf(o)){const l=fr(o);a=new Xt;for(const[u,f]of Object.entries(l))a.set(u,f,s)}const c=Xe.create(Ne.of(s,0),r,void 0,a);e.append(c);for(const l of i)pa(l,c,n)}}function SA(t,e){const{type:n}=e,r=t.issueTimeTicket();let s;if(e.type===Ct){const{value:i}=e;s=Xe.create(Ne.of(r,0),n,i)}else if(e){const{children:i=[]}=e,{attributes:o}=e;let a;if(typeof o=="object"&&!Uf(o)){const c=fr(o);a=new Xt;for(const[l,u]of Object.entries(c))a.set(l,u,r)}s=Xe.create(Ne.of(t.issueTimeTicket(),0),n,void 0,a);for(const c of i)pa(c,s,t)}return s}function ah(t){if(!t.value.length)throw new p(g.ErrInvalidArgument,"text node cannot have empty value");return!0}function yl(t){if(!t.length)return!0;if(t[0].type===Ct)for(const n of t){const{type:r}=n;if(r!==Ct)throw new p(g.ErrInvalidArgument,"element node and text node cannot be passed together");ah(n)}else for(const n of t){const{type:r}=n;if(r===Ct)throw new p(g.ErrInvalidArgument,"element node and text node cannot be passed together")}return!0}class ma{initialRoot;context;tree;constructor(e){this.initialRoot=e}initialize(e,n){this.context=e,this.tree=n}getID(){return this.tree.getID()}buildRoot(e){if(!this.initialRoot)return Xe.create(Ne.of(e.issueTimeTicket(),0),Ay);const n=Xe.create(Ne.of(e.issueTimeTicket(),0),this.initialRoot.type);for(const r of this.initialRoot.children)pa(r,n,e);return n}getSize(){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getSize()}getNodeSize(){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getNodeSize()}getIndexTree(){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getIndexTree()}splitByPath(e){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");if(!e.length)throw new p(g.ErrInvalidArgument,"path should not be empty");const n=this.tree.pathToTreePos(e),r=AA(n,e);for(const s of r){const{fromPath:i,toPath:o,content:a}=s,c=this.tree.pathToPos(i),l=this.tree.pathToPos(o);this.editInternal(c,l,a?[a]:[],0)}}mergeByPath(e){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");if(!e.length)throw new p(g.ErrInvalidArgument,"path should not be empty");const n=this.tree.pathToTreePos(e);if(n.node.isText)throw new p(g.ErrInvalidArgument,"text node cannot be merged");const r=vA(n,e);for(const s of r){const{fromPath:i,toPath:o,content:a}=s,c=this.tree.pathToPos(i),l=this.tree.pathToPos(o);this.editInternal(c,l,a??[],0)}}styleByPath(e,n){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");if(!e.length)throw new p(g.ErrInvalidArgument,"path should not be empty");const[r,s]=this.tree.pathToPosRange(e),i=this.context.issueTimeTicket(),o=n?fr(n):void 0,[a,,c]=this.tree.style([r,s],o,i);this.context.acc(c);for(const l of a)this.context.registerGCPair(l);this.context.push(Yt.create(this.tree.getCreatedAt(),r,s,o?new Map(Object.entries(o)):new Map,i))}style(e,n,r){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");if(e>n)throw new p(g.ErrInvalidArgument,"from should be less than or equal to to");const s=this.tree.findPos(e),i=this.tree.findPos(n),o=this.context.issueTimeTicket(),a=r?fr(r):void 0,[c,,l]=this.tree.style([s,i],a,o);this.context.acc(l);for(const u of c)this.context.registerGCPair(u);this.context.push(Yt.create(this.tree.getCreatedAt(),s,i,a?new Map(Object.entries(a)):new Map,o))}removeStyle(e,n,r){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");if(e>n)throw new p(g.ErrInvalidArgument,"from should be less than or equal to to");const s=this.tree.findPos(e),i=this.tree.findPos(n),o=this.context.issueTimeTicket(),[a,,c]=this.tree.removeStyle([s,i],r,o);this.context.acc(c);for(const l of a)this.context.registerGCPair(l);this.context.push(Yt.createTreeRemoveStyleOperation(this.tree.getCreatedAt(),s,i,r,o))}editInternal(e,n,r,s=0){if(r.length!==0&&r[0]&&(yl(r),r[0].type!==Ct))for(const l of r){const{children:u=[]}=l;yl(u)}const i=this.context.getLastTimeTicket();let o=new Array;if(r[0]?.type===Ct){let l="";for(const u of r){const{value:f}=u;l+=f}o.push(Xe.create(Ne.of(this.context.issueTimeTicket(),0),Ct,l))}else o=r.map(l=>l&&SA(this.context,l)).filter(l=>l);const[,a,c]=this.tree.edit([e,n],o.length?o.map(l=>l?.deepcopy()):void 0,s,i,()=>this.context.issueTimeTicket());this.context.acc(c);for(const l of a)this.context.registerGCPair(l);return this.context.push(os.create(this.tree.getCreatedAt(),e,n,o.length?o:void 0,s,i)),!0}editByPath(e,n,r,s=0){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");if(e.length!==n.length)throw new p(g.ErrInvalidArgument,"path length should be equal");if(!e.length||!n.length)throw new p(g.ErrInvalidArgument,"path should not be empty");const i=this.tree.pathToPos(e),o=this.tree.pathToPos(n);return this.editInternal(i,o,r?[r]:[],s)}editBulkByPath(e,n,r,s=0){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");if(e.length!==n.length)throw new p(g.ErrInvalidArgument,"path length should be equal");if(!e.length||!n.length)throw new p(g.ErrInvalidArgument,"path should not be empty");const i=this.tree.pathToPos(e),o=this.tree.pathToPos(n);return this.editInternal(i,o,r,s)}edit(e,n,r,s=0){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");if(e>n)throw new p(g.ErrInvalidArgument,"from should be less than or equal to to");const i=this.tree.findPos(e),o=this.tree.findPos(n);return this.editInternal(i,o,r?[r]:[],s)}editBulk(e,n,r,s=0){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");if(e>n)throw new p(g.ErrInvalidArgument,"from should be less than or equal to to");const i=this.tree.findPos(e),o=this.tree.findPos(n);return this.editInternal(i,o,r,s)}toXML(){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toXML()}toJSON(){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSON()}toJSForTest(){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSForTest()}toJSInfoForTest(){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSInfoForTest()}getRootTreeNode(){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getRootTreeNode()}indexToPath(e){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");return this.tree.indexToPath(e)}pathToIndex(e){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");return this.tree.pathToIndex(e)}pathRangeToPosRange(e){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");const n=[this.tree.pathToIndex(e[0]),this.tree.pathToIndex(e[1])],r=this.tree.indexRangeToPosRange(n);return[r[0].toStruct(),r[1].toStruct()]}indexRangeToPosRange(e){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");return this.tree.indexRangeToPosStructRange(e)}posRangeToIndexRange(e){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");const n=[ht.fromStruct(e[0]),ht.fromStruct(e[1])];return this.tree.posRangeToIndexRange(n)}posRangeToPathRange(e){if(!this.context||!this.tree)throw new p(g.ErrNotInitialized,"Tree is not initialized yet");const n=[ht.fromStruct(e[0]),ht.fromStruct(e[1])];return this.tree.posRangeToPathRange(n)}}function Al(t,e){return oh(t,e)}function ot(t,e){if(e){if(e instanceof be)return e;if(e instanceof Ce)return oh(t,e);if(e instanceof Te)return mA(t,e);if(e instanceof Ye)return new ha(t,e);if(e instanceof Me){const n=new da(Dt.Int,0);return n.initialize(t,e),n}else if(e instanceof ze){const n=new ma;return n.initialize(t,e),n}}else return;throw new TypeError(`Unsupported type of element: ${typeof e}`)}function Rn(t,e){const n=ot(t,e);return n instanceof be?n.getValue():n}function _r(t,e,n){let r;if(be.isSupport(e))r=be.of(e,n);else if(Array.isArray(e))r=Te.create(n,ee.buildArrayElements(t,e));else if(typeof e=="object")e instanceof ha?(r=Ye.create(ur.create(),n),e.initialize(t,r)):e instanceof da?(r=Me.create(e.getValueType(),e.getValue(),n),e.initialize(t,r)):e instanceof ma?(r=ze.create(e.buildRoot(t),n),e.initialize(t,r)):r=Ce.create(n,Qr.buildObjectMembers(t,e));else throw new TypeError(`Unsupported type of value: ${typeof e}`);return r}class qr{rootObject;elementPairMapByCreatedAt;gcElementSetByCreatedAt;gcPairMap;docSize;constructor(e){this.rootObject=e,this.elementPairMapByCreatedAt=new Map,this.gcElementSetByCreatedAt=new Set,this.gcPairMap=new Map,this.docSize={live:{data:0,meta:0},gc:{data:0,meta:0}},this.registerElement(e,void 0),e.getDescendants(n=>{if(n.getRemovedAt()&&this.registerRemovedElement(n),n instanceof Ye||n instanceof ze)for(const r of n.getGCPairs())this.registerGCPair(r);return!1})}static create(){return new qr(Ce.create(ar))}findByCreatedAt(e){const n=this.elementPairMapByCreatedAt.get(e.toIDString());if(n)return n.element}findElementPairByCreatedAt(e){return this.elementPairMapByCreatedAt.get(e.toIDString())}createSubPaths(e){let n=this.elementPairMapByCreatedAt.get(e.toIDString());if(!n)return[];const r=[];for(;n.parent;){const s=n.element.getCreatedAt(),i=n.parent.subPathOf(s);if(i===void 0)throw new p(g.ErrInvalidArgument,`cant find the given element: ${s.toIDString()}`);r.unshift(i),n=this.elementPairMapByCreatedAt.get(n.parent.getCreatedAt().toIDString())}return r.unshift("$"),r}createPath(e){return this.createSubPaths(e).join(".")}registerElement(e,n){this.elementPairMapByCreatedAt.set(e.getCreatedAt().toIDString(),{parent:n,element:e}),we(this.docSize.live,e.getDataSize()),e instanceof cn&&e.getDescendants((r,s)=>(this.elementPairMapByCreatedAt.set(r.getCreatedAt().toIDString(),{parent:s,element:r}),we(this.docSize.live,r.getDataSize()),!1))}deregisterElement(e){let n=0;const r=s=>{const i=s.getCreatedAt().toIDString();Tn(this.docSize.gc,s.getDataSize()),this.elementPairMapByCreatedAt.delete(i),this.gcElementSetByCreatedAt.delete(i),n++};return r(e),e instanceof cn&&e.getDescendants(s=>(r(s),!1)),n}registerRemovedElement(e){we(this.docSize.gc,e.getDataSize()),Tn(this.docSize.live,e.getDataSize()),this.docSize.live.meta+=Nt,this.gcElementSetByCreatedAt.add(e.getCreatedAt().toIDString())}registerGCPair(e){if(this.gcPairMap.get(e.child.toIDString())){this.gcPairMap.delete(e.child.toIDString());return}this.gcPairMap.set(e.child.toIDString(),e);const r=this.gcPairMap.get(e.child.toIDString()).child.getDataSize();we(this.docSize.gc,r),Tn(this.docSize.live,r),e.child instanceof an||(this.docSize.live.meta+=Nt)}getElementMapSize(){return this.elementPairMapByCreatedAt.size}getGarbageElementSetSize(){const e=new Set;for(const n of this.gcElementSetByCreatedAt){e.add(n);const r=this.elementPairMapByCreatedAt.get(n);r.element instanceof cn&&r.element.getDescendants(s=>(e.add(s.getCreatedAt().toIDString()),!1))}return e.size}getObject(){return this.rootObject}getGarbageLen(){return this.getGarbageElementSetSize()+this.gcPairMap.size}getDocSize(){return this.docSize}deepcopy(){return new qr(this.rootObject.deepcopy())}garbageCollect(e){let n=0;for(const r of this.gcElementSetByCreatedAt){const s=this.elementPairMapByCreatedAt.get(r),i=s.element.getRemovedAt();i&&e?.afterOrEqual(i)&&(s.parent.purge(s.element),n+=this.deregisterElement(s.element))}for(const[,r]of this.gcPairMap){const s=r.child.getRemovedAt();s&&e?.afterOrEqual(s)&&(r.parent.purge(r.child),Tn(this.docSize.gc,r.child.getDataSize()),this.gcPairMap.delete(r.child.toIDString()),n+=1)}return n}toJSON(){return this.rootObject.toJSON()}toSortedJSON(){return this.rootObject.toSortedJSON()}getStats(){return{elements:this.getElementMapSize(),gcPairs:this.gcPairMap.size,gcElements:this.getGarbageElementSetSize()}}acc(e){we(this.docSize.live,e)}*getGCElementPairs(){for(const e of this.gcElementSetByCreatedAt){const n=this.elementPairMapByCreatedAt.get(e);n&&(yield n)}}}let vl=class{context;presence;constructor(e,n){this.context=e,this.presence=n}set(e,n){for(const r of Object.keys(e))this.presence[r]=e[r];this.context.setPresenceChange({type:xt.Put,presence:at(this.presence)}),this.context.setReversePresence(e,n)}get(e){return this.presence[e]}clear(){this.presence={},this.context.setPresenceChange({type:xt.Clear})}};const Sl=50;class IA{undoStack=[];redoStack=[];hasUndo(){return this.undoStack.length>0}hasRedo(){return this.redoStack.length>0}pushUndo(e){this.undoStack.length>=Sl&&this.undoStack.shift(),this.undoStack.push(e)}popUndo(){return this.undoStack.pop()}pushRedo(e){this.redoStack.length>=Sl&&this.redoStack.shift(),this.redoStack.push(e)}popRedo(){return this.redoStack.pop()}clearRedo(){this.redoStack=[]}clearUndo(){this.undoStack=[]}getUndoStackForTest(){return this.undoStack}getRedoStackForTest(){return this.redoStack}reconcileCreatedAt(e,n){const r=s=>{for(const i of s)for(const o of i)(o instanceof zt||o instanceof Vt||o instanceof ft)&&o.getCreatedAt()===e&&o.setCreatedAt(n),(o instanceof bn||o instanceof ft)&&o.getPrevCreatedAt()===e&&o.setPrevCreatedAt(n)};r(this.undoStack),r(this.redoStack)}reconcileTextEdit(e,n,r,s){const i=o=>{for(const a of o)for(const c of a)c instanceof gn&&c.getParentCreatedAt().compare(e)===0&&c.reconcileOperation(n,r,s)};i(this.undoStack),i(this.redoStack)}}function EA(t,e){const n=[];for(const r of e){const s=wA(t,r.path),i=NA(s,r);if(!i.valid)for(const o of i.errors||[])n.push(o)}return{valid:n.length===0,errors:n}}function wA(t,e){if(!e.startsWith("$"))throw new Error(`Path must start with $, got ${e}`);const n=e.split(".");let r=t;for(let s=1;s<n.length;s++){const i=n[s];if(!(r instanceof Ce))return;r=r.get(i)}return r}function NA(t,e){switch(e.type){case"string":case"boolean":case"integer":case"double":case"long":case"date":case"bytes":case"null":return CA(t,e);case"object":if(!(t instanceof Ce))return{valid:!1,errors:[{path:e.path,message:`expected object at path ${e.path}`}]};break;case"array":if(!(t instanceof Te))return{valid:!1,errors:[{path:e.path,message:`expected array at path ${e.path}`}]};break;case"yorkie.Text":if(!(t instanceof Ye))return{valid:!1,errors:[{path:e.path,message:`expected yorkie.Text at path ${e.path}`}]};break;case"yorkie.Tree":if(!(t instanceof ze))return{valid:!1,errors:[{path:e.path,message:`expected yorkie.Tree at path ${e.path}`}]};break;case"yorkie.Counter":if(!(t instanceof Me))return{valid:!1,errors:[{path:e.path,message:`expected yorkie.Counter at path ${e.path}`}]};break;default:throw new Error(`Unknown rule type: ${e.type}`)}return{valid:!0}}function RA(t){switch(t){case"null":return ce.Null;case"boolean":return ce.Boolean;case"integer":return ce.Integer;case"long":return ce.Long;case"double":return ce.Double;case"string":return ce.String;case"bytes":return ce.Bytes;case"date":return ce.Date;default:throw new Error(`Unknown primitive type: ${t}`)}}function CA(t,e){return t instanceof be&&t.getType()===RA(e.type)?{valid:!0}:{valid:!1,errors:[{path:e.path,message:`expected ${e.type} at path ${e.path}`}]}}const TA="yorkie-devtools-panel",xA="yorkie-devtools-sdk";function VA(t){return[Se.StatusChanged,Se.Snapshot,Se.LocalChange,Se.RemoteChange,Se.Initialized,Se.Watched,Se.Unwatched,Se.PresenceChanged].includes(t.type)}function DA(t){return t.every(VA)}let Yn="disconnected";const Il=new Map,Ts=new Map;typeof window<"u"&&(window.docEventsForReplayByDocKey=Ts);function Ss(t,e){(e?.force||Yn!=="disconnected")&&window.postMessage({source:xA,...t},"*")}function OA(t){if(!t.isEnableDevtools()||typeof window>"u"||Il.has(t.getKey()))return;Ts.set(t.getKey(),[]);const e=t.subscribe("all",n=>{DA(n)&&(Ts.get(t.getKey()).push(n),Yn==="synced"&&Ss({msg:"doc::sync::partial",docKey:t.getKey(),event:n}))});Il.set(t.getKey(),[e]),Ss({msg:"refresh-devtools"},{force:!0}),window.addEventListener("message",n=>{if(n.data?.source!==TA)return;switch(n.data.msg){case"devtools::connect":if(Yn!=="disconnected")break;Yn="connected",Ss({msg:"doc::available",docKey:t.getKey()}),x.info(`[YD] Devtools connected. Doc: ${t.getKey()}`);break;case"devtools::disconnect":Yn="disconnected",x.info(`[YD] Devtools disconnected. Doc: ${t.getKey()}`);break;case"devtools::subscribe":Yn="synced",Ss({msg:"doc::sync::full",docKey:t.getKey(),events:Ts.get(t.getKey())}),x.info(`[YD] Devtools subscribed. Doc: ${t.getKey()}`);break}})}var en=(t=>(t.Detached="detached",t.Attached="attached",t.Removed="removed",t))(en||{}),Se=(t=>(t.StatusChanged="status-changed",t.ConnectionChanged="connection-changed",t.SyncStatusChanged="sync-status-changed",t.Snapshot="snapshot",t.LocalChange="local-change",t.RemoteChange="remote-change",t.Initialized="initialized",t.Watched="watched",t.Unwatched="unwatched",t.PresenceChanged="presence-changed",t.AuthError="auth-error",t))(Se||{}),xs=(t=>(t.Connected="connected",t.Disconnected="disconnected",t))(xs||{}),ao=(t=>(t.Synced="synced",t.SyncFailed="sync-failed",t))(ao||{});class on{key;status;opts;maxSizeLimit;schemaRules;changeID;checkpoint;localChanges;root;presences;clone;internalHistory;isUpdating;onlineClients;eventStream;eventStreamObserver;history;constructor(e,n){this.key=e,this.status="detached",this.opts=n||{},this.maxSizeLimit=0,this.schemaRules=[],this.changeID=wy,this.checkpoint=Ny,this.localChanges=[],this.root=qr.create(),this.presences=new Map,this.onlineClients=new Set,this.internalHistory=new IA,this.isUpdating=!1,this.eventStream=ih(r=>this.eventStreamObserver=r),this.history={canUndo:()=>this.internalHistory.hasUndo()&&!this.isUpdating,canRedo:()=>this.internalHistory.hasRedo()&&!this.isUpdating,undo:()=>this.executeUndoRedo(!0),redo:()=>this.executeUndoRedo(!1)},OA(this)}update(e,n){if(this.getStatus()==="removed")throw new p(g.ErrDocumentRemoved,`${this.key} is removed`);this.ensureClone();const r=this.changeID.getActorID(),s=Pr.create(this.changeID,this.clone.root,this.clone.presences.get(r)||{},n);try{const a=Al(s,this.clone.root.getObject());this.presences.has(r)||this.clone.presences.set(r,{}),this.isUpdating=!0,e(a,new vl(s,this.clone.presences.get(r)))}catch(a){throw this.clone=void 0,a}finally{this.isUpdating=!1}const i=this.getSchemaRules();if(!s.isPresenceOnlyChange()&&i.length){const a=EA(this.clone?.root.getObject(),i);if(!a.valid)throw this.clone=void 0,new p(g.ErrDocumentSchemaValidationFailed,`schema validation failed: ${a.errors?.map(c=>c.message).join(", ")}`)}const o=my(this.clone?.root.getDocSize());if(!s.isPresenceOnlyChange()&&this.maxSizeLimit>0&&this.maxSizeLimit<o)throw this.clone=void 0,new p(g.ErrDocumentSizeExceedsLimit,`document size exceeded: ${o} > ${this.maxSizeLimit}`);if(s.hasChange()){x.isEnabled(Fe.Trivial)&&x.trivial(`trying to update a local change: ${this.toJSON()}`);const a=s.toChange(),{opInfos:c,reverseOps:l}=a.execute(this.root,this.presences,de.Local);for(const b of a.getOperations())b instanceof zt&&this.internalHistory.reconcileCreatedAt(b.getCreatedAt(),b.getValue().getCreatedAt());const u=s.getReversePresence();u&&l.push({type:"presence",value:u}),this.localChanges.push(a),l.length&&this.internalHistory.pushUndo(l),c.length&&this.internalHistory.clearRedo(),this.changeID=s.getNextID();const f=[];c.length&&f.push({type:"local-change",source:de.Local,value:{message:a.getMessage()||"",operations:c,actor:r,clientSeq:a.getID().getClientSeq(),serverSeq:a.getID().getServerSeq()},rawChange:this.isEnableDevtools()?a.toStruct():void 0}),a.hasPresenceChange()&&f.push({type:"presence-changed",source:de.Local,value:{clientID:r,presence:this.getPresence(r)}}),this.publish(f),x.isEnabled(Fe.Trivial)&&x.trivial(`after update a local change: ${this.toJSON()}`)}}subscribe(e,n,r,s){if(typeof e=="string"){if(typeof n!="function")throw new p(g.ErrInvalidArgument,"Second argument must be a callback function");if(e==="presence"){const a=n;return this.eventStream.subscribe(c=>{for(const l of c)l.type!=="initialized"&&l.type!=="watched"&&l.type!=="unwatched"&&l.type!=="presence-changed"||a(l)},r,s)}if(e==="my-presence"){const a=n;return this.eventStream.subscribe(c=>{for(const l of c)l.type!=="initialized"&&l.type!=="presence-changed"||l.type==="presence-changed"&&l.value.clientID!==this.changeID.getActorID()||a(l)},r,s)}if(e==="others"){const a=n;return this.eventStream.subscribe(c=>{for(const l of c)l.type!=="watched"&&l.type!=="unwatched"&&l.type!=="presence-changed"||l.value.clientID!==this.changeID.getActorID()&&a(l)},r,s)}if(e==="connection"){const a=n;return this.eventStream.subscribe(c=>{for(const l of c)l.type==="connection-changed"&&a(l)},r,s)}if(e==="status"){const a=n;return this.eventStream.subscribe(c=>{for(const l of c)l.type==="status-changed"&&a(l)},r,s)}if(e==="sync"){const a=n;return this.eventStream.subscribe(c=>{for(const l of c)l.type==="sync-status-changed"&&a(l)},r,s)}if(e==="auth-error"){const a=n;return this.eventStream.subscribe(c=>{for(const l of c)l.type==="auth-error"&&a(l)},r)}if(e==="all"){const a=n;return this.eventStream.subscribe(a,r,s)}const i=e,o=n;return this.eventStream.subscribe(a=>{for(const c of a){if(c.type!=="local-change"&&c.type!=="remote-change")continue;const l=[];for(const u of c.value.operations)this.isSameElementOrChildOf(u.path,i)&&l.push(u);l.length&&o({...c,value:{...c.value,operations:l}})}},r,s)}if(typeof e=="function"){const i=e,o=n,a=r;return this.eventStream.subscribe(c=>{for(const l of c)l.type!=="snapshot"&&l.type!=="local-change"&&l.type!=="remote-change"||i(l)},o,a)}throw new p(g.ErrInvalidArgument,`"${e}" is not a valid`)}publish(e){this.eventStreamObserver&&this.eventStreamObserver.next(e)}applyChangePack(e){e.hasSnapshot()?this.applySnapshot(e.getCheckpoint().getServerSeq(),e.getVersionVector(),e.getSnapshot(),e.getCheckpoint().getClientSeq()):(this.applyChanges(e.getChanges(),de.Remote),this.removePushedLocalChanges(e.getCheckpoint().getClientSeq())),this.checkpoint=this.checkpoint.forward(e.getCheckpoint()),e.hasSnapshot()||this.garbageCollect(e.getVersionVector()),e.getIsRemoved()&&this.applyStatus("removed"),x.isEnabled(Fe.Trivial)&&x.trivial(`${this.root.toJSON()}`)}getCheckpoint(){return this.checkpoint}getChangeID(){return this.changeID}hasLocalChanges(){return this.localChanges.length>0}ensureClone(){this.clone||(this.clone={root:this.root.deepcopy(),presences:at(this.presences)})}createChangePack(){const e=Array.from(this.localChanges),n=this.checkpoint.increaseClientSeq(e.length);return ci.create(this.key,n,!1,e,this.getVersionVector())}setActor(e){for(const n of this.localChanges)n.setActor(e);this.changeID=this.changeID.setActor(e)}isEnableDevtools(){return!!this.opts.enableDevtools}getKey(){return this.key}getStatus(){return this.status}getClone(){return this.clone}getCloneRoot(){if(this.clone)return this.clone.root.getObject()}getRoot(){this.ensureClone();const e=Pr.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});return Al(e,this.clone.root.getObject())}getDocSize(){return this.root.getDocSize()}getMaxSizePerDocument(){return this.maxSizeLimit}setMaxSizePerDocument(e){this.maxSizeLimit=e}getSchemaRules(){return this.schemaRules}setSchemaRules(e){this.schemaRules=e}garbageCollect(e){return this.opts.disableGC?0:(this.clone&&this.clone.root.garbageCollect(e),this.root.garbageCollect(e))}getRootObject(){return this.root.getObject()}getGarbageLen(){return this.root.getGarbageLen()}getRootCRDT(){return this.root}getGarbageLenFromClone(){return this.clone.root.getGarbageLen()}toJSON(){return this.root.toJSON()}toSortedJSON(){return this.root.toSortedJSON()}getStats(){return this.root.getStats()}toJSForTest(){return{...this.getRoot().toJSForTest(),key:"root"}}applySnapshot(e,n,r,s=-1){const{root:i,presences:o}=he.bytesToSnapshot(r);this.root=new qr(i),this.presences=o,this.changeID=this.changeID.setClocks(n.maxLamport(),n),this.clone=void 0,this.removePushedLocalChanges(s),this.applyChanges(this.localChanges,de.Local),this.clearHistory(),this.publish([{type:"snapshot",source:de.Remote,value:{serverSeq:e.toString(),snapshot:this.isEnableDevtools()?he.bytesToHex(r):void 0,snapshotVector:he.versionVectorToHex(n)}}])}clearHistory(){this.internalHistory.clearRedo(),this.internalHistory.clearUndo()}applyChanges(e,n){x.isEnabled(Fe.Debug)&&x.debug(`trying to apply ${e.length} remote changes.elements:${this.root.getElementMapSize()}, removeds:${this.root.getGarbageElementSetSize()}`),x.isEnabled(Fe.Trivial)&&x.trivial(e.map(r=>`${r.getID().toTestString()}	${r.toTestString()}`).join(`
`));for(const r of e)this.applyChange(r,n);x.isEnabled(Fe.Debug)&&x.debug(`after appling ${e.length} remote changes.elements:${this.root.getElementMapSize()},  removeds:${this.root.getGarbageElementSetSize()}`)}applyChange(e,n){this.ensureClone(),e.execute(this.clone.root,this.clone.presences,n);const r=[],s=e.getID().getActorID();if(e.hasPresenceChange()&&this.onlineClients.has(s)){const a=e.getPresenceChange();switch(a.type){case xt.Put:r.push(this.presences.has(s)?{type:"presence-changed",source:n,value:{clientID:s,presence:a.presence}}:{type:"watched",source:de.Remote,value:{clientID:s,presence:a.presence}});break;case xt.Clear:r.push({type:"unwatched",source:de.Remote,value:{clientID:s,presence:this.getPresence(s)}}),this.removeOnlineClient(s);break}}const{opInfos:i,operations:o}=e.execute(this.root,this.presences,n);for(const a of o)if(a instanceof gn){const[c,l]=a.normalizePos(this.root);this.internalHistory.reconcileTextEdit(a.getParentCreatedAt(),c,l,a.getContent()?.length??0)}if(this.changeID=this.changeID.syncClocks(e.getID()),i.length){const a=this.isEnableDevtools()?e.toStruct():void 0;r.push(n===de.Remote?{type:"remote-change",source:n,value:{actor:s,clientSeq:e.getID().getClientSeq(),serverSeq:e.getID().getServerSeq(),message:e.getMessage()||"",operations:i},rawChange:a}:{type:"local-change",source:n,value:{actor:s,clientSeq:e.getID().getClientSeq(),serverSeq:e.getID().getServerSeq(),message:e.getMessage()||"",operations:i},rawChange:a})}r.length&&this.publish(r)}applyWatchStream(e){if(e.body.case==="initialization"){const n=e.body.value.clientIds,r=new Set;for(const s of n)s!==this.changeID.getActorID()&&r.add(s);this.setOnlineClients(r),this.publish([{type:"initialized",source:de.Local,value:this.getPresences()}]);return}if(e.body.case==="event"){const{type:n,publisher:r}=e.body.value,s=[];if(n===Fs.DOCUMENT_WATCHED){if(this.onlineClients.has(r)&&this.hasPresence(r))return;this.addOnlineClient(r),this.hasPresence(r)&&s.push({type:"watched",source:de.Remote,value:{clientID:r,presence:this.getPresence(r)}})}else if(n===Fs.DOCUMENT_UNWATCHED){const i=this.getPresence(r);this.removeOnlineClient(r),i&&s.push({type:"unwatched",source:de.Remote,value:{clientID:r,presence:i}})}s.length&&this.publish(s)}}applyStatus(e){this.status=e,e==="detached"&&this.setActor(ea),this.publish([{source:e==="removed"?de.Remote:de.Local,type:"status-changed",value:e==="attached"?{status:e,actorID:this.changeID.getActorID()}:{status:e}}])}applyDocEventsForReplay(e){for(const n of e){if(n.type==="status-changed"){this.applyStatus(n.value.status),n.value.status==="attached"&&this.setActor(n.value.actorID);continue}if(n.type==="snapshot"){const{snapshot:r,serverSeq:s,snapshotVector:i}=n.value;if(!r)continue;this.applySnapshot(BigInt(s),he.hexToVersionVector(i),he.hexToBytes(r));continue}if(n.type==="local-change"||n.type==="remote-change"){if(!n.rawChange)continue;const r=hr.fromStruct(n.rawChange);this.applyChange(r,n.source)}if(n.type==="initialized"){const r=new Set;for(const{clientID:s,presence:i}of n.value)r.add(s),this.presences.set(s,i);this.setOnlineClients(r)}else if(n.type==="watched"){const{clientID:r,presence:s}=n.value;this.addOnlineClient(r),this.presences.set(r,s)}else if(n.type==="unwatched"){const{clientID:r}=n.value;this.removeOnlineClient(r),this.presences.delete(r)}else if(n.type==="presence-changed"){const{clientID:r,presence:s}=n.value;this.presences.set(r,s)}}}getValueByPath(e){if(!e.startsWith("$"))throw new p(g.ErrInvalidArgument,'path must start with "$"');const n=e.split(".");n.shift();let r=this.getRoot();for(const s of n)if(r=r[s],!r)return;return r}setOnlineClients(e){this.onlineClients=e}resetOnlineClients(){this.onlineClients=new Set}addOnlineClient(e){this.onlineClients.add(e)}removeOnlineClient(e){this.onlineClients.delete(e)}hasPresence(e){return this.presences.has(e)}getMyPresence(){if(this.status!=="attached")return{};const e=this.presences.get(this.changeID.getActorID());return e?at(e):{}}getOthersPresences(){const e=[],n=this.changeID.getActorID();for(const r of this.onlineClients)r!==n&&this.presences.has(r)&&e.push({clientID:r,presence:at(this.presences.get(r))});return e}getPresence(e){if(e===this.changeID.getActorID())return this.getMyPresence();if(!this.onlineClients.has(e))return;const n=this.presences.get(e);return n?at(n):void 0}getPresences(){const e=[];e.push({clientID:this.changeID.getActorID(),presence:at(this.getMyPresence())});for(const n of this.onlineClients)this.presences.has(n)&&e.push({clientID:n,presence:at(this.presences.get(n))});return e}getPresenceForTest(e){const n=this.presences.get(e);return n?at(n):void 0}getSelfForTest(){return{clientID:this.getChangeID().getActorID(),presence:this.getMyPresence()}}getOthersForTest(){const e=this.getChangeID().getActorID();return this.getPresences().filter(n=>n.clientID!==e).sort((n,r)=>n.clientID>r.clientID?1:-1)}getUndoStackForTest(){return this.internalHistory.getUndoStackForTest()}getRedoStackForTest(){return this.internalHistory.getRedoStackForTest()}getVersionVector(){return this.changeID.getVersionVector()}isSameElementOrChildOf(e,n){if(n===e)return!0;const r=e.split(".");return n.split(".").every((s,i)=>s===r[i])}removePushedLocalChanges(e){for(;this.localChanges.length&&!(this.localChanges[0].getID().getClientSeq()>e);)this.localChanges.shift()}executeUndoRedo(e){if(this.isUpdating)throw new p(g.ErrRefused,`${e?"Undo":"Redo"} is not allowed during an update`);const n=e?this.internalHistory.popUndo():this.internalHistory.popRedo();if(!n)throw new p(g.ErrRefused,`There is no operation to be ${e?"undone":"redone"}`);this.ensureClone();const r=Pr.create(this.changeID,this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(const u of n){if(!(u instanceof pt)){new vl(r,at(this.clone.presences.get(this.changeID.getActorID()))).set(u.value,{addToHistory:!0});continue}const f=r.issueTimeTicket();if(u.setExecutedAt(f),u instanceof zt){const b=u.getCreatedAt();u.getValue().setCreatedAt(f),this.internalHistory.reconcileCreatedAt(b,f)}else if(u instanceof bn){const b=u.getValue().getCreatedAt();u.getValue().setCreatedAt(f),this.internalHistory.reconcileCreatedAt(b,f)}r.push(u)}const s=r.toChange();s.execute(this.clone.root,this.clone.presences,de.UndoRedo);const{opInfos:i,reverseOps:o}=s.execute(this.root,this.presences,de.UndoRedo),a=r.getReversePresence();if(a&&o.push({type:"presence",value:a}),o.length&&(e?this.internalHistory.pushRedo(o):this.internalHistory.pushUndo(o)),!s.hasPresenceChange()&&!i.length)return;this.localChanges.push(s),this.changeID=r.getNextID();const c=this.changeID.getActorID(),l=[];i.length&&l.push({type:"local-change",source:de.UndoRedo,value:{message:s.getMessage()||"",operations:i,actor:c,clientSeq:s.getID().getClientSeq(),serverSeq:s.getID().getServerSeq()},rawChange:this.isEnableDevtools()?s.toStruct():void 0}),s.hasPresenceChange()&&l.push({type:"presence-changed",source:de.UndoRedo,value:{clientID:c,presence:this.getPresence(c)}}),this.publish(l)}}class El{resource;resourceID;syncMode;changeEventReceived;lastHeartbeatTime;reconnectStreamDelay;cancelled;watchStream;watchLoopTimerID;watchAbortController;constructor(e,n,r,s){this.reconnectStreamDelay=e,this.resource=n,this.resourceID=r,this.syncMode=s,this.changeEventReceived=s!==void 0?!1:void 0,this.lastHeartbeatTime=Date.now(),this.cancelled=!1}changeSyncMode(e){this.syncMode=e}needRealtimeSync(){return this.syncMode===Nr.RealtimeSyncOff?!1:this.syncMode===Nr.RealtimePushOnly?this.resource.hasLocalChanges():this.syncMode!==Nr.Manual&&(this.resource.hasLocalChanges()||(this.changeEventReceived??!1))}needSync(e){return this.resource instanceof on?this.needRealtimeSync():this.syncMode===Nr.Manual?!1:Date.now()-this.lastHeartbeatTime>=e}updateHeartbeatTime(){this.lastHeartbeatTime=Date.now()}async runWatchLoop(e){const n=async()=>{if(this.watchStream)return Promise.resolve();this.watchLoopTimerID&&(clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0);try{[this.watchStream,this.watchAbortController]=await e(()=>{this.watchStream=void 0,this.watchAbortController=void 0,this.cancelled||(this.watchLoopTimerID=setTimeout(n,this.reconnectStreamDelay))})}catch{}};await n()}cancelWatchStream(){this.cancelled=!0,this.watchStream&&this.watchAbortController&&(this.watchAbortController.abort(),this.watchStream=void 0,this.watchAbortController=void 0),clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0}}function LA(t,e){let n=e;return{authInterceptor:i=>async o=>(t&&o.header.set("x-api-key",t),n&&o.header.set("authorization",n),await i(o)),setToken:i=>{n=i}}}const BA="@yorkie-js/sdk",WA="0.6.43",wl={name:BA,version:WA};function PA(t){return e=>async n=>(t?n.header.set("x-yorkie-user-agent",t):n.header.set("x-yorkie-user-agent",wl.name+"/"+wl.version),await e(n))}const _A=t=>{try{if(JSON.stringify(t)===void 0)return!1}catch{return!1}return!0};var wr=(t=>(t.Detached="detached",t.Attached="attached",t.Removed="removed",t))(wr||{}),Jn=(t=>(t.PresenceChanged="presence-changed",t.Initialized="initialized",t.Broadcast="broadcast",t.LocalBroadcast="local-broadcast",t.AuthError="auth-error",t))(Jn||{});const Sr=".";class tn{key;status;actorID;sessionID;count;seq;eventStream;eventStreamObserver;constructor(e){this.validateChannelKey(e),this.key=e,this.status="detached",this.count=0,this.seq=0,this.eventStream=ih(n=>this.eventStreamObserver=n)}getKey(){return this.key}getFirstKeyPath(){return this.key.split(Sr)[0]}getStatus(){return this.status}applyStatus(e){this.status=e}isAttached(){return this.status==="attached"}getActorID(){return this.actorID}setActor(e){this.actorID=e}getSessionID(){return this.sessionID}setSessionID(e){this.sessionID=e}getPresenceCount(){return this.count}updateCount(e,n){return n===0||n>this.seq?(this.count=e,this.seq=n,!0):!1}hasLocalChanges(){return!1}subscribe(e,n){if(typeof e=="function")return this.eventStream.subscribe(e);const r=e,s=n;if(!s)throw new Error("callback is required when subscribing to specific event type or topic");if(r==="broadcast")return this.eventStream.subscribe(o=>{o.type==="broadcast"&&s(o)});if(r==="local-broadcast")return this.eventStream.subscribe(o=>{o.type==="local-broadcast"&&s(o)});if(r==="auth-error")return this.eventStream.subscribe(o=>{o.type==="auth-error"&&s(o)});if(r==="presence")return this.eventStream.subscribe(o=>{(o.type==="presence-changed"||o.type==="initialized")&&s(o)});if(r==="all")return this.eventStream.subscribe(s);const i=r;return this.eventStream.subscribe(o=>{o.type==="broadcast"&&o.topic===i&&s(o)})}publish(e){this.eventStreamObserver&&this.eventStreamObserver.next(e)}broadcast(e,n,r){if(this.status!=="attached")throw new Error(`channel is not attached: ${this.status}`);if(!this.actorID)throw new Error("actorID is not set");this.publish({type:"local-broadcast",clientID:this.actorID,topic:e,payload:n,options:r})}validateChannelKey(e){if(e==="")throw new Error("channel key must not be empty");if(e.includes(" "))throw new Error("channel key must not contain a whitespace");if(e.startsWith(Sr))throw new Error("channel key must not start with a period");if(e.endsWith(Sr))throw new Error("channel key must not end with a period");if(e.includes(`${Sr}${Sr}`))throw new Error("channel key path must not empty")}}var Nr=(t=>(t.Manual="manual",t.Realtime="realtime",t.RealtimePushOnly="realtime-pushonly",t.RealtimeSyncOff="realtime-syncoff",t))(Nr||{});const Fn={rpcAddr:"https://api.yorkie.dev",syncLoopDuration:50,retrySyncLoopDelay:1e3,reconnectStreamDelay:1e3,channelHeartbeatInterval:3e4},Wi={maxRetries:1/0,initialRetryInterval:1e3,maxBackoff:2e4};class ch{id;key;metadata;status;attachmentMap;apiKey;authTokenInjector;conditions;syncLoopDuration;reconnectStreamDelay;retrySyncLoopDelay;channelHeartbeatInterval;rpcClient;setAuthToken;taskQueue;processing=!1;keepalive=!1;constructor(e){e=e||Fn;const n=e.rpcAddr||Fn.rpcAddr;this.key=e.key||sh(),this.metadata=e.metadata||{},this.status="deactivated",this.attachmentMap=new Map,this.apiKey=e.apiKey||"",this.authTokenInjector=e.authTokenInjector,this.conditions={SyncLoop:!1,WatchLoop:!1},this.syncLoopDuration=e.syncLoopDuration??Fn.syncLoopDuration,this.reconnectStreamDelay=e.reconnectStreamDelay??Fn.reconnectStreamDelay,this.retrySyncLoopDelay=e.retrySyncLoopDelay??Fn.retrySyncLoopDelay,this.channelHeartbeatInterval=e.channelHeartbeatInterval??Fn.channelHeartbeatInterval;const{authInterceptor:r,setToken:s}=LA(this.apiKey);this.setAuthToken=s,this.rpcClient=ib(ly,Vb({baseUrl:n,interceptors:[r,PA(e?.userAgent)],fetch:(i,o)=>fetch(i,{...o,keepalive:this.keepalive})})),this.taskQueue=[]}async activate(){if(this.isActive())return Promise.resolve();if(this.authTokenInjector){const e=await this.authTokenInjector();this.setAuthToken(e)}return this.enqueueTask(async()=>{try{const e=await this.rpcClient.activateClient({clientKey:this.key,metadata:this.metadata},{headers:{"x-shard-key":`${this.apiKey}/${this.key}`}});this.id=e.clientId,this.status="activated",this.runSyncLoop(),x.info(`[AC] c:"${this.getKey()}" activated, id:"${this.id}"`),typeof window<"u"&&window.addEventListener("beforeunload",async()=>{await this.deactivate({keepalive:!0})})}catch(e){throw x.error(`[AC] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}})}deactivate(e={keepalive:!1,synchronous:!1}){if(this.status==="deactivated")return Promise.resolve();const n=async()=>{try{await this.rpcClient.deactivateClient({clientId:this.id,synchronous:e.synchronous},{headers:{"x-shard-key":`${this.apiKey}/${this.key}`}}),this.deactivateInternal(),x.info(`[DC] c"${this.getKey()}" deactivated`)}catch(r){throw x.error(`[DC] c:"${this.getKey()}" err :`,r),await this.handleConnectError(r),r}};if(e.keepalive){this.keepalive=!0;const r=n();return this.keepalive=!1,r}return this.enqueueTask(n)}has(e){return this.attachmentMap.has(e)}attach(e,n){return e instanceof tn?this.attachChannel(e,n):this.attachDocument(e,n)}attachDocument(e,n={}){if(!this.isActive())throw new p(g.ErrClientNotActivated,`${this.key} is not active`);if(e.getStatus()!==en.Detached)throw new p(g.ErrNotDetached,`${e.getKey()} is not detached`);e.setActor(this.id),e.update((s,i)=>i.set(n.initialPresence||{}));const r=n.syncMode??"realtime";return this.enqueueTask(async()=>{try{const s=await this.rpcClient.attachDocument({clientId:this.id,changePack:he.toChangePack(e.createChangePack()),schemaKey:n.schema},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}});(s.maxSizePerDocument??0)>0&&e.setMaxSizePerDocument(s.maxSizePerDocument),s.schemaRules.length>0&&e.setSchemaRules(he.fromSchemaRules(s.schemaRules));const o=he.fromChangePack(s.changePack);if(e.applyChangePack(o),e.getStatus()===en.Removed)return e;e.applyStatus(en.Attached),this.attachmentMap.set(e.getKey(),new El(this.reconnectStreamDelay,e,s.documentId,r)),r!=="manual"&&await this.runWatchLoop(e.getKey()),x.info(`[AD] c:"${this.getKey()}" attaches d:"${e.getKey()}"`);const a=e.getRootObject();if(n.initialRoot){const c=n.initialRoot;e.update(l=>{for(const[u,f]of Object.entries(c))if(!a.has(u)){const b=u;l[b]=f}})}return e}catch(s){throw x.error(`[AD] c:"${this.getKey()}" err :`,s),await this.handleConnectError(s),s}})}detach(e,n){return e instanceof tn?this.detachChannel(e):this.detachDocument(e,n)}detachDocument(e,n={keepalive:!1}){if(!this.isActive())throw new p(g.ErrClientNotActivated,`${this.key} is not active`);const r=this.attachmentMap.get(e.getKey());if(!r)throw new p(g.ErrNotAttached,`${e.getKey()} is not attached`);e.update((i,o)=>o.clear());const s=async()=>{try{const i=await this.rpcClient.detachDocument({clientId:this.id,documentId:r.resourceID,changePack:he.toChangePack(e.createChangePack())},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),o=he.fromChangePack(i.changePack);return e.applyChangePack(o),e.getStatus()!==en.Removed&&e.applyStatus(en.Detached),this.detachInternal(e.getKey()),x.info(`[DD] c:"${this.getKey()}" detaches d:"${e.getKey()}"`),e}catch(i){throw x.error(`[DD] c:"${this.getKey()}" err :`,i),await this.handleConnectError(i),i}};if(n.keepalive){this.keepalive=!0;const i=s();return this.keepalive=!1,i}return this.enqueueTask(s)}async attachChannel(e,n={}){if(!this.isActive())throw new p(g.ErrClientNotActivated,`${this.key} is not active`);if(e.getStatus()!==wr.Detached)throw new p(g.ErrNotDetached,`${e.getKey()} is not detached`);e.setActor(this.id);const r=async()=>{try{const s=await this.rpcClient.attachChannel({clientId:this.id,channelKey:e.getKey()},{headers:{"x-shard-key":`${this.apiKey}/${e.getFirstKeyPath()}`}});e.setSessionID(s.sessionId),e.updateCount(Number(s.count),0),e.applyStatus(wr.Attached);const i=n.isRealtime!==!1?"realtime":"manual",o=new El(this.reconnectStreamDelay,e,s.sessionId,i);return e.subscribe("local-broadcast",a=>{const{topic:c,payload:l,options:u}=a;this.broadcast(e.getKey(),c,l,u).catch(f=>{u?.error&&u.error(f),x.error(`[BC] c:"${this.getKey()}" failed: ${f}`)})}),this.attachmentMap.set(e.getKey(),o),i==="realtime"&&await this.runWatchLoop(e.getKey()),x.info(`[AP] c:"${this.getKey()}" attaches p:"${e.getKey()}" mode:${i} count:${e.getPresenceCount()}`),e}catch(s){throw x.error(`[AP] c:"${this.getKey()}" err :`,s),await this.handleConnectError(s),s}};return this.enqueueTask(r)}async detachChannel(e){if(!this.isActive())throw new p(g.ErrClientNotActivated,`${this.key} is not active`);if(!this.attachmentMap.has(e.getKey()))throw new p(g.ErrNotAttached,`${e.getKey()} is not attached`);const n=async()=>{try{const r=await this.rpcClient.detachChannel({clientId:this.id,channelKey:e.getKey(),sessionId:e.getSessionID()},{headers:{"x-shard-key":`${this.apiKey}/${e.getFirstKeyPath()}`}});return e.updateCount(Number(r.count),0),e.applyStatus(wr.Detached),this.detachInternal(e.getKey()),x.info(`[DP] c:"${this.getKey()}" detaches p:"${e.getKey()}" count:${e.getPresenceCount()}`),e}catch(r){throw x.error(`[DP] c:"${this.getKey()}" err :`,r),await this.handleConnectError(r),r}};return this.enqueueTask(n)}async changeSyncMode(e,n){if(!this.isActive())throw new p(g.ErrClientNotActivated,`${this.key} is not active`);const r=this.attachmentMap.get(e.getKey());if(!r)throw new p(g.ErrNotAttached,`${e.getKey()} is not attached`);const s=r.syncMode;return s===n?e:(r.changeSyncMode(n),n==="manual"?(r.cancelWatchStream(),e):(n==="realtime"&&(r.changeEventReceived=!0),s==="manual"&&await this.runWatchLoop(e.getKey()),e))}sync(e){if(!this.isActive())throw new p(g.ErrClientNotActivated,`${this.key} is not active`);if(e instanceof tn){const n=this.attachmentMap.get(e.getKey());if(!n)throw new p(g.ErrNotAttached,`${e.getKey()} is not attached`);return this.enqueueTask(async()=>this.syncInternal(n).catch(async r=>{throw x.error(`[SY] c:"${this.getKey()}" err :`,r),await this.handleConnectError(r),r}))}if(e instanceof on){const n=this.attachmentMap.get(e.getKey());if(!n)throw new p(g.ErrNotAttached,`${e.getKey()} is not attached`);return this.enqueueTask(async()=>this.syncInternal(n,"realtime").catch(async r=>{throw x.error(`[SY] c:"${this.getKey()}" err :`,r),await this.handleConnectError(r),r}))}return this.enqueueTask(async()=>{const n=[];for(const[,r]of this.attachmentMap)r.syncMode!==void 0&&r.resource instanceof on&&n.push(this.syncInternal(r,r.syncMode));return Promise.all(n).catch(async r=>{throw x.error(`[SY] c:"${this.getKey()}" err :`,r),await this.handleConnectError(r),r})})}remove(e){if(!this.isActive())throw new p(g.ErrClientNotActivated,`${this.key} is not active`);const n=this.attachmentMap.get(e.getKey());if(!n)throw new p(g.ErrNotAttached,`${e.getKey()} is not attached`);e.setActor(this.id);const r=he.toChangePack(e.createChangePack());return r.isRemoved=!0,this.enqueueTask(async()=>{try{const s=await this.rpcClient.removeDocument({clientId:this.id,documentId:n.resourceID,changePack:r},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),i=he.fromChangePack(s.changePack);e.applyChangePack(i),this.detachInternal(e.getKey()),x.info(`[RD] c:"${this.getKey()}" removes d:"${e.getKey()}"`)}catch(s){throw x.error(`[RD] c:"${this.getKey()}" err :`,s),await this.handleConnectError(s),s}})}getID(){return this.id}getKey(){return this.key}isActive(){return this.status==="activated"}getStatus(){return this.status}getCondition(e){return this.conditions[e]}async createRevision(e,n,r){if(!this.isActive())throw new p(g.ErrClientNotActivated,`${this.key} is not active`);const s=this.attachmentMap.get(e.getKey());if(!s)throw new p(g.ErrNotAttached,`${e.getKey()} is not attached`);const i=async()=>{try{const o=await this.rpcClient.createRevision({clientId:this.id,documentId:s.resourceID,label:n,description:r||""},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}});if(!o.revision)throw new p(g.ErrInvalidArgument,"revision is not returned");return x.info(`[CR] c:"${this.getKey()}" creates revision d:"${e.getKey()}" l:"${n}"`),he.toRevisionSummary(o.revision)}catch(o){throw x.error(`[CR] c:"${this.getKey()}" err :`,o),await this.handleConnectError(o),o}};return this.enqueueTask(i)}async listRevisions(e,n){if(!this.isActive())throw new p(g.ErrClientNotActivated,`${this.key} is not active`);const r=this.attachmentMap.get(e.getKey());if(!r)throw new p(g.ErrNotAttached,`${e.getKey()} is not attached`);const s=async()=>{try{const i=await this.rpcClient.listRevisions({clientId:this.id,documentId:r.resourceID,pageSize:n?.pageSize||10,offset:n?.offset||0,isForward:n?.isForward??!1},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}});return x.info(`[LR] c:"${this.getKey()}" lists revisions d:"${e.getKey()}" count:${i.revisions.length}`),i.revisions.map(he.toRevisionSummary)}catch(i){throw x.error(`[LR] c:"${this.getKey()}" err :`,i),await this.handleConnectError(i),i}};return this.enqueueTask(s)}async getRevision(e,n){if(!this.isActive())throw new p(g.ErrClientNotActivated,`${this.key} is not active`);const r=this.attachmentMap.get(e.getKey());if(!r)throw new p(g.ErrNotAttached,`${e.getKey()} is not attached`);const s=async()=>{try{const i=await this.rpcClient.getRevision({clientId:this.id,documentId:r.resourceID,revisionId:n},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}});if(!i.revision)throw new p(g.ErrInvalidArgument,"revision is not returned");return x.info(`[GR] c:"${this.getKey()}" gets revision d:"${e.getKey()}" r:"${n}"`),he.toRevisionSummary(i.revision)}catch(i){throw x.error(`[GR] c:"${this.getKey()}" err :`,i),await this.handleConnectError(i),i}};return this.enqueueTask(s)}async restoreRevision(e,n){if(!this.isActive())throw new p(g.ErrClientNotActivated,`${this.key} is not active`);const r=this.attachmentMap.get(e.getKey());if(!r)throw new p(g.ErrNotAttached,`${e.getKey()} is not attached`);const s=async()=>{try{await this.rpcClient.restoreRevision({clientId:this.id,documentId:r.resourceID,revisionId:n},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),x.info(`[RR] c:"${this.getKey()}" restores revision d:"${e.getKey()}" r:"${n}"`)}catch(i){throw x.error(`[RR] c:"${this.getKey()}" err :`,i),await this.handleConnectError(i),i}};return this.enqueueTask(s)}async broadcast(e,n,r,s){if(!this.isActive())throw new p(g.ErrClientNotActivated,`${this.key} is not active`);const i=this.attachmentMap.get(e);if(!i)throw new p(g.ErrNotAttached,`${e} is not attached`);if(!_A(r))throw new p(g.ErrInvalidArgument,"payload is not serializable");const o=i.resource,a=s?.maxRetries??Wi.maxRetries,c=Wi.maxBackoff;let l=0;const u=b=>Math.min(Wi.initialRetryInterval*2**b,c),f=async()=>this.enqueueTask(async()=>{try{await this.rpcClient.broadcast({clientId:this.id,channelKey:e,topic:n,payload:new TextEncoder().encode(JSON.stringify(r))},{headers:{"x-shard-key":`${this.apiKey}/${o.getFirstKeyPath()}`}}),x.info(`[BC] c:"${this.getKey()}" broadcasts p:"${e}" t:"${n}"`)}catch(b){if(x.error(`[BC] c:"${this.getKey()}" err:`,b),await this.handleConnectError(b))if(Li(b,g.ErrUnauthenticated)&&i.resource instanceof tn&&i.resource.publish({type:Jn.AuthError,reason:Er(b).reason||"unauthenticated",method:"Broadcast"}),l<a)l++,setTimeout(()=>f(),u(l-1)),x.info(`[BC] c:"${this.getKey()}" retry attempt ${l}/${a}`);else throw x.error(`[BC] c:"${this.getKey()}" exceeded maximum retry attempts`),b}});return f()}runSyncLoop(){const e=async()=>{if(!this.isActive()){x.debug(`[SL] c:"${this.getKey()}" exit sync loop`),this.conditions.SyncLoop=!1;return}try{await this.enqueueTask(async()=>{const n=[];for(const[,r]of this.attachmentMap)r.needSync(this.channelHeartbeatInterval)&&(r.changeEventReceived!==void 0&&(r.changeEventReceived=!1),n.push(this.syncInternal(r,r.syncMode).catch(s=>{throw Li(s,g.ErrUnauthenticated)&&r.resource.publish([{type:Se.AuthError,value:{reason:Er(s).reason,method:"PushPull"}}]),s})));await Promise.all(n),setTimeout(e,this.syncLoopDuration)})}catch(n){x.error(`[SL] c:"${this.getKey()}" sync failed:`,n),await this.handleConnectError(n)?setTimeout(e,this.retrySyncLoopDelay):this.conditions.SyncLoop=!1}};x.debug(`[SL] c:"${this.getKey()}" run sync loop`),this.conditions.SyncLoop=!0,e()}async runWatchLoop(e){const n=this.attachmentMap.get(e);if(!n)throw new p(g.ErrNotAttached,`${e} is not attached`);return this.conditions.WatchLoop=!0,n.runWatchLoop(r=>{if(!this.isActive())return this.conditions.WatchLoop=!1,Promise.reject(new p(g.ErrClientNotActivated,`${this.key} is not active`));if(!this.attachmentMap.has(e))return this.conditions.WatchLoop=!1,Promise.reject(new p(g.ErrNotAttached,`${e} is not attached`));const s=new AbortController;return n.resource instanceof on?this.createDocumentWatchStream(n,e,s,r):n.resource instanceof tn?this.createChannelWatchStream(n,e,s,r):Promise.reject(new p(g.ErrClientNotActivated,`Unknown resource type for ${e}`))})}createDocumentWatchStream(e,n,r,s){const i=this.rpcClient.watchDocument({clientId:this.id,documentId:e.resourceID},{headers:{"x-shard-key":`${this.apiKey}/${n}`},signal:r.signal});return e.resource.publish([{type:Se.ConnectionChanged,value:xs.Connected}]),x.info(`[WD] c:"${this.getKey()}" watches d:"${n}"`),e.changeEventReceived!==void 0&&(e.changeEventReceived=!0),new Promise((o,a)=>{(async()=>{try{for await(const l of i)this.handleWatchDocumentResponse(e,l),l.body.case==="initialization"&&o([i,r]);e.resource.resetOnlineClients(),e.resource.publish([{type:Se.Initialized,source:de.Local,value:e.resource.getPresences()}]),e.resource.publish([{type:Se.ConnectionChanged,value:xs.Disconnected}]),x.debug(`[WD] c:"${this.getKey()}" unwatches (stream ended)`),s()}catch(l){e.resource.resetOnlineClients(),e.resource.publish([{type:Se.Initialized,source:de.Local,value:e.resource.getPresences()}]),e.resource.publish([{type:Se.ConnectionChanged,value:xs.Disconnected}]),x.debug(`[WD] c:"${this.getKey()}" unwatches`),await this.handleConnectError(l)?(Li(l,g.ErrUnauthenticated)&&e.resource.publish([{type:Se.AuthError,value:{reason:Er(l).reason,method:"WatchDocument"}}]),s()):this.conditions.WatchLoop=!1,a(l)}})()})}createChannelWatchStream(e,n,r,s){const i=this.rpcClient.watchChannel({clientId:this.id,channelKey:n},{headers:{"x-shard-key":`${this.apiKey}/${e.resource.getFirstKeyPath()}`},signal:r.signal});return x.info(`[WP] c:"${this.getKey()}" watches p:"${n}"`),new Promise((o,a)=>{(async()=>{try{let l=!0;for await(const u of i)this.handleWatchChannelResponse(e,u),l&&(l=!1,o([i,r]));x.debug(`[WP] c:"${this.getKey()}" p:"${n}" stream ended`),s()}catch(l){if(l instanceof Error&&l.name==="AbortError"){x.debug(`[WP] c:"${this.getKey()}" p:"${n}" stream aborted`);return}x.debug(`[WP] c:"${this.getKey()}" p:"${n}" err:`,l),await this.handleConnectError(l)?s():this.conditions.WatchLoop=!1,a(l)}})()})}handleWatchChannelResponse(e,n){const r=e.resource;if(n.body.case==="initialized"){const{count:s,seq:i}=n.body.value;r.updateCount(Number(s),Number(i))&&r.publish({type:Jn.Initialized,count:Number(s)})}else if(n.body.case==="event"){const s=n.body.value;if(s.type===Vf.BROADCAST){const i=new TextDecoder;try{const o=JSON.parse(i.decode(s.payload));r.publish({type:Jn.Broadcast,clientID:s.publisher,topic:s.topic,payload:o})}catch(o){x.error(`[WP] c:"${this.getKey()}" failed to parse broadcast payload:`,o)}return}r.updateCount(Number(s.count),Number(s.seq))&&r.publish({type:Jn.PresenceChanged,count:Number(s.count)})}}handleWatchDocumentResponse(e,n){if(n.body.case==="event"&&n.body.value.type===Fs.DOCUMENT_CHANGED){e.changeEventReceived!==void 0&&(e.changeEventReceived=!0);return}e.resource.applyWatchStream(n)}deactivateInternal(){this.status="deactivated";for(const[e,n]of this.attachmentMap)this.detachInternal(e),n.resource instanceof on?n.resource.applyStatus(en.Detached):n.resource instanceof tn&&n.resource.applyStatus(wr.Detached)}detachInternal(e){const n=this.attachmentMap.get(e);n&&(n.cancelWatchStream(),n.resource instanceof on&&n.resource.resetOnlineClients(),this.attachmentMap.delete(e))}async syncInternal(e,n){const{resource:r}=e;if(r instanceof tn){try{const a=await this.rpcClient.refreshChannel({clientId:this.id,channelKey:r.getKey(),sessionId:r.getSessionID()},{headers:{"x-shard-key":`${this.apiKey}/${r.getFirstKeyPath()}`}});r.updateCount(Number(a.count),0),e.updateHeartbeatTime(),x.debug(`[RP] c:"${this.getKey()}" refreshes p:"${r.getKey()}" mode:${e.syncMode}`)}catch(a){throw x.error(`[RP] c:"${this.getKey()}" err :`,a),a}return r}const s=r,{resourceID:i}=e,o=s.createChangePack();try{const a=await this.rpcClient.pushPullChanges({clientId:this.id,documentId:i,changePack:he.toChangePack(o),pushOnly:n==="realtime-pushonly"},{headers:{"x-shard-key":`${this.apiKey}/${s.getKey()}`}}),c=he.fromChangePack(a.changePack);if(c.hasChanges()&&(e.syncMode==="realtime-pushonly"||e.syncMode==="realtime-syncoff"))return s;s.applyChangePack(c),e.resource.publish([{type:Se.SyncStatusChanged,value:ao.Synced}]),s.getStatus()===en.Removed&&this.detachInternal(s.getKey());const l=s.getKey(),u=c.getChangeSize();return x.info(`[PP] c:"${this.getKey()}" sync d:"${l}", push:${o.getChangeSize()} pull:${u} cp:${c.getCheckpoint().toTestString()}`),s}catch(a){throw s.publish([{type:Se.SyncStatusChanged,value:ao.SyncFailed}]),x.error(`[PP] c:"${this.getKey()}" err :`,a),a}}async handleConnectError(e){if(!(e instanceof se))return!1;if(e.code===z.Canceled||e.code===z.Unknown||e.code===z.ResourceExhausted||e.code===z.Unavailable)return!0;if(Mn(e)===g.ErrUnauthenticated){if(this.authTokenInjector){const n=await this.authTokenInjector(Er(e).reason);this.setAuthToken(n)}return!0}return Mn(e)===g.ErrTooManySubscribers?(x.error(`[WD] c:"${this.getKey()}" err :`,e.rawMessage),!0):(Mn(e)===g.ErrTooManyAttachments||(Mn(e)===g.ErrClientNotActivated||Mn(e)===g.ErrClientNotFound)&&this.deactivateInternal(),!1)}enqueueTask(e){return new Promise((n,r)=>{this.taskQueue.push(()=>e().then(n).catch(r)),this.processing||this.processNext()})}async processNext(){if(this.taskQueue.length===0){this.processing=!1;return}try{this.processing=!0,await this.taskQueue.shift()()}catch{x.error(`[TQ] c:"${this.getKey()}" process failed, id:"${this.id}"`)}this.processNext()}}function lh(t){return typeof t=="object"&&t!==null&&t.type==="Text"&&Array.isArray(t.nodes)}function uh(t){return typeof t=="object"&&t!==null&&t.type==="Tree"&&typeof t.root=="object"}function fh(t){return typeof t=="object"&&t!==null&&t.type==="Int"&&typeof t.value=="number"}function hh(t){return typeof t=="object"&&t!==null&&t.type==="Long"&&typeof t.value=="number"}function dh(t){return typeof t=="object"&&t!==null&&t.type==="Date"&&typeof t.value=="string"}function gh(t){return typeof t=="object"&&t!==null&&t.type==="BinData"&&typeof t.value=="string"}function ph(t){return typeof t=="object"&&t!==null&&t.type==="Counter"&&typeof t.value=="object"}function UA(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&!lh(t)&&!uh(t)&&!fh(t)&&!hh(t)&&!dh(t)&&!gh(t)&&!ph(t)}function kA(t){try{const e=FA(t),n=JSON.parse(e);return Vs(n)}catch(e){throw new p(g.ErrInvalidArgument,`Failed to parse YSON: ${e instanceof Error?e.message:String(e)}`)}}function FA(t){let e=t;return e=e.replace(/Counter\((Int|Long)\((-?\d+)\)\)/g,(n,r,s)=>`{"__yson_type":"Counter","__yson_data":{"__yson_type":"${r}","__yson_data":${s}}}`),e=e.replace(/Int\((-?\d+)\)/g,(n,r)=>`{"__yson_type":"Int","__yson_data":${r}}`),e=e.replace(/Long\((-?\d+)\)/g,(n,r)=>`{"__yson_type":"Long","__yson_data":${r}}`),e=e.replace(/Date\("([^"]*)"\)/g,(n,r)=>`{"__yson_type":"Date","__yson_data":"${r}"}`),e=e.replace(/BinData\("([^"]*)"\)/g,(n,r)=>`{"__yson_type":"BinData","__yson_data":"${r}"}`),e=e.replace(/Text\((\[(?:[^[\]]|\[(?:[^[\]]|\[[^[\]]*\])*\])*\])\)/g,(n,r)=>`{"__yson_type":"Text","__yson_data":${r}}`),e=e.replace(/Tree\((\{[^{}]*(?:\{[^{}]*(?:\{[^{}]*\})*[^{}]*\})*[^{}]*\})\)/g,(n,r)=>`{"__yson_type":"Tree","__yson_data":${r}}`),e}function Vs(t){if(t===null||typeof t!="object")return t;if(t.__yson_type==="Int"&&typeof t.__yson_data=="number")return{type:"Int",value:t.__yson_data};if(t.__yson_type==="Long"&&typeof t.__yson_data=="number")return{type:"Long",value:t.__yson_data};if(t.__yson_type==="Date"&&typeof t.__yson_data=="string")return{type:"Date",value:t.__yson_data};if(t.__yson_type==="BinData"&&typeof t.__yson_data=="string")return{type:"BinData",value:t.__yson_data};if(t.__yson_type==="Counter"&&typeof t.__yson_data=="object"){const n=Vs(t.__yson_data);if(typeof n=="object"&&n!==null&&"type"in n&&(n.type==="Int"||n.type==="Long"))return{type:"Counter",value:n};throw new p(g.ErrInvalidArgument,"Counter must contain Int or Long")}if(t.__yson_type==="Text"&&Array.isArray(t.__yson_data))return{type:"Text",nodes:t.__yson_data.map(n=>ZA(n))};if(t.__yson_type==="Tree"&&typeof t.__yson_data=="object")return{type:"Tree",root:mh(t.__yson_data)};if(Array.isArray(t))return t.map(n=>Vs(n));const e={};for(const[n,r]of Object.entries(t))e[n]=Vs(r);return e}function ZA(t){if(typeof t!="object"||t===null||typeof t.val!="string")throw new p(g.ErrInvalidArgument,"invalid text node format");const e={val:t.val};return t.attrs&&typeof t.attrs=="object"&&(e.attrs=t.attrs),e}function mh(t){if(typeof t!="object"||t===null||typeof t.type!="string")throw new p(g.ErrInvalidArgument,"invalid tree node format");const e={type:t.type};return t.type==="text"&&typeof t.value=="string"?(e.value=t.value,e):(t.attrs&&typeof t.attrs=="object"&&(e.attrs=t.attrs),Array.isArray(t.children)&&(e.children=t.children.map(n=>mh(n))),e)}function GA(t){return t.nodes.map(e=>e.val).join("")}function MA(t){return bh(t.root)}function bh(t){const e=t.attrs?Object.entries(t.attrs).map(([r,s])=>` ${r}="${Nl(s)}"`).join(""):"";if(t.type==="text"&&t.value!==void 0)return`<${t.type}${e}>${Nl(t.value)}</${t.type}>`;if(!t.children||t.children.length===0)return`<${t.type}${e} />`;const n=t.children.map(r=>bh(r)).join("");return`<${t.type}${e}>${n}</${t.type}>`}function Nl(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}const YA=Object.freeze(Object.defineProperty({__proto__:null,isBinData:gh,isCounter:ph,isDate:dh,isInt:fh,isLong:hh,isObject:UA,isText:lh,isTree:uh,parse:kA,textToString:GA,treeToXML:MA},Symbol.toStringTag,{value:"Module"})),yh={Client:ch,Document:on,IntType:Dt.Int,LongType:Dt.Long};typeof globalThis<"u"&&(globalThis.yorkie={Client:ch,Document:on,Primitive:be,Text:ha,Counter:da,Tree:ma,Channel:tn,ChannelEventType:Jn,YSON:YA,LogLevel:Fe,setLogLevel:gA,IntType:Dt.Int,LongType:Dt.Long});const KA=(t,e)=>{const n=t.__vccOpts||t;for(const[r,s]of e)n[r]=s;return n},JA={lists:[{title:"Todo",cards:[{title:"Pruning document"},{title:"Clean up codes"}]},{title:"Doing",cards:[{title:"Array operations"}]},{title:"Done",cards:[{title:"Create a sample page"},{title:"Launch demo site"}]}]},In=new yh.Client({rpcAddr:"https://api.yorkie.dev",apiKey:"D6sd9E5ehtXBssmeRZ4QQP"}),qt=new yh.Document(`vuejs-kanban-${new Date().toISOString().substring(0,10).replace(/-/g,"")}`,{enableDevtools:!0}),$A={data(){return{lists:[],title:"",opened:null}},created(){this.fetchDoc()},watch:{opened(t){this.$nextTick(function(){t===0?this.$refs.addListForm.querySelector("input").focus():t&&this.$refs.addCardForm[t-1].querySelector("input").focus(),this.title=""})}},methods:{async fetchDoc(){await In.activate(),await In.attach(qt,{initialRoot:JA}),qt.subscribe(t=>{this.lists=qt.getRoot().lists}),await In.sync(),this.lists=qt.getRoot().lists},isOpened(t){return this.opened===t},openForm(t){this.opened=t},closeForm(){this.opened=null},addCard(t){this.title!==""&&qt.update(e=>{e.lists.getElementByID(t.getID()).cards.push({title:this.title}),this.title=""},`add new card by ${In.getID()}`)},deleteCard(t,e){qt.update(n=>{n.lists.getElementByID(t.getID()).cards.deleteByID(e.getID())},`delete a card by ${In.getID()}`)},addList(){this.title!==""&&qt.update(t=>{t.lists.push({title:this.title,cards:[]}),this.title=""},`add new list by ${In.getID()}`)},deleteList(t){qt.update(e=>{e.lists.deleteByID(t.getID())},`delete a list by ${In.getID()}`)}}},XA={class:"list"},zA=["onClick"],jA={class:"title"},HA={class:"card"},QA=["onClick"],qA={key:0,class:"add-form"},ev=["onKeyup"],tv={class:"buttons"},nv=["onClick"],rv=["onClick"],sv={class:"add-list",ref:"addListForm"},iv={key:0,class:"add-form"},ov={class:"buttons"};function av(t,e,n,r,s,i){return Wt(),Pt(He,null,[(Wt(!0),Pt(He,null,xa(s.lists,(o,a)=>(Wt(),Pt("div",XA,[Oe("span",{class:"delete",onClick:c=>i.deleteList(o)},"",8,zA),Oe("div",jA,Pi(o.title),1),(Wt(!0),Pt(He,null,xa(o.cards,c=>(Wt(),Pt("div",HA,[Oe("span",{class:"delete",onClick:l=>i.deleteCard(o,c)},"",8,QA),Ru(" "+Pi(c.title),1)]))),256)),Oe("div",{class:"add-card",ref_for:!0,ref:"addCardForm"},[i.isOpened(a+1)?(Wt(),Pt("div",qA,[Ca(Oe("input",{type:"text",placeholder:"Enter card title","onUpdate:modelValue":e[0]||(e[0]=c=>s.title=c),onKeyup:[ds(c=>i.addCard(o),["enter"]),e[1]||(e[1]=ds(c=>i.closeForm(),["esc"]))]},null,40,ev),[[tc,s.title]]),Oe("div",tv,[Oe("input",{type:"button",value:"Add",onClick:c=>i.addCard(o)},null,8,nv),Oe("input",{type:"button",value:"Close",class:"pull-right",onClick:e[2]||(e[2]=c=>i.closeForm())})])])):(Wt(),Pt("div",{key:1,class:"add-card-opener",onClick:c=>i.openForm(a+1)}," Add another card ",8,rv))],512)]))),256)),Oe("div",sv,[i.isOpened(0)?(Wt(),Pt("div",iv,[Ca(Oe("input",{type:"text",placeholder:"Enter list title","onUpdate:modelValue":e[3]||(e[3]=o=>s.title=o),onKeyup:[e[4]||(e[4]=ds(o=>i.addList(),["enter"])),e[5]||(e[5]=ds(o=>i.closeForm(),["esc"]))]},null,544),[[tc,s.title]]),Oe("div",ov,[Oe("input",{type:"button",value:"Add",onClick:e[6]||(e[6]=o=>i.addList())}),Oe("input",{type:"button",value:"Close",class:"pull-right",onClick:e[7]||(e[7]=o=>i.closeForm())})])])):(Wt(),Pt("div",{key:1,class:"add-list-opener",onClick:e[8]||(e[8]=o=>i.openForm(0))}," Add another list "))],512)],64)}const cv=KA($A,[["render",av]]);Zg(cv).mount("#app");
