var gh=Object.defineProperty;var mh=(r,e,t)=>e in r?gh(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var c=(r,e,t)=>mh(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function qa(r){const e=Object.create(null);for(const t of r.split(","))e[t]=1;return t=>t in e}const ce={},is=[],jt=()=>{},ph=()=>!1,go=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&(r.charCodeAt(2)>122||r.charCodeAt(2)<97),Va=r=>r.startsWith("onUpdate:"),Me=Object.assign,Ka=(r,e)=>{const t=r.indexOf(e);t>-1&&r.splice(t,1)},yh=Object.prototype.hasOwnProperty,re=(r,e)=>yh.call(r,e),W=Array.isArray,os=r=>mo(r)==="[object Map]",Zl=r=>mo(r)==="[object Set]",G=r=>typeof r=="function",Te=r=>typeof r=="string",Nn=r=>typeof r=="symbol",ge=r=>r!==null&&typeof r=="object",Ql=r=>(ge(r)||G(r))&&G(r.then)&&G(r.catch),eu=Object.prototype.toString,mo=r=>eu.call(r),vh=r=>mo(r).slice(8,-1),tu=r=>mo(r)==="[object Object]",za=r=>Te(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,Rs=qa(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),po=r=>{const e=Object.create(null);return t=>e[t]||(e[t]=r(t))},wh=/-(\w)/g,xn=po(r=>r.replace(wh,(e,t)=>t?t.toUpperCase():"")),bh=/\B([A-Z])/g,Pn=po(r=>r.replace(bh,"-$1").toLowerCase()),ru=po(r=>r.charAt(0).toUpperCase()+r.slice(1)),Do=po(r=>r?`on${ru(r)}`:""),Vn=(r,e)=>!Object.is(r,e),ki=(r,...e)=>{for(let t=0;t<r.length;t++)r[t](...e)},nu=(r,e,t,n=!1)=>{Object.defineProperty(r,e,{configurable:!0,enumerable:!1,writable:n,value:t})},Qo=r=>{const e=parseFloat(r);return isNaN(e)?r:e};let Oc;const yo=()=>Oc||(Oc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ja(r){if(W(r)){const e={};for(let t=0;t<r.length;t++){const n=r[t],s=Te(n)?Ih(n):ja(n);if(s)for(const i in s)e[i]=s[i]}return e}else if(Te(r)||ge(r))return r}const Th=/;(?![^(]*\))/g,Ah=/:([^]+)/,Sh=/\/\*[^]*?\*\//g;function Ih(r){const e={};return r.replace(Sh,"").split(Th).forEach(t=>{if(t){const n=t.split(Ah);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Ha(r){let e="";if(Te(r))e=r;else if(W(r))for(let t=0;t<r.length;t++){const n=Ha(r[t]);n&&(e+=n+" ")}else if(ge(r))for(const t in r)r[t]&&(e+=t+" ");return e.trim()}const xh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",kh=qa(xh);function su(r){return!!r||r===""}const iu=r=>!!(r&&r.__v_isRef===!0),ea=r=>Te(r)?r:r==null?"":W(r)||ge(r)&&(r.toString===eu||!G(r.toString))?iu(r)?ea(r.value):JSON.stringify(r,ou,2):String(r),ou=(r,e)=>iu(e)?ou(r,e.value):os(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[n,s],i)=>(t[Bo(n,i)+" =>"]=s,t),{})}:Zl(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Bo(t))}:Nn(e)?Bo(e):ge(e)&&!W(e)&&!tu(e)?String(e):e,Bo=(r,e="")=>{var t;return Nn(r)?`Symbol(${(t=r.description)!=null?t:e})`:r};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let We;class Eh{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=We,!e&&We&&(this.index=(We.scopes||(We.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=We;try{return We=this,e()}finally{We=t}}}on(){We=this}off(){We=this.parent}stop(e){if(this._active){this._active=!1;let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Ch(){return We}let fe;const Ro=new WeakSet;class au{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,We&&We.active&&We.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ro.has(this)&&(Ro.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||lu(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Dc(this),uu(this);const e=fe,t=Tt;fe=this,Tt=!0;try{return this.fn()}finally{fu(this),fe=e,Tt=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Ga(e);this.deps=this.depsTail=void 0,Dc(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ro.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ta(this)&&this.run()}get dirty(){return ta(this)}}let cu=0,Ls,Js;function lu(r,e=!1){if(r.flags|=8,e){r.next=Js,Js=r;return}r.next=Ls,Ls=r}function Wa(){cu++}function _a(){if(--cu>0)return;if(Js){let e=Js;for(Js=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let r;for(;Ls;){let e=Ls;for(Ls=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){r||(r=n)}e=t}}if(r)throw r}function uu(r){for(let e=r.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function fu(r){let e,t=r.depsTail,n=t;for(;n;){const s=n.prevDep;n.version===-1?(n===t&&(t=s),Ga(n),Nh(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=s}r.deps=e,r.depsTail=t}function ta(r){for(let e=r.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(hu(e.dep.computed)||e.dep.version!==e.version))return!0;return!!r._dirty}function hu(r){if(r.flags&4&&!(r.flags&16)||(r.flags&=-17,r.globalVersion===js))return;r.globalVersion=js;const e=r.dep;if(r.flags|=2,e.version>0&&!r.isSSR&&r.deps&&!ta(r)){r.flags&=-3;return}const t=fe,n=Tt;fe=r,Tt=!0;try{uu(r);const s=r.fn(r._value);(e.version===0||Vn(s,r._value))&&(r._value=s,e.version++)}catch(s){throw e.version++,s}finally{fe=t,Tt=n,fu(r),r.flags&=-3}}function Ga(r,e=!1){const{dep:t,prevSub:n,nextSub:s}=r;if(n&&(n.nextSub=s,r.prevSub=void 0),s&&(s.prevSub=n,r.nextSub=void 0),t.subs===r&&(t.subs=n,!n&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)Ga(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function Nh(r){const{prevDep:e,nextDep:t}=r;e&&(e.nextDep=t,r.prevDep=void 0),t&&(t.prevDep=e,r.nextDep=void 0)}let Tt=!0;const du=[];function On(){du.push(Tt),Tt=!1}function Dn(){const r=du.pop();Tt=r===void 0?!0:r}function Dc(r){const{cleanup:e}=r;if(r.cleanup=void 0,e){const t=fe;fe=void 0;try{e()}finally{fe=t}}}let js=0;class Ph{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class gu{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!fe||!Tt||fe===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==fe)t=this.activeLink=new Ph(fe,this),fe.deps?(t.prevDep=fe.depsTail,fe.depsTail.nextDep=t,fe.depsTail=t):fe.deps=fe.depsTail=t,mu(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const n=t.nextDep;n.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=n),t.prevDep=fe.depsTail,t.nextDep=void 0,fe.depsTail.nextDep=t,fe.depsTail=t,fe.deps===t&&(fe.deps=n)}return t}trigger(e){this.version++,js++,this.notify(e)}notify(e){Wa();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{_a()}}}function mu(r){if(r.dep.sc++,r.sub.flags&4){const e=r.dep.computed;if(e&&!r.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)mu(n)}const t=r.dep.subs;t!==r&&(r.prevSub=t,t&&(t.nextSub=r)),r.dep.subs=r}}const ra=new WeakMap,Kn=Symbol(""),na=Symbol(""),Hs=Symbol("");function Ee(r,e,t){if(Tt&&fe){let n=ra.get(r);n||ra.set(r,n=new Map);let s=n.get(t);s||(n.set(t,s=new gu),s.map=n,s.key=t),s.track()}}function tn(r,e,t,n,s,i){const o=ra.get(r);if(!o){js++;return}const a=l=>{l&&l.trigger()};if(Wa(),e==="clear")o.forEach(a);else{const l=W(r),u=l&&za(t);if(l&&t==="length"){const f=Number(n);o.forEach((d,y)=>{(y==="length"||y===Hs||!Nn(y)&&y>=f)&&a(d)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),u&&a(o.get(Hs)),e){case"add":l?u&&a(o.get("length")):(a(o.get(Kn)),os(r)&&a(o.get(na)));break;case"delete":l||(a(o.get(Kn)),os(r)&&a(o.get(na)));break;case"set":os(r)&&a(o.get(Kn));break}}_a()}function Xn(r){const e=oe(r);return e===r?e:(Ee(e,"iterate",Hs),At(r)?e:e.map($e))}function vo(r){return Ee(r=oe(r),"iterate",Hs),r}const Oh={__proto__:null,[Symbol.iterator](){return Lo(this,Symbol.iterator,$e)},concat(...r){return Xn(this).concat(...r.map(e=>W(e)?Xn(e):e))},entries(){return Lo(this,"entries",r=>(r[1]=$e(r[1]),r))},every(r,e){return Yt(this,"every",r,e,void 0,arguments)},filter(r,e){return Yt(this,"filter",r,e,t=>t.map($e),arguments)},find(r,e){return Yt(this,"find",r,e,$e,arguments)},findIndex(r,e){return Yt(this,"findIndex",r,e,void 0,arguments)},findLast(r,e){return Yt(this,"findLast",r,e,$e,arguments)},findLastIndex(r,e){return Yt(this,"findLastIndex",r,e,void 0,arguments)},forEach(r,e){return Yt(this,"forEach",r,e,void 0,arguments)},includes(...r){return Jo(this,"includes",r)},indexOf(...r){return Jo(this,"indexOf",r)},join(r){return Xn(this).join(r)},lastIndexOf(...r){return Jo(this,"lastIndexOf",r)},map(r,e){return Yt(this,"map",r,e,void 0,arguments)},pop(){return Es(this,"pop")},push(...r){return Es(this,"push",r)},reduce(r,...e){return Bc(this,"reduce",r,e)},reduceRight(r,...e){return Bc(this,"reduceRight",r,e)},shift(){return Es(this,"shift")},some(r,e){return Yt(this,"some",r,e,void 0,arguments)},splice(...r){return Es(this,"splice",r)},toReversed(){return Xn(this).toReversed()},toSorted(r){return Xn(this).toSorted(r)},toSpliced(...r){return Xn(this).toSpliced(...r)},unshift(...r){return Es(this,"unshift",r)},values(){return Lo(this,"values",$e)}};function Lo(r,e,t){const n=vo(r),s=n[e]();return n!==r&&!At(r)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=t(i.value)),i}),s}const Dh=Array.prototype;function Yt(r,e,t,n,s,i){const o=vo(r),a=o!==r&&!At(r),l=o[e];if(l!==Dh[e]){const d=l.apply(r,i);return a?$e(d):d}let u=t;o!==r&&(a?u=function(d,y){return t.call(this,$e(d),y,r)}:t.length>2&&(u=function(d,y){return t.call(this,d,y,r)}));const f=l.call(o,u,n);return a&&s?s(f):f}function Bc(r,e,t,n){const s=vo(r);let i=t;return s!==r&&(At(r)?t.length>3&&(i=function(o,a,l){return t.call(this,o,a,l,r)}):i=function(o,a,l){return t.call(this,o,$e(a),l,r)}),s[e](i,...n)}function Jo(r,e,t){const n=oe(r);Ee(n,"iterate",Hs);const s=n[e](...t);return(s===-1||s===!1)&&Qa(t[0])?(t[0]=oe(t[0]),n[e](...t)):s}function Es(r,e,t=[]){On(),Wa();const n=oe(r)[e].apply(r,t);return _a(),Dn(),n}const Bh=qa("__proto__,__v_isRef,__isVue"),pu=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(Nn));function Rh(r){Nn(r)||(r=String(r));const e=oe(this);return Ee(e,"has",r),e.hasOwnProperty(r)}class yu{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return n===(s?i?zh:Tu:i?bu:wu).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=W(e);if(!s){let l;if(o&&(l=Oh[t]))return l;if(t==="hasOwnProperty")return Rh}const a=Reflect.get(e,t,Je(e)?e:n);return(Nn(t)?pu.has(t):Bh(t))||(s||Ee(e,"get",t),i)?a:Je(a)?o&&za(t)?a:a.value:ge(a)?s?Au(a):Xa(a):a}}class vu extends yu{constructor(e=!1){super(!1,e)}set(e,t,n,s){let i=e[t];if(!this._isShallow){const l=ds(i);if(!At(n)&&!ds(n)&&(i=oe(i),n=oe(n)),!W(e)&&Je(i)&&!Je(n))return l?!1:(i.value=n,!0)}const o=W(e)&&za(t)?Number(t)<e.length:re(e,t),a=Reflect.set(e,t,n,Je(e)?e:s);return e===oe(s)&&(o?Vn(n,i)&&tn(e,"set",t,n):tn(e,"add",t,n)),a}deleteProperty(e,t){const n=re(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&n&&tn(e,"delete",t,void 0),s}has(e,t){const n=Reflect.has(e,t);return(!Nn(t)||!pu.has(t))&&Ee(e,"has",t),n}ownKeys(e){return Ee(e,"iterate",W(e)?"length":Kn),Reflect.ownKeys(e)}}class Lh extends yu{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const Jh=new vu,Mh=new Lh,Fh=new vu(!0);const sa=r=>r,yi=r=>Reflect.getPrototypeOf(r);function $h(r,e,t){return function(...n){const s=this.__v_raw,i=oe(s),o=os(i),a=r==="entries"||r===Symbol.iterator&&o,l=r==="keys"&&o,u=s[r](...n),f=t?sa:e?ia:$e;return!e&&Ee(i,"iterate",l?na:Kn),{next(){const{value:d,done:y}=u.next();return y?{value:d,done:y}:{value:a?[f(d[0]),f(d[1])]:f(d),done:y}},[Symbol.iterator](){return this}}}}function vi(r){return function(...e){return r==="delete"?!1:r==="clear"?void 0:this}}function Uh(r,e){const t={get(s){const i=this.__v_raw,o=oe(i),a=oe(s);r||(Vn(s,a)&&Ee(o,"get",s),Ee(o,"get",a));const{has:l}=yi(o),u=e?sa:r?ia:$e;if(l.call(o,s))return u(i.get(s));if(l.call(o,a))return u(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!r&&Ee(oe(s),"iterate",Kn),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=oe(i),a=oe(s);return r||(Vn(s,a)&&Ee(o,"has",s),Ee(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,l=oe(a),u=e?sa:r?ia:$e;return!r&&Ee(l,"iterate",Kn),a.forEach((f,d)=>s.call(i,u(f),u(d),o))}};return Me(t,r?{add:vi("add"),set:vi("set"),delete:vi("delete"),clear:vi("clear")}:{add(s){!e&&!At(s)&&!ds(s)&&(s=oe(s));const i=oe(this);return yi(i).has.call(i,s)||(i.add(s),tn(i,"add",s,s)),this},set(s,i){!e&&!At(i)&&!ds(i)&&(i=oe(i));const o=oe(this),{has:a,get:l}=yi(o);let u=a.call(o,s);u||(s=oe(s),u=a.call(o,s));const f=l.call(o,s);return o.set(s,i),u?Vn(i,f)&&tn(o,"set",s,i):tn(o,"add",s,i),this},delete(s){const i=oe(this),{has:o,get:a}=yi(i);let l=o.call(i,s);l||(s=oe(s),l=o.call(i,s)),a&&a.call(i,s);const u=i.delete(s);return l&&tn(i,"delete",s,void 0),u},clear(){const s=oe(this),i=s.size!==0,o=s.clear();return i&&tn(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=$h(s,r,e)}),t}function Ya(r,e){const t=Uh(r,e);return(n,s,i)=>s==="__v_isReactive"?!r:s==="__v_isReadonly"?r:s==="__v_raw"?n:Reflect.get(re(t,s)&&s in n?t:n,s,i)}const qh={get:Ya(!1,!1)},Vh={get:Ya(!1,!0)},Kh={get:Ya(!0,!1)};const wu=new WeakMap,bu=new WeakMap,Tu=new WeakMap,zh=new WeakMap;function jh(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Hh(r){return r.__v_skip||!Object.isExtensible(r)?0:jh(vh(r))}function Xa(r){return ds(r)?r:Za(r,!1,Jh,qh,wu)}function Wh(r){return Za(r,!1,Fh,Vh,bu)}function Au(r){return Za(r,!0,Mh,Kh,Tu)}function Za(r,e,t,n,s){if(!ge(r)||r.__v_raw&&!(e&&r.__v_isReactive))return r;const i=s.get(r);if(i)return i;const o=Hh(r);if(o===0)return r;const a=new Proxy(r,o===2?n:t);return s.set(r,a),a}function as(r){return ds(r)?as(r.__v_raw):!!(r&&r.__v_isReactive)}function ds(r){return!!(r&&r.__v_isReadonly)}function At(r){return!!(r&&r.__v_isShallow)}function Qa(r){return r?!!r.__v_raw:!1}function oe(r){const e=r&&r.__v_raw;return e?oe(e):r}function _h(r){return!re(r,"__v_skip")&&Object.isExtensible(r)&&nu(r,"__v_skip",!0),r}const $e=r=>ge(r)?Xa(r):r,ia=r=>ge(r)?Au(r):r;function Je(r){return r?r.__v_isRef===!0:!1}function Gh(r){return Je(r)?r.value:r}const Yh={get:(r,e,t)=>e==="__v_raw"?r:Gh(Reflect.get(r,e,t)),set:(r,e,t,n)=>{const s=r[e];return Je(s)&&!Je(t)?(s.value=t,!0):Reflect.set(r,e,t,n)}};function Su(r){return as(r)?r:new Proxy(r,Yh)}class Xh{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new gu(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=js-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&fe!==this)return lu(this,!0),!0}get value(){const e=this.dep.track();return hu(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Zh(r,e,t=!1){let n,s;return G(r)?n=r:(n=r.get,s=r.set),new Xh(n,s,t)}const wi={},Mi=new WeakMap;let Mn;function Qh(r,e=!1,t=Mn){if(t){let n=Mi.get(t);n||Mi.set(t,n=[]),n.push(r)}}function ed(r,e,t=ce){const{immediate:n,deep:s,once:i,scheduler:o,augmentJob:a,call:l}=t,u=J=>s?J:At(J)||s===!1||s===0?rn(J,1):rn(J);let f,d,y,p,b=!1,S=!1;if(Je(r)?(d=()=>r.value,b=At(r)):as(r)?(d=()=>u(r),b=!0):W(r)?(S=!0,b=r.some(J=>as(J)||At(J)),d=()=>r.map(J=>{if(Je(J))return J.value;if(as(J))return u(J);if(G(J))return l?l(J,2):J()})):G(r)?e?d=l?()=>l(r,2):r:d=()=>{if(y){On();try{y()}finally{Dn()}}const J=Mn;Mn=f;try{return l?l(r,3,[p]):r(p)}finally{Mn=J}}:d=jt,e&&s){const J=d,q=s===!0?1/0:s;d=()=>rn(J(),q)}const B=Ch(),D=()=>{f.stop(),B&&B.active&&Ka(B.effects,f)};if(i&&e){const J=e;e=(...q)=>{J(...q),D()}}let F=S?new Array(r.length).fill(wi):wi;const V=J=>{if(!(!(f.flags&1)||!f.dirty&&!J))if(e){const q=f.run();if(s||b||(S?q.some((Y,Z)=>Vn(Y,F[Z])):Vn(q,F))){y&&y();const Y=Mn;Mn=f;try{const Z=[q,F===wi?void 0:S&&F[0]===wi?[]:F,p];l?l(e,3,Z):e(...Z),F=q}finally{Mn=Y}}}else f.run()};return a&&a(V),f=new au(d),f.scheduler=o?()=>o(V,!1):V,p=J=>Qh(J,!1,f),y=f.onStop=()=>{const J=Mi.get(f);if(J){if(l)l(J,4);else for(const q of J)q();Mi.delete(f)}},e?n?V(!0):F=f.run():o?o(V.bind(null,!0),!0):f.run(),D.pause=f.pause.bind(f),D.resume=f.resume.bind(f),D.stop=D,D}function rn(r,e=1/0,t){if(e<=0||!ge(r)||r.__v_skip||(t=t||new Set,t.has(r)))return r;if(t.add(r),e--,Je(r))rn(r.value,e,t);else if(W(r))for(let n=0;n<r.length;n++)rn(r[n],e,t);else if(Zl(r)||os(r))r.forEach(n=>{rn(n,e,t)});else if(tu(r)){for(const n in r)rn(r[n],e,t);for(const n of Object.getOwnPropertySymbols(r))Object.prototype.propertyIsEnumerable.call(r,n)&&rn(r[n],e,t)}return r}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function ai(r,e,t,n){try{return n?r(...n):r()}catch(s){wo(s,e,t)}}function Wt(r,e,t,n){if(G(r)){const s=ai(r,e,t,n);return s&&Ql(s)&&s.catch(i=>{wo(i,e,t)}),s}if(W(r)){const s=[];for(let i=0;i<r.length;i++)s.push(Wt(r[i],e,t,n));return s}}function wo(r,e,t,n=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||ce;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const f=a.ec;if(f){for(let d=0;d<f.length;d++)if(f[d](r,l,u)===!1)return}a=a.parent}if(i){On(),ai(i,null,10,[r,l,u]),Dn();return}}td(r,t,s,n,o)}function td(r,e,t,n=!0,s=!1){if(s)throw r;console.error(r)}const Re=[];let Ot=-1;const cs=[];let wn=null,es=0;const Iu=Promise.resolve();let Fi=null;function rd(r){const e=Fi||Iu;return r?e.then(this?r.bind(this):r):e}function nd(r){let e=Ot+1,t=Re.length;for(;e<t;){const n=e+t>>>1,s=Re[n],i=Ws(s);i<r||i===r&&s.flags&2?e=n+1:t=n}return e}function ec(r){if(!(r.flags&1)){const e=Ws(r),t=Re[Re.length-1];!t||!(r.flags&2)&&e>=Ws(t)?Re.push(r):Re.splice(nd(e),0,r),r.flags|=1,xu()}}function xu(){Fi||(Fi=Iu.then(Eu))}function sd(r){W(r)?cs.push(...r):wn&&r.id===-1?wn.splice(es+1,0,r):r.flags&1||(cs.push(r),r.flags|=1),xu()}function Rc(r,e,t=Ot+1){for(;t<Re.length;t++){const n=Re[t];if(n&&n.flags&2){if(r&&n.id!==r.uid)continue;Re.splice(t,1),t--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function ku(r){if(cs.length){const e=[...new Set(cs)].sort((t,n)=>Ws(t)-Ws(n));if(cs.length=0,wn){wn.push(...e);return}for(wn=e,es=0;es<wn.length;es++){const t=wn[es];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}wn=null,es=0}}const Ws=r=>r.id==null?r.flags&2?-1:1/0:r.id;function Eu(r){try{for(Ot=0;Ot<Re.length;Ot++){const e=Re[Ot];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),ai(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Ot<Re.length;Ot++){const e=Re[Ot];e&&(e.flags&=-2)}Ot=-1,Re.length=0,ku(),Fi=null,(Re.length||cs.length)&&Eu()}}let ft=null,Cu=null;function $i(r){const e=ft;return ft=r,Cu=r&&r.type.__scopeId||null,e}function id(r,e=ft,t){if(!e||r._n)return r;const n=(...s)=>{n._d&&jc(-1);const i=$i(e);let o;try{o=r(...s)}finally{$i(i),n._d&&jc(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function Lc(r,e){if(ft===null)return r;const t=So(ft),n=r.dirs||(r.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,l=ce]=e[s];i&&(G(i)&&(i={mounted:i,updated:i}),i.deep&&rn(o),n.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return r}function Ln(r,e,t,n){const s=r.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[n];l&&(On(),Wt(l,t,8,[r.el,a,r,e]),Dn())}}const od=Symbol("_vte"),ad=r=>r.__isTeleport;function tc(r,e){r.shapeFlag&6&&r.component?(r.transition=e,tc(r.component.subTree,e)):r.shapeFlag&128?(r.ssContent.transition=e.clone(r.ssContent),r.ssFallback.transition=e.clone(r.ssFallback)):r.transition=e}function Nu(r){r.ids=[r.ids[0]+r.ids[2]+++"-",0,0]}function Ui(r,e,t,n,s=!1){if(W(r)){r.forEach((b,S)=>Ui(b,e&&(W(e)?e[S]:e),t,n,s));return}if(Ms(n)&&!s){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Ui(r,e,t,n.component.subTree);return}const i=n.shapeFlag&4?So(n.component):n.el,o=s?null:i,{i:a,r:l}=r,u=e&&e.r,f=a.refs===ce?a.refs={}:a.refs,d=a.setupState,y=oe(d),p=d===ce?()=>!1:b=>re(y,b);if(u!=null&&u!==l&&(Te(u)?(f[u]=null,p(u)&&(d[u]=null)):Je(u)&&(u.value=null)),G(l))ai(l,a,12,[o,f]);else{const b=Te(l),S=Je(l);if(b||S){const B=()=>{if(r.f){const D=b?p(l)?d[l]:f[l]:l.value;s?W(D)&&Ka(D,i):W(D)?D.includes(i)||D.push(i):b?(f[l]=[i],p(l)&&(d[l]=f[l])):(l.value=[i],r.k&&(f[r.k]=l.value))}else b?(f[l]=o,p(l)&&(d[l]=o)):S&&(l.value=o,r.k&&(f[r.k]=o))};o?(B.id=-1,He(B,t)):B()}}}yo().requestIdleCallback;yo().cancelIdleCallback;const Ms=r=>!!r.type.__asyncLoader,Pu=r=>r.type.__isKeepAlive;function cd(r,e){Ou(r,"a",e)}function ld(r,e){Ou(r,"da",e)}function Ou(r,e,t=Le){const n=r.__wdc||(r.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return r()});if(bo(e,n,t),t){let s=t.parent;for(;s&&s.parent;)Pu(s.parent.vnode)&&ud(n,e,t,s),s=s.parent}}function ud(r,e,t,n){const s=bo(e,r,n,!0);Du(()=>{Ka(n[e],s)},t)}function bo(r,e,t=Le,n=!1){if(t){const s=t[r]||(t[r]=[]),i=e.__weh||(e.__weh=(...o)=>{On();const a=ci(t),l=Wt(e,t,r,o);return a(),Dn(),l});return n?s.unshift(i):s.push(i),i}}const hn=r=>(e,t=Le)=>{(!Ys||r==="sp")&&bo(r,(...n)=>e(...n),t)},fd=hn("bm"),hd=hn("m"),dd=hn("bu"),gd=hn("u"),md=hn("bum"),Du=hn("um"),pd=hn("sp"),yd=hn("rtg"),vd=hn("rtc");function wd(r,e=Le){bo("ec",r,e)}const bd=Symbol.for("v-ndc");function Jc(r,e,t,n){let s;const i=t,o=W(r);if(o||Te(r)){const a=o&&as(r);let l=!1;a&&(l=!At(r),r=vo(r)),s=new Array(r.length);for(let u=0,f=r.length;u<f;u++)s[u]=e(l?$e(r[u]):r[u],u,void 0,i)}else if(typeof r=="number"){s=new Array(r);for(let a=0;a<r;a++)s[a]=e(a+1,a,void 0,i)}else if(ge(r))if(r[Symbol.iterator])s=Array.from(r,(a,l)=>e(a,l,void 0,i));else{const a=Object.keys(r);s=new Array(a.length);for(let l=0,u=a.length;l<u;l++){const f=a[l];s[l]=e(r[f],f,l,i)}}else s=[];return s}const oa=r=>r?ef(r)?So(r):oa(r.parent):null,Fs=Me(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>oa(r.parent),$root:r=>oa(r.root),$host:r=>r.ce,$emit:r=>r.emit,$options:r=>Ru(r),$forceUpdate:r=>r.f||(r.f=()=>{ec(r.update)}),$nextTick:r=>r.n||(r.n=rd.bind(r.proxy)),$watch:r=>Vd.bind(r)}),Mo=(r,e)=>r!==ce&&!r.__isScriptSetup&&re(r,e),Td={get({_:r},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:n,data:s,props:i,accessCache:o,type:a,appContext:l}=r;let u;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return n[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(Mo(n,e))return o[e]=1,n[e];if(s!==ce&&re(s,e))return o[e]=2,s[e];if((u=r.propsOptions[0])&&re(u,e))return o[e]=3,i[e];if(t!==ce&&re(t,e))return o[e]=4,t[e];aa&&(o[e]=0)}}const f=Fs[e];let d,y;if(f)return e==="$attrs"&&Ee(r.attrs,"get",""),f(r);if((d=a.__cssModules)&&(d=d[e]))return d;if(t!==ce&&re(t,e))return o[e]=4,t[e];if(y=l.config.globalProperties,re(y,e))return y[e]},set({_:r},e,t){const{data:n,setupState:s,ctx:i}=r;return Mo(s,e)?(s[e]=t,!0):n!==ce&&re(n,e)?(n[e]=t,!0):re(r.props,e)||e[0]==="$"&&e.slice(1)in r?!1:(i[e]=t,!0)},has({_:{data:r,setupState:e,accessCache:t,ctx:n,appContext:s,propsOptions:i}},o){let a;return!!t[o]||r!==ce&&re(r,o)||Mo(e,o)||(a=i[0])&&re(a,o)||re(n,o)||re(Fs,o)||re(s.config.globalProperties,o)},defineProperty(r,e,t){return t.get!=null?r._.accessCache[e]=0:re(t,"value")&&this.set(r,e,t.value,null),Reflect.defineProperty(r,e,t)}};function Mc(r){return W(r)?r.reduce((e,t)=>(e[t]=null,e),{}):r}let aa=!0;function Ad(r){const e=Ru(r),t=r.proxy,n=r.ctx;aa=!1,e.beforeCreate&&Fc(e.beforeCreate,r,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:u,created:f,beforeMount:d,mounted:y,beforeUpdate:p,updated:b,activated:S,deactivated:B,beforeDestroy:D,beforeUnmount:F,destroyed:V,unmounted:J,render:q,renderTracked:Y,renderTriggered:Z,errorCaptured:se,serverPrefetch:Ie,expose:Se,inheritAttrs:Qe,components:Gt,directives:gi,filters:Po}=e;if(u&&Sd(u,n,null),o)for(const de in o){const le=o[de];G(le)&&(n[de]=le.bind(t))}if(s){const de=s.call(t,t);ge(de)&&(r.data=Xa(de))}if(aa=!0,i)for(const de in i){const le=i[de],Bn=G(le)?le.bind(t,t):G(le.get)?le.get.bind(t,t):jt,mi=!G(le)&&G(le.set)?le.set.bind(t):jt,Rn=lg({get:Bn,set:mi});Object.defineProperty(n,de,{enumerable:!0,configurable:!0,get:()=>Rn.value,set:kt=>Rn.value=kt})}if(a)for(const de in a)Bu(a[de],n,t,de);if(l){const de=G(l)?l.call(t):l;Reflect.ownKeys(de).forEach(le=>{Nd(le,de[le])})}f&&Fc(f,r,"c");function Pe(de,le){W(le)?le.forEach(Bn=>de(Bn.bind(t))):le&&de(le.bind(t))}if(Pe(fd,d),Pe(hd,y),Pe(dd,p),Pe(gd,b),Pe(cd,S),Pe(ld,B),Pe(wd,se),Pe(vd,Y),Pe(yd,Z),Pe(md,F),Pe(Du,J),Pe(pd,Ie),W(Se))if(Se.length){const de=r.exposed||(r.exposed={});Se.forEach(le=>{Object.defineProperty(de,le,{get:()=>t[le],set:Bn=>t[le]=Bn})})}else r.exposed||(r.exposed={});q&&r.render===jt&&(r.render=q),Qe!=null&&(r.inheritAttrs=Qe),Gt&&(r.components=Gt),gi&&(r.directives=gi),Ie&&Nu(r)}function Sd(r,e,t=jt){W(r)&&(r=ca(r));for(const n in r){const s=r[n];let i;ge(s)?"default"in s?i=Ei(s.from||n,s.default,!0):i=Ei(s.from||n):i=Ei(s),Je(i)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[n]=i}}function Fc(r,e,t){Wt(W(r)?r.map(n=>n.bind(e.proxy)):r.bind(e.proxy),e,t)}function Bu(r,e,t,n){let s=n.includes(".")?_u(t,n):()=>t[n];if(Te(r)){const i=e[r];G(i)&&$o(s,i)}else if(G(r))$o(s,r.bind(t));else if(ge(r))if(W(r))r.forEach(i=>Bu(i,e,t,n));else{const i=G(r.handler)?r.handler.bind(t):e[r.handler];G(i)&&$o(s,i,r)}}function Ru(r){const e=r.type,{mixins:t,extends:n}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=r.appContext,a=i.get(e);let l;return a?l=a:!s.length&&!t&&!n?l=e:(l={},s.length&&s.forEach(u=>qi(l,u,o,!0)),qi(l,e,o)),ge(e)&&i.set(e,l),l}function qi(r,e,t,n=!1){const{mixins:s,extends:i}=e;i&&qi(r,i,t,!0),s&&s.forEach(o=>qi(r,o,t,!0));for(const o in e)if(!(n&&o==="expose")){const a=Id[o]||t&&t[o];r[o]=a?a(r[o],e[o]):e[o]}return r}const Id={data:$c,props:Uc,emits:Uc,methods:Ds,computed:Ds,beforeCreate:Oe,created:Oe,beforeMount:Oe,mounted:Oe,beforeUpdate:Oe,updated:Oe,beforeDestroy:Oe,beforeUnmount:Oe,destroyed:Oe,unmounted:Oe,activated:Oe,deactivated:Oe,errorCaptured:Oe,serverPrefetch:Oe,components:Ds,directives:Ds,watch:kd,provide:$c,inject:xd};function $c(r,e){return e?r?function(){return Me(G(r)?r.call(this,this):r,G(e)?e.call(this,this):e)}:e:r}function xd(r,e){return Ds(ca(r),ca(e))}function ca(r){if(W(r)){const e={};for(let t=0;t<r.length;t++)e[r[t]]=r[t];return e}return r}function Oe(r,e){return r?[...new Set([].concat(r,e))]:e}function Ds(r,e){return r?Me(Object.create(null),r,e):e}function Uc(r,e){return r?W(r)&&W(e)?[...new Set([...r,...e])]:Me(Object.create(null),Mc(r),Mc(e??{})):e}function kd(r,e){if(!r)return e;if(!e)return r;const t=Me(Object.create(null),r);for(const n in e)t[n]=Oe(r[n],e[n]);return t}function Lu(){return{app:null,config:{isNativeTag:ph,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ed=0;function Cd(r,e){return function(n,s=null){G(n)||(n=Me({},n)),s!=null&&!ge(s)&&(s=null);const i=Lu(),o=new WeakSet,a=[];let l=!1;const u=i.app={_uid:Ed++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:ug,get config(){return i.config},set config(f){},use(f,...d){return o.has(f)||(f&&G(f.install)?(o.add(f),f.install(u,...d)):G(f)&&(o.add(f),f(u,...d))),u},mixin(f){return i.mixins.includes(f)||i.mixins.push(f),u},component(f,d){return d?(i.components[f]=d,u):i.components[f]},directive(f,d){return d?(i.directives[f]=d,u):i.directives[f]},mount(f,d,y){if(!l){const p=u._ceVNode||zn(n,s);return p.appContext=i,y===!0?y="svg":y===!1&&(y=void 0),r(p,f,y),l=!0,u._container=f,f.__vue_app__=u,So(p.component)}},onUnmount(f){a.push(f)},unmount(){l&&(Wt(a,u._instance,16),r(null,u._container),delete u._container.__vue_app__)},provide(f,d){return i.provides[f]=d,u},runWithContext(f){const d=ls;ls=u;try{return f()}finally{ls=d}}};return u}}let ls=null;function Nd(r,e){if(Le){let t=Le.provides;const n=Le.parent&&Le.parent.provides;n===t&&(t=Le.provides=Object.create(n)),t[r]=e}}function Ei(r,e,t=!1){const n=Le||ft;if(n||ls){const s=ls?ls._context.provides:n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&r in s)return s[r];if(arguments.length>1)return t&&G(e)?e.call(n&&n.proxy):e}}const Ju={},Mu=()=>Object.create(Ju),Fu=r=>Object.getPrototypeOf(r)===Ju;function Pd(r,e,t,n=!1){const s={},i=Mu();r.propsDefaults=Object.create(null),$u(r,e,s,i);for(const o in r.propsOptions[0])o in s||(s[o]=void 0);t?r.props=n?s:Wh(s):r.type.props?r.props=s:r.props=i,r.attrs=i}function Od(r,e,t,n){const{props:s,attrs:i,vnode:{patchFlag:o}}=r,a=oe(s),[l]=r.propsOptions;let u=!1;if((n||o>0)&&!(o&16)){if(o&8){const f=r.vnode.dynamicProps;for(let d=0;d<f.length;d++){let y=f[d];if(To(r.emitsOptions,y))continue;const p=e[y];if(l)if(re(i,y))p!==i[y]&&(i[y]=p,u=!0);else{const b=xn(y);s[b]=la(l,a,b,p,r,!1)}else p!==i[y]&&(i[y]=p,u=!0)}}}else{$u(r,e,s,i)&&(u=!0);let f;for(const d in a)(!e||!re(e,d)&&((f=Pn(d))===d||!re(e,f)))&&(l?t&&(t[d]!==void 0||t[f]!==void 0)&&(s[d]=la(l,a,d,void 0,r,!0)):delete s[d]);if(i!==a)for(const d in i)(!e||!re(e,d))&&(delete i[d],u=!0)}u&&tn(r.attrs,"set","")}function $u(r,e,t,n){const[s,i]=r.propsOptions;let o=!1,a;if(e)for(let l in e){if(Rs(l))continue;const u=e[l];let f;s&&re(s,f=xn(l))?!i||!i.includes(f)?t[f]=u:(a||(a={}))[f]=u:To(r.emitsOptions,l)||(!(l in n)||u!==n[l])&&(n[l]=u,o=!0)}if(i){const l=oe(t),u=a||ce;for(let f=0;f<i.length;f++){const d=i[f];t[d]=la(s,l,d,u[d],r,!re(u,d))}}return o}function la(r,e,t,n,s,i){const o=r[t];if(o!=null){const a=re(o,"default");if(a&&n===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&G(l)){const{propsDefaults:u}=s;if(t in u)n=u[t];else{const f=ci(s);n=u[t]=l.call(null,e),f()}}else n=l;s.ce&&s.ce._setProp(t,n)}o[0]&&(i&&!a?n=!1:o[1]&&(n===""||n===Pn(t))&&(n=!0))}return n}const Dd=new WeakMap;function Uu(r,e,t=!1){const n=t?Dd:e.propsCache,s=n.get(r);if(s)return s;const i=r.props,o={},a=[];let l=!1;if(!G(r)){const f=d=>{l=!0;const[y,p]=Uu(d,e,!0);Me(o,y),p&&a.push(...p)};!t&&e.mixins.length&&e.mixins.forEach(f),r.extends&&f(r.extends),r.mixins&&r.mixins.forEach(f)}if(!i&&!l)return ge(r)&&n.set(r,is),is;if(W(i))for(let f=0;f<i.length;f++){const d=xn(i[f]);qc(d)&&(o[d]=ce)}else if(i)for(const f in i){const d=xn(f);if(qc(d)){const y=i[f],p=o[d]=W(y)||G(y)?{type:y}:Me({},y),b=p.type;let S=!1,B=!0;if(W(b))for(let D=0;D<b.length;++D){const F=b[D],V=G(F)&&F.name;if(V==="Boolean"){S=!0;break}else V==="String"&&(B=!1)}else S=G(b)&&b.name==="Boolean";p[0]=S,p[1]=B,(S||re(p,"default"))&&a.push(d)}}const u=[o,a];return ge(r)&&n.set(r,u),u}function qc(r){return r[0]!=="$"&&!Rs(r)}const qu=r=>r[0]==="_"||r==="$stable",rc=r=>W(r)?r.map(Rt):[Rt(r)],Bd=(r,e,t)=>{if(e._n)return e;const n=id((...s)=>rc(e(...s)),t);return n._c=!1,n},Vu=(r,e,t)=>{const n=r._ctx;for(const s in r){if(qu(s))continue;const i=r[s];if(G(i))e[s]=Bd(s,i,n);else if(i!=null){const o=rc(i);e[s]=()=>o}}},Ku=(r,e)=>{const t=rc(e);r.slots.default=()=>t},zu=(r,e,t)=>{for(const n in e)(t||n!=="_")&&(r[n]=e[n])},Rd=(r,e,t)=>{const n=r.slots=Mu();if(r.vnode.shapeFlag&32){const s=e._;s?(zu(n,e,t),t&&nu(n,"_",s,!0)):Vu(e,n)}else e&&Ku(r,e)},Ld=(r,e,t)=>{const{vnode:n,slots:s}=r;let i=!0,o=ce;if(n.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:zu(s,e,t):(i=!e.$stable,Vu(e,s)),o=e}else e&&(Ku(r,e),o={default:1});if(i)for(const a in s)!qu(a)&&o[a]==null&&delete s[a]},He=Gd;function Jd(r){return Md(r)}function Md(r,e){const t=yo();t.__VUE__=!0;const{insert:n,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:u,setElementText:f,parentNode:d,nextSibling:y,setScopeId:p=jt,insertStaticContent:b}=r,S=(g,m,A,E=null,I=null,x=null,R=void 0,P=null,N=!!m.dynamicChildren)=>{if(g===m)return;g&&!Cs(g,m)&&(E=pi(g),kt(g,I,x,!0),g=null),m.patchFlag===-2&&(N=!1,m.dynamicChildren=null);const{type:C,ref:j,shapeFlag:L}=m;switch(C){case Ao:B(g,m,A,E);break;case _s:D(g,m,A,E);break;case Uo:g==null&&F(m,A,E,R);break;case et:Gt(g,m,A,E,I,x,R,P,N);break;default:L&1?q(g,m,A,E,I,x,R,P,N):L&6?gi(g,m,A,E,I,x,R,P,N):(L&64||L&128)&&C.process(g,m,A,E,I,x,R,P,N,xs)}j!=null&&I&&Ui(j,g&&g.ref,x,m||g,!m)},B=(g,m,A,E)=>{if(g==null)n(m.el=a(m.children),A,E);else{const I=m.el=g.el;m.children!==g.children&&u(I,m.children)}},D=(g,m,A,E)=>{g==null?n(m.el=l(m.children||""),A,E):m.el=g.el},F=(g,m,A,E)=>{[g.el,g.anchor]=b(g.children,m,A,E,g.el,g.anchor)},V=({el:g,anchor:m},A,E)=>{let I;for(;g&&g!==m;)I=y(g),n(g,A,E),g=I;n(m,A,E)},J=({el:g,anchor:m})=>{let A;for(;g&&g!==m;)A=y(g),s(g),g=A;s(m)},q=(g,m,A,E,I,x,R,P,N)=>{m.type==="svg"?R="svg":m.type==="math"&&(R="mathml"),g==null?Y(m,A,E,I,x,R,P,N):Ie(g,m,I,x,R,P,N)},Y=(g,m,A,E,I,x,R,P)=>{let N,C;const{props:j,shapeFlag:L,transition:z,dirs:H}=g;if(N=g.el=o(g.type,x,j&&j.is,j),L&8?f(N,g.children):L&16&&se(g.children,N,null,E,I,Fo(g,x),R,P),H&&Ln(g,null,E,"created"),Z(N,g,g.scopeId,R,E),j){for(const ue in j)ue!=="value"&&!Rs(ue)&&i(N,ue,null,j[ue],x,E);"value"in j&&i(N,"value",null,j.value,x),(C=j.onVnodeBeforeMount)&&Pt(C,E,g)}H&&Ln(g,null,E,"beforeMount");const ee=Fd(I,z);ee&&z.beforeEnter(N),n(N,m,A),((C=j&&j.onVnodeMounted)||ee||H)&&He(()=>{C&&Pt(C,E,g),ee&&z.enter(N),H&&Ln(g,null,E,"mounted")},I)},Z=(g,m,A,E,I)=>{if(A&&p(g,A),E)for(let x=0;x<E.length;x++)p(g,E[x]);if(I){let x=I.subTree;if(m===x||Yu(x.type)&&(x.ssContent===m||x.ssFallback===m)){const R=I.vnode;Z(g,R,R.scopeId,R.slotScopeIds,I.parent)}}},se=(g,m,A,E,I,x,R,P,N=0)=>{for(let C=N;C<g.length;C++){const j=g[C]=P?bn(g[C]):Rt(g[C]);S(null,j,m,A,E,I,x,R,P)}},Ie=(g,m,A,E,I,x,R)=>{const P=m.el=g.el;let{patchFlag:N,dynamicChildren:C,dirs:j}=m;N|=g.patchFlag&16;const L=g.props||ce,z=m.props||ce;let H;if(A&&Jn(A,!1),(H=z.onVnodeBeforeUpdate)&&Pt(H,A,m,g),j&&Ln(m,g,A,"beforeUpdate"),A&&Jn(A,!0),(L.innerHTML&&z.innerHTML==null||L.textContent&&z.textContent==null)&&f(P,""),C?Se(g.dynamicChildren,C,P,A,E,Fo(m,I),x):R||le(g,m,P,null,A,E,Fo(m,I),x,!1),N>0){if(N&16)Qe(P,L,z,A,I);else if(N&2&&L.class!==z.class&&i(P,"class",null,z.class,I),N&4&&i(P,"style",L.style,z.style,I),N&8){const ee=m.dynamicProps;for(let ue=0;ue<ee.length;ue++){const ie=ee[ue],ze=L[ie],Fe=z[ie];(Fe!==ze||ie==="value")&&i(P,ie,ze,Fe,I,A)}}N&1&&g.children!==m.children&&f(P,m.children)}else!R&&C==null&&Qe(P,L,z,A,I);((H=z.onVnodeUpdated)||j)&&He(()=>{H&&Pt(H,A,m,g),j&&Ln(m,g,A,"updated")},E)},Se=(g,m,A,E,I,x,R)=>{for(let P=0;P<m.length;P++){const N=g[P],C=m[P],j=N.el&&(N.type===et||!Cs(N,C)||N.shapeFlag&70)?d(N.el):A;S(N,C,j,null,E,I,x,R,!0)}},Qe=(g,m,A,E,I)=>{if(m!==A){if(m!==ce)for(const x in m)!Rs(x)&&!(x in A)&&i(g,x,m[x],null,I,E);for(const x in A){if(Rs(x))continue;const R=A[x],P=m[x];R!==P&&x!=="value"&&i(g,x,P,R,I,E)}"value"in A&&i(g,"value",m.value,A.value,I)}},Gt=(g,m,A,E,I,x,R,P,N)=>{const C=m.el=g?g.el:a(""),j=m.anchor=g?g.anchor:a("");let{patchFlag:L,dynamicChildren:z,slotScopeIds:H}=m;H&&(P=P?P.concat(H):H),g==null?(n(C,A,E),n(j,A,E),se(m.children||[],A,j,I,x,R,P,N)):L>0&&L&64&&z&&g.dynamicChildren?(Se(g.dynamicChildren,z,A,I,x,R,P),(m.key!=null||I&&m===I.subTree)&&ju(g,m,!0)):le(g,m,A,j,I,x,R,P,N)},gi=(g,m,A,E,I,x,R,P,N)=>{m.slotScopeIds=P,g==null?m.shapeFlag&512?I.ctx.activate(m,A,E,R,N):Po(m,A,E,I,x,R,N):kc(g,m,N)},Po=(g,m,A,E,I,x,R)=>{const P=g.component=ng(g,E,I);if(Pu(g)&&(P.ctx.renderer=xs),sg(P,!1,R),P.asyncDep){if(I&&I.registerDep(P,Pe,R),!g.el){const N=P.subTree=zn(_s);D(null,N,m,A)}}else Pe(P,g,m,A,I,x,R)},kc=(g,m,A)=>{const E=m.component=g.component;if(Wd(g,m,A))if(E.asyncDep&&!E.asyncResolved){de(E,m,A);return}else E.next=m,E.update();else m.el=g.el,E.vnode=m},Pe=(g,m,A,E,I,x,R)=>{const P=()=>{if(g.isMounted){let{next:L,bu:z,u:H,parent:ee,vnode:ue}=g;{const Ct=Hu(g);if(Ct){L&&(L.el=ue.el,de(g,L,R)),Ct.asyncDep.then(()=>{g.isUnmounted||P()});return}}let ie=L,ze;Jn(g,!1),L?(L.el=ue.el,de(g,L,R)):L=ue,z&&ki(z),(ze=L.props&&L.props.onVnodeBeforeUpdate)&&Pt(ze,ee,L,ue),Jn(g,!0);const Fe=Kc(g),Et=g.subTree;g.subTree=Fe,S(Et,Fe,d(Et.el),pi(Et),g,I,x),L.el=Fe.el,ie===null&&_d(g,Fe.el),H&&He(H,I),(ze=L.props&&L.props.onVnodeUpdated)&&He(()=>Pt(ze,ee,L,ue),I)}else{let L;const{el:z,props:H}=m,{bm:ee,m:ue,parent:ie,root:ze,type:Fe}=g,Et=Ms(m);Jn(g,!1),ee&&ki(ee),!Et&&(L=H&&H.onVnodeBeforeMount)&&Pt(L,ie,m),Jn(g,!0);{ze.ce&&ze.ce._injectChildStyle(Fe);const Ct=g.subTree=Kc(g);S(null,Ct,A,E,g,I,x),m.el=Ct.el}if(ue&&He(ue,I),!Et&&(L=H&&H.onVnodeMounted)){const Ct=m;He(()=>Pt(L,ie,Ct),I)}(m.shapeFlag&256||ie&&Ms(ie.vnode)&&ie.vnode.shapeFlag&256)&&g.a&&He(g.a,I),g.isMounted=!0,m=A=E=null}};g.scope.on();const N=g.effect=new au(P);g.scope.off();const C=g.update=N.run.bind(N),j=g.job=N.runIfDirty.bind(N);j.i=g,j.id=g.uid,N.scheduler=()=>ec(j),Jn(g,!0),C()},de=(g,m,A)=>{m.component=g;const E=g.vnode.props;g.vnode=m,g.next=null,Od(g,m.props,E,A),Ld(g,m.children,A),On(),Rc(g),Dn()},le=(g,m,A,E,I,x,R,P,N=!1)=>{const C=g&&g.children,j=g?g.shapeFlag:0,L=m.children,{patchFlag:z,shapeFlag:H}=m;if(z>0){if(z&128){mi(C,L,A,E,I,x,R,P,N);return}else if(z&256){Bn(C,L,A,E,I,x,R,P,N);return}}H&8?(j&16&&Is(C,I,x),L!==C&&f(A,L)):j&16?H&16?mi(C,L,A,E,I,x,R,P,N):Is(C,I,x,!0):(j&8&&f(A,""),H&16&&se(L,A,E,I,x,R,P,N))},Bn=(g,m,A,E,I,x,R,P,N)=>{g=g||is,m=m||is;const C=g.length,j=m.length,L=Math.min(C,j);let z;for(z=0;z<L;z++){const H=m[z]=N?bn(m[z]):Rt(m[z]);S(g[z],H,A,null,I,x,R,P,N)}C>j?Is(g,I,x,!0,!1,L):se(m,A,E,I,x,R,P,N,L)},mi=(g,m,A,E,I,x,R,P,N)=>{let C=0;const j=m.length;let L=g.length-1,z=j-1;for(;C<=L&&C<=z;){const H=g[C],ee=m[C]=N?bn(m[C]):Rt(m[C]);if(Cs(H,ee))S(H,ee,A,null,I,x,R,P,N);else break;C++}for(;C<=L&&C<=z;){const H=g[L],ee=m[z]=N?bn(m[z]):Rt(m[z]);if(Cs(H,ee))S(H,ee,A,null,I,x,R,P,N);else break;L--,z--}if(C>L){if(C<=z){const H=z+1,ee=H<j?m[H].el:E;for(;C<=z;)S(null,m[C]=N?bn(m[C]):Rt(m[C]),A,ee,I,x,R,P,N),C++}}else if(C>z)for(;C<=L;)kt(g[C],I,x,!0),C++;else{const H=C,ee=C,ue=new Map;for(C=ee;C<=z;C++){const je=m[C]=N?bn(m[C]):Rt(m[C]);je.key!=null&&ue.set(je.key,C)}let ie,ze=0;const Fe=z-ee+1;let Et=!1,Ct=0;const ks=new Array(Fe);for(C=0;C<Fe;C++)ks[C]=0;for(C=H;C<=L;C++){const je=g[C];if(ze>=Fe){kt(je,I,x,!0);continue}let Nt;if(je.key!=null)Nt=ue.get(je.key);else for(ie=ee;ie<=z;ie++)if(ks[ie-ee]===0&&Cs(je,m[ie])){Nt=ie;break}Nt===void 0?kt(je,I,x,!0):(ks[Nt-ee]=C+1,Nt>=Ct?Ct=Nt:Et=!0,S(je,m[Nt],A,null,I,x,R,P,N),ze++)}const Nc=Et?$d(ks):is;for(ie=Nc.length-1,C=Fe-1;C>=0;C--){const je=ee+C,Nt=m[je],Pc=je+1<j?m[je+1].el:E;ks[C]===0?S(null,Nt,A,Pc,I,x,R,P,N):Et&&(ie<0||C!==Nc[ie]?Rn(Nt,A,Pc,2):ie--)}}},Rn=(g,m,A,E,I=null)=>{const{el:x,type:R,transition:P,children:N,shapeFlag:C}=g;if(C&6){Rn(g.component.subTree,m,A,E);return}if(C&128){g.suspense.move(m,A,E);return}if(C&64){R.move(g,m,A,xs);return}if(R===et){n(x,m,A);for(let L=0;L<N.length;L++)Rn(N[L],m,A,E);n(g.anchor,m,A);return}if(R===Uo){V(g,m,A);return}if(E!==2&&C&1&&P)if(E===0)P.beforeEnter(x),n(x,m,A),He(()=>P.enter(x),I);else{const{leave:L,delayLeave:z,afterLeave:H}=P,ee=()=>n(x,m,A),ue=()=>{L(x,()=>{ee(),H&&H()})};z?z(x,ee,ue):ue()}else n(x,m,A)},kt=(g,m,A,E=!1,I=!1)=>{const{type:x,props:R,ref:P,children:N,dynamicChildren:C,shapeFlag:j,patchFlag:L,dirs:z,cacheIndex:H}=g;if(L===-2&&(I=!1),P!=null&&Ui(P,null,A,g,!0),H!=null&&(m.renderCache[H]=void 0),j&256){m.ctx.deactivate(g);return}const ee=j&1&&z,ue=!Ms(g);let ie;if(ue&&(ie=R&&R.onVnodeBeforeUnmount)&&Pt(ie,m,g),j&6)dh(g.component,A,E);else{if(j&128){g.suspense.unmount(A,E);return}ee&&Ln(g,null,m,"beforeUnmount"),j&64?g.type.remove(g,m,A,xs,E):C&&!C.hasOnce&&(x!==et||L>0&&L&64)?Is(C,m,A,!1,!0):(x===et&&L&384||!I&&j&16)&&Is(N,m,A),E&&Ec(g)}(ue&&(ie=R&&R.onVnodeUnmounted)||ee)&&He(()=>{ie&&Pt(ie,m,g),ee&&Ln(g,null,m,"unmounted")},A)},Ec=g=>{const{type:m,el:A,anchor:E,transition:I}=g;if(m===et){hh(A,E);return}if(m===Uo){J(g);return}const x=()=>{s(A),I&&!I.persisted&&I.afterLeave&&I.afterLeave()};if(g.shapeFlag&1&&I&&!I.persisted){const{leave:R,delayLeave:P}=I,N=()=>R(A,x);P?P(g.el,x,N):N()}else x()},hh=(g,m)=>{let A;for(;g!==m;)A=y(g),s(g),g=A;s(m)},dh=(g,m,A)=>{const{bum:E,scope:I,job:x,subTree:R,um:P,m:N,a:C}=g;Vc(N),Vc(C),E&&ki(E),I.stop(),x&&(x.flags|=8,kt(R,g,m,A)),P&&He(P,m),He(()=>{g.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&g.asyncDep&&!g.asyncResolved&&g.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},Is=(g,m,A,E=!1,I=!1,x=0)=>{for(let R=x;R<g.length;R++)kt(g[R],m,A,E,I)},pi=g=>{if(g.shapeFlag&6)return pi(g.component.subTree);if(g.shapeFlag&128)return g.suspense.next();const m=y(g.anchor||g.el),A=m&&m[od];return A?y(A):m};let Oo=!1;const Cc=(g,m,A)=>{g==null?m._vnode&&kt(m._vnode,null,null,!0):S(m._vnode||null,g,m,null,null,null,A),m._vnode=g,Oo||(Oo=!0,Rc(),ku(),Oo=!1)},xs={p:S,um:kt,m:Rn,r:Ec,mt:Po,mc:se,pc:le,pbc:Se,n:pi,o:r};return{render:Cc,hydrate:void 0,createApp:Cd(Cc)}}function Fo({type:r,props:e},t){return t==="svg"&&r==="foreignObject"||t==="mathml"&&r==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Jn({effect:r,job:e},t){t?(r.flags|=32,e.flags|=4):(r.flags&=-33,e.flags&=-5)}function Fd(r,e){return(!r||r&&!r.pendingBranch)&&e&&!e.persisted}function ju(r,e,t=!1){const n=r.children,s=e.children;if(W(n)&&W(s))for(let i=0;i<n.length;i++){const o=n[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=bn(s[i]),a.el=o.el),!t&&a.patchFlag!==-2&&ju(o,a)),a.type===Ao&&(a.el=o.el)}}function $d(r){const e=r.slice(),t=[0];let n,s,i,o,a;const l=r.length;for(n=0;n<l;n++){const u=r[n];if(u!==0){if(s=t[t.length-1],r[s]<u){e[n]=s,t.push(n);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,r[t[a]]<u?i=a+1:o=a;u<r[t[i]]&&(i>0&&(e[n]=t[i-1]),t[i]=n)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function Hu(r){const e=r.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Hu(e)}function Vc(r){if(r)for(let e=0;e<r.length;e++)r[e].flags|=8}const Ud=Symbol.for("v-scx"),qd=()=>Ei(Ud);function $o(r,e,t){return Wu(r,e,t)}function Wu(r,e,t=ce){const{immediate:n,deep:s,flush:i,once:o}=t,a=Me({},t),l=e&&n||!e&&i!=="post";let u;if(Ys){if(i==="sync"){const p=qd();u=p.__watcherHandles||(p.__watcherHandles=[])}else if(!l){const p=()=>{};return p.stop=jt,p.resume=jt,p.pause=jt,p}}const f=Le;a.call=(p,b,S)=>Wt(p,f,b,S);let d=!1;i==="post"?a.scheduler=p=>{He(p,f&&f.suspense)}:i!=="sync"&&(d=!0,a.scheduler=(p,b)=>{b?p():ec(p)}),a.augmentJob=p=>{e&&(p.flags|=4),d&&(p.flags|=2,f&&(p.id=f.uid,p.i=f))};const y=ed(r,e,a);return Ys&&(u?u.push(y):l&&y()),y}function Vd(r,e,t){const n=this.proxy,s=Te(r)?r.includes(".")?_u(n,r):()=>n[r]:r.bind(n,n);let i;G(e)?i=e:(i=e.handler,t=e);const o=ci(this),a=Wu(s,i.bind(n),t);return o(),a}function _u(r,e){const t=e.split(".");return()=>{let n=r;for(let s=0;s<t.length&&n;s++)n=n[t[s]];return n}}const Kd=(r,e)=>e==="modelValue"||e==="model-value"?r.modelModifiers:r[`${e}Modifiers`]||r[`${xn(e)}Modifiers`]||r[`${Pn(e)}Modifiers`];function zd(r,e,...t){if(r.isUnmounted)return;const n=r.vnode.props||ce;let s=t;const i=e.startsWith("update:"),o=i&&Kd(n,e.slice(7));o&&(o.trim&&(s=t.map(f=>Te(f)?f.trim():f)),o.number&&(s=t.map(Qo)));let a,l=n[a=Do(e)]||n[a=Do(xn(e))];!l&&i&&(l=n[a=Do(Pn(e))]),l&&Wt(l,r,6,s);const u=n[a+"Once"];if(u){if(!r.emitted)r.emitted={};else if(r.emitted[a])return;r.emitted[a]=!0,Wt(u,r,6,s)}}function Gu(r,e,t=!1){const n=e.emitsCache,s=n.get(r);if(s!==void 0)return s;const i=r.emits;let o={},a=!1;if(!G(r)){const l=u=>{const f=Gu(u,e,!0);f&&(a=!0,Me(o,f))};!t&&e.mixins.length&&e.mixins.forEach(l),r.extends&&l(r.extends),r.mixins&&r.mixins.forEach(l)}return!i&&!a?(ge(r)&&n.set(r,null),null):(W(i)?i.forEach(l=>o[l]=null):Me(o,i),ge(r)&&n.set(r,o),o)}function To(r,e){return!r||!go(e)?!1:(e=e.slice(2).replace(/Once$/,""),re(r,e[0].toLowerCase()+e.slice(1))||re(r,Pn(e))||re(r,e))}function Kc(r){const{type:e,vnode:t,proxy:n,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:l,render:u,renderCache:f,props:d,data:y,setupState:p,ctx:b,inheritAttrs:S}=r,B=$i(r);let D,F;try{if(t.shapeFlag&4){const J=s||n,q=J;D=Rt(u.call(q,J,f,d,p,y,b)),F=a}else{const J=e;D=Rt(J.length>1?J(d,{attrs:a,slots:o,emit:l}):J(d,null)),F=e.props?a:jd(a)}}catch(J){$s.length=0,wo(J,r,1),D=zn(_s)}let V=D;if(F&&S!==!1){const J=Object.keys(F),{shapeFlag:q}=V;J.length&&q&7&&(i&&J.some(Va)&&(F=Hd(F,i)),V=gs(V,F,!1,!0))}return t.dirs&&(V=gs(V,null,!1,!0),V.dirs=V.dirs?V.dirs.concat(t.dirs):t.dirs),t.transition&&tc(V,t.transition),D=V,$i(B),D}const jd=r=>{let e;for(const t in r)(t==="class"||t==="style"||go(t))&&((e||(e={}))[t]=r[t]);return e},Hd=(r,e)=>{const t={};for(const n in r)(!Va(n)||!(n.slice(9)in e))&&(t[n]=r[n]);return t};function Wd(r,e,t){const{props:n,children:s,component:i}=r,{props:o,children:a,patchFlag:l}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return n?zc(n,o,u):!!o;if(l&8){const f=e.dynamicProps;for(let d=0;d<f.length;d++){const y=f[d];if(o[y]!==n[y]&&!To(u,y))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:n===o?!1:n?o?zc(n,o,u):!0:!!o;return!1}function zc(r,e,t){const n=Object.keys(e);if(n.length!==Object.keys(r).length)return!0;for(let s=0;s<n.length;s++){const i=n[s];if(e[i]!==r[i]&&!To(t,i))return!0}return!1}function _d({vnode:r,parent:e},t){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===r&&(n.el=r.el),n===r)(r=e.vnode).el=t,e=e.parent;else break}}const Yu=r=>r.__isSuspense;function Gd(r,e){e&&e.pendingBranch?W(r)?e.effects.push(...r):e.effects.push(r):sd(r)}const et=Symbol.for("v-fgt"),Ao=Symbol.for("v-txt"),_s=Symbol.for("v-cmt"),Uo=Symbol.for("v-stc"),$s=[];let _e=null;function Xt(r=!1){$s.push(_e=r?null:[])}function Yd(){$s.pop(),_e=$s[$s.length-1]||null}let Gs=1;function jc(r,e=!1){Gs+=r,r<0&&_e&&e&&(_e.hasOnce=!0)}function Xd(r){return r.dynamicChildren=Gs>0?_e||is:null,Yd(),Gs>0&&_e&&_e.push(r),r}function Zt(r,e,t,n,s,i){return Xd(De(r,e,t,n,s,i,!0))}function Xu(r){return r?r.__v_isVNode===!0:!1}function Cs(r,e){return r.type===e.type&&r.key===e.key}const Zu=({key:r})=>r??null,Ci=({ref:r,ref_key:e,ref_for:t})=>(typeof r=="number"&&(r=""+r),r!=null?Te(r)||Je(r)||G(r)?{i:ft,r,k:e,f:!!t}:r:null);function De(r,e=null,t=null,n=0,s=null,i=r===et?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:r,props:e,key:e&&Zu(e),ref:e&&Ci(e),scopeId:Cu,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:ft};return a?(nc(l,t),i&128&&r.normalize(l)):t&&(l.shapeFlag|=Te(t)?8:16),Gs>0&&!o&&_e&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&_e.push(l),l}const zn=Zd;function Zd(r,e=null,t=null,n=0,s=null,i=!1){if((!r||r===bd)&&(r=_s),Xu(r)){const a=gs(r,e,!0);return t&&nc(a,t),Gs>0&&!i&&_e&&(a.shapeFlag&6?_e[_e.indexOf(r)]=a:_e.push(a)),a.patchFlag=-2,a}if(cg(r)&&(r=r.__vccOpts),e){e=Qd(e);let{class:a,style:l}=e;a&&!Te(a)&&(e.class=Ha(a)),ge(l)&&(Qa(l)&&!W(l)&&(l=Me({},l)),e.style=ja(l))}const o=Te(r)?1:Yu(r)?128:ad(r)?64:ge(r)?4:G(r)?2:0;return De(r,e,t,n,s,o,i,!0)}function Qd(r){return r?Qa(r)||Fu(r)?Me({},r):r:null}function gs(r,e,t=!1,n=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:l}=r,u=e?eg(s||{},e):s,f={__v_isVNode:!0,__v_skip:!0,type:r.type,props:u,key:u&&Zu(u),ref:e&&e.ref?t&&i?W(i)?i.concat(Ci(e)):[i,Ci(e)]:Ci(e):i,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:a,target:r.target,targetStart:r.targetStart,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:e&&r.type!==et?o===-1?16:o|16:o,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:l,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&gs(r.ssContent),ssFallback:r.ssFallback&&gs(r.ssFallback),el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce};return l&&n&&tc(f,l.clone(f)),f}function Qu(r=" ",e=0){return zn(Ao,null,r,e)}function Rt(r){return r==null||typeof r=="boolean"?zn(_s):W(r)?zn(et,null,r.slice()):Xu(r)?bn(r):zn(Ao,null,String(r))}function bn(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:gs(r)}function nc(r,e){let t=0;const{shapeFlag:n}=r;if(e==null)e=null;else if(W(e))t=16;else if(typeof e=="object")if(n&65){const s=e.default;s&&(s._c&&(s._d=!1),nc(r,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!Fu(e)?e._ctx=ft:s===3&&ft&&(ft.slots._===1?e._=1:(e._=2,r.patchFlag|=1024))}else G(e)?(e={default:e,_ctx:ft},t=32):(e=String(e),n&64?(t=16,e=[Qu(e)]):t=8);r.children=e,r.shapeFlag|=t}function eg(...r){const e={};for(let t=0;t<r.length;t++){const n=r[t];for(const s in n)if(s==="class")e.class!==n.class&&(e.class=Ha([e.class,n.class]));else if(s==="style")e.style=ja([e.style,n.style]);else if(go(s)){const i=e[s],o=n[s];o&&i!==o&&!(W(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=n[s])}return e}function Pt(r,e,t,n=null){Wt(r,e,7,[t,n])}const tg=Lu();let rg=0;function ng(r,e,t){const n=r.type,s=(e?e.appContext:r.appContext)||tg,i={uid:rg++,vnode:r,type:n,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Eh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Uu(n,s),emitsOptions:Gu(n,s),emit:null,emitted:null,propsDefaults:ce,inheritAttrs:n.inheritAttrs,ctx:ce,data:ce,props:ce,attrs:ce,slots:ce,refs:ce,setupState:ce,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=zd.bind(null,i),r.ce&&r.ce(i),i}let Le=null,Vi,ua;{const r=yo(),e=(t,n)=>{let s;return(s=r[t])||(s=r[t]=[]),s.push(n),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};Vi=e("__VUE_INSTANCE_SETTERS__",t=>Le=t),ua=e("__VUE_SSR_SETTERS__",t=>Ys=t)}const ci=r=>{const e=Le;return Vi(r),r.scope.on(),()=>{r.scope.off(),Vi(e)}},Hc=()=>{Le&&Le.scope.off(),Vi(null)};function ef(r){return r.vnode.shapeFlag&4}let Ys=!1;function sg(r,e=!1,t=!1){e&&ua(e);const{props:n,children:s}=r.vnode,i=ef(r);Pd(r,n,i,e),Rd(r,s,t);const o=i?ig(r,e):void 0;return e&&ua(!1),o}function ig(r,e){const t=r.type;r.accessCache=Object.create(null),r.proxy=new Proxy(r.ctx,Td);const{setup:n}=t;if(n){On();const s=r.setupContext=n.length>1?ag(r):null,i=ci(r),o=ai(n,r,0,[r.props,s]),a=Ql(o);if(Dn(),i(),(a||r.sp)&&!Ms(r)&&Nu(r),a){if(o.then(Hc,Hc),e)return o.then(l=>{Wc(r,l)}).catch(l=>{wo(l,r,0)});r.asyncDep=o}else Wc(r,o)}else tf(r)}function Wc(r,e,t){G(e)?r.type.__ssrInlineRender?r.ssrRender=e:r.render=e:ge(e)&&(r.setupState=Su(e)),tf(r)}function tf(r,e,t){const n=r.type;r.render||(r.render=n.render||jt);{const s=ci(r);On();try{Ad(r)}finally{Dn(),s()}}}const og={get(r,e){return Ee(r,"get",""),r[e]}};function ag(r){const e=t=>{r.exposed=t||{}};return{attrs:new Proxy(r.attrs,og),slots:r.slots,emit:r.emit,expose:e}}function So(r){return r.exposed?r.exposeProxy||(r.exposeProxy=new Proxy(Su(_h(r.exposed)),{get(e,t){if(t in e)return e[t];if(t in Fs)return Fs[t](r)},has(e,t){return t in e||t in Fs}})):r.proxy}function cg(r){return G(r)&&"__vccOpts"in r}const lg=(r,e)=>Zh(r,e,Ys),ug="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let fa;const _c=typeof window<"u"&&window.trustedTypes;if(_c)try{fa=_c.createPolicy("vue",{createHTML:r=>r})}catch{}const rf=fa?r=>fa.createHTML(r):r=>r,fg="http://www.w3.org/2000/svg",hg="http://www.w3.org/1998/Math/MathML",er=typeof document<"u"?document:null,Gc=er&&er.createElement("template"),dg={insert:(r,e,t)=>{e.insertBefore(r,t||null)},remove:r=>{const e=r.parentNode;e&&e.removeChild(r)},createElement:(r,e,t,n)=>{const s=e==="svg"?er.createElementNS(fg,r):e==="mathml"?er.createElementNS(hg,r):t?er.createElement(r,{is:t}):er.createElement(r);return r==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:r=>er.createTextNode(r),createComment:r=>er.createComment(r),setText:(r,e)=>{r.nodeValue=e},setElementText:(r,e)=>{r.textContent=e},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>er.querySelector(r),setScopeId(r,e){r.setAttribute(e,"")},insertStaticContent(r,e,t,n,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{Gc.innerHTML=rf(n==="svg"?`<svg>${r}</svg>`:n==="mathml"?`<math>${r}</math>`:r);const a=Gc.content;if(n==="svg"||n==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},gg=Symbol("_vtc");function mg(r,e,t){const n=r[gg];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?r.removeAttribute("class"):t?r.setAttribute("class",e):r.className=e}const Yc=Symbol("_vod"),pg=Symbol("_vsh"),yg=Symbol(""),vg=/(^|;)\s*display\s*:/;function wg(r,e,t){const n=r.style,s=Te(t);let i=!1;if(t&&!s){if(e)if(Te(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&Ni(n,a,"")}else for(const o in e)t[o]==null&&Ni(n,o,"");for(const o in t)o==="display"&&(i=!0),Ni(n,o,t[o])}else if(s){if(e!==t){const o=n[yg];o&&(t+=";"+o),n.cssText=t,i=vg.test(t)}}else e&&r.removeAttribute("style");Yc in r&&(r[Yc]=i?n.display:"",r[pg]&&(n.display="none"))}const Xc=/\s*!important$/;function Ni(r,e,t){if(W(t))t.forEach(n=>Ni(r,e,n));else if(t==null&&(t=""),e.startsWith("--"))r.setProperty(e,t);else{const n=bg(r,e);Xc.test(t)?r.setProperty(Pn(n),t.replace(Xc,""),"important"):r[n]=t}}const Zc=["Webkit","Moz","ms"],qo={};function bg(r,e){const t=qo[e];if(t)return t;let n=xn(e);if(n!=="filter"&&n in r)return qo[e]=n;n=ru(n);for(let s=0;s<Zc.length;s++){const i=Zc[s]+n;if(i in r)return qo[e]=i}return e}const Qc="http://www.w3.org/1999/xlink";function el(r,e,t,n,s,i=kh(e)){n&&e.startsWith("xlink:")?t==null?r.removeAttributeNS(Qc,e.slice(6,e.length)):r.setAttributeNS(Qc,e,t):t==null||i&&!su(t)?r.removeAttribute(e):r.setAttribute(e,i?"":Nn(t)?String(t):t)}function tl(r,e,t,n,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(r[e]=e==="innerHTML"?rf(t):t);return}const i=r.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?r.getAttribute("value")||"":r.value,l=t==null?r.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in r))&&(r.value=l),t==null&&r.removeAttribute(e),r._value=t;return}let o=!1;if(t===""||t==null){const a=typeof r[e];a==="boolean"?t=su(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{r[e]=t}catch{}o&&r.removeAttribute(s||e)}function ts(r,e,t,n){r.addEventListener(e,t,n)}function Tg(r,e,t,n){r.removeEventListener(e,t,n)}const rl=Symbol("_vei");function Ag(r,e,t,n,s=null){const i=r[rl]||(r[rl]={}),o=i[e];if(n&&o)o.value=n;else{const[a,l]=Sg(e);if(n){const u=i[e]=kg(n,s);ts(r,a,u,l)}else o&&(Tg(r,a,o,l),i[e]=void 0)}}const nl=/(?:Once|Passive|Capture)$/;function Sg(r){let e;if(nl.test(r)){e={};let n;for(;n=r.match(nl);)r=r.slice(0,r.length-n[0].length),e[n[0].toLowerCase()]=!0}return[r[2]===":"?r.slice(3):Pn(r.slice(2)),e]}let Vo=0;const Ig=Promise.resolve(),xg=()=>Vo||(Ig.then(()=>Vo=0),Vo=Date.now());function kg(r,e){const t=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=t.attached)return;Wt(Eg(n,t.value),e,5,[n])};return t.value=r,t.attached=xg(),t}function Eg(r,e){if(W(e)){const t=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{t.call(r),r._stopped=!0},e.map(n=>s=>!s._stopped&&n&&n(s))}else return e}const sl=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)>96&&r.charCodeAt(2)<123,Cg=(r,e,t,n,s,i)=>{const o=s==="svg";e==="class"?mg(r,n,o):e==="style"?wg(r,t,n):go(e)?Va(e)||Ag(r,e,t,n,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Ng(r,e,n,o))?(tl(r,e,n),!r.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&el(r,e,n,o,i,e!=="value")):r._isVueCE&&(/[A-Z]/.test(e)||!Te(n))?tl(r,xn(e),n,i,e):(e==="true-value"?r._trueValue=n:e==="false-value"&&(r._falseValue=n),el(r,e,n,o))};function Ng(r,e,t,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in r&&sl(e)&&G(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&r.tagName==="INPUT"||e==="type"&&r.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=r.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return sl(e)&&Te(t)?!1:e in r}const il=r=>{const e=r.props["onUpdate:modelValue"]||!1;return W(e)?t=>ki(e,t):e};function Pg(r){r.target.composing=!0}function ol(r){const e=r.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Ko=Symbol("_assign"),al={created(r,{modifiers:{lazy:e,trim:t,number:n}},s){r[Ko]=il(s);const i=n||s.props&&s.props.type==="number";ts(r,e?"change":"input",o=>{if(o.target.composing)return;let a=r.value;t&&(a=a.trim()),i&&(a=Qo(a)),r[Ko](a)}),t&&ts(r,"change",()=>{r.value=r.value.trim()}),e||(ts(r,"compositionstart",Pg),ts(r,"compositionend",ol),ts(r,"change",ol))},mounted(r,{value:e}){r.value=e??""},beforeUpdate(r,{value:e,oldValue:t,modifiers:{lazy:n,trim:s,number:i}},o){if(r[Ko]=il(o),r.composing)return;const a=(i||r.type==="number")&&!/^0\d/.test(r.value)?Qo(r.value):r.value,l=e??"";a!==l&&(document.activeElement===r&&r.type!=="range"&&(n&&e===t||s&&r.value.trim()===l)||(r.value=l))}},Og={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},bi=(r,e)=>{const t=r._withKeys||(r._withKeys={}),n=e.join(".");return t[n]||(t[n]=s=>{if(!("key"in s))return;const i=Pn(s.key);if(e.some(o=>o===i||Og[o]===i))return r(s)})},Dg=Me({patchProp:Cg},dg);let cl;function Bg(){return cl||(cl=Jd(Dg))}const Rg=(...r)=>{const e=Bg().createApp(...r),{mount:t}=e;return e.mount=n=>{const s=Jg(n);if(!s)return;const i=e._component;!G(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,Lg(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function Lg(r){if(r instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&r instanceof MathMLElement)return"mathml"}function Jg(r){return Te(r)?document.querySelector(r):r}var X;(function(r){r[r.Canceled=1]="Canceled",r[r.Unknown=2]="Unknown",r[r.InvalidArgument=3]="InvalidArgument",r[r.DeadlineExceeded=4]="DeadlineExceeded",r[r.NotFound=5]="NotFound",r[r.AlreadyExists=6]="AlreadyExists",r[r.PermissionDenied=7]="PermissionDenied",r[r.ResourceExhausted=8]="ResourceExhausted",r[r.FailedPrecondition=9]="FailedPrecondition",r[r.Aborted=10]="Aborted",r[r.OutOfRange=11]="OutOfRange",r[r.Unimplemented=12]="Unimplemented",r[r.Internal=13]="Internal",r[r.Unavailable=14]="Unavailable",r[r.DataLoss=15]="DataLoss",r[r.Unauthenticated=16]="Unauthenticated"})(X||(X={}));function ll(r){const e=X[r];return typeof e!="string"?r.toString():e[0].toLowerCase()+e.substring(1).replace(/[A-Z]/g,t=>"_"+t.toLowerCase())}class ne extends Error{constructor(e,t=X.Unknown,n,s,i){super(Mg(e,t)),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=e,this.code=t,this.metadata=new Headers(n??{}),this.details=s??[],this.cause=i}static from(e,t=X.Unknown){return e instanceof ne?e:e instanceof Error?e.name=="AbortError"?new ne(e.message,X.Canceled):new ne(e.message,t,void 0,void 0,e):new ne(String(e),t,void 0,void 0,e)}static[Symbol.hasInstance](e){return e instanceof Error?Object.getPrototypeOf(e)===ne.prototype?!0:e.name==="ConnectError"&&"code"in e&&typeof e.code=="number"&&"metadata"in e&&"details"in e&&Array.isArray(e.details)&&"rawMessage"in e&&typeof e.rawMessage=="string"&&"cause"in e:!1}findDetails(e){const t="typeName"in e?{findMessage:s=>s===e.typeName?e:void 0}:e,n=[];for(const s of this.details){if("getType"in s){t.findMessage(s.getType().typeName)&&n.push(s);continue}const i=t.findMessage(s.type);if(i)try{n.push(i.fromBinary(s.value))}catch{}}return n}}function Mg(r,e){return r.length?`[${ll(e)}] ${r}`:`[${ll(e)}]`}function pe(r,e){if(!r)throw new Error(e)}const Fg=34028234663852886e22,$g=-34028234663852886e22,Ug=4294967295,qg=2147483647,Vg=-2147483648;function Pi(r){if(typeof r!="number")throw new Error("invalid int 32: "+typeof r);if(!Number.isInteger(r)||r>qg||r<Vg)throw new Error("invalid int 32: "+r)}function ha(r){if(typeof r!="number")throw new Error("invalid uint 32: "+typeof r);if(!Number.isInteger(r)||r>Ug||r<0)throw new Error("invalid uint 32: "+r)}function nf(r){if(typeof r!="number")throw new Error("invalid float 32: "+typeof r);if(Number.isFinite(r)&&(r>Fg||r<$g))throw new Error("invalid float 32: "+r)}const sf=Symbol("@bufbuild/protobuf/enum-type");function Kg(r){const e=r[sf];return pe(e,"missing enum type on enum object"),e}function of(r,e,t,n){r[sf]=af(e,t.map(s=>({no:s.no,name:s.name,localName:r[s.no]})))}function af(r,e,t){const n=Object.create(null),s=Object.create(null),i=[];for(const o of e){const a=cf(o);i.push(a),n[o.name]=a,s[o.no]=a}return{typeName:r,values:i,findName(o){return n[o]},findNumber(o){return s[o]}}}function zg(r,e,t){const n={};for(const s of e){const i=cf(s);n[i.localName]=i.no,n[i.no]=i.localName}return of(n,r,e),n}function cf(r){return"localName"in r?r:Object.assign(Object.assign({},r),{localName:r.name})}class O{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const n=this.getType(),s=n.runtime.bin,i=s.makeReadOptions(t);return s.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,t){const n=this.getType(),s=n.runtime.json,i=s.makeReadOptions(t);return s.readMessage(n,e,i,this),this}fromJsonString(e,t){let n;try{n=JSON.parse(e)}catch(s){throw new Error(`cannot decode ${this.getType().typeName} from JSON: ${s instanceof Error?s.message:String(s)}`)}return this.fromJson(n,t)}toBinary(e){const t=this.getType(),n=t.runtime.bin,s=n.makeWriteOptions(e),i=s.writerFactory();return n.writeMessage(this,i,s),i.finish()}toJson(e){const t=this.getType(),n=t.runtime.json,s=n.makeWriteOptions(e);return n.writeMessage(this,s)}toJsonString(e){var t;const n=this.toJson(e);return JSON.stringify(n,null,(t=e==null?void 0:e.prettySpaces)!==null&&t!==void 0?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function jg(r,e,t,n){var s;const i=(s=n==null?void 0:n.localName)!==null&&s!==void 0?s:e.substring(e.lastIndexOf(".")+1),o={[i]:function(a){r.util.initFields(this),r.util.initPartial(a,this)}}[i];return Object.setPrototypeOf(o.prototype,new O),Object.assign(o,{runtime:r,typeName:e,fields:r.util.newFieldList(t),fromBinary(a,l){return new o().fromBinary(a,l)},fromJson(a,l){return new o().fromJson(a,l)},fromJsonString(a,l){return new o().fromJsonString(a,l)},equals(a,l){return r.util.equals(o,a,l)}}),o}function Hg(){let r=0,e=0;for(let n=0;n<28;n+=7){let s=this.buf[this.pos++];if(r|=(s&127)<<n,!(s&128))return this.assertBounds(),[r,e]}let t=this.buf[this.pos++];if(r|=(t&15)<<28,e=(t&112)>>4,!(t&128))return this.assertBounds(),[r,e];for(let n=3;n<=31;n+=7){let s=this.buf[this.pos++];if(e|=(s&127)<<n,!(s&128))return this.assertBounds(),[r,e]}throw new Error("invalid varint")}function zo(r,e,t){for(let i=0;i<28;i=i+7){const o=r>>>i,a=!(!(o>>>7)&&e==0),l=(a?o|128:o)&255;if(t.push(l),!a)return}const n=r>>>28&15|(e&7)<<4,s=!!(e>>3);if(t.push((s?n|128:n)&255),!!s){for(let i=3;i<31;i=i+7){const o=e>>>i,a=!!(o>>>7),l=(a?o|128:o)&255;if(t.push(l),!a)return}t.push(e>>>31&1)}}const Oi=4294967296;function ul(r){const e=r[0]==="-";e&&(r=r.slice(1));const t=1e6;let n=0,s=0;function i(o,a){const l=Number(r.slice(o,a));s*=t,n=n*t+l,n>=Oi&&(s=s+(n/Oi|0),n=n%Oi)}return i(-24,-18),i(-18,-12),i(-12,-6),i(-6),e?uf(n,s):sc(n,s)}function Wg(r,e){let t=sc(r,e);const n=t.hi&2147483648;n&&(t=uf(t.lo,t.hi));const s=lf(t.lo,t.hi);return n?"-"+s:s}function lf(r,e){if({lo:r,hi:e}=_g(r,e),e<=2097151)return String(Oi*e+r);const t=r&16777215,n=(r>>>24|e<<8)&16777215,s=e>>16&65535;let i=t+n*6777216+s*6710656,o=n+s*8147497,a=s*2;const l=1e7;return i>=l&&(o+=Math.floor(i/l),i%=l),o>=l&&(a+=Math.floor(o/l),o%=l),a.toString()+fl(o)+fl(i)}function _g(r,e){return{lo:r>>>0,hi:e>>>0}}function sc(r,e){return{lo:r|0,hi:e|0}}function uf(r,e){return e=~e,r?r=~r+1:e+=1,sc(r,e)}const fl=r=>{const e=String(r);return"0000000".slice(e.length)+e};function hl(r,e){if(r>=0){for(;r>127;)e.push(r&127|128),r=r>>>7;e.push(r)}else{for(let t=0;t<9;t++)e.push(r&127|128),r=r>>7;e.push(1)}}function Gg(){let r=this.buf[this.pos++],e=r&127;if(!(r&128))return this.assertBounds(),e;if(r=this.buf[this.pos++],e|=(r&127)<<7,!(r&128))return this.assertBounds(),e;if(r=this.buf[this.pos++],e|=(r&127)<<14,!(r&128))return this.assertBounds(),e;if(r=this.buf[this.pos++],e|=(r&127)<<21,!(r&128))return this.assertBounds(),e;r=this.buf[this.pos++],e|=(r&15)<<28;for(let t=5;r&128&&t<10;t++)r=this.buf[this.pos++];if(r&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}var dl={};function Yg(){const r=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof r.getBigInt64=="function"&&typeof r.getBigUint64=="function"&&typeof r.setBigInt64=="function"&&typeof r.setBigUint64=="function"&&(typeof process!="object"||typeof dl!="object"||dl.BUF_BIGINT_DISABLE!=="1")){const s=BigInt("-9223372036854775808"),i=BigInt("9223372036854775807"),o=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(l){const u=typeof l=="bigint"?l:BigInt(l);if(u>i||u<s)throw new Error(`int64 invalid: ${l}`);return u},uParse(l){const u=typeof l=="bigint"?l:BigInt(l);if(u>a||u<o)throw new Error(`uint64 invalid: ${l}`);return u},enc(l){return r.setBigInt64(0,this.parse(l),!0),{lo:r.getInt32(0,!0),hi:r.getInt32(4,!0)}},uEnc(l){return r.setBigInt64(0,this.uParse(l),!0),{lo:r.getInt32(0,!0),hi:r.getInt32(4,!0)}},dec(l,u){return r.setInt32(0,l,!0),r.setInt32(4,u,!0),r.getBigInt64(0,!0)},uDec(l,u){return r.setInt32(0,l,!0),r.setInt32(4,u,!0),r.getBigUint64(0,!0)}}}const t=s=>pe(/^-?[0-9]+$/.test(s),`int64 invalid: ${s}`),n=s=>pe(/^[0-9]+$/.test(s),`uint64 invalid: ${s}`);return{zero:"0",supported:!1,parse(s){return typeof s!="string"&&(s=s.toString()),t(s),s},uParse(s){return typeof s!="string"&&(s=s.toString()),n(s),s},enc(s){return typeof s!="string"&&(s=s.toString()),t(s),ul(s)},uEnc(s){return typeof s!="string"&&(s=s.toString()),n(s),ul(s)},dec(s,i){return Wg(s,i)},uDec(s,i){return lf(s,i)}}}const he=Yg();var T;(function(r){r[r.DOUBLE=1]="DOUBLE",r[r.FLOAT=2]="FLOAT",r[r.INT64=3]="INT64",r[r.UINT64=4]="UINT64",r[r.INT32=5]="INT32",r[r.FIXED64=6]="FIXED64",r[r.FIXED32=7]="FIXED32",r[r.BOOL=8]="BOOL",r[r.STRING=9]="STRING",r[r.BYTES=12]="BYTES",r[r.UINT32=13]="UINT32",r[r.SFIXED32=15]="SFIXED32",r[r.SFIXED64=16]="SFIXED64",r[r.SINT32=17]="SINT32",r[r.SINT64=18]="SINT64"})(T||(T={}));var kn;(function(r){r[r.BIGINT=0]="BIGINT",r[r.STRING=1]="STRING"})(kn||(kn={}));function gn(r,e,t){if(e===t)return!0;if(r==T.BYTES){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}switch(r){case T.UINT64:case T.FIXED64:case T.INT64:case T.SFIXED64:case T.SINT64:return e==t}return!1}function ms(r,e){switch(r){case T.BOOL:return!1;case T.UINT64:case T.FIXED64:case T.INT64:case T.SFIXED64:case T.SINT64:return e==0?he.zero:"0";case T.DOUBLE:case T.FLOAT:return 0;case T.BYTES:return new Uint8Array(0);case T.STRING:return"";default:return 0}}function ff(r,e){switch(r){case T.BOOL:return e===!1;case T.STRING:return e==="";case T.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var we;(function(r){r[r.Varint=0]="Varint",r[r.Bit64=1]="Bit64",r[r.LengthDelimited=2]="LengthDelimited",r[r.StartGroup=3]="StartGroup",r[r.EndGroup=4]="EndGroup",r[r.Bit32=5]="Bit32"})(we||(we={}));class Xg{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let s=0;s<this.chunks.length;s++)e+=this.chunks[s].length;let t=new Uint8Array(e),n=0;for(let s=0;s<this.chunks.length;s++)t.set(this.chunks[s],n),n+=this.chunks[s].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(ha(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Pi(e),hl(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){nf(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){ha(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){Pi(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return Pi(e),e=(e<<1^e>>31)>>>0,hl(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),s=he.enc(e);return n.setInt32(0,s.lo,!0),n.setInt32(4,s.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),s=he.uEnc(e);return n.setInt32(0,s.lo,!0),n.setInt32(4,s.hi,!0),this.raw(t)}int64(e){let t=he.enc(e);return zo(t.lo,t.hi,this.buf),this}sint64(e){let t=he.enc(e),n=t.hi>>31,s=t.lo<<1^n,i=(t.hi<<1|t.lo>>>31)^n;return zo(s,i,this.buf),this}uint64(e){let t=he.uEnc(e);return zo(t.lo,t.hi,this.buf),this}}class Zg{constructor(e,t){this.varint64=Hg,this.uint32=Gg,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,n=e&7;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e,t){let n=this.pos;switch(e){case we.Varint:for(;this.buf[this.pos++]&128;);break;case we.Bit64:this.pos+=4;case we.Bit32:this.pos+=4;break;case we.LengthDelimited:let s=this.uint32();this.pos+=s;break;case we.StartGroup:for(;;){const[i,o]=this.tag();if(o===we.EndGroup){if(t!==void 0&&i!==t)throw new Error("invalid end group tag");break}this.skip(o,i)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return he.dec(...this.varint64())}uint64(){return he.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(e&1);return e=(e>>>1|(t&1)<<31)^n,t=t>>>1^n,he.dec(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return he.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return he.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function Qg(r,e,t,n){let s;return{typeName:e,extendee:t,get field(){if(!s){const i=typeof n=="function"?n():n;i.name=e.split(".").pop(),i.jsonName=`[${e}]`,s=r.util.newFieldList([i]).list()[0]}return s},runtime:r}}function hf(r){const e=r.field.localName,t=Object.create(null);return t[e]=em(r),[t,()=>t[e]]}function em(r){const e=r.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return ms(e.T,e.L);case"message":const t=e.T,n=new t;return t.fieldWrapper?t.fieldWrapper.unwrapField(n):n;case"map":throw"map fields are not allowed to be extensions"}}function tm(r,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let t=r.length-1;t>=0;--t)if(r[t].no==e.no)return[r[t]];return[]}return r.filter(t=>t.no===e.no)}let nn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Io=[];for(let r=0;r<nn.length;r++)Io[nn[r].charCodeAt(0)]=r;Io[45]=nn.indexOf("+");Io[95]=nn.indexOf("/");const ic={dec(r){let e=r.length*3/4;r[r.length-2]=="="?e-=2:r[r.length-1]=="="&&(e-=1);let t=new Uint8Array(e),n=0,s=0,i,o=0;for(let a=0;a<r.length;a++){if(i=Io[r.charCodeAt(a)],i===void 0)switch(r[a]){case"=":s=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(s){case 0:o=i,s=1;break;case 1:t[n++]=o<<2|(i&48)>>4,o=i,s=2;break;case 2:t[n++]=(o&15)<<4|(i&60)>>2,o=i,s=3;break;case 3:t[n++]=(o&3)<<6|i,s=0;break}}if(s==1)throw Error("invalid base64 string.");return t.subarray(0,n)},enc(r){let e="",t=0,n,s=0;for(let i=0;i<r.length;i++)switch(n=r[i],t){case 0:e+=nn[n>>2],s=(n&3)<<4,t=1;break;case 1:e+=nn[s|n>>4],s=(n&15)<<2,t=2;break;case 2:e+=nn[s|n>>6],e+=nn[n&63],t=0;break}return t&&(e+=nn[s],e+="=",t==1&&(e+="=")),e}};function rm(r,e,t){gf(e,r);const n=e.runtime.bin.makeReadOptions(t),s=tm(r.getType().runtime.bin.listUnknownFields(r),e.field),[i,o]=hf(e);for(const a of s)e.runtime.bin.readField(i,n.readerFactory(a.data),e.field,a.wireType,n);return o()}function nm(r,e,t,n){gf(e,r);const s=e.runtime.bin.makeReadOptions(n),i=e.runtime.bin.makeWriteOptions(n);if(df(r,e)){const u=r.getType().runtime.bin.listUnknownFields(r).filter(f=>f.no!=e.field.no);r.getType().runtime.bin.discardUnknownFields(r);for(const f of u)r.getType().runtime.bin.onUnknownField(r,f.no,f.wireType,f.data)}const o=i.writerFactory();let a=e.field;!a.opt&&!a.repeated&&(a.kind=="enum"||a.kind=="scalar")&&(a=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(a,t,o,i);const l=s.readerFactory(o.finish());for(;l.pos<l.len;){const[u,f]=l.tag(),d=l.skip(f,u);r.getType().runtime.bin.onUnknownField(r,u,f,d)}}function df(r,e){const t=r.getType();return e.extendee.typeName===t.typeName&&!!t.runtime.bin.listUnknownFields(r).find(n=>n.no==e.field.no)}function gf(r,e){pe(r.extendee.typeName==e.getType().typeName,`extension ${r.typeName} can only be applied to message ${r.extendee.typeName}`)}function mf(r,e){const t=r.localName;if(r.repeated)return e[t].length>0;if(r.oneof)return e[r.oneof.localName].case===t;switch(r.kind){case"enum":case"scalar":return r.opt||r.req?e[t]!==void 0:r.kind=="enum"?e[t]!==r.T.values[0].no:!ff(r.T,e[t]);case"message":return e[t]!==void 0;case"map":return Object.keys(e[t]).length>0}}function gl(r,e){const t=r.localName,n=!r.opt&&!r.req;if(r.repeated)e[t]=[];else if(r.oneof)e[r.oneof.localName]={case:void 0};else switch(r.kind){case"map":e[t]={};break;case"enum":e[t]=n?r.T.values[0].no:void 0;break;case"scalar":e[t]=n?ms(r.T,r.L):void 0;break;case"message":e[t]=void 0;break}}function jn(r,e){if(r===null||typeof r!="object"||!Object.getOwnPropertyNames(O.prototype).every(n=>n in r&&typeof r[n]=="function"))return!1;const t=r.getType();return t===null||typeof t!="function"||!("typeName"in t)||typeof t.typeName!="string"?!1:e===void 0?!0:t.typeName==e.typeName}function pf(r,e){return jn(e)||!r.fieldWrapper?e:r.fieldWrapper.wrapField(e)}T.DOUBLE,T.FLOAT,T.INT64,T.UINT64,T.INT32,T.UINT32,T.BOOL,T.STRING,T.BYTES;const ml={ignoreUnknownFields:!1},pl={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function sm(r){return r?Object.assign(Object.assign({},ml),r):ml}function im(r){return r?Object.assign(Object.assign({},pl),r):pl}const Ki=Symbol(),Di=Symbol();function om(){return{makeReadOptions:sm,makeWriteOptions:im,readMessage(r,e,t,n){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error(`cannot decode message ${r.typeName} from JSON: ${Bt(e)}`);n=n??new r;const s=new Map,i=t.typeRegistry;for(const[o,a]of Object.entries(e)){const l=r.fields.findJsonName(o);if(l){if(l.oneof){if(a===null&&l.kind=="scalar")continue;const u=s.get(l.oneof);if(u!==void 0)throw new Error(`cannot decode message ${r.typeName} from JSON: multiple keys for oneof "${l.oneof.name}" present: "${u}", "${o}"`);s.set(l.oneof,o)}yl(n,a,l,t,r)}else{let u=!1;if(i!=null&&i.findExtension&&o.startsWith("[")&&o.endsWith("]")){const f=i.findExtension(o.substring(1,o.length-1));if(f&&f.extendee.typeName==r.typeName){u=!0;const[d,y]=hf(f);yl(d,a,f.field,t,f),nm(n,f,y(),t)}}if(!u&&!t.ignoreUnknownFields)throw new Error(`cannot decode message ${r.typeName} from JSON: key "${o}" is unknown`)}}return n},writeMessage(r,e){const t=r.getType(),n={};let s;try{for(s of t.fields.byNumber()){if(!mf(s,r)){if(s.req)throw"required field not set";if(!e.emitDefaultValues||!cm(s))continue}const o=s.oneof?r[s.oneof.localName].value:r[s.localName],a=vl(s,o,e);a!==void 0&&(n[e.useProtoFieldName?s.name:s.jsonName]=a)}const i=e.typeRegistry;if(i!=null&&i.findExtensionFor)for(const o of t.runtime.bin.listUnknownFields(r)){const a=i.findExtensionFor(t.typeName,o.no);if(a&&df(r,a)){const l=rm(r,a,e),u=vl(a.field,l,e);u!==void 0&&(n[a.field.jsonName]=u)}}}catch(i){const o=s?`cannot encode field ${t.typeName}.${s.name} to JSON`:`cannot encode message ${t.typeName} to JSON`,a=i instanceof Error?i.message:String(i);throw new Error(o+(a.length>0?`: ${a}`:""))}return n},readScalar(r,e,t){return Us(r,e,t??kn.BIGINT,!0)},writeScalar(r,e,t){if(e!==void 0&&(t||ff(r,e)))return Bi(r,e)},debug:Bt}}function Bt(r){if(r===null)return"null";switch(typeof r){case"object":return Array.isArray(r)?"array":"object";case"string":return r.length>100?"string":`"${r.split('"').join('\\"')}"`;default:return String(r)}}function yl(r,e,t,n,s){let i=t.localName;if(t.repeated){if(pe(t.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error(`cannot decode field ${s.typeName}.${t.name} from JSON: ${Bt(e)}`);const o=r[i];for(const a of e){if(a===null)throw new Error(`cannot decode field ${s.typeName}.${t.name} from JSON: ${Bt(a)}`);switch(t.kind){case"message":o.push(t.T.fromJson(a,n));break;case"enum":const l=jo(t.T,a,n.ignoreUnknownFields,!0);l!==Di&&o.push(l);break;case"scalar":try{o.push(Us(t.T,a,t.L,!0))}catch(u){let f=`cannot decode field ${s.typeName}.${t.name} from JSON: ${Bt(a)}`;throw u instanceof Error&&u.message.length>0&&(f+=`: ${u.message}`),new Error(f)}break}}}else if(t.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error(`cannot decode field ${s.typeName}.${t.name} from JSON: ${Bt(e)}`);const o=r[i];for(const[a,l]of Object.entries(e)){if(l===null)throw new Error(`cannot decode field ${s.typeName}.${t.name} from JSON: map value null`);let u;try{u=am(t.K,a)}catch(f){let d=`cannot decode map key for field ${s.typeName}.${t.name} from JSON: ${Bt(e)}`;throw f instanceof Error&&f.message.length>0&&(d+=`: ${f.message}`),new Error(d)}switch(t.V.kind){case"message":o[u]=t.V.T.fromJson(l,n);break;case"enum":const f=jo(t.V.T,l,n.ignoreUnknownFields,!0);f!==Di&&(o[u]=f);break;case"scalar":try{o[u]=Us(t.V.T,l,kn.BIGINT,!0)}catch(d){let y=`cannot decode map value for field ${s.typeName}.${t.name} from JSON: ${Bt(e)}`;throw d instanceof Error&&d.message.length>0&&(y+=`: ${d.message}`),new Error(y)}break}}}else switch(t.oneof&&(r=r[t.oneof.localName]={case:i},i="value"),t.kind){case"message":const o=t.T;if(e===null&&o.typeName!="google.protobuf.Value")return;let a=r[i];jn(a)?a.fromJson(e,n):(r[i]=a=o.fromJson(e,n),o.fieldWrapper&&!t.oneof&&(r[i]=o.fieldWrapper.unwrapField(a)));break;case"enum":const l=jo(t.T,e,n.ignoreUnknownFields,!1);switch(l){case Ki:gl(t,r);break;case Di:break;default:r[i]=l;break}break;case"scalar":try{const u=Us(t.T,e,t.L,!1);switch(u){case Ki:gl(t,r);break;default:r[i]=u;break}}catch(u){let f=`cannot decode field ${s.typeName}.${t.name} from JSON: ${Bt(e)}`;throw u instanceof Error&&u.message.length>0&&(f+=`: ${u.message}`),new Error(f)}break}}function am(r,e){if(r===T.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Us(r,e,kn.BIGINT,!0).toString()}function Us(r,e,t,n){if(e===null)return n?ms(r,t):Ki;switch(r){case T.DOUBLE:case T.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const s=Number(e);if(Number.isNaN(s)||!Number.isFinite(s))break;return r==T.FLOAT&&nf(s),s;case T.INT32:case T.FIXED32:case T.SFIXED32:case T.SINT32:case T.UINT32:let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return r==T.UINT32||r==T.FIXED32?ha(i):Pi(i),i;case T.INT64:case T.SFIXED64:case T.SINT64:if(typeof e!="number"&&typeof e!="string")break;const o=he.parse(e);return t?o.toString():o;case T.FIXED64:case T.UINT64:if(typeof e!="number"&&typeof e!="string")break;const a=he.uParse(e);return t?a.toString():a;case T.BOOL:if(typeof e!="boolean")break;return e;case T.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case T.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return ic.dec(e)}throw new Error}function jo(r,e,t,n){if(e===null)return r.typeName=="google.protobuf.NullValue"?0:n?r.values[0].no:Ki;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const s=r.findName(e);if(s!==void 0)return s.no;if(t)return Di;break}throw new Error(`cannot decode enum ${r.typeName} from JSON: ${Bt(e)}`)}function cm(r){return r.repeated||r.kind=="map"?!0:!(r.oneof||r.kind=="message"||r.opt||r.req)}function vl(r,e,t){if(r.kind=="map"){pe(typeof e=="object"&&e!=null);const n={},s=Object.entries(e);switch(r.V.kind){case"scalar":for(const[o,a]of s)n[o.toString()]=Bi(r.V.T,a);break;case"message":for(const[o,a]of s)n[o.toString()]=a.toJson(t);break;case"enum":const i=r.V.T;for(const[o,a]of s)n[o.toString()]=Ho(i,a,t.enumAsInteger);break}return t.emitDefaultValues||s.length>0?n:void 0}if(r.repeated){pe(Array.isArray(e));const n=[];switch(r.kind){case"scalar":for(let s=0;s<e.length;s++)n.push(Bi(r.T,e[s]));break;case"enum":for(let s=0;s<e.length;s++)n.push(Ho(r.T,e[s],t.enumAsInteger));break;case"message":for(let s=0;s<e.length;s++)n.push(e[s].toJson(t));break}return t.emitDefaultValues||n.length>0?n:void 0}switch(r.kind){case"scalar":return Bi(r.T,e);case"enum":return Ho(r.T,e,t.enumAsInteger);case"message":return pf(r.T,e).toJson(t)}}function Ho(r,e,t){var n;if(pe(typeof e=="number"),r.typeName=="google.protobuf.NullValue")return null;if(t)return e;const s=r.findNumber(e);return(n=s==null?void 0:s.name)!==null&&n!==void 0?n:e}function Bi(r,e){switch(r){case T.INT32:case T.SFIXED32:case T.SINT32:case T.FIXED32:case T.UINT32:return pe(typeof e=="number"),e;case T.FLOAT:case T.DOUBLE:return pe(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case T.STRING:return pe(typeof e=="string"),e;case T.BOOL:return pe(typeof e=="boolean"),e;case T.UINT64:case T.FIXED64:case T.INT64:case T.SFIXED64:case T.SINT64:return pe(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case T.BYTES:return pe(e instanceof Uint8Array),ic.enc(e)}}const Zn=Symbol("@bufbuild/protobuf/unknown-fields"),wl={readUnknownFields:!0,readerFactory:r=>new Zg(r)},bl={writeUnknownFields:!0,writerFactory:()=>new Xg};function lm(r){return r?Object.assign(Object.assign({},wl),r):wl}function um(r){return r?Object.assign(Object.assign({},bl),r):bl}function fm(){return{makeReadOptions:lm,makeWriteOptions:um,listUnknownFields(r){var e;return(e=r[Zn])!==null&&e!==void 0?e:[]},discardUnknownFields(r){delete r[Zn]},writeUnknownFields(r,e){const n=r[Zn];if(n)for(const s of n)e.tag(s.no,s.wireType).raw(s.data)},onUnknownField(r,e,t,n){const s=r;Array.isArray(s[Zn])||(s[Zn]=[]),s[Zn].push({no:e,wireType:t,data:n})},readMessage(r,e,t,n,s){const i=r.getType(),o=s?e.len:e.pos+t;let a,l;for(;e.pos<o&&([a,l]=e.tag(),!(s===!0&&l==we.EndGroup));){const u=i.fields.find(a);if(!u){const f=e.skip(l,a);n.readUnknownFields&&this.onUnknownField(r,a,l,f);continue}Tl(r,e,u,l,n)}if(s&&(l!=we.EndGroup||a!==t))throw new Error("invalid end group tag")},readField:Tl,writeMessage(r,e,t){const n=r.getType();for(const s of n.fields.byNumber()){if(!mf(s,r)){if(s.req)throw new Error(`cannot encode field ${n.typeName}.${s.name} to binary: required field not set`);continue}const i=s.oneof?r[s.oneof.localName].value:r[s.localName];Al(s,i,e,t)}return t.writeUnknownFields&&this.writeUnknownFields(r,e),e},writeField(r,e,t,n){e!==void 0&&Al(r,e,t,n)}}}function Tl(r,e,t,n,s){let{repeated:i,localName:o}=t;switch(t.oneof&&(r=r[t.oneof.localName],r.case!=o&&delete r.value,r.case=o,o="value"),t.kind){case"scalar":case"enum":const a=t.kind=="enum"?T.INT32:t.T;let l=zi;if(t.kind=="scalar"&&t.L>0&&(l=dm),i){let y=r[o];if(n==we.LengthDelimited&&a!=T.STRING&&a!=T.BYTES){let b=e.uint32()+e.pos;for(;e.pos<b;)y.push(l(e,a))}else y.push(l(e,a))}else r[o]=l(e,a);break;case"message":const u=t.T;i?r[o].push(Ri(e,new u,s,t)):jn(r[o])?Ri(e,r[o],s,t):(r[o]=Ri(e,new u,s,t),u.fieldWrapper&&!t.oneof&&!t.repeated&&(r[o]=u.fieldWrapper.unwrapField(r[o])));break;case"map":let[f,d]=hm(t,e,s);r[o][f]=d;break}}function Ri(r,e,t,n){const s=e.getType().runtime.bin,i=n==null?void 0:n.delimited;return s.readMessage(e,r,i?n.no:r.uint32(),t,i),e}function hm(r,e,t){const n=e.uint32(),s=e.pos+n;let i,o;for(;e.pos<s;){const[a]=e.tag();switch(a){case 1:i=zi(e,r.K);break;case 2:switch(r.V.kind){case"scalar":o=zi(e,r.V.T);break;case"enum":o=e.int32();break;case"message":o=Ri(e,new r.V.T,t,void 0);break}break}}if(i===void 0&&(i=ms(r.K,kn.BIGINT)),typeof i!="string"&&typeof i!="number"&&(i=i.toString()),o===void 0)switch(r.V.kind){case"scalar":o=ms(r.V.T,kn.BIGINT);break;case"enum":o=r.V.T.values[0].no;break;case"message":o=new r.V.T;break}return[i,o]}function dm(r,e){const t=zi(r,e);return typeof t=="bigint"?t.toString():t}function zi(r,e){switch(e){case T.STRING:return r.string();case T.BOOL:return r.bool();case T.DOUBLE:return r.double();case T.FLOAT:return r.float();case T.INT32:return r.int32();case T.INT64:return r.int64();case T.UINT64:return r.uint64();case T.FIXED64:return r.fixed64();case T.BYTES:return r.bytes();case T.FIXED32:return r.fixed32();case T.SFIXED32:return r.sfixed32();case T.SFIXED64:return r.sfixed64();case T.SINT64:return r.sint64();case T.UINT32:return r.uint32();case T.SINT32:return r.sint32()}}function Al(r,e,t,n){pe(e!==void 0);const s=r.repeated;switch(r.kind){case"scalar":case"enum":let i=r.kind=="enum"?T.INT32:r.T;if(s)if(pe(Array.isArray(e)),r.packed)mm(t,i,r.no,e);else for(const o of e)qs(t,i,r.no,o);else qs(t,i,r.no,e);break;case"message":if(s){pe(Array.isArray(e));for(const o of e)Sl(t,n,r,o)}else Sl(t,n,r,e);break;case"map":pe(typeof e=="object"&&e!=null);for(const[o,a]of Object.entries(e))gm(t,n,r,o,a);break}}function gm(r,e,t,n,s){r.tag(t.no,we.LengthDelimited),r.fork();let i=n;switch(t.K){case T.INT32:case T.FIXED32:case T.UINT32:case T.SFIXED32:case T.SINT32:i=Number.parseInt(n);break;case T.BOOL:pe(n=="true"||n=="false"),i=n=="true";break}switch(qs(r,t.K,1,i),t.V.kind){case"scalar":qs(r,t.V.T,2,s);break;case"enum":qs(r,T.INT32,2,s);break;case"message":pe(s!==void 0),r.tag(2,we.LengthDelimited).bytes(s.toBinary(e));break}r.join()}function Sl(r,e,t,n){const s=pf(t.T,n);t.delimited?r.tag(t.no,we.StartGroup).raw(s.toBinary(e)).tag(t.no,we.EndGroup):r.tag(t.no,we.LengthDelimited).bytes(s.toBinary(e))}function qs(r,e,t,n){pe(n!==void 0);let[s,i]=yf(e);r.tag(t,s)[i](n)}function mm(r,e,t,n){if(!n.length)return;r.tag(t,we.LengthDelimited).fork();let[,s]=yf(e);for(let i=0;i<n.length;i++)r[s](n[i]);r.join()}function yf(r){let e=we.Varint;switch(r){case T.BYTES:case T.STRING:e=we.LengthDelimited;break;case T.DOUBLE:case T.FIXED64:case T.SFIXED64:e=we.Bit64;break;case T.FIXED32:case T.SFIXED32:case T.FLOAT:e=we.Bit32;break}const t=T[r].toLowerCase();return[e,t]}function pm(){return{setEnumType:of,initPartial(r,e){if(r===void 0)return;const t=e.getType();for(const n of t.fields.byMember()){const s=n.localName,i=e,o=r;if(o[s]!=null)switch(n.kind){case"oneof":const a=o[s].case;if(a===void 0)continue;const l=n.findField(a);let u=o[s].value;l&&l.kind=="message"&&!jn(u,l.T)?u=new l.T(u):l&&l.kind==="scalar"&&l.T===T.BYTES&&(u=Ns(u)),i[s]={case:a,value:u};break;case"scalar":case"enum":let f=o[s];n.T===T.BYTES&&(f=n.repeated?f.map(Ns):Ns(f)),i[s]=f;break;case"map":switch(n.V.kind){case"scalar":case"enum":if(n.V.T===T.BYTES)for(const[p,b]of Object.entries(o[s]))i[s][p]=Ns(b);else Object.assign(i[s],o[s]);break;case"message":const y=n.V.T;for(const p of Object.keys(o[s])){let b=o[s][p];y.fieldWrapper||(b=new y(b)),i[s][p]=b}break}break;case"message":const d=n.T;if(n.repeated)i[s]=o[s].map(y=>jn(y,d)?y:new d(y));else{const y=o[s];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?i[s]=Ns(y):i[s]=y:i[s]=jn(y,d)?y:new d(y)}break}}},equals(r,e,t){return e===t?!0:!e||!t?!1:r.fields.byMember().every(n=>{const s=e[n.localName],i=t[n.localName];if(n.repeated){if(s.length!==i.length)return!1;switch(n.kind){case"message":return s.every((o,a)=>n.T.equals(o,i[a]));case"scalar":return s.every((o,a)=>gn(n.T,o,i[a]));case"enum":return s.every((o,a)=>gn(T.INT32,o,i[a]))}throw new Error(`repeated cannot contain ${n.kind}`)}switch(n.kind){case"message":return n.T.equals(s,i);case"enum":return gn(T.INT32,s,i);case"scalar":return gn(n.T,s,i);case"oneof":if(s.case!==i.case)return!1;const o=n.findField(s.case);if(o===void 0)return!0;switch(o.kind){case"message":return o.T.equals(s.value,i.value);case"enum":return gn(T.INT32,s.value,i.value);case"scalar":return gn(o.T,s.value,i.value)}throw new Error(`oneof cannot contain ${o.kind}`);case"map":const a=Object.keys(s).concat(Object.keys(i));switch(n.V.kind){case"message":const l=n.V.T;return a.every(f=>l.equals(s[f],i[f]));case"enum":return a.every(f=>gn(T.INT32,s[f],i[f]));case"scalar":const u=n.V.T;return a.every(f=>gn(u,s[f],i[f]))}break}})},clone(r){const e=r.getType(),t=new e,n=t;for(const s of e.fields.byMember()){const i=r[s.localName];let o;if(s.repeated)o=i.map(Ti);else if(s.kind=="map"){o=n[s.localName];for(const[a,l]of Object.entries(i))o[a]=Ti(l)}else s.kind=="oneof"?o=s.findField(i.case)?{case:i.case,value:Ti(i.value)}:{case:void 0}:o=Ti(i);n[s.localName]=o}for(const s of e.runtime.bin.listUnknownFields(r))e.runtime.bin.onUnknownField(n,s.no,s.wireType,s.data);return t}}}function Ti(r){if(r===void 0)return r;if(jn(r))return r.clone();if(r instanceof Uint8Array){const e=new Uint8Array(r.byteLength);return e.set(r),e}return r}function Ns(r){return r instanceof Uint8Array?r:new Uint8Array(r)}function ym(r,e,t){return{syntax:r,json:om(),bin:fm(),util:Object.assign(Object.assign({},pm()),{newFieldList:e,initFields:t}),makeMessageType(n,s,i){return jg(this,n,s,i)},makeEnum:zg,makeEnumType:af,getEnumType:Kg,makeExtension(n,s,i){return Qg(this,n,s,i)}}}class vm{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const t={};for(const n of this.list())t[n.jsonName]=t[n.name]=n;this.jsonNames=t}return this.jsonNames[e]}find(e){if(!this.numbers){const t={};for(const n of this.list())t[n.no]=n;this.numbers=t}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const n of this.list())n.oneof?n.oneof!==t&&(t=n.oneof,e.push(t)):e.push(n)}return this.members}}function vf(r,e){const t=wf(r);return e?t:Im(Sm(t))}function wm(r){return vf(r,!1)}const bm=wf;function wf(r){let e=!1;const t=[];for(let n=0;n<r.length;n++){let s=r.charAt(n);switch(s){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t.push(s),e=!1;break;default:e&&(e=!1,s=s.toUpperCase()),t.push(s);break}}return t.join("")}const Tm=new Set(["constructor","toString","toJSON","valueOf"]),Am=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),bf=r=>`${r}$`,Sm=r=>Am.has(r)?bf(r):r,Im=r=>Tm.has(r)?bf(r):r;class xm{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=wm(e)}addField(e){pe(e.oneof===this,`field ${e.name} not one of ${this.name}`),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}function km(r,e){var t,n,s,i,o,a;const l=[];let u;for(const f of typeof r=="function"?r():r){const d=f;if(d.localName=vf(f.name,f.oneof!==void 0),d.jsonName=(t=f.jsonName)!==null&&t!==void 0?t:bm(f.name),d.repeated=(n=f.repeated)!==null&&n!==void 0?n:!1,f.kind=="scalar"&&(d.L=(s=f.L)!==null&&s!==void 0?s:kn.BIGINT),d.delimited=(i=f.delimited)!==null&&i!==void 0?i:!1,d.req=(o=f.req)!==null&&o!==void 0?o:!1,d.opt=(a=f.opt)!==null&&a!==void 0?a:!1,f.packed===void 0&&(d.packed=f.kind=="enum"||f.kind=="scalar"&&f.T!=T.BYTES&&f.T!=T.STRING),f.oneof!==void 0){const y=typeof f.oneof=="string"?f.oneof:f.oneof.name;(!u||u.name!=y)&&(u=new xm(y)),d.oneof=u,u.addField(d)}l.push(d)}return l}const h=ym("proto3",r=>new vm(r,e=>km(e)),r=>{for(const e of r.getType().fields.byMember()){if(e.opt)continue;const t=e.localName,n=r;if(e.repeated){n[t]=[];continue}switch(e.kind){case"oneof":n[t]={case:void 0};break;case"enum":n[t]=0;break;case"map":n[t]={};break;case"scalar":n[t]=ms(e.T,e.L);break}}});var Be;(function(r){r[r.Unary=0]="Unary",r[r.ServerStreaming=1]="ServerStreaming",r[r.ClientStreaming=2]="ClientStreaming",r[r.BiDiStreaming=3]="BiDiStreaming"})(Be||(Be={}));var Il;(function(r){r[r.NoSideEffects=1]="NoSideEffects",r[r.Idempotent=2]="Idempotent"})(Il||(Il={}));class Ce extends O{constructor(e){super(),this.seconds=he.zero,this.nanos=0,h.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error(`cannot decode google.protobuf.Timestamp from JSON: ${h.json.debug(e)}`);const n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const s=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(s))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(s<Date.parse("0001-01-01T00:00:00Z")||s>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=he.parse(s/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}toJson(e){const t=Number(this.seconds)*1e3;if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let n="Z";if(this.nanos>0){const s=(this.nanos+1e9).toString().substring(1);s.substring(3)==="000000"?n="."+s.substring(0,3)+"Z":s.substring(6)==="000"?n="."+s.substring(0,6)+"Z":n="."+s+"Z"}return new Date(t).toISOString().replace(".000Z",n)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Ce.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new Ce({seconds:he.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new Ce().fromBinary(e,t)}static fromJson(e,t){return new Ce().fromJson(e,t)}static fromJsonString(e,t){return new Ce().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Ce,e,t)}}Ce.runtime=h;Ce.typeName="google.protobuf.Timestamp";Ce.fields=h.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);class sn extends O{constructor(e){super(),this.seconds=he.zero,this.nanos=0,h.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error(`cannot decode google.protobuf.Duration from JSON: ${h.json.debug(e)}`);const n=e.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(n===null)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${h.json.debug(e)}`);const s=Number(n[1]);if(s>315576e6||s<-315576e6)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${h.json.debug(e)}`);if(this.seconds=he.parse(s),typeof n[2]=="string"){const i=n[2]+"0".repeat(9-n[2].length);this.nanos=parseInt(i),(s<0||Object.is(s,-0))&&(this.nanos=-this.nanos)}return this}toJson(e){if(Number(this.seconds)>315576e6||Number(this.seconds)<-315576e6)throw new Error("cannot encode google.protobuf.Duration to JSON: value out of range");let t=this.seconds.toString();if(this.nanos!==0){let n=Math.abs(this.nanos).toString();n="0".repeat(9-n.length)+n,n.substring(3)==="000000"?n=n.substring(0,3):n.substring(6)==="000"&&(n=n.substring(0,6)),t+="."+n,this.nanos<0&&Number(this.seconds)==0&&(t="-"+t)}return t+"s"}static fromBinary(e,t){return new sn().fromBinary(e,t)}static fromJson(e,t){return new sn().fromJson(e,t)}static fromJsonString(e,t){return new sn().fromJsonString(e,t)}static equals(e,t){return h.util.equals(sn,e,t)}}sn.runtime=h;sn.typeName="google.protobuf.Duration";sn.fields=h.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);class Lt extends O{constructor(e){super(),this.typeUrl="",this.value=new Uint8Array(0),h.util.initPartial(e,this)}toJson(e){var t;if(this.typeUrl==="")return{};const n=this.typeUrlToName(this.typeUrl),s=(t=e==null?void 0:e.typeRegistry)===null||t===void 0?void 0:t.findMessage(n);if(!s)throw new Error(`cannot encode message google.protobuf.Any to JSON: "${this.typeUrl}" is not in the type registry`);let o=s.fromBinary(this.value).toJson(e);return(n.startsWith("google.protobuf.")||o===null||Array.isArray(o)||typeof o!="object")&&(o={value:o}),o["@type"]=this.typeUrl,o}fromJson(e,t){var n;if(e===null||Array.isArray(e)||typeof e!="object")throw new Error(`cannot decode message google.protobuf.Any from JSON: expected object but got ${e===null?"null":Array.isArray(e)?"array":typeof e}`);if(Object.keys(e).length==0)return this;const s=e["@type"];if(typeof s!="string"||s=="")throw new Error('cannot decode message google.protobuf.Any from JSON: "@type" is empty');const i=this.typeUrlToName(s),o=(n=t==null?void 0:t.typeRegistry)===null||n===void 0?void 0:n.findMessage(i);if(!o)throw new Error(`cannot decode message google.protobuf.Any from JSON: ${s} is not in the type registry`);let a;if(i.startsWith("google.protobuf.")&&Object.prototype.hasOwnProperty.call(e,"value"))a=o.fromJson(e.value,t);else{const l=Object.assign({},e);delete l["@type"],a=o.fromJson(l,t)}return this.packFrom(a),this}packFrom(e){this.value=e.toBinary(),this.typeUrl=this.typeNameToUrl(e.getType().typeName)}unpackTo(e){return this.is(e.getType())?(e.fromBinary(this.value),!0):!1}unpack(e){if(this.typeUrl==="")return;const t=e.findMessage(this.typeUrlToName(this.typeUrl));if(t)return t.fromBinary(this.value)}is(e){if(this.typeUrl==="")return!1;const t=this.typeUrlToName(this.typeUrl);let n="";return typeof e=="string"?n=e:n=e.typeName,t===n}typeNameToUrl(e){return`type.googleapis.com/${e}`}typeUrlToName(e){if(!e.length)throw new Error(`invalid type url: ${e}`);const t=e.lastIndexOf("/"),n=t>=0?e.substring(t+1):e;if(!n.length)throw new Error(`invalid type url: ${e}`);return n}static pack(e){const t=new Lt;return t.packFrom(e),t}static fromBinary(e,t){return new Lt().fromBinary(e,t)}static fromJson(e,t){return new Lt().fromJson(e,t)}static fromJsonString(e,t){return new Lt().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Lt,e,t)}}Lt.runtime=h;Lt.typeName="google.protobuf.Any";Lt.fields=h.util.newFieldList(()=>[{no:1,name:"type_url",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:12}]);class Jt extends O{constructor(e){super(),this.value=0,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(T.DOUBLE,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(T.DOUBLE,e)}catch(n){let s='cannot decode message google.protobuf.DoubleValue from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new Jt().fromBinary(e,t)}static fromJson(e,t){return new Jt().fromJson(e,t)}static fromJsonString(e,t){return new Jt().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Jt,e,t)}}Jt.runtime=h;Jt.typeName="google.protobuf.DoubleValue";Jt.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:1}]);Jt.fieldWrapper={wrapField(r){return new Jt({value:r})},unwrapField(r){return r.value}};class Mt extends O{constructor(e){super(),this.value=0,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(T.FLOAT,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(T.FLOAT,e)}catch(n){let s='cannot decode message google.protobuf.FloatValue from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new Mt().fromBinary(e,t)}static fromJson(e,t){return new Mt().fromJson(e,t)}static fromJsonString(e,t){return new Mt().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Mt,e,t)}}Mt.runtime=h;Mt.typeName="google.protobuf.FloatValue";Mt.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:2}]);Mt.fieldWrapper={wrapField(r){return new Mt({value:r})},unwrapField(r){return r.value}};class Ft extends O{constructor(e){super(),this.value=he.zero,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(T.INT64,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(T.INT64,e)}catch(n){let s='cannot decode message google.protobuf.Int64Value from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new Ft().fromBinary(e,t)}static fromJson(e,t){return new Ft().fromJson(e,t)}static fromJsonString(e,t){return new Ft().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Ft,e,t)}}Ft.runtime=h;Ft.typeName="google.protobuf.Int64Value";Ft.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:3}]);Ft.fieldWrapper={wrapField(r){return new Ft({value:r})},unwrapField(r){return r.value}};class $t extends O{constructor(e){super(),this.value=he.zero,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(T.UINT64,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(T.UINT64,e)}catch(n){let s='cannot decode message google.protobuf.UInt64Value from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new $t().fromBinary(e,t)}static fromJson(e,t){return new $t().fromJson(e,t)}static fromJsonString(e,t){return new $t().fromJsonString(e,t)}static equals(e,t){return h.util.equals($t,e,t)}}$t.runtime=h;$t.typeName="google.protobuf.UInt64Value";$t.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:4}]);$t.fieldWrapper={wrapField(r){return new $t({value:r})},unwrapField(r){return r.value}};class Ut extends O{constructor(e){super(),this.value=0,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(T.INT32,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(T.INT32,e)}catch(n){let s='cannot decode message google.protobuf.Int32Value from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new Ut().fromBinary(e,t)}static fromJson(e,t){return new Ut().fromJson(e,t)}static fromJsonString(e,t){return new Ut().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Ut,e,t)}}Ut.runtime=h;Ut.typeName="google.protobuf.Int32Value";Ut.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:5}]);Ut.fieldWrapper={wrapField(r){return new Ut({value:r})},unwrapField(r){return r.value}};class qt extends O{constructor(e){super(),this.value=0,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(T.UINT32,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(T.UINT32,e)}catch(n){let s='cannot decode message google.protobuf.UInt32Value from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new qt().fromBinary(e,t)}static fromJson(e,t){return new qt().fromJson(e,t)}static fromJsonString(e,t){return new qt().fromJsonString(e,t)}static equals(e,t){return h.util.equals(qt,e,t)}}qt.runtime=h;qt.typeName="google.protobuf.UInt32Value";qt.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:13}]);qt.fieldWrapper={wrapField(r){return new qt({value:r})},unwrapField(r){return r.value}};class Vt extends O{constructor(e){super(),this.value=!1,h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(T.BOOL,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(T.BOOL,e)}catch(n){let s='cannot decode message google.protobuf.BoolValue from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new Vt().fromBinary(e,t)}static fromJson(e,t){return new Vt().fromJson(e,t)}static fromJsonString(e,t){return new Vt().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Vt,e,t)}}Vt.runtime=h;Vt.typeName="google.protobuf.BoolValue";Vt.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:8}]);Vt.fieldWrapper={wrapField(r){return new Vt({value:r})},unwrapField(r){return r.value}};class Ge extends O{constructor(e){super(),this.value="",h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(T.STRING,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(T.STRING,e)}catch(n){let s='cannot decode message google.protobuf.StringValue from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new Ge().fromBinary(e,t)}static fromJson(e,t){return new Ge().fromJson(e,t)}static fromJsonString(e,t){return new Ge().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Ge,e,t)}}Ge.runtime=h;Ge.typeName="google.protobuf.StringValue";Ge.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:9}]);Ge.fieldWrapper={wrapField(r){return new Ge({value:r})},unwrapField(r){return r.value}};class Kt extends O{constructor(e){super(),this.value=new Uint8Array(0),h.util.initPartial(e,this)}toJson(e){return h.json.writeScalar(T.BYTES,this.value,!0)}fromJson(e,t){try{this.value=h.json.readScalar(T.BYTES,e)}catch(n){let s='cannot decode message google.protobuf.BytesValue from JSON"';throw n instanceof Error&&n.message.length>0&&(s+=`: ${n.message}`),new Error(s)}return this}static fromBinary(e,t){return new Kt().fromBinary(e,t)}static fromJson(e,t){return new Kt().fromJson(e,t)}static fromJsonString(e,t){return new Kt().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Kt,e,t)}}Kt.runtime=h;Kt.typeName="google.protobuf.BytesValue";Kt.fields=h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:12}]);Kt.fieldWrapper={wrapField(r){return new Kt({value:r})},unwrapField(r){return r.value}};function Em(r,e,t){try{const n=ic.dec(r);return e?e.fromBinary(n,t):n}catch(n){throw ne.from(n,X.DataLoss)}}function Cm(r,e){const t={};for(const[n,s]of Object.entries(r.methods)){const i=e(Object.assign(Object.assign({},s),{localName:n,service:r}));i!=null&&(t[n]=i)}return t}const xl=1;function kl(r){let e,t=new Uint8Array(0);function n(s){const i=new Uint8Array(t.length+s.length);i.set(t),i.set(s,t.length),t=i}return new ReadableStream({start(){e=r.getReader()},async pull(s){let i;for(;;){if(i===void 0&&t.byteLength>=5){let l=0;for(let u=1;u<5;u++)l=(l<<8)+t[u];i={flags:t[0],length:l}}if(i!==void 0&&t.byteLength>=i.length+5)break;const a=await e.read();if(a.done)break;n(a.value)}if(i===void 0){if(t.byteLength==0){s.close();return}s.error(new ne("premature end of stream",X.DataLoss));return}const o=t.subarray(5,5+i.length);t=t.subarray(5+i.length),s.enqueue({flags:i.flags,data:o})}})}function El(r,e){const t=new Uint8Array(e.length+5);t.set(e,5);const n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setUint8(0,r),n.setUint32(1,e.length),t}var Nm=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof __values=="function"?__values(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(a,l){o=r[i](o),s(a,l,o.done,o.value)})}}function s(i,o,a,l){Promise.resolve(l).then(function(u){i({value:u,done:a})},o)}},Xs=function(r){return this instanceof Xs?(this.v=r,this):new Xs(r)},Pm=function(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(p){return function(b){return Promise.resolve(b).then(p,d)}}function a(p,b){n[p]&&(s[p]=function(S){return new Promise(function(B,D){i.push([p,S,B,D])>1||l(p,S)})},b&&(s[p]=b(s[p])))}function l(p,b){try{u(n[p](b))}catch(S){y(i[0][3],S)}}function u(p){p.value instanceof Xs?Promise.resolve(p.value.v).then(f,d):y(i[0][2],p)}function f(p){l("next",p)}function d(p){l("throw",p)}function y(p,b){p(b),i.shift(),i.length&&l(i[0][0],i[0][1])}},Om=function(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:Xs(r[s](o)),done:!1}:i?i(o):o}:i}};function Dm(r){return Pm(this,arguments,function*(){yield Xs(yield*Om(Nm(r)))})}var Tf=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof __values=="function"?__values(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(a,l){o=r[i](o),s(a,l,o.done,o.value)})}}function s(i,o,a,l){Promise.resolve(l).then(function(u){i({value:u,done:a})},o)}},ps=function(r){return this instanceof ps?(this.v=r,this):new ps(r)},Bm=function(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:ps(r[s](o)),done:!1}:i?i(o):o}:i}},Rm=function(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(p){return function(b){return Promise.resolve(b).then(p,d)}}function a(p,b){n[p]&&(s[p]=function(S){return new Promise(function(B,D){i.push([p,S,B,D])>1||l(p,S)})},b&&(s[p]=b(s[p])))}function l(p,b){try{u(n[p](b))}catch(S){y(i[0][3],S)}}function u(p){p.value instanceof ps?Promise.resolve(p.value.v).then(f,d):y(i[0][2],p)}function f(p){l("next",p)}function d(p){l("throw",p)}function y(p,b){p(b),i.shift(),i.length&&l(i[0][0],i[0][1])}};function Lm(r,e){return Cm(r,t=>{switch(t.kind){case Be.Unary:return Jm(e,r,t);case Be.ServerStreaming:return Mm(e,r,t);case Be.ClientStreaming:return Fm(e,r,t);case Be.BiDiStreaming:return $m(e,r,t);default:return null}})}function Jm(r,e,t){return async function(n,s){var i,o;const a=await r.unary(e,t,s==null?void 0:s.signal,s==null?void 0:s.timeoutMs,s==null?void 0:s.headers,n,s==null?void 0:s.contextValues);return(i=s==null?void 0:s.onHeader)===null||i===void 0||i.call(s,a.header),(o=s==null?void 0:s.onTrailer)===null||o===void 0||o.call(s,a.trailer),a.message}}function Mm(r,e,t){return function(n,s){return Af(r.stream(e,t,s==null?void 0:s.signal,s==null?void 0:s.timeoutMs,s==null?void 0:s.headers,Dm([n]),s==null?void 0:s.contextValues),s)}}function Fm(r,e,t){return async function(n,s){var i,o,a,l,u,f;const d=await r.stream(e,t,s==null?void 0:s.signal,s==null?void 0:s.timeoutMs,s==null?void 0:s.headers,n,s==null?void 0:s.contextValues);(u=s==null?void 0:s.onHeader)===null||u===void 0||u.call(s,d.header);let y,p=0;try{for(var b=!0,S=Tf(d.message),B;B=await S.next(),i=B.done,!i;b=!0)l=B.value,b=!1,y=l,p++}catch(D){o={error:D}}finally{try{!b&&!i&&(a=S.return)&&await a.call(S)}finally{if(o)throw o.error}}if(!y)throw new ne("protocol error: missing response message",X.Unimplemented);if(p>1)throw new ne("protocol error: received extra messages for client streaming method",X.Unimplemented);return(f=s==null?void 0:s.onTrailer)===null||f===void 0||f.call(s,d.trailer),y}}function $m(r,e,t){return function(n,s){return Af(r.stream(e,t,s==null?void 0:s.signal,s==null?void 0:s.timeoutMs,s==null?void 0:s.headers,n,s==null?void 0:s.contextValues),s)}}function Af(r,e){const t=function(){return Rm(this,arguments,function*(){var n,s;const i=yield ps(r);(n=e==null?void 0:e.onHeader)===null||n===void 0||n.call(e,i.header),yield ps(yield*Bm(Tf(i.message))),(s=e==null?void 0:e.onTrailer)===null||s===void 0||s.call(e,i.trailer)})}()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>t.next()})}}function Um(...r){const e=new AbortController,t=r.filter(s=>s!==void 0).concat(e.signal);for(const s of t){if(s.aborted){n.apply(s);break}s.addEventListener("abort",n)}function n(){e.signal.aborted||e.abort(Sf(this));for(const s of t)s.removeEventListener("abort",n)}return e}function qm(r){const e=new AbortController,t=()=>{e.abort(new ne("the operation timed out",X.DeadlineExceeded))};let n;return r!==void 0&&(r<=0?t():n=setTimeout(t,r)),{signal:e.signal,cleanup:()=>clearTimeout(n)}}function Sf(r){if(!r.aborted)return;if(r.reason!==void 0)return r.reason;const e=new Error("This operation was aborted");return e.name="AbortError",e}function Cl(){return{get(r){return r.id in this?this[r.id]:r.defaultValue},set(r,e){return this[r.id]=e,this},delete(r){return delete this[r.id],this}}}const Wo=128;function Nl(r){const e=new Headers,t=new TextDecoder().decode(r).split(`\r
`);for(const n of t){if(n==="")continue;const s=n.indexOf(":");if(s>0){const i=n.substring(0,s).trim(),o=n.substring(s+1).trim();e.append(i,o)}}return e}const Vm="Content-Type",Km="Grpc-Timeout",ys="Grpc-Status",If="Grpc-Message",zm="Grpc-Status-Details-Bin",jm="X-User-Agent",Hm="X-Grpc-Web",Wm="application/grpc-web+proto",_m="application/grpc-web+json";class on extends O{constructor(e){super(),this.code=0,this.message="",this.details=[],h.util.initPartial(e,this)}static fromBinary(e,t){return new on().fromBinary(e,t)}static fromJson(e,t){return new on().fromJson(e,t)}static fromJsonString(e,t){return new on().fromJsonString(e,t)}static equals(e,t){return h.util.equals(on,e,t)}}on.runtime=h;on.typeName="google.rpc.Status";on.fields=h.util.newFieldList(()=>[{no:1,name:"code",kind:"scalar",T:5},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"details",kind:"message",T:Lt,repeated:!0}]);const Gm="0";function xf(r){var e;const t=r.get(zm);if(t!=null){const s=Em(t,on);if(s.code==0)return;const i=new ne(s.message,s.code,r);return i.details=s.details.map(o=>({type:o.typeUrl.substring(o.typeUrl.lastIndexOf("/")+1),value:o.value})),i}const n=r.get(ys);if(n!=null){if(n===Gm)return;const s=parseInt(n,10);return s in X?new ne(decodeURIComponent((e=r.get(If))!==null&&e!==void 0?e:""),s,r):new ne(`invalid grpc-status: ${n}`,X.Internal,r)}}function Pl(r,e,t){const n=typeof e=="string"?e:e.typeName,s=typeof t=="string"?t:t.name;return r.toString().replace(/\/?$/,`/${n}/${s}`)}function kf(r,e){return e instanceof r?e:new r(e)}function Ym(r,e){function t(n){return n.done===!0?n:{done:n.done,value:kf(r,n.value)}}return{[Symbol.asyncIterator](){const n=e[Symbol.asyncIterator](),s={next:()=>n.next().then(t)};return n.throw!==void 0&&(s.throw=i=>n.throw(i).then(t)),n.return!==void 0&&(s.return=i=>n.return(i).then(t)),s}}}function Ef(r,e){var t;return(t=e==null?void 0:e.concat().reverse().reduce((n,s)=>s(n),r))!==null&&t!==void 0?t:r}function Xm(r){var e;const t=Object.assign({},r);return(e=t.ignoreUnknownFields)!==null&&e!==void 0||(t.ignoreUnknownFields=!0),t}function Ol(r,e,t,n){const s=e?Dl(r.I,n):Bl(r.I,t);return{parse:(e?Dl(r.O,n):Bl(r.O,t)).parse,serialize:s.serialize}}function Dl(r,e){return{parse(t){try{return r.fromBinary(t,e)}catch(n){const s=n instanceof Error?n.message:String(n);throw new ne(`parse binary: ${s}`,X.Internal)}},serialize(t){try{return t.toBinary(e)}catch(n){const s=n instanceof Error?n.message:String(n);throw new ne(`serialize binary: ${s}`,X.Internal)}}}}function Bl(r,e){var t,n;const s=(t=e==null?void 0:e.textEncoder)!==null&&t!==void 0?t:new TextEncoder,i=(n=e==null?void 0:e.textDecoder)!==null&&n!==void 0?n:new TextDecoder,o=Xm(e);return{parse(a){try{const l=i.decode(a);return r.fromJsonString(l,o)}catch(l){throw ne.from(l,X.InvalidArgument)}},serialize(a){try{const l=a.toJsonString(o);return s.encode(l)}catch(l){throw ne.from(l,X.Internal)}}}}function Zm(r){const e=Ef(r.next,r.interceptors),[t,n,s]=Cf(r),i=Object.assign(Object.assign({},r.req),{message:kf(r.req.method.I,r.req.message),signal:t});return e(i).then(o=>(s(),o),n)}function Qm(r){const e=Ef(r.next,r.interceptors),[t,n,s]=Cf(r),i=Object.assign(Object.assign({},r.req),{message:Ym(r.req.method.I,r.req.message),signal:t});let o=!1;return t.addEventListener("abort",function(){var a,l;const u=r.req.message[Symbol.asyncIterator]();o||(a=u.throw)===null||a===void 0||a.call(u,this.reason).catch(()=>{}),(l=u.return)===null||l===void 0||l.call(u).catch(()=>{})}),e(i).then(a=>Object.assign(Object.assign({},a),{message:{[Symbol.asyncIterator](){const l=a.message[Symbol.asyncIterator]();return{next(){return l.next().then(u=>(u.done==!0&&(o=!0,s()),u),n)}}}}}),n)}function Cf(r){const{signal:e,cleanup:t}=qm(r.timeoutMs),n=Um(r.signal,e);return[n.signal,function(i){const o=ne.from(e.aborted?Sf(e):i);return n.abort(o),t(),Promise.reject(o)},function(){t(),n.abort()}]}function ep(){try{new Headers}catch{throw new Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}}function Rl(r,e){const t=xf(r);if(t)throw e.forEach((n,s)=>{t.metadata.append(s,n)}),t;if(!e.has(ys)&&!r.has(ys))throw new ne("protocol error: missing status",X.Internal)}function Ll(r,e,t,n){const s=new Headers(t??{});return s.set(Vm,r?Wm:_m),s.set(Hm,"1"),s.set(jm,"connect-es/1.6.1"),e!==void 0&&s.set(Km,`${e}m`),s}function tp(r){switch(r){case 400:return X.Internal;case 401:return X.Unauthenticated;case 403:return X.PermissionDenied;case 404:return X.Unimplemented;case 429:return X.Unavailable;case 502:return X.Unavailable;case 503:return X.Unavailable;case 504:return X.Unavailable;default:return X.Unknown}}function Jl(r,e){var t;if(r>=200&&r<300)return{foundStatus:e.has(ys),headerError:xf(e)};throw new ne(decodeURIComponent((t=e.get(If))!==null&&t!==void 0?t:`HTTP ${r}`),tp(r),e)}var Un=function(r){return this instanceof Un?(this.v=r,this):new Un(r)},rp=function(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(p){return function(b){return Promise.resolve(b).then(p,d)}}function a(p,b){n[p]&&(s[p]=function(S){return new Promise(function(B,D){i.push([p,S,B,D])>1||l(p,S)})},b&&(s[p]=b(s[p])))}function l(p,b){try{u(n[p](b))}catch(S){y(i[0][3],S)}}function u(p){p.value instanceof Un?Promise.resolve(p.value.v).then(f,d):y(i[0][2],p)}function f(p){l("next",p)}function d(p){l("throw",p)}function y(p,b){p(b),i.shift(),i.length&&l(i[0][0],i[0][1])}};function np(r){var e;ep();const t=(e=r.useBinaryFormat)!==null&&e!==void 0?e:!0;return{async unary(n,s,i,o,a,l,u){var f;const{serialize:d,parse:y}=Ol(s,t,r.jsonOptions,r.binaryOptions);return o=o===void 0?r.defaultTimeoutMs:o<=0?void 0:o,await Zm({interceptors:r.interceptors,signal:i,timeoutMs:o,req:{stream:!1,service:n,method:s,url:Pl(r.baseUrl,n,s),init:{method:"POST",credentials:(f=r.credentials)!==null&&f!==void 0?f:"same-origin",redirect:"error",mode:"cors"},header:Ll(t,o,a),contextValues:u??Cl(),message:l},next:async p=>{var b;const B=await((b=r.fetch)!==null&&b!==void 0?b:globalThis.fetch)(p.url,Object.assign(Object.assign({},p.init),{headers:p.header,signal:p.signal,body:El(0,d(p.message))})),{headerError:D}=Jl(B.status,B.headers);if(!B.body)throw D!==void 0?D:"missing response body";const F=kl(B.body).getReader();let V,J;for(;;){const q=await F.read();if(q.done)break;const{flags:Y,data:Z}=q.value;if((Y&xl)===xl)throw new ne("protocol error: received unsupported compressed output",X.Internal);if(Y===Wo){if(V!==void 0)throw"extra trailer";V=Nl(Z);continue}if(J!==void 0)throw new ne("extra message",X.Unimplemented);J=y(Z)}if(V===void 0)throw D!==void 0?D:new ne("missing trailer",B.headers.has(ys)?X.Unimplemented:X.Unknown);if(Rl(V,B.headers),J===void 0)throw new ne("missing message",V.has(ys)?X.Unimplemented:X.Unknown);return{stream:!1,service:n,method:s,header:B.headers,message:J,trailer:V}}})},async stream(n,s,i,o,a,l,u){var f;const{serialize:d,parse:y}=Ol(s,t,r.jsonOptions,r.binaryOptions);function p(S,B,D,F,V){return rp(this,arguments,function*(){const q=kl(S).getReader();if(B){if(!(yield Un(q.read())).done)throw"extra data for trailers-only";return yield Un(void 0)}let Y=!1;for(;;){const Z=yield Un(q.read());if(Z.done)break;const{flags:se,data:Ie}=Z.value;if((se&Wo)===Wo){if(Y)throw"extra trailer";Y=!0;const Se=Nl(Ie);Rl(Se,F),Se.forEach((Qe,Gt)=>D.set(Gt,Qe));continue}if(Y)throw"extra message";yield yield Un(y(Ie))}if("throwIfAborted"in V&&V.throwIfAborted(),!Y)throw"missing trailer"})}async function b(S){if(s.kind!=Be.ServerStreaming)throw"The fetch API does not support streaming request bodies";const B=await S[Symbol.asyncIterator]().next();if(B.done==!0)throw"missing request message";return El(0,d(B.value))}return o=o===void 0?r.defaultTimeoutMs:o<=0?void 0:o,Qm({interceptors:r.interceptors,signal:i,timeoutMs:o,req:{stream:!0,service:n,method:s,url:Pl(r.baseUrl,n,s),init:{method:"POST",credentials:(f=r.credentials)!==null&&f!==void 0?f:"same-origin",redirect:"error",mode:"cors"},header:Ll(t,o,a),contextValues:u??Cl(),message:l},next:async S=>{var B;const F=await((B=r.fetch)!==null&&B!==void 0?B:globalThis.fetch)(S.url,Object.assign(Object.assign({},S.init),{headers:S.header,signal:S.signal,body:await b(S.message)})),{foundStatus:V,headerError:J}=Jl(F.status,F.headers);if(J!=null)throw J;if(!F.body)throw"missing response body";const q=new Headers;return Object.assign(Object.assign({},S),{header:F.headers,trailer:q,message:p(F.body,V,q,F.headers,S.signal)})}})}}}var _=(r=>(r[r.NULL=0]="NULL",r[r.BOOLEAN=1]="BOOLEAN",r[r.INTEGER=2]="INTEGER",r[r.LONG=3]="LONG",r[r.DOUBLE=4]="DOUBLE",r[r.STRING=5]="STRING",r[r.BYTES=6]="BYTES",r[r.DATE=7]="DATE",r[r.JSON_OBJECT=8]="JSON_OBJECT",r[r.JSON_ARRAY=9]="JSON_ARRAY",r[r.TEXT=10]="TEXT",r[r.INTEGER_CNT=11]="INTEGER_CNT",r[r.LONG_CNT=12]="LONG_CNT",r[r.TREE=13]="TREE",r))(_||{});h.util.setEnumType(_,"yorkie.v1.ValueType",[{no:0,name:"VALUE_TYPE_NULL"},{no:1,name:"VALUE_TYPE_BOOLEAN"},{no:2,name:"VALUE_TYPE_INTEGER"},{no:3,name:"VALUE_TYPE_LONG"},{no:4,name:"VALUE_TYPE_DOUBLE"},{no:5,name:"VALUE_TYPE_STRING"},{no:6,name:"VALUE_TYPE_BYTES"},{no:7,name:"VALUE_TYPE_DATE"},{no:8,name:"VALUE_TYPE_JSON_OBJECT"},{no:9,name:"VALUE_TYPE_JSON_ARRAY"},{no:10,name:"VALUE_TYPE_TEXT"},{no:11,name:"VALUE_TYPE_INTEGER_CNT"},{no:12,name:"VALUE_TYPE_LONG_CNT"},{no:13,name:"VALUE_TYPE_TREE"}]);var Hn=(r=>(r[r.DOCUMENT_CHANGED=0]="DOCUMENT_CHANGED",r[r.DOCUMENT_WATCHED=1]="DOCUMENT_WATCHED",r[r.DOCUMENT_UNWATCHED=2]="DOCUMENT_UNWATCHED",r[r.DOCUMENT_BROADCAST=3]="DOCUMENT_BROADCAST",r))(Hn||{});h.util.setEnumType(Hn,"yorkie.v1.DocEventType",[{no:0,name:"DOC_EVENT_TYPE_DOCUMENT_CHANGED"},{no:1,name:"DOC_EVENT_TYPE_DOCUMENT_WATCHED"},{no:2,name:"DOC_EVENT_TYPE_DOCUMENT_UNWATCHED"},{no:3,name:"DOC_EVENT_TYPE_DOCUMENT_BROADCAST"}]);const tr=class tr extends O{constructor(t){super();c(this,"root");c(this,"presences",{});h.util.initPartial(t,this)}static fromBinary(t,n){return new tr().fromBinary(t,n)}static fromJson(t,n){return new tr().fromJson(t,n)}static fromJsonString(t,n){return new tr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(tr,t,n)}};c(tr,"runtime",h),c(tr,"typeName","yorkie.v1.Snapshot"),c(tr,"fields",h.util.newFieldList(()=>[{no:1,name:"root",kind:"message",T:Ke},{no:2,name:"presences",kind:"map",K:9,V:{kind:"message",T:ac}}]));let da=tr;var rt;let dn=(rt=class extends O{constructor(t){super();c(this,"documentKey","");c(this,"checkpoint");c(this,"snapshot",new Uint8Array(0));c(this,"changes",[]);c(this,"minSyncedTicket");c(this,"isRemoved",!1);c(this,"versionVector");h.util.initPartial(t,this)}static fromBinary(t,n){return new rt().fromBinary(t,n)}static fromJson(t,n){return new rt().fromJson(t,n)}static fromJsonString(t,n){return new rt().fromJsonString(t,n)}static equals(t,n){return h.util.equals(rt,t,n)}},c(rt,"runtime",h),c(rt,"typeName","yorkie.v1.ChangePack"),c(rt,"fields",h.util.newFieldList(()=>[{no:1,name:"document_key",kind:"scalar",T:9},{no:2,name:"checkpoint",kind:"message",T:Of},{no:3,name:"snapshot",kind:"scalar",T:12},{no:4,name:"changes",kind:"message",T:Nf,repeated:!0},{no:5,name:"min_synced_ticket",kind:"message",T:M},{no:6,name:"is_removed",kind:"scalar",T:8},{no:7,name:"version_vector",kind:"message",T:ko}])),rt);var nt;let Nf=(nt=class extends O{constructor(t){super();c(this,"id");c(this,"message","");c(this,"operations",[]);c(this,"presenceChange");h.util.initPartial(t,this)}static fromBinary(t,n){return new nt().fromBinary(t,n)}static fromJson(t,n){return new nt().fromJson(t,n)}static fromJsonString(t,n){return new nt().fromJsonString(t,n)}static equals(t,n){return h.util.equals(nt,t,n)}},c(nt,"runtime",h),c(nt,"typeName","yorkie.v1.Change"),c(nt,"fields",h.util.newFieldList(()=>[{no:1,name:"id",kind:"message",T:xo},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"operations",kind:"message",T:oc,repeated:!0},{no:4,name:"presence_change",kind:"message",T:ei}])),nt);var st;let xo=(st=class extends O{constructor(t){super();c(this,"clientSeq",0);c(this,"serverSeq",he.zero);c(this,"lamport",he.zero);c(this,"actorId",new Uint8Array(0));c(this,"versionVector");h.util.initPartial(t,this)}static fromBinary(t,n){return new st().fromBinary(t,n)}static fromJson(t,n){return new st().fromJson(t,n)}static fromJsonString(t,n){return new st().fromJsonString(t,n)}static equals(t,n){return h.util.equals(st,t,n)}},c(st,"runtime",h),c(st,"typeName","yorkie.v1.ChangeID"),c(st,"fields",h.util.newFieldList(()=>[{no:1,name:"client_seq",kind:"scalar",T:13},{no:2,name:"server_seq",kind:"scalar",T:3},{no:3,name:"lamport",kind:"scalar",T:3},{no:4,name:"actor_id",kind:"scalar",T:12},{no:5,name:"version_vector",kind:"message",T:ko}])),st);var it;let ko=(it=class extends O{constructor(t){super();c(this,"vector",{});h.util.initPartial(t,this)}static fromBinary(t,n){return new it().fromBinary(t,n)}static fromJson(t,n){return new it().fromJson(t,n)}static fromJsonString(t,n){return new it().fromJsonString(t,n)}static equals(t,n){return h.util.equals(it,t,n)}},c(it,"runtime",h),c(it,"typeName","yorkie.v1.VersionVector"),c(it,"fields",h.util.newFieldList(()=>[{no:1,name:"vector",kind:"map",K:9,V:{kind:"scalar",T:3}}])),it);var ot;let oc=(ot=class extends O{constructor(t){super();c(this,"body",{case:void 0});h.util.initPartial(t,this)}static fromBinary(t,n){return new ot().fromBinary(t,n)}static fromJson(t,n){return new ot().fromJson(t,n)}static fromJsonString(t,n){return new ot().fromJsonString(t,n)}static equals(t,n){return h.util.equals(ot,t,n)}},c(ot,"runtime",h),c(ot,"typeName","yorkie.v1.Operation"),c(ot,"fields",h.util.newFieldList(()=>[{no:1,name:"set",kind:"message",T:ji,oneof:"body"},{no:2,name:"add",kind:"message",T:Hi,oneof:"body"},{no:3,name:"move",kind:"message",T:Wi,oneof:"body"},{no:4,name:"remove",kind:"message",T:_i,oneof:"body"},{no:5,name:"edit",kind:"message",T:Gi,oneof:"body"},{no:6,name:"select",kind:"message",T:ga,oneof:"body"},{no:7,name:"style",kind:"message",T:Yi,oneof:"body"},{no:8,name:"increase",kind:"message",T:Xi,oneof:"body"},{no:9,name:"tree_edit",kind:"message",T:Zi,oneof:"body"},{no:10,name:"tree_style",kind:"message",T:Qi,oneof:"body"},{no:11,name:"array_set",kind:"message",T:ma,oneof:"body"}])),ot);const rr=class rr extends O{constructor(t){super();c(this,"parentCreatedAt");c(this,"key","");c(this,"value");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new rr().fromBinary(t,n)}static fromJson(t,n){return new rr().fromJson(t,n)}static fromJsonString(t,n){return new rr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(rr,t,n)}};c(rr,"runtime",h),c(rr,"typeName","yorkie.v1.Operation.Set"),c(rr,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:M},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"value",kind:"message",T:tt},{no:4,name:"executed_at",kind:"message",T:M}]));let ji=rr;const nr=class nr extends O{constructor(t){super();c(this,"parentCreatedAt");c(this,"prevCreatedAt");c(this,"value");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new nr().fromBinary(t,n)}static fromJson(t,n){return new nr().fromJson(t,n)}static fromJsonString(t,n){return new nr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(nr,t,n)}};c(nr,"runtime",h),c(nr,"typeName","yorkie.v1.Operation.Add"),c(nr,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:M},{no:2,name:"prev_created_at",kind:"message",T:M},{no:3,name:"value",kind:"message",T:tt},{no:4,name:"executed_at",kind:"message",T:M}]));let Hi=nr;const sr=class sr extends O{constructor(t){super();c(this,"parentCreatedAt");c(this,"prevCreatedAt");c(this,"createdAt");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new sr().fromBinary(t,n)}static fromJson(t,n){return new sr().fromJson(t,n)}static fromJsonString(t,n){return new sr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(sr,t,n)}};c(sr,"runtime",h),c(sr,"typeName","yorkie.v1.Operation.Move"),c(sr,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:M},{no:2,name:"prev_created_at",kind:"message",T:M},{no:3,name:"created_at",kind:"message",T:M},{no:4,name:"executed_at",kind:"message",T:M}]));let Wi=sr;const ir=class ir extends O{constructor(t){super();c(this,"parentCreatedAt");c(this,"createdAt");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new ir().fromBinary(t,n)}static fromJson(t,n){return new ir().fromJson(t,n)}static fromJsonString(t,n){return new ir().fromJsonString(t,n)}static equals(t,n){return h.util.equals(ir,t,n)}};c(ir,"runtime",h),c(ir,"typeName","yorkie.v1.Operation.Remove"),c(ir,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:M},{no:2,name:"created_at",kind:"message",T:M},{no:3,name:"executed_at",kind:"message",T:M}]));let _i=ir;const or=class or extends O{constructor(t){super();c(this,"parentCreatedAt");c(this,"from");c(this,"to");c(this,"createdAtMapByActor",{});c(this,"content","");c(this,"executedAt");c(this,"attributes",{});h.util.initPartial(t,this)}static fromBinary(t,n){return new or().fromBinary(t,n)}static fromJson(t,n){return new or().fromJson(t,n)}static fromJsonString(t,n){return new or().fromJsonString(t,n)}static equals(t,n){return h.util.equals(or,t,n)}};c(or,"runtime",h),c(or,"typeName","yorkie.v1.Operation.Edit"),c(or,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:M},{no:2,name:"from",kind:"message",T:un},{no:3,name:"to",kind:"message",T:un},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:M}},{no:5,name:"content",kind:"scalar",T:9},{no:6,name:"executed_at",kind:"message",T:M},{no:7,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}]));let Gi=or;const ar=class ar extends O{constructor(t){super();c(this,"parentCreatedAt");c(this,"from");c(this,"to");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new ar().fromBinary(t,n)}static fromJson(t,n){return new ar().fromJson(t,n)}static fromJsonString(t,n){return new ar().fromJsonString(t,n)}static equals(t,n){return h.util.equals(ar,t,n)}};c(ar,"runtime",h),c(ar,"typeName","yorkie.v1.Operation.Select"),c(ar,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:M},{no:2,name:"from",kind:"message",T:un},{no:3,name:"to",kind:"message",T:un},{no:4,name:"executed_at",kind:"message",T:M}]));let ga=ar;const cr=class cr extends O{constructor(t){super();c(this,"parentCreatedAt");c(this,"from");c(this,"to");c(this,"attributes",{});c(this,"executedAt");c(this,"createdAtMapByActor",{});h.util.initPartial(t,this)}static fromBinary(t,n){return new cr().fromBinary(t,n)}static fromJson(t,n){return new cr().fromJson(t,n)}static fromJsonString(t,n){return new cr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(cr,t,n)}};c(cr,"runtime",h),c(cr,"typeName","yorkie.v1.Operation.Style"),c(cr,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:M},{no:2,name:"from",kind:"message",T:un},{no:3,name:"to",kind:"message",T:un},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:M},{no:6,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:M}}]));let Yi=cr;const lr=class lr extends O{constructor(t){super();c(this,"parentCreatedAt");c(this,"value");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new lr().fromBinary(t,n)}static fromJson(t,n){return new lr().fromJson(t,n)}static fromJsonString(t,n){return new lr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(lr,t,n)}};c(lr,"runtime",h),c(lr,"typeName","yorkie.v1.Operation.Increase"),c(lr,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:M},{no:2,name:"value",kind:"message",T:tt},{no:3,name:"executed_at",kind:"message",T:M}]));let Xi=lr;const ur=class ur extends O{constructor(t){super();c(this,"parentCreatedAt");c(this,"from");c(this,"to");c(this,"createdAtMapByActor",{});c(this,"contents",[]);c(this,"splitLevel",0);c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new ur().fromBinary(t,n)}static fromJson(t,n){return new ur().fromJson(t,n)}static fromJsonString(t,n){return new ur().fromJsonString(t,n)}static equals(t,n){return h.util.equals(ur,t,n)}};c(ur,"runtime",h),c(ur,"typeName","yorkie.v1.Operation.TreeEdit"),c(ur,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:M},{no:2,name:"from",kind:"message",T:Wn},{no:3,name:"to",kind:"message",T:Wn},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:M}},{no:5,name:"contents",kind:"message",T:co,repeated:!0},{no:7,name:"split_level",kind:"scalar",T:5},{no:6,name:"executed_at",kind:"message",T:M}]));let Zi=ur;const fr=class fr extends O{constructor(t){super();c(this,"parentCreatedAt");c(this,"from");c(this,"to");c(this,"attributes",{});c(this,"executedAt");c(this,"attributesToRemove",[]);c(this,"createdAtMapByActor",{});h.util.initPartial(t,this)}static fromBinary(t,n){return new fr().fromBinary(t,n)}static fromJson(t,n){return new fr().fromJson(t,n)}static fromJsonString(t,n){return new fr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(fr,t,n)}};c(fr,"runtime",h),c(fr,"typeName","yorkie.v1.Operation.TreeStyle"),c(fr,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:M},{no:2,name:"from",kind:"message",T:Wn},{no:3,name:"to",kind:"message",T:Wn},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:M},{no:6,name:"attributes_to_remove",kind:"scalar",T:9,repeated:!0},{no:7,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:M}}]));let Qi=fr;const hr=class hr extends O{constructor(t){super();c(this,"parentCreatedAt");c(this,"createdAt");c(this,"value");c(this,"executedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new hr().fromBinary(t,n)}static fromJson(t,n){return new hr().fromJson(t,n)}static fromJsonString(t,n){return new hr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(hr,t,n)}};c(hr,"runtime",h),c(hr,"typeName","yorkie.v1.Operation.ArraySet"),c(hr,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:M},{no:2,name:"created_at",kind:"message",T:M},{no:3,name:"value",kind:"message",T:tt},{no:4,name:"executed_at",kind:"message",T:M}]));let ma=hr;const dr=class dr extends O{constructor(t){super();c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");c(this,"type",0);c(this,"value",new Uint8Array(0));h.util.initPartial(t,this)}static fromBinary(t,n){return new dr().fromBinary(t,n)}static fromJson(t,n){return new dr().fromJson(t,n)}static fromJsonString(t,n){return new dr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(dr,t,n)}};c(dr,"runtime",h),c(dr,"typeName","yorkie.v1.JSONElementSimple"),c(dr,"fields",h.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:M},{no:2,name:"moved_at",kind:"message",T:M},{no:3,name:"removed_at",kind:"message",T:M},{no:4,name:"type",kind:"enum",T:h.getEnumType(_)},{no:5,name:"value",kind:"scalar",T:12}]));let tt=dr;const gr=class gr extends O{constructor(t){super();c(this,"body",{case:void 0});h.util.initPartial(t,this)}static fromBinary(t,n){return new gr().fromBinary(t,n)}static fromJson(t,n){return new gr().fromJson(t,n)}static fromJsonString(t,n){return new gr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(gr,t,n)}};c(gr,"runtime",h),c(gr,"typeName","yorkie.v1.JSONElement"),c(gr,"fields",h.util.newFieldList(()=>[{no:1,name:"json_object",kind:"message",T:eo,oneof:"body"},{no:2,name:"json_array",kind:"message",T:to,oneof:"body"},{no:3,name:"primitive",kind:"message",T:ro,oneof:"body"},{no:5,name:"text",kind:"message",T:no,oneof:"body"},{no:6,name:"counter",kind:"message",T:so,oneof:"body"},{no:7,name:"tree",kind:"message",T:io,oneof:"body"}]));let Ke=gr;const mr=class mr extends O{constructor(t){super();c(this,"nodes",[]);c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new mr().fromBinary(t,n)}static fromJson(t,n){return new mr().fromJson(t,n)}static fromJsonString(t,n){return new mr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(mr,t,n)}};c(mr,"runtime",h),c(mr,"typeName","yorkie.v1.JSONElement.JSONObject"),c(mr,"fields",h.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:Pf,repeated:!0},{no:2,name:"created_at",kind:"message",T:M},{no:3,name:"moved_at",kind:"message",T:M},{no:4,name:"removed_at",kind:"message",T:M}]));let eo=mr;const pr=class pr extends O{constructor(t){super();c(this,"nodes",[]);c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new pr().fromBinary(t,n)}static fromJson(t,n){return new pr().fromJson(t,n)}static fromJsonString(t,n){return new pr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(pr,t,n)}};c(pr,"runtime",h),c(pr,"typeName","yorkie.v1.JSONElement.JSONArray"),c(pr,"fields",h.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:oo,repeated:!0},{no:2,name:"created_at",kind:"message",T:M},{no:3,name:"moved_at",kind:"message",T:M},{no:4,name:"removed_at",kind:"message",T:M}]));let to=pr;const yr=class yr extends O{constructor(t){super();c(this,"type",0);c(this,"value",new Uint8Array(0));c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new yr().fromBinary(t,n)}static fromJson(t,n){return new yr().fromJson(t,n)}static fromJsonString(t,n){return new yr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(yr,t,n)}};c(yr,"runtime",h),c(yr,"typeName","yorkie.v1.JSONElement.Primitive"),c(yr,"fields",h.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:h.getEnumType(_)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:M},{no:4,name:"moved_at",kind:"message",T:M},{no:5,name:"removed_at",kind:"message",T:M}]));let ro=yr;const vr=class vr extends O{constructor(t){super();c(this,"nodes",[]);c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new vr().fromBinary(t,n)}static fromJson(t,n){return new vr().fromJson(t,n)}static fromJsonString(t,n){return new vr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(vr,t,n)}};c(vr,"runtime",h),c(vr,"typeName","yorkie.v1.JSONElement.Text"),c(vr,"fields",h.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:ao,repeated:!0},{no:2,name:"created_at",kind:"message",T:M},{no:3,name:"moved_at",kind:"message",T:M},{no:4,name:"removed_at",kind:"message",T:M}]));let no=vr;const wr=class wr extends O{constructor(t){super();c(this,"type",0);c(this,"value",new Uint8Array(0));c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new wr().fromBinary(t,n)}static fromJson(t,n){return new wr().fromJson(t,n)}static fromJsonString(t,n){return new wr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(wr,t,n)}};c(wr,"runtime",h),c(wr,"typeName","yorkie.v1.JSONElement.Counter"),c(wr,"fields",h.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:h.getEnumType(_)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:M},{no:4,name:"moved_at",kind:"message",T:M},{no:5,name:"removed_at",kind:"message",T:M}]));let so=wr;const br=class br extends O{constructor(t){super();c(this,"nodes",[]);c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new br().fromBinary(t,n)}static fromJson(t,n){return new br().fromJson(t,n)}static fromJsonString(t,n){return new br().fromJsonString(t,n)}static equals(t,n){return h.util.equals(br,t,n)}};c(br,"runtime",h),c(br,"typeName","yorkie.v1.JSONElement.Tree"),c(br,"fields",h.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:Qs,repeated:!0},{no:2,name:"created_at",kind:"message",T:M},{no:3,name:"moved_at",kind:"message",T:M},{no:4,name:"removed_at",kind:"message",T:M}]));let io=br;var at;let Pf=(at=class extends O{constructor(t){super();c(this,"key","");c(this,"element");h.util.initPartial(t,this)}static fromBinary(t,n){return new at().fromBinary(t,n)}static fromJson(t,n){return new at().fromJson(t,n)}static fromJsonString(t,n){return new at().fromJsonString(t,n)}static equals(t,n){return h.util.equals(at,t,n)}},c(at,"runtime",h),c(at,"typeName","yorkie.v1.RHTNode"),c(at,"fields",h.util.newFieldList(()=>[{no:1,name:"key",kind:"scalar",T:9},{no:2,name:"element",kind:"message",T:Ke}])),at);const Dt=class Dt extends O{constructor(t){super();c(this,"next");c(this,"element");h.util.initPartial(t,this)}static fromBinary(t,n){return new Dt().fromBinary(t,n)}static fromJson(t,n){return new Dt().fromJson(t,n)}static fromJsonString(t,n){return new Dt().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Dt,t,n)}};c(Dt,"runtime",h),c(Dt,"typeName","yorkie.v1.RGANode"),c(Dt,"fields",h.util.newFieldList(()=>[{no:1,name:"next",kind:"message",T:Dt},{no:2,name:"element",kind:"message",T:Ke}]));let oo=Dt;const Tr=class Tr extends O{constructor(t){super();c(this,"value","");c(this,"updatedAt");c(this,"isRemoved",!1);h.util.initPartial(t,this)}static fromBinary(t,n){return new Tr().fromBinary(t,n)}static fromJson(t,n){return new Tr().fromJson(t,n)}static fromJsonString(t,n){return new Tr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Tr,t,n)}};c(Tr,"runtime",h),c(Tr,"typeName","yorkie.v1.NodeAttr"),c(Tr,"fields",h.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:9},{no:2,name:"updated_at",kind:"message",T:M},{no:3,name:"is_removed",kind:"scalar",T:8}]));let vs=Tr;const Ar=class Ar extends O{constructor(t){super();c(this,"id");c(this,"value","");c(this,"removedAt");c(this,"insPrevId");c(this,"attributes",{});h.util.initPartial(t,this)}static fromBinary(t,n){return new Ar().fromBinary(t,n)}static fromJson(t,n){return new Ar().fromJson(t,n)}static fromJsonString(t,n){return new Ar().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Ar,t,n)}};c(Ar,"runtime",h),c(Ar,"typeName","yorkie.v1.TextNode"),c(Ar,"fields",h.util.newFieldList(()=>[{no:1,name:"id",kind:"message",T:Zs},{no:2,name:"value",kind:"scalar",T:9},{no:3,name:"removed_at",kind:"message",T:M},{no:4,name:"ins_prev_id",kind:"message",T:Zs},{no:5,name:"attributes",kind:"map",K:9,V:{kind:"message",T:vs}}]));let ao=Ar;const Sr=class Sr extends O{constructor(t){super();c(this,"createdAt");c(this,"offset",0);h.util.initPartial(t,this)}static fromBinary(t,n){return new Sr().fromBinary(t,n)}static fromJson(t,n){return new Sr().fromJson(t,n)}static fromJsonString(t,n){return new Sr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Sr,t,n)}};c(Sr,"runtime",h),c(Sr,"typeName","yorkie.v1.TextNodeID"),c(Sr,"fields",h.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:M},{no:2,name:"offset",kind:"scalar",T:5}]));let Zs=Sr;const Ir=class Ir extends O{constructor(t){super();c(this,"id");c(this,"type","");c(this,"value","");c(this,"removedAt");c(this,"insPrevId");c(this,"insNextId");c(this,"depth",0);c(this,"attributes",{});h.util.initPartial(t,this)}static fromBinary(t,n){return new Ir().fromBinary(t,n)}static fromJson(t,n){return new Ir().fromJson(t,n)}static fromJsonString(t,n){return new Ir().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Ir,t,n)}};c(Ir,"runtime",h),c(Ir,"typeName","yorkie.v1.TreeNode"),c(Ir,"fields",h.util.newFieldList(()=>[{no:1,name:"id",kind:"message",T:An},{no:2,name:"type",kind:"scalar",T:9},{no:3,name:"value",kind:"scalar",T:9},{no:4,name:"removed_at",kind:"message",T:M},{no:5,name:"ins_prev_id",kind:"message",T:An},{no:6,name:"ins_next_id",kind:"message",T:An},{no:7,name:"depth",kind:"scalar",T:5},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"message",T:vs}}]));let Qs=Ir;const xr=class xr extends O{constructor(t){super();c(this,"content",[]);h.util.initPartial(t,this)}static fromBinary(t,n){return new xr().fromBinary(t,n)}static fromJson(t,n){return new xr().fromJson(t,n)}static fromJsonString(t,n){return new xr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(xr,t,n)}};c(xr,"runtime",h),c(xr,"typeName","yorkie.v1.TreeNodes"),c(xr,"fields",h.util.newFieldList(()=>[{no:1,name:"content",kind:"message",T:Qs,repeated:!0}]));let co=xr;const kr=class kr extends O{constructor(t){super();c(this,"createdAt");c(this,"offset",0);h.util.initPartial(t,this)}static fromBinary(t,n){return new kr().fromBinary(t,n)}static fromJson(t,n){return new kr().fromJson(t,n)}static fromJsonString(t,n){return new kr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(kr,t,n)}};c(kr,"runtime",h),c(kr,"typeName","yorkie.v1.TreeNodeID"),c(kr,"fields",h.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:M},{no:2,name:"offset",kind:"scalar",T:5}]));let An=kr;const Er=class Er extends O{constructor(t){super();c(this,"parentId");c(this,"leftSiblingId");h.util.initPartial(t,this)}static fromBinary(t,n){return new Er().fromBinary(t,n)}static fromJson(t,n){return new Er().fromJson(t,n)}static fromJsonString(t,n){return new Er().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Er,t,n)}};c(Er,"runtime",h),c(Er,"typeName","yorkie.v1.TreePos"),c(Er,"fields",h.util.newFieldList(()=>[{no:1,name:"parent_id",kind:"message",T:An},{no:2,name:"left_sibling_id",kind:"message",T:An}]));let Wn=Er;const Cr=class Cr extends O{constructor(t){super();c(this,"id","");c(this,"username","");c(this,"createdAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new Cr().fromBinary(t,n)}static fromJson(t,n){return new Cr().fromJson(t,n)}static fromJsonString(t,n){return new Cr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Cr,t,n)}};c(Cr,"runtime",h),c(Cr,"typeName","yorkie.v1.User"),c(Cr,"fields",h.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"created_at",kind:"message",T:Ce}]));let Ml=Cr;const Nr=class Nr extends O{constructor(t){super();c(this,"id","");c(this,"name","");c(this,"publicKey","");c(this,"secretKey","");c(this,"authWebhookUrl","");c(this,"authWebhookMethods",[]);c(this,"clientDeactivateThreshold","");c(this,"createdAt");c(this,"updatedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new Nr().fromBinary(t,n)}static fromJson(t,n){return new Nr().fromJson(t,n)}static fromJsonString(t,n){return new Nr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Nr,t,n)}};c(Nr,"runtime",h),c(Nr,"typeName","yorkie.v1.Project"),c(Nr,"fields",h.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"public_key",kind:"scalar",T:9},{no:4,name:"secret_key",kind:"scalar",T:9},{no:5,name:"auth_webhook_url",kind:"scalar",T:9},{no:6,name:"auth_webhook_methods",kind:"scalar",T:9,repeated:!0},{no:7,name:"client_deactivate_threshold",kind:"scalar",T:9},{no:8,name:"created_at",kind:"message",T:Ce},{no:9,name:"updated_at",kind:"message",T:Ce}]));let Fl=Nr;const Pr=class Pr extends O{constructor(t){super();c(this,"name");c(this,"authWebhookUrl");c(this,"authWebhookMethods");c(this,"clientDeactivateThreshold");h.util.initPartial(t,this)}static fromBinary(t,n){return new Pr().fromBinary(t,n)}static fromJson(t,n){return new Pr().fromJson(t,n)}static fromJsonString(t,n){return new Pr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Pr,t,n)}};c(Pr,"runtime",h),c(Pr,"typeName","yorkie.v1.UpdatableProjectFields"),c(Pr,"fields",h.util.newFieldList(()=>[{no:1,name:"name",kind:"message",T:Ge},{no:2,name:"auth_webhook_url",kind:"message",T:Ge},{no:3,name:"auth_webhook_methods",kind:"message",T:pa},{no:4,name:"client_deactivate_threshold",kind:"message",T:Ge}]));let $l=Pr;const Or=class Or extends O{constructor(t){super();c(this,"methods",[]);h.util.initPartial(t,this)}static fromBinary(t,n){return new Or().fromBinary(t,n)}static fromJson(t,n){return new Or().fromJson(t,n)}static fromJsonString(t,n){return new Or().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Or,t,n)}};c(Or,"runtime",h),c(Or,"typeName","yorkie.v1.UpdatableProjectFields.AuthWebhookMethods"),c(Or,"fields",h.util.newFieldList(()=>[{no:1,name:"methods",kind:"scalar",T:9,repeated:!0}]));let pa=Or;const Dr=class Dr extends O{constructor(t){super();c(this,"id","");c(this,"key","");c(this,"snapshot","");c(this,"createdAt");c(this,"accessedAt");c(this,"updatedAt");h.util.initPartial(t,this)}static fromBinary(t,n){return new Dr().fromBinary(t,n)}static fromJson(t,n){return new Dr().fromJson(t,n)}static fromJsonString(t,n){return new Dr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Dr,t,n)}};c(Dr,"runtime",h),c(Dr,"typeName","yorkie.v1.DocumentSummary"),c(Dr,"fields",h.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"snapshot",kind:"scalar",T:9},{no:4,name:"created_at",kind:"message",T:Ce},{no:5,name:"accessed_at",kind:"message",T:Ce},{no:6,name:"updated_at",kind:"message",T:Ce}]));let Ul=Dr;const Br=class Br extends O{constructor(t){super();c(this,"type",0);c(this,"presence");h.util.initPartial(t,this)}static fromBinary(t,n){return new Br().fromBinary(t,n)}static fromJson(t,n){return new Br().fromJson(t,n)}static fromJsonString(t,n){return new Br().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Br,t,n)}};c(Br,"runtime",h),c(Br,"typeName","yorkie.v1.PresenceChange"),c(Br,"fields",h.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:h.getEnumType(_n)},{no:2,name:"presence",kind:"message",T:ac}]));let ei=Br;var _n=(r=>(r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.PUT=1]="PUT",r[r.DELETE=2]="DELETE",r[r.CLEAR=3]="CLEAR",r))(_n||{});h.util.setEnumType(_n,"yorkie.v1.PresenceChange.ChangeType",[{no:0,name:"CHANGE_TYPE_UNSPECIFIED"},{no:1,name:"CHANGE_TYPE_PUT"},{no:2,name:"CHANGE_TYPE_DELETE"},{no:3,name:"CHANGE_TYPE_CLEAR"}]);var ct;let ac=(ct=class extends O{constructor(t){super();c(this,"data",{});h.util.initPartial(t,this)}static fromBinary(t,n){return new ct().fromBinary(t,n)}static fromJson(t,n){return new ct().fromJson(t,n)}static fromJsonString(t,n){return new ct().fromJsonString(t,n)}static equals(t,n){return h.util.equals(ct,t,n)}},c(ct,"runtime",h),c(ct,"typeName","yorkie.v1.Presence"),c(ct,"fields",h.util.newFieldList(()=>[{no:1,name:"data",kind:"map",K:9,V:{kind:"scalar",T:9}}])),ct);var lt;let Of=(lt=class extends O{constructor(t){super();c(this,"serverSeq",he.zero);c(this,"clientSeq",0);h.util.initPartial(t,this)}static fromBinary(t,n){return new lt().fromBinary(t,n)}static fromJson(t,n){return new lt().fromJson(t,n)}static fromJsonString(t,n){return new lt().fromJsonString(t,n)}static equals(t,n){return h.util.equals(lt,t,n)}},c(lt,"runtime",h),c(lt,"typeName","yorkie.v1.Checkpoint"),c(lt,"fields",h.util.newFieldList(()=>[{no:1,name:"server_seq",kind:"scalar",T:3},{no:2,name:"client_seq",kind:"scalar",T:13}])),lt);const Rr=class Rr extends O{constructor(t){super();c(this,"createdAt");c(this,"offset",0);c(this,"relativeOffset",0);h.util.initPartial(t,this)}static fromBinary(t,n){return new Rr().fromBinary(t,n)}static fromJson(t,n){return new Rr().fromJson(t,n)}static fromJsonString(t,n){return new Rr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Rr,t,n)}};c(Rr,"runtime",h),c(Rr,"typeName","yorkie.v1.TextNodePos"),c(Rr,"fields",h.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:M},{no:2,name:"offset",kind:"scalar",T:5},{no:3,name:"relative_offset",kind:"scalar",T:5}]));let un=Rr;var ut;let M=(ut=class extends O{constructor(t){super();c(this,"lamport",he.zero);c(this,"delimiter",0);c(this,"actorId",new Uint8Array(0));h.util.initPartial(t,this)}static fromBinary(t,n){return new ut().fromBinary(t,n)}static fromJson(t,n){return new ut().fromJson(t,n)}static fromJsonString(t,n){return new ut().fromJsonString(t,n)}static equals(t,n){return h.util.equals(ut,t,n)}},c(ut,"runtime",h),c(ut,"typeName","yorkie.v1.TimeTicket"),c(ut,"fields",h.util.newFieldList(()=>[{no:1,name:"lamport",kind:"scalar",T:3},{no:2,name:"delimiter",kind:"scalar",T:13},{no:3,name:"actor_id",kind:"scalar",T:12}])),ut);const Lr=class Lr extends O{constructor(t){super();c(this,"topic","");c(this,"payload",new Uint8Array(0));h.util.initPartial(t,this)}static fromBinary(t,n){return new Lr().fromBinary(t,n)}static fromJson(t,n){return new Lr().fromJson(t,n)}static fromJsonString(t,n){return new Lr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Lr,t,n)}};c(Lr,"runtime",h),c(Lr,"typeName","yorkie.v1.DocEventBody"),c(Lr,"fields",h.util.newFieldList(()=>[{no:1,name:"topic",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12}]));let ya=Lr;const Jr=class Jr extends O{constructor(t){super();c(this,"type",0);c(this,"publisher","");c(this,"body");h.util.initPartial(t,this)}static fromBinary(t,n){return new Jr().fromBinary(t,n)}static fromJson(t,n){return new Jr().fromJson(t,n)}static fromJsonString(t,n){return new Jr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Jr,t,n)}};c(Jr,"runtime",h),c(Jr,"typeName","yorkie.v1.DocEvent"),c(Jr,"fields",h.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:h.getEnumType(Hn)},{no:2,name:"publisher",kind:"scalar",T:9},{no:3,name:"body",kind:"message",T:ya}]));let va=Jr;const Mr=class Mr extends O{constructor(t){super();c(this,"clientKey","");c(this,"metadata",{});h.util.initPartial(t,this)}static fromBinary(t,n){return new Mr().fromBinary(t,n)}static fromJson(t,n){return new Mr().fromJson(t,n)}static fromJsonString(t,n){return new Mr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Mr,t,n)}};c(Mr,"runtime",h),c(Mr,"typeName","yorkie.v1.ActivateClientRequest"),c(Mr,"fields",h.util.newFieldList(()=>[{no:1,name:"client_key",kind:"scalar",T:9},{no:2,name:"metadata",kind:"map",K:9,V:{kind:"scalar",T:9}}]));let wa=Mr;const Fr=class Fr extends O{constructor(t){super();c(this,"clientId","");h.util.initPartial(t,this)}static fromBinary(t,n){return new Fr().fromBinary(t,n)}static fromJson(t,n){return new Fr().fromJson(t,n)}static fromJsonString(t,n){return new Fr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Fr,t,n)}};c(Fr,"runtime",h),c(Fr,"typeName","yorkie.v1.ActivateClientResponse"),c(Fr,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9}]));let ba=Fr;const $r=class $r extends O{constructor(t){super();c(this,"clientId","");h.util.initPartial(t,this)}static fromBinary(t,n){return new $r().fromBinary(t,n)}static fromJson(t,n){return new $r().fromJson(t,n)}static fromJsonString(t,n){return new $r().fromJsonString(t,n)}static equals(t,n){return h.util.equals($r,t,n)}};c($r,"runtime",h),c($r,"typeName","yorkie.v1.DeactivateClientRequest"),c($r,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9}]));let Ta=$r;const Ur=class Ur extends O{constructor(e){super(),h.util.initPartial(e,this)}static fromBinary(e,t){return new Ur().fromBinary(e,t)}static fromJson(e,t){return new Ur().fromJson(e,t)}static fromJsonString(e,t){return new Ur().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Ur,e,t)}};c(Ur,"runtime",h),c(Ur,"typeName","yorkie.v1.DeactivateClientResponse"),c(Ur,"fields",h.util.newFieldList(()=>[]));let Aa=Ur;const qr=class qr extends O{constructor(t){super();c(this,"clientId","");c(this,"changePack");h.util.initPartial(t,this)}static fromBinary(t,n){return new qr().fromBinary(t,n)}static fromJson(t,n){return new qr().fromJson(t,n)}static fromJsonString(t,n){return new qr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(qr,t,n)}};c(qr,"runtime",h),c(qr,"typeName","yorkie.v1.AttachDocumentRequest"),c(qr,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:dn}]));let Sa=qr;const Vr=class Vr extends O{constructor(t){super();c(this,"documentId","");c(this,"changePack");h.util.initPartial(t,this)}static fromBinary(t,n){return new Vr().fromBinary(t,n)}static fromJson(t,n){return new Vr().fromJson(t,n)}static fromJsonString(t,n){return new Vr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Vr,t,n)}};c(Vr,"runtime",h),c(Vr,"typeName","yorkie.v1.AttachDocumentResponse"),c(Vr,"fields",h.util.newFieldList(()=>[{no:1,name:"document_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:dn}]));let Ia=Vr;const Kr=class Kr extends O{constructor(t){super();c(this,"clientId","");c(this,"documentId","");c(this,"changePack");c(this,"removeIfNotAttached",!1);h.util.initPartial(t,this)}static fromBinary(t,n){return new Kr().fromBinary(t,n)}static fromJson(t,n){return new Kr().fromJson(t,n)}static fromJsonString(t,n){return new Kr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Kr,t,n)}};c(Kr,"runtime",h),c(Kr,"typeName","yorkie.v1.DetachDocumentRequest"),c(Kr,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:dn},{no:4,name:"remove_if_not_attached",kind:"scalar",T:8}]));let xa=Kr;const zr=class zr extends O{constructor(t){super();c(this,"changePack");h.util.initPartial(t,this)}static fromBinary(t,n){return new zr().fromBinary(t,n)}static fromJson(t,n){return new zr().fromJson(t,n)}static fromJsonString(t,n){return new zr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(zr,t,n)}};c(zr,"runtime",h),c(zr,"typeName","yorkie.v1.DetachDocumentResponse"),c(zr,"fields",h.util.newFieldList(()=>[{no:2,name:"change_pack",kind:"message",T:dn}]));let ka=zr;const jr=class jr extends O{constructor(t){super();c(this,"clientId","");c(this,"documentId","");h.util.initPartial(t,this)}static fromBinary(t,n){return new jr().fromBinary(t,n)}static fromJson(t,n){return new jr().fromJson(t,n)}static fromJsonString(t,n){return new jr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(jr,t,n)}};c(jr,"runtime",h),c(jr,"typeName","yorkie.v1.WatchDocumentRequest"),c(jr,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9}]));let Ea=jr;const Hr=class Hr extends O{constructor(t){super();c(this,"body",{case:void 0});h.util.initPartial(t,this)}static fromBinary(t,n){return new Hr().fromBinary(t,n)}static fromJson(t,n){return new Hr().fromJson(t,n)}static fromJsonString(t,n){return new Hr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Hr,t,n)}};c(Hr,"runtime",h),c(Hr,"typeName","yorkie.v1.WatchDocumentResponse"),c(Hr,"fields",h.util.newFieldList(()=>[{no:1,name:"initialization",kind:"message",T:Na,oneof:"body"},{no:2,name:"event",kind:"message",T:va,oneof:"body"}]));let Ca=Hr;const Wr=class Wr extends O{constructor(t){super();c(this,"clientIds",[]);h.util.initPartial(t,this)}static fromBinary(t,n){return new Wr().fromBinary(t,n)}static fromJson(t,n){return new Wr().fromJson(t,n)}static fromJsonString(t,n){return new Wr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Wr,t,n)}};c(Wr,"runtime",h),c(Wr,"typeName","yorkie.v1.WatchDocumentResponse.Initialization"),c(Wr,"fields",h.util.newFieldList(()=>[{no:1,name:"client_ids",kind:"scalar",T:9,repeated:!0}]));let Na=Wr;const _r=class _r extends O{constructor(t){super();c(this,"clientId","");c(this,"documentId","");c(this,"changePack");h.util.initPartial(t,this)}static fromBinary(t,n){return new _r().fromBinary(t,n)}static fromJson(t,n){return new _r().fromJson(t,n)}static fromJsonString(t,n){return new _r().fromJsonString(t,n)}static equals(t,n){return h.util.equals(_r,t,n)}};c(_r,"runtime",h),c(_r,"typeName","yorkie.v1.RemoveDocumentRequest"),c(_r,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:dn}]));let Pa=_r;const Gr=class Gr extends O{constructor(t){super();c(this,"changePack");h.util.initPartial(t,this)}static fromBinary(t,n){return new Gr().fromBinary(t,n)}static fromJson(t,n){return new Gr().fromJson(t,n)}static fromJsonString(t,n){return new Gr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Gr,t,n)}};c(Gr,"runtime",h),c(Gr,"typeName","yorkie.v1.RemoveDocumentResponse"),c(Gr,"fields",h.util.newFieldList(()=>[{no:1,name:"change_pack",kind:"message",T:dn}]));let Oa=Gr;const Yr=class Yr extends O{constructor(t){super();c(this,"clientId","");c(this,"documentId","");c(this,"changePack");c(this,"pushOnly",!1);h.util.initPartial(t,this)}static fromBinary(t,n){return new Yr().fromBinary(t,n)}static fromJson(t,n){return new Yr().fromJson(t,n)}static fromJsonString(t,n){return new Yr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Yr,t,n)}};c(Yr,"runtime",h),c(Yr,"typeName","yorkie.v1.PushPullChangesRequest"),c(Yr,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:dn},{no:4,name:"push_only",kind:"scalar",T:8}]));let Da=Yr;const Xr=class Xr extends O{constructor(t){super();c(this,"changePack");h.util.initPartial(t,this)}static fromBinary(t,n){return new Xr().fromBinary(t,n)}static fromJson(t,n){return new Xr().fromJson(t,n)}static fromJsonString(t,n){return new Xr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Xr,t,n)}};c(Xr,"runtime",h),c(Xr,"typeName","yorkie.v1.PushPullChangesResponse"),c(Xr,"fields",h.util.newFieldList(()=>[{no:1,name:"change_pack",kind:"message",T:dn}]));let Ba=Xr;const Zr=class Zr extends O{constructor(t){super();c(this,"clientId","");c(this,"documentId","");c(this,"topic","");c(this,"payload",new Uint8Array(0));h.util.initPartial(t,this)}static fromBinary(t,n){return new Zr().fromBinary(t,n)}static fromJson(t,n){return new Zr().fromJson(t,n)}static fromJsonString(t,n){return new Zr().fromJsonString(t,n)}static equals(t,n){return h.util.equals(Zr,t,n)}};c(Zr,"runtime",h),c(Zr,"typeName","yorkie.v1.BroadcastRequest"),c(Zr,"fields",h.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"payload",kind:"scalar",T:12}]));let Ra=Zr;const Qr=class Qr extends O{constructor(e){super(),h.util.initPartial(e,this)}static fromBinary(e,t){return new Qr().fromBinary(e,t)}static fromJson(e,t){return new Qr().fromJson(e,t)}static fromJsonString(e,t){return new Qr().fromJsonString(e,t)}static equals(e,t){return h.util.equals(Qr,e,t)}};c(Qr,"runtime",h),c(Qr,"typeName","yorkie.v1.BroadcastResponse"),c(Qr,"fields",h.util.newFieldList(()=>[]));let La=Qr;const sp={typeName:"yorkie.v1.YorkieService",methods:{activateClient:{name:"ActivateClient",I:wa,O:ba,kind:Be.Unary},deactivateClient:{name:"DeactivateClient",I:Ta,O:Aa,kind:Be.Unary},attachDocument:{name:"AttachDocument",I:Sa,O:Ia,kind:Be.Unary},detachDocument:{name:"DetachDocument",I:xa,O:ka,kind:Be.Unary},removeDocument:{name:"RemoveDocument",I:Pa,O:Oa,kind:Be.Unary},pushPullChanges:{name:"PushPullChanges",I:Da,O:Ba,kind:Be.Unary},watchDocument:{name:"WatchDocument",I:Ea,O:Ca,kind:Be.ServerStreaming},broadcast:{name:"Broadcast",I:Ra,O:La,kind:Be.Unary}}},ip=h.makeMessageType("google.rpc.ErrorInfo",()=>[{no:1,name:"reason",kind:"scalar",T:9},{no:2,name:"domain",kind:"scalar",T:9},{no:3,name:"metadata",kind:"map",K:9,V:{kind:"scalar",T:9}}]);h.makeMessageType("google.rpc.RetryInfo",()=>[{no:1,name:"retry_delay",kind:"message",T:sn}]);h.makeMessageType("google.rpc.DebugInfo",()=>[{no:1,name:"stack_entries",kind:"scalar",T:9,repeated:!0},{no:2,name:"detail",kind:"scalar",T:9}]);h.makeMessageType("google.rpc.QuotaFailure",()=>[{no:1,name:"violations",kind:"message",T:op,repeated:!0}]);const op=h.makeMessageType("google.rpc.QuotaFailure.Violation",()=>[{no:1,name:"subject",kind:"scalar",T:9},{no:2,name:"description",kind:"scalar",T:9}],{localName:"QuotaFailure_Violation"});h.makeMessageType("google.rpc.PreconditionFailure",()=>[{no:1,name:"violations",kind:"message",T:ap,repeated:!0}]);const ap=h.makeMessageType("google.rpc.PreconditionFailure.Violation",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"subject",kind:"scalar",T:9},{no:3,name:"description",kind:"scalar",T:9}],{localName:"PreconditionFailure_Violation"});h.makeMessageType("google.rpc.BadRequest",()=>[{no:1,name:"field_violations",kind:"message",T:cp,repeated:!0}]);const cp=h.makeMessageType("google.rpc.BadRequest.FieldViolation",()=>[{no:1,name:"field",kind:"scalar",T:9},{no:2,name:"description",kind:"scalar",T:9},{no:3,name:"reason",kind:"scalar",T:9},{no:4,name:"localized_message",kind:"message",T:up}],{localName:"BadRequest_FieldViolation"});h.makeMessageType("google.rpc.RequestInfo",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"serving_data",kind:"scalar",T:9}]);h.makeMessageType("google.rpc.ResourceInfo",()=>[{no:1,name:"resource_type",kind:"scalar",T:9},{no:2,name:"resource_name",kind:"scalar",T:9},{no:3,name:"owner",kind:"scalar",T:9},{no:4,name:"description",kind:"scalar",T:9}]);h.makeMessageType("google.rpc.Help",()=>[{no:1,name:"links",kind:"message",T:lp,repeated:!0}]);const lp=h.makeMessageType("google.rpc.Help.Link",()=>[{no:1,name:"description",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9}],{localName:"Help_Link"}),up=h.makeMessageType("google.rpc.LocalizedMessage",()=>[{no:1,name:"locale",kind:"scalar",T:9},{no:2,name:"message",kind:"scalar",T:9}]);var v=(r=>(r.Ok="ok",r.ErrClientNotActivated="ErrClientNotActivated",r.ErrClientNotFound="ErrClientNotFound",r.ErrUnimplemented="ErrUnimplemented",r.ErrInvalidType="ErrInvalidType",r.ErrDummy="ErrDummy",r.ErrDocumentNotAttached="ErrDocumentNotAttached",r.ErrDocumentNotDetached="ErrDocumentNotDetached",r.ErrDocumentRemoved="ErrDocumentRemoved",r.ErrInvalidObjectKey="ErrInvalidObjectKey",r.ErrInvalidArgument="ErrInvalidArgument",r.ErrNotInitialized="ErrNotInitialized",r.ErrNotReady="ErrNotReady",r.ErrRefused="ErrRefused",r.ErrContextNotProvided="ErrContextNotProvided",r.ErrPermissionDenied="ErrPermissionDenied",r.ErrUnauthenticated="ErrUnauthenticated",r.ErrTooManySubscribers="ErrTooManySubscribers",r.ErrTooManyAttachments="ErrTooManyAttachments",r))(v||{});class w extends Error{constructor(t,n){super(n);c(this,"name","YorkieError");c(this,"stack");this.code=t,this.message=n,this.toString=()=>`[code=${this.code}]: ${this.message}`}}function vt(r){if(r instanceof Map){const e=Array.from(r);return new Map(JSON.parse(JSON.stringify(e)))}return JSON.parse(JSON.stringify(r))}const Df=r=>r?Object.entries(r).length===0:!0,ws=r=>{const e={};for(const[t,n]of Object.entries(r))e[t]=JSON.stringify(n);return e},us=r=>{const e={};for(const[t,n]of Object.entries(r))e[t]=JSON.parse(n);return e};var En=(r=>(r.Put="put",r.Clear="clear",r))(En||{});class _o{constructor(e,t){c(this,"context");c(this,"presence");this.context=e,this.presence=t}set(e,t){for(const n of Object.keys(e))this.presence[n]=e[n];this.context.setPresenceChange({type:"put",presence:vt(this.presence)}),this.context.setReversePresence(e,t)}get(e){return this.presence[e]}clear(){this.presence={},this.context.setPresenceChange({type:"clear"})}}const Eo="000000000000000000000000";class gt{constructor(e,t,n){c(this,"lamport");c(this,"delimiter");c(this,"actorID");this.lamport=e,this.delimiter=t,this.actorID=n}static of(e,t,n){return new gt(e,t,n)}static fromStruct(e){return gt.of(BigInt(e.lamport),e.delimiter,e.actorID)}toIDString(){return`${this.lamport.toString()}:${this.actorID}:${this.delimiter}`}toStruct(){return{lamport:this.getLamportAsString(),delimiter:this.getDelimiter(),actorID:this.getActorID()}}toTestString(){return`${this.lamport.toString()}:${this.actorID.slice(-2)}:${this.delimiter}`}setActor(e){return new gt(this.lamport,this.delimiter,e)}getLamportAsString(){return this.lamport.toString()}getLamport(){return this.lamport}getDelimiter(){return this.delimiter}getActorID(){return this.actorID}after(e){return this.compare(e)>0}equals(e){return this.compare(e)===0}compare(e){if(this.lamport>e.lamport)return 1;if(e.lamport>this.lamport)return-1;const t=this.actorID.localeCompare(e.actorID);return t!==0?t:this.delimiter>e.delimiter?1:e.delimiter>this.delimiter?-1:0}}const Bf=0,Vs=9223372036854775807n,St=new gt(0n,Bf,Eo);function zt(r){return r.replace(/["'\\\n\r\f\b\t\u2028\u2029]/g,function(e){switch(e){case'"':case"\\":return"\\"+e;case`
`:return"\\n";case"\r":return"\\r";case"\f":return"\\f";case"\b":return"\\b";case"	":return"\\t";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e}})}class li{constructor(e){c(this,"createdAt");c(this,"movedAt");c(this,"removedAt");this.createdAt=e}getCreatedAt(){return this.createdAt}getID(){return this.createdAt}getMovedAt(){return this.movedAt}getRemovedAt(){return this.removedAt}getPositionedAt(){return this.movedAt?this.movedAt:this.createdAt}setMovedAt(e){return!this.movedAt||e&&e.after(this.movedAt)?(this.movedAt=e,!0):!1}setRemovedAt(e){this.removedAt=e}remove(e){return e&&e.after(this.getPositionedAt())&&(!this.removedAt||e.after(this.removedAt))?(this.removedAt=e,!0):!1}isRemoved(){return!!this.removedAt}}class Sn extends li{constructor(e){super(e)}}class cc{constructor(e,t){c(this,"strKey");c(this,"value");this.strKey=e,this.value=t}static of(e,t){return new cc(e,t)}isRemoved(){return this.value.isRemoved()}getStrKey(){return this.strKey}getValue(){return this.value}remove(e){return this.value.remove(e)}}class ti{constructor(){c(this,"nodeMapByKey");c(this,"nodeMapByCreatedAt");this.nodeMapByKey=new Map,this.nodeMapByCreatedAt=new Map}static create(){return new ti}set(e,t,n){let s;const i=this.nodeMapByKey.get(e);i!=null&&!i.isRemoved()&&i.remove(n)&&(s=i.getValue());const o=cc.of(e,t);return this.nodeMapByCreatedAt.set(t.getCreatedAt().toIDString(),o),(i==null||n.after(i.getValue().getPositionedAt()))&&(this.nodeMapByKey.set(e,o),t.setMovedAt(n)),s}delete(e,t){if(!this.nodeMapByCreatedAt.has(e.toIDString()))throw new w(v.ErrInvalidArgument,`fail to find ${e.toIDString()}`);const n=this.nodeMapByCreatedAt.get(e.toIDString());return n.remove(t),n.getValue()}subPathOf(e){const t=this.nodeMapByCreatedAt.get(e.toIDString());if(t)return t.getStrKey()}purge(e){const t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!t)throw new w(v.ErrInvalidArgument,`fail to find ${e.getCreatedAt().toIDString()}`);const n=this.nodeMapByKey.get(t.getStrKey());t===n&&this.nodeMapByKey.delete(n.getStrKey()),this.nodeMapByCreatedAt.delete(t.getValue().getCreatedAt().toIDString())}deleteByKey(e,t){const n=this.nodeMapByKey.get(e);if(n!=null&&n.remove(t))return n.getValue()}has(e){const t=this.nodeMapByKey.get(e);return t==null?!1:!t.isRemoved()}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}get(e){const t=this.nodeMapByKey.get(e);if(!(!t||t.isRemoved()))return t}*[Symbol.iterator](){for(const[,e]of this.nodeMapByKey)yield e}}class Ve extends Sn{constructor(t,n){super(t);c(this,"memberNodes");this.memberNodes=n}static create(t,n){if(!n)return new Ve(t,ti.create());const s=ti.create();for(const[i,o]of Object.entries(n))s.set(i,o.deepcopy(),o.getCreatedAt());return new Ve(t,s)}subPathOf(t){return this.memberNodes.subPathOf(t)}purge(t){this.memberNodes.purge(t)}set(t,n,s){return this.memberNodes.set(t,n,s)}delete(t,n){return this.memberNodes.delete(t,n)}deleteByKey(t,n){return this.memberNodes.deleteByKey(t,n)}get(t){const n=this.memberNodes.get(t);return n==null?void 0:n.getValue()}getByID(t){const n=this.memberNodes.getByID(t);return n==null?void 0:n.getValue()}has(t){return this.memberNodes.has(t)}toJSON(){const t=[];for(const[n,s]of this)t.push(`"${zt(n)}":${s.toJSON()}`);return`{${t.join(",")}}`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const t={};for(const[n,s]of this){const{createdAt:i,value:o,type:a}=s.toJSForTest();t[n]={key:n,createdAt:i,value:o,type:a}}return{createdAt:this.getCreatedAt().toTestString(),value:t,type:"YORKIE_OBJECT"}}getKeys(){const t=Array();for(const[n]of this)t.push(n);return t}toSortedJSON(){var s;const t=Array();for(const[i]of this)t.push(i);const n=[];for(const i of t.sort()){const o=(s=this.memberNodes.get(i))==null?void 0:s.getValue();n.push(`"${zt(i)}":${o.toSortedJSON()}`)}return`{${n.join(",")}}`}getRHT(){return this.memberNodes}deepcopy(){const t=Ve.create(this.getCreatedAt());for(const n of this.memberNodes)t.memberNodes.set(n.getStrKey(),n.getValue().deepcopy(),this.getPositionedAt());return t.remove(this.getRemovedAt()),t}getDescendants(t){for(const n of this.memberNodes){const s=n.getValue();if(t(s,this))return;s instanceof Sn&&s.getDescendants(t)}}*[Symbol.iterator](){const t=new Set;for(const n of this.memberNodes)t.has(n.getStrKey())||(t.add(n.getStrKey()),n.isRemoved()||(yield[n.getStrKey(),n.getValue()]))}}var ae=(r=>(r.Local="local",r.Remote="remote",r.UndoRedo="undoredo",r))(ae||{});class xt{constructor(e,t){c(this,"parentCreatedAt");c(this,"executedAt");this.parentCreatedAt=e,this.executedAt=t}getParentCreatedAt(){return this.parentCreatedAt}getExecutedAt(){if(!this.executedAt)throw new w(v.ErrNotReady,"executedAt is not set yet");return this.executedAt}setActor(e){this.executedAt&&(this.executedAt=this.executedAt.setActor(e))}setExecutedAt(e){this.executedAt=e}}class Rf{constructor(e){c(this,"value");c(this,"left");c(this,"right");c(this,"parent");c(this,"weight");this.value=e,this.initWeight()}getNodeString(){return`${this.weight}${this.value}`}getValue(){return this.value}getLeftWeight(){return this.hasLeft()?this.left.getWeight():0}getRightWeight(){return this.hasRight()?this.right.getWeight():0}getWeight(){return this.weight}getLeft(){return this.left}getRight(){return this.right}getParent(){return this.parent}hasLeft(){return!!this.left}hasRight(){return!!this.right}hasParent(){return!!this.parent}setLeft(e){this.left=e}setRight(e){this.right=e}setParent(e){this.parent=e}unlink(){this.parent=void 0,this.right=void 0,this.left=void 0}hasLinks(){return this.hasParent()||this.hasLeft()||this.hasRight()}increaseWeight(e){this.weight+=e}initWeight(){this.weight=this.getLength()}}class ri{constructor(e){c(this,"root");this.root=e}get length(){return this.root?this.root.getWeight():0}find(e){if(!this.root||e<0)return[void 0,0];let t=this.root;for(;;)if(t.hasLeft()&&e<=t.getLeftWeight())t=t.getLeft();else if(t.hasRight()&&t.getLeftWeight()+t.getLength()<e)e-=t.getLeftWeight()+t.getLength(),t=t.getRight();else{e-=t.getLeftWeight();break}if(e>t.getLength())throw new w(v.ErrInvalidArgument,`out of index range: pos: ${e} > node.length: ${t.getLength()}`);return this.splayNode(t),[t,e]}indexOf(e){return!e||e!==this.root&&!e.hasLinks()?-1:(this.splayNode(e),this.root.getLeftWeight())}getRoot(){return this.root}insert(e){return this.insertAfter(this.root,e)}insertAfter(e,t){return e?(this.splayNode(e),this.root=t,t.setRight(e.getRight()),e.hasRight()&&e.getRight().setParent(t),t.setLeft(e),e.setParent(t),e.setRight(),this.updateWeight(e),this.updateWeight(t),t):(this.root=t,t)}updateWeight(e){e.initWeight(),e.hasLeft()&&e.increaseWeight(e.getLeftWeight()),e.hasRight()&&e.increaseWeight(e.getRightWeight())}updateTreeWeight(e){for(;e;)this.updateWeight(e),e=e.getParent()}splayNode(e){if(e)for(;;)if(this.isLeftChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e),this.rotateLeft(e);else if(this.isLeftChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e.getParent()),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e.getParent()),this.rotateLeft(e);else{this.isLeftChild(e)?this.rotateRight(e):this.isRightChild(e)&&this.rotateLeft(e),this.updateWeight(e);return}}delete(e){this.splayNode(e);const t=new ri(e.getLeft());t.root&&t.root.setParent();const n=new ri(e.getRight());if(n.root&&n.root.setParent(),t.root){const s=t.getRightmost();t.splayNode(s),t.root.setRight(n.root),n.root&&n.root.setParent(t.root),this.root=t.root}else this.root=n.root;e.unlink(),this.root&&this.updateWeight(this.root)}deleteRange(e,t){if(!t){this.splayNode(e),this.cutOffRight(e);return}this.splayNode(e),this.splayNode(t),t.getLeft()!=e&&this.rotateRight(e),this.cutOffRight(e)}cutOffRight(e){const t=[];this.traversePostorder(e.getRight(),t);for(const n of t)n.initWeight();this.updateTreeWeight(e)}toTestString(){const e=[];return this.traverseInorder(this.root,e),e.map(t=>`[${t.getWeight()},${t.getLength()}]${t.getValue()||""}`).join("")}checkWeight(){const e=[];this.traverseInorder(this.root,e);for(const t of e)if(t.getWeight()!=t.getLength()+t.getLeftWeight()+t.getRightWeight())return!1;return!0}getRightmost(){let e=this.root;for(;e.hasRight();)e=e.getRight();return e}traverseInorder(e,t){e&&(this.traverseInorder(e.getLeft(),t),t.push(e),this.traverseInorder(e.getRight(),t))}traversePostorder(e,t){e&&(this.traversePostorder(e.getLeft(),t),this.traversePostorder(e.getRight(),t),t.push(e))}rotateLeft(e){const t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setRight(e.getLeft()),t.hasRight()&&t.getRight().setParent(t),e.setLeft(t),e.getLeft().setParent(e),this.updateWeight(t),this.updateWeight(e)}rotateRight(e){const t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setLeft(e.getRight()),t.hasLeft()&&t.getLeft().setParent(t),e.setRight(t),e.getRight().setParent(e),this.updateWeight(t),this.updateWeight(e)}isLeftChild(e){return e&&e.hasParent()?e.getParent().getLeft()===e:!1}isRightChild(e){return e&&e.hasParent()?e.getParent().getRight()===e:!1}}/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var ht=null;try{ht=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Q(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}Q.prototype.__isLong__;Object.defineProperty(Q.prototype,"__isLong__",{value:!0});function Ne(r){return(r&&r.__isLong__)===!0}function ql(r){var e=Math.clz32(r&-r);return r?31-e:e}Q.isLong=Ne;var Vl={},Kl={};function Yn(r,e){var t,n,s;return e?(r>>>=0,(s=0<=r&&r<256)&&(n=Kl[r],n)?n:(t=te(r,0,!0),s&&(Kl[r]=t),t)):(r|=0,(s=-128<=r&&r<128)&&(n=Vl[r],n)?n:(t=te(r,r<0?-1:0,!1),s&&(Vl[r]=t),t))}Q.fromInt=Yn;function dt(r,e){if(isNaN(r))return e?an:wt;if(e){if(r<0)return an;if(r>=Lf)return Ff}else{if(r<=-9223372036854776e3)return qe;if(r+1>=hp)return Mf}return r<0?dt(-r,e).neg():te(r%bs|0,r/bs|0,e)}Q.fromNumber=dt;function te(r,e,t){return new Q(r,e,t)}Q.fromBits=te;var lo=Math.pow;function lc(r,e,t){if(r.length===0)throw Error("empty string");if(typeof e=="number"?(t=e,e=!1):e=!!e,r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return e?an:wt;if(t=t||10,t<2||36<t)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return lc(r.substring(1),e,t).neg();for(var s=dt(lo(t,8)),i=wt,o=0;o<r.length;o+=8){var a=Math.min(8,r.length-o),l=parseInt(r.substring(o,o+a),t);if(a<8){var u=dt(lo(t,a));i=i.mul(u).add(dt(l))}else i=i.mul(s),i=i.add(dt(l))}return i.unsigned=e,i}Q.fromString=lc;function yt(r,e){return typeof r=="number"?dt(r,e):typeof r=="string"?lc(r,e):te(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}Q.fromValue=yt;var zl=65536,fp=1<<24,bs=zl*zl,Lf=bs*bs,hp=Lf/2,jl=Yn(fp),wt=Yn(0);Q.ZERO=wt;var an=Yn(0,!0);Q.UZERO=an;var ns=Yn(1);Q.ONE=ns;var Jf=Yn(1,!0);Q.UONE=Jf;var Ja=Yn(-1);Q.NEG_ONE=Ja;var Mf=te(-1,2147483647,!1);Q.MAX_VALUE=Mf;var Ff=te(-1,-1,!0);Q.MAX_UNSIGNED_VALUE=Ff;var qe=te(0,-2147483648,!1);Q.MIN_VALUE=qe;var k=Q.prototype;k.toInt=function(){return this.unsigned?this.low>>>0:this.low};k.toNumber=function(){return this.unsigned?(this.high>>>0)*bs+(this.low>>>0):this.high*bs+(this.low>>>0)};k.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(qe)){var t=dt(e),n=this.div(t),s=n.mul(t).sub(this);return n.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=dt(lo(e,6),this.unsigned),o=this,a="";;){var l=o.div(i),u=o.sub(l.mul(i)).toInt()>>>0,f=u.toString(e);if(o=l,o.isZero())return f+a;for(;f.length<6;)f="0"+f;a=""+f+a}};k.getHighBits=function(){return this.high};k.getHighBitsUnsigned=function(){return this.high>>>0};k.getLowBits=function(){return this.low};k.getLowBitsUnsigned=function(){return this.low>>>0};k.getNumBitsAbs=function(){if(this.isNegative())return this.eq(qe)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};k.isSafeInteger=function(){var e=this.high>>21;return e?this.unsigned?!1:e===-1&&!(this.low===0&&this.high===-2097152):!0};k.isZero=function(){return this.high===0&&this.low===0};k.eqz=k.isZero;k.isNegative=function(){return!this.unsigned&&this.high<0};k.isPositive=function(){return this.unsigned||this.high>=0};k.isOdd=function(){return(this.low&1)===1};k.isEven=function(){return(this.low&1)===0};k.equals=function(e){return Ne(e)||(e=yt(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};k.eq=k.equals;k.notEquals=function(e){return!this.eq(e)};k.neq=k.notEquals;k.ne=k.notEquals;k.lessThan=function(e){return this.comp(e)<0};k.lt=k.lessThan;k.lessThanOrEqual=function(e){return this.comp(e)<=0};k.lte=k.lessThanOrEqual;k.le=k.lessThanOrEqual;k.greaterThan=function(e){return this.comp(e)>0};k.gt=k.greaterThan;k.greaterThanOrEqual=function(e){return this.comp(e)>=0};k.gte=k.greaterThanOrEqual;k.ge=k.greaterThanOrEqual;k.compare=function(e){if(Ne(e)||(e=yt(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};k.comp=k.compare;k.negate=function(){return!this.unsigned&&this.eq(qe)?qe:this.not().add(ns)};k.neg=k.negate;k.add=function(e){Ne(e)||(e=yt(e));var t=this.high>>>16,n=this.high&65535,s=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,u=e.low&65535,f=0,d=0,y=0,p=0;return p+=i+u,y+=p>>>16,p&=65535,y+=s+l,d+=y>>>16,y&=65535,d+=n+a,f+=d>>>16,d&=65535,f+=t+o,f&=65535,te(y<<16|p,f<<16|d,this.unsigned)};k.subtract=function(e){return Ne(e)||(e=yt(e)),this.add(e.neg())};k.sub=k.subtract;k.multiply=function(e){if(this.isZero())return this;if(Ne(e)||(e=yt(e)),ht){var t=ht.mul(this.low,this.high,e.low,e.high);return te(t,ht.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?an:wt;if(this.eq(qe))return e.isOdd()?qe:wt;if(e.eq(qe))return this.isOdd()?qe:wt;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(jl)&&e.lt(jl))return dt(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,u=e.low>>>16,f=e.low&65535,d=0,y=0,p=0,b=0;return b+=o*f,p+=b>>>16,b&=65535,p+=i*f,y+=p>>>16,p&=65535,p+=o*u,y+=p>>>16,p&=65535,y+=s*f,d+=y>>>16,y&=65535,y+=i*u,d+=y>>>16,y&=65535,y+=o*l,d+=y>>>16,y&=65535,d+=n*f+s*u+i*l+o*a,d&=65535,te(p<<16|b,d<<16|y,this.unsigned)};k.mul=k.multiply;k.divide=function(e){if(Ne(e)||(e=yt(e)),e.isZero())throw Error("division by zero");if(ht){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?ht.div_u:ht.div_s)(this.low,this.high,e.low,e.high);return te(t,ht.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?an:wt;var n,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return an;if(e.gt(this.shru(1)))return Jf;i=an}else{if(this.eq(qe)){if(e.eq(ns)||e.eq(Ja))return qe;if(e.eq(qe))return ns;var o=this.shr(1);return n=o.div(e).shl(1),n.eq(wt)?e.isNegative()?ns:Ja:(s=this.sub(e.mul(n)),i=n.add(s.div(e)),i)}else if(e.eq(qe))return this.unsigned?an:wt;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=wt}for(s=this;s.gte(e);){n=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(n)/Math.LN2),l=a<=48?1:lo(2,a-48),u=dt(n),f=u.mul(e);f.isNegative()||f.gt(s);)n-=l,u=dt(n,this.unsigned),f=u.mul(e);u.isZero()&&(u=ns),i=i.add(u),s=s.sub(f)}return i};k.div=k.divide;k.modulo=function(e){if(Ne(e)||(e=yt(e)),ht){var t=(this.unsigned?ht.rem_u:ht.rem_s)(this.low,this.high,e.low,e.high);return te(t,ht.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};k.mod=k.modulo;k.rem=k.modulo;k.not=function(){return te(~this.low,~this.high,this.unsigned)};k.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};k.clz=k.countLeadingZeros;k.countTrailingZeros=function(){return this.low?ql(this.low):ql(this.high)+32};k.ctz=k.countTrailingZeros;k.and=function(e){return Ne(e)||(e=yt(e)),te(this.low&e.low,this.high&e.high,this.unsigned)};k.or=function(e){return Ne(e)||(e=yt(e)),te(this.low|e.low,this.high|e.high,this.unsigned)};k.xor=function(e){return Ne(e)||(e=yt(e)),te(this.low^e.low,this.high^e.high,this.unsigned)};k.shiftLeft=function(e){return Ne(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?te(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):te(0,this.low<<e-32,this.unsigned)};k.shl=k.shiftLeft;k.shiftRight=function(e){return Ne(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?te(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):te(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};k.shr=k.shiftRight;k.shiftRightUnsigned=function(e){return Ne(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?te(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?te(this.high,0,this.unsigned):te(this.high>>>e-32,0,this.unsigned)};k.shru=k.shiftRightUnsigned;k.shr_u=k.shiftRightUnsigned;k.rotateLeft=function(e){var t;return Ne(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?te(this.high,this.low,this.unsigned):e<32?(t=32-e,te(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,te(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))};k.rotl=k.rotateLeft;k.rotateRight=function(e){var t;return Ne(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?te(this.high,this.low,this.unsigned):e<32?(t=32-e,te(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,te(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))};k.rotr=k.rotateRight;k.toSigned=function(){return this.unsigned?te(this.low,this.high,!1):this};k.toUnsigned=function(){return this.unsigned?this:te(this.low,this.high,!0)};k.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};k.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};k.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Q.fromBytes=function(e,t,n){return n?Q.fromBytesLE(e,t):Q.fromBytesBE(e,t)};Q.fromBytesLE=function(e,t){return new Q(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Q.fromBytesBE=function(e,t){return new Q(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};typeof BigInt=="function"&&(Q.fromBigInt=function(e,t){var n=Number(BigInt.asIntN(32,e)),s=Number(BigInt.asIntN(32,e>>BigInt(32)));return te(n,s,t)},Q.fromValue=function(e,t){return typeof e=="bigint"?fromBigInt(e,t):yt(e,t)},k.toBigInt=function(){var e=BigInt(this.low>>>0),t=BigInt(this.unsigned?this.high>>>0:this.high);return t<<BigInt(32)|e});var Ae=(r=>(r[r.Null=0]="Null",r[r.Boolean=1]="Boolean",r[r.Integer=2]="Integer",r[r.Long=3]="Long",r[r.Double=4]="Double",r[r.String=5]="String",r[r.Bytes=6]="Bytes",r[r.Date=7]="Date",r))(Ae||{});class ye extends li{constructor(t,n){super(n);c(this,"valueType");c(this,"value");this.valueType=ye.getPrimitiveType(t),this.value=t===void 0?null:t}static of(t,n){return new ye(t,n)}static valueFromBytes(t,n){switch(t){case 0:return null;case 1:return!!n[0];case 2:return n[0]|n[1]<<8|n[2]<<16|n[3]<<24;case 4:{const s=new DataView(n.buffer);return n.forEach(function(i,o){s.setUint8(o,i)}),s.getFloat64(0,!0)}case 5:return new TextDecoder("utf-8").decode(n);case 3:return Q.fromBytesLE(Array.from(n));case 6:return n;case 7:return new Date(Q.fromBytesLE(Array.from(n),!0).toNumber());default:throw new w(v.ErrUnimplemented,`unimplemented type: ${t}`)}}toJSON(){return this.valueType===5?`"${zt(this.value)}"`:`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_PRIMITIVE"}}deepcopy(){const t=ye.of(this.value,this.getCreatedAt());return t.setMovedAt(this.getMovedAt()),t.setRemovedAt(this.getRemovedAt()),t}getType(){return this.valueType}static getPrimitiveType(t){switch(typeof t){case"undefined":return 0;case"boolean":return 1;case"number":return this.isInteger(t)?2:4;case"string":return 5;case"object":if(t===null)return 0;if(t instanceof Q)return 3;if(t instanceof Uint8Array)return 6;if(t instanceof Date)return 7}}static isSupport(t){return ye.getPrimitiveType(t)!==void 0}static isInteger(t){return t%1===0}isNumericType(){const t=this.valueType;return t===2||t===3||t===4}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:return new Uint8Array;case 1:return this.value?new Uint8Array([1]):new Uint8Array([0]);case 2:{const t=this.value;return new Uint8Array([t&255,t>>8&255,t>>16&255,t>>24&255])}case 4:{const t=this.value,n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,t,!0),n}case 5:return new TextEncoder().encode(this.value);case 3:{const n=this.value.toBytesLE();return Uint8Array.from(n)}case 6:return this.value;case 7:{const t=this.value,n=Q.fromNumber(t.getTime(),!0).toBytesLE();return Uint8Array.from(n)}default:throw new w(v.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}}class uo extends Rf{constructor(t){super(t);c(this,"prev");c(this,"next");this.value=t}static createAfter(t,n){const s=new uo(n),i=t.next;return t.next=s,s.prev=t,s.next=i,i&&(i.prev=s),s}remove(t){return this.value.remove(t)}getCreatedAt(){return this.value.getCreatedAt()}getPositionedAt(){return this.value.getPositionedAt()}release(){this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.prev=void 0,this.next=void 0}getLength(){return this.value.isRemoved()?0:1}getPrev(){return this.prev}getNext(){return this.next}getValue(){return this.value}isRemoved(){return this.value.isRemoved()}}class ni{constructor(){c(this,"dummyHead");c(this,"last");c(this,"nodeMapByIndex");c(this,"nodeMapByCreatedAt");const e=ye.of(0,St);e.setRemovedAt(St),this.dummyHead=new uo(e),this.last=this.dummyHead,this.nodeMapByIndex=new ri,this.nodeMapByCreatedAt=new Map,this.nodeMapByIndex.insert(this.dummyHead),this.nodeMapByCreatedAt.set(this.dummyHead.getCreatedAt().toIDString(),this.dummyHead)}static create(){return new ni}get length(){return this.nodeMapByIndex.length}findNextBeforeExecutedAt(e,t){let n=this.nodeMapByCreatedAt.get(e.toIDString());if(!n)throw new w(v.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);for(;n.getNext()&&n.getNext().getPositionedAt().after(t);)n=n.getNext();return n}release(e){this.last===e&&(this.last=e.getPrev()),e.release(),this.nodeMapByIndex.delete(e),this.nodeMapByCreatedAt.delete(e.getValue().getCreatedAt().toIDString())}insertAfter(e,t,n=t.getCreatedAt()){const s=this.findNextBeforeExecutedAt(e,n),i=uo.createAfter(s,t);s===this.last&&(this.last=i),this.nodeMapByIndex.insertAfter(s,i),this.nodeMapByCreatedAt.set(i.getCreatedAt().toIDString(),i)}moveAfter(e,t,n){const s=this.nodeMapByCreatedAt.get(e.toIDString());if(!s)throw new w(v.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);const i=this.nodeMapByCreatedAt.get(t.toIDString());if(!i)throw new w(v.ErrInvalidArgument,`cant find the given node: ${t.toIDString()}`);s!==i&&(!i.getValue().getMovedAt()||n.after(i.getValue().getMovedAt()))&&(this.release(i),this.insertAfter(s.getCreatedAt(),i.getValue(),n),i.getValue().setMovedAt(n))}insert(e){this.insertAfter(this.last.getCreatedAt(),e)}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}subPathOf(e){const t=this.nodeMapByCreatedAt.get(e.toIDString());if(t)return String(this.nodeMapByIndex.indexOf(t))}purge(e){const t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!t)throw new w(v.ErrInvalidArgument,`fail to find the given createdAt: ${e.getCreatedAt().toIDString()}`);this.release(t)}getByIndex(e){if(e>=this.length)return;const[t,n]=this.nodeMapByIndex.find(e);let s=t;if(e===0&&t===this.dummyHead||n>0)do s&&(s=s.getNext());while(s&&s.isRemoved());return s}getPrevCreatedAt(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());do t=t.getPrev();while(this.dummyHead!==t&&t.isRemoved());return t.getValue().getCreatedAt()}delete(e,t){const n=this.nodeMapByCreatedAt.get(e.toIDString()),s=n.isRemoved();return n.remove(t)&&!s&&this.nodeMapByIndex.splayNode(n),n.getValue()}deleteByIndex(e,t){const n=this.getByIndex(e);if(n)return n.remove(t)&&this.nodeMapByIndex.splayNode(n),n.getValue()}getHead(){return this.dummyHead.getValue()}getLast(){return this.last.getValue()}getLastCreatedAt(){return this.last.getCreatedAt()}toTestString(){const e=[];for(const t of this){const n=`${t.getCreatedAt().toIDString()}:${t.getValue().toJSON()}`;t.isRemoved()?e.push(`{${n}}`):e.push(`[${n}]`)}return e.join("")}*[Symbol.iterator](){let e=this.dummyHead.getNext();for(;e;)yield e,e=e.getNext()}}class Xe extends Sn{constructor(t,n){super(t);c(this,"elements");this.elements=n}static create(t,n){if(!n)return new Xe(t,ni.create());const s=ni.create();for(const i of n)s.insertAfter(s.getLastCreatedAt(),i.deepcopy());return new Xe(t,s)}subPathOf(t){return this.elements.subPathOf(t)}purge(t){this.elements.purge(t)}insertAfter(t,n){this.elements.insertAfter(t,n)}moveAfter(t,n,s){this.elements.moveAfter(t,n,s)}get(t){const n=this.elements.getByIndex(t);return n==null?void 0:n.getValue()}getByID(t){const n=this.elements.getByID(t);return n==null?void 0:n.getValue()}getHead(){return this.elements.getHead()}getLast(){return this.elements.getLast()}getPrevCreatedAt(t){return this.elements.getPrevCreatedAt(t)}delete(t,n){return this.elements.delete(t,n)}deleteByIndex(t,n){return this.elements.deleteByIndex(t,n)}getLastCreatedAt(){return this.elements.getLastCreatedAt()}get length(){return this.elements.length}*[Symbol.iterator](){for(const t of this.elements)t.isRemoved()||(yield t.getValue())}toTestString(){return this.elements.toTestString()}getDescendants(t){for(const n of this.elements){const s=n.getValue();if(t(s,this))return;s instanceof Sn&&s.getDescendants(t)}}toJSON(){const t=[];for(const n of this)t.push(n.toJSON());return`[${t.join(",")}]`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const t={};for(let n=0;n<this.length;n++){const{createdAt:s,value:i,type:o}=this.get(n).toJSForTest();t[n]={key:String(n),createdAt:s,value:i,type:o}}return{createdAt:this.getCreatedAt().toTestString(),value:t,type:"YORKIE_ARRAY"}}toSortedJSON(){return this.toJSON()}getElements(){return this.elements}deepcopy(){const t=Xe.create(this.getCreatedAt());for(const n of this.elements)t.elements.insertAfter(t.getLastCreatedAt(),n.getValue().deepcopy());return t.remove(this.getRemovedAt()),t}}class Cn extends xt{constructor(t,n,s){super(t,s);c(this,"createdAt");this.createdAt=n}static create(t,n,s){return new Cn(t,n,s)}execute(t,n){var u;const s=t.findByCreatedAt(this.getParentCreatedAt());if(!s)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(s instanceof Sn))throw new w(v.ErrInvalidArgument,`only object and array can execute remove: ${s}`);if(n===ae.UndoRedo){let f=s.getByID(this.createdAt);for(;f;){if(f.getRemovedAt())return;f=(u=t.findElementPairByCreatedAt(f.getCreatedAt()))==null?void 0:u.parent}}const i=s.subPathOf(this.createdAt),o=this.toReverseOperation(s),a=s.delete(this.createdAt,this.getExecutedAt());return t.registerRemovedElement(a),{opInfos:s instanceof Xe?[{type:"remove",path:t.createPath(this.getParentCreatedAt()),index:Number(i)}]:[{type:"remove",path:t.createPath(this.getParentCreatedAt()),key:i}],reverseOp:o}}toReverseOperation(t){if(t instanceof Ve){const n=t.subPathOf(this.createdAt);if(n!==void 0){const s=t.get(n);if(s!==void 0)return Gn.create(n,s.deepcopy(),this.getParentCreatedAt())}}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.REMOVE.${this.createdAt.toTestString()}`}getCreatedAt(){return this.createdAt}}class Gn extends xt{constructor(t,n,s,i){super(s,i);c(this,"key");c(this,"value");this.key=t,this.value=n}static create(t,n,s,i){return new Gn(t,n,s,i)}execute(t,n){var u;const s=t.findByCreatedAt(this.getParentCreatedAt());if(!s)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(s instanceof Ve))throw new w(v.ErrInvalidArgument,"fail to execute, only object can execute set");if(n===ae.UndoRedo){let f=s;for(;f;){if(f.getRemovedAt())return;f=(u=t.findElementPairByCreatedAt(f.getCreatedAt()))==null?void 0:u.parent}}const i=s.get(this.key),o=this.toReverseOperation(i),a=this.value.deepcopy(),l=s.set(this.key,a,this.getExecutedAt());return n===ae.UndoRedo&&t.findByCreatedAt(a.getCreatedAt())&&t.deregisterElement(a),t.registerElement(a,s),l&&t.registerRemovedElement(l),{opInfos:[{type:"set",path:t.createPath(this.getParentCreatedAt()),key:this.key}],reverseOp:o}}toReverseOperation(t){let n=Cn.create(this.getParentCreatedAt(),this.value.getCreatedAt());return t!==void 0&&!t.isRemoved()&&(n=Gn.create(this.key,t.deepcopy(),this.getParentCreatedAt())),n}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.SET.${this.key}=${this.value.toSortedJSON()}`}getKey(){return this.key}getValue(){return this.value}}class ui extends xt{constructor(t,n,s,i){super(t,i);c(this,"prevCreatedAt");c(this,"value");this.prevCreatedAt=n,this.value=s}static create(t,n,s,i){return new ui(t,n,s,i)}execute(t){const n=t.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof Xe))throw new w(v.ErrInvalidArgument,"fail to execute, only array can execute add");const s=n,i=this.value.deepcopy();return s.insertAfter(this.prevCreatedAt,i),t.registerElement(i,s),{opInfos:[{type:"add",path:t.createPath(this.getParentCreatedAt()),index:Number(s.subPathOf(this.getEffectedCreatedAt()))}]}}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.ADD.${this.value.toJSON()}`}getPrevCreatedAt(){return this.prevCreatedAt}getValue(){return this.value}}class Tn extends xt{constructor(t,n,s,i){super(t,i);c(this,"prevCreatedAt");c(this,"createdAt");this.prevCreatedAt=n,this.createdAt=s}static create(t,n,s,i){return new Tn(t,n,s,i)}execute(t){const n=t.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof Xe))throw new w(v.ErrInvalidArgument,"fail to execute, only array can execute move");const s=n,i=Number(s.subPathOf(this.createdAt));s.moveAfter(this.prevCreatedAt,this.createdAt,this.getExecutedAt());const o=Number(s.subPathOf(this.createdAt));return{opInfos:[{type:"move",path:t.createPath(this.getParentCreatedAt()),index:o,previousIndex:i}]}}getEffectedCreatedAt(){return this.createdAt}toTestString(){return`${this.getParentCreatedAt().toTestString()}.MOVE`}getPrevCreatedAt(){return this.prevCreatedAt}getCreatedAt(){return this.createdAt}}class qn{constructor(e,t,n,s){c(this,"key");c(this,"value");c(this,"updatedAt");c(this,"_isRemoved");this.key=e,this.value=t,this.updatedAt=n,this._isRemoved=s}static of(e,t,n,s){return new qn(e,t,n,s)}getKey(){return this.key}getValue(){return this.value}getUpdatedAt(){return this.updatedAt}isRemoved(){return this._isRemoved}toIDString(){return`${this.updatedAt.toIDString()}:${this.key}`}getRemovedAt(){if(this._isRemoved)return this.updatedAt}}class fn{constructor(){c(this,"nodeMapByKey");c(this,"numberOfRemovedElement");this.nodeMapByKey=new Map,this.numberOfRemovedElement=0}static create(){return new fn}getNodeMapByKey(){return this.nodeMapByKey}set(e,t,n){const s=this.nodeMapByKey.get(e);if(s&&s.isRemoved()&&n.after(s.getUpdatedAt())&&(this.numberOfRemovedElement-=1),s===void 0||n.after(s.getUpdatedAt())){const i=qn.of(e,t,n,!1);return this.nodeMapByKey.set(e,i),s!==void 0&&s.isRemoved()?[s,i]:[void 0,i]}return s.isRemoved()?[s,void 0]:[void 0,void 0]}setInternal(e,t,n,s){const i=qn.of(e,t,n,s);this.nodeMapByKey.set(e,i),s&&this.numberOfRemovedElement++}remove(e,t){const n=this.nodeMapByKey.get(e),s=[];if(n===void 0||t.after(n.getUpdatedAt())){if(n===void 0){this.numberOfRemovedElement+=1;const a=qn.of(e,"",t,!0);return this.nodeMapByKey.set(e,a),s.push(a),s}const i=n.isRemoved();i||(this.numberOfRemovedElement+=1),i&&s.push(n);const o=qn.of(e,n.getValue(),t,!0);return this.nodeMapByKey.set(e,o),s.push(o),s}return s}has(e){if(this.nodeMapByKey.has(e)){const t=this.nodeMapByKey.get(e);return t!==void 0&&!t.isRemoved()}return!1}get(e){if(this.nodeMapByKey.has(e))return this.nodeMapByKey.get(e).getValue()}deepcopy(){const e=new fn;for(const[,t]of this.nodeMapByKey)e.setInternal(t.getKey(),t.getValue(),t.getUpdatedAt(),t.isRemoved());return e}toJSON(){if(!this.size())return"{}";const e=[];for(const[t,n]of this.nodeMapByKey)n.isRemoved()||e.push(`"${zt(t)}":"${zt(n.getValue())}"`);return`{${e.join(",")}}`}size(){return this.nodeMapByKey.size-this.numberOfRemovedElement}toObject(){const e={};for(const[t,n]of this.nodeMapByKey)n.isRemoved()||(e[t]=n.getValue());return e}*[Symbol.iterator](){for(const[,e]of this.nodeMapByKey)yield e}purge(e){const t=this.nodeMapByKey.get(e.getKey());t==null||t.toIDString()!=e.toIDString()||(this.nodeMapByKey.delete(e.getKey()),this.numberOfRemovedElement--)}}class si{constructor(e){c(this,"attributes");c(this,"content");this.attributes=fn.create(),this.content=e}static create(e){return new si(e)}get length(){return this.content.length}substring(e,t){const n=new si(this.content.substring(e,t));return n.attributes=this.attributes.deepcopy(),n}setAttr(e,t,n){return this.attributes.set(e,t,n)}getAttrs(){return this.attributes}toString(){return this.content}toJSON(){const e=zt(this.content),t=this.attributes.toObject(),n=[];for(const[s,i]of Object.entries(t)){const o=JSON.parse(i),a=typeof o=="string"?`"${zt(s)}":"${zt(o)}"`:`"${zt(s)}":${String(o)}`;n.push(a)}return n.sort(),n.length===0?`{"val":"${e}"}`:`{"attrs":{${n.join(",")}},"val":"${e}"}`}getAttributes(){return this.attributes.toObject()}getContent(){return this.content}purge(e){this.attributes&&e instanceof qn&&this.attributes.purge(e)}getGCPairs(){const e=[];for(const t of this.attributes)t.getRemovedAt()&&e.push({parent:this,child:t});return e}}class mt extends li{constructor(t,n){super(n);c(this,"rgaTreeSplit");this.rgaTreeSplit=t}static create(t,n){return new mt(t,n)}edit(t,n,s,i,o,a){const l=n?si.create(n):void 0;if(l&&i)for(const[b,S]of Object.entries(i))l.setAttr(b,S,s);const[u,f,d,y]=this.rgaTreeSplit.edit(t,s,l,o,a),p=y.map(b=>({...b,value:b.value?{attributes:us(b.value.getAttributes()),content:b.value.getContent()}:{attributes:void 0,content:""},type:"content"}));return[f,p,d,[u,u]]}setStyle(t,n,s,i,o){const[,a]=this.rgaTreeSplit.findNodeWithSplit(t[1],s),[,l]=this.rgaTreeSplit.findNodeWithSplit(t[0],s),u=[],f=this.rgaTreeSplit.findBetween(l,a),d=new Map,y=[];for(const b of f){const S=b.getCreatedAt().getActorID();let B,D=0n;if(o===void 0&&i===void 0?D=Vs:o.size()>0?D=o.get(S)?o.get(S):0n:B=i.has(S)?i.get(S):St,b.canStyle(s,B,D)){const F=d.get(S),V=b.getCreatedAt();(!F||V.after(F))&&d.set(S,V),y.push(b)}}const p=[];for(const b of y){if(b.isRemoved())continue;const[S,B]=this.rgaTreeSplit.findIndexesFromRange(b.createPosRange());u.push({type:"style",actor:s.getActorID(),from:S,to:B,value:{attributes:us(n)}});for(const[D,F]of Object.entries(n)){const[V]=b.getValue().setAttr(D,F,s);V!==void 0&&p.push({parent:b.getValue(),child:V})}}return[d,p,u]}indexRangeToPosRange(t,n){const s=this.rgaTreeSplit.indexToPos(t);return t===n?[s,s]:[s,this.rgaTreeSplit.indexToPos(n)]}get length(){return this.rgaTreeSplit.length}getTreeByIndex(){return this.rgaTreeSplit.getTreeByIndex()}getTreeByID(){return this.rgaTreeSplit.getTreeByID()}toJSON(){const t=[];for(const n of this.rgaTreeSplit)n.isRemoved()||t.push(n.getValue().toJSON());return`[${t.join(",")}]`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TEXT"}}toString(){return this.rgaTreeSplit.toString()}values(){const t=[];for(const n of this.rgaTreeSplit)if(!n.isRemoved()){const s=n.getValue();t.push({attributes:us(s.getAttributes()),content:s.getContent()})}return t}getRGATreeSplit(){return this.rgaTreeSplit}toTestString(){return this.rgaTreeSplit.toTestString()}deepcopy(){const t=new mt(this.rgaTreeSplit.deepcopy(),this.getCreatedAt());return t.remove(this.getRemovedAt()),t}findIndexesFromRange(t){return this.rgaTreeSplit.findIndexesFromRange(t)}getGCPairs(){const t=[];for(const n of this.rgaTreeSplit){n.getRemovedAt()&&t.push({parent:this.rgaTreeSplit,child:n});for(const s of n.getValue().getGCPairs())t.push(s)}return t}}class fi extends xt{constructor(t,n,s,i,o,a,l){super(t,l);c(this,"fromPos");c(this,"toPos");c(this,"maxCreatedAtMapByActor");c(this,"content");c(this,"attributes");this.fromPos=n,this.toPos=s,this.maxCreatedAtMapByActor=i,this.content=o,this.attributes=a}static create(t,n,s,i,o,a,l){return new fi(t,n,s,i,o,a,l)}execute(t,n,s){const i=t.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof mt))throw new w(v.ErrInvalidArgument,"fail to execute, only Text can execute edit");const o=i,[,a,l]=o.edit([this.fromPos,this.toPos],this.content,this.getExecutedAt(),Object.fromEntries(this.attributes),this.maxCreatedAtMapByActor,s);for(const u of l)t.registerGCPair(u);return{opInfos:a.map(({from:u,to:f,value:d})=>({type:"edit",from:u,to:f,value:d,path:t.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const t=this.getParentCreatedAt().toTestString(),n=this.fromPos.toTestString(),s=this.toPos.toTestString(),i=this.content;return`${t}.EDIT(${n},${s},${i})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContent(){return this.content}getAttributes(){return this.attributes||new Map}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}}class hi extends xt{constructor(t,n,s,i,o,a){super(t,a);c(this,"fromPos");c(this,"toPos");c(this,"maxCreatedAtMapByActor");c(this,"attributes");this.fromPos=n,this.toPos=s,this.maxCreatedAtMapByActor=i,this.attributes=o}static create(t,n,s,i,o,a){return new hi(t,n,s,i,o,a)}execute(t,n,s){const i=t.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof mt))throw new w(v.ErrInvalidArgument,"fail to execute, only Text can execute edit");const o=i,[,a,l]=o.setStyle([this.fromPos,this.toPos],this.attributes?Object.fromEntries(this.attributes):{},this.getExecutedAt(),this.maxCreatedAtMapByActor,s);for(const u of a)t.registerGCPair(u);return{opInfos:l.map(({from:u,to:f,value:d})=>({type:"style",from:u,to:f,value:d,path:t.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const t=this.getParentCreatedAt().toTestString(),n=this.fromPos.toTestString(),s=this.toPos.toTestString(),i=this.attributes;return`${t}.STYL(${n},${s},${JSON.stringify(i)})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}}const dp=2,gp="root",cn="text";function Ps(r,e){let t=0;const n=r.children;for(let s=0;s<e;s++){const i=n[s];!i||i.isRemoved||(t+=i.paddedSize)}return t}class mp{constructor(e,t=[]){c(this,"type");c(this,"parent");c(this,"_children");c(this,"size");if(this.type=e,this.size=0,this._children=t,this.isText&&this._children.length>0)throw new w(v.ErrRefused,"Text node cannot have children")}updateAncestorsSize(){let e=this.parent;const t=this.isRemoved?-1:1;for(;e&&(e.size+=this.paddedSize*t,!e.isRemoved);)e=e.parent}updateDescendantsSize(){let e=0;for(const t of this._children){const n=t.updateDescendantsSize();t.isRemoved||(e+=n)}return this.size+=e,this.paddedSize}get isText(){return this.type===cn}get paddedSize(){return this.size+(this.isText?0:dp)}isAncestorOf(e){return pp(this,e)}get nextSibling(){const e=this.parent.findOffset(this),t=this.parent.children[e+1];if(t)return t}get prevSibling(){const e=this.parent.findOffset(this),t=this.parent.children[e-1];if(t)return t}splitText(e,t){if(e===0||e===this.size)return;const n=this.value.slice(0,e),s=this.value.slice(e);if(!s.length)return;this.value=n;const i=this.cloneText(e+t);return i.value=s,this.parent.insertAfterInternal(i,this),i}get children(){return this._children.filter(e=>!e.isRemoved)}get allChildren(){return[...this._children]}hasTextChild(){return this.children.length>0&&this.children.every(e=>e.isText)}append(...e){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");this._children.push(...e);for(const t of e)t.parent=this,t.updateAncestorsSize()}prepend(...e){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");this._children.unshift(...e);for(const t of e)t.parent=this}insertBefore(e,t){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");const n=this._children.indexOf(t);if(n===-1)throw new w(v.ErrInvalidArgument,"child not found");this.insertAtInternal(e,n),e.updateAncestorsSize()}insertAfter(e,t){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");const n=this._children.indexOf(t);if(n===-1)throw new w(v.ErrInvalidArgument,"child not found");this.insertAtInternal(e,n+1),e.updateAncestorsSize()}insertAt(e,t){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");this.insertAtInternal(e,t),e.updateAncestorsSize()}removeChild(e){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");const t=this._children.indexOf(e);if(t===-1)throw new w(v.ErrInvalidArgument,"child not found");this._children.splice(t,1),e.parent=void 0}splitElement(e,t){const n=this.cloneElement(t);this.parent.insertAfterInternal(n,this),n.updateAncestorsSize();const s=this.children.slice(0,e),i=this.children.slice(e);this._children=s,n._children=i,this.size=this._children.reduce((o,a)=>o+a.paddedSize,0),n.size=n._children.reduce((o,a)=>o+a.paddedSize,0);for(const o of n._children)o.parent=n;return n}insertAfterInternal(e,t){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");const n=this._children.indexOf(t);if(n===-1)throw new w(v.ErrInvalidArgument,"child not found");this.insertAtInternal(e,n+1)}insertAtInternal(e,t){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");this._children.splice(t,0,e),e.parent=this}findOffset(e){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");if(e.isRemoved){const t=this._children.indexOf(e);return this.allChildren.splice(0,t).filter(s=>!s.isRemoved).length}return this.children.indexOf(e)}findBranchOffset(e){if(this.isText)throw new w(v.ErrRefused,"Text node cannot have children");let t=e;for(;t;){const n=this._children.indexOf(t);if(n!==-1)return n;t=t.parent}return-1}}function pp(r,e){if(r===e)return!1;for(;e.parent;){if(e.parent===r)return!0;e=e.parent}return!1}var be=(r=>(r.Start="Start",r.End="End",r.Text="Text",r))(be||{});function $f(r,e,t,n){if(e>t)throw new w(v.ErrInvalidArgument,`from is greater than to: ${e} > ${t}`);if(e>r.size)throw new w(v.ErrInvalidArgument,`from is out of range: ${e} > ${r.size}`);if(t>r.size)throw new w(v.ErrInvalidArgument,`to is out of range: ${t} > ${r.size}`);if(e===t)return;let s=0;for(const i of r.children){if(e-i.paddedSize<s&&s<t){const o=i.isText?e-s:e-s-1,a=i.isText?t-s:t-s-1,l=!i.isText&&o<0,u=!i.isText&&a>i.size;(i.isText||l)&&n([i,i.isText?"Text":"Start"],u),$f(i,Math.max(0,o),Math.min(a,i.size),n),u&&n([i,"End"],u)}s+=i.paddedSize}}function Uf(r,e,t=0){for(const n of r.children)Uf(n,e,t+1);e(r,t)}function Co(r,e,t=0){for(const n of r._children)Co(n,e,t+1);e(r,t)}function Ma(r,e,t=!0){if(e>r.size)throw new w(v.ErrInvalidArgument,`index is out of range: ${e} > ${r.size}`);if(r.isText)return{node:r,offset:e};let n=0,s=0;for(const i of r.children){if(t&&i.isText&&i.size>=e-s)return Ma(i,e-s,t);if(e===s)return{node:r,offset:n};if(!t&&i.paddedSize===e-s)return{node:r,offset:n+1};if(i.paddedSize>e-s)return Ma(i,e-s-1,t);s+=i.paddedSize,n+=1}return{node:r,offset:n}}function qf(r){return r.isText||r.children.length===0?r:qf(r.children[0])}function yp(r,e){if(r.size<e)throw new w(v.ErrInvalidArgument,"unacceptable path");for(let t=0;t<r.children.length;t++){const n=r.children[t];if(n.size<e)e-=n.size;else{r=n;break}}return{node:r,offset:e}}class vp{constructor(e){c(this,"root");this.root=e}tokensBetween(e,t,n){$f(this.root,e,t,n)}traverse(e){Uf(this.root,e,0)}traverseAll(e){Co(this.root,e,0)}findTreePos(e,t=!0){return Ma(this.root,e,t)}treePosToPath(e){const t=[];let n=e.node;if(n.isText){const s=n.parent.findOffset(n);if(s===-1)throw new w(v.ErrInvalidArgument,"invalid treePos");const i=Ps(n.parent,s);t.push(i+e.offset),n=n.parent}else if(n.hasTextChild()){const s=Ps(n,e.offset);t.push(s)}else t.push(e.offset);for(;n.parent;){const s=n.parent.findOffset(n);if(s===-1)throw new w(v.ErrInvalidArgument,"invalid treePos");t.push(s),n=n.parent}return t.reverse()}pathToIndex(e){const t=this.pathToTreePos(e);return this.indexOf(t)}pathToTreePos(e){if(!e.length)throw new w(v.ErrInvalidArgument,"unacceptable path");let t=this.root;for(let n=0;n<e.length-1;n++){const s=e[n];if(t=t.children[s],!t)throw new w(v.ErrInvalidArgument,"unacceptable path")}if(t.hasTextChild())return yp(t,e[e.length-1]);if(t.children.length<e[e.length-1])throw new w(v.ErrInvalidArgument,"unacceptable path");return{node:t,offset:e[e.length-1]}}getRoot(){return this.root}get size(){return this.root.size}findPostorderRight(e){const{node:t,offset:n}=e;if(t.isText){if(t.size===n){const s=t.nextSibling;return s||t.parent}return t}return t.children.length===n?t:qf(t.children[n])}indexOf(e){let{node:t}=e;const{offset:n}=e;let s=0,i=1;if(t.isText){s+=n;const o=t.parent,a=o.findOffset(t);if(a===-1)throw new w(v.ErrInvalidArgument,"invalid pos");s+=Ps(o,a),t=t.parent}else s+=Ps(t,n);for(;t!=null&&t.parent;){const o=t.parent,a=o.findOffset(t);if(a===-1)throw new w(v.ErrInvalidArgument,"invalid pos");s+=Ps(o,a),i++,t=t.parent}return s+i-1}indexToPath(e){const t=this.findTreePos(e);return this.treePosToPath(t)}}const wp=(r,e)=>r===e?0:r<e?-1:1;class bp{constructor(e,t,n){c(this,"key");c(this,"value");c(this,"parent");c(this,"left");c(this,"right");c(this,"isRed");this.key=e,this.value=t,this.isRed=n}}class Tp{constructor(e){c(this,"stack");this.stack=[],this.traverseInorder(e)}traverseInorder(e){e&&(this.traverseInorder(e.left),this.stack.push({key:e.key,value:e.value}),this.traverseInorder(e.right))}}class Vf{constructor(e){c(this,"root");c(this,"comparator");c(this,"counter");this.comparator=typeof e<"u"?e:wp,this.counter=0}put(e,t){return this.root=this.putInternal(e,t,this.root),this.root.isRed=!1,t}get(e){const t=this.getInternal(e,this.root);return t?t.value:void 0}remove(e){!this.isRed(this.root.left)&&!this.isRed(this.root.right)&&(this.root.isRed=!0),this.root=this.removeInternal(this.root,e),this.root&&(this.root.isRed=!1)}getIterator(){return new Tp(this.root)}values(){const e=[];for(const t of this.getIterator().stack)e.push(t.value);return e}floorEntry(e){let t=this.root;for(;t;){const n=this.comparator(e,t.key);if(n>0)if(t.right)t.right.parent=t,t=t.right;else return t;else if(n<0)if(t.left)t.left.parent=t,t=t.left;else{let s=t.parent,i=t;for(;s&&i===s.left;)i=s,s=s.parent;return s}else return t}}lastEntry(){if(!this.root)return this.root;let e=this.root;for(;e.right;)e=e.right;return e}size(){return this.counter}isEmpty(){return this.counter===0}getInternal(e,t){for(;t;){const n=this.comparator(e,t.key);if(n===0)return t;n<0?t=t.left:n>0&&(t=t.right)}}putInternal(e,t,n){if(!n)return this.counter+=1,new bp(e,t,!0);const s=this.comparator(e,n.key);return s<0?n.left=this.putInternal(e,t,n.left):s>0?n.right=this.putInternal(e,t,n.right):n.value=t,this.isRed(n.right)&&!this.isRed(n.left)&&(n=this.rotateLeft(n)),this.isRed(n.left)&&this.isRed(n.left.left)&&(n=this.rotateRight(n)),this.isRed(n.left)&&this.isRed(n.right)&&this.flipColors(n),n}removeInternal(e,t){if(this.comparator(t,e.key)<0)!this.isRed(e.left)&&!this.isRed(e.left.left)&&(e=this.moveRedLeft(e)),e.left=this.removeInternal(e.left,t);else{if(this.isRed(e.left)&&(e=this.rotateRight(e)),this.comparator(t,e.key)===0&&!e.right){this.counter-=1;return}if(!this.isRed(e.right)&&!this.isRed(e.right.left)&&(e=this.moveRedRight(e)),this.comparator(t,e.key)===0){this.counter-=1;const n=this.min(e.right);e.value=n.value,e.key=n.key,e.right=this.removeMin(e.right)}else e.right=this.removeInternal(e.right,t)}return this.fixUp(e)}min(e){return e.left?this.min(e.left):e}removeMin(e){if(e.left)return!this.isRed(e.left)&&!this.isRed(e.left.left)&&(e=this.moveRedLeft(e)),e.left=this.removeMin(e.left),this.fixUp(e)}fixUp(e){return this.isRed(e.right)&&(e=this.rotateLeft(e)),this.isRed(e.left)&&this.isRed(e.left.left)&&(e=this.rotateRight(e)),this.isRed(e.left)&&this.isRed(e.right)&&this.flipColors(e),e}moveRedLeft(e){return this.flipColors(e),this.isRed(e.right.left)&&(e.right=this.rotateRight(e.right),e=this.rotateLeft(e),this.flipColors(e)),e}moveRedRight(e){return this.flipColors(e),this.isRed(e.left.left)&&(e=this.rotateRight(e),this.flipColors(e)),e}isRed(e){return e&&e.isRed}rotateLeft(e){const t=e.right;return e.right=t.left,t.left=e,t.isRed=t.left.isRed,t.left.isRed=!0,t}rotateRight(e){const t=e.left;return e.left=t.right,t.right=e,t.isRed=t.right.isRed,t.right.isRed=!0,t}flipColors(e){e.isRed=!e.isRed,e.left.isRed=!e.left.isRed,e.right.isRed=!e.right.isRed}}class bt{constructor(e,t){c(this,"parentID");c(this,"leftSiblingID");this.parentID=e,this.leftSiblingID=t}static of(e,t){return new bt(e,t)}static fromTreePos(e){const{offset:t}=e;let{node:n}=e,s;return n.isText?(n.parent.children[0]===n&&t===0?s=n.parent:s=n,n=n.parent):t===0?s=n:s=n.children[t-1],bt.of(n.id,ke.of(s.getCreatedAt(),s.getOffset()+t))}getParentID(){return this.parentID}static fromStruct(e){return bt.of(ke.of(gt.fromStruct(e.parentID.createdAt),e.parentID.offset),ke.of(gt.fromStruct(e.leftSiblingID.createdAt),e.leftSiblingID.offset))}toStruct(){return{parentID:{createdAt:this.getParentID().getCreatedAt().toStruct(),offset:this.getParentID().getOffset()},leftSiblingID:{createdAt:this.getLeftSiblingID().getCreatedAt().toStruct(),offset:this.getLeftSiblingID().getOffset()}}}toTreeNodePair(e){const t=this.getParentID(),n=this.getLeftSiblingID(),s=e.findFloorNode(t);let i=e.findFloorNode(n);if(!s||!i)throw new w(v.ErrRefused,`cannot find node of CRDTTreePos(${t.toTestString()}, ${n.toTestString()})`);return!n.equals(t)&&n.getOffset()>0&&n.getOffset()===i.id.getOffset()&&i.insPrevID&&(i=e.findFloorNode(i.insPrevID)),[s,i]}getLeftSiblingID(){return this.leftSiblingID}equals(e){return this.getParentID().getCreatedAt().equals(e.getParentID().getCreatedAt())&&this.getParentID().getOffset()===e.getParentID().getOffset()&&this.getLeftSiblingID().getCreatedAt().equals(e.getLeftSiblingID().getCreatedAt())&&this.getLeftSiblingID().getOffset()===e.getLeftSiblingID().getOffset()}}class ke{constructor(e,t){c(this,"createdAt");c(this,"offset");this.createdAt=e,this.offset=t}static of(e,t){return new ke(e,t)}static fromStruct(e){return ke.of(gt.fromStruct(e.createdAt),e.offset)}static createComparator(){return(e,t)=>{const n=e.getCreatedAt().compare(t.getCreatedAt());return n!==0?n:e.getOffset()>t.getOffset()?1:e.getOffset()<t.getOffset()?-1:0}}getCreatedAt(){return this.createdAt}equals(e){return this.createdAt.compare(e.createdAt)===0&&this.offset===e.offset}getOffset(){return this.offset}setOffset(e){this.offset=e}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}toTestString(){return`${this.createdAt.toTestString()}/${this.offset}`}}class Ye extends mp{constructor(t,n,s,i,o){super(n);c(this,"id");c(this,"removedAt");c(this,"attrs");c(this,"insPrevID");c(this,"insNextID");c(this,"_value","");this.id=t,this.removedAt=o,i&&(this.attrs=i),typeof s=="string"?this.value=s:Array.isArray(s)&&(this._children=s)}toIDString(){return this.id.toIDString()}getRemovedAt(){return this.removedAt}static create(t,n,s,i){return new Ye(t,n,s,i)}deepcopy(){var n;const t=new Ye(this.id,this.type);return t.removedAt=this.removedAt,t._value=this._value,t.size=this.size,t.attrs=(n=this.attrs)==null?void 0:n.deepcopy(),t._children=this._children.map(s=>{const i=s.deepcopy();return i.parent=t,i}),t.insPrevID=this.insPrevID,t.insNextID=this.insNextID,t}get value(){if(!this.isText)throw new w(v.ErrInvalidType,`cannot get value of element node: ${this.type}`);return this._value}set value(t){if(!this.isText)throw new w(v.ErrInvalidType,`cannot set value of element node: ${this.type}`);this._value=t,this.size=t.length}get isRemoved(){return!!this.removedAt}remove(t){const n=!this.removedAt;(!this.removedAt||this.removedAt.compare(t)>0)&&(this.removedAt=t),n&&this.updateAncestorsSize()}cloneText(t){return new Ye(ke.of(this.id.getCreatedAt(),t),this.type,void 0,void 0,this.removedAt)}cloneElement(t){return new Ye(ke.of(t(),0),this.type,void 0,void 0,this.removedAt)}split(t,n,s){const i=this.isText?this.splitText(n,this.id.getOffset()):this.splitElement(n,s);if(i){if(i.insPrevID=this.id,this.insNextID){const o=t.findFloorNode(this.insNextID);o.insPrevID=i.id,i.insNextID=this.insNextID}this.insNextID=i.id,t.registerNode(i)}return i}getCreatedAt(){return this.id.getCreatedAt()}getOffset(){return this.id.getOffset()}canDelete(t,n,s){return(n?!this.getCreatedAt().after(n):this.getCreatedAt().getLamport()<=s)&&(!this.removedAt||t.after(this.removedAt))}canStyle(t,n,s){return this.isText?!1:(n?!this.getCreatedAt().after(n):this.getCreatedAt().getLamport()<=s)&&(!this.removedAt||t.after(this.removedAt))}setAttrs(t,n){this.attrs||(this.attrs=new fn);const s=[];for(const[i,o]of Object.entries(t))s.push(this.attrs.set(i,o,n));return s}purge(t){this.attrs&&this.attrs.purge(t)}getGCPairs(){const t=[];if(!this.attrs)return t;for(const n of this.attrs)n.getRemovedAt()&&t.push({parent:this,child:n});return t}}function Fa(r){var t;if(r.isText){const n=r;return{type:n.type,value:n.value}}const e={type:r.type,children:r.children.map(Fa)};return r.attrs&&(e.attributes=us((t=r.attrs)==null?void 0:t.toObject())),e}function uc(r){if(r.isText)return r.value;let e="";return r.attrs&&r.attrs.size()&&(e=" "+Array.from(r.attrs).filter(t=>!t.isRemoved()).sort((t,n)=>t.getKey().localeCompare(n.getKey())).map(t=>{const n=JSON.parse(t.getValue());return typeof n=="string"?`${t.getKey()}="${n}"`:`${t.getKey()}="${zt(t.getValue())}"`}).join(" ")),`<${r.type}${e}>${r.children.map(t=>uc(t)).join("")}</${r.type}>`}function Kf(r){if(r.isText){const e=r;return{type:e.type,value:e.value,size:e.size,isRemoved:e.isRemoved}}return{type:r.type,children:r.children.map(Kf),size:r.size,isRemoved:r.isRemoved}}class pt extends li{constructor(t,n){super(n);c(this,"indexTree");c(this,"nodeMapByID");this.indexTree=new vp(t),this.nodeMapByID=new Vf(ke.createComparator()),this.indexTree.traverseAll(s=>{this.nodeMapByID.put(s.id,s)})}static create(t,n){return new pt(t,n)}findFloorNode(t){const n=this.nodeMapByID.floorEntry(t);if(!(!n||!n.key.getCreatedAt().equals(t.getCreatedAt())))return n.value}registerNode(t){this.nodeMapByID.put(t.id,t)}findNodesAndSplitText(t,n){const[s,i]=t.toTreeNodePair(this);let o=i;const a=s===o,l=o.parent&&!a?o.parent:s;if(o.isText&&o.split(this,t.getLeftSiblingID().getOffset()-o.id.getOffset()),n){const u=l.allChildren,f=a?0:u.indexOf(o)+1;for(let d=f;d<u.length;d++){const y=u[d];if(!y.id.getCreatedAt().after(n))break;o=y}}return[l,o]}style(t,n,s,i,o){const[a,l]=this.findNodesAndSplitText(t[0],s),[u,f]=this.findNodesAndSplitText(t[1],s),d=[],y=n?us(n):{},p=new Map,b=[];return this.traverseInPosRange(a,l,u,f,([S])=>{const B=S.getCreatedAt().getActorID();let D,F=0n;if(o===void 0&&i===void 0?F=Vs:o.size()>0?F=o.get(B)?o.get(B):0n:D=i.has(B)?i.get(B):St,S.canStyle(s,D,F)&&n){const V=p.get(B),J=S.getCreatedAt();(!V||J.after(V))&&p.set(B,J);const q=S.setAttrs(n,s),Y=q.reduce((Ie,[,Se])=>(Se&&(Ie[Se.getKey()]=y[Se.getKey()]),Ie),{}),Z=S.parent,se=S.prevSibling||S.parent;Object.keys(Y).length>0&&d.push({type:"style",from:this.toIndex(Z,se),to:this.toIndex(S,S),fromPath:this.toPath(Z,se),toPath:this.toPath(S,S),actor:s.getActorID(),value:Y});for(const[Ie]of q)Ie&&b.push({parent:S,child:Ie})}}),[p,b,d]}removeStyle(t,n,s,i,o){const[a,l]=this.findNodesAndSplitText(t[0],s),[u,f]=this.findNodesAndSplitText(t[1],s),d=[],y=new Map,p=[];return this.traverseInPosRange(a,l,u,f,([b])=>{const S=b.getCreatedAt().getActorID();let B,D=0n;if(o===void 0&&i===void 0?D=Vs:o.size()>0?D=o.get(S)?o.get(S):0n:B=i.has(S)?i.get(S):St,b.canStyle(s,B,D)&&n){const F=y.get(S),V=b.getCreatedAt();(!F||V.after(F))&&y.set(S,V),b.attrs||(b.attrs=new fn);for(const Y of n){const Z=b.attrs.remove(Y,s);for(const se of Z)p.push({parent:b,child:se})}const J=b.parent,q=b.prevSibling||b.parent;d.push({actor:s.getActorID(),type:"removeStyle",from:this.toIndex(J,q),to:this.toIndex(b,b),fromPath:this.toPath(J,q),toPath:this.toPath(b,b),value:n})}}),[y,p,d]}edit(t,n,s,i,o,a,l){const[u,f]=this.findNodesAndSplitText(t[0],i),[d,y]=this.findNodesAndSplitText(t[1],i),p=this.toIndex(u,f),b=this.toPath(u,f),S=[],B=[],D=[],F=new Map;this.traverseInPosRange(u,f,d,y,([q,Y],Z)=>{if(Y===be.Start&&!Z)for(const Qe of q.children)D.push(Qe);const se=q.getCreatedAt().getActorID();let Ie,Se=0n;if(l===void 0&&a===void 0?Se=Vs:l.size()>0?Se=l.get(se)?l.get(se):0n:Ie=a.has(se)?a.get(se):St,q.canDelete(i,Ie,Se)||S.includes(q.parent)){const Qe=F.get(se),Gt=q.getCreatedAt();(!Qe||Gt.after(Qe))&&F.set(se,Gt),(Y===be.Text||Y===be.Start)&&S.push(q),B.push([q,Y])}});const V=this.makeDeletionChanges(B,i),J=[];for(const q of S)q.remove(i),q.isRemoved&&J.push({parent:this,child:q});for(const q of D)q.removedAt||u.append(q);if(s>0){let q=0,Y=u,Z=f;for(;q<s;)Y.split(this,Y.findOffset(Z)+1,o),Z=Y,Y=Y.parent,q++;V.push({type:"content",from:p,to:p,fromPath:b,toPath:b,actor:i.getActorID()})}if(n!=null&&n.length){const q=[];let Y=f;for(const Z of n)Y===u?u.insertAt(Z,0):u.insertAfter(Z,Y),Y=Z,Co(Z,se=>{u.isRemoved&&(se.remove(i),J.push({parent:this,child:se})),this.nodeMapByID.put(se.id,se)}),Z.isRemoved||q.push(Z);if(q.length){const Z=q.map(se=>Fa(se));V.length&&V[V.length-1].from===p?V[V.length-1].value=Z:V.push({type:"content",from:p,to:p,fromPath:b,toPath:b,actor:i.getActorID(),value:Z})}}return[V,J,F]}editT(t,n,s,i,o){const a=this.findPos(t[0]),l=this.findPos(t[1]);this.edit([a,l],n,s,i,o)}move(t,n,s){throw new w(v.ErrUnimplemented,`not implemented: ${t}, ${n}, ${s}`)}purge(t){var i;(i=t.parent)==null||i.removeChild(t),this.nodeMapByID.remove(t.id);const n=t.insPrevID,s=t.insNextID;if(n){const o=this.findFloorNode(n);o.insNextID=s}if(s){const o=this.findFloorNode(s);o.insPrevID=n}t.insPrevID=void 0,t.insNextID=void 0}getGCPairs(){const t=[];return this.indexTree.traverse(n=>{n.getRemovedAt()&&t.push({parent:this,child:n});for(const s of n.getGCPairs())t.push(s)}),t}findPos(t,n=!0){const s=this.indexTree.findTreePos(t,n);return bt.fromTreePos(s)}pathToPosRange(t){const n=this.pathToIndex(t);return[this.findPos(n),this.findPos(n+1)]}pathToPos(t){const n=this.indexTree.pathToIndex(t);return this.findPos(n)}getRoot(){return this.indexTree.getRoot()}getSize(){return this.indexTree.size}getNodeSize(){return this.nodeMapByID.size()}getIndexTree(){return this.indexTree}toXML(){return uc(this.indexTree.getRoot())}toJSON(){return JSON.stringify(this.getRootTreeNode())}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TREE"}}toJSInfoForTest(){const t=this.indexTree.getRoot(),n=(s,i=void 0,o=void 0,a=0)=>{var p,b,S,B;let l,u,f;const d=s.isText?{node:s,offset:0}:i&&o?this.toTreePos(i,o):null;d&&(l=this.indexTree.indexOf(d),u=this.indexTree.treePosToPath(d),f=bt.fromTreePos(d).toStruct());const y={type:s.type,parent:i==null?void 0:i.id.toTestString(),size:s.size,id:s.id.toTestString(),removedAt:(p=s.removedAt)==null?void 0:p.toTestString(),insPrev:(b=s.insPrevID)==null?void 0:b.toTestString(),insNext:(S=s.insNextID)==null?void 0:S.toTestString(),value:s.isText?s.value:void 0,isRemoved:s.isRemoved,children:[],depth:a,attributes:s.attrs?us((B=s.attrs)==null?void 0:B.toObject()):void 0,index:l,path:u,pos:f};for(let D=0;D<s.allChildren.length;D++){const F=D===0?s:s.allChildren[D-1];y.children.push(n(s.allChildren[D],s,F,a+1))}return y};return n(t)}getRootTreeNode(){return Fa(this.indexTree.getRoot())}toTestTreeNode(){return Kf(this.indexTree.getRoot())}toSortedJSON(){return this.toJSON()}deepcopy(){const t=this.getRoot();return new pt(t.deepcopy(),this.getCreatedAt())}toPath(t,n){const s=this.toTreePos(t,n);return s?this.indexTree.treePosToPath(s):[]}toIndex(t,n){const s=this.toTreePos(t,n);return s?this.indexTree.indexOf(s):-1}indexToPath(t){return this.indexTree.indexToPath(t)}pathToIndex(t){return this.indexTree.pathToIndex(t)}indexRangeToPosRange(t){const n=this.findPos(t[0]);return t[0]===t[1]?[n,n]:[n,this.findPos(t[1])]}indexRangeToPosStructRange(t){const[n,s]=t,i=this.findPos(n);return n===s?[i.toStruct(),i.toStruct()]:[i.toStruct(),this.findPos(s).toStruct()]}posRangeToPathRange(t){const[n,s]=this.findNodesAndSplitText(t[0]),[i,o]=this.findNodesAndSplitText(t[1]);return[this.toPath(n,s),this.toPath(i,o)]}posRangeToIndexRange(t){const[n,s]=this.findNodesAndSplitText(t[0]),[i,o]=this.findNodesAndSplitText(t[1]);return[this.toIndex(n,s),this.toIndex(i,o)]}traverseInPosRange(t,n,s,i,o){const a=this.toIndex(t,n),l=this.toIndex(s,i);return this.indexTree.tokensBetween(a,l,o)}toTreePos(t,n){if(!t||!n)return;if(t.isRemoved){let i;for(;t.isRemoved;)i=t,t=i.parent;const o=t.findOffset(i);return{node:t,offset:o}}if(t===n)return{node:t,offset:0};let s=t.findOffset(n);if(!n.isRemoved){if(n.isText)return{node:n,offset:n.paddedSize};s++}return{node:t,offset:s}}makeDeletionChanges(t,n){const s=[],i=[];let o=null,a=null;for(let l=0;l<t.length;l++){const u=t[l],f=t[l+1];o||(o=u),a=u;const d=this.findRightToken(u);(!d||!f||d[0]!==f[0]||d[1]!==f[1])&&(i.push([o,a]),o=null,a=null)}for(const l of i){const[u,f]=l,[d,y]=this.findLeftToken(u),[p,b]=f,S=y===be.Start?d:d.parent,B=b===be.Start?p:p.parent,D=this.toIndex(S,d),F=this.toIndex(B,p);D<F&&(s.length>0&&D===s[s.length-1].to?(s[s.length-1].to=F,s[s.length-1].toPath=this.toPath(B,p)):s.push({type:"content",from:D,to:F,fromPath:this.toPath(S,d),toPath:this.toPath(B,p),actor:n.getActorID()}))}return s.reverse()}findRightToken([t,n]){if(n===be.Start){const l=t.allChildren;return l.length>0?[l[0],l[0].isText?be.Text:be.Start]:[t,be.End]}const s=t.parent,i=s.allChildren,o=i.indexOf(t);if(s&&o===i.length-1)return[s,be.End];const a=i[o+1];return[a,a.isText?be.Text:be.Start]}findLeftToken([t,n]){if(n===be.End){const l=t.allChildren;if(l.length>0){const u=l[l.length-1];return[u,u.isText?be.Text:be.End]}return[t,be.Start]}const s=t.parent,i=s.allChildren,o=i.indexOf(t);if(s&&o===0)return[s,be.Start];const a=i[o-1];return[a,a.isText?be.Text:be.End]}}class di extends xt{constructor(t,n,s,i,o,a,l){super(t,l);c(this,"fromPos");c(this,"toPos");c(this,"contents");c(this,"splitLevel");c(this,"maxCreatedAtMapByActor");this.fromPos=n,this.toPos=s,this.contents=i,this.splitLevel=o,this.maxCreatedAtMapByActor=a}static create(t,n,s,i,o,a,l){return new di(t,n,s,i,o,a,l)}execute(t,n,s){var f;const i=t.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof pt))throw new w(v.ErrInvalidArgument,"fail to execute, only Tree can execute edit");const o=this.getExecutedAt(),a=i,[l,u]=a.edit([this.fromPos,this.toPos],(f=this.contents)==null?void 0:f.map(d=>d.deepcopy()),this.splitLevel,o,(()=>{let d=o.getDelimiter();return this.contents!==void 0&&(d+=this.contents.length),()=>gt.of(o.getLamport(),++d,o.getActorID())})(),this.maxCreatedAtMapByActor,s);for(const d of u)t.registerGCPair(d);return{opInfos:l.map(({from:d,to:y,value:p,splitLevel:b,fromPath:S,toPath:B})=>({type:"tree-edit",path:t.createPath(this.getParentCreatedAt()),from:d,to:y,value:p,splitLevel:b,fromPath:S,toPath:B}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const t=this.getParentCreatedAt().toTestString(),n=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.fromPos.getLeftSiblingID().getOffset()}`,s=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.toPos.getLeftSiblingID().getOffset()}`,i=this.contents||[];return`${t}.EDIT(${n},${s},${i.map(o=>uc(o)).join("")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContents(){return this.contents}getSplitLevel(){return this.splitLevel}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}}class fs{constructor(e){c(this,"vector");this.vector=e||new Map}set(e,t){this.vector.set(e,t)}unset(e){this.vector.delete(e)}get(e){return this.vector.get(e)}maxLamport(){let e=BigInt(0);for(const[,t]of this)t>e&&(e=t);return e}max(e){const t=new Map;for(const[n,s]of e){const i=this.vector.get(n),o=i&&i>s?i:s;t.set(n,o)}for(const[n,s]of this){const i=e.get(n),o=i&&i>s?i:s;t.set(n,o)}return new fs(t)}afterOrEqual(e){const t=this.vector.get(e.getActorID());return t===void 0?!1:t>=e.getLamport()}deepcopy(){const e=new Map;for(const[t,n]of this.vector)e.set(t,n);return new fs(e)}filter(e){const t=new Map;for(const[n]of e){const s=this.vector.get(n);s!==void 0&&t.set(n,s)}return new fs(t)}size(){return this.vector.size}*[Symbol.iterator](){for(const[e,t]of this.vector)yield[e,t]}}const Ap=new fs(new Map);class en{constructor(e,t,n,s,i){c(this,"clientSeq");c(this,"serverSeq");c(this,"lamport");c(this,"actor");c(this,"versionVector");this.clientSeq=e,this.serverSeq=i,this.lamport=t,this.versionVector=s,this.actor=n}static of(e,t,n,s,i){return new en(e,t,n,s,i)}next(){const e=this.versionVector.deepcopy();return e.set(this.actor,this.lamport+1n),new en(this.clientSeq+1,this.lamport+1n,this.actor,e)}syncClocks(e){const t=e.lamport>this.lamport?e.lamport+1n:this.lamport+1n;let n=e.versionVector;n.size()===0&&(n=n.deepcopy(),n.set(e.actor,e.lamport));const s=this.versionVector.max(n),i=new en(this.clientSeq,t,this.actor,s);return i.versionVector.set(this.actor,t),i}setClocks(e,t){const n=e>this.lamport?e+1n:this.lamport+1n;t.unset(Eo);const s=this.versionVector.max(t);return s.set(this.actor,n),en.of(this.clientSeq,n,this.actor,s)}createTimeTicket(e){return gt.of(this.lamport,e,this.actor)}setActor(e){return new en(this.clientSeq,this.lamport,e,this.versionVector,this.serverSeq)}setVersionVector(e){return new en(this.clientSeq,this.lamport,this.actor,e,this.serverSeq)}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq?this.serverSeq.toString():""}getLamport(){return this.lamport}getLamportAsString(){return this.lamport.toString()}getActorID(){return this.actor}getVersionVector(){return this.versionVector}toTestString(){return`${this.lamport.toString()}:${this.actor.slice(-2)}:${this.clientSeq}`}}const Sp=new en(0,0n,Eo,Ap);class Ts{constructor({id:e,operations:t,presenceChange:n,message:s}){c(this,"id");c(this,"operations");c(this,"presenceChange");c(this,"message");this.id=e,this.operations=t||[],this.presenceChange=n,this.message=s}static create({id:e,operations:t,presenceChange:n,message:s}){return new Ts({id:e,operations:t,presenceChange:n,message:s})}getID(){return this.id}getMessage(){return this.message}hasOperations(){return this.operations.length>0}getOperations(){return this.operations}setActor(e){for(const t of this.operations)t.setActor(e);this.id=this.id.setActor(e)}hasPresenceChange(){return this.presenceChange!==void 0}getPresenceChange(){return this.presenceChange}execute(e,t,n){const s=[],i=[];for(const o of this.operations){const a=o.execute(e,n,this.id.getVersionVector());if(!a)continue;const{opInfos:l,reverseOp:u}=a;s.push(...l),u&&i.unshift(u)}return this.presenceChange&&(this.presenceChange.type===En.Put?t.set(this.id.getActorID(),vt(this.presenceChange.presence)):t.delete(this.id.getActorID())),{opInfos:s,reverseOps:i}}toTestString(){return`${this.operations.map(e=>e.toTestString()).join(",")}`}toStruct(){return{changeID:ve.bytesToHex(ve.toChangeID(this.getID()).toBinary()),message:this.getMessage(),operations:this.getOperations().map(e=>ve.bytesToHex(ve.toOperation(e).toBinary())),presenceChange:this.getPresenceChange()}}static fromStruct(e){const{changeID:t,operations:n,presenceChange:s,message:i}=e;return Ts.create({id:ve.bytesToChangeID(ve.hexToBytes(t)),operations:n==null?void 0:n.map(o=>ve.bytesToOperation(ve.hexToBytes(o))),presenceChange:s,message:i})}}class No{constructor(e,t,n,s,i,o,a){c(this,"documentKey");c(this,"checkpoint");c(this,"isRemoved");c(this,"changes");c(this,"snapshot");c(this,"minSyncedTicket");c(this,"versionVector");this.documentKey=e,this.checkpoint=t,this.isRemoved=n,this.changes=s,this.snapshot=o,this.minSyncedTicket=a,this.versionVector=i}static create(e,t,n,s,i,o,a){return new No(e,t,n,s,i,o,a)}getDocumentKey(){return this.documentKey}getCheckpoint(){return this.checkpoint}getIsRemoved(){return this.isRemoved}getChanges(){return this.changes}hasChanges(){return this.changes.length>0}getChangeSize(){return this.changes.length}hasSnapshot(){return!!this.snapshot&&!!this.snapshot.length}getSnapshot(){return this.snapshot}getMinSyncedTicket(){return this.minSyncedTicket}getVersionVector(){return this.versionVector}}class hs{constructor(e,t){c(this,"serverSeq");c(this,"clientSeq");this.serverSeq=e,this.clientSeq=t}static of(e,t){return new hs(e,t)}increaseClientSeq(e){return e===0?this:new hs(this.serverSeq,this.clientSeq+e)}forward(e){if(this.equals(e))return this;const t=this.serverSeq>e.serverSeq?this.serverSeq:e.serverSeq,n=Math.max(this.clientSeq,e.clientSeq);return hs.of(t,n)}getServerSeqAsString(){return this.serverSeq.toString()}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq}equals(e){return this.clientSeq===e.clientSeq&&this.serverSeq==e.serverSeq}toTestString(){return`serverSeq=${this.serverSeq}, clientSeq=${this.clientSeq}`}}const Ip=new hs(0n,0);class Ht{constructor(e,t){c(this,"createdAt");c(this,"offset");this.createdAt=e,this.offset=t}static of(e,t){return new Ht(e,t)}static fromStruct(e){return Ht.of(gt.fromStruct(e.createdAt),e.offset)}getCreatedAt(){return this.createdAt}getOffset(){return this.offset}equals(e){return this.createdAt.compare(e.createdAt)===0&&this.offset===e.offset}hasSameCreatedAt(e){return this.createdAt.compare(e.createdAt)===0}split(e){return new Ht(this.createdAt,this.offset+e)}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toTestString(){return`${this.createdAt.toTestString()}:${this.offset}`}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}}const xp=Ht.of(St,0);class It{constructor(e,t){c(this,"id");c(this,"relativeOffset");this.id=e,this.relativeOffset=t}static of(e,t){return new It(e,t)}static fromStruct(e){const t=Ht.fromStruct(e.id);return It.of(t,e.relativeOffset)}getID(){return this.id}getRelativeOffset(){return this.relativeOffset}getAbsoluteID(){return Ht.of(this.id.getCreatedAt(),this.id.getOffset()+this.relativeOffset)}toTestString(){return`${this.id.toTestString()}:${this.relativeOffset}`}toStruct(){return{id:this.id.toStruct(),relativeOffset:this.relativeOffset}}equals(e){return this.id.equals(e.id)?this.relativeOffset===e.relativeOffset:!1}}class In extends Rf{constructor(t,n,s){super(n);c(this,"id");c(this,"removedAt");c(this,"prev");c(this,"next");c(this,"insPrev");c(this,"insNext");this.id=t,this.removedAt=s}static create(t,n){return new In(t,n)}static createComparator(){return(t,n)=>{const s=t.getCreatedAt().compare(n.getCreatedAt());return s!==0?s:t.getOffset()>n.getOffset()?1:t.getOffset()<n.getOffset()?-1:0}}getID(){return this.id}getCreatedAt(){return this.id.getCreatedAt()}getLength(){return this.removedAt?0:this.getContentLength()}getContentLength(){return this.value&&this.value.length||0}getPrev(){return this.prev}getNext(){return this.next}getInsPrev(){return this.insPrev}getInsNext(){return this.insNext}getInsPrevID(){return this.insPrev.getID()}setPrev(t){this.prev=t,t&&(t.next=this)}setNext(t){this.next=t,t&&(t.prev=this)}setInsPrev(t){this.insPrev=t,t&&(t.insNext=this)}setInsNext(t){this.insNext=t,t&&(t.insPrev=this)}hasNext(){return!!this.next}hasInsPrev(){return!!this.insPrev}isRemoved(){return!!this.removedAt}getRemovedAt(){return this.removedAt}split(t){return new In(this.id.split(t),this.splitValue(t),this.removedAt)}canDelete(t,n,s){const i=!this.removedAt;return(n?!this.getCreatedAt().after(n):this.getCreatedAt().getLamport()<=s)&&(!this.removedAt||t.after(this.removedAt))?i:!1}canStyle(t,n,s){return(n?!this.getCreatedAt().after(n):this.getCreatedAt().getLamport()<=s)&&(!this.removedAt||t.after(this.removedAt))}remove(t){this.removedAt=t}createPosRange(){return[It.of(this.id,0),It.of(this.id,this.getLength())]}deepcopy(){return new In(this.id,this.value,this.removedAt)}toTestString(){return`${this.id.toTestString()} ${this.value?this.value:""}`}splitValue(t){const n=this.value;return this.value=n.substring(0,t),n.substring(t,n.length)}toIDString(){return this.id.toIDString()}}class As{constructor(){c(this,"head");c(this,"treeByIndex");c(this,"treeByID");this.head=In.create(xp),this.treeByIndex=new ri,this.treeByID=new Vf(In.createComparator()),this.treeByIndex.insert(this.head),this.treeByID.put(this.head.getID(),this.head)}static create(){return new As}edit(e,t,n,s,i){const[o,a]=this.findNodeWithSplit(e[1],t),[l,u]=this.findNodeWithSplit(e[0],t),f=this.findBetween(u,a),[d,y,p]=this.deleteNodes(f,t,s,i),b=a?a.getID():o.getID();let S=It.of(b,0);if(n){const D=this.posToIndex(l.createPosRange()[1],!0),F=this.insertAfter(l,In.create(Ht.of(t,0),n));d.length&&d[d.length-1].from===D?d[d.length-1].value=n:d.push({actor:t.getActorID(),from:D,to:D,value:n}),S=It.of(F.getID(),F.getContentLength())}const B=[];for(const[,D]of p)B.push({parent:this,child:D});return[S,y,B,d]}indexToPos(e){const[t,n]=this.treeByIndex.find(e),s=t;return It.of(s.getID(),n)}findIndexesFromRange(e){const[t,n]=e;return[this.posToIndex(t,!1),this.posToIndex(n,!0)]}posToIndex(e,t){const n=e.getAbsoluteID(),s=t?this.findFloorNodePreferToLeft(n):this.findFloorNode(n);if(!s)throw new w(v.ErrInvalidArgument,`the node of the given id should be found: ${n.toTestString()}`);const i=this.treeByIndex.indexOf(s),o=s.isRemoved()?0:n.getOffset()-s.getID().getOffset();return i+o}findNode(e){return this.findFloorNode(e)}get length(){return this.treeByIndex.length}getTreeByIndex(){return this.treeByIndex}getTreeByID(){return this.treeByID}toString(){const e=[];for(const t of this)t.isRemoved()||e.push(t.getValue());return e.join("")}*[Symbol.iterator](){let e=this.head.getNext();for(;e;)yield e,e=e.getNext()}getHead(){return this.head}deepcopy(){const e=new As;let t=this.head.getNext(),n=e.head,s;for(;t;){if(s=e.insertAfter(n,t.deepcopy()),t.hasInsPrev()){const i=e.findNode(t.getInsPrevID());s.setInsPrev(i)}n=s,t=t.getNext()}return e}toTestString(){const e=[];let t=this.head;for(;t;)t.isRemoved()?e.push(`{${t.toTestString()}}`):e.push(`[${t.toTestString()}]`),t=t.getNext();return e.join("")}insertAfter(e,t){const n=e.getNext();return t.setPrev(e),n&&n.setPrev(t),this.treeByID.put(t.getID(),t),this.treeByIndex.insertAfter(e,t),t}findNodeWithSplit(e,t){const n=e.getAbsoluteID();let s=this.findFloorNodePreferToLeft(n);const i=n.getOffset()-s.getID().getOffset();for(this.splitNode(s,i);s.hasNext()&&s.getNext().getCreatedAt().after(t);)s=s.getNext();return[s,s.getNext()]}findFloorNodePreferToLeft(e){let t=this.findFloorNode(e);if(!t)throw new w(v.ErrInvalidArgument,`the node of the given id should be found: ${e.toTestString()}`);if(e.getOffset()>0&&t.getID().getOffset()==e.getOffset()){if(!t.hasInsPrev())return t;t=t.getInsPrev()}return t}findFloorNode(e){const t=this.treeByID.floorEntry(e);if(t&&!(!t.key.equals(e)&&!t.key.hasSameCreatedAt(e)))return t.value}findBetween(e,t){const n=[];let s=e;for(;s&&s!==t;)n.push(s),s=s.getNext();return n}splitNode(e,t){if(t>e.getContentLength())throw new w(v.ErrInvalidArgument,"offset should be less than or equal to length");if(t===0)return e;if(t===e.getContentLength())return e.getNext();const n=e.split(t);this.treeByIndex.updateWeight(n),this.insertAfter(e,n);const s=e.getInsNext();return s&&s.setInsPrev(n),n.setInsPrev(e),n}deleteNodes(e,t,n,s){if(!e.length)return[[],new Map,new Map];const[i,o]=this.filterNodes(e,t,n,s),a=new Map,l=new Map,u=this.makeChanges(o,t);for(const f of i){const d=f.getCreatedAt().getActorID();(!a.has(d)||f.getID().getCreatedAt().after(a.get(d)))&&a.set(d,f.getID().getCreatedAt()),l.set(f.getID().toIDString(),f),f.remove(t)}return this.deleteIndexNodes(o),[u,a,l]}filterNodes(e,t,n,s){const i=[],o=[],[a,l]=this.findEdgesOfCandidates(e);o.push(a);for(const u of e){const f=u.getCreatedAt().getActorID();let d,y=0n;s===void 0&&n===void 0?y=Vs:s.size()>0?y=s.get(f)?s.get(f):0n:d=n.has(f)?n.get(f):St,u.canDelete(t,d,y)?i.push(u):o.push(u)}return o.push(l),[i,o]}findEdgesOfCandidates(e){return[e[0].getPrev(),e[e.length-1].getNext()]}makeChanges(e,t){const n=[];let s,i;for(let o=0;o<e.length-1;o++){const a=e[o],l=e[o+1];a.getNext()!=l&&([s]=this.findIndexesFromRange(a.getNext().createPosRange()),l?[,i]=this.findIndexesFromRange(l.getPrev().createPosRange()):i=this.treeByIndex.length,s<i&&n.push({actor:t.getActorID(),from:s,to:i}))}return n.reverse()}deleteIndexNodes(e){for(let t=0;t<e.length-1;t++){const n=e[t],s=e[t+1];n.getNext()!=s&&this.treeByIndex.deleteRange(n,s)}}purge(e){this.treeByIndex.delete(e),this.treeByID.remove(e.getID());const t=e.getPrev(),n=e.getNext(),s=e.getInsPrev(),i=e.getInsNext();t&&t.setNext(n),n&&n.setPrev(t),e.setPrev(void 0),e.setNext(void 0),s&&s.setInsNext(i),i&&i.setInsPrev(s),e.setInsPrev(void 0),e.setInsNext(void 0)}}const Hl=r=>r<0?Math.ceil(r):Math.floor(r);var _t=(r=>(r[r.IntegerCnt=0]="IntegerCnt",r[r.LongCnt=1]="LongCnt",r))(_t||{});class Ze extends li{constructor(t,n,s){super(s);c(this,"valueType");c(this,"value");switch(this.valueType=t,t){case 0:typeof n=="number"?n>Math.pow(2,31)-1||n<-Math.pow(2,31)?this.value=Q.fromNumber(n).toInt():this.value=Hl(n):this.value=n.toInt();break;case 1:typeof n=="number"?this.value=Q.fromNumber(n):this.value=n;break;default:throw new w(v.ErrUnimplemented,`unimplemented type: ${t}`)}}static create(t,n,s){return new Ze(t,n,s)}static valueFromBytes(t,n){switch(t){case 0:return n[0]|n[1]<<8|n[2]<<16|n[3]<<24;case 1:return Q.fromBytesLE(Array.from(n));default:throw new w(v.ErrUnimplemented,`unimplemented type: ${t}`)}}toJSON(){return`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_COUNTER"}}deepcopy(){const t=Ze.create(this.valueType,this.value,this.getCreatedAt());return t.setMovedAt(this.getMovedAt()),t}getType(){return this.valueType}static getCounterType(t){switch(typeof t){case"object":return t instanceof Q?1:void 0;case"number":return t>Math.pow(2,31)-1||t<-Math.pow(2,31)?1:0;default:return}}static isSupport(t){return!!Ze.getCounterType(t)}static isInteger(t){return t%1===0}isNumericType(){const t=this.valueType;return t===0||t===1}getValueType(){return this.valueType}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:{const t=this.value;return new Uint8Array([t&255,t>>8&255,t>>16&255,t>>24&255])}case 1:{const n=this.value.toBytesLE();return Uint8Array.from(n)}default:throw new w(v.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}increase(t){function n(s){if(!s.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof s.getValue()}`)}return n(this),n(t),this.valueType===1?this.value=this.value.add(t.getValue()):t.getType()===Ae.Long?this.value=this.value+t.getValue().toInt():this.value=Q.fromNumber(this.value+Hl(t.getValue())).toInt(),this}}class Ss extends xt{constructor(t,n,s){super(t,s);c(this,"value");this.value=n}static create(t,n,s){return new Ss(t,n,s)}execute(t){const n=t.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof Ze))throw new w(v.ErrInvalidArgument,"fail to execute, only Counter can execute increase");const s=n,i=this.value.deepcopy();return s.increase(i),{opInfos:[{type:"increase",path:t.createPath(this.getParentCreatedAt()),value:i.getValue()}],reverseOp:this.toReverseOperation()}}toReverseOperation(){const t=this.value.deepcopy(),s=t.getType()===Ae.Long?t.getValue().multiply(-1):t.getValue()*-1;return Ss.create(this.getParentCreatedAt(),ye.of(s,t.getCreatedAt()))}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.INCREASE.${this.value.toJSON()}`}getValue(){return this.value}}class ln extends xt{constructor(t,n,s,i,o,a,l){super(t,l);c(this,"fromPos");c(this,"toPos");c(this,"maxCreatedAtMapByActor");c(this,"attributes");c(this,"attributesToRemove");this.fromPos=n,this.toPos=s,this.maxCreatedAtMapByActor=i,this.attributes=o,this.attributesToRemove=a}static create(t,n,s,i,o,a){return new ln(t,n,s,i,o,[],a)}static createTreeRemoveStyleOperation(t,n,s,i,o,a){return new ln(t,n,s,i,new Map,o,a)}execute(t,n,s){const i=t.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new w(v.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof pt))throw new w(v.ErrInvalidArgument,"fail to execute, only Tree can execute edit");const o=i;let a,l;if(this.attributes.size){const u={};[...this.attributes].forEach(([f,d])=>u[f]=d),[,l,a]=o.style([this.fromPos,this.toPos],u,this.getExecutedAt(),this.maxCreatedAtMapByActor,s)}else{const u=this.attributesToRemove;[,l,a]=o.removeStyle([this.fromPos,this.toPos],u,this.getExecutedAt(),this.maxCreatedAtMapByActor,s)}for(const u of l)t.registerGCPair(u);return{opInfos:a.map(({from:u,to:f,value:d,fromPath:y,toPath:p})=>({type:"tree-style",from:u,to:f,value:this.attributes.size?{attributes:d}:{attributesToRemove:d},fromPath:y,toPath:p,path:t.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const t=this.getParentCreatedAt().toTestString(),n=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.fromPos.getLeftSiblingID().getOffset()}`,s=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.toPos.getLeftSiblingID().getOffset()}`;return`${t}.STYLE(${n},${s},${Object.entries(this.attributes||{}).map(([i,o])=>`${i}:"${o}"`).join(" ")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getAttributesToRemove(){return this.attributesToRemove}getMaxCreatedAtMapByActor(){return this.maxCreatedAtMapByActor}}function kp(r){const e=new ac,t=e.data;for(const[n,s]of Object.entries(r))t[n]=JSON.stringify(s);return e}function Ep(r){if(r.type===En.Put)return new ei({type:_n.PUT,presence:kp(r.presence)});if(r.type===En.Clear)return new ei({type:_n.CLEAR});throw new w(v.ErrUnimplemented,"unimplemented type")}function Cp(r){return new Of({serverSeq:r.getServerSeq(),clientSeq:r.getClientSeq()})}function zf(r){return new xo({clientSeq:r.getClientSeq(),lamport:r.getLamport(),actorId:Tc(r.getActorID()),versionVector:fc(r.getVersionVector())})}function $(r){if(r)return new M({lamport:r.getLamport(),delimiter:r.getDelimiter(),actorId:Tc(r.getActorID())})}function fc(r){if(!r)return;const e=new ko;for(const[t,n]of r)e.vector[t]=BigInt(n.toString());return e}function jf(r){switch(r){case Ae.Null:return _.NULL;case Ae.Boolean:return _.BOOLEAN;case Ae.Integer:return _.INTEGER;case Ae.Long:return _.LONG;case Ae.Double:return _.DOUBLE;case Ae.String:return _.STRING;case Ae.Bytes:return _.BYTES;case Ae.Date:return _.DATE;default:throw new w(v.ErrInvalidType,`unsupported type: ${r}`)}}function Hf(r){switch(r){case _t.IntegerCnt:return _.INTEGER_CNT;case _t.LongCnt:return _.LONG_CNT;default:throw new w(v.ErrInvalidType,`unsupported type: ${r}`)}}function Go(r){if(r instanceof Ve)return new tt({type:_.JSON_OBJECT,createdAt:$(r.getCreatedAt()),value:ih(r)});if(r instanceof Xe)return new tt({type:_.JSON_ARRAY,createdAt:$(r.getCreatedAt()),value:iy(r)});if(r instanceof mt)return new tt({type:_.TEXT,createdAt:$(r.getCreatedAt())});if(r instanceof ye)return new tt({type:jf(r.getType()),createdAt:$(r.getCreatedAt()),value:r.toBytes()});if(r instanceof Ze)return new tt({type:Hf(r.getType()),createdAt:$(r.getCreatedAt()),value:r.toBytes()});if(r instanceof pt)return new tt({type:_.TREE,createdAt:$(r.getCreatedAt()),value:ay(r)});throw new w(v.ErrUnimplemented,"unimplemented element")}function Np(r){return new Zs({createdAt:$(r.getCreatedAt()),offset:r.getOffset()})}function Ai(r){return new un({createdAt:$(r.getID().getCreatedAt()),offset:r.getID().getOffset(),relativeOffset:r.getRelativeOffset()})}function Si(r){return new Wn({parentId:Ks(r.getParentID()),leftSiblingId:Ks(r.getLeftSiblingID())})}function Ks(r){return new An({createdAt:$(r.getCreatedAt()),offset:r.getOffset()})}function Wf(r){const e=new oc;if(r instanceof Gn){const t=r,n=new ji;n.parentCreatedAt=$(t.getParentCreatedAt()),n.key=t.getKey(),n.value=Go(t.getValue()),n.executedAt=$(t.getExecutedAt()),e.body.case="set",e.body.value=n}else if(r instanceof ui){const t=r,n=new Hi;n.parentCreatedAt=$(t.getParentCreatedAt()),n.prevCreatedAt=$(t.getPrevCreatedAt()),n.value=Go(t.getValue()),n.executedAt=$(t.getExecutedAt()),e.body.case="add",e.body.value=n}else if(r instanceof Tn){const t=r,n=new Wi;n.parentCreatedAt=$(t.getParentCreatedAt()),n.prevCreatedAt=$(t.getPrevCreatedAt()),n.createdAt=$(t.getCreatedAt()),n.executedAt=$(t.getExecutedAt()),e.body.case="move",e.body.value=n}else if(r instanceof Cn){const t=r,n=new _i;n.parentCreatedAt=$(t.getParentCreatedAt()),n.createdAt=$(t.getCreatedAt()),n.executedAt=$(t.getExecutedAt()),e.body.case="remove",e.body.value=n}else if(r instanceof fi){const t=r,n=new Gi;n.parentCreatedAt=$(t.getParentCreatedAt()),n.from=Ai(t.getFromPos()),n.to=Ai(t.getToPos());const s=n.createdAtMapByActor;for(const[o,a]of t.getMaxCreatedAtMapByActor())s[o]=$(a);n.content=t.getContent();const i=n.attributes;for(const[o,a]of t.getAttributes())i[o]=a;n.executedAt=$(t.getExecutedAt()),e.body.case="edit",e.body.value=n}else if(r instanceof hi){const t=r,n=new Yi;n.parentCreatedAt=$(t.getParentCreatedAt()),n.from=Ai(t.getFromPos()),n.to=Ai(t.getToPos());const s=n.createdAtMapByActor;for(const[o,a]of t.getMaxCreatedAtMapByActor())s[o]=$(a);const i=n.attributes;for(const[o,a]of t.getAttributes())i[o]=a;n.executedAt=$(t.getExecutedAt()),e.body.case="style",e.body.value=n}else if(r instanceof Ss){const t=r,n=new Xi;n.parentCreatedAt=$(t.getParentCreatedAt()),n.value=Go(t.getValue()),n.executedAt=$(t.getExecutedAt()),e.body.case="increase",e.body.value=n}else if(r instanceof di){const t=r,n=new Zi,s=n.createdAtMapByActor;for(const[i,o]of t.getMaxCreatedAtMapByActor())s[i]=$(o);n.parentCreatedAt=$(t.getParentCreatedAt()),n.from=Si(t.getFromPos()),n.to=Si(t.getToPos()),n.contents=Jp(t.getContents()),n.splitLevel=t.getSplitLevel(),n.executedAt=$(t.getExecutedAt()),e.body.case="treeEdit",e.body.value=n}else if(r instanceof ln){const t=r,n=new Qi;n.parentCreatedAt=$(t.getParentCreatedAt()),n.from=Si(t.getFromPos()),n.to=Si(t.getToPos());const s=n.createdAtMapByActor;for(const[o,a]of t.getMaxCreatedAtMapByActor())s[o]=$(a);const i=t.getAttributesToRemove();if(i.length>0)n.attributesToRemove=i;else{const o=n.attributes;for(const[a,l]of t.getAttributes())o[a]=l}n.executedAt=$(t.getExecutedAt()),e.body.case="treeStyle",e.body.value=n}else throw new w(v.ErrUnimplemented,"unimplemented operation");return e}function Pp(r){const e=[];for(const t of r)e.push(Wf(t));return e}function Op(r){const e=new Nf({id:zf(r.getID()),message:r.getMessage()});return r.hasOperations()&&(e.operations=Pp(r.getOperations())),r.hasPresenceChange()&&(e.presenceChange=Ep(r.getPresenceChange())),e}function Dp(r){const e=[];for(const t of r)e.push(Op(t));return e}function Bp(r){const e=[];for(const t of r)e.push(new Pf({key:t.getStrKey(),element:dc(t.getValue())}));return e}function Rp(r){const e=[];for(const t of r)e.push(new oo({element:dc(t.getValue())}));return e}function Lp(r){const e=[];for(const t of r){const n=new ao;n.id=Np(t.getID()),n.value=t.getValue().getContent(),n.removedAt=$(t.getRemovedAt());const s=n.attributes,i=t.getValue().getAttrs();for(const o of i){const a=new vs;a.value=o.getValue(),a.updatedAt=$(o.getUpdatedAt()),s[o.getKey()]=a}e.push(n)}return e}function Jp(r){const e=[];if(!r||!r.length)return e;for(const t of r)e.push(new co({content:hc(t)}));return e}function Mp(r){const e={};for(const t of r)e[t.getKey()]=new vs({value:t.getValue(),updatedAt:$(t.getUpdatedAt()),isRemoved:t.isRemoved()});return e}function hc(r){if(!r)return[];const e=[];return Co(r,(t,n)=>{const s=new Qs({id:Ks(t.id),type:t.type,removedAt:$(t.removedAt),depth:n});t.isText&&(s.value=t.value),t.insPrevID&&(s.insPrevId=Ks(t.insPrevID)),t.insNextID&&(s.insNextId=Ks(t.insNextID)),t.attrs&&(s.attributes=Mp(t.attrs)),e.push(s)}),e}function Fp(r){const e=new Ke;return e.body.case="jsonObject",e.body.value=new eo({nodes:Bp(r.getRHT()),createdAt:$(r.getCreatedAt()),movedAt:$(r.getMovedAt()),removedAt:$(r.getRemovedAt())}),e}function _f(r){const e=new Ke;return e.body.case="jsonArray",e.body.value=new to({nodes:Rp(r.getElements()),createdAt:$(r.getCreatedAt()),movedAt:$(r.getMovedAt()),removedAt:$(r.getRemovedAt())}),e}function $p(r){const e=new Ke;return e.body.case="primitive",e.body.value=new ro({type:jf(r.getType()),value:r.toBytes(),createdAt:$(r.getCreatedAt()),movedAt:$(r.getMovedAt()),removedAt:$(r.getRemovedAt())}),e}function Up(r){const e=new Ke;return e.body.case="text",e.body.value=new no({nodes:Lp(r.getRGATreeSplit()),createdAt:$(r.getCreatedAt()),movedAt:$(r.getMovedAt()),removedAt:$(r.getRemovedAt())}),e}function qp(r){const e=new Ke;return e.body.case="counter",e.body.value=new so({type:Hf(r.getType()),value:r.toBytes(),createdAt:$(r.getCreatedAt()),movedAt:$(r.getMovedAt()),removedAt:$(r.getRemovedAt())}),e}function Gf(r){const e=new Ke;return e.body.case="tree",e.body.value=new io({nodes:hc(r.getRoot()),createdAt:$(r.getCreatedAt()),movedAt:$(r.getMovedAt()),removedAt:$(r.getRemovedAt())}),e}function dc(r){if(r instanceof Ve)return Fp(r);if(r instanceof Xe)return _f(r);if(r instanceof ye)return $p(r);if(r instanceof mt)return Up(r);if(r instanceof Ze)return qp(r);if(r instanceof pt)return Gf(r);throw new w(v.ErrUnimplemented,"unimplemented element")}function Vp(r){return new dn({documentKey:r.getDocumentKey(),checkpoint:Cp(r.getCheckpoint()),isRemoved:r.getIsRemoved(),changes:Dp(r.getChanges()),snapshot:r.getSnapshot(),versionVector:fc(r.getVersionVector()),minSyncedTicket:$(r.getMinSyncedTicket())})}function Bs(r){if(!(r instanceof ne))return{};const e=r.findDetails(ip);for(const t of e)return t.metadata;return{}}function mn(r){return Bs(r).code??""}function Yf(r){return en.of(r.clientSeq,BigInt(r.lamport),wc(r.actorId),gc(r.versionVector),BigInt(r.serverSeq))}function gc(r){if(!r)return;const e=new fs;return Object.entries(r.vector).forEach(([t,n])=>{e.set(t,BigInt(n.toString()))}),e}function U(r){if(r)return gt.of(BigInt(r.lamport),r.delimiter,wc(r.actorId))}function mc(r){const e={};return Object.entries(r.data).forEach(([t,n])=>{e[t]=JSON.parse(n)}),e}function Kp(r){const e=r.type;if(e===_n.PUT){const t=mc(r.presence);return{type:En.Put,presence:t}}if(e===_n.CLEAR)return{type:En.Clear};throw new w(v.ErrInvalidType,`unsupported type: ${e}`)}function zp(r){const e=new Map;return Object.entries(r).forEach(([t,n])=>{e.set(t,mc(n))}),e}function Xf(r){switch(r){case _.NULL:return Ae.Null;case _.BOOLEAN:return Ae.Boolean;case _.INTEGER:return Ae.Integer;case _.LONG:return Ae.Long;case _.DOUBLE:return Ae.Double;case _.STRING:return Ae.String;case _.BYTES:return Ae.Bytes;case _.DATE:return Ae.Date}throw new w(v.ErrUnimplemented,`unimplemented value type: ${r}`)}function fo(r){switch(r){case _.INTEGER_CNT:return _t.IntegerCnt;case _.LONG_CNT:return _t.LongCnt}throw new w(v.ErrUnimplemented,`unimplemented value type: ${r}`)}function Yo(r){switch(r.type){case _.JSON_OBJECT:return r.value?sh(r.value):Ve.create(U(r.createdAt));case _.JSON_ARRAY:return r.value?sy(r.value):Xe.create(U(r.createdAt));case _.TEXT:return mt.create(As.create(),U(r.createdAt));case _.TREE:return oy(r.value);case _.NULL:case _.BOOLEAN:case _.INTEGER:case _.LONG:case _.DOUBLE:case _.STRING:case _.BYTES:case _.DATE:return ye.of(ye.valueFromBytes(Xf(r.type),r.value),U(r.createdAt));case _.INTEGER_CNT:case _.LONG_CNT:return Ze.create(fo(r.type),Ze.valueFromBytes(fo(r.type),r.value),U(r.createdAt))}}function Ii(r){return It.of(Ht.of(U(r.createdAt),r.offset),r.relativeOffset)}function Zf(r){return Ht.of(U(r.createdAt),r.offset)}function jp(r){const e=si.create(r.value);Object.entries(r.attributes).forEach(([n,s])=>{e.setAttr(n,s.value,U(s.updatedAt))});const t=In.create(Zf(r.id),e);return t.remove(U(r.removedAt)),t}function Qn(r){return bt.of(zs(r.parentId),zs(r.leftSiblingId))}function zs(r){return ke.of(U(r.createdAt),r.offset)}function Hp(r){if(!r.length)return;const e=[];return r.forEach(t=>{const n=pc(t.content);e.push(n)}),e}function pc(r){if(r.length===0)return;const e=[];for(const s of r)e.push(_p(s));const t=e[e.length-1],n=new Map;n.set(r[e.length-1].depth,e[e.length-1]);for(let s=e.length-2;s>=0;s--)n.get(r[s].depth-1).prepend(e[s]),n.set(r[s].depth,e[s]);return t.updateDescendantsSize(),pt.create(t,St).getRoot()}function Wp(r){const e=fn.create();for(const[t,n]of Object.entries(r))e.setInternal(t,n.value,U(n.updatedAt),n.isRemoved);return e}function _p(r){const e=zs(r.id),t=Ye.create(e,r.type),n=Object.entries(r.attributes);return t.isText?t.value=r.value:n.length&&(t.attrs=Wp(r.attributes)),r.insPrevId&&(t.insPrevID=zs(r.insPrevId)),r.insNextId&&(t.insNextID=zs(r.insNextId)),t.removedAt=U(r.removedAt),t}function Qf(r){if(r.body.case==="set"){const e=r.body.value;return Gn.create(e.key,Yo(e.value),U(e.parentCreatedAt),U(e.executedAt))}else if(r.body.case==="add"){const e=r.body.value;return ui.create(U(e.parentCreatedAt),U(e.prevCreatedAt),Yo(e.value),U(e.executedAt))}else if(r.body.case==="move"){const e=r.body.value;return Tn.create(U(e.parentCreatedAt),U(e.prevCreatedAt),U(e.createdAt),U(e.executedAt))}else if(r.body.case==="remove"){const e=r.body.value;return Cn.create(U(e.parentCreatedAt),U(e.createdAt),U(e.executedAt))}else if(r.body.case==="edit"){const e=r.body.value,t=new Map;Object.entries(e.createdAtMapByActor).forEach(([s,i])=>{t.set(s,U(i))});const n=new Map;return Object.entries(e.attributes).forEach(([s,i])=>{n.set(s,i)}),fi.create(U(e.parentCreatedAt),Ii(e.from),Ii(e.to),t,e.content,n,U(e.executedAt))}else if(r.body.case==="style"){const e=r.body.value,t=new Map;Object.entries(e.createdAtMapByActor).forEach(([s,i])=>{t.set(s,U(i))});const n=new Map;return Object.entries(e.attributes).forEach(([s,i])=>{n.set(s,i)}),hi.create(U(e.parentCreatedAt),Ii(e.from),Ii(e.to),t,n,U(e.executedAt))}else{if(r.body.case==="select")return;if(r.body.case==="increase"){const e=r.body.value;return Ss.create(U(e.parentCreatedAt),Yo(e.value),U(e.executedAt))}else if(r.body.case==="treeEdit"){const e=r.body.value,t=new Map;return Object.entries(e.createdAtMapByActor).forEach(([n,s])=>{t.set(n,U(s))}),di.create(U(e.parentCreatedAt),Qn(e.from),Qn(e.to),Hp(e.contents),e.splitLevel,t,U(e.executedAt))}else if(r.body.case==="treeStyle"){const e=r.body.value,t=new Map,n=e.attributesToRemove,s=new Map;return e!=null&&e.createdAtMapByActor&&Object.entries(e.createdAtMapByActor).forEach(([i,o])=>{s.set(i,U(o))}),(n==null?void 0:n.length)>0?ln.createTreeRemoveStyleOperation(U(e.parentCreatedAt),Qn(e.from),Qn(e.to),s,n,U(e.executedAt)):(Object.entries(e.attributes).forEach(([i,o])=>{t.set(i,o)}),ln.create(U(e.parentCreatedAt),Qn(e.from),Qn(e.to),s,t,U(e.executedAt)))}else throw new w(v.ErrUnimplemented,"unimplemented operation")}}function Gp(r){const e=[];for(const t of r){const n=Qf(t);n&&e.push(n)}return e}function eh(r){const e=[];for(const t of r)e.push(Ts.create({id:Yf(t.id),operations:Gp(t.operations),presenceChange:t.presenceChange?Kp(t.presenceChange):void 0,message:t.message}));return e}function Yp(r){return hs.of(BigInt(r.serverSeq),r.clientSeq)}function Xp(r){return No.create(r.documentKey,Yp(r.checkpoint),r.isRemoved,eh(r.changes),gc(r.versionVector),r.snapshot,U(r.minSyncedTicket))}function th(r){const e=new ti;for(const n of r.nodes){const s=yc(n.element);e.set(n.key,s,s.getPositionedAt())}const t=new Ve(U(r.createdAt),e);return t.setMovedAt(U(r.movedAt)),t.setRemovedAt(U(r.removedAt)),t}function rh(r){const e=new ni;for(const n of r.nodes)e.insert(yc(n.element));const t=new Xe(U(r.createdAt),e);return t.setMovedAt(U(r.movedAt)),t.setRemovedAt(U(r.removedAt)),t}function Zp(r){const e=ye.of(ye.valueFromBytes(Xf(r.type),r.value),U(r.createdAt));return e.setMovedAt(U(r.movedAt)),e.setRemovedAt(U(r.removedAt)),e}function Qp(r){const e=new As;let t=e.getHead();for(const s of r.nodes){const i=e.insertAfter(t,jp(s));s.insPrevId&&i.setInsPrev(e.findNode(Zf(s.insPrevId))),t=i}const n=new mt(e,U(r.createdAt));return n.setMovedAt(U(r.movedAt)),n.setRemovedAt(U(r.removedAt)),n}function ey(r){const e=Ze.create(fo(r.type),Ze.valueFromBytes(fo(r.type),r.value),U(r.createdAt));return e.setMovedAt(U(r.movedAt)),e.setRemovedAt(U(r.removedAt)),e}function nh(r){const e=pc(r.nodes);return pt.create(e,U(r.createdAt))}function yc(r){if(r.body.case==="jsonObject")return th(r.body.value);if(r.body.case==="jsonArray")return rh(r.body.value);if(r.body.case==="primitive")return Zp(r.body.value);if(r.body.case==="text")return Qp(r.body.value);if(r.body.case==="counter")return ey(r.body.value);if(r.body.case==="tree")return nh(r.body.value);throw new w(v.ErrUnimplemented,"unimplemented element")}function ty(r){if(!r)return{root:Ve.create(St),presences:new Map};const e=da.fromBinary(r);return{root:yc(e.root),presences:zp(e.presences)}}function ry(r){const e=fc(r);return vc(e.toBinary())}function ny(r){const e=bc(r),t=ko.fromBinary(e);return gc(t)}function sh(r){if(!r)throw new w(v.ErrInvalidArgument,"bytes is empty");const e=Ke.fromBinary(r);return th(e.body.value)}function ih(r){return dc(r).toBinary()}function sy(r){if(!r)throw new w(v.ErrInvalidArgument,"bytes is empty");const e=Ke.fromBinary(r);return rh(e.body.value)}function iy(r){return _f(r).toBinary()}function oy(r){if(!r)throw new w(v.ErrInvalidArgument,"bytes is empty");const e=Ke.fromBinary(r);return nh(e.body.value)}function ay(r){return Gf(r).toBinary()}function vc(r){return r?Array.from(r).map(e=>e.toString(16).padStart(2,"0")).join(""):""}function wc(r){return vc(r)}function bc(r){return new Uint8Array(r.match(/.{1,2}/g).map(e=>parseInt(e,16)))}function Tc(r){return bc(r)}function cy(r){const e=xo.fromBinary(r);return Yf(e)}function ly(r){const e=oc.fromBinary(r);return Qf(e)}const ve={fromPresence:mc,toChangePack:Vp,fromChangePack:Xp,fromChanges:eh,toTreeNodes:hc,fromTreeNodes:pc,objectToBytes:ih,bytesToObject:sh,bytesToSnapshot:ty,bytesToHex:vc,hexToBytes:bc,toHexString:wc,toUint8Array:Tc,toOperation:Wf,toChangeID:zf,PbChangeID:xo,bytesToChangeID:cy,bytesToOperation:ly,versionVectorToHex:ry,hexToVersionVector:ny};var Ue=(r=>(r[r.Trivial=0]="Trivial",r[r.Debug=1]="Debug",r[r.Info=2]="Info",r[r.Warn=3]="Warn",r[r.Error=4]="Error",r[r.Fatal=5]="Fatal",r))(Ue||{});let Fn=3;function uy(r){Fn=r}const K={trivial:(...r)=>{Fn>0||typeof console<"u"&&console.log("YORKIE T:",...r)},debug:(...r)=>{Fn>1||typeof console<"u"&&console.log("YORKIE D:",...r)},info:(...r)=>{Fn>2||typeof console<"u"&&console.log("YORKIE I:",...r)},warn:(...r)=>{Fn>3||typeof console<"u"&&(typeof console.warn<"u"?console.warn("YORKIE W:",...r):console.log("YORKIE W:",...r))},error:(...r)=>{Fn>4||typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE E:",...r):console.log("YORKIE E:",...r))},fatal:(...r)=>{typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE F:",...r):console.log("YORKIE F:",...r))},isEnabled:r=>Fn<=r};function oh(){return"xxxxxxxx-xxxx-4xxxy-xxxx-xxxxxxxxxxx".replace(/[xy]/g,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}class fy{constructor(e,t,n,s,i){c(this,"reconnectStreamDelay");c(this,"doc");c(this,"docID");c(this,"syncMode");c(this,"remoteChangeEventReceived");c(this,"watchStream");c(this,"watchLoopTimerID");c(this,"watchAbortController");c(this,"unsubscribeBroadcastEvent");this.reconnectStreamDelay=e,this.doc=t,this.docID=n,this.syncMode=s,this.remoteChangeEventReceived=!1,this.unsubscribeBroadcastEvent=i}changeSyncMode(e){this.syncMode=e}needRealtimeSync(){return this.syncMode===Ji.RealtimeSyncOff?!1:this.syncMode===Ji.RealtimePushOnly?this.doc.hasLocalChanges():this.syncMode!==Ji.Manual&&(this.doc.hasLocalChanges()||this.remoteChangeEventReceived)}async runWatchLoop(e){const t=async()=>{if(this.watchStream)return Promise.resolve();this.watchLoopTimerID&&(clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0);try{[this.watchStream,this.watchAbortController]=await e(()=>{this.watchStream=void 0,this.watchAbortController=void 0,this.watchLoopTimerID=setTimeout(t,this.reconnectStreamDelay)})}catch{}};await t()}cancelWatchStream(){this.watchStream&&this.watchAbortController&&(this.watchAbortController.abort(),this.watchStream=void 0,this.watchAbortController=void 0),clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0}}const Xo=()=>{};class hy{constructor(e){c(this,"finalized",!1);c(this,"observers",[]);c(this,"finalError");try{e(this)}catch(t){this.error(t)}}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(!e)throw new w(v.ErrInvalidArgument,"missing observer");if(this.finalized)throw new w(v.ErrRefused,"observable is finalized due to previous error");typeof e=="object"?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=Xo),s.error===void 0&&(s.error=Xo),s.complete===void 0&&(s.complete=Xo);const i=oh(),o=this.unsubscribeOne.bind(this,i);if(this.observers.push({subscriptionID:i,observer:s}),this.finalized)try{this.finalError?s.error(this.finalError):s.complete()}catch(a){K.warn(a)}return o}unsubscribeOne(e){var t;this.observers=(t=this.observers)==null?void 0:t.filter(n=>n.subscriptionID!==e)}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e].observer)}catch(n){K.error(n)}}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.observers=void 0)}}function dy(r){const e=new hy(r);return{subscribe:e.subscribe.bind(e),getProxy:()=>e}}class ss{constructor(e,t,n,s){c(this,"id");c(this,"delimiter");c(this,"message");c(this,"root");c(this,"operations");c(this,"presenceChange");c(this,"previousPresence");c(this,"reversePresenceKeys");this.id=e,this.delimiter=Bf,this.root=t,this.operations=[],this.previousPresence=vt(n),this.presenceChange=void 0,this.reversePresenceKeys=new Set,this.message=s}static create(e,t,n,s){return new ss(e,t,n,s)}push(e){this.operations.push(e)}registerElement(e,t){this.root.registerElement(e,t)}registerRemovedElement(e){this.root.registerRemovedElement(e)}registerGCPair(e){this.root.registerGCPair(e)}getChange(){return Ts.create({id:this.id,operations:this.operations,presenceChange:this.presenceChange,message:this.message})}hasChange(){return this.operations.length>0||this.presenceChange!==void 0}setPresenceChange(e){this.presenceChange=e}setReversePresence(e,t){for(const n of Object.keys(e))t!=null&&t.addToHistory?this.reversePresenceKeys.add(n):this.reversePresenceKeys.delete(n)}getReversePresence(){if(this.reversePresenceKeys.size===0)return;const e={};for(const t of this.reversePresenceKeys)e[t]=this.previousPresence[t];return e}issueTimeTicket(){return this.delimiter+=1,this.id.createTimeTicket(this.delimiter)}getLastTimeTicket(){return this.id.createTimeTicket(this.delimiter)}}class ii{constructor(e){c(this,"rootObject");c(this,"elementPairMapByCreatedAt");c(this,"gcElementSetByCreatedAt");c(this,"gcPairMap");this.rootObject=e,this.elementPairMapByCreatedAt=new Map,this.gcElementSetByCreatedAt=new Set,this.gcPairMap=new Map,this.registerElement(e,void 0),e.getDescendants(t=>{if(t.getRemovedAt()&&this.registerRemovedElement(t),t instanceof mt||t instanceof pt)for(const n of t.getGCPairs())this.registerGCPair(n);return!1})}static create(){return new ii(Ve.create(St))}findByCreatedAt(e){const t=this.elementPairMapByCreatedAt.get(e.toIDString());if(t)return t.element}findElementPairByCreatedAt(e){return this.elementPairMapByCreatedAt.get(e.toIDString())}createSubPaths(e){let t=this.elementPairMapByCreatedAt.get(e.toIDString());if(!t)return[];const n=[];for(;t.parent;){const s=t.element.getCreatedAt(),i=t.parent.subPathOf(s);if(i===void 0)throw new w(v.ErrInvalidArgument,`cant find the given element: ${s.toIDString()}`);n.unshift(i),t=this.elementPairMapByCreatedAt.get(t.parent.getCreatedAt().toIDString())}return n.unshift("$"),n}createPath(e){return this.createSubPaths(e).join(".")}registerElement(e,t){this.elementPairMapByCreatedAt.set(e.getCreatedAt().toIDString(),{parent:t,element:e}),e instanceof Sn&&e.getDescendants((n,s)=>(this.registerElement(n,s),!1))}deregisterElement(e){let t=0;const n=s=>{const i=s.getCreatedAt().toIDString();this.elementPairMapByCreatedAt.delete(i),this.gcElementSetByCreatedAt.delete(i),t++};return n(e),e instanceof Sn&&e.getDescendants(s=>(n(s),!1)),t}registerRemovedElement(e){this.gcElementSetByCreatedAt.add(e.getCreatedAt().toIDString())}registerGCPair(e){if(this.gcPairMap.get(e.child.toIDString())){this.gcPairMap.delete(e.child.toIDString());return}this.gcPairMap.set(e.child.toIDString(),e)}getElementMapSize(){return this.elementPairMapByCreatedAt.size}getGarbageElementSetSize(){const e=new Set;for(const t of this.gcElementSetByCreatedAt){e.add(t);const n=this.elementPairMapByCreatedAt.get(t);n.element instanceof Sn&&n.element.getDescendants(s=>(e.add(s.getCreatedAt().toIDString()),!1))}return e.size}getObject(){return this.rootObject}getGarbageLen(){return this.getGarbageElementSetSize()+this.gcPairMap.size}deepcopy(){return new ii(this.rootObject.deepcopy())}garbageCollect(e){let t=0;for(const n of this.gcElementSetByCreatedAt){const s=this.elementPairMapByCreatedAt.get(n),i=s.element.getRemovedAt();i&&(e!=null&&e.afterOrEqual(i))&&(s.parent.purge(s.element),t+=this.deregisterElement(s.element))}for(const[,n]of this.gcPairMap){const s=n.child.getRemovedAt();s&&(e!=null&&e.afterOrEqual(s))&&(n.parent.purge(n.child),this.gcPairMap.delete(n.child.toIDString()),t+=1)}return t}toJSON(){return this.rootObject.toJSON()}toSortedJSON(){return this.rootObject.toSortedJSON()}getStats(){return{elements:this.getElementMapSize(),gcPairs:this.gcPairMap.size,gcElements:this.getGarbageElementSetSize()}}}function ah(r,e){const t=new oi(r);return new Proxy(e,t.getHandlers())}class oi{constructor(e){c(this,"context");c(this,"handlers");this.context=e,this.handlers={set:(t,n,s)=>(K.isEnabled(Ue.Trivial)&&K.trivial(`obj[${n}]=${JSON.stringify(s)}`),oi.setInternal(e,t,n,s),!0),get:(t,n)=>(K.isEnabled(Ue.Trivial)&&K.trivial(`obj[${n}]`),n==="getID"?()=>t.getCreatedAt():n==="toJSON"||n==="toString"?()=>t.toJSON():n==="toJS"?()=>t.toJS():n==="toJSForTest"?()=>t.toJSForTest():$n(e,t.get(n))),ownKeys:t=>t.getKeys(),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),deleteProperty:(t,n)=>(K.isEnabled(Ue.Trivial)&&K.trivial(`obj[${n}]`),oi.deleteInternal(e,t,n),!0)}}static setInternal(e,t,n,s){if(n.includes("."))throw new w(v.ErrInvalidObjectKey,"key must not contain the '.'.");const i=e.issueTimeTicket(),o=ho(e,s,i),a=t.set(n,o,i);e.registerElement(o,t),a&&e.registerRemovedElement(a),e.push(Gn.create(n,o.deepcopy(),t.getCreatedAt(),i))}static buildObjectMembers(e,t){const n={};for(const[s,i]of Object.entries(t)){if(s.includes("."))throw new w(v.ErrInvalidObjectKey,"key must not contain the '.'.");const o=e.issueTimeTicket(),a=ho(e,i,o);n[s]=a}return n}static deleteInternal(e,t,n){const s=e.issueTimeTicket(),i=t.deleteByKey(n,s);i&&(e.push(Cn.create(t.getCreatedAt(),i.getCreatedAt(),s)),e.registerRemovedElement(i))}getHandlers(){return this.handlers}}function gy(r,e){const t=new me(r,e);return new Proxy(e,t.getHandlers())}function my(r){return typeof r=="string"||r instanceof String?!isNaN(r):!1}function py(r){return["concat","entries","every","filter","find","findIndex","forEach","join","keys","map","reduce","reduceRight","slice","some","toLocaleString","toString","values"].includes(r)}class me{constructor(e,t){c(this,"context");c(this,"handlers");c(this,"array");this.context=e,this.array=t,this.handlers={get:(n,s,i)=>s==="getID"?()=>n.getCreatedAt():s==="getElementByID"?o=>{const a=n.getByID(o);if(!(!a||a.isRemoved()))return yn(e,a)}:s==="getElementByIndex"?o=>{const a=n.get(o);return yn(e,a)}:s==="getLast"?()=>yn(e,n.getLast()):s==="deleteByID"?o=>{const a=me.deleteInternalByID(e,n,o);return yn(e,a)}:s==="insertAfter"?(o,a)=>{const l=me.insertAfterInternal(e,n,o,a);return yn(e,l)}:s==="insertBefore"?(o,a)=>{const l=me.insertBeforeInternal(e,n,o,a);return yn(e,l)}:s==="moveBefore"?(o,a)=>{me.moveBeforeInternal(e,n,o,a)}:s==="moveAfter"?(o,a)=>{me.moveAfterInternal(e,n,o,a)}:s==="moveFront"?o=>{me.moveFrontInternal(e,n,o)}:s==="moveLast"?o=>{me.moveLastInternal(e,n,o)}:my(s)?$n(e,n.get(Number(s))):s==="push"?o=>me.pushInternal(e,n,o):s==="splice"?(o,a,...l)=>me.splice(e,n,o,a,...l):s==="length"?n.length:typeof s=="symbol"&&s===Symbol.iterator?me.iteratorInternal.bind(this,e,n):s==="includes"?(o,a)=>me.includes(e,n,o,a):s==="indexOf"?(o,a)=>me.indexOf(e,n,o,a):s==="lastIndexOf"?(o,a)=>me.lastIndexOf(e,n,o,a):s==="toJSForTest"?()=>n.toJSForTest():s==="toTestString"?()=>me.toTestString(n):typeof s=="string"&&py(s)?(...o)=>{const a=Array.from(n).map(l=>$n(e,l));return Array.prototype[s].apply(a,o)}:Reflect.get(n,s,i),deleteProperty:(n,s)=>(K.isEnabled(Ue.Trivial)&&K.trivial(`array[${s}]`),me.deleteInternalByIndex(e,n,Number.parseInt(s)),!0)}}static*iteratorInternal(e,t){for(const n of t)yield yn(e,n)}static buildArrayElements(e,t){const n=[];for(const s of t){const i=e.issueTimeTicket(),o=ho(e,s,i);n.push(o)}return n}static pushInternal(e,t,n){return me.insertAfterInternal(e,t,t.getLastCreatedAt(),n),t.length}static moveBeforeInternal(e,t,n,s){const i=e.issueTimeTicket(),o=t.getPrevCreatedAt(n);t.moveAfter(o,s,i),e.push(Tn.create(t.getCreatedAt(),o,s,i))}static moveAfterInternal(e,t,n,s){const i=e.issueTimeTicket();t.moveAfter(n,s,i),e.push(Tn.create(t.getCreatedAt(),n,s,i))}static moveFrontInternal(e,t,n){const s=e.issueTimeTicket(),i=t.getHead();t.moveAfter(i.getCreatedAt(),n,s),e.push(Tn.create(t.getCreatedAt(),i.getCreatedAt(),n,s))}static moveLastInternal(e,t,n){const s=e.issueTimeTicket(),i=t.getLastCreatedAt();t.moveAfter(i,n,s),e.push(Tn.create(t.getCreatedAt(),i,n,s))}static insertAfterInternal(e,t,n,s){const i=e.issueTimeTicket(),o=ho(e,s,i);return t.insertAfter(n,o),e.registerElement(o,t),e.push(ui.create(t.getCreatedAt(),n,o.deepcopy(),i)),o}static insertBeforeInternal(e,t,n,s){return me.insertAfterInternal(e,t,t.getPrevCreatedAt(n),s)}static deleteInternalByIndex(e,t,n){const s=e.issueTimeTicket(),i=t.deleteByIndex(n,s);if(i)return e.push(Cn.create(t.getCreatedAt(),i.getCreatedAt(),s)),e.registerRemovedElement(i),i}static deleteInternalByID(e,t,n){const s=e.issueTimeTicket(),i=t.delete(n,s);return e.push(Cn.create(t.getCreatedAt(),i.getCreatedAt(),s)),e.registerRemovedElement(i),i}static splice(e,t,n,s,...i){const o=t.length,a=n>=0?Math.min(n,o):Math.max(o+n,0),l=s===void 0?o:s<0?a:Math.min(a+s,o),u=[];for(let f=a;f<l;f++){const d=me.deleteInternalByIndex(e,t,a);if(d){const y=d.deepcopy();y.setRemovedAt(),u.push($n(e,y))}}if(i){let f=a===0?t.getHead().getID():t.get(a-1).getID();for(const d of i)f=me.insertAfterInternal(e,t,f,d).getID()}return u}static includes(e,t,n,s){var a;const i=t.length,o=s===void 0?0:s<0?Math.max(s+i,0):s;if(o>=i)return!1;if(ye.isSupport(n))return Array.from(t).map(u=>$n(e,u)).includes(n,o);for(let l=o;l<i;l++)if(((a=t.get(l))==null?void 0:a.getID())===n.getID())return!0;return!1}static indexOf(e,t,n,s){var a;const i=t.length,o=s===void 0?0:s<0?Math.max(s+i,0):s;if(o>=i)return-1;if(ye.isSupport(n))return Array.from(t).map(u=>$n(e,u)).indexOf(n,o);for(let l=o;l<i;l++)if(((a=t.get(l))==null?void 0:a.getID())===n.getID())return l;return-1}static lastIndexOf(e,t,n,s){var a;const i=t.length,o=s===void 0||s>=i?i-1:s<0?s+i:s;if(o<0)return-1;if(ye.isSupport(n))return Array.from(t).map(u=>$n(e,u)).lastIndexOf(n,o);for(let l=o;l>0;l--)if(((a=t.get(l))==null?void 0:a.getID())===n.getID())return l;return-1}static toTestString(e){return e.toTestString()}getHandlers(){return this.handlers}}class Ac{constructor(e,t){c(this,"context");c(this,"text");this.context=e,this.text=t}initialize(e,t){this.context=e,this.text=t}getID(){return this.text.getID()}edit(e,t,n,s){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");if(e>t)throw new w(v.ErrInvalidArgument,"from should be less than or equal to to");const i=this.text.indexRangeToPosRange(e,t);K.isEnabled(Ue.Debug)&&K.debug(`EDIT: f:${e}->${i[0].toTestString()}, t:${t}->${i[1].toTestString()} c:${n}`);const o=s?ws(s):void 0,a=this.context.issueTimeTicket(),[l,,u,f]=this.text.edit(i,n,a,o);for(const d of u)this.context.registerGCPair(d);return this.context.push(new fi(this.text.getCreatedAt(),i[0],i[1],l,n,o?new Map(Object.entries(o)):new Map,a)),this.text.findIndexesFromRange(f)}delete(e,t){return this.edit(e,t,"")}empty(){return this.edit(0,this.length,"")}setStyle(e,t,n){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");if(e>t)throw new w(v.ErrInvalidArgument,"from should be less than or equal to to");const s=this.text.indexRangeToPosRange(e,t);K.isEnabled(Ue.Debug)&&K.debug(`STYL: f:${e}->${s[0].toTestString()}, t:${t}->${s[1].toTestString()} a:${JSON.stringify(n)}`);const i=ws(n),o=this.context.issueTimeTicket(),[a,l]=this.text.setStyle(s,i,o);for(const u of l)this.context.registerGCPair(u);return this.context.push(new hi(this.text.getCreatedAt(),s[0],s[1],a,new Map(Object.entries(i)),o)),!0}indexRangeToPosRange(e){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");const t=this.text.indexRangeToPosRange(e[0],e[1]);return[t[0].toStruct(),t[1].toStruct()]}posRangeToIndexRange(e){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");const t=this.text.findIndexesFromRange([It.fromStruct(e[0]),It.fromStruct(e[1])]);return[t[0],t[1]]}toTestString(){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");return this.text.toTestString()}values(){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");return this.text.values()}get length(){return this.text.length}getTreeByIndex(){return this.text.getTreeByIndex()}getTreeByID(){return this.text.getTreeByID()}toString(){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");return this.text.toString()}toJSON(){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");return this.text.toJSON()}toJSForTest(){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");return this.text.toJSForTest()}createRangeForTest(e,t){if(!this.context||!this.text)throw new w(v.ErrNotInitialized,"Text is not initialized yet");return this.text.indexRangeToPosRange(e,t)}}class Sc{constructor(e,t){c(this,"valueType");c(this,"value");c(this,"context");c(this,"counter");this.valueType=e,this.value=t}initialize(e,t){this.valueType=t.getValueType(),this.context=e,this.counter=t,this.value=t.getValue()}getID(){return this.counter.getID()}getValue(){return this.value}getValueType(){return this.valueType}increase(e){if(!this.context||!this.counter)throw new w(v.ErrNotInitialized,"Counter is not initialized yet");const t=this.context.issueTimeTicket(),n=ye.of(e,t);if(!n.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof n.getValue()}`);return this.counter.increase(n),this.context.push(Ss.create(this.counter.getCreatedAt(),n,t)),this}toJSForTest(){if(!this.context||!this.counter)throw new w(v.ErrNotInitialized,"Counter is not initialized yet");return this.counter.toJSForTest()}}function Ic(r,e,t){const{type:n}=r,s=t.issueTimeTicket();if(n===cn){ch(r);const{value:i}=r,o=Ye.create(ke.of(s,0),n,i);e.append(o)}else{const{children:i=[]}=r,{attributes:o}=r;let a;if(typeof o=="object"&&!Df(o)){const u=ws(o);a=new fn;for(const[f,d]of Object.entries(u))a.set(f,d,s)}const l=Ye.create(ke.of(s,0),n,void 0,a);e.append(l);for(const u of i)Ic(u,l,t)}}function yy(r,e){const{type:t}=e,n=r.issueTimeTicket();let s;if(e.type===cn){const{value:i}=e;s=Ye.create(ke.of(n,0),t,i)}else if(e){const{children:i=[]}=e,{attributes:o}=e;let a;if(typeof o=="object"&&!Df(o)){const l=ws(o);a=new fn;for(const[u,f]of Object.entries(l))a.set(u,f,n)}s=Ye.create(ke.of(r.issueTimeTicket(),0),t,void 0,a);for(const l of i)Ic(l,s,r)}return s}function ch(r){if(!r.value.length)throw new w(v.ErrInvalidArgument,"text node cannot have empty value");return!0}function Wl(r){if(!r.length)return!0;if(r[0].type===cn)for(const t of r){const{type:n}=t;if(n!==cn)throw new w(v.ErrInvalidArgument,"element node and text node cannot be passed together");ch(t)}else for(const t of r){const{type:n}=t;if(n===cn)throw new w(v.ErrInvalidArgument,"element node and text node cannot be passed together")}return!0}class xc{constructor(e){c(this,"initialRoot");c(this,"context");c(this,"tree");this.initialRoot=e}initialize(e,t){this.context=e,this.tree=t}getID(){return this.tree.getID()}buildRoot(e){if(!this.initialRoot)return Ye.create(ke.of(e.issueTimeTicket(),0),gp);const t=Ye.create(ke.of(e.issueTimeTicket(),0),this.initialRoot.type);for(const n of this.initialRoot.children)Ic(n,t,e);return t}getSize(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getSize()}getNodeSize(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getNodeSize()}getIndexTree(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getIndexTree()}styleByPath(e,t){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(!e.length)throw new w(v.ErrInvalidArgument,"path should not be empty");const[n,s]=this.tree.pathToPosRange(e),i=this.context.issueTimeTicket(),o=t?ws(t):void 0,[a]=this.tree.style([n,s],o,i);this.context.push(ln.create(this.tree.getCreatedAt(),n,s,a,o?new Map(Object.entries(o)):new Map,i))}style(e,t,n){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new w(v.ErrInvalidArgument,"from should be less than or equal to to");const s=this.tree.findPos(e),i=this.tree.findPos(t),o=this.context.issueTimeTicket(),a=n?ws(n):void 0,[l,u]=this.tree.style([s,i],a,o);for(const f of u)this.context.registerGCPair(f);this.context.push(ln.create(this.tree.getCreatedAt(),s,i,l,a?new Map(Object.entries(a)):new Map,o))}removeStyle(e,t,n){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new w(v.ErrInvalidArgument,"from should be less than or equal to to");const s=this.tree.findPos(e),i=this.tree.findPos(t),o=this.context.issueTimeTicket(),[a,l]=this.tree.removeStyle([s,i],n,o);for(const u of l)this.context.registerGCPair(u);this.context.push(ln.createTreeRemoveStyleOperation(this.tree.getCreatedAt(),s,i,a,n,o))}editInternal(e,t,n,s=0){var u;if(n.length!==0&&n[0]&&(Wl(n),n[0].type!==cn))for(const f of n){const{children:d=[]}=f;Wl(d)}const i=this.context.getLastTimeTicket();let o=new Array;if(((u=n[0])==null?void 0:u.type)===cn){let f="";for(const d of n){const{value:y}=d;f+=y}o.push(Ye.create(ke.of(this.context.issueTimeTicket(),0),cn,f))}else o=n.map(f=>f&&yy(this.context,f)).filter(f=>f);const[,a,l]=this.tree.edit([e,t],o.length?o.map(f=>f==null?void 0:f.deepcopy()):void 0,s,i,()=>this.context.issueTimeTicket());for(const f of a)this.context.registerGCPair(f);return this.context.push(di.create(this.tree.getCreatedAt(),e,t,o.length?o:void 0,s,l,i)),!0}editByPath(e,t,n,s=0){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(e.length!==t.length)throw new w(v.ErrInvalidArgument,"path length should be equal");if(!e.length||!t.length)throw new w(v.ErrInvalidArgument,"path should not be empty");const i=this.tree.pathToPos(e),o=this.tree.pathToPos(t);return this.editInternal(i,o,n?[n]:[],s)}editBulkByPath(e,t,n,s=0){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(e.length!==t.length)throw new w(v.ErrInvalidArgument,"path length should be equal");if(!e.length||!t.length)throw new w(v.ErrInvalidArgument,"path should not be empty");const i=this.tree.pathToPos(e),o=this.tree.pathToPos(t);return this.editInternal(i,o,n,s)}edit(e,t,n,s=0){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new w(v.ErrInvalidArgument,"from should be less than or equal to to");const i=this.tree.findPos(e),o=this.tree.findPos(t);return this.editInternal(i,o,n?[n]:[],s)}editBulk(e,t,n,s=0){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new w(v.ErrInvalidArgument,"from should be less than or equal to to");const i=this.tree.findPos(e),o=this.tree.findPos(t);return this.editInternal(i,o,n,s)}toXML(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toXML()}toJSON(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSON()}toJSForTest(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSForTest()}toJSInfoForTest(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSInfoForTest()}getRootTreeNode(){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getRootTreeNode()}indexToPath(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.indexToPath(e)}pathToIndex(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.pathToIndex(e)}pathRangeToPosRange(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");const t=[this.tree.pathToIndex(e[0]),this.tree.pathToIndex(e[1])],n=this.tree.indexRangeToPosRange(t);return[n[0].toStruct(),n[1].toStruct()]}indexRangeToPosRange(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");return this.tree.indexRangeToPosStructRange(e)}posRangeToIndexRange(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");const t=[bt.fromStruct(e[0]),bt.fromStruct(e[1])];return this.tree.posRangeToIndexRange(t)}posRangeToPathRange(e){if(!this.context||!this.tree)throw new w(v.ErrNotInitialized,"Tree is not initialized yet");const t=[bt.fromStruct(e[0]),bt.fromStruct(e[1])];return this.tree.posRangeToPathRange(t)}}function _l(r,e){return ah(r,e)}function yn(r,e){if(e){if(e instanceof ye)return e;if(e instanceof Ve)return ah(r,e);if(e instanceof Xe)return gy(r,e);if(e instanceof mt)return new Ac(r,e);if(e instanceof Ze){const t=new Sc(_t.IntegerCnt,0);return t.initialize(r,e),t}else if(e instanceof pt){const t=new xc;return t.initialize(r,e),t}}else return;throw new TypeError(`Unsupported type of element: ${typeof e}`)}function $n(r,e){const t=yn(r,e);return t instanceof ye?t.getValue():t}function ho(r,e,t){let n;if(ye.isSupport(e))n=ye.of(e,t);else if(Array.isArray(e))n=Xe.create(t,me.buildArrayElements(r,e));else if(typeof e=="object")e instanceof Ac?(n=mt.create(As.create(),t),e.initialize(r,n)):e instanceof Sc?(n=Ze.create(e.getValueType(),e.getValue(),t),e.initialize(r,n)):e instanceof xc?(n=pt.create(e.buildRoot(r),t),e.initialize(r,n)):n=Ve.create(t,oi.buildObjectMembers(r,e));else throw new TypeError(`Unsupported type of value: ${typeof e}`);return n}const Gl=50;class vy{constructor(){c(this,"undoStack",[]);c(this,"redoStack",[])}hasUndo(){return this.undoStack.length>0}hasRedo(){return this.redoStack.length>0}pushUndo(e){this.undoStack.length>=Gl&&this.undoStack.shift(),this.undoStack.push(e)}popUndo(){return this.undoStack.pop()}pushRedo(e){this.redoStack.length>=Gl&&this.redoStack.shift(),this.redoStack.push(e)}popRedo(){return this.redoStack.pop()}clearRedo(){this.redoStack=[]}getUndoStackForTest(){return this.undoStack}getRedoStackForTest(){return this.redoStack}}const wy="yorkie-devtools-panel",by="yorkie-devtools-sdk";function Ty(r){return[xe.StatusChanged,xe.Snapshot,xe.LocalChange,xe.RemoteChange,xe.Initialized,xe.Watched,xe.Unwatched,xe.PresenceChanged].includes(r.type)}function Ay(r){return r.every(Ty)}let rs="disconnected";const Yl=new Map,Li=new Map;typeof window<"u"&&(window.docEventsForReplayByDocKey=Li);function xi(r,e){(e!=null&&e.force||rs!=="disconnected")&&window.postMessage({source:by,...r},"*")}function Sy(r){if(!r.isEnableDevtools()||typeof window>"u"||Yl.has(r.getKey()))return;Li.set(r.getKey(),[]);const e=r.subscribe("all",t=>{Ay(t)&&(Li.get(r.getKey()).push(t),rs==="synced"&&xi({msg:"doc::sync::partial",docKey:r.getKey(),event:t}))});Yl.set(r.getKey(),[e]),xi({msg:"refresh-devtools"},{force:!0}),window.addEventListener("message",t=>{var s;if(((s=t.data)==null?void 0:s.source)!==wy)return;switch(t.data.msg){case"devtools::connect":if(rs!=="disconnected")break;rs="connected",xi({msg:"doc::available",docKey:r.getKey()}),K.info(`[YD] Devtools connected. Doc: ${r.getKey()}`);break;case"devtools::disconnect":rs="disconnected",K.info(`[YD] Devtools disconnected. Doc: ${r.getKey()}`);break;case"devtools::subscribe":rs="synced",xi({msg:"doc::sync::full",docKey:r.getKey(),events:Li.get(r.getKey())}),K.info(`[YD] Devtools subscribed. Doc: ${r.getKey()}`);break}})}var vn=(r=>(r.Detached="detached",r.Attached="attached",r.Removed="removed",r))(vn||{}),xe=(r=>(r.StatusChanged="status-changed",r.ConnectionChanged="connection-changed",r.SyncStatusChanged="sync-status-changed",r.Snapshot="snapshot",r.LocalChange="local-change",r.RemoteChange="remote-change",r.Initialized="initialized",r.Watched="watched",r.Unwatched="unwatched",r.PresenceChanged="presence-changed",r.Broadcast="broadcast",r.LocalBroadcast="local-broadcast",r.AuthError="auth-error",r))(xe||{}),$a=(r=>(r.Connected="connected",r.Disconnected="disconnected",r))($a||{}),Ua=(r=>(r.Synced="synced",r.SyncFailed="sync-failed",r))(Ua||{});class lh{constructor(e,t){c(this,"key");c(this,"status");c(this,"opts");c(this,"changeID");c(this,"checkpoint");c(this,"localChanges");c(this,"root");c(this,"clone");c(this,"eventStream");c(this,"eventStreamObserver");c(this,"onlineClients");c(this,"presences");c(this,"history");c(this,"internalHistory");c(this,"isUpdating");this.opts=t||{},this.key=e,this.status="detached",this.root=ii.create(),this.changeID=Sp,this.checkpoint=Ip,this.localChanges=[],this.eventStream=dy(n=>{this.eventStreamObserver=n}),this.onlineClients=new Set,this.presences=new Map,this.isUpdating=!1,this.internalHistory=new vy,this.history={canUndo:this.canUndo.bind(this),canRedo:this.canRedo.bind(this),undo:this.undo.bind(this),redo:this.redo.bind(this)},Sy(this)}update(e,t){if(this.getStatus()==="removed")throw new w(v.ErrDocumentRemoved,`${this.key} is removed`);this.ensureClone();const n=this.changeID.getActorID(),s=ss.create(this.changeID.next(),this.clone.root,this.clone.presences.get(n)||{},t);try{const i=_l(s,this.clone.root.getObject());this.presences.has(n)||this.clone.presences.set(n,{}),this.isUpdating=!0,e(i,new _o(s,this.clone.presences.get(n)))}catch(i){throw this.clone=void 0,i}finally{this.isUpdating=!1}if(s.hasChange()){K.isEnabled(Ue.Trivial)&&K.trivial(`trying to update a local change: ${this.toJSON()}`);const i=s.getChange(),{opInfos:o,reverseOps:a}=i.execute(this.root,this.presences,ae.Local),l=s.getReversePresence();l&&a.push({type:"presence",value:l}),this.localChanges.push(i),a.length>0&&this.internalHistory.pushUndo(a),o.length>0&&this.internalHistory.clearRedo(),this.changeID=i.getID();const u=[];o.length>0&&u.push({type:"local-change",source:ae.Local,value:{message:i.getMessage()||"",operations:o,actor:n,clientSeq:i.getID().getClientSeq(),serverSeq:i.getID().getServerSeq()},rawChange:this.isEnableDevtools()?i.toStruct():void 0}),i.hasPresenceChange()&&u.push({type:"presence-changed",source:ae.Local,value:{clientID:n,presence:this.getPresence(n)}}),this.publish(u),K.isEnabled(Ue.Trivial)&&K.trivial(`after update a local change: ${this.toJSON()}`)}}subscribe(e,t,n,s){if(typeof e=="string"){if(typeof t!="function")throw new w(v.ErrInvalidArgument,"Second argument must be a callback function");if(e==="presence"){const a=t;return this.eventStream.subscribe(l=>{for(const u of l)u.type!=="initialized"&&u.type!=="watched"&&u.type!=="unwatched"&&u.type!=="presence-changed"||a(u)},n,s)}if(e==="my-presence"){const a=t;return this.eventStream.subscribe(l=>{for(const u of l)u.type!=="initialized"&&u.type!=="presence-changed"||u.type==="presence-changed"&&u.value.clientID!==this.changeID.getActorID()||a(u)},n,s)}if(e==="others"){const a=t;return this.eventStream.subscribe(l=>{for(const u of l)u.type!=="watched"&&u.type!=="unwatched"&&u.type!=="presence-changed"||u.value.clientID!==this.changeID.getActorID()&&a(u)},n,s)}if(e==="connection"){const a=t;return this.eventStream.subscribe(l=>{for(const u of l)u.type==="connection-changed"&&a(u)},n,s)}if(e==="status"){const a=t;return this.eventStream.subscribe(l=>{for(const u of l)u.type==="status-changed"&&a(u)},n,s)}if(e==="sync"){const a=t;return this.eventStream.subscribe(l=>{for(const u of l)u.type==="sync-status-changed"&&a(u)},n,s)}if(e==="local-broadcast"){const a=t;return this.eventStream.subscribe(l=>{for(const u of l)u.type==="local-broadcast"&&a(u)},n)}if(e==="broadcast"){const a=t;return this.eventStream.subscribe(l=>{for(const u of l)u.type==="broadcast"&&a(u)},n)}if(e==="auth-error"){const a=t;return this.eventStream.subscribe(l=>{for(const u of l)u.type==="auth-error"&&a(u)},n)}if(e==="all"){const a=t;return this.eventStream.subscribe(a,n,s)}const i=e,o=t;return this.eventStream.subscribe(a=>{for(const l of a){if(l.type!=="local-change"&&l.type!=="remote-change")continue;const u=[];for(const f of l.value.operations)this.isSameElementOrChildOf(f.path,i)&&u.push(f);u.length&&o({...l,value:{...l.value,operations:u}})}},n,s)}if(typeof e=="function"){const i=e,o=t,a=n;return this.eventStream.subscribe(l=>{for(const u of l)u.type!=="snapshot"&&u.type!=="local-change"&&u.type!=="remote-change"||i(u)},o,a)}throw new w(v.ErrInvalidArgument,`"${e}" is not a valid`)}publish(e){this.eventStreamObserver&&this.eventStreamObserver.next(e)}isSameElementOrChildOf(e,t){if(t===e)return!0;const n=e.split(".");return t.split(".").every((i,o)=>i===n[o])}removePushedLocalChanges(e){for(;this.localChanges.length&&!(this.localChanges[0].getID().getClientSeq()>e);)this.localChanges.shift()}applyChangePack(e){const t=e.hasSnapshot();t?this.applySnapshot(e.getCheckpoint().getServerSeq(),e.getVersionVector(),e.getSnapshot(),e.getCheckpoint().getClientSeq()):(this.applyChanges(e.getChanges(),ae.Remote),this.removePushedLocalChanges(e.getCheckpoint().getClientSeq())),this.checkpoint=this.checkpoint.forward(e.getCheckpoint()),t||this.garbageCollect(e.getVersionVector()),e.getIsRemoved()&&this.applyStatus("removed"),K.isEnabled(Ue.Trivial)&&K.trivial(`${this.root.toJSON()}`)}getCheckpoint(){return this.checkpoint}getChangeID(){return this.changeID}hasLocalChanges(){return this.localChanges.length>0}ensureClone(){this.clone||(this.clone={root:this.root.deepcopy(),presences:vt(this.presences)})}createChangePack(){const e=Array.from(this.localChanges),t=this.checkpoint.increaseClientSeq(e.length);return No.create(this.key,t,!1,e,this.getVersionVector())}setActor(e){for(const t of this.localChanges)t.setActor(e);this.changeID=this.changeID.setActor(e)}isEnableDevtools(){return!!this.opts.enableDevtools}getKey(){return this.key}getStatus(){return this.status}getCloneRoot(){if(this.clone)return this.clone.root.getObject()}getRoot(){this.ensureClone();const e=ss.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});return _l(e,this.clone.root.getObject())}garbageCollect(e){return this.opts.disableGC?0:(this.clone&&this.clone.root.garbageCollect(e),this.root.garbageCollect(e))}getRootObject(){return this.root.getObject()}getGarbageLen(){return this.root.getGarbageLen()}getGarbageLenFromClone(){return this.clone.root.getGarbageLen()}toJSON(){return this.root.toJSON()}toSortedJSON(){return this.root.toSortedJSON()}getStats(){return this.root.getStats()}toJSForTest(){return{...this.getRoot().toJSForTest(),key:"root"}}applySnapshot(e,t,n,s=-1){const{root:i,presences:o}=ve.bytesToSnapshot(n);this.root=new ii(i),this.presences=o,this.changeID=this.changeID.setClocks(t.maxLamport(),t),this.clone=void 0,this.removePushedLocalChanges(s),this.applyChanges(this.localChanges,ae.Local),this.publish([{type:"snapshot",source:ae.Remote,value:{serverSeq:e.toString(),snapshot:this.isEnableDevtools()?ve.bytesToHex(n):void 0,snapshotVector:ve.versionVectorToHex(t)}}])}applyChanges(e,t){K.isEnabled(Ue.Debug)&&K.debug(`trying to apply ${e.length} remote changes.elements:${this.root.getElementMapSize()}, removeds:${this.root.getGarbageElementSetSize()}`),K.isEnabled(Ue.Trivial)&&K.trivial(e.map(n=>`${n.getID().toTestString()}	${n.toTestString()}`).join(`
`));for(const n of e)this.applyChange(n,t);K.isEnabled(Ue.Debug)&&K.debug(`after appling ${e.length} remote changes.elements:${this.root.getElementMapSize()},  removeds:${this.root.getGarbageElementSetSize()}`)}applyChange(e,t){this.ensureClone(),e.execute(this.clone.root,this.clone.presences,t);const n=[],s=e.getID().getActorID();if(e.hasPresenceChange()&&this.onlineClients.has(s)){const o=e.getPresenceChange();switch(o.type){case En.Put:n.push(this.presences.has(s)?{type:"presence-changed",source:t,value:{clientID:s,presence:o.presence}}:{type:"watched",source:ae.Remote,value:{clientID:s,presence:o.presence}});break;case En.Clear:n.push({type:"unwatched",source:ae.Remote,value:{clientID:s,presence:this.getPresence(s)}}),this.removeOnlineClient(s);break}}const{opInfos:i}=e.execute(this.root,this.presences,t);if(this.changeID=this.changeID.syncClocks(e.getID()),i.length>0){const o=this.isEnableDevtools()?e.toStruct():void 0;n.push(t===ae.Remote?{type:"remote-change",source:t,value:{actor:s,clientSeq:e.getID().getClientSeq(),serverSeq:e.getID().getServerSeq(),message:e.getMessage()||"",operations:i},rawChange:o}:{type:"local-change",source:t,value:{actor:s,clientSeq:e.getID().getClientSeq(),serverSeq:e.getID().getServerSeq(),message:e.getMessage()||"",operations:i},rawChange:o})}n.length>0&&this.publish(n)}applyWatchStream(e){if(e.body.case==="initialization"){const t=e.body.value.clientIds,n=new Set;for(const s of t)s!==this.changeID.getActorID()&&n.add(s);this.setOnlineClients(n),this.publish([{type:"initialized",source:ae.Local,value:this.getPresences()}]);return}if(e.body.case==="event"){const{type:t,publisher:n}=e.body.value,s=[];if(t===Hn.DOCUMENT_WATCHED){if(this.onlineClients.has(n)&&this.hasPresence(n))return;this.addOnlineClient(n),this.hasPresence(n)&&s.push({type:"watched",source:ae.Remote,value:{clientID:n,presence:this.getPresence(n)}})}else if(t===Hn.DOCUMENT_UNWATCHED){const i=this.getPresence(n);this.removeOnlineClient(n),i&&s.push({type:"unwatched",source:ae.Remote,value:{clientID:n,presence:i}})}else if(t===Hn.DOCUMENT_BROADCAST&&e.body.value.body){const{topic:i,payload:o}=e.body.value.body,a=new TextDecoder;s.push({type:"broadcast",value:{clientID:n,topic:i,payload:JSON.parse(a.decode(o))}})}s.length>0&&this.publish(s)}}applyStatus(e){this.status=e,e==="detached"&&this.setActor(Eo),this.publish([{source:e==="removed"?ae.Remote:ae.Local,type:"status-changed",value:e==="attached"?{status:e,actorID:this.changeID.getActorID()}:{status:e}}])}applyDocEventForReplay(e){if(e.type==="status-changed"){this.applyStatus(e.value.status),e.value.status==="attached"&&this.setActor(e.value.actorID);return}if(e.type==="snapshot"){const{snapshot:t,serverSeq:n,snapshotVector:s}=e.value;if(!t)return;this.applySnapshot(BigInt(n),ve.hexToVersionVector(s),ve.hexToBytes(t));return}if(e.type==="local-change"||e.type==="remote-change"){if(!e.rawChange)return;const t=Ts.fromStruct(e.rawChange);this.applyChange(t,e.source)}if(e.type==="initialized"){const t=new Set;for(const{clientID:n,presence:s}of e.value)t.add(n),this.presences.set(n,s);this.setOnlineClients(t);return}if(e.type==="watched"){const{clientID:t,presence:n}=e.value;this.addOnlineClient(t),this.presences.set(t,n);return}if(e.type==="unwatched"){const{clientID:t}=e.value;this.removeOnlineClient(t),this.presences.delete(t)}if(e.type==="presence-changed"){const{clientID:t,presence:n}=e.value;this.presences.set(t,n)}}applyDocEventsForReplay(e){for(const t of e)this.applyDocEventForReplay(t)}getValueByPath(e){if(!e.startsWith("$"))throw new w(v.ErrInvalidArgument,'path must start with "$"');const t=e.split(".");t.shift();let n=this.getRoot();for(const s of t)if(n=n[s],n===void 0)return;return n}setOnlineClients(e){this.onlineClients=e}resetOnlineClients(){this.onlineClients=new Set}addOnlineClient(e){this.onlineClients.add(e)}removeOnlineClient(e){this.onlineClients.delete(e)}hasPresence(e){return this.presences.has(e)}getMyPresence(){if(this.status!=="attached")return{};const e=this.presences.get(this.changeID.getActorID());return e?vt(e):{}}getPresence(e){if(e===this.changeID.getActorID())return this.getMyPresence();if(!this.onlineClients.has(e))return;const t=this.presences.get(e);return t?vt(t):void 0}getPresenceForTest(e){const t=this.presences.get(e);return t?vt(t):void 0}getPresences(){const e=[];e.push({clientID:this.changeID.getActorID(),presence:vt(this.getMyPresence())});for(const t of this.onlineClients)this.presences.has(t)&&e.push({clientID:t,presence:vt(this.presences.get(t))});return e}getSelfForTest(){return{clientID:this.getChangeID().getActorID(),presence:this.getMyPresence()}}getOthersForTest(){const e=this.getChangeID().getActorID();return this.getPresences().filter(t=>t.clientID!==e).sort((t,n)=>t.clientID>n.clientID?1:-1)}canUndo(){return this.internalHistory.hasUndo()&&!this.isUpdating}filterVersionVector(e){const n=this.changeID.getVersionVector().filter(e);this.changeID=this.changeID.setVersionVector(n)}canRedo(){return this.internalHistory.hasRedo()&&!this.isUpdating}undo(){if(this.isUpdating)throw new w(v.ErrRefused,"Undo is not allowed during an update");const e=this.internalHistory.popUndo();if(e===void 0)throw new w(v.ErrRefused,"There is no operation to be undone");this.ensureClone();const t=ss.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(const u of e){if(!(u instanceof xt)){new _o(t,vt(this.clone.presences.get(this.changeID.getActorID()))).set(u.value,{addToHistory:!0});continue}const f=t.issueTimeTicket();u.setExecutedAt(f),t.push(u)}const n=t.getChange();n.execute(this.clone.root,this.clone.presences,ae.UndoRedo);const{opInfos:s,reverseOps:i}=n.execute(this.root,this.presences,ae.UndoRedo),o=t.getReversePresence();if(o&&i.push({type:"presence",value:o}),i.length>0&&this.internalHistory.pushRedo(i),!n.hasPresenceChange()&&s.length===0)return;this.localChanges.push(n),this.changeID=n.getID();const a=this.changeID.getActorID(),l=[];s.length>0&&l.push({type:"local-change",source:ae.UndoRedo,value:{message:n.getMessage()||"",operations:s,actor:a,clientSeq:n.getID().getClientSeq(),serverSeq:n.getID().getServerSeq()},rawChange:this.isEnableDevtools()?n.toStruct():void 0}),n.hasPresenceChange()&&l.push({type:"presence-changed",source:ae.UndoRedo,value:{clientID:a,presence:this.getPresence(a)}}),this.publish(l)}redo(){if(this.isUpdating)throw new w(v.ErrRefused,"Redo is not allowed during an update");const e=this.internalHistory.popRedo();if(e===void 0)throw new w(v.ErrRefused,"There is no operation to be redone");this.ensureClone();const t=ss.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(const u of e){if(!(u instanceof xt)){new _o(t,vt(this.clone.presences.get(this.changeID.getActorID()))).set(u.value,{addToHistory:!0});continue}const f=t.issueTimeTicket();u.setExecutedAt(f),t.push(u)}const n=t.getChange();n.execute(this.clone.root,this.clone.presences,ae.UndoRedo);const{opInfos:s,reverseOps:i}=n.execute(this.root,this.presences,ae.UndoRedo),o=t.getReversePresence();if(o&&i.push({type:"presence",value:o}),i.length>0&&this.internalHistory.pushUndo(i),!n.hasPresenceChange()&&s.length===0)return;this.localChanges.push(n),this.changeID=n.getID();const a=this.changeID.getActorID(),l=[];s.length>0&&l.push({type:"local-change",source:ae.UndoRedo,value:{message:n.getMessage()||"",operations:s,actor:a,clientSeq:n.getID().getClientSeq(),serverSeq:n.getID().getServerSeq()},rawChange:this.isEnableDevtools()?n.toStruct():void 0}),n.hasPresenceChange()&&l.push({type:"presence-changed",source:ae.UndoRedo,value:{clientID:a,presence:this.getPresence(a)}}),this.publish(l)}getUndoStackForTest(){return this.internalHistory.getUndoStackForTest()}getRedoStackForTest(){return this.internalHistory.getRedoStackForTest()}broadcast(e,t,n){const s={type:"local-broadcast",value:{topic:e,payload:t},options:n};this.publish([s])}getVersionVector(){return this.changeID.getVersionVector()}}function Iy(r,e){let t=e;return{authInterceptor:i=>async o=>(r&&o.header.set("x-api-key",r),t&&o.header.set("authorization",t),await i(o)),setToken:i=>{t=i}}}const xy="@yorkie-js/sdk",ky="0.6.7",Xl={name:xy,version:ky};function Ey(r){return e=>async t=>(r?t.header.set("x-yorkie-user-agent",r):t.header.set("x-yorkie-user-agent",Xl.name+"/"+Xl.version),await e(t))}const Cy=r=>{try{if(JSON.stringify(r)===void 0)return!1}catch{return!1}return!0};var Ji=(r=>(r.Manual="manual",r.Realtime="realtime",r.RealtimePushOnly="realtime-pushonly",r.RealtimeSyncOff="realtime-syncoff",r))(Ji||{});const Os={rpcAddr:"https://api.yorkie.dev",syncLoopDuration:50,retrySyncLoopDelay:1e3,reconnectStreamDelay:1e3},Zo={maxRetries:1/0,initialRetryInterval:1e3,maxBackoff:2e4};class uh{constructor(e){c(this,"id");c(this,"key");c(this,"metadata");c(this,"status");c(this,"attachmentMap");c(this,"apiKey");c(this,"authTokenInjector");c(this,"conditions");c(this,"syncLoopDuration");c(this,"reconnectStreamDelay");c(this,"retrySyncLoopDelay");c(this,"rpcClient");c(this,"setAuthToken");c(this,"taskQueue");c(this,"processing",!1);c(this,"keepalive",!1);e=e||Os;const t=e.rpcAddr||Os.rpcAddr;this.key=e.key||oh(),this.metadata=e.metadata||{},this.status="deactivated",this.attachmentMap=new Map,this.apiKey=e.apiKey||"",this.authTokenInjector=e.authTokenInjector,this.conditions={SyncLoop:!1,WatchLoop:!1},this.syncLoopDuration=e.syncLoopDuration??Os.syncLoopDuration,this.reconnectStreamDelay=e.reconnectStreamDelay??Os.reconnectStreamDelay,this.retrySyncLoopDelay=e.retrySyncLoopDelay??Os.retrySyncLoopDelay;const{authInterceptor:n,setToken:s}=Iy(this.apiKey);this.setAuthToken=s,this.rpcClient=Lm(sp,np({baseUrl:t,interceptors:[n,Ey(e==null?void 0:e.userAgent)],fetch:(i,o)=>{const a={...o,keepalive:this.keepalive};return fetch(i,a)}})),this.taskQueue=[]}async activate(){if(this.isActive())return Promise.resolve();if(this.authTokenInjector){const e=await this.authTokenInjector();this.setAuthToken(e)}return this.enqueueTask(async()=>{try{const e=await this.rpcClient.activateClient({clientKey:this.key,metadata:this.metadata},{headers:{"x-shard-key":this.apiKey}});this.id=e.clientId,this.status="activated",this.runSyncLoop(),K.info(`[AC] c:"${this.getKey()}" activated, id:"${this.id}"`),typeof window<"u"&&window.addEventListener("beforeunload",async()=>{await this.deactivate({keepalive:!0})})}catch(e){throw K.error(`[AC] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}})}deactivate(e={keepalive:!1}){if(this.status==="deactivated")return Promise.resolve();const t=async()=>{try{await this.rpcClient.deactivateClient({clientId:this.id},{headers:{"x-shard-key":this.apiKey}}),this.deactivateInternal(),K.info(`[DC] c"${this.getKey()}" deactivated`)}catch(n){throw K.error(`[DC] c:"${this.getKey()}" err :`,n),await this.handleConnectError(n),n}};if(e.keepalive){this.keepalive=!0;const n=t();return this.keepalive=!1,n}return this.enqueueTask(t)}hasDocument(e){return this.attachmentMap.has(e)}attach(e,t={}){if(!this.isActive())throw new w(v.ErrClientNotActivated,`${this.key} is not active`);if(e.getStatus()!==vn.Detached)throw new w(v.ErrDocumentNotDetached,`${e.getKey()} is not detached`);e.setActor(this.id),e.update((i,o)=>o.set(t.initialPresence||{}));const n=e.subscribe("local-broadcast",async i=>{var f;const{topic:o,payload:a}=i.value,l=(f=i.options)==null?void 0:f.error,u=i.options;try{await this.broadcast(e.getKey(),o,a,u)}catch(d){d instanceof Error&&(l==null||l(d))}}),s=t.syncMode??"realtime";return this.enqueueTask(async()=>{try{const i=await this.rpcClient.attachDocument({clientId:this.id,changePack:ve.toChangePack(e.createChangePack())},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),o=ve.fromChangePack(i.changePack);if(e.applyChangePack(o),e.getStatus()===vn.Removed)return e;e.applyStatus(vn.Attached),this.attachmentMap.set(e.getKey(),new fy(this.reconnectStreamDelay,e,i.documentId,s,n)),s!=="manual"&&await this.runWatchLoop(e.getKey()),K.info(`[AD] c:"${this.getKey()}" attaches d:"${e.getKey()}"`);const a=e.getRootObject();if(t.initialRoot){const l=t.initialRoot;e.update(u=>{for(const[f,d]of Object.entries(l))if(!a.has(f)){const y=f;u[y]=d}})}return e}catch(i){throw K.error(`[AD] c:"${this.getKey()}" err :`,i),await this.handleConnectError(i),i}})}detach(e,t={keepalive:!1}){if(!this.isActive())throw new w(v.ErrClientNotActivated,`${this.key} is not active`);const n=this.attachmentMap.get(e.getKey());if(!n)throw new w(v.ErrDocumentNotAttached,`${e.getKey()} is not attached`);e.update((i,o)=>o.clear());const s=async()=>{try{const i=await this.rpcClient.detachDocument({clientId:this.id,documentId:n.docID,changePack:ve.toChangePack(e.createChangePack()),removeIfNotAttached:t.removeIfNotAttached??!1},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),o=ve.fromChangePack(i.changePack);return e.applyChangePack(o),e.getStatus()!==vn.Removed&&e.applyStatus(vn.Detached),this.detachInternal(e.getKey()),K.info(`[DD] c:"${this.getKey()}" detaches d:"${e.getKey()}"`),e}catch(i){throw K.error(`[DD] c:"${this.getKey()}" err :`,i),await this.handleConnectError(i),i}};if(t.keepalive){this.keepalive=!0;const i=s();return this.keepalive=!1,i}return this.enqueueTask(s)}async changeSyncMode(e,t){if(!this.isActive())throw new w(v.ErrClientNotActivated,`${this.key} is not active`);const n=this.attachmentMap.get(e.getKey());if(!n)throw new w(v.ErrDocumentNotAttached,`${e.getKey()} is not attached`);const s=n.syncMode;return s===t?e:(n.changeSyncMode(t),t==="manual"?(n.cancelWatchStream(),e):(t==="realtime"&&(n.remoteChangeEventReceived=!0),s==="manual"&&await this.runWatchLoop(e.getKey()),e))}sync(e){if(!this.isActive())throw new w(v.ErrClientNotActivated,`${this.key} is not active`);if(e){const t=this.attachmentMap.get(e.getKey());if(!t)throw new w(v.ErrDocumentNotAttached,`${e.getKey()} is not attached`);return this.enqueueTask(async()=>this.syncInternal(t,"realtime").catch(async n=>{throw K.error(`[SY] c:"${this.getKey()}" err :`,n),await this.handleConnectError(n),n}))}return this.enqueueTask(async()=>{const t=[];for(const[,n]of this.attachmentMap)t.push(this.syncInternal(n,n.syncMode));return Promise.all(t).catch(async n=>{throw K.error(`[SY] c:"${this.getKey()}" err :`,n),await this.handleConnectError(n),n})})}remove(e){if(!this.isActive())throw new w(v.ErrClientNotActivated,`${this.key} is not active`);const t=this.attachmentMap.get(e.getKey());if(!t)throw new w(v.ErrDocumentNotAttached,`${e.getKey()} is not attached`);e.setActor(this.id);const n=ve.toChangePack(e.createChangePack());return n.isRemoved=!0,this.enqueueTask(async()=>{try{const s=await this.rpcClient.removeDocument({clientId:this.id,documentId:t.docID,changePack:n},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),i=ve.fromChangePack(s.changePack);e.applyChangePack(i),this.detachInternal(e.getKey()),K.info(`[RD] c:"${this.getKey()}" removes d:"${e.getKey()}"`)}catch(s){throw K.error(`[RD] c:"${this.getKey()}" err :`,s),await this.handleConnectError(s),s}})}getID(){return this.id}getKey(){return this.key}isActive(){return this.status==="activated"}getStatus(){return this.status}getCondition(e){return this.conditions[e]}broadcast(e,t,n,s){if(!this.isActive())throw new w(v.ErrClientNotActivated,`${this.key} is not active`);const i=this.attachmentMap.get(e);if(!i)throw new w(v.ErrDocumentNotAttached,`${e} is not attached`);if(!Cy(n))throw new w(v.ErrInvalidArgument,"payload is not serializable");const o=(s==null?void 0:s.maxRetries)??Zo.maxRetries,a=Zo.maxBackoff;let l=0;const u=d=>Math.min(Zo.initialRetryInterval*2**d,a),f=async()=>this.enqueueTask(async()=>{try{await this.rpcClient.broadcast({clientId:this.id,documentId:i.docID,topic:t,payload:new TextEncoder().encode(JSON.stringify(n))},{headers:{"x-shard-key":`${this.apiKey}/${e}`}}),K.info(`[BC] c:"${this.getKey()}" broadcasts d:"${e}" t:"${t}"`)}catch(d){if(K.error(`[BC] c:"${this.getKey()}" err:`,d),await this.handleConnectError(d))if(d instanceof ne&&mn(d)===v.ErrUnauthenticated&&i.doc.publish([{type:xe.AuthError,value:{reason:Bs(d).reason,method:"Broadcast"}}]),l<o)l++,setTimeout(()=>f(),u(l-1)),K.info(`[BC] c:"${this.getKey()}" retry attempt ${l}/${o}`);else throw K.error(`[BC] c:"${this.getKey()}" exceeded maximum retry attempts`),d;else throw d}});return f()}runSyncLoop(){const e=()=>{if(!this.isActive()){K.debug(`[SL] c:"${this.getKey()}" exit sync loop`),this.conditions.SyncLoop=!1;return}const t=[];for(const[,n]of this.attachmentMap)n.needRealtimeSync()&&(n.remoteChangeEventReceived=!1,t.push(this.syncInternal(n,n.syncMode).catch(async s=>{throw s instanceof ne&&mn(s)===v.ErrUnauthenticated&&n.doc.publish([{type:xe.AuthError,value:{reason:Bs(s).reason,method:"PushPull"}}]),s})));Promise.all(t).then(()=>setTimeout(e,this.syncLoopDuration)).catch(async n=>{K.error(`[SL] c:"${this.getKey()}" sync failed:`,n),await this.handleConnectError(n)?setTimeout(e,this.retrySyncLoopDelay):this.conditions.SyncLoop=!1})};K.debug(`[SL] c:"${this.getKey()}" run sync loop`),this.conditions.SyncLoop=!0,e()}async runWatchLoop(e){const t=this.attachmentMap.get(e);if(!t)throw new w(v.ErrDocumentNotAttached,`${e} is not attached`);return this.conditions.WatchLoop=!0,t.runWatchLoop(n=>{if(!this.isActive())return this.conditions.WatchLoop=!1,Promise.reject(new w(v.ErrClientNotActivated,`${this.key} is not active`));const s=new AbortController,i=this.rpcClient.watchDocument({clientId:this.id,documentId:t.docID},{headers:{"x-shard-key":`${this.apiKey}/${e}`},signal:s.signal});return t.doc.publish([{type:xe.ConnectionChanged,value:$a.Connected}]),K.info(`[WD] c:"${this.getKey()}" watches d:"${e}"`),new Promise((o,a)=>{(async()=>{try{for await(const u of i)this.handleWatchDocumentsResponse(t,u),u.body.case==="initialization"&&o([i,s])}catch(u){t.doc.resetOnlineClients(),t.doc.publish([{type:xe.Initialized,source:ae.Local,value:t.doc.getPresences()}]),t.doc.publish([{type:xe.ConnectionChanged,value:$a.Disconnected}]),K.debug(`[WD] c:"${this.getKey()}" unwatches`),await this.handleConnectError(u)?(u instanceof ne&&mn(u)===v.ErrUnauthenticated&&t.doc.publish([{type:xe.AuthError,value:{reason:Bs(u).reason,method:"WatchDocuments"}}]),n()):this.conditions.WatchLoop=!1,a(u)}})()})})}handleWatchDocumentsResponse(e,t){if(t.body.case==="event"&&t.body.value.type===Hn.DOCUMENT_CHANGED){e.remoteChangeEventReceived=!0;return}e.doc.applyWatchStream(t)}deactivateInternal(){this.status="deactivated";for(const[e,t]of this.attachmentMap)this.detachInternal(e),t.doc.applyStatus(vn.Detached)}detachInternal(e){const t=this.attachmentMap.get(e);t&&(t.cancelWatchStream(),t.unsubscribeBroadcastEvent(),this.attachmentMap.delete(e))}async syncInternal(e,t){const{doc:n,docID:s}=e,i=n.createChangePack();try{const o=await this.rpcClient.pushPullChanges({clientId:this.id,documentId:s,changePack:ve.toChangePack(i),pushOnly:t==="realtime-pushonly"},{headers:{"x-shard-key":`${this.apiKey}/${n.getKey()}`}}),a=ve.fromChangePack(o.changePack);if(a.hasChanges()&&(e.syncMode==="realtime-pushonly"||e.syncMode==="realtime-syncoff"))return n;n.applyChangePack(a),e.doc.publish([{type:xe.SyncStatusChanged,value:Ua.Synced}]),n.getStatus()===vn.Removed&&this.detachInternal(n.getKey());const l=n.getKey(),u=a.getChangeSize();return K.info(`[PP] c:"${this.getKey()}" sync d:"${l}", push:${i.getChangeSize()} pull:${u} cp:${a.getCheckpoint().toTestString()}`),n}catch(o){throw n.publish([{type:xe.SyncStatusChanged,value:Ua.SyncFailed}]),K.error(`[PP] c:"${this.getKey()}" err :`,o),o}}async handleConnectError(e){if(!(e instanceof ne))return!1;if(e.code===X.Canceled||e.code===X.Unknown||e.code===X.ResourceExhausted||e.code===X.Unavailable)return!0;if(mn(e)===v.ErrUnauthenticated){if(this.authTokenInjector){const t=await this.authTokenInjector(Bs(e).reason);this.setAuthToken(t)}return!0}return mn(e)===v.ErrTooManySubscribers?(K.error(`[WD] c:"${this.getKey()}" err :`,e.rawMessage),!0):(mn(e)===v.ErrTooManyAttachments||(mn(e)===v.ErrClientNotActivated||mn(e)===v.ErrClientNotFound)&&this.deactivateInternal(),!1)}enqueueTask(e){return new Promise((t,n)=>{this.taskQueue.push(()=>e().then(t).catch(n)),this.processing||this.processNext()})}async processNext(){if(this.taskQueue.length===0){this.processing=!1;return}try{this.processing=!0,await this.taskQueue.shift()()}catch{K.error(`[TQ] c:"${this.getKey()}" process failed, id:"${this.id}"`)}this.processNext()}}const fh={Client:uh,Document:lh,IntType:_t.IntegerCnt,LongType:_t.LongCnt};typeof globalThis<"u"&&(globalThis.yorkie={Client:uh,Document:lh,Primitive:ye,Text:Ac,Counter:Sc,Tree:xc,LogLevel:Ue,setLogLevel:uy,IntType:_t.IntegerCnt,LongType:_t.LongCnt});const Ny=(r,e)=>{const t=r.__vccOpts||r;for(const[n,s]of e)t[n]=s;return t},Py=[{title:"Todo",cards:[{title:"Pruning document"},{title:"Clean up codes"}]},{title:"Doing",cards:[{title:"Array operations"}]},{title:"Done",cards:[{title:"Create a sample page"},{title:"Launch demo site"}]}],pn=new fh.Client({rpcAddr:"https://api.yorkie.dev",apiKey:"cedaovjuioqlk4pjqn6g"}),Qt=new fh.Document(`vuejs-kanban-${new Date().toISOString().substring(0,10).replace(/-/g,"")}`,{enableDevtools:!0}),Oy={data(){return{lists:[],title:"",opened:null}},created(){this.fetchDoc()},beforeUnmount(){this.disconnect()},watch:{opened(r){this.$nextTick(function(){r===0?this.$refs.addListForm.querySelector("input").focus():r&&this.$refs.addCardForm[r-1].querySelector("input").focus(),this.title=""})}},methods:{async fetchDoc(){await pn.activate(),await pn.attach(Qt),Qt.update(r=>{r.lists||(r.lists=Py)},"create default list if not exists"),Qt.subscribe(r=>{this.lists=Qt.getRoot().lists}),await pn.sync(),this.lists=Qt.getRoot().lists},async disconnect(){await pn.deactivate({keepalive:!0})},isOpened(r){return this.opened===r},openForm(r){this.opened=r},closeForm(){this.opened=null},addCard(r){this.title!==""&&Qt.update(e=>{e.lists.getElementByID(r.getID()).cards.push({title:this.title}),this.title=""},`add new card by ${pn.getID()}`)},deleteCard(r,e){Qt.update(t=>{t.lists.getElementByID(r.getID()).cards.deleteByID(e.getID())},`delete a card by ${pn.getID()}`)},addList(){this.title!==""&&Qt.update(r=>{r.lists.push({title:this.title,cards:[]}),this.title=""},`add new list by ${pn.getID()}`)},deleteList(r){Qt.update(e=>{e.lists.deleteByID(r.getID())},`delete a list by ${pn.getID()}`)}}},Dy={class:"list"},By=["onClick"],Ry={class:"title"},Ly={class:"card"},Jy=["onClick"],My={key:0,class:"add-form"},Fy=["onKeyup"],$y={class:"buttons"},Uy=["onClick"],qy=["onClick"],Vy={class:"add-list",ref:"addListForm"},Ky={key:0,class:"add-form"},zy={class:"buttons"};function jy(r,e,t,n,s,i){return Xt(),Zt(et,null,[(Xt(!0),Zt(et,null,Jc(s.lists,(o,a)=>(Xt(),Zt("div",Dy,[De("span",{class:"delete",onClick:l=>i.deleteList(o)},"",8,By),De("div",Ry,ea(o.title),1),(Xt(!0),Zt(et,null,Jc(o.cards,l=>(Xt(),Zt("div",Ly,[De("span",{class:"delete",onClick:u=>i.deleteCard(o,l)},"",8,Jy),Qu(" "+ea(l.title),1)]))),256)),De("div",{class:"add-card",ref_for:!0,ref:"addCardForm"},[i.isOpened(a+1)?(Xt(),Zt("div",My,[Lc(De("input",{type:"text",placeholder:"Enter card title","onUpdate:modelValue":e[0]||(e[0]=l=>s.title=l),onKeyup:[bi(l=>i.addCard(o),["enter"]),e[1]||(e[1]=bi(l=>i.closeForm(),["esc"]))]},null,40,Fy),[[al,s.title]]),De("div",$y,[De("input",{type:"button",value:"Add",onClick:l=>i.addCard(o)},null,8,Uy),De("input",{type:"button",value:"Close",class:"pull-right",onClick:e[2]||(e[2]=l=>i.closeForm())})])])):(Xt(),Zt("div",{key:1,class:"add-card-opener",onClick:l=>i.openForm(a+1)}," Add another card ",8,qy))],512)]))),256)),De("div",Vy,[i.isOpened(0)?(Xt(),Zt("div",Ky,[Lc(De("input",{type:"text",placeholder:"Enter list title","onUpdate:modelValue":e[3]||(e[3]=o=>s.title=o),onKeyup:[e[4]||(e[4]=bi(o=>i.addList(),["enter"])),e[5]||(e[5]=bi(o=>i.closeForm(),["esc"]))]},null,544),[[al,s.title]]),De("div",zy,[De("input",{type:"button",value:"Add",onClick:e[6]||(e[6]=o=>i.addList())}),De("input",{type:"button",value:"Close",class:"pull-right",onClick:e[7]||(e[7]=o=>i.closeForm())})])])):(Xt(),Zt("div",{key:1,class:"add-list-opener",onClick:e[8]||(e[8]=o=>i.openForm(0))}," Add another list "))],512)],64)}const Hy=Ny(Oy,[["render",jy]]);Rg(Hy).mount("#app");
