var Gu=Object.defineProperty;var Yu=(i,t,e)=>t in i?Gu(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var A=(i,t,e)=>Yu(i,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=e(r);fetch(r.href,o)}})();var Be;(function(i){i[i.Canceled=1]="Canceled",i[i.Unknown=2]="Unknown",i[i.InvalidArgument=3]="InvalidArgument",i[i.DeadlineExceeded=4]="DeadlineExceeded",i[i.NotFound=5]="NotFound",i[i.AlreadyExists=6]="AlreadyExists",i[i.PermissionDenied=7]="PermissionDenied",i[i.ResourceExhausted=8]="ResourceExhausted",i[i.FailedPrecondition=9]="FailedPrecondition",i[i.Aborted=10]="Aborted",i[i.OutOfRange=11]="OutOfRange",i[i.Unimplemented=12]="Unimplemented",i[i.Internal=13]="Internal",i[i.Unavailable=14]="Unavailable",i[i.DataLoss=15]="DataLoss",i[i.Unauthenticated=16]="Unauthenticated"})(Be||(Be={}));function Va(i){const t=Be[i];return typeof t!="string"?i.toString():t[0].toLowerCase()+t.substring(1).replace(/[A-Z]/g,e=>"_"+e.toLowerCase())}class We extends Error{constructor(t,e=Be.Unknown,n,r,o){super(Zu(t,e)),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=t,this.code=e,this.metadata=new Headers(n??{}),this.details=r??[],this.cause=o}static from(t,e=Be.Unknown){return t instanceof We?t:t instanceof Error?t.name=="AbortError"?new We(t.message,Be.Canceled):new We(t.message,e,void 0,void 0,t):new We(String(t),e,void 0,void 0,t)}static[Symbol.hasInstance](t){return t instanceof Error?Object.getPrototypeOf(t)===We.prototype?!0:t.name==="ConnectError"&&"code"in t&&typeof t.code=="number"&&"metadata"in t&&"details"in t&&Array.isArray(t.details)&&"rawMessage"in t&&typeof t.rawMessage=="string"&&"cause"in t:!1}findDetails(t){const e="typeName"in t?{findMessage:r=>r===t.typeName?t:void 0}:t,n=[];for(const r of this.details){if("getType"in r){e.findMessage(r.getType().typeName)&&n.push(r);continue}const o=e.findMessage(r.type);if(o)try{n.push(o.fromBinary(r.value))}catch{}}return n}}function Zu(i,t){return i.length?`[${Va(t)}] ${i}`:`[${Va(t)}]`}function tt(i,t){if(!i)throw new Error(t)}const Xu=34028234663852886e22,Qu=-34028234663852886e22,ec=4294967295,tc=2147483647,nc=-2147483648;function Ko(i){if(typeof i!="number")throw new Error("invalid int 32: "+typeof i);if(!Number.isInteger(i)||i>tc||i<nc)throw new Error("invalid int 32: "+i)}function Ks(i){if(typeof i!="number")throw new Error("invalid uint 32: "+typeof i);if(!Number.isInteger(i)||i>ec||i<0)throw new Error("invalid uint 32: "+i)}function Ml(i){if(typeof i!="number")throw new Error("invalid float 32: "+typeof i);if(Number.isFinite(i)&&(i>Xu||i<Qu))throw new Error("invalid float 32: "+i)}const jl=Symbol("@bufbuild/protobuf/enum-type");function rc(i){const t=i[jl];return tt(t,"missing enum type on enum object"),t}function Fl(i,t,e,n){i[jl]=Ul(t,e.map(r=>({no:r.no,name:r.name,localName:i[r.no]})))}function Ul(i,t,e){const n=Object.create(null),r=Object.create(null),o=[];for(const s of t){const c=Jl(s);o.push(c),n[s.name]=c,r[s.no]=c}return{typeName:i,values:o,findName(s){return n[s]},findNumber(s){return r[s]}}}function ic(i,t,e){const n={};for(const r of t){const o=Jl(r);n[o.localName]=o.no,n[o.no]=o.localName}return Fl(n,i,t),n}function Jl(i){return"localName"in i?i:Object.assign(Object.assign({},i),{localName:i.name})}class fe{equals(t){return this.getType().runtime.util.equals(this.getType(),this,t)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(t,e){const n=this.getType(),r=n.runtime.bin,o=r.makeReadOptions(e);return r.readMessage(this,o.readerFactory(t),t.byteLength,o),this}fromJson(t,e){const n=this.getType(),r=n.runtime.json,o=r.makeReadOptions(e);return r.readMessage(n,t,o,this),this}fromJsonString(t,e){let n;try{n=JSON.parse(t)}catch(r){throw new Error(`cannot decode ${this.getType().typeName} from JSON: ${r instanceof Error?r.message:String(r)}`)}return this.fromJson(n,e)}toBinary(t){const e=this.getType(),n=e.runtime.bin,r=n.makeWriteOptions(t),o=r.writerFactory();return n.writeMessage(this,o,r),o.finish()}toJson(t){const e=this.getType(),n=e.runtime.json,r=n.makeWriteOptions(t);return n.writeMessage(this,r)}toJsonString(t){var e;const n=this.toJson(t);return JSON.stringify(n,null,(e=t==null?void 0:t.prettySpaces)!==null&&e!==void 0?e:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function oc(i,t,e,n){var r;const o=(r=n==null?void 0:n.localName)!==null&&r!==void 0?r:t.substring(t.lastIndexOf(".")+1),s={[o]:function(c){i.util.initFields(this),i.util.initPartial(c,this)}}[o];return Object.setPrototypeOf(s.prototype,new fe),Object.assign(s,{runtime:i,typeName:t,fields:i.util.newFieldList(e),fromBinary(c,u){return new s().fromBinary(c,u)},fromJson(c,u){return new s().fromJson(c,u)},fromJsonString(c,u){return new s().fromJsonString(c,u)},equals(c,u){return i.util.equals(s,c,u)}}),s}function sc(){let i=0,t=0;for(let n=0;n<28;n+=7){let r=this.buf[this.pos++];if(i|=(r&127)<<n,!(r&128))return this.assertBounds(),[i,t]}let e=this.buf[this.pos++];if(i|=(e&15)<<28,t=(e&112)>>4,!(e&128))return this.assertBounds(),[i,t];for(let n=3;n<=31;n+=7){let r=this.buf[this.pos++];if(t|=(r&127)<<n,!(r&128))return this.assertBounds(),[i,t]}throw new Error("invalid varint")}function Ds(i,t,e){for(let o=0;o<28;o=o+7){const s=i>>>o,c=!(!(s>>>7)&&t==0),u=(c?s|128:s)&255;if(e.push(u),!c)return}const n=i>>>28&15|(t&7)<<4,r=!!(t>>3);if(e.push((r?n|128:n)&255),!!r){for(let o=3;o<31;o=o+7){const s=t>>>o,c=!!(s>>>7),u=(c?s|128:s)&255;if(e.push(u),!c)return}e.push(t>>>31&1)}}const Ho=4294967296;function Ka(i){const t=i[0]==="-";t&&(i=i.slice(1));const e=1e6;let n=0,r=0;function o(s,c){const u=Number(i.slice(s,c));r*=e,n=n*e+u,n>=Ho&&(r=r+(n/Ho|0),n=n%Ho)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),t?zl(n,r):Ta(n,r)}function ac(i,t){let e=Ta(i,t);const n=e.hi&2147483648;n&&(e=zl(e.lo,e.hi));const r=$l(e.lo,e.hi);return n?"-"+r:r}function $l(i,t){if({lo:i,hi:t}=lc(i,t),t<=2097151)return String(Ho*t+i);const e=i&16777215,n=(i>>>24|t<<8)&16777215,r=t>>16&65535;let o=e+n*6777216+r*6710656,s=n+r*8147497,c=r*2;const u=1e7;return o>=u&&(s+=Math.floor(o/u),o%=u),s>=u&&(c+=Math.floor(s/u),s%=u),c.toString()+Ha(s)+Ha(o)}function lc(i,t){return{lo:i>>>0,hi:t>>>0}}function Ta(i,t){return{lo:i|0,hi:t|0}}function zl(i,t){return t=~t,i?i=~i+1:t+=1,Ta(i,t)}const Ha=i=>{const t=String(i);return"0000000".slice(t.length)+t};function Wa(i,t){if(i>=0){for(;i>127;)t.push(i&127|128),i=i>>>7;t.push(i)}else{for(let e=0;e<9;e++)t.push(i&127|128),i=i>>7;t.push(1)}}function uc(){let i=this.buf[this.pos++],t=i&127;if(!(i&128))return this.assertBounds(),t;if(i=this.buf[this.pos++],t|=(i&127)<<7,!(i&128))return this.assertBounds(),t;if(i=this.buf[this.pos++],t|=(i&127)<<14,!(i&128))return this.assertBounds(),t;if(i=this.buf[this.pos++],t|=(i&127)<<21,!(i&128))return this.assertBounds(),t;i=this.buf[this.pos++],t|=(i&15)<<28;for(let e=5;i&128&&e<10;e++)i=this.buf[this.pos++];if(i&128)throw new Error("invalid varint");return this.assertBounds(),t>>>0}var Ga={};function cc(){const i=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof i.getBigInt64=="function"&&typeof i.getBigUint64=="function"&&typeof i.setBigInt64=="function"&&typeof i.setBigUint64=="function"&&(typeof process!="object"||typeof Ga!="object"||Ga.BUF_BIGINT_DISABLE!=="1")){const r=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),s=BigInt("0"),c=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(u){const d=typeof u=="bigint"?u:BigInt(u);if(d>o||d<r)throw new Error(`int64 invalid: ${u}`);return d},uParse(u){const d=typeof u=="bigint"?u:BigInt(u);if(d>c||d<s)throw new Error(`uint64 invalid: ${u}`);return d},enc(u){return i.setBigInt64(0,this.parse(u),!0),{lo:i.getInt32(0,!0),hi:i.getInt32(4,!0)}},uEnc(u){return i.setBigInt64(0,this.uParse(u),!0),{lo:i.getInt32(0,!0),hi:i.getInt32(4,!0)}},dec(u,d){return i.setInt32(0,u,!0),i.setInt32(4,d,!0),i.getBigInt64(0,!0)},uDec(u,d){return i.setInt32(0,u,!0),i.setInt32(4,d,!0),i.getBigUint64(0,!0)}}}const e=r=>tt(/^-?[0-9]+$/.test(r),`int64 invalid: ${r}`),n=r=>tt(/^[0-9]+$/.test(r),`uint64 invalid: ${r}`);return{zero:"0",supported:!1,parse(r){return typeof r!="string"&&(r=r.toString()),e(r),r},uParse(r){return typeof r!="string"&&(r=r.toString()),n(r),r},enc(r){return typeof r!="string"&&(r=r.toString()),e(r),Ka(r)},uEnc(r){return typeof r!="string"&&(r=r.toString()),n(r),Ka(r)},dec(r,o){return ac(r,o)},uDec(r,o){return $l(r,o)}}}const Ye=cc();var ne;(function(i){i[i.DOUBLE=1]="DOUBLE",i[i.FLOAT=2]="FLOAT",i[i.INT64=3]="INT64",i[i.UINT64=4]="UINT64",i[i.INT32=5]="INT32",i[i.FIXED64=6]="FIXED64",i[i.FIXED32=7]="FIXED32",i[i.BOOL=8]="BOOL",i[i.STRING=9]="STRING",i[i.BYTES=12]="BYTES",i[i.UINT32=13]="UINT32",i[i.SFIXED32=15]="SFIXED32",i[i.SFIXED64=16]="SFIXED64",i[i.SINT32=17]="SINT32",i[i.SINT64=18]="SINT64"})(ne||(ne={}));var ci;(function(i){i[i.BIGINT=0]="BIGINT",i[i.STRING=1]="STRING"})(ci||(ci={}));function Xr(i,t,e){if(t===e)return!0;if(i==ne.BYTES){if(!(t instanceof Uint8Array)||!(e instanceof Uint8Array)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}switch(i){case ne.UINT64:case ne.FIXED64:case ne.INT64:case ne.SFIXED64:case ne.SINT64:return t==e}return!1}function Ji(i,t){switch(i){case ne.BOOL:return!1;case ne.UINT64:case ne.FIXED64:case ne.INT64:case ne.SFIXED64:case ne.SINT64:return t==0?Ye.zero:"0";case ne.DOUBLE:case ne.FLOAT:return 0;case ne.BYTES:return new Uint8Array(0);case ne.STRING:return"";default:return 0}}function Vl(i,t){switch(i){case ne.BOOL:return t===!1;case ne.STRING:return t==="";case ne.BYTES:return t instanceof Uint8Array&&!t.byteLength;default:return t==0}}var st;(function(i){i[i.Varint=0]="Varint",i[i.Bit64=1]="Bit64",i[i.LengthDelimited=2]="LengthDelimited",i[i.StartGroup=3]="StartGroup",i[i.EndGroup=4]="EndGroup",i[i.Bit32=5]="Bit32"})(st||(st={}));class fc{constructor(t){this.stack=[],this.textEncoder=t??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let t=0;for(let r=0;r<this.chunks.length;r++)t+=this.chunks[r].length;let e=new Uint8Array(t),n=0;for(let r=0;r<this.chunks.length;r++)e.set(this.chunks[r],n),n+=this.chunks[r].length;return this.chunks=[],e}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let t=this.finish(),e=this.stack.pop();if(!e)throw new Error("invalid state, fork stack empty");return this.chunks=e.chunks,this.buf=e.buf,this.uint32(t.byteLength),this.raw(t)}tag(t,e){return this.uint32((t<<3|e)>>>0)}raw(t){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(t),this}uint32(t){for(Ks(t);t>127;)this.buf.push(t&127|128),t=t>>>7;return this.buf.push(t),this}int32(t){return Ko(t),Wa(t,this.buf),this}bool(t){return this.buf.push(t?1:0),this}bytes(t){return this.uint32(t.byteLength),this.raw(t)}string(t){let e=this.textEncoder.encode(t);return this.uint32(e.byteLength),this.raw(e)}float(t){Ml(t);let e=new Uint8Array(4);return new DataView(e.buffer).setFloat32(0,t,!0),this.raw(e)}double(t){let e=new Uint8Array(8);return new DataView(e.buffer).setFloat64(0,t,!0),this.raw(e)}fixed32(t){Ks(t);let e=new Uint8Array(4);return new DataView(e.buffer).setUint32(0,t,!0),this.raw(e)}sfixed32(t){Ko(t);let e=new Uint8Array(4);return new DataView(e.buffer).setInt32(0,t,!0),this.raw(e)}sint32(t){return Ko(t),t=(t<<1^t>>31)>>>0,Wa(t,this.buf),this}sfixed64(t){let e=new Uint8Array(8),n=new DataView(e.buffer),r=Ye.enc(t);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(e)}fixed64(t){let e=new Uint8Array(8),n=new DataView(e.buffer),r=Ye.uEnc(t);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(e)}int64(t){let e=Ye.enc(t);return Ds(e.lo,e.hi,this.buf),this}sint64(t){let e=Ye.enc(t),n=e.hi>>31,r=e.lo<<1^n,o=(e.hi<<1|e.lo>>>31)^n;return Ds(r,o,this.buf),this}uint64(t){let e=Ye.uEnc(t);return Ds(e.lo,e.hi,this.buf),this}}class hc{constructor(t,e){this.varint64=sc,this.uint32=uc,this.buf=t,this.len=t.length,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.textDecoder=e??new TextDecoder}tag(){let t=this.uint32(),e=t>>>3,n=t&7;if(e<=0||n<0||n>5)throw new Error("illegal tag: field no "+e+" wire type "+n);return[e,n]}skip(t,e){let n=this.pos;switch(t){case st.Varint:for(;this.buf[this.pos++]&128;);break;case st.Bit64:this.pos+=4;case st.Bit32:this.pos+=4;break;case st.LengthDelimited:let r=this.uint32();this.pos+=r;break;case st.StartGroup:for(;;){const[o,s]=this.tag();if(s===st.EndGroup){if(e!==void 0&&o!==e)throw new Error("invalid end group tag");break}this.skip(s,o)}break;default:throw new Error("cant skip wire type "+t)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)}int64(){return Ye.dec(...this.varint64())}uint64(){return Ye.uDec(...this.varint64())}sint64(){let[t,e]=this.varint64(),n=-(t&1);return t=(t>>>1|(e&1)<<31)^n,e=e>>>1^n,Ye.dec(t,e)}bool(){let[t,e]=this.varint64();return t!==0||e!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Ye.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Ye.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let t=this.uint32(),e=this.pos;return this.pos+=t,this.assertBounds(),this.buf.subarray(e,e+t)}string(){return this.textDecoder.decode(this.bytes())}}function dc(i,t,e,n){let r;return{typeName:t,extendee:e,get field(){if(!r){const o=typeof n=="function"?n():n;o.name=t.split(".").pop(),o.jsonName=`[${t}]`,r=i.util.newFieldList([o]).list()[0]}return r},runtime:i}}function Kl(i){const t=i.field.localName,e=Object.create(null);return e[t]=gc(i),[e,()=>e[t]]}function gc(i){const t=i.field;if(t.repeated)return[];if(t.default!==void 0)return t.default;switch(t.kind){case"enum":return t.T.values[0].no;case"scalar":return Ji(t.T,t.L);case"message":const e=t.T,n=new e;return e.fieldWrapper?e.fieldWrapper.unwrapField(n):n;case"map":throw"map fields are not allowed to be extensions"}}function pc(i,t){if(!t.repeated&&(t.kind=="enum"||t.kind=="scalar")){for(let e=i.length-1;e>=0;--e)if(i[e].no==t.no)return[i[e]];return[]}return i.filter(e=>e.no===t.no)}let Mr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Es=[];for(let i=0;i<Mr.length;i++)Es[Mr[i].charCodeAt(0)]=i;Es[45]=Mr.indexOf("+");Es[95]=Mr.indexOf("/");const Aa={dec(i){let t=i.length*3/4;i[i.length-2]=="="?t-=2:i[i.length-1]=="="&&(t-=1);let e=new Uint8Array(t),n=0,r=0,o,s=0;for(let c=0;c<i.length;c++){if(o=Es[i.charCodeAt(c)],o===void 0)switch(i[c]){case"=":r=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(r){case 0:s=o,r=1;break;case 1:e[n++]=s<<2|(o&48)>>4,s=o,r=2;break;case 2:e[n++]=(s&15)<<4|(o&60)>>2,s=o,r=3;break;case 3:e[n++]=(s&3)<<6|o,r=0;break}}if(r==1)throw Error("invalid base64 string.");return e.subarray(0,n)},enc(i){let t="",e=0,n,r=0;for(let o=0;o<i.length;o++)switch(n=i[o],e){case 0:t+=Mr[n>>2],r=(n&3)<<4,e=1;break;case 1:t+=Mr[r|n>>4],r=(n&15)<<2,e=2;break;case 2:t+=Mr[r|n>>6],t+=Mr[n&63],e=0;break}return e&&(t+=Mr[r],t+="=",e==1&&(t+="=")),t}};function mc(i,t,e){Wl(t,i);const n=t.runtime.bin.makeReadOptions(e),r=pc(i.getType().runtime.bin.listUnknownFields(i),t.field),[o,s]=Kl(t);for(const c of r)t.runtime.bin.readField(o,n.readerFactory(c.data),t.field,c.wireType,n);return s()}function yc(i,t,e,n){Wl(t,i);const r=t.runtime.bin.makeReadOptions(n),o=t.runtime.bin.makeWriteOptions(n);if(Hl(i,t)){const d=i.getType().runtime.bin.listUnknownFields(i).filter(m=>m.no!=t.field.no);i.getType().runtime.bin.discardUnknownFields(i);for(const m of d)i.getType().runtime.bin.onUnknownField(i,m.no,m.wireType,m.data)}const s=o.writerFactory();let c=t.field;!c.opt&&!c.repeated&&(c.kind=="enum"||c.kind=="scalar")&&(c=Object.assign(Object.assign({},t.field),{opt:!0})),t.runtime.bin.writeField(c,e,s,o);const u=r.readerFactory(s.finish());for(;u.pos<u.len;){const[d,m]=u.tag(),h=u.skip(m,d);i.getType().runtime.bin.onUnknownField(i,d,m,h)}}function Hl(i,t){const e=i.getType();return t.extendee.typeName===e.typeName&&!!e.runtime.bin.listUnknownFields(i).find(n=>n.no==t.field.no)}function Wl(i,t){tt(i.extendee.typeName==t.getType().typeName,`extension ${i.typeName} can only be applied to message ${i.extendee.typeName}`)}function Gl(i,t){const e=i.localName;if(i.repeated)return t[e].length>0;if(i.oneof)return t[i.oneof.localName].case===e;switch(i.kind){case"enum":case"scalar":return i.opt||i.req?t[e]!==void 0:i.kind=="enum"?t[e]!==i.T.values[0].no:!Vl(i.T,t[e]);case"message":return t[e]!==void 0;case"map":return Object.keys(t[e]).length>0}}function Ya(i,t){const e=i.localName,n=!i.opt&&!i.req;if(i.repeated)t[e]=[];else if(i.oneof)t[i.oneof.localName]={case:void 0};else switch(i.kind){case"map":t[e]={};break;case"enum":t[e]=n?i.T.values[0].no:void 0;break;case"scalar":t[e]=n?Ji(i.T,i.L):void 0;break;case"message":t[e]=void 0;break}}function Si(i,t){if(i===null||typeof i!="object"||!Object.getOwnPropertyNames(fe.prototype).every(n=>n in i&&typeof i[n]=="function"))return!1;const e=i.getType();return e===null||typeof e!="function"||!("typeName"in e)||typeof e.typeName!="string"?!1:t===void 0?!0:e.typeName==t.typeName}function Yl(i,t){return Si(t)||!i.fieldWrapper?t:i.fieldWrapper.wrapField(t)}ne.DOUBLE,ne.FLOAT,ne.INT64,ne.UINT64,ne.INT32,ne.UINT32,ne.BOOL,ne.STRING,ne.BYTES;const Za={ignoreUnknownFields:!1},Xa={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function vc(i){return i?Object.assign(Object.assign({},Za),i):Za}function bc(i){return i?Object.assign(Object.assign({},Xa),i):Xa}const es=Symbol(),Wo=Symbol();function wc(){return{makeReadOptions:vc,makeWriteOptions:bc,readMessage(i,t,e,n){if(t==null||Array.isArray(t)||typeof t!="object")throw new Error(`cannot decode message ${i.typeName} from JSON: ${Tn(t)}`);n=n??new i;const r=new Map,o=e.typeRegistry;for(const[s,c]of Object.entries(t)){const u=i.fields.findJsonName(s);if(u){if(u.oneof){if(c===null&&u.kind=="scalar")continue;const d=r.get(u.oneof);if(d!==void 0)throw new Error(`cannot decode message ${i.typeName} from JSON: multiple keys for oneof "${u.oneof.name}" present: "${d}", "${s}"`);r.set(u.oneof,s)}Qa(n,c,u,e,i)}else{let d=!1;if(o!=null&&o.findExtension&&s.startsWith("[")&&s.endsWith("]")){const m=o.findExtension(s.substring(1,s.length-1));if(m&&m.extendee.typeName==i.typeName){d=!0;const[h,l]=Kl(m);Qa(h,c,m.field,e,m),yc(n,m,l(),e)}}if(!d&&!e.ignoreUnknownFields)throw new Error(`cannot decode message ${i.typeName} from JSON: key "${s}" is unknown`)}}return n},writeMessage(i,t){const e=i.getType(),n={};let r;try{for(r of e.fields.byNumber()){if(!Gl(r,i)){if(r.req)throw"required field not set";if(!t.emitDefaultValues||!Ac(r))continue}const s=r.oneof?i[r.oneof.localName].value:i[r.localName],c=el(r,s,t);c!==void 0&&(n[t.useProtoFieldName?r.name:r.jsonName]=c)}const o=t.typeRegistry;if(o!=null&&o.findExtensionFor)for(const s of e.runtime.bin.listUnknownFields(i)){const c=o.findExtensionFor(e.typeName,s.no);if(c&&Hl(i,c)){const u=mc(i,c,t),d=el(c.field,u,t);d!==void 0&&(n[c.field.jsonName]=d)}}}catch(o){const s=r?`cannot encode field ${e.typeName}.${r.name} to JSON`:`cannot encode message ${e.typeName} to JSON`,c=o instanceof Error?o.message:String(o);throw new Error(s+(c.length>0?`: ${c}`:""))}return n},readScalar(i,t,e){return lo(i,t,e??ci.BIGINT,!0)},writeScalar(i,t,e){if(t!==void 0&&(e||Vl(i,t)))return Go(i,t)},debug:Tn}}function Tn(i){if(i===null)return"null";switch(typeof i){case"object":return Array.isArray(i)?"array":"object";case"string":return i.length>100?"string":`"${i.split('"').join('\\"')}"`;default:return String(i)}}function Qa(i,t,e,n,r){let o=e.localName;if(e.repeated){if(tt(e.kind!="map"),t===null)return;if(!Array.isArray(t))throw new Error(`cannot decode field ${r.typeName}.${e.name} from JSON: ${Tn(t)}`);const s=i[o];for(const c of t){if(c===null)throw new Error(`cannot decode field ${r.typeName}.${e.name} from JSON: ${Tn(c)}`);switch(e.kind){case"message":s.push(e.T.fromJson(c,n));break;case"enum":const u=Bs(e.T,c,n.ignoreUnknownFields,!0);u!==Wo&&s.push(u);break;case"scalar":try{s.push(lo(e.T,c,e.L,!0))}catch(d){let m=`cannot decode field ${r.typeName}.${e.name} from JSON: ${Tn(c)}`;throw d instanceof Error&&d.message.length>0&&(m+=`: ${d.message}`),new Error(m)}break}}}else if(e.kind=="map"){if(t===null)return;if(typeof t!="object"||Array.isArray(t))throw new Error(`cannot decode field ${r.typeName}.${e.name} from JSON: ${Tn(t)}`);const s=i[o];for(const[c,u]of Object.entries(t)){if(u===null)throw new Error(`cannot decode field ${r.typeName}.${e.name} from JSON: map value null`);let d;try{d=Tc(e.K,c)}catch(m){let h=`cannot decode map key for field ${r.typeName}.${e.name} from JSON: ${Tn(t)}`;throw m instanceof Error&&m.message.length>0&&(h+=`: ${m.message}`),new Error(h)}switch(e.V.kind){case"message":s[d]=e.V.T.fromJson(u,n);break;case"enum":const m=Bs(e.V.T,u,n.ignoreUnknownFields,!0);m!==Wo&&(s[d]=m);break;case"scalar":try{s[d]=lo(e.V.T,u,ci.BIGINT,!0)}catch(h){let l=`cannot decode map value for field ${r.typeName}.${e.name} from JSON: ${Tn(t)}`;throw h instanceof Error&&h.message.length>0&&(l+=`: ${h.message}`),new Error(l)}break}}}else switch(e.oneof&&(i=i[e.oneof.localName]={case:o},o="value"),e.kind){case"message":const s=e.T;if(t===null&&s.typeName!="google.protobuf.Value")return;let c=i[o];Si(c)?c.fromJson(t,n):(i[o]=c=s.fromJson(t,n),s.fieldWrapper&&!e.oneof&&(i[o]=s.fieldWrapper.unwrapField(c)));break;case"enum":const u=Bs(e.T,t,n.ignoreUnknownFields,!1);switch(u){case es:Ya(e,i);break;case Wo:break;default:i[o]=u;break}break;case"scalar":try{const d=lo(e.T,t,e.L,!1);switch(d){case es:Ya(e,i);break;default:i[o]=d;break}}catch(d){let m=`cannot decode field ${r.typeName}.${e.name} from JSON: ${Tn(t)}`;throw d instanceof Error&&d.message.length>0&&(m+=`: ${d.message}`),new Error(m)}break}}function Tc(i,t){if(i===ne.BOOL)switch(t){case"true":t=!0;break;case"false":t=!1;break}return lo(i,t,ci.BIGINT,!0).toString()}function lo(i,t,e,n){if(t===null)return n?Ji(i,e):es;switch(i){case ne.DOUBLE:case ne.FLOAT:if(t==="NaN")return Number.NaN;if(t==="Infinity")return Number.POSITIVE_INFINITY;if(t==="-Infinity")return Number.NEGATIVE_INFINITY;if(t===""||typeof t=="string"&&t.trim().length!==t.length||typeof t!="string"&&typeof t!="number")break;const r=Number(t);if(Number.isNaN(r)||!Number.isFinite(r))break;return i==ne.FLOAT&&Ml(r),r;case ne.INT32:case ne.FIXED32:case ne.SFIXED32:case ne.SINT32:case ne.UINT32:let o;if(typeof t=="number"?o=t:typeof t=="string"&&t.length>0&&t.trim().length===t.length&&(o=Number(t)),o===void 0)break;return i==ne.UINT32||i==ne.FIXED32?Ks(o):Ko(o),o;case ne.INT64:case ne.SFIXED64:case ne.SINT64:if(typeof t!="number"&&typeof t!="string")break;const s=Ye.parse(t);return e?s.toString():s;case ne.FIXED64:case ne.UINT64:if(typeof t!="number"&&typeof t!="string")break;const c=Ye.uParse(t);return e?c.toString():c;case ne.BOOL:if(typeof t!="boolean")break;return t;case ne.STRING:if(typeof t!="string")break;try{encodeURIComponent(t)}catch{throw new Error("invalid UTF8")}return t;case ne.BYTES:if(t==="")return new Uint8Array(0);if(typeof t!="string")break;return Aa.dec(t)}throw new Error}function Bs(i,t,e,n){if(t===null)return i.typeName=="google.protobuf.NullValue"?0:n?i.values[0].no:es;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const r=i.findName(t);if(r!==void 0)return r.no;if(e)return Wo;break}throw new Error(`cannot decode enum ${i.typeName} from JSON: ${Tn(t)}`)}function Ac(i){return i.repeated||i.kind=="map"?!0:!(i.oneof||i.kind=="message"||i.opt||i.req)}function el(i,t,e){if(i.kind=="map"){tt(typeof t=="object"&&t!=null);const n={},r=Object.entries(t);switch(i.V.kind){case"scalar":for(const[s,c]of r)n[s.toString()]=Go(i.V.T,c);break;case"message":for(const[s,c]of r)n[s.toString()]=c.toJson(e);break;case"enum":const o=i.V.T;for(const[s,c]of r)n[s.toString()]=qs(o,c,e.enumAsInteger);break}return e.emitDefaultValues||r.length>0?n:void 0}if(i.repeated){tt(Array.isArray(t));const n=[];switch(i.kind){case"scalar":for(let r=0;r<t.length;r++)n.push(Go(i.T,t[r]));break;case"enum":for(let r=0;r<t.length;r++)n.push(qs(i.T,t[r],e.enumAsInteger));break;case"message":for(let r=0;r<t.length;r++)n.push(t[r].toJson(e));break}return e.emitDefaultValues||n.length>0?n:void 0}switch(i.kind){case"scalar":return Go(i.T,t);case"enum":return qs(i.T,t,e.enumAsInteger);case"message":return Yl(i.T,t).toJson(e)}}function qs(i,t,e){var n;if(tt(typeof t=="number"),i.typeName=="google.protobuf.NullValue")return null;if(e)return t;const r=i.findNumber(t);return(n=r==null?void 0:r.name)!==null&&n!==void 0?n:t}function Go(i,t){switch(i){case ne.INT32:case ne.SFIXED32:case ne.SINT32:case ne.FIXED32:case ne.UINT32:return tt(typeof t=="number"),t;case ne.FLOAT:case ne.DOUBLE:return tt(typeof t=="number"),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t;case ne.STRING:return tt(typeof t=="string"),t;case ne.BOOL:return tt(typeof t=="boolean"),t;case ne.UINT64:case ne.FIXED64:case ne.INT64:case ne.SFIXED64:case ne.SINT64:return tt(typeof t=="bigint"||typeof t=="string"||typeof t=="number"),t.toString();case ne.BYTES:return tt(t instanceof Uint8Array),Aa.enc(t)}}const Li=Symbol("@bufbuild/protobuf/unknown-fields"),tl={readUnknownFields:!0,readerFactory:i=>new hc(i)},nl={writeUnknownFields:!0,writerFactory:()=>new fc};function Sc(i){return i?Object.assign(Object.assign({},tl),i):tl}function Ec(i){return i?Object.assign(Object.assign({},nl),i):nl}function xc(){return{makeReadOptions:Sc,makeWriteOptions:Ec,listUnknownFields(i){var t;return(t=i[Li])!==null&&t!==void 0?t:[]},discardUnknownFields(i){delete i[Li]},writeUnknownFields(i,t){const n=i[Li];if(n)for(const r of n)t.tag(r.no,r.wireType).raw(r.data)},onUnknownField(i,t,e,n){const r=i;Array.isArray(r[Li])||(r[Li]=[]),r[Li].push({no:t,wireType:e,data:n})},readMessage(i,t,e,n,r){const o=i.getType(),s=r?t.len:t.pos+e;let c,u;for(;t.pos<s&&([c,u]=t.tag(),!(r===!0&&u==st.EndGroup));){const d=o.fields.find(c);if(!d){const m=t.skip(u,c);n.readUnknownFields&&this.onUnknownField(i,c,u,m);continue}rl(i,t,d,u,n)}if(r&&(u!=st.EndGroup||c!==e))throw new Error("invalid end group tag")},readField:rl,writeMessage(i,t,e){const n=i.getType();for(const r of n.fields.byNumber()){if(!Gl(r,i)){if(r.req)throw new Error(`cannot encode field ${n.typeName}.${r.name} to binary: required field not set`);continue}const o=r.oneof?i[r.oneof.localName].value:i[r.localName];il(r,o,t,e)}return e.writeUnknownFields&&this.writeUnknownFields(i,t),t},writeField(i,t,e,n){t!==void 0&&il(i,t,e,n)}}}function rl(i,t,e,n,r){let{repeated:o,localName:s}=e;switch(e.oneof&&(i=i[e.oneof.localName],i.case!=s&&delete i.value,i.case=s,s="value"),e.kind){case"scalar":case"enum":const c=e.kind=="enum"?ne.INT32:e.T;let u=ts;if(e.kind=="scalar"&&e.L>0&&(u=kc),o){let l=i[s];if(n==st.LengthDelimited&&c!=ne.STRING&&c!=ne.BYTES){let v=t.uint32()+t.pos;for(;t.pos<v;)l.push(u(t,c))}else l.push(u(t,c))}else i[s]=u(t,c);break;case"message":const d=e.T;o?i[s].push(Yo(t,new d,r,e)):Si(i[s])?Yo(t,i[s],r,e):(i[s]=Yo(t,new d,r,e),d.fieldWrapper&&!e.oneof&&!e.repeated&&(i[s]=d.fieldWrapper.unwrapField(i[s])));break;case"map":let[m,h]=Oc(e,t,r);i[s][m]=h;break}}function Yo(i,t,e,n){const r=t.getType().runtime.bin,o=n==null?void 0:n.delimited;return r.readMessage(t,i,o?n.no:i.uint32(),e,o),t}function Oc(i,t,e){const n=t.uint32(),r=t.pos+n;let o,s;for(;t.pos<r;){const[c]=t.tag();switch(c){case 1:o=ts(t,i.K);break;case 2:switch(i.V.kind){case"scalar":s=ts(t,i.V.T);break;case"enum":s=t.int32();break;case"message":s=Yo(t,new i.V.T,e,void 0);break}break}}if(o===void 0&&(o=Ji(i.K,ci.BIGINT)),typeof o!="string"&&typeof o!="number"&&(o=o.toString()),s===void 0)switch(i.V.kind){case"scalar":s=Ji(i.V.T,ci.BIGINT);break;case"enum":s=i.V.T.values[0].no;break;case"message":s=new i.V.T;break}return[o,s]}function kc(i,t){const e=ts(i,t);return typeof e=="bigint"?e.toString():e}function ts(i,t){switch(t){case ne.STRING:return i.string();case ne.BOOL:return i.bool();case ne.DOUBLE:return i.double();case ne.FLOAT:return i.float();case ne.INT32:return i.int32();case ne.INT64:return i.int64();case ne.UINT64:return i.uint64();case ne.FIXED64:return i.fixed64();case ne.BYTES:return i.bytes();case ne.FIXED32:return i.fixed32();case ne.SFIXED32:return i.sfixed32();case ne.SFIXED64:return i.sfixed64();case ne.SINT64:return i.sint64();case ne.UINT32:return i.uint32();case ne.SINT32:return i.sint32()}}function il(i,t,e,n){tt(t!==void 0);const r=i.repeated;switch(i.kind){case"scalar":case"enum":let o=i.kind=="enum"?ne.INT32:i.T;if(r)if(tt(Array.isArray(t)),i.packed)Nc(e,o,i.no,t);else for(const s of t)uo(e,o,i.no,s);else uo(e,o,i.no,t);break;case"message":if(r){tt(Array.isArray(t));for(const s of t)ol(e,n,i,s)}else ol(e,n,i,t);break;case"map":tt(typeof t=="object"&&t!=null);for(const[s,c]of Object.entries(t))Ic(e,n,i,s,c);break}}function Ic(i,t,e,n,r){i.tag(e.no,st.LengthDelimited),i.fork();let o=n;switch(e.K){case ne.INT32:case ne.FIXED32:case ne.UINT32:case ne.SFIXED32:case ne.SINT32:o=Number.parseInt(n);break;case ne.BOOL:tt(n=="true"||n=="false"),o=n=="true";break}switch(uo(i,e.K,1,o),e.V.kind){case"scalar":uo(i,e.V.T,2,r);break;case"enum":uo(i,ne.INT32,2,r);break;case"message":tt(r!==void 0),i.tag(2,st.LengthDelimited).bytes(r.toBinary(t));break}i.join()}function ol(i,t,e,n){const r=Yl(e.T,n);e.delimited?i.tag(e.no,st.StartGroup).raw(r.toBinary(t)).tag(e.no,st.EndGroup):i.tag(e.no,st.LengthDelimited).bytes(r.toBinary(t))}function uo(i,t,e,n){tt(n!==void 0);let[r,o]=Zl(t);i.tag(e,r)[o](n)}function Nc(i,t,e,n){if(!n.length)return;i.tag(e,st.LengthDelimited).fork();let[,r]=Zl(t);for(let o=0;o<n.length;o++)i[r](n[o]);i.join()}function Zl(i){let t=st.Varint;switch(i){case ne.BYTES:case ne.STRING:t=st.LengthDelimited;break;case ne.DOUBLE:case ne.FIXED64:case ne.SFIXED64:t=st.Bit64;break;case ne.FIXED32:case ne.SFIXED32:case ne.FLOAT:t=st.Bit32;break}const e=ne[i].toLowerCase();return[t,e]}function _c(){return{setEnumType:Fl,initPartial(i,t){if(i===void 0)return;const e=t.getType();for(const n of e.fields.byMember()){const r=n.localName,o=t,s=i;if(s[r]!=null)switch(n.kind){case"oneof":const c=s[r].case;if(c===void 0)continue;const u=n.findField(c);let d=s[r].value;u&&u.kind=="message"&&!Si(d,u.T)?d=new u.T(d):u&&u.kind==="scalar"&&u.T===ne.BYTES&&(d=ro(d)),o[r]={case:c,value:d};break;case"scalar":case"enum":let m=s[r];n.T===ne.BYTES&&(m=n.repeated?m.map(ro):ro(m)),o[r]=m;break;case"map":switch(n.V.kind){case"scalar":case"enum":if(n.V.T===ne.BYTES)for(const[a,v]of Object.entries(s[r]))o[r][a]=ro(v);else Object.assign(o[r],s[r]);break;case"message":const l=n.V.T;for(const a of Object.keys(s[r])){let v=s[r][a];l.fieldWrapper||(v=new l(v)),o[r][a]=v}break}break;case"message":const h=n.T;if(n.repeated)o[r]=s[r].map(l=>Si(l,h)?l:new h(l));else{const l=s[r];h.fieldWrapper?h.typeName==="google.protobuf.BytesValue"?o[r]=ro(l):o[r]=l:o[r]=Si(l,h)?l:new h(l)}break}}},equals(i,t,e){return t===e?!0:!t||!e?!1:i.fields.byMember().every(n=>{const r=t[n.localName],o=e[n.localName];if(n.repeated){if(r.length!==o.length)return!1;switch(n.kind){case"message":return r.every((s,c)=>n.T.equals(s,o[c]));case"scalar":return r.every((s,c)=>Xr(n.T,s,o[c]));case"enum":return r.every((s,c)=>Xr(ne.INT32,s,o[c]))}throw new Error(`repeated cannot contain ${n.kind}`)}switch(n.kind){case"message":return n.T.equals(r,o);case"enum":return Xr(ne.INT32,r,o);case"scalar":return Xr(n.T,r,o);case"oneof":if(r.case!==o.case)return!1;const s=n.findField(r.case);if(s===void 0)return!0;switch(s.kind){case"message":return s.T.equals(r.value,o.value);case"enum":return Xr(ne.INT32,r.value,o.value);case"scalar":return Xr(s.T,r.value,o.value)}throw new Error(`oneof cannot contain ${s.kind}`);case"map":const c=Object.keys(r).concat(Object.keys(o));switch(n.V.kind){case"message":const u=n.V.T;return c.every(m=>u.equals(r[m],o[m]));case"enum":return c.every(m=>Xr(ne.INT32,r[m],o[m]));case"scalar":const d=n.V.T;return c.every(m=>Xr(d,r[m],o[m]))}break}})},clone(i){const t=i.getType(),e=new t,n=e;for(const r of t.fields.byMember()){const o=i[r.localName];let s;if(r.repeated)s=o.map(Fo);else if(r.kind=="map"){s=n[r.localName];for(const[c,u]of Object.entries(o))s[c]=Fo(u)}else r.kind=="oneof"?s=r.findField(o.case)?{case:o.case,value:Fo(o.value)}:{case:void 0}:s=Fo(o);n[r.localName]=s}for(const r of t.runtime.bin.listUnknownFields(i))t.runtime.bin.onUnknownField(n,r.no,r.wireType,r.data);return e}}}function Fo(i){if(i===void 0)return i;if(Si(i))return i.clone();if(i instanceof Uint8Array){const t=new Uint8Array(i.byteLength);return t.set(i),t}return i}function ro(i){return i instanceof Uint8Array?i:new Uint8Array(i)}function Pc(i,t,e){return{syntax:i,json:wc(),bin:xc(),util:Object.assign(Object.assign({},_c()),{newFieldList:t,initFields:e}),makeMessageType(n,r,o){return oc(this,n,r,o)},makeEnum:ic,makeEnumType:Ul,getEnumType:rc,makeExtension(n,r,o){return dc(this,n,r,o)}}}class Cc{constructor(t,e){this._fields=t,this._normalizer=e}findJsonName(t){if(!this.jsonNames){const e={};for(const n of this.list())e[n.jsonName]=e[n.name]=n;this.jsonNames=e}return this.jsonNames[t]}find(t){if(!this.numbers){const e={};for(const n of this.list())e[n.no]=n;this.numbers=e}return this.numbers[t]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((t,e)=>t.no-e.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const t=this.members;let e;for(const n of this.list())n.oneof?n.oneof!==e&&(e=n.oneof,t.push(e)):t.push(n)}return this.members}}function Xl(i,t){const e=Ql(i);return t?e:Mc(qc(e))}function Lc(i){return Xl(i,!1)}const Rc=Ql;function Ql(i){let t=!1;const e=[];for(let n=0;n<i.length;n++){let r=i.charAt(n);switch(r){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":e.push(r),t=!1;break;default:t&&(t=!1,r=r.toUpperCase()),e.push(r);break}}return e.join("")}const Dc=new Set(["constructor","toString","toJSON","valueOf"]),Bc=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),eu=i=>`${i}$`,qc=i=>Bc.has(i)?eu(i):i,Mc=i=>Dc.has(i)?eu(i):i;class jc{constructor(t){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=t,this.localName=Lc(t)}addField(t){tt(t.oneof===this,`field ${t.name} not one of ${this.name}`),this.fields.push(t)}findField(t){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[t]}}function Fc(i,t){var e,n,r,o,s,c;const u=[];let d;for(const m of typeof i=="function"?i():i){const h=m;if(h.localName=Xl(m.name,m.oneof!==void 0),h.jsonName=(e=m.jsonName)!==null&&e!==void 0?e:Rc(m.name),h.repeated=(n=m.repeated)!==null&&n!==void 0?n:!1,m.kind=="scalar"&&(h.L=(r=m.L)!==null&&r!==void 0?r:ci.BIGINT),h.delimited=(o=m.delimited)!==null&&o!==void 0?o:!1,h.req=(s=m.req)!==null&&s!==void 0?s:!1,h.opt=(c=m.opt)!==null&&c!==void 0?c:!1,m.packed===void 0&&(h.packed=m.kind=="enum"||m.kind=="scalar"&&m.T!=ne.BYTES&&m.T!=ne.STRING),m.oneof!==void 0){const l=typeof m.oneof=="string"?m.oneof:m.oneof.name;(!d||d.name!=l)&&(d=new jc(l)),h.oneof=d,d.addField(h)}u.push(h)}return u}const L=Pc("proto3",i=>new Cc(i,t=>Fc(t)),i=>{for(const t of i.getType().fields.byMember()){if(t.opt)continue;const e=t.localName,n=i;if(t.repeated){n[e]=[];continue}switch(t.kind){case"oneof":n[e]={case:void 0};break;case"enum":n[e]=0;break;case"map":n[e]={};break;case"scalar":n[e]=Ji(t.T,t.L);break}}});var mt;(function(i){i[i.Unary=0]="Unary",i[i.ServerStreaming=1]="ServerStreaming",i[i.ClientStreaming=2]="ClientStreaming",i[i.BiDiStreaming=3]="BiDiStreaming"})(mt||(mt={}));var sl;(function(i){i[i.NoSideEffects=1]="NoSideEffects",i[i.Idempotent=2]="Idempotent"})(sl||(sl={}));class gt extends fe{constructor(t){super(),this.seconds=Ye.zero,this.nanos=0,L.util.initPartial(t,this)}fromJson(t,e){if(typeof t!="string")throw new Error(`cannot decode google.protobuf.Timestamp from JSON: ${L.json.debug(t)}`);const n=t.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const r=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(r))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(r<Date.parse("0001-01-01T00:00:00Z")||r>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Ye.parse(r/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}toJson(t){const e=Number(this.seconds)*1e3;if(e<Date.parse("0001-01-01T00:00:00Z")||e>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let n="Z";if(this.nanos>0){const r=(this.nanos+1e9).toString().substring(1);r.substring(3)==="000000"?n="."+r.substring(0,3)+"Z":r.substring(6)==="000"?n="."+r.substring(0,6)+"Z":n="."+r+"Z"}return new Date(e).toISOString().replace(".000Z",n)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return gt.fromDate(new Date)}static fromDate(t){const e=t.getTime();return new gt({seconds:Ye.parse(Math.floor(e/1e3)),nanos:e%1e3*1e6})}static fromBinary(t,e){return new gt().fromBinary(t,e)}static fromJson(t,e){return new gt().fromJson(t,e)}static fromJsonString(t,e){return new gt().fromJsonString(t,e)}static equals(t,e){return L.util.equals(gt,t,e)}}gt.runtime=L;gt.typeName="google.protobuf.Timestamp";gt.fields=L.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);class jr extends fe{constructor(t){super(),this.seconds=Ye.zero,this.nanos=0,L.util.initPartial(t,this)}fromJson(t,e){if(typeof t!="string")throw new Error(`cannot decode google.protobuf.Duration from JSON: ${L.json.debug(t)}`);const n=t.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(n===null)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${L.json.debug(t)}`);const r=Number(n[1]);if(r>315576e6||r<-315576e6)throw new Error(`cannot decode google.protobuf.Duration from JSON: ${L.json.debug(t)}`);if(this.seconds=Ye.parse(r),typeof n[2]=="string"){const o=n[2]+"0".repeat(9-n[2].length);this.nanos=parseInt(o),(r<0||Object.is(r,-0))&&(this.nanos=-this.nanos)}return this}toJson(t){if(Number(this.seconds)>315576e6||Number(this.seconds)<-315576e6)throw new Error("cannot encode google.protobuf.Duration to JSON: value out of range");let e=this.seconds.toString();if(this.nanos!==0){let n=Math.abs(this.nanos).toString();n="0".repeat(9-n.length)+n,n.substring(3)==="000000"?n=n.substring(0,3):n.substring(6)==="000"&&(n=n.substring(0,6)),e+="."+n,this.nanos<0&&Number(this.seconds)==0&&(e="-"+e)}return e+"s"}static fromBinary(t,e){return new jr().fromBinary(t,e)}static fromJson(t,e){return new jr().fromJson(t,e)}static fromJsonString(t,e){return new jr().fromJsonString(t,e)}static equals(t,e){return L.util.equals(jr,t,e)}}jr.runtime=L;jr.typeName="google.protobuf.Duration";jr.fields=L.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);class An extends fe{constructor(t){super(),this.typeUrl="",this.value=new Uint8Array(0),L.util.initPartial(t,this)}toJson(t){var e;if(this.typeUrl==="")return{};const n=this.typeUrlToName(this.typeUrl),r=(e=t==null?void 0:t.typeRegistry)===null||e===void 0?void 0:e.findMessage(n);if(!r)throw new Error(`cannot encode message google.protobuf.Any to JSON: "${this.typeUrl}" is not in the type registry`);let s=r.fromBinary(this.value).toJson(t);return(n.startsWith("google.protobuf.")||s===null||Array.isArray(s)||typeof s!="object")&&(s={value:s}),s["@type"]=this.typeUrl,s}fromJson(t,e){var n;if(t===null||Array.isArray(t)||typeof t!="object")throw new Error(`cannot decode message google.protobuf.Any from JSON: expected object but got ${t===null?"null":Array.isArray(t)?"array":typeof t}`);if(Object.keys(t).length==0)return this;const r=t["@type"];if(typeof r!="string"||r=="")throw new Error('cannot decode message google.protobuf.Any from JSON: "@type" is empty');const o=this.typeUrlToName(r),s=(n=e==null?void 0:e.typeRegistry)===null||n===void 0?void 0:n.findMessage(o);if(!s)throw new Error(`cannot decode message google.protobuf.Any from JSON: ${r} is not in the type registry`);let c;if(o.startsWith("google.protobuf.")&&Object.prototype.hasOwnProperty.call(t,"value"))c=s.fromJson(t.value,e);else{const u=Object.assign({},t);delete u["@type"],c=s.fromJson(u,e)}return this.packFrom(c),this}packFrom(t){this.value=t.toBinary(),this.typeUrl=this.typeNameToUrl(t.getType().typeName)}unpackTo(t){return this.is(t.getType())?(t.fromBinary(this.value),!0):!1}unpack(t){if(this.typeUrl==="")return;const e=t.findMessage(this.typeUrlToName(this.typeUrl));if(e)return e.fromBinary(this.value)}is(t){if(this.typeUrl==="")return!1;const e=this.typeUrlToName(this.typeUrl);let n="";return typeof t=="string"?n=t:n=t.typeName,e===n}typeNameToUrl(t){return`type.googleapis.com/${t}`}typeUrlToName(t){if(!t.length)throw new Error(`invalid type url: ${t}`);const e=t.lastIndexOf("/"),n=e>=0?t.substring(e+1):t;if(!n.length)throw new Error(`invalid type url: ${t}`);return n}static pack(t){const e=new An;return e.packFrom(t),e}static fromBinary(t,e){return new An().fromBinary(t,e)}static fromJson(t,e){return new An().fromJson(t,e)}static fromJsonString(t,e){return new An().fromJsonString(t,e)}static equals(t,e){return L.util.equals(An,t,e)}}An.runtime=L;An.typeName="google.protobuf.Any";An.fields=L.util.newFieldList(()=>[{no:1,name:"type_url",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:12}]);class Sn extends fe{constructor(t){super(),this.value=0,L.util.initPartial(t,this)}toJson(t){return L.json.writeScalar(ne.DOUBLE,this.value,!0)}fromJson(t,e){try{this.value=L.json.readScalar(ne.DOUBLE,t)}catch(n){let r='cannot decode message google.protobuf.DoubleValue from JSON"';throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),new Error(r)}return this}static fromBinary(t,e){return new Sn().fromBinary(t,e)}static fromJson(t,e){return new Sn().fromJson(t,e)}static fromJsonString(t,e){return new Sn().fromJsonString(t,e)}static equals(t,e){return L.util.equals(Sn,t,e)}}Sn.runtime=L;Sn.typeName="google.protobuf.DoubleValue";Sn.fields=L.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:1}]);Sn.fieldWrapper={wrapField(i){return new Sn({value:i})},unwrapField(i){return i.value}};class En extends fe{constructor(t){super(),this.value=0,L.util.initPartial(t,this)}toJson(t){return L.json.writeScalar(ne.FLOAT,this.value,!0)}fromJson(t,e){try{this.value=L.json.readScalar(ne.FLOAT,t)}catch(n){let r='cannot decode message google.protobuf.FloatValue from JSON"';throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),new Error(r)}return this}static fromBinary(t,e){return new En().fromBinary(t,e)}static fromJson(t,e){return new En().fromJson(t,e)}static fromJsonString(t,e){return new En().fromJsonString(t,e)}static equals(t,e){return L.util.equals(En,t,e)}}En.runtime=L;En.typeName="google.protobuf.FloatValue";En.fields=L.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:2}]);En.fieldWrapper={wrapField(i){return new En({value:i})},unwrapField(i){return i.value}};class xn extends fe{constructor(t){super(),this.value=Ye.zero,L.util.initPartial(t,this)}toJson(t){return L.json.writeScalar(ne.INT64,this.value,!0)}fromJson(t,e){try{this.value=L.json.readScalar(ne.INT64,t)}catch(n){let r='cannot decode message google.protobuf.Int64Value from JSON"';throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),new Error(r)}return this}static fromBinary(t,e){return new xn().fromBinary(t,e)}static fromJson(t,e){return new xn().fromJson(t,e)}static fromJsonString(t,e){return new xn().fromJsonString(t,e)}static equals(t,e){return L.util.equals(xn,t,e)}}xn.runtime=L;xn.typeName="google.protobuf.Int64Value";xn.fields=L.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:3}]);xn.fieldWrapper={wrapField(i){return new xn({value:i})},unwrapField(i){return i.value}};class On extends fe{constructor(t){super(),this.value=Ye.zero,L.util.initPartial(t,this)}toJson(t){return L.json.writeScalar(ne.UINT64,this.value,!0)}fromJson(t,e){try{this.value=L.json.readScalar(ne.UINT64,t)}catch(n){let r='cannot decode message google.protobuf.UInt64Value from JSON"';throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),new Error(r)}return this}static fromBinary(t,e){return new On().fromBinary(t,e)}static fromJson(t,e){return new On().fromJson(t,e)}static fromJsonString(t,e){return new On().fromJsonString(t,e)}static equals(t,e){return L.util.equals(On,t,e)}}On.runtime=L;On.typeName="google.protobuf.UInt64Value";On.fields=L.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:4}]);On.fieldWrapper={wrapField(i){return new On({value:i})},unwrapField(i){return i.value}};class kn extends fe{constructor(t){super(),this.value=0,L.util.initPartial(t,this)}toJson(t){return L.json.writeScalar(ne.INT32,this.value,!0)}fromJson(t,e){try{this.value=L.json.readScalar(ne.INT32,t)}catch(n){let r='cannot decode message google.protobuf.Int32Value from JSON"';throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),new Error(r)}return this}static fromBinary(t,e){return new kn().fromBinary(t,e)}static fromJson(t,e){return new kn().fromJson(t,e)}static fromJsonString(t,e){return new kn().fromJsonString(t,e)}static equals(t,e){return L.util.equals(kn,t,e)}}kn.runtime=L;kn.typeName="google.protobuf.Int32Value";kn.fields=L.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:5}]);kn.fieldWrapper={wrapField(i){return new kn({value:i})},unwrapField(i){return i.value}};class In extends fe{constructor(t){super(),this.value=0,L.util.initPartial(t,this)}toJson(t){return L.json.writeScalar(ne.UINT32,this.value,!0)}fromJson(t,e){try{this.value=L.json.readScalar(ne.UINT32,t)}catch(n){let r='cannot decode message google.protobuf.UInt32Value from JSON"';throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),new Error(r)}return this}static fromBinary(t,e){return new In().fromBinary(t,e)}static fromJson(t,e){return new In().fromJson(t,e)}static fromJsonString(t,e){return new In().fromJsonString(t,e)}static equals(t,e){return L.util.equals(In,t,e)}}In.runtime=L;In.typeName="google.protobuf.UInt32Value";In.fields=L.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:13}]);In.fieldWrapper={wrapField(i){return new In({value:i})},unwrapField(i){return i.value}};class Nn extends fe{constructor(t){super(),this.value=!1,L.util.initPartial(t,this)}toJson(t){return L.json.writeScalar(ne.BOOL,this.value,!0)}fromJson(t,e){try{this.value=L.json.readScalar(ne.BOOL,t)}catch(n){let r='cannot decode message google.protobuf.BoolValue from JSON"';throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),new Error(r)}return this}static fromBinary(t,e){return new Nn().fromBinary(t,e)}static fromJson(t,e){return new Nn().fromJson(t,e)}static fromJsonString(t,e){return new Nn().fromJsonString(t,e)}static equals(t,e){return L.util.equals(Nn,t,e)}}Nn.runtime=L;Nn.typeName="google.protobuf.BoolValue";Nn.fields=L.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:8}]);Nn.fieldWrapper={wrapField(i){return new Nn({value:i})},unwrapField(i){return i.value}};class Ot extends fe{constructor(t){super(),this.value="",L.util.initPartial(t,this)}toJson(t){return L.json.writeScalar(ne.STRING,this.value,!0)}fromJson(t,e){try{this.value=L.json.readScalar(ne.STRING,t)}catch(n){let r='cannot decode message google.protobuf.StringValue from JSON"';throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),new Error(r)}return this}static fromBinary(t,e){return new Ot().fromBinary(t,e)}static fromJson(t,e){return new Ot().fromJson(t,e)}static fromJsonString(t,e){return new Ot().fromJsonString(t,e)}static equals(t,e){return L.util.equals(Ot,t,e)}}Ot.runtime=L;Ot.typeName="google.protobuf.StringValue";Ot.fields=L.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:9}]);Ot.fieldWrapper={wrapField(i){return new Ot({value:i})},unwrapField(i){return i.value}};class _n extends fe{constructor(t){super(),this.value=new Uint8Array(0),L.util.initPartial(t,this)}toJson(t){return L.json.writeScalar(ne.BYTES,this.value,!0)}fromJson(t,e){try{this.value=L.json.readScalar(ne.BYTES,t)}catch(n){let r='cannot decode message google.protobuf.BytesValue from JSON"';throw n instanceof Error&&n.message.length>0&&(r+=`: ${n.message}`),new Error(r)}return this}static fromBinary(t,e){return new _n().fromBinary(t,e)}static fromJson(t,e){return new _n().fromJson(t,e)}static fromJsonString(t,e){return new _n().fromJsonString(t,e)}static equals(t,e){return L.util.equals(_n,t,e)}}_n.runtime=L;_n.typeName="google.protobuf.BytesValue";_n.fields=L.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:12}]);_n.fieldWrapper={wrapField(i){return new _n({value:i})},unwrapField(i){return i.value}};function Uc(i,t,e){try{const n=Aa.dec(i);return t?t.fromBinary(n,e):n}catch(n){throw We.from(n,Be.DataLoss)}}function Jc(i,t){const e={};for(const[n,r]of Object.entries(i.methods)){const o=t(Object.assign(Object.assign({},r),{localName:n,service:i}));o!=null&&(e[n]=o)}return e}const al=1;function ll(i){let t,e=new Uint8Array(0);function n(r){const o=new Uint8Array(e.length+r.length);o.set(e),o.set(r,e.length),e=o}return new ReadableStream({start(){t=i.getReader()},async pull(r){let o;for(;;){if(o===void 0&&e.byteLength>=5){let u=0;for(let d=1;d<5;d++)u=(u<<8)+e[d];o={flags:e[0],length:u}}if(o!==void 0&&e.byteLength>=o.length+5)break;const c=await t.read();if(c.done)break;n(c.value)}if(o===void 0){if(e.byteLength==0){r.close();return}r.error(new We("premature end of stream",Be.DataLoss));return}const s=e.subarray(5,5+o.length);e=e.subarray(5+o.length),r.enqueue({flags:o.flags,data:s})}})}function ul(i,t){const e=new Uint8Array(t.length+5);e.set(t,5);const n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setUint8(0,i),n.setUint32(1,t.length),e}var $c=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(o){e[o]=i[o]&&function(s){return new Promise(function(c,u){s=i[o](s),r(c,u,s.done,s.value)})}}function r(o,s,c,u){Promise.resolve(u).then(function(d){o({value:d,done:c})},s)}},go=function(i){return this instanceof go?(this.v=i,this):new go(i)},zc=function(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(i,t||[]),r,o=[];return r={},c("next"),c("throw"),c("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(a){return function(v){return Promise.resolve(v).then(a,h)}}function c(a,v){n[a]&&(r[a]=function(b){return new Promise(function(w,y){o.push([a,b,w,y])>1||u(a,b)})},v&&(r[a]=v(r[a])))}function u(a,v){try{d(n[a](v))}catch(b){l(o[0][3],b)}}function d(a){a.value instanceof go?Promise.resolve(a.value.v).then(m,h):l(o[0][2],a)}function m(a){u("next",a)}function h(a){u("throw",a)}function l(a,v){a(v),o.shift(),o.length&&u(o[0][0],o[0][1])}},Vc=function(i){var t,e;return t={},n("next"),n("throw",function(r){throw r}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(r,o){t[r]=i[r]?function(s){return(e=!e)?{value:go(i[r](s)),done:!1}:o?o(s):s}:o}};function Kc(i){return zc(this,arguments,function*(){yield go(yield*Vc($c(i)))})}var tu=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof __values=="function"?__values(i):i[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(o){e[o]=i[o]&&function(s){return new Promise(function(c,u){s=i[o](s),r(c,u,s.done,s.value)})}}function r(o,s,c,u){Promise.resolve(u).then(function(d){o({value:d,done:c})},s)}},$i=function(i){return this instanceof $i?(this.v=i,this):new $i(i)},Hc=function(i){var t,e;return t={},n("next"),n("throw",function(r){throw r}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(r,o){t[r]=i[r]?function(s){return(e=!e)?{value:$i(i[r](s)),done:!1}:o?o(s):s}:o}},Wc=function(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(i,t||[]),r,o=[];return r={},c("next"),c("throw"),c("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(a){return function(v){return Promise.resolve(v).then(a,h)}}function c(a,v){n[a]&&(r[a]=function(b){return new Promise(function(w,y){o.push([a,b,w,y])>1||u(a,b)})},v&&(r[a]=v(r[a])))}function u(a,v){try{d(n[a](v))}catch(b){l(o[0][3],b)}}function d(a){a.value instanceof $i?Promise.resolve(a.value.v).then(m,h):l(o[0][2],a)}function m(a){u("next",a)}function h(a){u("throw",a)}function l(a,v){a(v),o.shift(),o.length&&u(o[0][0],o[0][1])}};function Gc(i,t){return Jc(i,e=>{switch(e.kind){case mt.Unary:return Yc(t,i,e);case mt.ServerStreaming:return Zc(t,i,e);case mt.ClientStreaming:return Xc(t,i,e);case mt.BiDiStreaming:return Qc(t,i,e);default:return null}})}function Yc(i,t,e){return async function(n,r){var o,s;const c=await i.unary(t,e,r==null?void 0:r.signal,r==null?void 0:r.timeoutMs,r==null?void 0:r.headers,n,r==null?void 0:r.contextValues);return(o=r==null?void 0:r.onHeader)===null||o===void 0||o.call(r,c.header),(s=r==null?void 0:r.onTrailer)===null||s===void 0||s.call(r,c.trailer),c.message}}function Zc(i,t,e){return function(n,r){return nu(i.stream(t,e,r==null?void 0:r.signal,r==null?void 0:r.timeoutMs,r==null?void 0:r.headers,Kc([n]),r==null?void 0:r.contextValues),r)}}function Xc(i,t,e){return async function(n,r){var o,s,c,u,d,m;const h=await i.stream(t,e,r==null?void 0:r.signal,r==null?void 0:r.timeoutMs,r==null?void 0:r.headers,n,r==null?void 0:r.contextValues);(d=r==null?void 0:r.onHeader)===null||d===void 0||d.call(r,h.header);let l,a=0;try{for(var v=!0,b=tu(h.message),w;w=await b.next(),o=w.done,!o;v=!0)u=w.value,v=!1,l=u,a++}catch(y){s={error:y}}finally{try{!v&&!o&&(c=b.return)&&await c.call(b)}finally{if(s)throw s.error}}if(!l)throw new We("protocol error: missing response message",Be.Unimplemented);if(a>1)throw new We("protocol error: received extra messages for client streaming method",Be.Unimplemented);return(m=r==null?void 0:r.onTrailer)===null||m===void 0||m.call(r,h.trailer),l}}function Qc(i,t,e){return function(n,r){return nu(i.stream(t,e,r==null?void 0:r.signal,r==null?void 0:r.timeoutMs,r==null?void 0:r.headers,n,r==null?void 0:r.contextValues),r)}}function nu(i,t){const e=function(){return Wc(this,arguments,function*(){var n,r;const o=yield $i(i);(n=t==null?void 0:t.onHeader)===null||n===void 0||n.call(t,o.header),yield $i(yield*Hc(tu(o.message))),(r=t==null?void 0:t.onTrailer)===null||r===void 0||r.call(t,o.trailer)})}()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>e.next()})}}function ef(...i){const t=new AbortController,e=i.filter(r=>r!==void 0).concat(t.signal);for(const r of e){if(r.aborted){n.apply(r);break}r.addEventListener("abort",n)}function n(){t.signal.aborted||t.abort(ru(this));for(const r of e)r.removeEventListener("abort",n)}return t}function tf(i){const t=new AbortController,e=()=>{t.abort(new We("the operation timed out",Be.DeadlineExceeded))};let n;return i!==void 0&&(i<=0?e():n=setTimeout(e,i)),{signal:t.signal,cleanup:()=>clearTimeout(n)}}function ru(i){if(!i.aborted)return;if(i.reason!==void 0)return i.reason;const t=new Error("This operation was aborted");return t.name="AbortError",t}function cl(){return{get(i){return i.id in this?this[i.id]:i.defaultValue},set(i,t){return this[i.id]=t,this},delete(i){return delete this[i.id],this}}}const Ms=128;function fl(i){const t=new Headers,e=new TextDecoder().decode(i).split(`\r
`);for(const n of e){if(n==="")continue;const r=n.indexOf(":");if(r>0){const o=n.substring(0,r).trim(),s=n.substring(r+1).trim();t.append(o,s)}}return t}const nf="Content-Type",rf="Grpc-Timeout",zi="Grpc-Status",iu="Grpc-Message",of="Grpc-Status-Details-Bin",sf="X-User-Agent",af="X-Grpc-Web",lf="application/grpc-web+proto",uf="application/grpc-web+json";class Fr extends fe{constructor(t){super(),this.code=0,this.message="",this.details=[],L.util.initPartial(t,this)}static fromBinary(t,e){return new Fr().fromBinary(t,e)}static fromJson(t,e){return new Fr().fromJson(t,e)}static fromJsonString(t,e){return new Fr().fromJsonString(t,e)}static equals(t,e){return L.util.equals(Fr,t,e)}}Fr.runtime=L;Fr.typeName="google.rpc.Status";Fr.fields=L.util.newFieldList(()=>[{no:1,name:"code",kind:"scalar",T:5},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"details",kind:"message",T:An,repeated:!0}]);const cf="0";function ou(i){var t;const e=i.get(of);if(e!=null){const r=Uc(e,Fr);if(r.code==0)return;const o=new We(r.message,r.code,i);return o.details=r.details.map(s=>({type:s.typeUrl.substring(s.typeUrl.lastIndexOf("/")+1),value:s.value})),o}const n=i.get(zi);if(n!=null){if(n===cf)return;const r=parseInt(n,10);return r in Be?new We(decodeURIComponent((t=i.get(iu))!==null&&t!==void 0?t:""),r,i):new We(`invalid grpc-status: ${n}`,Be.Internal,i)}}function hl(i,t,e){const n=typeof t=="string"?t:t.typeName,r=typeof e=="string"?e:e.name;return i.toString().replace(/\/?$/,`/${n}/${r}`)}function su(i,t){return t instanceof i?t:new i(t)}function ff(i,t){function e(n){return n.done===!0?n:{done:n.done,value:su(i,n.value)}}return{[Symbol.asyncIterator](){const n=t[Symbol.asyncIterator](),r={next:()=>n.next().then(e)};return n.throw!==void 0&&(r.throw=o=>n.throw(o).then(e)),n.return!==void 0&&(r.return=o=>n.return(o).then(e)),r}}}function au(i,t){var e;return(e=t==null?void 0:t.concat().reverse().reduce((n,r)=>r(n),i))!==null&&e!==void 0?e:i}function hf(i){var t;const e=Object.assign({},i);return(t=e.ignoreUnknownFields)!==null&&t!==void 0||(e.ignoreUnknownFields=!0),e}function dl(i,t,e,n){const r=t?gl(i.I,n):pl(i.I,e);return{parse:(t?gl(i.O,n):pl(i.O,e)).parse,serialize:r.serialize}}function gl(i,t){return{parse(e){try{return i.fromBinary(e,t)}catch(n){const r=n instanceof Error?n.message:String(n);throw new We(`parse binary: ${r}`,Be.Internal)}},serialize(e){try{return e.toBinary(t)}catch(n){const r=n instanceof Error?n.message:String(n);throw new We(`serialize binary: ${r}`,Be.Internal)}}}}function pl(i,t){var e,n;const r=(e=t==null?void 0:t.textEncoder)!==null&&e!==void 0?e:new TextEncoder,o=(n=t==null?void 0:t.textDecoder)!==null&&n!==void 0?n:new TextDecoder,s=hf(t);return{parse(c){try{const u=o.decode(c);return i.fromJsonString(u,s)}catch(u){throw We.from(u,Be.InvalidArgument)}},serialize(c){try{const u=c.toJsonString(s);return r.encode(u)}catch(u){throw We.from(u,Be.Internal)}}}}function df(i){const t=au(i.next,i.interceptors),[e,n,r]=lu(i),o=Object.assign(Object.assign({},i.req),{message:su(i.req.method.I,i.req.message),signal:e});return t(o).then(s=>(r(),s),n)}function gf(i){const t=au(i.next,i.interceptors),[e,n,r]=lu(i),o=Object.assign(Object.assign({},i.req),{message:ff(i.req.method.I,i.req.message),signal:e});let s=!1;return e.addEventListener("abort",function(){var c,u;const d=i.req.message[Symbol.asyncIterator]();s||(c=d.throw)===null||c===void 0||c.call(d,this.reason).catch(()=>{}),(u=d.return)===null||u===void 0||u.call(d).catch(()=>{})}),t(o).then(c=>Object.assign(Object.assign({},c),{message:{[Symbol.asyncIterator](){const u=c.message[Symbol.asyncIterator]();return{next(){return u.next().then(d=>(d.done==!0&&(s=!0,r()),d),n)}}}}}),n)}function lu(i){const{signal:t,cleanup:e}=tf(i.timeoutMs),n=ef(i.signal,t);return[n.signal,function(o){const s=We.from(t.aborted?ru(t):o);return n.abort(s),e(),Promise.reject(s)},function(){e(),n.abort()}]}function pf(){try{new Headers}catch{throw new Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}}function ml(i,t){const e=ou(i);if(e)throw t.forEach((n,r)=>{e.metadata.append(r,n)}),e;if(!t.has(zi)&&!i.has(zi))throw new We("protocol error: missing status",Be.Internal)}function yl(i,t,e,n){const r=new Headers(e??{});return r.set(nf,i?lf:uf),r.set(af,"1"),r.set(sf,"connect-es/1.6.1"),t!==void 0&&r.set(rf,`${t}m`),r}function mf(i){switch(i){case 400:return Be.Internal;case 401:return Be.Unauthenticated;case 403:return Be.PermissionDenied;case 404:return Be.Unimplemented;case 429:return Be.Unavailable;case 502:return Be.Unavailable;case 503:return Be.Unavailable;case 504:return Be.Unavailable;default:return Be.Unknown}}function vl(i,t){var e;if(i>=200&&i<300)return{foundStatus:t.has(zi),headerError:ou(t)};throw new We(decodeURIComponent((e=t.get(iu))!==null&&e!==void 0?e:`HTTP ${i}`),mf(i),t)}var Ti=function(i){return this instanceof Ti?(this.v=i,this):new Ti(i)},yf=function(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(i,t||[]),r,o=[];return r={},c("next"),c("throw"),c("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(a){return function(v){return Promise.resolve(v).then(a,h)}}function c(a,v){n[a]&&(r[a]=function(b){return new Promise(function(w,y){o.push([a,b,w,y])>1||u(a,b)})},v&&(r[a]=v(r[a])))}function u(a,v){try{d(n[a](v))}catch(b){l(o[0][3],b)}}function d(a){a.value instanceof Ti?Promise.resolve(a.value.v).then(m,h):l(o[0][2],a)}function m(a){u("next",a)}function h(a){u("throw",a)}function l(a,v){a(v),o.shift(),o.length&&u(o[0][0],o[0][1])}};function vf(i){var t;pf();const e=(t=i.useBinaryFormat)!==null&&t!==void 0?t:!0;return{async unary(n,r,o,s,c,u,d){var m;const{serialize:h,parse:l}=dl(r,e,i.jsonOptions,i.binaryOptions);return s=s===void 0?i.defaultTimeoutMs:s<=0?void 0:s,await df({interceptors:i.interceptors,signal:o,timeoutMs:s,req:{stream:!1,service:n,method:r,url:hl(i.baseUrl,n,r),init:{method:"POST",credentials:(m=i.credentials)!==null&&m!==void 0?m:"same-origin",redirect:"error",mode:"cors"},header:yl(e,s,c),contextValues:d??cl(),message:u},next:async a=>{var v;const w=await((v=i.fetch)!==null&&v!==void 0?v:globalThis.fetch)(a.url,Object.assign(Object.assign({},a.init),{headers:a.header,signal:a.signal,body:ul(0,h(a.message))})),{headerError:y}=vl(w.status,w.headers);if(!w.body)throw y!==void 0?y:"missing response body";const p=ll(w.body).getReader();let g,f;for(;;){const T=await p.read();if(T.done)break;const{flags:S,data:E}=T.value;if((S&al)===al)throw new We("protocol error: received unsupported compressed output",Be.Internal);if(S===Ms){if(g!==void 0)throw"extra trailer";g=fl(E);continue}if(f!==void 0)throw new We("extra message",Be.Unimplemented);f=l(E)}if(g===void 0)throw y!==void 0?y:new We("missing trailer",w.headers.has(zi)?Be.Unimplemented:Be.Unknown);if(ml(g,w.headers),f===void 0)throw new We("missing message",g.has(zi)?Be.Unimplemented:Be.Unknown);return{stream:!1,service:n,method:r,header:w.headers,message:f,trailer:g}}})},async stream(n,r,o,s,c,u,d){var m;const{serialize:h,parse:l}=dl(r,e,i.jsonOptions,i.binaryOptions);function a(b,w,y,p,g){return yf(this,arguments,function*(){const T=ll(b).getReader();if(w){if(!(yield Ti(T.read())).done)throw"extra data for trailers-only";return yield Ti(void 0)}let S=!1;for(;;){const E=yield Ti(T.read());if(E.done)break;const{flags:k,data:P}=E.value;if((k&Ms)===Ms){if(S)throw"extra trailer";S=!0;const O=fl(P);ml(O,p),O.forEach((x,I)=>y.set(I,x));continue}if(S)throw"extra message";yield yield Ti(l(P))}if("throwIfAborted"in g&&g.throwIfAborted(),!S)throw"missing trailer"})}async function v(b){if(r.kind!=mt.ServerStreaming)throw"The fetch API does not support streaming request bodies";const w=await b[Symbol.asyncIterator]().next();if(w.done==!0)throw"missing request message";return ul(0,h(w.value))}return s=s===void 0?i.defaultTimeoutMs:s<=0?void 0:s,gf({interceptors:i.interceptors,signal:o,timeoutMs:s,req:{stream:!0,service:n,method:r,url:hl(i.baseUrl,n,r),init:{method:"POST",credentials:(m=i.credentials)!==null&&m!==void 0?m:"same-origin",redirect:"error",mode:"cors"},header:yl(e,s,c),contextValues:d??cl(),message:u},next:async b=>{var w;const p=await((w=i.fetch)!==null&&w!==void 0?w:globalThis.fetch)(b.url,Object.assign(Object.assign({},b.init),{headers:b.header,signal:b.signal,body:await v(b.message)})),{foundStatus:g,headerError:f}=vl(p.status,p.headers);if(f!=null)throw f;if(!p.body)throw"missing response body";const T=new Headers;return Object.assign(Object.assign({},b),{header:p.headers,trailer:T,message:a(p.body,g,T,p.headers,b.signal)})}})}}}var _e=(i=>(i[i.NULL=0]="NULL",i[i.BOOLEAN=1]="BOOLEAN",i[i.INTEGER=2]="INTEGER",i[i.LONG=3]="LONG",i[i.DOUBLE=4]="DOUBLE",i[i.STRING=5]="STRING",i[i.BYTES=6]="BYTES",i[i.DATE=7]="DATE",i[i.JSON_OBJECT=8]="JSON_OBJECT",i[i.JSON_ARRAY=9]="JSON_ARRAY",i[i.TEXT=10]="TEXT",i[i.INTEGER_CNT=11]="INTEGER_CNT",i[i.LONG_CNT=12]="LONG_CNT",i[i.TREE=13]="TREE",i))(_e||{});L.util.setEnumType(_e,"yorkie.v1.ValueType",[{no:0,name:"VALUE_TYPE_NULL"},{no:1,name:"VALUE_TYPE_BOOLEAN"},{no:2,name:"VALUE_TYPE_INTEGER"},{no:3,name:"VALUE_TYPE_LONG"},{no:4,name:"VALUE_TYPE_DOUBLE"},{no:5,name:"VALUE_TYPE_STRING"},{no:6,name:"VALUE_TYPE_BYTES"},{no:7,name:"VALUE_TYPE_DATE"},{no:8,name:"VALUE_TYPE_JSON_OBJECT"},{no:9,name:"VALUE_TYPE_JSON_ARRAY"},{no:10,name:"VALUE_TYPE_TEXT"},{no:11,name:"VALUE_TYPE_INTEGER_CNT"},{no:12,name:"VALUE_TYPE_LONG_CNT"},{no:13,name:"VALUE_TYPE_TREE"}]);var Ei=(i=>(i[i.DOCUMENT_CHANGED=0]="DOCUMENT_CHANGED",i[i.DOCUMENT_WATCHED=1]="DOCUMENT_WATCHED",i[i.DOCUMENT_UNWATCHED=2]="DOCUMENT_UNWATCHED",i[i.DOCUMENT_BROADCAST=3]="DOCUMENT_BROADCAST",i))(Ei||{});L.util.setEnumType(Ei,"yorkie.v1.DocEventType",[{no:0,name:"DOC_EVENT_TYPE_DOCUMENT_CHANGED"},{no:1,name:"DOC_EVENT_TYPE_DOCUMENT_WATCHED"},{no:2,name:"DOC_EVENT_TYPE_DOCUMENT_UNWATCHED"},{no:3,name:"DOC_EVENT_TYPE_DOCUMENT_BROADCAST"}]);const jn=class jn extends fe{constructor(e){super();A(this,"root");A(this,"presences",{});L.util.initPartial(e,this)}static fromBinary(e,n){return new jn().fromBinary(e,n)}static fromJson(e,n){return new jn().fromJson(e,n)}static fromJsonString(e,n){return new jn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(jn,e,n)}};A(jn,"runtime",L),A(jn,"typeName","yorkie.v1.Snapshot"),A(jn,"fields",L.util.newFieldList(()=>[{no:1,name:"root",kind:"message",T:At},{no:2,name:"presences",kind:"map",K:9,V:{kind:"message",T:Ea}}]));let Hs=jn;var Pt;let Kr=(Pt=class extends fe{constructor(e){super();A(this,"documentKey","");A(this,"checkpoint");A(this,"snapshot",new Uint8Array(0));A(this,"changes",[]);A(this,"minSyncedTicket");A(this,"isRemoved",!1);A(this,"versionVector");L.util.initPartial(e,this)}static fromBinary(e,n){return new Pt().fromBinary(e,n)}static fromJson(e,n){return new Pt().fromJson(e,n)}static fromJsonString(e,n){return new Pt().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Pt,e,n)}},A(Pt,"runtime",L),A(Pt,"typeName","yorkie.v1.ChangePack"),A(Pt,"fields",L.util.newFieldList(()=>[{no:1,name:"document_key",kind:"scalar",T:9},{no:2,name:"checkpoint",kind:"message",T:fu},{no:3,name:"snapshot",kind:"scalar",T:12},{no:4,name:"changes",kind:"message",T:uu,repeated:!0},{no:5,name:"min_synced_ticket",kind:"message",T:Te},{no:6,name:"is_removed",kind:"scalar",T:8},{no:7,name:"version_vector",kind:"message",T:Os}])),Pt);var Ct;let uu=(Ct=class extends fe{constructor(e){super();A(this,"id");A(this,"message","");A(this,"operations",[]);A(this,"presenceChange");L.util.initPartial(e,this)}static fromBinary(e,n){return new Ct().fromBinary(e,n)}static fromJson(e,n){return new Ct().fromJson(e,n)}static fromJsonString(e,n){return new Ct().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Ct,e,n)}},A(Ct,"runtime",L),A(Ct,"typeName","yorkie.v1.Change"),A(Ct,"fields",L.util.newFieldList(()=>[{no:1,name:"id",kind:"message",T:xs},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"operations",kind:"message",T:Sa,repeated:!0},{no:4,name:"presence_change",kind:"message",T:yo}])),Ct);var Lt;let xs=(Lt=class extends fe{constructor(e){super();A(this,"clientSeq",0);A(this,"serverSeq",Ye.zero);A(this,"lamport",Ye.zero);A(this,"actorId",new Uint8Array(0));A(this,"versionVector");L.util.initPartial(e,this)}static fromBinary(e,n){return new Lt().fromBinary(e,n)}static fromJson(e,n){return new Lt().fromJson(e,n)}static fromJsonString(e,n){return new Lt().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Lt,e,n)}},A(Lt,"runtime",L),A(Lt,"typeName","yorkie.v1.ChangeID"),A(Lt,"fields",L.util.newFieldList(()=>[{no:1,name:"client_seq",kind:"scalar",T:13},{no:2,name:"server_seq",kind:"scalar",T:3},{no:3,name:"lamport",kind:"scalar",T:3},{no:4,name:"actor_id",kind:"scalar",T:12},{no:5,name:"version_vector",kind:"message",T:Os}])),Lt);var Rt;let Os=(Rt=class extends fe{constructor(e){super();A(this,"vector",{});L.util.initPartial(e,this)}static fromBinary(e,n){return new Rt().fromBinary(e,n)}static fromJson(e,n){return new Rt().fromJson(e,n)}static fromJsonString(e,n){return new Rt().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Rt,e,n)}},A(Rt,"runtime",L),A(Rt,"typeName","yorkie.v1.VersionVector"),A(Rt,"fields",L.util.newFieldList(()=>[{no:1,name:"vector",kind:"map",K:9,V:{kind:"scalar",T:3}}])),Rt);var Dt;let Sa=(Dt=class extends fe{constructor(e){super();A(this,"body",{case:void 0});L.util.initPartial(e,this)}static fromBinary(e,n){return new Dt().fromBinary(e,n)}static fromJson(e,n){return new Dt().fromJson(e,n)}static fromJsonString(e,n){return new Dt().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Dt,e,n)}},A(Dt,"runtime",L),A(Dt,"typeName","yorkie.v1.Operation"),A(Dt,"fields",L.util.newFieldList(()=>[{no:1,name:"set",kind:"message",T:ns,oneof:"body"},{no:2,name:"add",kind:"message",T:rs,oneof:"body"},{no:3,name:"move",kind:"message",T:is,oneof:"body"},{no:4,name:"remove",kind:"message",T:os,oneof:"body"},{no:5,name:"edit",kind:"message",T:ss,oneof:"body"},{no:6,name:"select",kind:"message",T:Ws,oneof:"body"},{no:7,name:"style",kind:"message",T:as,oneof:"body"},{no:8,name:"increase",kind:"message",T:ls,oneof:"body"},{no:9,name:"tree_edit",kind:"message",T:us,oneof:"body"},{no:10,name:"tree_style",kind:"message",T:cs,oneof:"body"},{no:11,name:"array_set",kind:"message",T:Gs,oneof:"body"}])),Dt);const Fn=class Fn extends fe{constructor(e){super();A(this,"parentCreatedAt");A(this,"key","");A(this,"value");A(this,"executedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new Fn().fromBinary(e,n)}static fromJson(e,n){return new Fn().fromJson(e,n)}static fromJsonString(e,n){return new Fn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Fn,e,n)}};A(Fn,"runtime",L),A(Fn,"typeName","yorkie.v1.Operation.Set"),A(Fn,"fields",L.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:Te},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"value",kind:"message",T:_t},{no:4,name:"executed_at",kind:"message",T:Te}]));let ns=Fn;const Un=class Un extends fe{constructor(e){super();A(this,"parentCreatedAt");A(this,"prevCreatedAt");A(this,"value");A(this,"executedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new Un().fromBinary(e,n)}static fromJson(e,n){return new Un().fromJson(e,n)}static fromJsonString(e,n){return new Un().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Un,e,n)}};A(Un,"runtime",L),A(Un,"typeName","yorkie.v1.Operation.Add"),A(Un,"fields",L.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:Te},{no:2,name:"prev_created_at",kind:"message",T:Te},{no:3,name:"value",kind:"message",T:_t},{no:4,name:"executed_at",kind:"message",T:Te}]));let rs=Un;const Jn=class Jn extends fe{constructor(e){super();A(this,"parentCreatedAt");A(this,"prevCreatedAt");A(this,"createdAt");A(this,"executedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new Jn().fromBinary(e,n)}static fromJson(e,n){return new Jn().fromJson(e,n)}static fromJsonString(e,n){return new Jn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Jn,e,n)}};A(Jn,"runtime",L),A(Jn,"typeName","yorkie.v1.Operation.Move"),A(Jn,"fields",L.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:Te},{no:2,name:"prev_created_at",kind:"message",T:Te},{no:3,name:"created_at",kind:"message",T:Te},{no:4,name:"executed_at",kind:"message",T:Te}]));let is=Jn;const $n=class $n extends fe{constructor(e){super();A(this,"parentCreatedAt");A(this,"createdAt");A(this,"executedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new $n().fromBinary(e,n)}static fromJson(e,n){return new $n().fromJson(e,n)}static fromJsonString(e,n){return new $n().fromJsonString(e,n)}static equals(e,n){return L.util.equals($n,e,n)}};A($n,"runtime",L),A($n,"typeName","yorkie.v1.Operation.Remove"),A($n,"fields",L.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:Te},{no:2,name:"created_at",kind:"message",T:Te},{no:3,name:"executed_at",kind:"message",T:Te}]));let os=$n;const zn=class zn extends fe{constructor(e){super();A(this,"parentCreatedAt");A(this,"from");A(this,"to");A(this,"createdAtMapByActor",{});A(this,"content","");A(this,"executedAt");A(this,"attributes",{});L.util.initPartial(e,this)}static fromBinary(e,n){return new zn().fromBinary(e,n)}static fromJson(e,n){return new zn().fromJson(e,n)}static fromJsonString(e,n){return new zn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(zn,e,n)}};A(zn,"runtime",L),A(zn,"typeName","yorkie.v1.Operation.Edit"),A(zn,"fields",L.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:Te},{no:2,name:"from",kind:"message",T:zr},{no:3,name:"to",kind:"message",T:zr},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:Te}},{no:5,name:"content",kind:"scalar",T:9},{no:6,name:"executed_at",kind:"message",T:Te},{no:7,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}]));let ss=zn;const Vn=class Vn extends fe{constructor(e){super();A(this,"parentCreatedAt");A(this,"from");A(this,"to");A(this,"executedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new Vn().fromBinary(e,n)}static fromJson(e,n){return new Vn().fromJson(e,n)}static fromJsonString(e,n){return new Vn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Vn,e,n)}};A(Vn,"runtime",L),A(Vn,"typeName","yorkie.v1.Operation.Select"),A(Vn,"fields",L.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:Te},{no:2,name:"from",kind:"message",T:zr},{no:3,name:"to",kind:"message",T:zr},{no:4,name:"executed_at",kind:"message",T:Te}]));let Ws=Vn;const Kn=class Kn extends fe{constructor(e){super();A(this,"parentCreatedAt");A(this,"from");A(this,"to");A(this,"attributes",{});A(this,"executedAt");A(this,"createdAtMapByActor",{});L.util.initPartial(e,this)}static fromBinary(e,n){return new Kn().fromBinary(e,n)}static fromJson(e,n){return new Kn().fromJson(e,n)}static fromJsonString(e,n){return new Kn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Kn,e,n)}};A(Kn,"runtime",L),A(Kn,"typeName","yorkie.v1.Operation.Style"),A(Kn,"fields",L.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:Te},{no:2,name:"from",kind:"message",T:zr},{no:3,name:"to",kind:"message",T:zr},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:Te},{no:6,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:Te}}]));let as=Kn;const Hn=class Hn extends fe{constructor(e){super();A(this,"parentCreatedAt");A(this,"value");A(this,"executedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new Hn().fromBinary(e,n)}static fromJson(e,n){return new Hn().fromJson(e,n)}static fromJsonString(e,n){return new Hn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Hn,e,n)}};A(Hn,"runtime",L),A(Hn,"typeName","yorkie.v1.Operation.Increase"),A(Hn,"fields",L.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:Te},{no:2,name:"value",kind:"message",T:_t},{no:3,name:"executed_at",kind:"message",T:Te}]));let ls=Hn;const Wn=class Wn extends fe{constructor(e){super();A(this,"parentCreatedAt");A(this,"from");A(this,"to");A(this,"createdAtMapByActor",{});A(this,"contents",[]);A(this,"splitLevel",0);A(this,"executedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new Wn().fromBinary(e,n)}static fromJson(e,n){return new Wn().fromJson(e,n)}static fromJsonString(e,n){return new Wn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Wn,e,n)}};A(Wn,"runtime",L),A(Wn,"typeName","yorkie.v1.Operation.TreeEdit"),A(Wn,"fields",L.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:Te},{no:2,name:"from",kind:"message",T:xi},{no:3,name:"to",kind:"message",T:xi},{no:4,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:Te}},{no:5,name:"contents",kind:"message",T:bs,repeated:!0},{no:7,name:"split_level",kind:"scalar",T:5},{no:6,name:"executed_at",kind:"message",T:Te}]));let us=Wn;const Gn=class Gn extends fe{constructor(e){super();A(this,"parentCreatedAt");A(this,"from");A(this,"to");A(this,"attributes",{});A(this,"executedAt");A(this,"attributesToRemove",[]);A(this,"createdAtMapByActor",{});L.util.initPartial(e,this)}static fromBinary(e,n){return new Gn().fromBinary(e,n)}static fromJson(e,n){return new Gn().fromJson(e,n)}static fromJsonString(e,n){return new Gn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Gn,e,n)}};A(Gn,"runtime",L),A(Gn,"typeName","yorkie.v1.Operation.TreeStyle"),A(Gn,"fields",L.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:Te},{no:2,name:"from",kind:"message",T:xi},{no:3,name:"to",kind:"message",T:xi},{no:4,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"executed_at",kind:"message",T:Te},{no:6,name:"attributes_to_remove",kind:"scalar",T:9,repeated:!0},{no:7,name:"created_at_map_by_actor",kind:"map",K:9,V:{kind:"message",T:Te}}]));let cs=Gn;const Yn=class Yn extends fe{constructor(e){super();A(this,"parentCreatedAt");A(this,"createdAt");A(this,"value");A(this,"executedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new Yn().fromBinary(e,n)}static fromJson(e,n){return new Yn().fromJson(e,n)}static fromJsonString(e,n){return new Yn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Yn,e,n)}};A(Yn,"runtime",L),A(Yn,"typeName","yorkie.v1.Operation.ArraySet"),A(Yn,"fields",L.util.newFieldList(()=>[{no:1,name:"parent_created_at",kind:"message",T:Te},{no:2,name:"created_at",kind:"message",T:Te},{no:3,name:"value",kind:"message",T:_t},{no:4,name:"executed_at",kind:"message",T:Te}]));let Gs=Yn;const Zn=class Zn extends fe{constructor(e){super();A(this,"createdAt");A(this,"movedAt");A(this,"removedAt");A(this,"type",0);A(this,"value",new Uint8Array(0));L.util.initPartial(e,this)}static fromBinary(e,n){return new Zn().fromBinary(e,n)}static fromJson(e,n){return new Zn().fromJson(e,n)}static fromJsonString(e,n){return new Zn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Zn,e,n)}};A(Zn,"runtime",L),A(Zn,"typeName","yorkie.v1.JSONElementSimple"),A(Zn,"fields",L.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:Te},{no:2,name:"moved_at",kind:"message",T:Te},{no:3,name:"removed_at",kind:"message",T:Te},{no:4,name:"type",kind:"enum",T:L.getEnumType(_e)},{no:5,name:"value",kind:"scalar",T:12}]));let _t=Zn;const Xn=class Xn extends fe{constructor(e){super();A(this,"body",{case:void 0});L.util.initPartial(e,this)}static fromBinary(e,n){return new Xn().fromBinary(e,n)}static fromJson(e,n){return new Xn().fromJson(e,n)}static fromJsonString(e,n){return new Xn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Xn,e,n)}};A(Xn,"runtime",L),A(Xn,"typeName","yorkie.v1.JSONElement"),A(Xn,"fields",L.util.newFieldList(()=>[{no:1,name:"json_object",kind:"message",T:fs,oneof:"body"},{no:2,name:"json_array",kind:"message",T:hs,oneof:"body"},{no:3,name:"primitive",kind:"message",T:ds,oneof:"body"},{no:5,name:"text",kind:"message",T:gs,oneof:"body"},{no:6,name:"counter",kind:"message",T:ps,oneof:"body"},{no:7,name:"tree",kind:"message",T:ms,oneof:"body"}]));let At=Xn;const Qn=class Qn extends fe{constructor(e){super();A(this,"nodes",[]);A(this,"createdAt");A(this,"movedAt");A(this,"removedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new Qn().fromBinary(e,n)}static fromJson(e,n){return new Qn().fromJson(e,n)}static fromJsonString(e,n){return new Qn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Qn,e,n)}};A(Qn,"runtime",L),A(Qn,"typeName","yorkie.v1.JSONElement.JSONObject"),A(Qn,"fields",L.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:cu,repeated:!0},{no:2,name:"created_at",kind:"message",T:Te},{no:3,name:"moved_at",kind:"message",T:Te},{no:4,name:"removed_at",kind:"message",T:Te}]));let fs=Qn;const er=class er extends fe{constructor(e){super();A(this,"nodes",[]);A(this,"createdAt");A(this,"movedAt");A(this,"removedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new er().fromBinary(e,n)}static fromJson(e,n){return new er().fromJson(e,n)}static fromJsonString(e,n){return new er().fromJsonString(e,n)}static equals(e,n){return L.util.equals(er,e,n)}};A(er,"runtime",L),A(er,"typeName","yorkie.v1.JSONElement.JSONArray"),A(er,"fields",L.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:ys,repeated:!0},{no:2,name:"created_at",kind:"message",T:Te},{no:3,name:"moved_at",kind:"message",T:Te},{no:4,name:"removed_at",kind:"message",T:Te}]));let hs=er;const tr=class tr extends fe{constructor(e){super();A(this,"type",0);A(this,"value",new Uint8Array(0));A(this,"createdAt");A(this,"movedAt");A(this,"removedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new tr().fromBinary(e,n)}static fromJson(e,n){return new tr().fromJson(e,n)}static fromJsonString(e,n){return new tr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(tr,e,n)}};A(tr,"runtime",L),A(tr,"typeName","yorkie.v1.JSONElement.Primitive"),A(tr,"fields",L.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:L.getEnumType(_e)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:Te},{no:4,name:"moved_at",kind:"message",T:Te},{no:5,name:"removed_at",kind:"message",T:Te}]));let ds=tr;const nr=class nr extends fe{constructor(e){super();A(this,"nodes",[]);A(this,"createdAt");A(this,"movedAt");A(this,"removedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new nr().fromBinary(e,n)}static fromJson(e,n){return new nr().fromJson(e,n)}static fromJsonString(e,n){return new nr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(nr,e,n)}};A(nr,"runtime",L),A(nr,"typeName","yorkie.v1.JSONElement.Text"),A(nr,"fields",L.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:vs,repeated:!0},{no:2,name:"created_at",kind:"message",T:Te},{no:3,name:"moved_at",kind:"message",T:Te},{no:4,name:"removed_at",kind:"message",T:Te}]));let gs=nr;const rr=class rr extends fe{constructor(e){super();A(this,"type",0);A(this,"value",new Uint8Array(0));A(this,"createdAt");A(this,"movedAt");A(this,"removedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new rr().fromBinary(e,n)}static fromJson(e,n){return new rr().fromJson(e,n)}static fromJsonString(e,n){return new rr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(rr,e,n)}};A(rr,"runtime",L),A(rr,"typeName","yorkie.v1.JSONElement.Counter"),A(rr,"fields",L.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:L.getEnumType(_e)},{no:2,name:"value",kind:"scalar",T:12},{no:3,name:"created_at",kind:"message",T:Te},{no:4,name:"moved_at",kind:"message",T:Te},{no:5,name:"removed_at",kind:"message",T:Te}]));let ps=rr;const ir=class ir extends fe{constructor(e){super();A(this,"nodes",[]);A(this,"createdAt");A(this,"movedAt");A(this,"removedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new ir().fromBinary(e,n)}static fromJson(e,n){return new ir().fromJson(e,n)}static fromJsonString(e,n){return new ir().fromJsonString(e,n)}static equals(e,n){return L.util.equals(ir,e,n)}};A(ir,"runtime",L),A(ir,"typeName","yorkie.v1.JSONElement.Tree"),A(ir,"fields",L.util.newFieldList(()=>[{no:1,name:"nodes",kind:"message",T:mo,repeated:!0},{no:2,name:"created_at",kind:"message",T:Te},{no:3,name:"moved_at",kind:"message",T:Te},{no:4,name:"removed_at",kind:"message",T:Te}]));let ms=ir;var Bt;let cu=(Bt=class extends fe{constructor(e){super();A(this,"key","");A(this,"element");L.util.initPartial(e,this)}static fromBinary(e,n){return new Bt().fromBinary(e,n)}static fromJson(e,n){return new Bt().fromJson(e,n)}static fromJsonString(e,n){return new Bt().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Bt,e,n)}},A(Bt,"runtime",L),A(Bt,"typeName","yorkie.v1.RHTNode"),A(Bt,"fields",L.util.newFieldList(()=>[{no:1,name:"key",kind:"scalar",T:9},{no:2,name:"element",kind:"message",T:At}])),Bt);const wn=class wn extends fe{constructor(e){super();A(this,"next");A(this,"element");L.util.initPartial(e,this)}static fromBinary(e,n){return new wn().fromBinary(e,n)}static fromJson(e,n){return new wn().fromJson(e,n)}static fromJsonString(e,n){return new wn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(wn,e,n)}};A(wn,"runtime",L),A(wn,"typeName","yorkie.v1.RGANode"),A(wn,"fields",L.util.newFieldList(()=>[{no:1,name:"next",kind:"message",T:wn},{no:2,name:"element",kind:"message",T:At}]));let ys=wn;const or=class or extends fe{constructor(e){super();A(this,"value","");A(this,"updatedAt");A(this,"isRemoved",!1);L.util.initPartial(e,this)}static fromBinary(e,n){return new or().fromBinary(e,n)}static fromJson(e,n){return new or().fromJson(e,n)}static fromJsonString(e,n){return new or().fromJsonString(e,n)}static equals(e,n){return L.util.equals(or,e,n)}};A(or,"runtime",L),A(or,"typeName","yorkie.v1.NodeAttr"),A(or,"fields",L.util.newFieldList(()=>[{no:1,name:"value",kind:"scalar",T:9},{no:2,name:"updated_at",kind:"message",T:Te},{no:3,name:"is_removed",kind:"scalar",T:8}]));let Vi=or;const sr=class sr extends fe{constructor(e){super();A(this,"id");A(this,"value","");A(this,"removedAt");A(this,"insPrevId");A(this,"attributes",{});L.util.initPartial(e,this)}static fromBinary(e,n){return new sr().fromBinary(e,n)}static fromJson(e,n){return new sr().fromJson(e,n)}static fromJsonString(e,n){return new sr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(sr,e,n)}};A(sr,"runtime",L),A(sr,"typeName","yorkie.v1.TextNode"),A(sr,"fields",L.util.newFieldList(()=>[{no:1,name:"id",kind:"message",T:po},{no:2,name:"value",kind:"scalar",T:9},{no:3,name:"removed_at",kind:"message",T:Te},{no:4,name:"ins_prev_id",kind:"message",T:po},{no:5,name:"attributes",kind:"map",K:9,V:{kind:"message",T:Vi}}]));let vs=sr;const ar=class ar extends fe{constructor(e){super();A(this,"createdAt");A(this,"offset",0);L.util.initPartial(e,this)}static fromBinary(e,n){return new ar().fromBinary(e,n)}static fromJson(e,n){return new ar().fromJson(e,n)}static fromJsonString(e,n){return new ar().fromJsonString(e,n)}static equals(e,n){return L.util.equals(ar,e,n)}};A(ar,"runtime",L),A(ar,"typeName","yorkie.v1.TextNodeID"),A(ar,"fields",L.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:Te},{no:2,name:"offset",kind:"scalar",T:5}]));let po=ar;const lr=class lr extends fe{constructor(e){super();A(this,"id");A(this,"type","");A(this,"value","");A(this,"removedAt");A(this,"insPrevId");A(this,"insNextId");A(this,"depth",0);A(this,"attributes",{});L.util.initPartial(e,this)}static fromBinary(e,n){return new lr().fromBinary(e,n)}static fromJson(e,n){return new lr().fromJson(e,n)}static fromJsonString(e,n){return new lr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(lr,e,n)}};A(lr,"runtime",L),A(lr,"typeName","yorkie.v1.TreeNode"),A(lr,"fields",L.util.newFieldList(()=>[{no:1,name:"id",kind:"message",T:si},{no:2,name:"type",kind:"scalar",T:9},{no:3,name:"value",kind:"scalar",T:9},{no:4,name:"removed_at",kind:"message",T:Te},{no:5,name:"ins_prev_id",kind:"message",T:si},{no:6,name:"ins_next_id",kind:"message",T:si},{no:7,name:"depth",kind:"scalar",T:5},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"message",T:Vi}}]));let mo=lr;const ur=class ur extends fe{constructor(e){super();A(this,"content",[]);L.util.initPartial(e,this)}static fromBinary(e,n){return new ur().fromBinary(e,n)}static fromJson(e,n){return new ur().fromJson(e,n)}static fromJsonString(e,n){return new ur().fromJsonString(e,n)}static equals(e,n){return L.util.equals(ur,e,n)}};A(ur,"runtime",L),A(ur,"typeName","yorkie.v1.TreeNodes"),A(ur,"fields",L.util.newFieldList(()=>[{no:1,name:"content",kind:"message",T:mo,repeated:!0}]));let bs=ur;const cr=class cr extends fe{constructor(e){super();A(this,"createdAt");A(this,"offset",0);L.util.initPartial(e,this)}static fromBinary(e,n){return new cr().fromBinary(e,n)}static fromJson(e,n){return new cr().fromJson(e,n)}static fromJsonString(e,n){return new cr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(cr,e,n)}};A(cr,"runtime",L),A(cr,"typeName","yorkie.v1.TreeNodeID"),A(cr,"fields",L.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:Te},{no:2,name:"offset",kind:"scalar",T:5}]));let si=cr;const fr=class fr extends fe{constructor(e){super();A(this,"parentId");A(this,"leftSiblingId");L.util.initPartial(e,this)}static fromBinary(e,n){return new fr().fromBinary(e,n)}static fromJson(e,n){return new fr().fromJson(e,n)}static fromJsonString(e,n){return new fr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(fr,e,n)}};A(fr,"runtime",L),A(fr,"typeName","yorkie.v1.TreePos"),A(fr,"fields",L.util.newFieldList(()=>[{no:1,name:"parent_id",kind:"message",T:si},{no:2,name:"left_sibling_id",kind:"message",T:si}]));let xi=fr;const hr=class hr extends fe{constructor(e){super();A(this,"id","");A(this,"username","");A(this,"createdAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new hr().fromBinary(e,n)}static fromJson(e,n){return new hr().fromJson(e,n)}static fromJsonString(e,n){return new hr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(hr,e,n)}};A(hr,"runtime",L),A(hr,"typeName","yorkie.v1.User"),A(hr,"fields",L.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"created_at",kind:"message",T:gt}]));let bl=hr;const dr=class dr extends fe{constructor(e){super();A(this,"id","");A(this,"name","");A(this,"publicKey","");A(this,"secretKey","");A(this,"authWebhookUrl","");A(this,"authWebhookMethods",[]);A(this,"clientDeactivateThreshold","");A(this,"createdAt");A(this,"updatedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new dr().fromBinary(e,n)}static fromJson(e,n){return new dr().fromJson(e,n)}static fromJsonString(e,n){return new dr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(dr,e,n)}};A(dr,"runtime",L),A(dr,"typeName","yorkie.v1.Project"),A(dr,"fields",L.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"public_key",kind:"scalar",T:9},{no:4,name:"secret_key",kind:"scalar",T:9},{no:5,name:"auth_webhook_url",kind:"scalar",T:9},{no:6,name:"auth_webhook_methods",kind:"scalar",T:9,repeated:!0},{no:7,name:"client_deactivate_threshold",kind:"scalar",T:9},{no:8,name:"created_at",kind:"message",T:gt},{no:9,name:"updated_at",kind:"message",T:gt}]));let wl=dr;const gr=class gr extends fe{constructor(e){super();A(this,"name");A(this,"authWebhookUrl");A(this,"authWebhookMethods");A(this,"clientDeactivateThreshold");L.util.initPartial(e,this)}static fromBinary(e,n){return new gr().fromBinary(e,n)}static fromJson(e,n){return new gr().fromJson(e,n)}static fromJsonString(e,n){return new gr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(gr,e,n)}};A(gr,"runtime",L),A(gr,"typeName","yorkie.v1.UpdatableProjectFields"),A(gr,"fields",L.util.newFieldList(()=>[{no:1,name:"name",kind:"message",T:Ot},{no:2,name:"auth_webhook_url",kind:"message",T:Ot},{no:3,name:"auth_webhook_methods",kind:"message",T:Ys},{no:4,name:"client_deactivate_threshold",kind:"message",T:Ot}]));let Tl=gr;const pr=class pr extends fe{constructor(e){super();A(this,"methods",[]);L.util.initPartial(e,this)}static fromBinary(e,n){return new pr().fromBinary(e,n)}static fromJson(e,n){return new pr().fromJson(e,n)}static fromJsonString(e,n){return new pr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(pr,e,n)}};A(pr,"runtime",L),A(pr,"typeName","yorkie.v1.UpdatableProjectFields.AuthWebhookMethods"),A(pr,"fields",L.util.newFieldList(()=>[{no:1,name:"methods",kind:"scalar",T:9,repeated:!0}]));let Ys=pr;const mr=class mr extends fe{constructor(e){super();A(this,"id","");A(this,"key","");A(this,"snapshot","");A(this,"createdAt");A(this,"accessedAt");A(this,"updatedAt");L.util.initPartial(e,this)}static fromBinary(e,n){return new mr().fromBinary(e,n)}static fromJson(e,n){return new mr().fromJson(e,n)}static fromJsonString(e,n){return new mr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(mr,e,n)}};A(mr,"runtime",L),A(mr,"typeName","yorkie.v1.DocumentSummary"),A(mr,"fields",L.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"key",kind:"scalar",T:9},{no:3,name:"snapshot",kind:"scalar",T:9},{no:4,name:"created_at",kind:"message",T:gt},{no:5,name:"accessed_at",kind:"message",T:gt},{no:6,name:"updated_at",kind:"message",T:gt}]));let Al=mr;const yr=class yr extends fe{constructor(e){super();A(this,"type",0);A(this,"presence");L.util.initPartial(e,this)}static fromBinary(e,n){return new yr().fromBinary(e,n)}static fromJson(e,n){return new yr().fromJson(e,n)}static fromJsonString(e,n){return new yr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(yr,e,n)}};A(yr,"runtime",L),A(yr,"typeName","yorkie.v1.PresenceChange"),A(yr,"fields",L.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:L.getEnumType(Oi)},{no:2,name:"presence",kind:"message",T:Ea}]));let yo=yr;var Oi=(i=>(i[i.UNSPECIFIED=0]="UNSPECIFIED",i[i.PUT=1]="PUT",i[i.DELETE=2]="DELETE",i[i.CLEAR=3]="CLEAR",i))(Oi||{});L.util.setEnumType(Oi,"yorkie.v1.PresenceChange.ChangeType",[{no:0,name:"CHANGE_TYPE_UNSPECIFIED"},{no:1,name:"CHANGE_TYPE_PUT"},{no:2,name:"CHANGE_TYPE_DELETE"},{no:3,name:"CHANGE_TYPE_CLEAR"}]);var qt;let Ea=(qt=class extends fe{constructor(e){super();A(this,"data",{});L.util.initPartial(e,this)}static fromBinary(e,n){return new qt().fromBinary(e,n)}static fromJson(e,n){return new qt().fromJson(e,n)}static fromJsonString(e,n){return new qt().fromJsonString(e,n)}static equals(e,n){return L.util.equals(qt,e,n)}},A(qt,"runtime",L),A(qt,"typeName","yorkie.v1.Presence"),A(qt,"fields",L.util.newFieldList(()=>[{no:1,name:"data",kind:"map",K:9,V:{kind:"scalar",T:9}}])),qt);var Mt;let fu=(Mt=class extends fe{constructor(e){super();A(this,"serverSeq",Ye.zero);A(this,"clientSeq",0);L.util.initPartial(e,this)}static fromBinary(e,n){return new Mt().fromBinary(e,n)}static fromJson(e,n){return new Mt().fromJson(e,n)}static fromJsonString(e,n){return new Mt().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Mt,e,n)}},A(Mt,"runtime",L),A(Mt,"typeName","yorkie.v1.Checkpoint"),A(Mt,"fields",L.util.newFieldList(()=>[{no:1,name:"server_seq",kind:"scalar",T:3},{no:2,name:"client_seq",kind:"scalar",T:13}])),Mt);const vr=class vr extends fe{constructor(e){super();A(this,"createdAt");A(this,"offset",0);A(this,"relativeOffset",0);L.util.initPartial(e,this)}static fromBinary(e,n){return new vr().fromBinary(e,n)}static fromJson(e,n){return new vr().fromJson(e,n)}static fromJsonString(e,n){return new vr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(vr,e,n)}};A(vr,"runtime",L),A(vr,"typeName","yorkie.v1.TextNodePos"),A(vr,"fields",L.util.newFieldList(()=>[{no:1,name:"created_at",kind:"message",T:Te},{no:2,name:"offset",kind:"scalar",T:5},{no:3,name:"relative_offset",kind:"scalar",T:5}]));let zr=vr;var jt;let Te=(jt=class extends fe{constructor(e){super();A(this,"lamport",Ye.zero);A(this,"delimiter",0);A(this,"actorId",new Uint8Array(0));L.util.initPartial(e,this)}static fromBinary(e,n){return new jt().fromBinary(e,n)}static fromJson(e,n){return new jt().fromJson(e,n)}static fromJsonString(e,n){return new jt().fromJsonString(e,n)}static equals(e,n){return L.util.equals(jt,e,n)}},A(jt,"runtime",L),A(jt,"typeName","yorkie.v1.TimeTicket"),A(jt,"fields",L.util.newFieldList(()=>[{no:1,name:"lamport",kind:"scalar",T:3},{no:2,name:"delimiter",kind:"scalar",T:13},{no:3,name:"actor_id",kind:"scalar",T:12}])),jt);const br=class br extends fe{constructor(e){super();A(this,"topic","");A(this,"payload",new Uint8Array(0));L.util.initPartial(e,this)}static fromBinary(e,n){return new br().fromBinary(e,n)}static fromJson(e,n){return new br().fromJson(e,n)}static fromJsonString(e,n){return new br().fromJsonString(e,n)}static equals(e,n){return L.util.equals(br,e,n)}};A(br,"runtime",L),A(br,"typeName","yorkie.v1.DocEventBody"),A(br,"fields",L.util.newFieldList(()=>[{no:1,name:"topic",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12}]));let Zs=br;const wr=class wr extends fe{constructor(e){super();A(this,"type",0);A(this,"publisher","");A(this,"body");L.util.initPartial(e,this)}static fromBinary(e,n){return new wr().fromBinary(e,n)}static fromJson(e,n){return new wr().fromJson(e,n)}static fromJsonString(e,n){return new wr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(wr,e,n)}};A(wr,"runtime",L),A(wr,"typeName","yorkie.v1.DocEvent"),A(wr,"fields",L.util.newFieldList(()=>[{no:1,name:"type",kind:"enum",T:L.getEnumType(Ei)},{no:2,name:"publisher",kind:"scalar",T:9},{no:3,name:"body",kind:"message",T:Zs}]));let Xs=wr;const Tr=class Tr extends fe{constructor(e){super();A(this,"clientKey","");A(this,"metadata",{});L.util.initPartial(e,this)}static fromBinary(e,n){return new Tr().fromBinary(e,n)}static fromJson(e,n){return new Tr().fromJson(e,n)}static fromJsonString(e,n){return new Tr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Tr,e,n)}};A(Tr,"runtime",L),A(Tr,"typeName","yorkie.v1.ActivateClientRequest"),A(Tr,"fields",L.util.newFieldList(()=>[{no:1,name:"client_key",kind:"scalar",T:9},{no:2,name:"metadata",kind:"map",K:9,V:{kind:"scalar",T:9}}]));let Qs=Tr;const Ar=class Ar extends fe{constructor(e){super();A(this,"clientId","");L.util.initPartial(e,this)}static fromBinary(e,n){return new Ar().fromBinary(e,n)}static fromJson(e,n){return new Ar().fromJson(e,n)}static fromJsonString(e,n){return new Ar().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Ar,e,n)}};A(Ar,"runtime",L),A(Ar,"typeName","yorkie.v1.ActivateClientResponse"),A(Ar,"fields",L.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9}]));let ea=Ar;const Sr=class Sr extends fe{constructor(e){super();A(this,"clientId","");L.util.initPartial(e,this)}static fromBinary(e,n){return new Sr().fromBinary(e,n)}static fromJson(e,n){return new Sr().fromJson(e,n)}static fromJsonString(e,n){return new Sr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Sr,e,n)}};A(Sr,"runtime",L),A(Sr,"typeName","yorkie.v1.DeactivateClientRequest"),A(Sr,"fields",L.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9}]));let ta=Sr;const Er=class Er extends fe{constructor(t){super(),L.util.initPartial(t,this)}static fromBinary(t,e){return new Er().fromBinary(t,e)}static fromJson(t,e){return new Er().fromJson(t,e)}static fromJsonString(t,e){return new Er().fromJsonString(t,e)}static equals(t,e){return L.util.equals(Er,t,e)}};A(Er,"runtime",L),A(Er,"typeName","yorkie.v1.DeactivateClientResponse"),A(Er,"fields",L.util.newFieldList(()=>[]));let na=Er;const xr=class xr extends fe{constructor(e){super();A(this,"clientId","");A(this,"changePack");L.util.initPartial(e,this)}static fromBinary(e,n){return new xr().fromBinary(e,n)}static fromJson(e,n){return new xr().fromJson(e,n)}static fromJsonString(e,n){return new xr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(xr,e,n)}};A(xr,"runtime",L),A(xr,"typeName","yorkie.v1.AttachDocumentRequest"),A(xr,"fields",L.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:Kr}]));let ra=xr;const Or=class Or extends fe{constructor(e){super();A(this,"documentId","");A(this,"changePack");L.util.initPartial(e,this)}static fromBinary(e,n){return new Or().fromBinary(e,n)}static fromJson(e,n){return new Or().fromJson(e,n)}static fromJsonString(e,n){return new Or().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Or,e,n)}};A(Or,"runtime",L),A(Or,"typeName","yorkie.v1.AttachDocumentResponse"),A(Or,"fields",L.util.newFieldList(()=>[{no:1,name:"document_id",kind:"scalar",T:9},{no:2,name:"change_pack",kind:"message",T:Kr}]));let ia=Or;const kr=class kr extends fe{constructor(e){super();A(this,"clientId","");A(this,"documentId","");A(this,"changePack");A(this,"removeIfNotAttached",!1);L.util.initPartial(e,this)}static fromBinary(e,n){return new kr().fromBinary(e,n)}static fromJson(e,n){return new kr().fromJson(e,n)}static fromJsonString(e,n){return new kr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(kr,e,n)}};A(kr,"runtime",L),A(kr,"typeName","yorkie.v1.DetachDocumentRequest"),A(kr,"fields",L.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:Kr},{no:4,name:"remove_if_not_attached",kind:"scalar",T:8}]));let oa=kr;const Ir=class Ir extends fe{constructor(e){super();A(this,"changePack");L.util.initPartial(e,this)}static fromBinary(e,n){return new Ir().fromBinary(e,n)}static fromJson(e,n){return new Ir().fromJson(e,n)}static fromJsonString(e,n){return new Ir().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Ir,e,n)}};A(Ir,"runtime",L),A(Ir,"typeName","yorkie.v1.DetachDocumentResponse"),A(Ir,"fields",L.util.newFieldList(()=>[{no:2,name:"change_pack",kind:"message",T:Kr}]));let sa=Ir;const Nr=class Nr extends fe{constructor(e){super();A(this,"clientId","");A(this,"documentId","");L.util.initPartial(e,this)}static fromBinary(e,n){return new Nr().fromBinary(e,n)}static fromJson(e,n){return new Nr().fromJson(e,n)}static fromJsonString(e,n){return new Nr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Nr,e,n)}};A(Nr,"runtime",L),A(Nr,"typeName","yorkie.v1.WatchDocumentRequest"),A(Nr,"fields",L.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9}]));let aa=Nr;const _r=class _r extends fe{constructor(e){super();A(this,"body",{case:void 0});L.util.initPartial(e,this)}static fromBinary(e,n){return new _r().fromBinary(e,n)}static fromJson(e,n){return new _r().fromJson(e,n)}static fromJsonString(e,n){return new _r().fromJsonString(e,n)}static equals(e,n){return L.util.equals(_r,e,n)}};A(_r,"runtime",L),A(_r,"typeName","yorkie.v1.WatchDocumentResponse"),A(_r,"fields",L.util.newFieldList(()=>[{no:1,name:"initialization",kind:"message",T:ua,oneof:"body"},{no:2,name:"event",kind:"message",T:Xs,oneof:"body"}]));let la=_r;const Pr=class Pr extends fe{constructor(e){super();A(this,"clientIds",[]);L.util.initPartial(e,this)}static fromBinary(e,n){return new Pr().fromBinary(e,n)}static fromJson(e,n){return new Pr().fromJson(e,n)}static fromJsonString(e,n){return new Pr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Pr,e,n)}};A(Pr,"runtime",L),A(Pr,"typeName","yorkie.v1.WatchDocumentResponse.Initialization"),A(Pr,"fields",L.util.newFieldList(()=>[{no:1,name:"client_ids",kind:"scalar",T:9,repeated:!0}]));let ua=Pr;const Cr=class Cr extends fe{constructor(e){super();A(this,"clientId","");A(this,"documentId","");A(this,"changePack");L.util.initPartial(e,this)}static fromBinary(e,n){return new Cr().fromBinary(e,n)}static fromJson(e,n){return new Cr().fromJson(e,n)}static fromJsonString(e,n){return new Cr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Cr,e,n)}};A(Cr,"runtime",L),A(Cr,"typeName","yorkie.v1.RemoveDocumentRequest"),A(Cr,"fields",L.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:Kr}]));let ca=Cr;const Lr=class Lr extends fe{constructor(e){super();A(this,"changePack");L.util.initPartial(e,this)}static fromBinary(e,n){return new Lr().fromBinary(e,n)}static fromJson(e,n){return new Lr().fromJson(e,n)}static fromJsonString(e,n){return new Lr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Lr,e,n)}};A(Lr,"runtime",L),A(Lr,"typeName","yorkie.v1.RemoveDocumentResponse"),A(Lr,"fields",L.util.newFieldList(()=>[{no:1,name:"change_pack",kind:"message",T:Kr}]));let fa=Lr;const Rr=class Rr extends fe{constructor(e){super();A(this,"clientId","");A(this,"documentId","");A(this,"changePack");A(this,"pushOnly",!1);L.util.initPartial(e,this)}static fromBinary(e,n){return new Rr().fromBinary(e,n)}static fromJson(e,n){return new Rr().fromJson(e,n)}static fromJsonString(e,n){return new Rr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Rr,e,n)}};A(Rr,"runtime",L),A(Rr,"typeName","yorkie.v1.PushPullChangesRequest"),A(Rr,"fields",L.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"change_pack",kind:"message",T:Kr},{no:4,name:"push_only",kind:"scalar",T:8}]));let ha=Rr;const Dr=class Dr extends fe{constructor(e){super();A(this,"changePack");L.util.initPartial(e,this)}static fromBinary(e,n){return new Dr().fromBinary(e,n)}static fromJson(e,n){return new Dr().fromJson(e,n)}static fromJsonString(e,n){return new Dr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Dr,e,n)}};A(Dr,"runtime",L),A(Dr,"typeName","yorkie.v1.PushPullChangesResponse"),A(Dr,"fields",L.util.newFieldList(()=>[{no:1,name:"change_pack",kind:"message",T:Kr}]));let da=Dr;const Br=class Br extends fe{constructor(e){super();A(this,"clientId","");A(this,"documentId","");A(this,"topic","");A(this,"payload",new Uint8Array(0));L.util.initPartial(e,this)}static fromBinary(e,n){return new Br().fromBinary(e,n)}static fromJson(e,n){return new Br().fromJson(e,n)}static fromJsonString(e,n){return new Br().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Br,e,n)}};A(Br,"runtime",L),A(Br,"typeName","yorkie.v1.BroadcastRequest"),A(Br,"fields",L.util.newFieldList(()=>[{no:1,name:"client_id",kind:"scalar",T:9},{no:2,name:"document_id",kind:"scalar",T:9},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"payload",kind:"scalar",T:12}]));let ga=Br;const qr=class qr extends fe{constructor(t){super(),L.util.initPartial(t,this)}static fromBinary(t,e){return new qr().fromBinary(t,e)}static fromJson(t,e){return new qr().fromJson(t,e)}static fromJsonString(t,e){return new qr().fromJsonString(t,e)}static equals(t,e){return L.util.equals(qr,t,e)}};A(qr,"runtime",L),A(qr,"typeName","yorkie.v1.BroadcastResponse"),A(qr,"fields",L.util.newFieldList(()=>[]));let pa=qr;const bf={typeName:"yorkie.v1.YorkieService",methods:{activateClient:{name:"ActivateClient",I:Qs,O:ea,kind:mt.Unary},deactivateClient:{name:"DeactivateClient",I:ta,O:na,kind:mt.Unary},attachDocument:{name:"AttachDocument",I:ra,O:ia,kind:mt.Unary},detachDocument:{name:"DetachDocument",I:oa,O:sa,kind:mt.Unary},removeDocument:{name:"RemoveDocument",I:ca,O:fa,kind:mt.Unary},pushPullChanges:{name:"PushPullChanges",I:ha,O:da,kind:mt.Unary},watchDocument:{name:"WatchDocument",I:aa,O:la,kind:mt.ServerStreaming},broadcast:{name:"Broadcast",I:ga,O:pa,kind:mt.Unary}}},wf=L.makeMessageType("google.rpc.ErrorInfo",()=>[{no:1,name:"reason",kind:"scalar",T:9},{no:2,name:"domain",kind:"scalar",T:9},{no:3,name:"metadata",kind:"map",K:9,V:{kind:"scalar",T:9}}]);L.makeMessageType("google.rpc.RetryInfo",()=>[{no:1,name:"retry_delay",kind:"message",T:jr}]);L.makeMessageType("google.rpc.DebugInfo",()=>[{no:1,name:"stack_entries",kind:"scalar",T:9,repeated:!0},{no:2,name:"detail",kind:"scalar",T:9}]);L.makeMessageType("google.rpc.QuotaFailure",()=>[{no:1,name:"violations",kind:"message",T:Tf,repeated:!0}]);const Tf=L.makeMessageType("google.rpc.QuotaFailure.Violation",()=>[{no:1,name:"subject",kind:"scalar",T:9},{no:2,name:"description",kind:"scalar",T:9}],{localName:"QuotaFailure_Violation"});L.makeMessageType("google.rpc.PreconditionFailure",()=>[{no:1,name:"violations",kind:"message",T:Af,repeated:!0}]);const Af=L.makeMessageType("google.rpc.PreconditionFailure.Violation",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"subject",kind:"scalar",T:9},{no:3,name:"description",kind:"scalar",T:9}],{localName:"PreconditionFailure_Violation"});L.makeMessageType("google.rpc.BadRequest",()=>[{no:1,name:"field_violations",kind:"message",T:Sf,repeated:!0}]);const Sf=L.makeMessageType("google.rpc.BadRequest.FieldViolation",()=>[{no:1,name:"field",kind:"scalar",T:9},{no:2,name:"description",kind:"scalar",T:9},{no:3,name:"reason",kind:"scalar",T:9},{no:4,name:"localized_message",kind:"message",T:xf}],{localName:"BadRequest_FieldViolation"});L.makeMessageType("google.rpc.RequestInfo",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"serving_data",kind:"scalar",T:9}]);L.makeMessageType("google.rpc.ResourceInfo",()=>[{no:1,name:"resource_type",kind:"scalar",T:9},{no:2,name:"resource_name",kind:"scalar",T:9},{no:3,name:"owner",kind:"scalar",T:9},{no:4,name:"description",kind:"scalar",T:9}]);L.makeMessageType("google.rpc.Help",()=>[{no:1,name:"links",kind:"message",T:Ef,repeated:!0}]);const Ef=L.makeMessageType("google.rpc.Help.Link",()=>[{no:1,name:"description",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9}],{localName:"Help_Link"}),xf=L.makeMessageType("google.rpc.LocalizedMessage",()=>[{no:1,name:"locale",kind:"scalar",T:9},{no:2,name:"message",kind:"scalar",T:9}]);var W=(i=>(i.Ok="ok",i.ErrClientNotActivated="ErrClientNotActivated",i.ErrClientNotFound="ErrClientNotFound",i.ErrUnimplemented="ErrUnimplemented",i.ErrInvalidType="ErrInvalidType",i.ErrDummy="ErrDummy",i.ErrDocumentNotAttached="ErrDocumentNotAttached",i.ErrDocumentNotDetached="ErrDocumentNotDetached",i.ErrDocumentRemoved="ErrDocumentRemoved",i.ErrInvalidObjectKey="ErrInvalidObjectKey",i.ErrInvalidArgument="ErrInvalidArgument",i.ErrNotInitialized="ErrNotInitialized",i.ErrNotReady="ErrNotReady",i.ErrRefused="ErrRefused",i.ErrContextNotProvided="ErrContextNotProvided",i.ErrPermissionDenied="ErrPermissionDenied",i.ErrUnauthenticated="ErrUnauthenticated",i.ErrTooManySubscribers="ErrTooManySubscribers",i.ErrTooManyAttachments="ErrTooManyAttachments",i))(W||{});class Z extends Error{constructor(e,n){super(n);A(this,"name","YorkieError");A(this,"stack");this.code=e,this.message=n,this.toString=()=>`[code=${this.code}]: ${this.message}`}}var Rn=(i=>(i.Put="put",i.Clear="clear",i))(Rn||{});const ks="000000000000000000000000",ai=24;class Jt{constructor(t,e,n){A(this,"lamport");A(this,"delimiter");A(this,"actorID");this.lamport=t,this.delimiter=e,this.actorID=n}static of(t,e,n){return new Jt(t,e,n)}static fromStruct(t){return Jt.of(BigInt(t.lamport),t.delimiter,t.actorID)}toIDString(){return`${this.lamport.toString()}:${this.actorID}:${this.delimiter}`}toStruct(){return{lamport:this.getLamportAsString(),delimiter:this.getDelimiter(),actorID:this.getActorID()}}toTestString(){return`${this.lamport.toString()}:${this.actorID.slice(-2)}:${this.delimiter}`}setActor(t){return new Jt(this.lamport,this.delimiter,t)}getLamportAsString(){return this.lamport.toString()}getLamport(){return this.lamport}getDelimiter(){return this.delimiter}getActorID(){return this.actorID}after(t){return this.compare(t)>0}equals(t){return this.compare(t)===0}compare(t){if(this.lamport>t.lamport)return 1;if(t.lamport>this.lamport)return-1;const e=this.actorID.localeCompare(t.actorID);return e!==0?e:this.delimiter>t.delimiter?1:t.delimiter>this.delimiter?-1:0}}const ma=0n,hu=0,co=9223372036854775807n,Ki=new Jt(ma,hu,ks);function Pn(i){return i.replace(/["'\\\n\r\f\b\t\u2028\u2029]/g,function(t){switch(t){case'"':case"\\":return"\\"+t;case`
`:return"\\n";case"\r":return"\\r";case"\f":return"\\f";case"\b":return"\\b";case"	":return"\\t";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return t}})}class xo{constructor(t){A(this,"createdAt");A(this,"movedAt");A(this,"removedAt");this.createdAt=t}getCreatedAt(){return this.createdAt}getID(){return this.createdAt}getMovedAt(){return this.movedAt}getRemovedAt(){return this.removedAt}getPositionedAt(){return this.movedAt?this.movedAt:this.createdAt}setMovedAt(t){return!this.movedAt||t&&t.after(this.movedAt)?(this.movedAt=t,!0):!1}setRemovedAt(t){this.removedAt=t}remove(t){return t&&t.after(this.getPositionedAt())&&(!this.removedAt||t.after(this.removedAt))?(this.removedAt=t,!0):!1}isRemoved(){return!!this.removedAt}getMetaUsage(){let t=0;return this.getCreatedAt()&&(t+=ai),this.getMovedAt()&&(t+=ai),this.getRemovedAt()&&(t+=ai),t}}class li extends xo{constructor(t){super(t)}}class xa{constructor(t,e){A(this,"strKey");A(this,"value");this.strKey=t,this.value=e}static of(t,e){return new xa(t,e)}isRemoved(){return this.value.isRemoved()}getStrKey(){return this.strKey}getValue(){return this.value}remove(t){return this.value.remove(t)}}class vo{constructor(){A(this,"nodeMapByKey");A(this,"nodeMapByCreatedAt");this.nodeMapByKey=new Map,this.nodeMapByCreatedAt=new Map}static create(){return new vo}set(t,e,n){let r;const o=this.nodeMapByKey.get(t);o!=null&&!o.isRemoved()&&o.remove(n)&&(r=o.getValue());const s=xa.of(t,e);return this.nodeMapByCreatedAt.set(e.getCreatedAt().toIDString(),s),(o==null||n.after(o.getValue().getPositionedAt()))&&(this.nodeMapByKey.set(t,s),e.setMovedAt(n)),r}delete(t,e){if(!this.nodeMapByCreatedAt.has(t.toIDString()))throw new Z(W.ErrInvalidArgument,`fail to find ${t.toIDString()}`);const n=this.nodeMapByCreatedAt.get(t.toIDString());return n.remove(e),n.getValue()}subPathOf(t){const e=this.nodeMapByCreatedAt.get(t.toIDString());if(e)return e.getStrKey()}purge(t){const e=this.nodeMapByCreatedAt.get(t.getCreatedAt().toIDString());if(!e)throw new Z(W.ErrInvalidArgument,`fail to find ${t.getCreatedAt().toIDString()}`);const n=this.nodeMapByKey.get(e.getStrKey());e===n&&this.nodeMapByKey.delete(n.getStrKey()),this.nodeMapByCreatedAt.delete(e.getValue().getCreatedAt().toIDString())}deleteByKey(t,e){const n=this.nodeMapByKey.get(t);if(n!=null&&n.remove(e))return n.getValue()}has(t){const e=this.nodeMapByKey.get(t);return e==null?!1:!e.isRemoved()}getByID(t){return this.nodeMapByCreatedAt.get(t.toIDString())}get(t){const e=this.nodeMapByKey.get(t);if(!(!e||e.isRemoved()))return e}*[Symbol.iterator](){for(const[,t]of this.nodeMapByKey)yield t}}class Tt extends li{constructor(e,n){super(e);A(this,"memberNodes");this.memberNodes=n}static create(e,n){if(!n)return new Tt(e,vo.create());const r=vo.create();for(const[o,s]of Object.entries(n))r.set(o,s.deepcopy(),s.getCreatedAt());return new Tt(e,r)}subPathOf(e){return this.memberNodes.subPathOf(e)}purge(e){this.memberNodes.purge(e)}set(e,n,r){return this.memberNodes.set(e,n,r)}delete(e,n){return this.memberNodes.delete(e,n)}deleteByKey(e,n){return this.memberNodes.deleteByKey(e,n)}get(e){const n=this.memberNodes.get(e);return n==null?void 0:n.getValue()}getByID(e){const n=this.memberNodes.getByID(e);return n==null?void 0:n.getValue()}has(e){return this.memberNodes.has(e)}getDataSize(){return{data:0,meta:this.getMetaUsage()}}toJSON(){const e=[];for(const[n,r]of this)e.push(`"${Pn(n)}":${r.toJSON()}`);return`{${e.join(",")}}`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const e={};for(const[n,r]of this){const{createdAt:o,value:s,type:c}=r.toJSForTest();e[n]={key:n,createdAt:o,value:s,type:c}}return{createdAt:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_OBJECT"}}getKeys(){const e=Array();for(const[n]of this)e.push(n);return e}toSortedJSON(){var r;const e=Array();for(const[o]of this)e.push(o);const n=[];for(const o of e.sort()){const s=(r=this.memberNodes.get(o))==null?void 0:r.getValue();n.push(`"${Pn(o)}":${s.toSortedJSON()}`)}return`{${n.join(",")}}`}getRHT(){return this.memberNodes}deepcopy(){const e=Tt.create(this.getCreatedAt());for(const n of this.memberNodes)e.memberNodes.set(n.getStrKey(),n.getValue().deepcopy(),this.getPositionedAt());return e.remove(this.getRemovedAt()),e}getDescendants(e){for(const n of this.memberNodes){const r=n.getValue();if(e(r,this))return;r instanceof li&&r.getDescendants(e)}}*[Symbol.iterator](){const e=new Set;for(const n of this.memberNodes)e.has(n.getStrKey())||(e.add(n.getStrKey()),n.isRemoved()||(yield[n.getStrKey(),n.getValue()]))}}var Ge=(i=>(i.Local="local",i.Remote="remote",i.UndoRedo="undoredo",i))(Ge||{});class on{constructor(t,e){A(this,"parentCreatedAt");A(this,"executedAt");this.parentCreatedAt=t,this.executedAt=e}getParentCreatedAt(){return this.parentCreatedAt}getExecutedAt(){if(!this.executedAt)throw new Z(W.ErrNotReady,"executedAt is not set yet");return this.executedAt}setActor(t){this.executedAt&&(this.executedAt=this.executedAt.setActor(t))}setExecutedAt(t){this.executedAt=t}}class du{constructor(t){A(this,"value");A(this,"left");A(this,"right");A(this,"parent");A(this,"weight");this.value=t,this.initWeight()}getNodeString(){return`${this.weight}${this.value}`}getValue(){return this.value}getLeftWeight(){return this.hasLeft()?this.left.getWeight():0}getRightWeight(){return this.hasRight()?this.right.getWeight():0}getWeight(){return this.weight}getLeft(){return this.left}getRight(){return this.right}getParent(){return this.parent}hasLeft(){return!!this.left}hasRight(){return!!this.right}hasParent(){return!!this.parent}setLeft(t){this.left=t}setRight(t){this.right=t}setParent(t){this.parent=t}unlink(){this.parent=void 0,this.right=void 0,this.left=void 0}hasLinks(){return this.hasParent()||this.hasLeft()||this.hasRight()}increaseWeight(t){this.weight+=t}initWeight(){this.weight=this.getLength()}}class bo{constructor(t){A(this,"root");this.root=t}get length(){return this.root?this.root.getWeight():0}find(t){if(!this.root||t<0)return[void 0,0];let e=this.root;for(;;)if(e.hasLeft()&&t<=e.getLeftWeight())e=e.getLeft();else if(e.hasRight()&&e.getLeftWeight()+e.getLength()<t)t-=e.getLeftWeight()+e.getLength(),e=e.getRight();else{t-=e.getLeftWeight();break}if(t>e.getLength())throw new Z(W.ErrInvalidArgument,`out of index range: pos: ${t} > node.length: ${e.getLength()}`);return this.splayNode(e),[e,t]}indexOf(t){return!t||t!==this.root&&!t.hasLinks()?-1:(this.splayNode(t),this.root.getLeftWeight())}getRoot(){return this.root}insert(t){return this.insertAfter(this.root,t)}insertAfter(t,e){return t?(this.splayNode(t),this.root=e,e.setRight(t.getRight()),t.hasRight()&&t.getRight().setParent(e),e.setLeft(t),t.setParent(e),t.setRight(),this.updateWeight(t),this.updateWeight(e),e):(this.root=e,e)}updateWeight(t){t.initWeight(),t.hasLeft()&&t.increaseWeight(t.getLeftWeight()),t.hasRight()&&t.increaseWeight(t.getRightWeight())}updateTreeWeight(t){for(;t;)this.updateWeight(t),t=t.getParent()}splayNode(t){if(t)for(;;)if(this.isLeftChild(t.getParent())&&this.isRightChild(t))this.rotateLeft(t),this.rotateRight(t);else if(this.isRightChild(t.getParent())&&this.isLeftChild(t))this.rotateRight(t),this.rotateLeft(t);else if(this.isLeftChild(t.getParent())&&this.isLeftChild(t))this.rotateRight(t.getParent()),this.rotateRight(t);else if(this.isRightChild(t.getParent())&&this.isRightChild(t))this.rotateLeft(t.getParent()),this.rotateLeft(t);else{this.isLeftChild(t)?this.rotateRight(t):this.isRightChild(t)&&this.rotateLeft(t),this.updateWeight(t);return}}delete(t){this.splayNode(t);const e=new bo(t.getLeft());e.root&&e.root.setParent();const n=new bo(t.getRight());if(n.root&&n.root.setParent(),e.root){const r=e.getRightmost();e.splayNode(r),e.root.setRight(n.root),n.root&&n.root.setParent(e.root),this.root=e.root}else this.root=n.root;t.unlink(),this.root&&this.updateWeight(this.root)}deleteRange(t,e){if(!e){this.splayNode(t),this.cutOffRight(t);return}this.splayNode(t),this.splayNode(e),e.getLeft()!=t&&this.rotateRight(t),this.cutOffRight(t)}cutOffRight(t){const e=[];this.traversePostorder(t.getRight(),e);for(const n of e)n.initWeight();this.updateTreeWeight(t)}toTestString(){const t=[];return this.traverseInorder(this.root,t),t.map(e=>`[${e.getWeight()},${e.getLength()}]${e.getValue()||""}`).join("")}checkWeight(){const t=[];this.traverseInorder(this.root,t);for(const e of t)if(e.getWeight()!=e.getLength()+e.getLeftWeight()+e.getRightWeight())return!1;return!0}getRightmost(){let t=this.root;for(;t.hasRight();)t=t.getRight();return t}traverseInorder(t,e){t&&(this.traverseInorder(t.getLeft(),e),e.push(t),this.traverseInorder(t.getRight(),e))}traversePostorder(t,e){t&&(this.traversePostorder(t.getLeft(),e),this.traversePostorder(t.getRight(),e),e.push(t))}rotateLeft(t){const e=t.getParent();e.hasParent()?e===e.getParent().getLeft()?e.getParent().setLeft(t):e.getParent().setRight(t):this.root=t,t.setParent(e.getParent()),e.setRight(t.getLeft()),e.hasRight()&&e.getRight().setParent(e),t.setLeft(e),t.getLeft().setParent(t),this.updateWeight(e),this.updateWeight(t)}rotateRight(t){const e=t.getParent();e.hasParent()?e===e.getParent().getLeft()?e.getParent().setLeft(t):e.getParent().setRight(t):this.root=t,t.setParent(e.getParent()),e.setLeft(t.getRight()),e.hasLeft()&&e.getLeft().setParent(e),t.setRight(e),t.getRight().setParent(t),this.updateWeight(e),this.updateWeight(t)}isLeftChild(t){return t&&t.hasParent()?t.getParent().getLeft()===t:!1}isRightChild(t){return t&&t.hasParent()?t.getParent().getRight()===t:!1}}/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var Ft=null;try{Ft=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Me(i,t,e){this.low=i|0,this.high=t|0,this.unsigned=!!e}Me.prototype.__isLong__;Object.defineProperty(Me.prototype,"__isLong__",{value:!0});function pt(i){return(i&&i.__isLong__)===!0}function Sl(i){var t=Math.clz32(i&-i);return i?31-t:t}Me.isLong=pt;var El={},xl={};function Ii(i,t){var e,n,r;return t?(i>>>=0,(r=0<=i&&i<256)&&(n=xl[i],n)?n:(e=Je(i,0,!0),r&&(xl[i]=e),e)):(i|=0,(r=-128<=i&&i<128)&&(n=El[i],n)?n:(e=Je(i,i<0?-1:0,!1),r&&(El[i]=e),e))}Me.fromInt=Ii;function Ut(i,t){if(isNaN(i))return t?Ur:tn;if(t){if(i<0)return Ur;if(i>=gu)return yu}else{if(i<=-9223372036854776e3)return wt;if(i+1>=kf)return mu}return i<0?Ut(-i,t).neg():Je(i%Hi|0,i/Hi|0,t)}Me.fromNumber=Ut;function Je(i,t,e){return new Me(i,t,e)}Me.fromBits=Je;var ws=Math.pow;function Oa(i,t,e){if(i.length===0)throw Error("empty string");if(typeof t=="number"?(e=t,t=!1):t=!!t,i==="NaN"||i==="Infinity"||i==="+Infinity"||i==="-Infinity")return t?Ur:tn;if(e=e||10,e<2||36<e)throw RangeError("radix");var n;if((n=i.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return Oa(i.substring(1),t,e).neg();for(var r=Ut(ws(e,8)),o=tn,s=0;s<i.length;s+=8){var c=Math.min(8,i.length-s),u=parseInt(i.substring(s,s+c),e);if(c<8){var d=Ut(ws(e,c));o=o.mul(d).add(Ut(u))}else o=o.mul(r),o=o.add(Ut(u))}return o.unsigned=t,o}Me.fromString=Oa;function Vt(i,t){return typeof i=="number"?Ut(i,t):typeof i=="string"?Oa(i,t):Je(i.low,i.high,typeof t=="boolean"?t:i.unsigned)}Me.fromValue=Vt;var Ol=65536,Of=1<<24,Hi=Ol*Ol,gu=Hi*Hi,kf=gu/2,kl=Ii(Of),tn=Ii(0);Me.ZERO=tn;var Ur=Ii(0,!0);Me.UZERO=Ur;var Mi=Ii(1);Me.ONE=Mi;var pu=Ii(1,!0);Me.UONE=pu;var ya=Ii(-1);Me.NEG_ONE=ya;var mu=Je(-1,2147483647,!1);Me.MAX_VALUE=mu;var yu=Je(-1,-1,!0);Me.MAX_UNSIGNED_VALUE=yu;var wt=Je(0,-2147483648,!1);Me.MIN_VALUE=wt;var se=Me.prototype;se.toInt=function(){return this.unsigned?this.low>>>0:this.low};se.toNumber=function(){return this.unsigned?(this.high>>>0)*Hi+(this.low>>>0):this.high*Hi+(this.low>>>0)};se.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(wt)){var e=Ut(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var o=Ut(ws(t,6),this.unsigned),s=this,c="";;){var u=s.div(o),d=s.sub(u.mul(o)).toInt()>>>0,m=d.toString(t);if(s=u,s.isZero())return m+c;for(;m.length<6;)m="0"+m;c=""+m+c}};se.getHighBits=function(){return this.high};se.getHighBitsUnsigned=function(){return this.high>>>0};se.getLowBits=function(){return this.low};se.getLowBitsUnsigned=function(){return this.low>>>0};se.getNumBitsAbs=function(){if(this.isNegative())return this.eq(wt)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return this.high!=0?e+33:e+1};se.isSafeInteger=function(){var t=this.high>>21;return t?this.unsigned?!1:t===-1&&!(this.low===0&&this.high===-2097152):!0};se.isZero=function(){return this.high===0&&this.low===0};se.eqz=se.isZero;se.isNegative=function(){return!this.unsigned&&this.high<0};se.isPositive=function(){return this.unsigned||this.high>=0};se.isOdd=function(){return(this.low&1)===1};se.isEven=function(){return(this.low&1)===0};se.equals=function(t){return pt(t)||(t=Vt(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low};se.eq=se.equals;se.notEquals=function(t){return!this.eq(t)};se.neq=se.notEquals;se.ne=se.notEquals;se.lessThan=function(t){return this.comp(t)<0};se.lt=se.lessThan;se.lessThanOrEqual=function(t){return this.comp(t)<=0};se.lte=se.lessThanOrEqual;se.le=se.lessThanOrEqual;se.greaterThan=function(t){return this.comp(t)>0};se.gt=se.greaterThan;se.greaterThanOrEqual=function(t){return this.comp(t)>=0};se.gte=se.greaterThanOrEqual;se.ge=se.greaterThanOrEqual;se.compare=function(t){if(pt(t)||(t=Vt(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1};se.comp=se.compare;se.negate=function(){return!this.unsigned&&this.eq(wt)?wt:this.not().add(Mi)};se.neg=se.negate;se.add=function(t){pt(t)||(t=Vt(t));var e=this.high>>>16,n=this.high&65535,r=this.low>>>16,o=this.low&65535,s=t.high>>>16,c=t.high&65535,u=t.low>>>16,d=t.low&65535,m=0,h=0,l=0,a=0;return a+=o+d,l+=a>>>16,a&=65535,l+=r+u,h+=l>>>16,l&=65535,h+=n+c,m+=h>>>16,h&=65535,m+=e+s,m&=65535,Je(l<<16|a,m<<16|h,this.unsigned)};se.subtract=function(t){return pt(t)||(t=Vt(t)),this.add(t.neg())};se.sub=se.subtract;se.multiply=function(t){if(this.isZero())return this;if(pt(t)||(t=Vt(t)),Ft){var e=Ft.mul(this.low,this.high,t.low,t.high);return Je(e,Ft.get_high(),this.unsigned)}if(t.isZero())return this.unsigned?Ur:tn;if(this.eq(wt))return t.isOdd()?wt:tn;if(t.eq(wt))return this.isOdd()?wt:tn;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(kl)&&t.lt(kl))return Ut(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,r=this.high&65535,o=this.low>>>16,s=this.low&65535,c=t.high>>>16,u=t.high&65535,d=t.low>>>16,m=t.low&65535,h=0,l=0,a=0,v=0;return v+=s*m,a+=v>>>16,v&=65535,a+=o*m,l+=a>>>16,a&=65535,a+=s*d,l+=a>>>16,a&=65535,l+=r*m,h+=l>>>16,l&=65535,l+=o*d,h+=l>>>16,l&=65535,l+=s*u,h+=l>>>16,l&=65535,h+=n*m+r*d+o*u+s*c,h&=65535,Je(a<<16|v,h<<16|l,this.unsigned)};se.mul=se.multiply;se.divide=function(t){if(pt(t)||(t=Vt(t)),t.isZero())throw Error("division by zero");if(Ft){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var e=(this.unsigned?Ft.div_u:Ft.div_s)(this.low,this.high,t.low,t.high);return Je(e,Ft.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Ur:tn;var n,r,o;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return Ur;if(t.gt(this.shru(1)))return pu;o=Ur}else{if(this.eq(wt)){if(t.eq(Mi)||t.eq(ya))return wt;if(t.eq(wt))return Mi;var s=this.shr(1);return n=s.div(t).shl(1),n.eq(tn)?t.isNegative()?Mi:ya:(r=this.sub(t.mul(n)),o=n.add(r.div(t)),o)}else if(t.eq(wt))return this.unsigned?Ur:tn;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();o=tn}for(r=this;r.gte(t);){n=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var c=Math.ceil(Math.log(n)/Math.LN2),u=c<=48?1:ws(2,c-48),d=Ut(n),m=d.mul(t);m.isNegative()||m.gt(r);)n-=u,d=Ut(n,this.unsigned),m=d.mul(t);d.isZero()&&(d=Mi),o=o.add(d),r=r.sub(m)}return o};se.div=se.divide;se.modulo=function(t){if(pt(t)||(t=Vt(t)),Ft){var e=(this.unsigned?Ft.rem_u:Ft.rem_s)(this.low,this.high,t.low,t.high);return Je(e,Ft.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))};se.mod=se.modulo;se.rem=se.modulo;se.not=function(){return Je(~this.low,~this.high,this.unsigned)};se.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};se.clz=se.countLeadingZeros;se.countTrailingZeros=function(){return this.low?Sl(this.low):Sl(this.high)+32};se.ctz=se.countTrailingZeros;se.and=function(t){return pt(t)||(t=Vt(t)),Je(this.low&t.low,this.high&t.high,this.unsigned)};se.or=function(t){return pt(t)||(t=Vt(t)),Je(this.low|t.low,this.high|t.high,this.unsigned)};se.xor=function(t){return pt(t)||(t=Vt(t)),Je(this.low^t.low,this.high^t.high,this.unsigned)};se.shiftLeft=function(t){return pt(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Je(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):Je(0,this.low<<t-32,this.unsigned)};se.shl=se.shiftLeft;se.shiftRight=function(t){return pt(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Je(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):Je(this.high>>t-32,this.high>=0?0:-1,this.unsigned)};se.shr=se.shiftRight;se.shiftRightUnsigned=function(t){return pt(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Je(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):t===32?Je(this.high,0,this.unsigned):Je(this.high>>>t-32,0,this.unsigned)};se.shru=se.shiftRightUnsigned;se.shr_u=se.shiftRightUnsigned;se.rotateLeft=function(t){var e;return pt(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?Je(this.high,this.low,this.unsigned):t<32?(e=32-t,Je(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned)):(t-=32,e=32-t,Je(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned))};se.rotl=se.rotateLeft;se.rotateRight=function(t){var e;return pt(t)&&(t=t.toInt()),(t&=63)===0?this:t===32?Je(this.high,this.low,this.unsigned):t<32?(e=32-t,Je(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned)):(t-=32,e=32-t,Je(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned))};se.rotr=se.rotateRight;se.toSigned=function(){return this.unsigned?Je(this.low,this.high,!1):this};se.toUnsigned=function(){return this.unsigned?this:Je(this.low,this.high,!0)};se.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()};se.toBytesLE=function(){var t=this.high,e=this.low;return[e&255,e>>>8&255,e>>>16&255,e>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]};se.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,e>>>24,e>>>16&255,e>>>8&255,e&255]};Me.fromBytes=function(t,e,n){return n?Me.fromBytesLE(t,e):Me.fromBytesBE(t,e)};Me.fromBytesLE=function(t,e){return new Me(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)};Me.fromBytesBE=function(t,e){return new Me(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};typeof BigInt=="function"&&(Me.fromBigInt=function(t,e){var n=Number(BigInt.asIntN(32,t)),r=Number(BigInt.asIntN(32,t>>BigInt(32)));return Je(n,r,e)},Me.fromValue=function(t,e){return typeof t=="bigint"?fromBigInt(t,e):Vt(t,e)},se.toBigInt=function(){var t=BigInt(this.low>>>0),e=BigInt(this.unsigned?this.high>>>0:this.high);return e<<BigInt(32)|t});var ut=(i=>(i[i.Null=0]="Null",i[i.Boolean=1]="Boolean",i[i.Integer=2]="Integer",i[i.Long=3]="Long",i[i.Double=4]="Double",i[i.String=5]="String",i[i.Bytes=6]="Bytes",i[i.Date=7]="Date",i))(ut||{});class nt extends xo{constructor(e,n){super(n);A(this,"valueType");A(this,"value");this.valueType=nt.getPrimitiveType(e),this.value=e===void 0?null:e}static of(e,n){return new nt(e,n)}static valueFromBytes(e,n){switch(e){case 0:return null;case 1:return!!n[0];case 2:return n[0]|n[1]<<8|n[2]<<16|n[3]<<24;case 4:{const r=new DataView(n.buffer);return n.forEach(function(o,s){r.setUint8(s,o)}),r.getFloat64(0,!0)}case 5:return new TextDecoder("utf-8").decode(n);case 3:return Me.fromBytesLE(Array.from(n));case 6:return n;case 7:return new Date(Me.fromBytesLE(Array.from(n),!0).toNumber());default:throw new Z(W.ErrUnimplemented,`unimplemented type: ${e}`)}}getValueSize(){switch(this.valueType){case 0:return 8;case 1:return 4;case 2:return 4;case 3:return 8;case 4:return 8;case 5:return this.value.length*2;case 6:return this.value.length;case 7:return 8;default:throw new Z(W.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}getDataSize(){return{data:this.getValueSize(),meta:this.getMetaUsage()}}toJSON(){return this.valueType===5?`"${Pn(this.value)}"`:`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_PRIMITIVE"}}deepcopy(){const e=nt.of(this.value,this.getCreatedAt());return e.setMovedAt(this.getMovedAt()),e.setRemovedAt(this.getRemovedAt()),e}getType(){return this.valueType}static getPrimitiveType(e){switch(typeof e){case"undefined":return 0;case"boolean":return 1;case"number":return this.isInteger(e)?2:4;case"string":return 5;case"object":if(e===null)return 0;if(e instanceof Me)return 3;if(e instanceof Uint8Array)return 6;if(e instanceof Date)return 7}}static isSupport(e){return nt.getPrimitiveType(e)!==void 0}static isInteger(e){return e%1===0}isNumericType(){const e=this.valueType;return e===2||e===3||e===4}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:return new Uint8Array;case 1:return this.value?new Uint8Array([1]):new Uint8Array([0]);case 2:{const e=this.value;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}case 4:{const e=this.value,n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),n}case 5:return new TextEncoder().encode(this.value);case 3:{const n=this.value.toBytesLE();return Uint8Array.from(n)}case 6:return this.value;case 7:{const e=this.value,n=Me.fromNumber(e.getTime(),!0).toBytesLE();return Uint8Array.from(n)}default:throw new Z(W.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}}class Ts extends du{constructor(e){super(e);A(this,"prev");A(this,"next");this.value=e}static createAfter(e,n){const r=new Ts(n),o=e.next;return e.next=r,r.prev=e,r.next=o,o&&(o.prev=r),r}remove(e){return this.value.remove(e)}getCreatedAt(){return this.value.getCreatedAt()}getPositionedAt(){return this.value.getPositionedAt()}release(){this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.prev=void 0,this.next=void 0}getLength(){return this.value.isRemoved()?0:1}getPrev(){return this.prev}getNext(){return this.next}getValue(){return this.value}isRemoved(){return this.value.isRemoved()}}class wo{constructor(){A(this,"dummyHead");A(this,"last");A(this,"nodeMapByIndex");A(this,"nodeMapByCreatedAt");const t=nt.of(0,Ki);t.setRemovedAt(Ki),this.dummyHead=new Ts(t),this.last=this.dummyHead,this.nodeMapByIndex=new bo,this.nodeMapByCreatedAt=new Map,this.nodeMapByIndex.insert(this.dummyHead),this.nodeMapByCreatedAt.set(this.dummyHead.getCreatedAt().toIDString(),this.dummyHead)}static create(){return new wo}get length(){return this.nodeMapByIndex.length}findNextBeforeExecutedAt(t,e){let n=this.nodeMapByCreatedAt.get(t.toIDString());if(!n)throw new Z(W.ErrInvalidArgument,`cant find the given node: ${t.toIDString()}`);for(;n.getNext()&&n.getNext().getPositionedAt().after(e);)n=n.getNext();return n}release(t){this.last===t&&(this.last=t.getPrev()),t.release(),this.nodeMapByIndex.delete(t),this.nodeMapByCreatedAt.delete(t.getValue().getCreatedAt().toIDString())}insertAfter(t,e,n=e.getCreatedAt()){const r=this.findNextBeforeExecutedAt(t,n),o=Ts.createAfter(r,e);r===this.last&&(this.last=o),this.nodeMapByIndex.insertAfter(r,o),this.nodeMapByCreatedAt.set(o.getCreatedAt().toIDString(),o)}moveAfter(t,e,n){const r=this.nodeMapByCreatedAt.get(t.toIDString());if(!r)throw new Z(W.ErrInvalidArgument,`cant find the given node: ${t.toIDString()}`);const o=this.nodeMapByCreatedAt.get(e.toIDString());if(!o)throw new Z(W.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);r!==o&&(!o.getValue().getMovedAt()||n.after(o.getValue().getMovedAt()))&&(this.release(o),this.insertAfter(r.getCreatedAt(),o.getValue(),n),o.getValue().setMovedAt(n))}insert(t){this.insertAfter(this.last.getCreatedAt(),t)}getByID(t){return this.nodeMapByCreatedAt.get(t.toIDString())}subPathOf(t){const e=this.nodeMapByCreatedAt.get(t.toIDString());if(e)return String(this.nodeMapByIndex.indexOf(e))}purge(t){const e=this.nodeMapByCreatedAt.get(t.getCreatedAt().toIDString());if(!e)throw new Z(W.ErrInvalidArgument,`fail to find the given createdAt: ${t.getCreatedAt().toIDString()}`);this.release(e)}getByIndex(t){if(t>=this.length)return;const[e,n]=this.nodeMapByIndex.find(t);let r=e;if(t===0&&e===this.dummyHead||n>0)do r&&(r=r.getNext());while(r&&r.isRemoved());return r}getPrevCreatedAt(t){let e=this.nodeMapByCreatedAt.get(t.toIDString());do e=e.getPrev();while(this.dummyHead!==e&&e.isRemoved());return e.getValue().getCreatedAt()}delete(t,e){const n=this.nodeMapByCreatedAt.get(t.toIDString()),r=n.isRemoved();return n.remove(e)&&!r&&this.nodeMapByIndex.splayNode(n),n.getValue()}deleteByIndex(t,e){const n=this.getByIndex(t);if(n)return n.remove(e)&&this.nodeMapByIndex.splayNode(n),n.getValue()}getHead(){return this.dummyHead.getValue()}getLast(){return this.last.getValue()}getLastCreatedAt(){return this.last.getCreatedAt()}toTestString(){const t=[];for(const e of this){const n=`${e.getCreatedAt().toIDString()}:${e.getValue().toJSON()}`;e.isRemoved()?t.push(`{${n}}`):t.push(`[${n}]`)}return t.join("")}*[Symbol.iterator](){let t=this.dummyHead.getNext();for(;t;)yield t,t=t.getNext()}}class It extends li{constructor(e,n){super(e);A(this,"elements");this.elements=n}static create(e,n){if(!n)return new It(e,wo.create());const r=wo.create();for(const o of n)r.insertAfter(r.getLastCreatedAt(),o.deepcopy());return new It(e,r)}subPathOf(e){return this.elements.subPathOf(e)}purge(e){this.elements.purge(e)}insertAfter(e,n){this.elements.insertAfter(e,n)}moveAfter(e,n,r){this.elements.moveAfter(e,n,r)}get(e){const n=this.elements.getByIndex(e);return n==null?void 0:n.getValue()}getByID(e){const n=this.elements.getByID(e);return n==null?void 0:n.getValue()}getHead(){return this.elements.getHead()}getLast(){return this.elements.getLast()}getPrevCreatedAt(e){return this.elements.getPrevCreatedAt(e)}delete(e,n){return this.elements.delete(e,n)}deleteByIndex(e,n){return this.elements.deleteByIndex(e,n)}getLastCreatedAt(){return this.elements.getLastCreatedAt()}get length(){return this.elements.length}*[Symbol.iterator](){for(const e of this.elements)e.isRemoved()||(yield e.getValue())}toTestString(){return this.elements.toTestString()}getDescendants(e){for(const n of this.elements){const r=n.getValue();if(e(r,this))return;r instanceof li&&r.getDescendants(e)}}getDataSize(){return{data:0,meta:this.getMetaUsage()}}toJSON(){const e=[];for(const n of this)e.push(n.toJSON());return`[${e.join(",")}]`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){const e={};for(let n=0;n<this.length;n++){const{createdAt:r,value:o,type:s}=this.get(n).toJSForTest();e[n]={key:String(n),createdAt:r,value:o,type:s}}return{createdAt:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_ARRAY"}}toSortedJSON(){return this.toJSON()}getElements(){return this.elements}deepcopy(){const e=It.create(this.getCreatedAt());for(const n of this.elements)e.elements.insertAfter(e.getLastCreatedAt(),n.getValue().deepcopy());return e.remove(this.getRemovedAt()),e}}class fi extends on{constructor(e,n,r){super(e,r);A(this,"createdAt");this.createdAt=n}static create(e,n,r){return new fi(e,n,r)}execute(e,n){var d;const r=e.findByCreatedAt(this.getParentCreatedAt());if(!r)throw new Z(W.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(r instanceof li))throw new Z(W.ErrInvalidArgument,`only object and array can execute remove: ${r}`);if(n===Ge.UndoRedo){let m=r.getByID(this.createdAt);for(;m;){if(m.getRemovedAt())return;m=(d=e.findElementPairByCreatedAt(m.getCreatedAt()))==null?void 0:d.parent}}const o=r.subPathOf(this.createdAt),s=this.toReverseOperation(r),c=r.delete(this.createdAt,this.getExecutedAt());return e.registerRemovedElement(c),{opInfos:r instanceof It?[{type:"remove",path:e.createPath(this.getParentCreatedAt()),index:Number(o)}]:[{type:"remove",path:e.createPath(this.getParentCreatedAt()),key:o}],reverseOp:s}}toReverseOperation(e){if(e instanceof Tt){const n=e.subPathOf(this.createdAt);if(n!==void 0){const r=e.get(n);if(r!==void 0)return ki.create(n,r.deepcopy(),this.getParentCreatedAt())}}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.REMOVE.${this.createdAt.toTestString()}`}getCreatedAt(){return this.createdAt}}class ki extends on{constructor(e,n,r,o){super(r,o);A(this,"key");A(this,"value");this.key=e,this.value=n}static create(e,n,r,o){return new ki(e,n,r,o)}execute(e,n){var d;const r=e.findByCreatedAt(this.getParentCreatedAt());if(!r)throw new Z(W.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(r instanceof Tt))throw new Z(W.ErrInvalidArgument,"fail to execute, only object can execute set");if(n===Ge.UndoRedo){let m=r;for(;m;){if(m.getRemovedAt())return;m=(d=e.findElementPairByCreatedAt(m.getCreatedAt()))==null?void 0:d.parent}}const o=r.get(this.key),s=this.toReverseOperation(o),c=this.value.deepcopy(),u=r.set(this.key,c,this.getExecutedAt());return n===Ge.UndoRedo&&e.findByCreatedAt(c.getCreatedAt())&&e.deregisterElement(c),e.registerElement(c,r),u&&e.registerRemovedElement(u),{opInfos:[{type:"set",path:e.createPath(this.getParentCreatedAt()),key:this.key}],reverseOp:s}}toReverseOperation(e){let n=fi.create(this.getParentCreatedAt(),this.value.getCreatedAt());return e!==void 0&&!e.isRemoved()&&(n=ki.create(this.key,e.deepcopy(),this.getParentCreatedAt())),n}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.SET.${this.key}=${this.value.toSortedJSON()}`}getKey(){return this.key}getValue(){return this.value}}class Oo extends on{constructor(e,n,r,o){super(e,o);A(this,"prevCreatedAt");A(this,"value");this.prevCreatedAt=n,this.value=r}static create(e,n,r,o){return new Oo(e,n,r,o)}execute(e){const n=e.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new Z(W.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof It))throw new Z(W.ErrInvalidArgument,"fail to execute, only array can execute add");const r=n,o=this.value.deepcopy();return r.insertAfter(this.prevCreatedAt,o),e.registerElement(o,r),{opInfos:[{type:"add",path:e.createPath(this.getParentCreatedAt()),index:Number(r.subPathOf(this.getEffectedCreatedAt()))}]}}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.ADD.${this.value.toJSON()}`}getPrevCreatedAt(){return this.prevCreatedAt}getValue(){return this.value}}class oi extends on{constructor(e,n,r,o){super(e,o);A(this,"prevCreatedAt");A(this,"createdAt");this.prevCreatedAt=n,this.createdAt=r}static create(e,n,r,o){return new oi(e,n,r,o)}execute(e){const n=e.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new Z(W.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof It))throw new Z(W.ErrInvalidArgument,"fail to execute, only array can execute move");const r=n,o=Number(r.subPathOf(this.createdAt));r.moveAfter(this.prevCreatedAt,this.createdAt,this.getExecutedAt());const s=Number(r.subPathOf(this.createdAt));return{opInfos:[{type:"move",path:e.createPath(this.getParentCreatedAt()),index:s,previousIndex:o}]}}getEffectedCreatedAt(){return this.createdAt}toTestString(){return`${this.getParentCreatedAt().toTestString()}.MOVE`}getPrevCreatedAt(){return this.prevCreatedAt}getCreatedAt(){return this.createdAt}}class Ai{constructor(t,e,n,r){A(this,"key");A(this,"value");A(this,"updatedAt");A(this,"_isRemoved");this.key=t,this.value=e,this.updatedAt=n,this._isRemoved=r}static of(t,e,n,r){return new Ai(t,e,n,r)}getKey(){return this.key}getValue(){return this.value}getUpdatedAt(){return this.updatedAt}isRemoved(){return this._isRemoved}toIDString(){return`${this.updatedAt.toIDString()}:${this.key}`}getRemovedAt(){if(this._isRemoved)return this.updatedAt}getDataSize(){return{data:(this.key.length+this.value.length)*2,meta:ai}}}class Vr{constructor(){A(this,"nodeMapByKey");A(this,"numberOfRemovedElement");this.nodeMapByKey=new Map,this.numberOfRemovedElement=0}static create(){return new Vr}getNodeMapByKey(){return this.nodeMapByKey}set(t,e,n){const r=this.nodeMapByKey.get(t);if(r&&r.isRemoved()&&n.after(r.getUpdatedAt())&&(this.numberOfRemovedElement-=1),r===void 0||n.after(r.getUpdatedAt())){const o=Ai.of(t,e,n,!1);return this.nodeMapByKey.set(t,o),r!==void 0&&r.isRemoved()?[r,o]:[void 0,o]}return r.isRemoved()?[r,void 0]:[void 0,void 0]}setInternal(t,e,n,r){const o=Ai.of(t,e,n,r);this.nodeMapByKey.set(t,o),r&&this.numberOfRemovedElement++}remove(t,e){const n=this.nodeMapByKey.get(t),r=[];if(n===void 0||e.after(n.getUpdatedAt())){if(n===void 0){this.numberOfRemovedElement+=1;const c=Ai.of(t,"",e,!0);return this.nodeMapByKey.set(t,c),r.push(c),r}const o=n.isRemoved();o||(this.numberOfRemovedElement+=1),o&&r.push(n);const s=Ai.of(t,n.getValue(),e,!0);return this.nodeMapByKey.set(t,s),r.push(s),r}return r}has(t){if(this.nodeMapByKey.has(t)){const e=this.nodeMapByKey.get(t);return e!==void 0&&!e.isRemoved()}return!1}get(t){if(this.nodeMapByKey.has(t))return this.nodeMapByKey.get(t).getValue()}deepcopy(){const t=new Vr;for(const[,e]of this.nodeMapByKey)t.setInternal(e.getKey(),e.getValue(),e.getUpdatedAt(),e.isRemoved());return t}toJSON(){if(!this.size())return"{}";const t=[];for(const[e,n]of this.nodeMapByKey)n.isRemoved()||t.push(`"${Pn(e)}":"${Pn(n.getValue())}"`);return`{${t.join(",")}}`}size(){return this.nodeMapByKey.size-this.numberOfRemovedElement}toObject(){const t={};for(const[e,n]of this.nodeMapByKey)n.isRemoved()||(t[e]=n.getValue());return t}*[Symbol.iterator](){for(const[,t]of this.nodeMapByKey)yield t}purge(t){const e=this.nodeMapByKey.get(t.getKey());e==null||e.toIDString()!=t.toIDString()||(this.nodeMapByKey.delete(t.getKey()),this.numberOfRemovedElement--)}}function Qt(i){if(i instanceof Map){const t=Array.from(i);return new Map(JSON.parse(JSON.stringify(t)))}return JSON.parse(JSON.stringify(i))}const vu=i=>i?Object.entries(i).length===0:!0,Wi=i=>{const t={};for(const[e,n]of Object.entries(i))t[e]=JSON.stringify(n);return t},Jr=i=>{const t={};for(const[e,n]of Object.entries(i))t[e]=JSON.parse(n);return t};class To{constructor(t){A(this,"attributes");A(this,"content");this.attributes=Vr.create(),this.content=t}static create(t){return new To(t)}get length(){return this.content.length}substring(t,e){const n=new To(this.content.substring(t,e));return n.attributes=this.attributes.deepcopy(),n}setAttr(t,e,n){return this.attributes.set(t,e,n)}getAttrs(){return this.attributes}toString(){return this.content}getDataSize(){const t={data:0,meta:0};t.data+=this.content.length*2;for(const e of this.attributes){const n=e.getDataSize();t.meta+=n.meta,t.data+=n.data}return t}toJSON(){const t=Pn(this.content),e=this.attributes.toObject(),n=[];for(const[r,o]of Object.entries(e)){const s=JSON.parse(o),c=typeof s=="string"?`"${Pn(r)}":"${Pn(s)}"`:`"${Pn(r)}":${String(s)}`;n.push(c)}return n.sort(),n.length===0?`{"val":"${t}"}`:`{"attrs":{${n.join(",")}},"val":"${t}"}`}getAttributes(){return this.attributes.toObject()}getContent(){return this.content}purge(t){this.attributes&&t instanceof Ai&&this.attributes.purge(t)}getGCPairs(){const t=[];for(const e of this.attributes)e.getRemovedAt()&&t.push({parent:this,child:e});return t}}class $t extends xo{constructor(e,n){super(n);A(this,"rgaTreeSplit");this.rgaTreeSplit=e}static create(e,n){return new $t(e,n)}edit(e,n,r,o,s){const c=n?To.create(n):void 0;if(c&&o)for(const[l,a]of Object.entries(o))c.setAttr(l,a,r);const[u,d,m]=this.rgaTreeSplit.edit(e,r,c,s);return[m.map(l=>({...l,value:l.value?{attributes:Jr(l.value.getAttributes()),content:l.value.getContent()}:{attributes:void 0,content:""},type:"content"})),d,[u,u]]}setStyle(e,n,r,o){const[,s]=this.rgaTreeSplit.findNodeWithSplit(e[1],r),[,c]=this.rgaTreeSplit.findNodeWithSplit(e[0],r),u=[],d=this.rgaTreeSplit.findBetween(c,s),m=[];for(const l of d){const a=l.getCreatedAt().getActorID();let v=co;o!=null&&(v=o.get(a)?o.get(a):0n),l.canStyle(r,v)&&m.push(l)}const h=[];for(const l of m){if(l.isRemoved())continue;const[a,v]=this.rgaTreeSplit.findIndexesFromRange(l.createPosRange());u.push({type:"style",actor:r.getActorID(),from:a,to:v,value:{attributes:Jr(n)}});for(const[b,w]of Object.entries(n)){const[y]=l.getValue().setAttr(b,w,r);y!==void 0&&h.push({parent:l.getValue(),child:y})}}return[h,u]}indexRangeToPosRange(e,n){const r=this.rgaTreeSplit.indexToPos(e);return e===n?[r,r]:[r,this.rgaTreeSplit.indexToPos(n)]}get length(){return this.rgaTreeSplit.length}getTreeByIndex(){return this.rgaTreeSplit.getTreeByIndex()}getTreeByID(){return this.rgaTreeSplit.getTreeByID()}getDataSize(){const e={data:0,meta:0};for(const n of this.rgaTreeSplit){if(n.isRemoved())continue;const r=n.getDataSize();e.data+=r.data,e.meta+=r.meta}return{data:e.data,meta:e.meta+this.getMetaUsage()}}toJSON(){const e=[];for(const n of this.rgaTreeSplit)n.isRemoved()||e.push(n.getValue().toJSON());return`[${e.join(",")}]`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TEXT"}}toString(){return this.rgaTreeSplit.toString()}values(){const e=[];for(const n of this.rgaTreeSplit)if(!n.isRemoved()){const r=n.getValue();e.push({attributes:Jr(r.getAttributes()),content:r.getContent()})}return e}getRGATreeSplit(){return this.rgaTreeSplit}toTestString(){return this.rgaTreeSplit.toTestString()}deepcopy(){const e=new $t(this.rgaTreeSplit.deepcopy(),this.getCreatedAt());return e.remove(this.getRemovedAt()),e}findIndexesFromRange(e){return this.rgaTreeSplit.findIndexesFromRange(e)}getGCPairs(){const e=[];for(const n of this.rgaTreeSplit){n.getRemovedAt()&&e.push({parent:this.rgaTreeSplit,child:n});for(const r of n.getValue().getGCPairs())e.push(r)}return e}}class ko extends on{constructor(e,n,r,o,s,c){super(e,c);A(this,"fromPos");A(this,"toPos");A(this,"content");A(this,"attributes");this.fromPos=n,this.toPos=r,this.content=o,this.attributes=s}static create(e,n,r,o,s,c){return new ko(e,n,r,o,s,c)}execute(e,n,r){const o=e.findByCreatedAt(this.getParentCreatedAt());if(!o)throw new Z(W.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(o instanceof $t))throw new Z(W.ErrInvalidArgument,"fail to execute, only Text can execute edit");const s=o,[c,u]=s.edit([this.fromPos,this.toPos],this.content,this.getExecutedAt(),Object.fromEntries(this.attributes),r);for(const d of u)e.registerGCPair(d);return{opInfos:c.map(({from:d,to:m,value:h})=>({type:"edit",from:d,to:m,value:h,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),n=this.fromPos.toTestString(),r=this.toPos.toTestString(),o=this.content;return`${e}.EDIT(${n},${r},${o})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContent(){return this.content}getAttributes(){return this.attributes||new Map}}class Io extends on{constructor(e,n,r,o,s){super(e,s);A(this,"fromPos");A(this,"toPos");A(this,"attributes");this.fromPos=n,this.toPos=r,this.attributes=o}static create(e,n,r,o,s){return new Io(e,n,r,o,s)}execute(e,n,r){const o=e.findByCreatedAt(this.getParentCreatedAt());if(!o)throw new Z(W.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(o instanceof $t))throw new Z(W.ErrInvalidArgument,"fail to execute, only Text can execute edit");const s=o,[c,u]=s.setStyle([this.fromPos,this.toPos],this.attributes?Object.fromEntries(this.attributes):{},this.getExecutedAt(),r);for(const d of c)e.registerGCPair(d);return{opInfos:u.map(({from:d,to:m,value:h})=>({type:"style",from:d,to:m,value:h,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),n=this.fromPos.toTestString(),r=this.toPos.toTestString(),o=this.attributes;return`${e}.STYL(${n},${r},${JSON.stringify(o)})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}}const If=2,Nf="root",Cn="text";function io(i,t){let e=0;const n=i.children;for(let r=0;r<t;r++){const o=n[r];!o||o.isRemoved||(e+=o.paddedSize)}return e}class _f{constructor(t,e=[]){A(this,"type");A(this,"parent");A(this,"_children");A(this,"size");if(this.type=t,this.size=0,this._children=e,this.isText&&this._children.length>0)throw new Z(W.ErrRefused,"Text node cannot have children")}updateAncestorsSize(){let t=this.parent;const e=this.isRemoved?-1:1;for(;t&&(t.size+=this.paddedSize*e,!t.isRemoved);)t=t.parent}updateDescendantsSize(){let t=0;for(const e of this._children){const n=e.updateDescendantsSize();e.isRemoved||(t+=n)}return this.size+=t,this.paddedSize}get isText(){return this.type===Cn}get paddedSize(){return this.size+(this.isText?0:If)}isAncestorOf(t){return Pf(this,t)}get nextSibling(){const t=this.parent.findOffset(this),e=this.parent.children[t+1];if(e)return e}get prevSibling(){const t=this.parent.findOffset(this),e=this.parent.children[t-1];if(e)return e}splitText(t,e){if(t===0||t===this.size)return;const n=this.value.slice(0,t),r=this.value.slice(t);if(!r.length)return;this.value=n;const o=this.cloneText(t+e);return o.value=r,this.parent.insertAfterInternal(o,this),o}get children(){return this._children.filter(t=>!t.isRemoved)}get allChildren(){return[...this._children]}hasTextChild(){return this.children.length>0&&this.children.every(t=>t.isText)}getChildrenText(){return this.isText?this.value:this.hasTextChild()?this.children.map(t=>t.value).join(""):""}append(...t){if(this.isText)throw new Z(W.ErrRefused,"Text node cannot have children");this._children.push(...t);for(const e of t)e.parent=this,e.updateAncestorsSize()}prepend(...t){if(this.isText)throw new Z(W.ErrRefused,"Text node cannot have children");this._children.unshift(...t);for(const e of t)e.parent=this}insertBefore(t,e){if(this.isText)throw new Z(W.ErrRefused,"Text node cannot have children");const n=this._children.indexOf(e);if(n===-1)throw new Z(W.ErrInvalidArgument,"child not found");this.insertAtInternal(t,n),t.updateAncestorsSize()}insertAfter(t,e){if(this.isText)throw new Z(W.ErrRefused,"Text node cannot have children");const n=this._children.indexOf(e);if(n===-1)throw new Z(W.ErrInvalidArgument,"child not found");this.insertAtInternal(t,n+1),t.updateAncestorsSize()}insertAt(t,e){if(this.isText)throw new Z(W.ErrRefused,"Text node cannot have children");this.insertAtInternal(t,e),t.updateAncestorsSize()}removeChild(t){if(this.isText)throw new Z(W.ErrRefused,"Text node cannot have children");const e=this._children.indexOf(t);if(e===-1)throw new Z(W.ErrInvalidArgument,"child not found");this._children.splice(e,1),t.parent=void 0}splitElement(t,e){const n=this.cloneElement(e);this.parent.insertAfterInternal(n,this),n.updateAncestorsSize();const r=this.children.slice(0,t),o=this.children.slice(t);this._children=r,n._children=o,this.size=this._children.reduce((s,c)=>s+c.paddedSize,0),n.size=n._children.reduce((s,c)=>s+c.paddedSize,0);for(const s of n._children)s.parent=n;return n}insertAfterInternal(t,e){if(this.isText)throw new Z(W.ErrRefused,"Text node cannot have children");const n=this._children.indexOf(e);if(n===-1)throw new Z(W.ErrInvalidArgument,"child not found");this.insertAtInternal(t,n+1)}insertAtInternal(t,e){if(this.isText)throw new Z(W.ErrRefused,"Text node cannot have children");this._children.splice(e,0,t),t.parent=this}findOffset(t){if(this.isText)throw new Z(W.ErrRefused,"Text node cannot have children");if(t.isRemoved){const e=this._children.indexOf(t);return this.allChildren.splice(0,e).filter(r=>!r.isRemoved).length}return this.children.indexOf(t)}findBranchOffset(t){if(this.isText)throw new Z(W.ErrRefused,"Text node cannot have children");let e=t;for(;e;){const n=this._children.indexOf(e);if(n!==-1)return n;e=e.parent}return-1}}function Pf(i,t){if(i===t)return!1;for(;t.parent;){if(t.parent===i)return!0;t=t.parent}return!1}var at=(i=>(i.Start="Start",i.End="End",i.Text="Text",i))(at||{});function bu(i,t,e,n){if(t>e)throw new Z(W.ErrInvalidArgument,`from is greater than to: ${t} > ${e}`);if(t>i.size)throw new Z(W.ErrInvalidArgument,`from is out of range: ${t} > ${i.size}`);if(e>i.size)throw new Z(W.ErrInvalidArgument,`to is out of range: ${e} > ${i.size}`);if(t===e)return;let r=0;for(const o of i.children){if(t-o.paddedSize<r&&r<e){const s=o.isText?t-r:t-r-1,c=o.isText?e-r:e-r-1,u=!o.isText&&s<0,d=!o.isText&&c>o.size;(o.isText||u)&&n([o,o.isText?"Text":"Start"],d),bu(o,Math.max(0,s),Math.min(c,o.size),n),d&&n([o,"End"],d)}r+=o.paddedSize}}function wu(i,t,e=0){for(const n of i.children)wu(n,t,e+1);t(i,e)}function Is(i,t,e=0){for(const n of i._children)Is(n,t,e+1);t(i,e)}function va(i,t,e=!0){if(t>i.size)throw new Z(W.ErrInvalidArgument,`index is out of range: ${t} > ${i.size}`);if(i.isText)return{node:i,offset:t};let n=0,r=0;for(const o of i.children){if(e&&o.isText&&o.size>=t-r)return va(o,t-r,e);if(t===r)return{node:i,offset:n};if(!e&&o.paddedSize===t-r)return{node:i,offset:n+1};if(o.paddedSize>t-r)return va(o,t-r-1,e);r+=o.paddedSize,n+=1}return{node:i,offset:n}}function Tu(i){return i.isText||i.children.length===0?i:Tu(i.children[0])}function Cf(i,t){if(i.size<t)throw new Z(W.ErrInvalidArgument,"unacceptable path");for(let e=0;e<i.children.length;e++){const n=i.children[e];if(n.size<t)t-=n.size;else{i=n;break}}return{node:i,offset:t}}class Lf{constructor(t){A(this,"root");this.root=t}tokensBetween(t,e,n){bu(this.root,t,e,n)}traverse(t){wu(this.root,t,0)}traverseAll(t){Is(this.root,t,0)}findTreePos(t,e=!0){return va(this.root,t,e)}treePosToPath(t){const e=[];let n=t.node;if(n.isText){const r=n.parent.findOffset(n);if(r===-1)throw new Z(W.ErrInvalidArgument,"invalid treePos");const o=io(n.parent,r);e.push(o+t.offset),n=n.parent}else if(n.hasTextChild()){const r=io(n,t.offset);e.push(r)}else e.push(t.offset);for(;n.parent;){const r=n.parent.findOffset(n);if(r===-1)throw new Z(W.ErrInvalidArgument,"invalid treePos");e.push(r),n=n.parent}return e.reverse()}pathToIndex(t){const e=this.pathToTreePos(t);return this.indexOf(e)}pathToTreePos(t){if(!t.length)throw new Z(W.ErrInvalidArgument,"unacceptable path");let e=this.root;for(let n=0;n<t.length-1;n++){const r=t[n];if(e=e.children[r],!e)throw new Z(W.ErrInvalidArgument,"unacceptable path")}if(e.hasTextChild())return Cf(e,t[t.length-1]);if(e.children.length<t[t.length-1])throw new Z(W.ErrInvalidArgument,"unacceptable path");return{node:e,offset:t[t.length-1]}}getRoot(){return this.root}get size(){return this.root.size}findPostorderRight(t){const{node:e,offset:n}=t;if(e.isText){if(e.size===n){const r=e.nextSibling;return r||e.parent}return e}return e.children.length===n?e:Tu(e.children[n])}indexOf(t){let{node:e}=t;const{offset:n}=t;let r=0,o=1;if(e.isText){r+=n;const s=e.parent,c=s.findOffset(e);if(c===-1)throw new Z(W.ErrInvalidArgument,"invalid pos");r+=io(s,c),e=e.parent}else r+=io(e,n);for(;e!=null&&e.parent;){const s=e.parent,c=s.findOffset(e);if(c===-1)throw new Z(W.ErrInvalidArgument,"invalid pos");r+=io(s,c),o++,e=e.parent}return r+o-1}indexToPath(t){const e=this.findTreePos(t);return this.treePosToPath(e)}}const Rf=(i,t)=>i===t?0:i<t?-1:1;class Df{constructor(t,e,n){A(this,"key");A(this,"value");A(this,"parent");A(this,"left");A(this,"right");A(this,"isRed");this.key=t,this.value=e,this.isRed=n}}class Bf{constructor(t){A(this,"stack");this.stack=[],this.traverseInorder(t)}traverseInorder(t){t&&(this.traverseInorder(t.left),this.stack.push({key:t.key,value:t.value}),this.traverseInorder(t.right))}}class Au{constructor(t){A(this,"root");A(this,"comparator");A(this,"counter");this.comparator=typeof t<"u"?t:Rf,this.counter=0}put(t,e){return this.root=this.putInternal(t,e,this.root),this.root.isRed=!1,e}get(t){const e=this.getInternal(t,this.root);return e?e.value:void 0}remove(t){!this.isRed(this.root.left)&&!this.isRed(this.root.right)&&(this.root.isRed=!0),this.root=this.removeInternal(this.root,t),this.root&&(this.root.isRed=!1)}getIterator(){return new Bf(this.root)}values(){const t=[];for(const e of this.getIterator().stack)t.push(e.value);return t}floorEntry(t){let e=this.root;for(;e;){const n=this.comparator(t,e.key);if(n>0)if(e.right)e.right.parent=e,e=e.right;else return e;else if(n<0)if(e.left)e.left.parent=e,e=e.left;else{let r=e.parent,o=e;for(;r&&o===r.left;)o=r,r=r.parent;return r}else return e}}lastEntry(){if(!this.root)return this.root;let t=this.root;for(;t.right;)t=t.right;return t}size(){return this.counter}isEmpty(){return this.counter===0}getInternal(t,e){for(;e;){const n=this.comparator(t,e.key);if(n===0)return e;n<0?e=e.left:n>0&&(e=e.right)}}putInternal(t,e,n){if(!n)return this.counter+=1,new Df(t,e,!0);const r=this.comparator(t,n.key);return r<0?n.left=this.putInternal(t,e,n.left):r>0?n.right=this.putInternal(t,e,n.right):n.value=e,this.isRed(n.right)&&!this.isRed(n.left)&&(n=this.rotateLeft(n)),this.isRed(n.left)&&this.isRed(n.left.left)&&(n=this.rotateRight(n)),this.isRed(n.left)&&this.isRed(n.right)&&this.flipColors(n),n}removeInternal(t,e){if(this.comparator(e,t.key)<0)!this.isRed(t.left)&&!this.isRed(t.left.left)&&(t=this.moveRedLeft(t)),t.left=this.removeInternal(t.left,e);else{if(this.isRed(t.left)&&(t=this.rotateRight(t)),this.comparator(e,t.key)===0&&!t.right){this.counter-=1;return}if(!this.isRed(t.right)&&!this.isRed(t.right.left)&&(t=this.moveRedRight(t)),this.comparator(e,t.key)===0){this.counter-=1;const n=this.min(t.right);t.value=n.value,t.key=n.key,t.right=this.removeMin(t.right)}else t.right=this.removeInternal(t.right,e)}return this.fixUp(t)}min(t){return t.left?this.min(t.left):t}removeMin(t){if(t.left)return!this.isRed(t.left)&&!this.isRed(t.left.left)&&(t=this.moveRedLeft(t)),t.left=this.removeMin(t.left),this.fixUp(t)}fixUp(t){return this.isRed(t.right)&&(t=this.rotateLeft(t)),this.isRed(t.left)&&this.isRed(t.left.left)&&(t=this.rotateRight(t)),this.isRed(t.left)&&this.isRed(t.right)&&this.flipColors(t),t}moveRedLeft(t){return this.flipColors(t),this.isRed(t.right.left)&&(t.right=this.rotateRight(t.right),t=this.rotateLeft(t),this.flipColors(t)),t}moveRedRight(t){return this.flipColors(t),this.isRed(t.left.left)&&(t=this.rotateRight(t),this.flipColors(t)),t}isRed(t){return t&&t.isRed}rotateLeft(t){const e=t.right;return t.right=e.left,e.left=t,e.isRed=e.left.isRed,e.left.isRed=!0,e}rotateRight(t){const e=t.left;return t.left=e.right,e.right=t,e.isRed=e.right.isRed,e.right.isRed=!0,e}flipColors(t){t.isRed=!t.isRed,t.left.isRed=!t.left.isRed,t.right.isRed=!t.right.isRed}}class nn{constructor(t,e){A(this,"parentID");A(this,"leftSiblingID");this.parentID=t,this.leftSiblingID=e}static of(t,e){return new nn(t,e)}static fromTreePos(t){const{offset:e}=t;let{node:n}=t,r;return n.isText?(n.parent.children[0]===n&&e===0?r=n.parent:r=n,n=n.parent):e===0?r=n:r=n.children[e-1],nn.of(n.id,dt.of(r.getCreatedAt(),r.getOffset()+e))}getParentID(){return this.parentID}static fromStruct(t){return nn.of(dt.of(Jt.fromStruct(t.parentID.createdAt),t.parentID.offset),dt.of(Jt.fromStruct(t.leftSiblingID.createdAt),t.leftSiblingID.offset))}toStruct(){return{parentID:{createdAt:this.getParentID().getCreatedAt().toStruct(),offset:this.getParentID().getOffset()},leftSiblingID:{createdAt:this.getLeftSiblingID().getCreatedAt().toStruct(),offset:this.getLeftSiblingID().getOffset()}}}toTreeNodePair(t){const e=this.getParentID(),n=this.getLeftSiblingID(),r=t.findFloorNode(e);let o=t.findFloorNode(n);if(!r||!o)throw new Z(W.ErrRefused,`cannot find node of CRDTTreePos(${e.toTestString()}, ${n.toTestString()})`);return!n.equals(e)&&n.getOffset()>0&&n.getOffset()===o.id.getOffset()&&o.insPrevID&&(o=t.findFloorNode(o.insPrevID)),[r,o]}getLeftSiblingID(){return this.leftSiblingID}equals(t){return this.getParentID().getCreatedAt().equals(t.getParentID().getCreatedAt())&&this.getParentID().getOffset()===t.getParentID().getOffset()&&this.getLeftSiblingID().getCreatedAt().equals(t.getLeftSiblingID().getCreatedAt())&&this.getLeftSiblingID().getOffset()===t.getLeftSiblingID().getOffset()}}class dt{constructor(t,e){A(this,"createdAt");A(this,"offset");this.createdAt=t,this.offset=e}static of(t,e){return new dt(t,e)}static fromStruct(t){return dt.of(Jt.fromStruct(t.createdAt),t.offset)}static createComparator(){return(t,e)=>{const n=t.getCreatedAt().compare(e.getCreatedAt());return n!==0?n:t.getOffset()>e.getOffset()?1:t.getOffset()<e.getOffset()?-1:0}}getCreatedAt(){return this.createdAt}equals(t){return this.createdAt.compare(t.createdAt)===0&&this.offset===t.offset}getOffset(){return this.offset}setOffset(t){this.offset=t}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}toTestString(){return`${this.createdAt.toTestString()}/${this.offset}`}}class kt extends _f{constructor(e,n,r,o,s){super(n);A(this,"id");A(this,"removedAt");A(this,"attrs");A(this,"insPrevID");A(this,"insNextID");A(this,"_value","");this.id=e,this.removedAt=s,o&&(this.attrs=o),typeof r=="string"?this.value=r:Array.isArray(r)&&(this._children=r)}toIDString(){return this.id.toIDString()}getRemovedAt(){return this.removedAt}static create(e,n,r,o){return new kt(e,n,r,o)}deepcopy(){var n;const e=new kt(this.id,this.type);return e.removedAt=this.removedAt,e._value=this._value,e.size=this.size,e.attrs=(n=this.attrs)==null?void 0:n.deepcopy(),e._children=this._children.map(r=>{const o=r.deepcopy();return o.parent=e,o}),e.insPrevID=this.insPrevID,e.insNextID=this.insNextID,e}get value(){if(!this.isText)throw new Z(W.ErrInvalidType,`cannot get value of element node: ${this.type}`);return this._value}set value(e){if(!this.isText)throw new Z(W.ErrInvalidType,`cannot set value of element node: ${this.type}`);this._value=e,this.size=e.length}get isRemoved(){return!!this.removedAt}remove(e){const n=!this.removedAt;(!this.removedAt||this.removedAt.compare(e)>0)&&(this.removedAt=e),n&&this.updateAncestorsSize()}cloneText(e){return new kt(dt.of(this.id.getCreatedAt(),e),this.type,void 0,void 0,this.removedAt)}cloneElement(e){return new kt(dt.of(e(),0),this.type,void 0,void 0,this.removedAt)}split(e,n,r){const o=this.isText?this.splitText(n,this.id.getOffset()):this.splitElement(n,r);if(o){if(o.insPrevID=this.id,this.insNextID){const s=e.findFloorNode(this.insNextID);s.insPrevID=o.id,o.insNextID=this.insNextID}this.insNextID=o.id,e.registerNode(o)}return o}getCreatedAt(){return this.id.getCreatedAt()}getOffset(){return this.id.getOffset()}canDelete(e,n){return this.getCreatedAt().getLamport()<=n&&(!this.removedAt||e.after(this.removedAt))}canStyle(e,n){return this.isText?!1:this.getCreatedAt().getLamport()<=n&&(!this.removedAt||e.after(this.removedAt))}setAttrs(e,n){this.attrs||(this.attrs=new Vr);const r=[];for(const[o,s]of Object.entries(e))r.push(this.attrs.set(o,s,n));return r}purge(e){this.attrs&&this.attrs.purge(e)}getDataSize(){const e={data:0,meta:0};if(this.isText&&(e.data+=this.size*2),this.id&&(e.meta+=ai),this.removedAt&&(e.meta+=ai),this.attrs)for(const n of this.attrs){if(n.getRemovedAt())continue;const r=n.getDataSize();e.meta+=r.meta,e.data+=r.data}return e}getGCPairs(){const e=[];if(!this.attrs)return e;for(const n of this.attrs)n.getRemovedAt()&&e.push({parent:this,child:n});return e}}function ba(i){var e;if(i.isText){const n=i;return{type:n.type,value:n.value}}const t={type:i.type,children:i.children.map(ba)};return i.attrs&&(t.attributes=Jr((e=i.attrs)==null?void 0:e.toObject())),t}function ka(i){if(i.isText)return i.value;let t="";return i.attrs&&i.attrs.size()&&(t=" "+Array.from(i.attrs).filter(e=>!e.isRemoved()).sort((e,n)=>e.getKey().localeCompare(n.getKey())).map(e=>{const n=JSON.parse(e.getValue());return typeof n=="string"?`${e.getKey()}="${n}"`:`${e.getKey()}="${Pn(e.getValue())}"`}).join(" ")),`<${i.type}${t}>${i.children.map(e=>ka(e)).join("")}</${i.type}>`}function Su(i){if(i.isText){const t=i;return{type:t.type,value:t.value,size:t.size,isRemoved:t.isRemoved}}return{type:i.type,children:i.children.map(Su),size:i.size,isRemoved:i.isRemoved}}class zt extends xo{constructor(e,n){super(n);A(this,"indexTree");A(this,"nodeMapByID");this.indexTree=new Lf(e),this.nodeMapByID=new Au(dt.createComparator()),this.indexTree.traverseAll(r=>{this.nodeMapByID.put(r.id,r)})}static create(e,n){return new zt(e,n)}findFloorNode(e){const n=this.nodeMapByID.floorEntry(e);if(!(!n||!n.key.getCreatedAt().equals(e.getCreatedAt())))return n.value}registerNode(e){this.nodeMapByID.put(e.id,e)}findNodesAndSplitText(e,n){const[r,o]=e.toTreeNodePair(this);let s=o;const c=r===s,u=s.parent&&!c?s.parent:r;if(s.isText&&s.split(this,e.getLeftSiblingID().getOffset()-s.id.getOffset()),n){const d=u.allChildren,m=c?0:d.indexOf(s)+1;for(let h=m;h<d.length;h++){const l=d[h];if(!l.id.getCreatedAt().after(n))break;s=l}}return[u,s]}style(e,n,r,o){const[s,c]=this.findNodesAndSplitText(e[0],r),[u,d]=this.findNodesAndSplitText(e[1],r),m=[],h=n?Jr(n):{},l=[];return this.traverseInPosRange(s,c,u,d,([a])=>{const v=a.getCreatedAt().getActorID();let b=co;if(o!=null&&(b=o.get(v)?o.get(v):0n),a.canStyle(r,b)&&n){const w=a.setAttrs(n,r),y=w.reduce((f,[,T])=>(T&&(f[T.getKey()]=h[T.getKey()]),f),{}),p=a.parent,g=a.prevSibling||a.parent;Object.keys(y).length>0&&m.push({type:"style",from:this.toIndex(p,g),to:this.toIndex(a,a),fromPath:this.toPath(p,g),toPath:this.toPath(a,a),actor:r.getActorID(),value:y});for(const[f]of w)f&&l.push({parent:a,child:f})}}),[l,m]}removeStyle(e,n,r,o){const[s,c]=this.findNodesAndSplitText(e[0],r),[u,d]=this.findNodesAndSplitText(e[1],r),m=[],h=[];return this.traverseInPosRange(s,c,u,d,([l])=>{const a=l.getCreatedAt().getActorID();let v=co;if(o!=null&&(v=o.get(a)?o.get(a):0n),l.canStyle(r,v)&&n){l.attrs||(l.attrs=new Vr);for(const y of n){const p=l.attrs.remove(y,r);for(const g of p)h.push({parent:l,child:g})}const b=l.parent,w=l.prevSibling||l.parent;m.push({actor:r.getActorID(),type:"removeStyle",from:this.toIndex(b,w),to:this.toIndex(l,l),fromPath:this.toPath(b,w),toPath:this.toPath(l,l),value:n})}}),[h,m]}edit(e,n,r,o,s,c){const[u,d]=this.findNodesAndSplitText(e[0],o),[m,h]=this.findNodesAndSplitText(e[1],o),l=this.toIndex(u,d),a=this.toPath(u,d),v=[],b=[],w=[];this.traverseInPosRange(u,d,m,h,([g,f],T)=>{if(f===at.Start&&!T)for(const k of g.children)w.push(k);const S=g.getCreatedAt().getActorID();let E=co;c!=null&&(E=c.get(S)?c.get(S):0n),(g.canDelete(o,E)||v.includes(g.parent))&&((f===at.Text||f===at.Start)&&v.push(g),b.push([g,f]))});const y=this.makeDeletionChanges(b,o),p=[];for(const g of v)g.remove(o),g.isRemoved&&p.push({parent:this,child:g});for(const g of w)g.removedAt||u.append(g);if(r>0){let g=0,f=u,T=d;for(;g<r;)f.split(this,f.findOffset(T)+1,s),T=f,f=f.parent,g++;y.push({type:"content",from:l,to:l,fromPath:a,toPath:a,actor:o.getActorID()})}if(n!=null&&n.length){const g=[];let f=d;for(const T of n)f===u?u.insertAt(T,0):u.insertAfter(T,f),f=T,Is(T,S=>{u.isRemoved&&(S.remove(o),p.push({parent:this,child:S})),this.nodeMapByID.put(S.id,S)}),T.isRemoved||g.push(T);if(g.length){const T=g.map(S=>ba(S));y.length&&y[y.length-1].from===l?y[y.length-1].value=T:y.push({type:"content",from:l,to:l,fromPath:a,toPath:a,actor:o.getActorID(),value:T})}}return[y,p]}editT(e,n,r,o,s){const c=this.findPos(e[0]),u=this.findPos(e[1]);this.edit([c,u],n,r,o,s)}move(e,n,r){throw new Z(W.ErrUnimplemented,`not implemented: ${e}, ${n}, ${r}`)}pathToTreePos(e){return this.indexTree.pathToTreePos(e)}purge(e){var o;(o=e.parent)==null||o.removeChild(e),this.nodeMapByID.remove(e.id);const n=e.insPrevID,r=e.insNextID;if(n){const s=this.findFloorNode(n);s.insNextID=r}if(r){const s=this.findFloorNode(r);s.insPrevID=n}e.insPrevID=void 0,e.insNextID=void 0}getGCPairs(){const e=[];return this.indexTree.traverse(n=>{n.getRemovedAt()&&e.push({parent:this,child:n});for(const r of n.getGCPairs())e.push(r)}),e}findPos(e,n=!0){const r=this.indexTree.findTreePos(e,n);return nn.fromTreePos(r)}pathToPosRange(e){const n=this.pathToIndex(e);return[this.findPos(n),this.findPos(n+1)]}pathToPos(e){const n=this.indexTree.pathToIndex(e);return this.findPos(n)}getRoot(){return this.indexTree.getRoot()}getSize(){return this.indexTree.size}getNodeSize(){return this.nodeMapByID.size()}getIndexTree(){return this.indexTree}toXML(){return ka(this.indexTree.getRoot())}getDataSize(){const e={data:0,meta:0};return this.indexTree.traverse(n=>{if(n.getRemovedAt())return;const r=n.getDataSize();e.data+=r.data,e.meta+=r.meta}),{data:e.data,meta:e.meta+this.getMetaUsage()}}toJSON(){return JSON.stringify(this.getRootTreeNode())}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TREE"}}toJSInfoForTest(){const e=this.indexTree.getRoot(),n=(r,o=void 0,s=void 0,c=0)=>{var a,v,b,w;let u,d,m;const h=r.isText?{node:r,offset:0}:o&&s?this.toTreePos(o,s):null;h&&(u=this.indexTree.indexOf(h),d=this.indexTree.treePosToPath(h),m=nn.fromTreePos(h).toStruct());const l={type:r.type,parent:o==null?void 0:o.id.toTestString(),size:r.size,id:r.id.toTestString(),removedAt:(a=r.removedAt)==null?void 0:a.toTestString(),insPrev:(v=r.insPrevID)==null?void 0:v.toTestString(),insNext:(b=r.insNextID)==null?void 0:b.toTestString(),value:r.isText?r.value:void 0,isRemoved:r.isRemoved,children:[],depth:c,attributes:r.attrs?Jr((w=r.attrs)==null?void 0:w.toObject()):void 0,index:u,path:d,pos:m};for(let y=0;y<r.allChildren.length;y++){const p=y===0?r:r.allChildren[y-1];l.children.push(n(r.allChildren[y],r,p,c+1))}return l};return n(e)}getRootTreeNode(){return ba(this.indexTree.getRoot())}toTestTreeNode(){return Su(this.indexTree.getRoot())}toSortedJSON(){return this.toJSON()}deepcopy(){const e=this.getRoot();return new zt(e.deepcopy(),this.getCreatedAt())}toPath(e,n){const r=this.toTreePos(e,n);return r?this.indexTree.treePosToPath(r):[]}toIndex(e,n){const r=this.toTreePos(e,n);return r?this.indexTree.indexOf(r):-1}indexToPath(e){return this.indexTree.indexToPath(e)}pathToIndex(e){return this.indexTree.pathToIndex(e)}indexRangeToPosRange(e){const n=this.findPos(e[0]);return e[0]===e[1]?[n,n]:[n,this.findPos(e[1])]}indexRangeToPosStructRange(e){const[n,r]=e,o=this.findPos(n);return n===r?[o.toStruct(),o.toStruct()]:[o.toStruct(),this.findPos(r).toStruct()]}posRangeToPathRange(e){const[n,r]=this.findNodesAndSplitText(e[0]),[o,s]=this.findNodesAndSplitText(e[1]);return[this.toPath(n,r),this.toPath(o,s)]}posRangeToIndexRange(e){const[n,r]=this.findNodesAndSplitText(e[0]),[o,s]=this.findNodesAndSplitText(e[1]);return[this.toIndex(n,r),this.toIndex(o,s)]}traverseInPosRange(e,n,r,o,s){const c=this.toIndex(e,n),u=this.toIndex(r,o);return this.indexTree.tokensBetween(c,u,s)}toTreePos(e,n){if(!e||!n)return;if(e.isRemoved){let o;for(;e.isRemoved;)o=e,e=o.parent;const s=e.findOffset(o);return{node:e,offset:s}}if(e===n)return{node:e,offset:0};let r=e.findOffset(n);if(!n.isRemoved){if(n.isText)return{node:n,offset:n.paddedSize};r++}return{node:e,offset:r}}makeDeletionChanges(e,n){const r=[],o=[];let s=null,c=null;for(let u=0;u<e.length;u++){const d=e[u],m=e[u+1];s||(s=d),c=d;const h=this.findRightToken(d);(!h||!m||h[0]!==m[0]||h[1]!==m[1])&&(o.push([s,c]),s=null,c=null)}for(const u of o){const[d,m]=u,[h,l]=this.findLeftToken(d),[a,v]=m,b=l===at.Start?h:h.parent,w=v===at.Start?a:a.parent,y=this.toIndex(b,h),p=this.toIndex(w,a);y<p&&(r.length>0&&y===r[r.length-1].to?(r[r.length-1].to=p,r[r.length-1].toPath=this.toPath(w,a)):r.push({type:"content",from:y,to:p,fromPath:this.toPath(b,h),toPath:this.toPath(w,a),actor:n.getActorID()}))}return r.reverse()}findRightToken([e,n]){if(n===at.Start){const u=e.allChildren;return u.length>0?[u[0],u[0].isText?at.Text:at.Start]:[e,at.End]}const r=e.parent,o=r.allChildren,s=o.indexOf(e);if(r&&s===o.length-1)return[r,at.End];const c=o[s+1];return[c,c.isText?at.Text:at.Start]}findLeftToken([e,n]){if(n===at.End){const u=e.allChildren;if(u.length>0){const d=u[u.length-1];return[d,d.isText?at.Text:at.End]}return[e,at.Start]}const r=e.parent,o=r.allChildren,s=o.indexOf(e);if(r&&s===0)return[r,at.Start];const c=o[s-1];return[c,c.isText?at.Text:at.End]}}class No extends on{constructor(e,n,r,o,s,c){super(e,c);A(this,"fromPos");A(this,"toPos");A(this,"contents");A(this,"splitLevel");this.fromPos=n,this.toPos=r,this.contents=o,this.splitLevel=s}static create(e,n,r,o,s,c){return new No(e,n,r,o,s,c)}execute(e,n,r){var m;const o=e.findByCreatedAt(this.getParentCreatedAt());if(!o)throw new Z(W.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(o instanceof zt))throw new Z(W.ErrInvalidArgument,"fail to execute, only Tree can execute edit");const s=this.getExecutedAt(),c=o,[u,d]=c.edit([this.fromPos,this.toPos],(m=this.contents)==null?void 0:m.map(h=>h.deepcopy()),this.splitLevel,s,(()=>{let h=s.getDelimiter();return this.contents!==void 0&&(h+=this.contents.length),()=>Jt.of(s.getLamport(),++h,s.getActorID())})(),r);for(const h of d)e.registerGCPair(h);return{opInfos:u.map(({from:h,to:l,value:a,splitLevel:v,fromPath:b,toPath:w})=>({type:"tree-edit",path:e.createPath(this.getParentCreatedAt()),from:h,to:l,value:a,splitLevel:v,fromPath:b,toPath:w}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),n=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.fromPos.getLeftSiblingID().getOffset()}`,r=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.toPos.getLeftSiblingID().getOffset()}`,o=this.contents||[];return`${e}.EDIT(${n},${r},${o.map(s=>ka(s)).join("")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContents(){return this.contents}getSplitLevel(){return this.splitLevel}}class Fi{constructor(t){A(this,"vector");this.vector=t||new Map}set(t,e){this.vector.set(t,e)}unset(t){this.vector.delete(t)}get(t){return this.vector.get(t)}maxLamport(){let t=BigInt(0);for(const[,e]of this)e>t&&(t=e);return t}max(t){const e=new Map;for(const[n,r]of t){const o=this.vector.get(n),s=o&&o>r?o:r;e.set(n,s)}for(const[n,r]of this){const o=t.get(n),s=o&&o>r?o:r;e.set(n,s)}return new Fi(e)}afterOrEqual(t){const e=this.vector.get(t.getActorID());return e===void 0?!1:e>=t.getLamport()}deepcopy(){const t=new Map;for(const[e,n]of this.vector)t.set(e,n);return new Fi(t)}filter(t){const e=new Map;for(const[n]of t){const r=this.vector.get(n);r!==void 0&&e.set(n,r)}return new Fi(e)}size(){return this.vector.size}*[Symbol.iterator](){for(const[t,e]of this.vector)yield[t,e]}}const Eu=new Fi(new Map);class en{constructor(t,e,n,r,o){A(this,"clientSeq");A(this,"serverSeq");A(this,"actor");A(this,"lamport");A(this,"versionVector");this.clientSeq=t,this.serverSeq=o,this.lamport=e,this.versionVector=r,this.actor=n}hasClocks(){return this.versionVector.size()>0&&this.lamport!=ma}static of(t,e,n,r,o){return new en(t,e,n,r,o)}next(t=!1){if(t)return new en(this.clientSeq+1,this.lamport,this.actor,Eu,ma);const e=this.versionVector.deepcopy();return e.set(this.actor,this.lamport+1n),new en(this.clientSeq+1,this.lamport+1n,this.actor,e)}syncClocks(t){if(!t.hasClocks())return this;const e=t.lamport>this.lamport?t.lamport+1n:this.lamport+1n,n=this.versionVector.max(t.versionVector),r=new en(this.clientSeq,e,this.actor,n);return r.versionVector.set(this.actor,e),r}setClocks(t,e){const n=t>this.lamport?t+1n:this.lamport+1n;e.unset(ks);const r=this.versionVector.max(e);return r.set(this.actor,n),en.of(this.clientSeq,n,this.actor,r)}createTimeTicket(t){return Jt.of(this.lamport,t,this.actor)}setActor(t){return new en(this.clientSeq,this.lamport,t,this.versionVector,this.serverSeq)}setLamport(t){return new en(this.clientSeq,t,this.actor,this.versionVector,this.serverSeq)}setVersionVector(t){return new en(this.clientSeq,this.lamport,this.actor,t,this.serverSeq)}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq?this.serverSeq.toString():""}getLamport(){return this.lamport}getLamportAsString(){return this.lamport.toString()}getActorID(){return this.actor}getVersionVector(){return this.versionVector}toTestString(){return`${this.lamport.toString()}:${this.actor.slice(-2)}:${this.clientSeq}`}}const qf=new en(0,0n,ks,Eu);class Gi{constructor({id:t,operations:e,presenceChange:n,message:r}){A(this,"id");A(this,"operations");A(this,"presenceChange");A(this,"message");this.id=t,this.operations=e||[],this.presenceChange=n,this.message=r}static create({id:t,operations:e,presenceChange:n,message:r}){return new Gi({id:t,operations:e,presenceChange:n,message:r})}getID(){return this.id}getMessage(){return this.message}hasOperations(){return this.operations.length>0}getOperations(){return this.operations}setActor(t){for(const e of this.operations)e.setActor(t);this.id=this.id.setActor(t)}hasPresenceChange(){return this.presenceChange!==void 0}getPresenceChange(){return this.presenceChange}execute(t,e,n){const r=[],o=[];for(const s of this.operations){const c=s.execute(t,n,this.id.getVersionVector());if(!c)continue;const{opInfos:u,reverseOp:d}=c;r.push(...u),d&&o.unshift(d)}return this.presenceChange&&(this.presenceChange.type===Rn.Put?e.set(this.id.getActorID(),Qt(this.presenceChange.presence)):e.delete(this.id.getActorID())),{opInfos:r,reverseOps:o}}toTestString(){return`${this.operations.map(t=>t.toTestString()).join(",")}`}toStruct(){return{changeID:ot.bytesToHex(ot.toChangeID(this.getID()).toBinary()),message:this.getMessage(),operations:this.getOperations().map(t=>ot.bytesToHex(ot.toOperation(t).toBinary())),presenceChange:this.getPresenceChange()}}static fromStruct(t){const{changeID:e,operations:n,presenceChange:r,message:o}=t;return Gi.create({id:ot.bytesToChangeID(ot.hexToBytes(e)),operations:n==null?void 0:n.map(s=>ot.bytesToOperation(ot.hexToBytes(s))),presenceChange:r,message:o})}}class Ns{constructor(t,e,n,r,o,s){A(this,"documentKey");A(this,"checkpoint");A(this,"isRemoved");A(this,"changes");A(this,"snapshot");A(this,"versionVector");this.documentKey=t,this.checkpoint=e,this.isRemoved=n,this.changes=r,this.snapshot=s,this.versionVector=o}static create(t,e,n,r,o,s){return new Ns(t,e,n,r,o,s)}getDocumentKey(){return this.documentKey}getCheckpoint(){return this.checkpoint}getIsRemoved(){return this.isRemoved}getChanges(){return this.changes}hasChanges(){return this.changes.length>0}getChangeSize(){return this.changes.length}hasSnapshot(){return!!this.snapshot&&!!this.snapshot.length}getSnapshot(){return this.snapshot}getVersionVector(){return this.versionVector}}class Ui{constructor(t,e){A(this,"serverSeq");A(this,"clientSeq");this.serverSeq=t,this.clientSeq=e}static of(t,e){return new Ui(t,e)}increaseClientSeq(t){return t===0?this:new Ui(this.serverSeq,this.clientSeq+t)}forward(t){if(this.equals(t))return this;const e=this.serverSeq>t.serverSeq?this.serverSeq:t.serverSeq,n=Math.max(this.clientSeq,t.clientSeq);return Ui.of(e,n)}getServerSeqAsString(){return this.serverSeq.toString()}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq}equals(t){return this.clientSeq===t.clientSeq&&this.serverSeq==t.serverSeq}toTestString(){return`serverSeq=${this.serverSeq}, clientSeq=${this.clientSeq}`}}const Mf=new Ui(0n,0);class Ln{constructor(t,e){A(this,"createdAt");A(this,"offset");this.createdAt=t,this.offset=e}static of(t,e){return new Ln(t,e)}static fromStruct(t){return Ln.of(Jt.fromStruct(t.createdAt),t.offset)}getCreatedAt(){return this.createdAt}getOffset(){return this.offset}equals(t){return this.createdAt.compare(t.createdAt)===0&&this.offset===t.offset}hasSameCreatedAt(t){return this.createdAt.compare(t.createdAt)===0}split(t){return new Ln(this.createdAt,this.offset+t)}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toTestString(){return`${this.createdAt.toTestString()}:${this.offset}`}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}}const jf=Ln.of(Ki,0);class rn{constructor(t,e){A(this,"id");A(this,"relativeOffset");this.id=t,this.relativeOffset=e}static of(t,e){return new rn(t,e)}static fromStruct(t){const e=Ln.fromStruct(t.id);return rn.of(e,t.relativeOffset)}getID(){return this.id}getRelativeOffset(){return this.relativeOffset}getAbsoluteID(){return Ln.of(this.id.getCreatedAt(),this.id.getOffset()+this.relativeOffset)}toTestString(){return`${this.id.toTestString()}:${this.relativeOffset}`}toStruct(){return{id:this.id.toStruct(),relativeOffset:this.relativeOffset}}equals(t){return this.id.equals(t.id)?this.relativeOffset===t.relativeOffset:!1}}class ui extends du{constructor(e,n,r){super(n);A(this,"id");A(this,"removedAt");A(this,"prev");A(this,"next");A(this,"insPrev");A(this,"insNext");this.id=e,this.removedAt=r}static create(e,n){return new ui(e,n)}static createComparator(){return(e,n)=>{const r=e.getCreatedAt().compare(n.getCreatedAt());return r!==0?r:e.getOffset()>n.getOffset()?1:e.getOffset()<n.getOffset()?-1:0}}getID(){return this.id}getCreatedAt(){return this.id.getCreatedAt()}getLength(){return this.removedAt?0:this.getContentLength()}getContentLength(){return this.value&&this.value.length||0}getPrev(){return this.prev}getNext(){return this.next}getInsPrev(){return this.insPrev}getInsNext(){return this.insNext}getInsPrevID(){return this.insPrev.getID()}setPrev(e){this.prev=e,e&&(e.next=this)}setNext(e){this.next=e,e&&(e.prev=this)}setInsPrev(e){this.insPrev=e,e&&(e.insNext=this)}setInsNext(e){this.insNext=e,e&&(e.insPrev=this)}hasNext(){return!!this.next}hasInsPrev(){return!!this.insPrev}isRemoved(){return!!this.removedAt}getRemovedAt(){return this.removedAt}split(e){return new ui(this.id.split(e),this.splitValue(e),this.removedAt)}canDelete(e,n){const r=!this.removedAt;return this.getCreatedAt().getLamport()<=n&&(!this.removedAt||e.after(this.removedAt))?r:!1}canStyle(e,n){return this.getCreatedAt().getLamport()<=n&&(!this.removedAt||e.after(this.removedAt))}remove(e){this.removedAt=e}createPosRange(){return[rn.of(this.id,0),rn.of(this.id,this.getLength())]}getDataSize(){const e=this.value.getDataSize();return this.id&&(e.meta+=ai),this.removedAt&&(e.meta+=ai),e}deepcopy(){return new ui(this.id,this.value,this.removedAt)}toTestString(){return`${this.id.toTestString()} ${this.value?this.value:""}`}splitValue(e){const n=this.value;return this.value=n.substring(0,e),n.substring(e,n.length)}toIDString(){return this.id.toIDString()}}class Yi{constructor(){A(this,"head");A(this,"treeByIndex");A(this,"treeByID");this.head=ui.create(jf),this.treeByIndex=new bo,this.treeByID=new Au(ui.createComparator()),this.treeByIndex.insert(this.head),this.treeByID.put(this.head.getID(),this.head)}static create(){return new Yi}edit(t,e,n,r){const[o,s]=this.findNodeWithSplit(t[1],e),[c,u]=this.findNodeWithSplit(t[0],e),d=this.findBetween(u,s),[m,h]=this.deleteNodes(d,e,r),l=s?s.getID():o.getID();let a=rn.of(l,0);if(n){const b=this.posToIndex(c.createPosRange()[1],!0),w=this.insertAfter(c,ui.create(Ln.of(e,0),n));m.length&&m[m.length-1].from===b?m[m.length-1].value=n:m.push({actor:e.getActorID(),from:b,to:b,value:n}),a=rn.of(w.getID(),w.getContentLength())}const v=[];for(const[,b]of h)v.push({parent:this,child:b});return[a,v,m]}indexToPos(t){const[e,n]=this.treeByIndex.find(t),r=e;return rn.of(r.getID(),n)}findIndexesFromRange(t){const[e,n]=t;return[this.posToIndex(e,!1),this.posToIndex(n,!0)]}posToIndex(t,e){const n=t.getAbsoluteID(),r=e?this.findFloorNodePreferToLeft(n):this.findFloorNode(n);if(!r)throw new Z(W.ErrInvalidArgument,`the node of the given id should be found: ${n.toTestString()}`);const o=this.treeByIndex.indexOf(r),s=r.isRemoved()?0:n.getOffset()-r.getID().getOffset();return o+s}findNode(t){return this.findFloorNode(t)}get length(){return this.treeByIndex.length}getTreeByIndex(){return this.treeByIndex}getTreeByID(){return this.treeByID}toString(){const t=[];for(const e of this)e.isRemoved()||t.push(e.getValue());return t.join("")}*[Symbol.iterator](){let t=this.head.getNext();for(;t;)yield t,t=t.getNext()}getHead(){return this.head}deepcopy(){const t=new Yi;let e=this.head.getNext(),n=t.head,r;for(;e;){if(r=t.insertAfter(n,e.deepcopy()),e.hasInsPrev()){const o=t.findNode(e.getInsPrevID());r.setInsPrev(o)}n=r,e=e.getNext()}return t}toTestString(){const t=[];let e=this.head;for(;e;)e.isRemoved()?t.push(`{${e.toTestString()}}`):t.push(`[${e.toTestString()}]`),e=e.getNext();return t.join("")}insertAfter(t,e){const n=t.getNext();return e.setPrev(t),n&&n.setPrev(e),this.treeByID.put(e.getID(),e),this.treeByIndex.insertAfter(t,e),e}findNodeWithSplit(t,e){const n=t.getAbsoluteID();let r=this.findFloorNodePreferToLeft(n);const o=n.getOffset()-r.getID().getOffset();for(this.splitNode(r,o);r.hasNext()&&r.getNext().getCreatedAt().after(e);)r=r.getNext();return[r,r.getNext()]}findFloorNodePreferToLeft(t){let e=this.findFloorNode(t);if(!e)throw new Z(W.ErrInvalidArgument,`the node of the given id should be found: ${t.toTestString()}`);if(t.getOffset()>0&&e.getID().getOffset()==t.getOffset()){if(!e.hasInsPrev())return e;e=e.getInsPrev()}return e}findFloorNode(t){const e=this.treeByID.floorEntry(t);if(e&&!(!e.key.equals(t)&&!e.key.hasSameCreatedAt(t)))return e.value}findBetween(t,e){const n=[];let r=t;for(;r&&r!==e;)n.push(r),r=r.getNext();return n}splitNode(t,e){if(e>t.getContentLength())throw new Z(W.ErrInvalidArgument,"offset should be less than or equal to length");if(e===0)return t;if(e===t.getContentLength())return t.getNext();const n=t.split(e);this.treeByIndex.updateWeight(n),this.insertAfter(t,n);const r=t.getInsNext();return r&&r.setInsPrev(n),n.setInsPrev(t),n}deleteNodes(t,e,n){if(!t.length)return[[],new Map];const[r,o]=this.filterNodes(t,e,n),s=new Map,c=this.makeChanges(o,e);for(const u of r)s.set(u.getID().toIDString(),u),u.remove(e);return this.deleteIndexNodes(o),[c,s]}filterNodes(t,e,n){const r=[],o=[],[s,c]=this.findEdgesOfCandidates(t);o.push(s);for(const u of t){const d=u.getCreatedAt().getActorID();let m=co;n!=null&&(m=n.get(d)?n.get(d):0n),u.canDelete(e,m)?r.push(u):o.push(u)}return o.push(c),[r,o]}findEdgesOfCandidates(t){return[t[0].getPrev(),t[t.length-1].getNext()]}makeChanges(t,e){const n=[];let r,o;for(let s=0;s<t.length-1;s++){const c=t[s],u=t[s+1];c.getNext()!=u&&([r]=this.findIndexesFromRange(c.getNext().createPosRange()),u?[,o]=this.findIndexesFromRange(u.getPrev().createPosRange()):o=this.treeByIndex.length,r<o&&n.push({actor:e.getActorID(),from:r,to:o}))}return n.reverse()}deleteIndexNodes(t){for(let e=0;e<t.length-1;e++){const n=t[e],r=t[e+1];n.getNext()!=r&&this.treeByIndex.deleteRange(n,r)}}purge(t){this.treeByIndex.delete(t),this.treeByID.remove(t.getID());const e=t.getPrev(),n=t.getNext(),r=t.getInsPrev(),o=t.getInsNext();e&&e.setNext(n),n&&n.setPrev(e),t.setPrev(void 0),t.setNext(void 0),r&&r.setInsNext(o),o&&o.setInsPrev(r),t.setInsPrev(void 0),t.setInsNext(void 0)}}const Il=i=>i<0?Math.ceil(i):Math.floor(i);var Dn=(i=>(i[i.Int=0]="Int",i[i.Long=1]="Long",i))(Dn||{});class Nt extends xo{constructor(e,n,r){super(r);A(this,"valueType");A(this,"value");switch(this.valueType=e,e){case 0:typeof n=="number"?n>Math.pow(2,31)-1||n<-Math.pow(2,31)?this.value=Me.fromNumber(n).toInt():this.value=Il(n):this.value=n.toInt();break;case 1:typeof n=="number"?this.value=Me.fromNumber(n):this.value=n;break;default:throw new Z(W.ErrUnimplemented,`unimplemented type: ${e}`)}}static create(e,n,r){return new Nt(e,n,r)}static valueFromBytes(e,n){switch(e){case 0:return n[0]|n[1]<<8|n[2]<<16|n[3]<<24;case 1:return Me.fromBytesLE(Array.from(n));default:throw new Z(W.ErrUnimplemented,`unimplemented type: ${e}`)}}getDataSize(){return{data:this.valueType===0?4:8,meta:this.getMetaUsage()}}toJSON(){return`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_COUNTER"}}deepcopy(){const e=Nt.create(this.valueType,this.value,this.getCreatedAt());return e.setMovedAt(this.getMovedAt()),e}getType(){return this.valueType}static getCounterType(e){switch(typeof e){case"object":return e instanceof Me?1:void 0;case"number":return e>Math.pow(2,31)-1||e<-Math.pow(2,31)?1:0;default:return}}static isSupport(e){return!!Nt.getCounterType(e)}static isInteger(e){return e%1===0}isNumericType(){const e=this.valueType;return e===0||e===1}getValueType(){return this.valueType}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:{const e=this.value;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}case 1:{const n=this.value.toBytesLE();return Uint8Array.from(n)}default:throw new Z(W.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}increase(e){function n(r){if(!r.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof r.getValue()}`)}return n(this),n(e),this.valueType===1?this.value=this.value.add(e.getValue()):e.getType()===ut.Long?this.value=this.value+e.getValue().toInt():this.value=Me.fromNumber(this.value+Il(e.getValue())).toInt(),this}}class Zi extends on{constructor(e,n,r){super(e,r);A(this,"value");this.value=n}static create(e,n,r){return new Zi(e,n,r)}execute(e){const n=e.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new Z(W.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof Nt))throw new Z(W.ErrInvalidArgument,"fail to execute, only Counter can execute increase");const r=n,o=this.value.deepcopy();return r.increase(o),{opInfos:[{type:"increase",path:e.createPath(this.getParentCreatedAt()),value:o.getValue()}],reverseOp:this.toReverseOperation()}}toReverseOperation(){const e=this.value.deepcopy(),r=e.getType()===ut.Long?e.getValue().multiply(-1):e.getValue()*-1;return Zi.create(this.getParentCreatedAt(),nt.of(r,e.getCreatedAt()))}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.INCREASE.${this.value.toJSON()}`}getValue(){return this.value}}class $r extends on{constructor(e,n,r,o,s,c){super(e,c);A(this,"fromPos");A(this,"toPos");A(this,"attributes");A(this,"attributesToRemove");this.fromPos=n,this.toPos=r,this.attributes=o,this.attributesToRemove=s}static create(e,n,r,o,s){return new $r(e,n,r,o,[],s)}static createTreeRemoveStyleOperation(e,n,r,o,s){return new $r(e,n,r,new Map,o,s)}execute(e,n,r){const o=e.findByCreatedAt(this.getParentCreatedAt());if(!o)throw new Z(W.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(o instanceof zt))throw new Z(W.ErrInvalidArgument,"fail to execute, only Tree can execute edit");const s=o;let c,u;if(this.attributes.size){const d={};[...this.attributes].forEach(([m,h])=>d[m]=h),[u,c]=s.style([this.fromPos,this.toPos],d,this.getExecutedAt(),r)}else{const d=this.attributesToRemove;[u,c]=s.removeStyle([this.fromPos,this.toPos],d,this.getExecutedAt(),r)}for(const d of u)e.registerGCPair(d);return{opInfos:c.map(({from:d,to:m,value:h,fromPath:l,toPath:a})=>({type:"tree-style",from:d,to:m,value:this.attributes.size?{attributes:h}:{attributesToRemove:h},fromPath:l,toPath:a,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){const e=this.getParentCreatedAt().toTestString(),n=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.fromPos.getLeftSiblingID().getOffset()}`,r=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.toPos.getLeftSiblingID().getOffset()}`;return`${e}.STYLE(${n},${r},${Object.entries(this.attributes||{}).map(([o,s])=>`${o}:"${s}"`).join(" ")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getAttributesToRemove(){return this.attributesToRemove}}function Ff(i){const t=new Ea,e=t.data;for(const[n,r]of Object.entries(i))e[n]=JSON.stringify(r);return t}function Uf(i){if(i.type===Rn.Put)return new yo({type:Oi.PUT,presence:Ff(i.presence)});if(i.type===Rn.Clear)return new yo({type:Oi.CLEAR});throw new Z(W.ErrUnimplemented,"unimplemented type")}function Jf(i){return new fu({serverSeq:i.getServerSeq(),clientSeq:i.getClientSeq()})}function xu(i){return new xs({clientSeq:i.getClientSeq(),lamport:i.getLamport(),actorId:Ma(i.getActorID()),versionVector:Ia(i.getVersionVector())})}function Ee(i){if(i)return new Te({lamport:i.getLamport(),delimiter:i.getDelimiter(),actorId:Ma(i.getActorID())})}function Ia(i){if(!i)return;const t=new Os;for(const[e,n]of i)t.vector[e]=BigInt(n.toString());return t}function Ou(i){switch(i){case ut.Null:return _e.NULL;case ut.Boolean:return _e.BOOLEAN;case ut.Integer:return _e.INTEGER;case ut.Long:return _e.LONG;case ut.Double:return _e.DOUBLE;case ut.String:return _e.STRING;case ut.Bytes:return _e.BYTES;case ut.Date:return _e.DATE;default:throw new Z(W.ErrInvalidType,`unsupported type: ${i}`)}}function ku(i){switch(i){case Dn.Int:return _e.INTEGER_CNT;case Dn.Long:return _e.LONG_CNT;default:throw new Z(W.ErrInvalidType,`unsupported type: ${i}`)}}function js(i){if(i instanceof Tt)return new _t({type:_e.JSON_OBJECT,createdAt:Ee(i.getCreatedAt()),value:Fu(i)});if(i instanceof It)return new _t({type:_e.JSON_ARRAY,createdAt:Ee(i.getCreatedAt()),value:bh(i)});if(i instanceof $t)return new _t({type:_e.TEXT,createdAt:Ee(i.getCreatedAt())});if(i instanceof nt)return new _t({type:Ou(i.getType()),createdAt:Ee(i.getCreatedAt()),value:i.toBytes()});if(i instanceof Nt)return new _t({type:ku(i.getType()),createdAt:Ee(i.getCreatedAt()),value:i.toBytes()});if(i instanceof zt)return new _t({type:_e.TREE,createdAt:Ee(i.getCreatedAt()),value:Th(i)});throw new Z(W.ErrUnimplemented,"unimplemented element")}function $f(i){return new po({createdAt:Ee(i.getCreatedAt()),offset:i.getOffset()})}function Uo(i){return new zr({createdAt:Ee(i.getID().getCreatedAt()),offset:i.getID().getOffset(),relativeOffset:i.getRelativeOffset()})}function Jo(i){return new xi({parentId:fo(i.getParentID()),leftSiblingId:fo(i.getLeftSiblingID())})}function fo(i){return new si({createdAt:Ee(i.getCreatedAt()),offset:i.getOffset()})}function Iu(i){const t=new Sa;if(i instanceof ki){const e=i,n=new ns;n.parentCreatedAt=Ee(e.getParentCreatedAt()),n.key=e.getKey(),n.value=js(e.getValue()),n.executedAt=Ee(e.getExecutedAt()),t.body.case="set",t.body.value=n}else if(i instanceof Oo){const e=i,n=new rs;n.parentCreatedAt=Ee(e.getParentCreatedAt()),n.prevCreatedAt=Ee(e.getPrevCreatedAt()),n.value=js(e.getValue()),n.executedAt=Ee(e.getExecutedAt()),t.body.case="add",t.body.value=n}else if(i instanceof oi){const e=i,n=new is;n.parentCreatedAt=Ee(e.getParentCreatedAt()),n.prevCreatedAt=Ee(e.getPrevCreatedAt()),n.createdAt=Ee(e.getCreatedAt()),n.executedAt=Ee(e.getExecutedAt()),t.body.case="move",t.body.value=n}else if(i instanceof fi){const e=i,n=new os;n.parentCreatedAt=Ee(e.getParentCreatedAt()),n.createdAt=Ee(e.getCreatedAt()),n.executedAt=Ee(e.getExecutedAt()),t.body.case="remove",t.body.value=n}else if(i instanceof ko){const e=i,n=new ss;n.parentCreatedAt=Ee(e.getParentCreatedAt()),n.from=Uo(e.getFromPos()),n.to=Uo(e.getToPos()),n.content=e.getContent();const r=n.attributes;for(const[o,s]of e.getAttributes())r[o]=s;n.executedAt=Ee(e.getExecutedAt()),t.body.case="edit",t.body.value=n}else if(i instanceof Io){const e=i,n=new as;n.parentCreatedAt=Ee(e.getParentCreatedAt()),n.from=Uo(e.getFromPos()),n.to=Uo(e.getToPos());const r=n.attributes;for(const[o,s]of e.getAttributes())r[o]=s;n.executedAt=Ee(e.getExecutedAt()),t.body.case="style",t.body.value=n}else if(i instanceof Zi){const e=i,n=new ls;n.parentCreatedAt=Ee(e.getParentCreatedAt()),n.value=js(e.getValue()),n.executedAt=Ee(e.getExecutedAt()),t.body.case="increase",t.body.value=n}else if(i instanceof No){const e=i,n=new us;n.parentCreatedAt=Ee(e.getParentCreatedAt()),n.from=Jo(e.getFromPos()),n.to=Jo(e.getToPos()),n.contents=Yf(e.getContents()),n.splitLevel=e.getSplitLevel(),n.executedAt=Ee(e.getExecutedAt()),t.body.case="treeEdit",t.body.value=n}else if(i instanceof $r){const e=i,n=new cs;n.parentCreatedAt=Ee(e.getParentCreatedAt()),n.from=Jo(e.getFromPos()),n.to=Jo(e.getToPos());const r=e.getAttributesToRemove();if(r.length>0)n.attributesToRemove=r;else{const o=n.attributes;for(const[s,c]of e.getAttributes())o[s]=c}n.executedAt=Ee(e.getExecutedAt()),t.body.case="treeStyle",t.body.value=n}else throw new Z(W.ErrUnimplemented,"unimplemented operation");return t}function zf(i){const t=[];for(const e of i)t.push(Iu(e));return t}function Vf(i){const t=new uu({id:xu(i.getID()),message:i.getMessage()});return i.hasOperations()&&(t.operations=zf(i.getOperations())),i.hasPresenceChange()&&(t.presenceChange=Uf(i.getPresenceChange())),t}function Kf(i){const t=[];for(const e of i)t.push(Vf(e));return t}function Hf(i){const t=[];for(const e of i)t.push(new cu({key:e.getStrKey(),element:_a(e.getValue())}));return t}function Wf(i){const t=[];for(const e of i)t.push(new ys({element:_a(e.getValue())}));return t}function Gf(i){const t=[];for(const e of i){const n=new vs;n.id=$f(e.getID()),n.value=e.getValue().getContent(),n.removedAt=Ee(e.getRemovedAt());const r=n.attributes,o=e.getValue().getAttrs();for(const s of o){const c=new Vi;c.value=s.getValue(),c.updatedAt=Ee(s.getUpdatedAt()),r[s.getKey()]=c}t.push(n)}return t}function Yf(i){const t=[];if(!i||!i.length)return t;for(const e of i)t.push(new bs({content:Na(e)}));return t}function Zf(i){const t={};for(const e of i)t[e.getKey()]=new Vi({value:e.getValue(),updatedAt:Ee(e.getUpdatedAt()),isRemoved:e.isRemoved()});return t}function Na(i){if(!i)return[];const t=[];return Is(i,(e,n)=>{const r=new mo({id:fo(e.id),type:e.type,removedAt:Ee(e.removedAt),depth:n});e.isText&&(r.value=e.value),e.insPrevID&&(r.insPrevId=fo(e.insPrevID)),e.insNextID&&(r.insNextId=fo(e.insNextID)),e.attrs&&(r.attributes=Zf(e.attrs)),t.push(r)}),t}function Xf(i){const t=new At;return t.body.case="jsonObject",t.body.value=new fs({nodes:Hf(i.getRHT()),createdAt:Ee(i.getCreatedAt()),movedAt:Ee(i.getMovedAt()),removedAt:Ee(i.getRemovedAt())}),t}function Nu(i){const t=new At;return t.body.case="jsonArray",t.body.value=new hs({nodes:Wf(i.getElements()),createdAt:Ee(i.getCreatedAt()),movedAt:Ee(i.getMovedAt()),removedAt:Ee(i.getRemovedAt())}),t}function Qf(i){const t=new At;return t.body.case="primitive",t.body.value=new ds({type:Ou(i.getType()),value:i.toBytes(),createdAt:Ee(i.getCreatedAt()),movedAt:Ee(i.getMovedAt()),removedAt:Ee(i.getRemovedAt())}),t}function eh(i){const t=new At;return t.body.case="text",t.body.value=new gs({nodes:Gf(i.getRGATreeSplit()),createdAt:Ee(i.getCreatedAt()),movedAt:Ee(i.getMovedAt()),removedAt:Ee(i.getRemovedAt())}),t}function th(i){const t=new At;return t.body.case="counter",t.body.value=new ps({type:ku(i.getType()),value:i.toBytes(),createdAt:Ee(i.getCreatedAt()),movedAt:Ee(i.getMovedAt()),removedAt:Ee(i.getRemovedAt())}),t}function _u(i){const t=new At;return t.body.case="tree",t.body.value=new ms({nodes:Na(i.getRoot()),createdAt:Ee(i.getCreatedAt()),movedAt:Ee(i.getMovedAt()),removedAt:Ee(i.getRemovedAt())}),t}function _a(i){if(i instanceof Tt)return Xf(i);if(i instanceof It)return Nu(i);if(i instanceof nt)return Qf(i);if(i instanceof $t)return eh(i);if(i instanceof Nt)return th(i);if(i instanceof zt)return _u(i);throw new Z(W.ErrUnimplemented,"unimplemented element")}function nh(i){return new Kr({documentKey:i.getDocumentKey(),checkpoint:Jf(i.getCheckpoint()),isRemoved:i.getIsRemoved(),changes:Kf(i.getChanges()),snapshot:i.getSnapshot(),versionVector:Ia(i.getVersionVector())})}function so(i){if(!(i instanceof We))return{};const t=i.findDetails(wf);for(const e of t)return e.metadata;return{}}function Qr(i){return so(i).code??""}function Pu(i){return en.of(i.clientSeq,BigInt(i.lamport),Ba(i.actorId),Pa(i.versionVector),BigInt(i.serverSeq))}function Pa(i){if(!i)return;const t=new Fi;return Object.entries(i.vector).forEach(([e,n])=>{t.set(e,BigInt(n.toString()))}),t}function xe(i){if(i)return Jt.of(BigInt(i.lamport),i.delimiter,Ba(i.actorId))}function Ca(i){const t={};return Object.entries(i.data).forEach(([e,n])=>{t[e]=JSON.parse(n)}),t}function rh(i){const t=i.type;if(t===Oi.PUT){const e=Ca(i.presence);return{type:Rn.Put,presence:e}}if(t===Oi.CLEAR)return{type:Rn.Clear};throw new Z(W.ErrInvalidType,`unsupported type: ${t}`)}function ih(i){const t=new Map;return Object.entries(i).forEach(([e,n])=>{t.set(e,Ca(n))}),t}function Cu(i){switch(i){case _e.NULL:return ut.Null;case _e.BOOLEAN:return ut.Boolean;case _e.INTEGER:return ut.Integer;case _e.LONG:return ut.Long;case _e.DOUBLE:return ut.Double;case _e.STRING:return ut.String;case _e.BYTES:return ut.Bytes;case _e.DATE:return ut.Date}throw new Z(W.ErrUnimplemented,`unimplemented value type: ${i}`)}function As(i){switch(i){case _e.INTEGER_CNT:return Dn.Int;case _e.LONG_CNT:return Dn.Long}throw new Z(W.ErrUnimplemented,`unimplemented value type: ${i}`)}function Fs(i){switch(i.type){case _e.JSON_OBJECT:return i.value?ju(i.value):Tt.create(xe(i.createdAt));case _e.JSON_ARRAY:return i.value?vh(i.value):It.create(xe(i.createdAt));case _e.TEXT:return $t.create(Yi.create(),xe(i.createdAt));case _e.TREE:return wh(i.value);case _e.NULL:case _e.BOOLEAN:case _e.INTEGER:case _e.LONG:case _e.DOUBLE:case _e.STRING:case _e.BYTES:case _e.DATE:return nt.of(nt.valueFromBytes(Cu(i.type),i.value),xe(i.createdAt));case _e.INTEGER_CNT:case _e.LONG_CNT:return Nt.create(As(i.type),Nt.valueFromBytes(As(i.type),i.value),xe(i.createdAt))}}function $o(i){return rn.of(Ln.of(xe(i.createdAt),i.offset),i.relativeOffset)}function Lu(i){return Ln.of(xe(i.createdAt),i.offset)}function oh(i){const t=To.create(i.value);Object.entries(i.attributes).forEach(([n,r])=>{t.setAttr(n,r.value,xe(r.updatedAt))});const e=ui.create(Lu(i.id),t);return e.remove(xe(i.removedAt)),e}function Ri(i){return nn.of(ho(i.parentId),ho(i.leftSiblingId))}function ho(i){return dt.of(xe(i.createdAt),i.offset)}function sh(i){if(!i.length)return;const t=[];return i.forEach(e=>{const n=La(e.content);t.push(n)}),t}function La(i){if(i.length===0)return;const t=[];for(const r of i)t.push(lh(r));const e=t[t.length-1],n=new Map;n.set(i[t.length-1].depth,t[t.length-1]);for(let r=t.length-2;r>=0;r--)n.get(i[r].depth-1).prepend(t[r]),n.set(i[r].depth,t[r]);return e.updateDescendantsSize(),zt.create(e,Ki).getRoot()}function ah(i){const t=Vr.create();for(const[e,n]of Object.entries(i))t.setInternal(e,n.value,xe(n.updatedAt),n.isRemoved);return t}function lh(i){const t=ho(i.id),e=kt.create(t,i.type),n=Object.entries(i.attributes);return e.isText?e.value=i.value:n.length&&(e.attrs=ah(i.attributes)),i.insPrevId&&(e.insPrevID=ho(i.insPrevId)),i.insNextId&&(e.insNextID=ho(i.insNextId)),e.removedAt=xe(i.removedAt),e}function Ru(i){if(i.body.case==="set"){const t=i.body.value;return ki.create(t.key,Fs(t.value),xe(t.parentCreatedAt),xe(t.executedAt))}else if(i.body.case==="add"){const t=i.body.value;return Oo.create(xe(t.parentCreatedAt),xe(t.prevCreatedAt),Fs(t.value),xe(t.executedAt))}else if(i.body.case==="move"){const t=i.body.value;return oi.create(xe(t.parentCreatedAt),xe(t.prevCreatedAt),xe(t.createdAt),xe(t.executedAt))}else if(i.body.case==="remove"){const t=i.body.value;return fi.create(xe(t.parentCreatedAt),xe(t.createdAt),xe(t.executedAt))}else if(i.body.case==="edit"){const t=i.body.value,e=new Map;return Object.entries(t.attributes).forEach(([n,r])=>{e.set(n,r)}),ko.create(xe(t.parentCreatedAt),$o(t.from),$o(t.to),t.content,e,xe(t.executedAt))}else if(i.body.case==="style"){const t=i.body.value,e=new Map;return Object.entries(t.attributes).forEach(([n,r])=>{e.set(n,r)}),Io.create(xe(t.parentCreatedAt),$o(t.from),$o(t.to),e,xe(t.executedAt))}else{if(i.body.case==="select")return;if(i.body.case==="increase"){const t=i.body.value;return Zi.create(xe(t.parentCreatedAt),Fs(t.value),xe(t.executedAt))}else if(i.body.case==="treeEdit"){const t=i.body.value;return No.create(xe(t.parentCreatedAt),Ri(t.from),Ri(t.to),sh(t.contents),t.splitLevel,xe(t.executedAt))}else if(i.body.case==="treeStyle"){const t=i.body.value,e=new Map,n=t.attributesToRemove;return(n==null?void 0:n.length)>0?$r.createTreeRemoveStyleOperation(xe(t.parentCreatedAt),Ri(t.from),Ri(t.to),n,xe(t.executedAt)):(Object.entries(t.attributes).forEach(([r,o])=>{e.set(r,o)}),$r.create(xe(t.parentCreatedAt),Ri(t.from),Ri(t.to),e,xe(t.executedAt)))}else throw new Z(W.ErrUnimplemented,"unimplemented operation")}}function uh(i){const t=[];for(const e of i){const n=Ru(e);n&&t.push(n)}return t}function Du(i){const t=[];for(const e of i)t.push(Gi.create({id:Pu(e.id),operations:uh(e.operations),presenceChange:e.presenceChange?rh(e.presenceChange):void 0,message:e.message}));return t}function ch(i){return Ui.of(BigInt(i.serverSeq),i.clientSeq)}function fh(i){return Ns.create(i.documentKey,ch(i.checkpoint),i.isRemoved,Du(i.changes),Pa(i.versionVector),i.snapshot)}function Bu(i){const t=new vo;for(const n of i.nodes){const r=Ra(n.element);t.set(n.key,r,r.getPositionedAt())}const e=new Tt(xe(i.createdAt),t);return e.setMovedAt(xe(i.movedAt)),e.setRemovedAt(xe(i.removedAt)),e}function qu(i){const t=new wo;for(const n of i.nodes)t.insert(Ra(n.element));const e=new It(xe(i.createdAt),t);return e.setMovedAt(xe(i.movedAt)),e.setRemovedAt(xe(i.removedAt)),e}function hh(i){const t=nt.of(nt.valueFromBytes(Cu(i.type),i.value),xe(i.createdAt));return t.setMovedAt(xe(i.movedAt)),t.setRemovedAt(xe(i.removedAt)),t}function dh(i){const t=new Yi;let e=t.getHead();for(const r of i.nodes){const o=t.insertAfter(e,oh(r));r.insPrevId&&o.setInsPrev(t.findNode(Lu(r.insPrevId))),e=o}const n=new $t(t,xe(i.createdAt));return n.setMovedAt(xe(i.movedAt)),n.setRemovedAt(xe(i.removedAt)),n}function gh(i){const t=Nt.create(As(i.type),Nt.valueFromBytes(As(i.type),i.value),xe(i.createdAt));return t.setMovedAt(xe(i.movedAt)),t.setRemovedAt(xe(i.removedAt)),t}function Mu(i){const t=La(i.nodes);return zt.create(t,xe(i.createdAt))}function Ra(i){if(i.body.case==="jsonObject")return Bu(i.body.value);if(i.body.case==="jsonArray")return qu(i.body.value);if(i.body.case==="primitive")return hh(i.body.value);if(i.body.case==="text")return dh(i.body.value);if(i.body.case==="counter")return gh(i.body.value);if(i.body.case==="tree")return Mu(i.body.value);throw new Z(W.ErrUnimplemented,"unimplemented element")}function ph(i){if(!i)return{root:Tt.create(Ki),presences:new Map};const t=Hs.fromBinary(i);return{root:Ra(t.root),presences:ih(t.presences)}}function mh(i){const t=Ia(i);return Da(t.toBinary())}function yh(i){const t=qa(i),e=Os.fromBinary(t);return Pa(e)}function ju(i){if(!i)throw new Z(W.ErrInvalidArgument,"bytes is empty");const t=At.fromBinary(i);return Bu(t.body.value)}function Fu(i){return _a(i).toBinary()}function vh(i){if(!i)throw new Z(W.ErrInvalidArgument,"bytes is empty");const t=At.fromBinary(i);return qu(t.body.value)}function bh(i){return Nu(i).toBinary()}function wh(i){if(!i)throw new Z(W.ErrInvalidArgument,"bytes is empty");const t=At.fromBinary(i);return Mu(t.body.value)}function Th(i){return _u(i).toBinary()}function Da(i){return i?Array.from(i).map(t=>t.toString(16).padStart(2,"0")).join(""):""}function Ba(i){return Da(i)}function qa(i){return new Uint8Array(i.match(/.{1,2}/g).map(t=>parseInt(t,16)))}function Ma(i){return qa(i)}function Ah(i){const t=xs.fromBinary(i);return Pu(t)}function Sh(i){const t=Sa.fromBinary(i);return Ru(t)}const ot={fromPresence:Ca,toChangePack:nh,fromChangePack:fh,fromChanges:Du,toTreeNodes:Na,fromTreeNodes:La,objectToBytes:Fu,bytesToObject:ju,bytesToSnapshot:ph,bytesToHex:Da,hexToBytes:qa,toHexString:Ba,toUint8Array:Ma,toOperation:Iu,toChangeID:xu,PbChangeID:xs,bytesToChangeID:Ah,bytesToOperation:Sh,versionVectorToHex:mh,hexToVersionVector:yh};var bt=(i=>(i[i.Trivial=0]="Trivial",i[i.Debug=1]="Debug",i[i.Info=2]="Info",i[i.Warn=3]="Warn",i[i.Error=4]="Error",i[i.Fatal=5]="Fatal",i))(bt||{});let mi=3;function Eh(i){mi=i}const Se={trivial:(...i)=>{mi>0||typeof console<"u"&&console.log("YORKIE T:",...i)},debug:(...i)=>{mi>1||typeof console<"u"&&console.log("YORKIE D:",...i)},info:(...i)=>{mi>2||typeof console<"u"&&console.log("YORKIE I:",...i)},warn:(...i)=>{mi>3||typeof console<"u"&&(typeof console.warn<"u"?console.warn("YORKIE W:",...i):console.log("YORKIE W:",...i))},error:(...i)=>{mi>4||typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE E:",...i):console.log("YORKIE E:",...i))},fatal:(...i)=>{typeof console<"u"&&(typeof console.error<"u"?console.error("YORKIE F:",...i):console.log("YORKIE F:",...i))},isEnabled:i=>mi<=i};function Uu(){return"xxxxxxxx-xxxx-4xxxy-xxxx-xxxxxxxxxxx".replace(/[xy]/g,i=>{const t=Math.random()*16|0;return(i==="x"?t:t&3|8).toString(16)})}class xh{constructor(t,e,n,r,o){A(this,"reconnectStreamDelay");A(this,"doc");A(this,"docID");A(this,"syncMode");A(this,"remoteChangeEventReceived");A(this,"watchStream");A(this,"watchLoopTimerID");A(this,"watchAbortController");A(this,"unsubscribeBroadcastEvent");this.reconnectStreamDelay=t,this.doc=e,this.docID=n,this.syncMode=r,this.remoteChangeEventReceived=!1,this.unsubscribeBroadcastEvent=o}changeSyncMode(t){this.syncMode=t}needRealtimeSync(){return this.syncMode===Xo.RealtimeSyncOff?!1:this.syncMode===Xo.RealtimePushOnly?this.doc.hasLocalChanges():this.syncMode!==Xo.Manual&&(this.doc.hasLocalChanges()||this.remoteChangeEventReceived)}async runWatchLoop(t){const e=async()=>{if(this.watchStream)return Promise.resolve();this.watchLoopTimerID&&(clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0);try{[this.watchStream,this.watchAbortController]=await t(()=>{this.watchStream=void 0,this.watchAbortController=void 0,this.watchLoopTimerID=setTimeout(e,this.reconnectStreamDelay)})}catch{}};await e()}cancelWatchStream(){this.watchStream&&this.watchAbortController&&(this.watchAbortController.abort(),this.watchStream=void 0,this.watchAbortController=void 0),clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0}}const Us=()=>{};class Oh{constructor(t){A(this,"finalized",!1);A(this,"observers",[]);A(this,"finalError");try{t(this)}catch(e){this.error(e)}}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,n){let r;if(!t)throw new Z(W.ErrInvalidArgument,"missing observer");if(this.finalized)throw new Z(W.ErrRefused,"observable is finalized due to previous error");typeof t=="object"?r=t:r={next:t,error:e,complete:n},r.next===void 0&&(r.next=Us),r.error===void 0&&(r.error=Us),r.complete===void 0&&(r.complete=Us);const o=Uu(),s=this.unsubscribeOne.bind(this,o);if(this.observers.push({subscriptionID:o,observer:r}),this.finalized)try{this.finalError?r.error(this.finalError):r.complete()}catch(c){Se.warn(c)}return s}unsubscribeOne(t){var e;this.observers=(e=this.observers)==null?void 0:e.filter(n=>n.subscriptionID!==t)}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t].observer)}catch(n){Se.error(n)}}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.observers=void 0)}}function kh(i){const t=new Oh(i);return{subscribe:t.subscribe.bind(t),getProxy:()=>t}}class ji{constructor(t,e,n,r){A(this,"prevID");A(this,"nextID");A(this,"delimiter");A(this,"message");A(this,"root");A(this,"operations");A(this,"presenceChange");A(this,"previousPresence");A(this,"reversePresenceKeys");this.prevID=t,this.nextID=t.next(),this.delimiter=hu,this.root=e,this.operations=[],this.previousPresence=Qt(n),this.presenceChange=void 0,this.reversePresenceKeys=new Set,this.message=r}static create(t,e,n,r){return new ji(t,e,n,r)}push(t){this.operations.push(t)}registerElement(t,e){this.root.registerElement(t,e)}registerRemovedElement(t){this.root.registerRemovedElement(t)}registerGCPair(t){this.root.registerGCPair(t)}getNextID(){return this.operations.length===0?this.prevID.next(!0).setLamport(this.prevID.getLamport()).setVersionVector(this.prevID.getVersionVector()):this.nextID}toChange(){const t=this.operations.length===0?this.prevID.next(!0):this.nextID;return Gi.create({id:t,operations:this.operations,presenceChange:this.presenceChange,message:this.message})}hasChange(){return this.operations.length>0||this.presenceChange!==void 0}setPresenceChange(t){this.presenceChange=t}setReversePresence(t,e){for(const n of Object.keys(t))e!=null&&e.addToHistory?this.reversePresenceKeys.add(n):this.reversePresenceKeys.delete(n)}getReversePresence(){if(this.reversePresenceKeys.size===0)return;const t={};for(const e of this.reversePresenceKeys)t[e]=this.previousPresence[e];return t}issueTimeTicket(){return this.delimiter+=1,this.nextID.createTimeTicket(this.delimiter)}getLastTimeTicket(){return this.nextID.createTimeTicket(this.delimiter)}}class Ao{constructor(t){A(this,"rootObject");A(this,"elementPairMapByCreatedAt");A(this,"gcElementSetByCreatedAt");A(this,"gcPairMap");this.rootObject=t,this.elementPairMapByCreatedAt=new Map,this.gcElementSetByCreatedAt=new Set,this.gcPairMap=new Map,this.registerElement(t,void 0),t.getDescendants(e=>{if(e.getRemovedAt()&&this.registerRemovedElement(e),e instanceof $t||e instanceof zt)for(const n of e.getGCPairs())this.registerGCPair(n);return!1})}static create(){return new Ao(Tt.create(Ki))}findByCreatedAt(t){const e=this.elementPairMapByCreatedAt.get(t.toIDString());if(e)return e.element}findElementPairByCreatedAt(t){return this.elementPairMapByCreatedAt.get(t.toIDString())}createSubPaths(t){let e=this.elementPairMapByCreatedAt.get(t.toIDString());if(!e)return[];const n=[];for(;e.parent;){const r=e.element.getCreatedAt(),o=e.parent.subPathOf(r);if(o===void 0)throw new Z(W.ErrInvalidArgument,`cant find the given element: ${r.toIDString()}`);n.unshift(o),e=this.elementPairMapByCreatedAt.get(e.parent.getCreatedAt().toIDString())}return n.unshift("$"),n}createPath(t){return this.createSubPaths(t).join(".")}registerElement(t,e){this.elementPairMapByCreatedAt.set(t.getCreatedAt().toIDString(),{parent:e,element:t}),t instanceof li&&t.getDescendants((n,r)=>(this.registerElement(n,r),!1))}deregisterElement(t){let e=0;const n=r=>{const o=r.getCreatedAt().toIDString();this.elementPairMapByCreatedAt.delete(o),this.gcElementSetByCreatedAt.delete(o),e++};return n(t),t instanceof li&&t.getDescendants(r=>(n(r),!1)),e}registerRemovedElement(t){this.gcElementSetByCreatedAt.add(t.getCreatedAt().toIDString())}registerGCPair(t){if(this.gcPairMap.get(t.child.toIDString())){this.gcPairMap.delete(t.child.toIDString());return}this.gcPairMap.set(t.child.toIDString(),t)}getElementMapSize(){return this.elementPairMapByCreatedAt.size}getGarbageElementSetSize(){const t=new Set;for(const e of this.gcElementSetByCreatedAt){t.add(e);const n=this.elementPairMapByCreatedAt.get(e);n.element instanceof li&&n.element.getDescendants(r=>(t.add(r.getCreatedAt().toIDString()),!1))}return t.size}getObject(){return this.rootObject}getGarbageLen(){return this.getGarbageElementSetSize()+this.gcPairMap.size}getDocSize(){const t={live:{data:0,meta:0},gc:{data:0,meta:0}};for(const[e,n]of this.elementPairMapByCreatedAt)this.gcElementSetByCreatedAt.has(e)?(t.gc.data+=n.element.getDataSize().data,t.gc.meta+=n.element.getDataSize().meta):(t.live.data+=n.element.getDataSize().data,t.live.meta+=n.element.getDataSize().meta);for(const e of this.gcPairMap.values()){const n=e.child.getDataSize();t.gc.data+=n.data,t.gc.meta+=n.meta}return t}deepcopy(){return new Ao(this.rootObject.deepcopy())}garbageCollect(t){let e=0;for(const n of this.gcElementSetByCreatedAt){const r=this.elementPairMapByCreatedAt.get(n),o=r.element.getRemovedAt();o&&(t!=null&&t.afterOrEqual(o))&&(r.parent.purge(r.element),e+=this.deregisterElement(r.element))}for(const[,n]of this.gcPairMap){const r=n.child.getRemovedAt();r&&(t!=null&&t.afterOrEqual(r))&&(n.parent.purge(n.child),this.gcPairMap.delete(n.child.toIDString()),e+=1)}return e}toJSON(){return this.rootObject.toJSON()}toSortedJSON(){return this.rootObject.toSortedJSON()}getStats(){return{elements:this.getElementMapSize(),gcPairs:this.gcPairMap.size,gcElements:this.getGarbageElementSetSize()}}}function Ju(i,t){const e=new So(i);return new Proxy(t,e.getHandlers())}class So{constructor(t){A(this,"context");A(this,"handlers");this.context=t,this.handlers={set:(e,n,r)=>(Se.isEnabled(bt.Trivial)&&Se.trivial(`obj[${n}]=${JSON.stringify(r)}`),So.setInternal(t,e,n,r),!0),get:(e,n)=>(Se.isEnabled(bt.Trivial)&&Se.trivial(`obj[${n}]`),n==="getID"?()=>e.getCreatedAt():n==="toJSON"||n==="toString"?()=>e.toJSON():n==="toJS"?()=>e.toJS():n==="toJSForTest"?()=>e.toJSForTest():yi(t,e.get(n))),ownKeys:e=>e.getKeys(),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),deleteProperty:(e,n)=>(Se.isEnabled(bt.Trivial)&&Se.trivial(`obj[${n}]`),So.deleteInternal(t,e,n),!0)}}static setInternal(t,e,n,r){if(n.includes("."))throw new Z(W.ErrInvalidObjectKey,"key must not contain the '.'.");const o=t.issueTimeTicket(),s=Ss(t,r,o),c=e.set(n,s,o);t.registerElement(s,e),c&&t.registerRemovedElement(c),t.push(ki.create(n,s.deepcopy(),e.getCreatedAt(),o))}static buildObjectMembers(t,e){const n={};for(const[r,o]of Object.entries(e)){if(r.includes("."))throw new Z(W.ErrInvalidObjectKey,"key must not contain the '.'.");const s=t.issueTimeTicket(),c=Ss(t,o,s);n[r]=c}return n}static deleteInternal(t,e,n){const r=t.issueTimeTicket(),o=e.deleteByKey(n,r);o&&(t.push(fi.create(e.getCreatedAt(),o.getCreatedAt(),r)),t.registerRemovedElement(o))}getHandlers(){return this.handlers}}function Ih(i,t){const e=new et(i,t);return new Proxy(t,e.getHandlers())}function Nh(i){return typeof i=="string"||i instanceof String?!isNaN(i):!1}function _h(i){return["concat","entries","every","filter","find","findIndex","forEach","join","keys","map","reduce","reduceRight","slice","some","toLocaleString","toString","values"].includes(i)}class et{constructor(t,e){A(this,"context");A(this,"handlers");A(this,"array");this.context=t,this.array=e,this.handlers={get:(n,r,o)=>r==="getID"?()=>n.getCreatedAt():r==="getElementByID"?s=>{const c=n.getByID(s);if(!(!c||c.isRemoved()))return ei(t,c)}:r==="getElementByIndex"?s=>{const c=n.get(s);return ei(t,c)}:r==="getLast"?()=>ei(t,n.getLast()):r==="deleteByID"?s=>{const c=et.deleteInternalByID(t,n,s);return ei(t,c)}:r==="insertAfter"?(s,c)=>{const u=et.insertAfterInternal(t,n,s,c);return ei(t,u)}:r==="insertBefore"?(s,c)=>{const u=et.insertBeforeInternal(t,n,s,c);return ei(t,u)}:r==="moveBefore"?(s,c)=>{et.moveBeforeInternal(t,n,s,c)}:r==="moveAfter"?(s,c)=>{et.moveAfterInternal(t,n,s,c)}:r==="moveFront"?s=>{et.moveFrontInternal(t,n,s)}:r==="moveLast"?s=>{et.moveLastInternal(t,n,s)}:Nh(r)?yi(t,n.get(Number(r))):r==="push"?s=>et.pushInternal(t,n,s):r==="splice"?(s,c,...u)=>et.splice(t,n,s,c,...u):r==="length"?n.length:typeof r=="symbol"&&r===Symbol.iterator?et.iteratorInternal.bind(this,t,n):r==="includes"?(s,c)=>et.includes(t,n,s,c):r==="indexOf"?(s,c)=>et.indexOf(t,n,s,c):r==="lastIndexOf"?(s,c)=>et.lastIndexOf(t,n,s,c):r==="toJSForTest"?()=>n.toJSForTest():r==="toTestString"?()=>et.toTestString(n):typeof r=="string"&&_h(r)?(...s)=>{const c=Array.from(n).map(u=>yi(t,u));return Array.prototype[r].apply(c,s)}:Reflect.get(n,r,o),deleteProperty:(n,r)=>(Se.isEnabled(bt.Trivial)&&Se.trivial(`array[${r}]`),et.deleteInternalByIndex(t,n,Number.parseInt(r)),!0)}}static*iteratorInternal(t,e){for(const n of e)yield ei(t,n)}static buildArrayElements(t,e){const n=[];for(const r of e){const o=t.issueTimeTicket(),s=Ss(t,r,o);n.push(s)}return n}static pushInternal(t,e,n){return et.insertAfterInternal(t,e,e.getLastCreatedAt(),n),e.length}static moveBeforeInternal(t,e,n,r){const o=t.issueTimeTicket(),s=e.getPrevCreatedAt(n);e.moveAfter(s,r,o),t.push(oi.create(e.getCreatedAt(),s,r,o))}static moveAfterInternal(t,e,n,r){const o=t.issueTimeTicket();e.moveAfter(n,r,o),t.push(oi.create(e.getCreatedAt(),n,r,o))}static moveFrontInternal(t,e,n){const r=t.issueTimeTicket(),o=e.getHead();e.moveAfter(o.getCreatedAt(),n,r),t.push(oi.create(e.getCreatedAt(),o.getCreatedAt(),n,r))}static moveLastInternal(t,e,n){const r=t.issueTimeTicket(),o=e.getLastCreatedAt();e.moveAfter(o,n,r),t.push(oi.create(e.getCreatedAt(),o,n,r))}static insertAfterInternal(t,e,n,r){const o=t.issueTimeTicket(),s=Ss(t,r,o);return e.insertAfter(n,s),t.registerElement(s,e),t.push(Oo.create(e.getCreatedAt(),n,s.deepcopy(),o)),s}static insertBeforeInternal(t,e,n,r){return et.insertAfterInternal(t,e,e.getPrevCreatedAt(n),r)}static deleteInternalByIndex(t,e,n){const r=t.issueTimeTicket(),o=e.deleteByIndex(n,r);if(o)return t.push(fi.create(e.getCreatedAt(),o.getCreatedAt(),r)),t.registerRemovedElement(o),o}static deleteInternalByID(t,e,n){const r=t.issueTimeTicket(),o=e.delete(n,r);return t.push(fi.create(e.getCreatedAt(),o.getCreatedAt(),r)),t.registerRemovedElement(o),o}static splice(t,e,n,r,...o){const s=e.length,c=n>=0?Math.min(n,s):Math.max(s+n,0),u=r===void 0?s:r<0?c:Math.min(c+r,s),d=[];for(let m=c;m<u;m++){const h=et.deleteInternalByIndex(t,e,c);if(h){const l=h.deepcopy();l.setRemovedAt(),d.push(yi(t,l))}}if(o){let m=c===0?e.getHead().getID():e.get(c-1).getID();for(const h of o)m=et.insertAfterInternal(t,e,m,h).getID()}return d}static includes(t,e,n,r){var c;const o=e.length,s=r===void 0?0:r<0?Math.max(r+o,0):r;if(s>=o)return!1;if(nt.isSupport(n))return Array.from(e).map(d=>yi(t,d)).includes(n,s);for(let u=s;u<o;u++)if(((c=e.get(u))==null?void 0:c.getID())===n.getID())return!0;return!1}static indexOf(t,e,n,r){var c;const o=e.length,s=r===void 0?0:r<0?Math.max(r+o,0):r;if(s>=o)return-1;if(nt.isSupport(n))return Array.from(e).map(d=>yi(t,d)).indexOf(n,s);for(let u=s;u<o;u++)if(((c=e.get(u))==null?void 0:c.getID())===n.getID())return u;return-1}static lastIndexOf(t,e,n,r){var c;const o=e.length,s=r===void 0||r>=o?o-1:r<0?r+o:r;if(s<0)return-1;if(nt.isSupport(n))return Array.from(e).map(d=>yi(t,d)).lastIndexOf(n,s);for(let u=s;u>0;u--)if(((c=e.get(u))==null?void 0:c.getID())===n.getID())return u;return-1}static toTestString(t){return t.toTestString()}getHandlers(){return this.handlers}}let _s=class{constructor(t,e){A(this,"context");A(this,"text");this.context=t,this.text=e}initialize(t,e){this.context=t,this.text=e}getID(){return this.text.getID()}edit(t,e,n,r){if(!this.context||!this.text)throw new Z(W.ErrNotInitialized,"Text is not initialized yet");if(t>e)throw new Z(W.ErrInvalidArgument,"from should be less than or equal to to");const o=this.text.indexRangeToPosRange(t,e);Se.isEnabled(bt.Debug)&&Se.debug(`EDIT: f:${t}->${o[0].toTestString()}, t:${e}->${o[1].toTestString()} c:${n}`);const s=r?Wi(r):void 0,c=this.context.issueTimeTicket(),[,u,d]=this.text.edit(o,n,c,s);for(const m of u)this.context.registerGCPair(m);return this.context.push(new ko(this.text.getCreatedAt(),o[0],o[1],n,s?new Map(Object.entries(s)):new Map,c)),this.text.findIndexesFromRange(d)}delete(t,e){return this.edit(t,e,"")}empty(){return this.edit(0,this.length,"")}setStyle(t,e,n){if(!this.context||!this.text)throw new Z(W.ErrNotInitialized,"Text is not initialized yet");if(t>e)throw new Z(W.ErrInvalidArgument,"from should be less than or equal to to");const r=this.text.indexRangeToPosRange(t,e);Se.isEnabled(bt.Debug)&&Se.debug(`STYL: f:${t}->${r[0].toTestString()}, t:${e}->${r[1].toTestString()} a:${JSON.stringify(n)}`);const o=Wi(n),s=this.context.issueTimeTicket(),[c]=this.text.setStyle(r,o,s);for(const u of c)this.context.registerGCPair(u);return this.context.push(new Io(this.text.getCreatedAt(),r[0],r[1],new Map(Object.entries(o)),s)),!0}indexRangeToPosRange(t){if(!this.context||!this.text)throw new Z(W.ErrNotInitialized,"Text is not initialized yet");const e=this.text.indexRangeToPosRange(t[0],t[1]);return[e[0].toStruct(),e[1].toStruct()]}posRangeToIndexRange(t){if(!this.context||!this.text)throw new Z(W.ErrNotInitialized,"Text is not initialized yet");const e=this.text.findIndexesFromRange([rn.fromStruct(t[0]),rn.fromStruct(t[1])]);return[e[0],e[1]]}toTestString(){if(!this.context||!this.text)throw new Z(W.ErrNotInitialized,"Text is not initialized yet");return this.text.toTestString()}values(){if(!this.context||!this.text)throw new Z(W.ErrNotInitialized,"Text is not initialized yet");return this.text.values()}get length(){return this.text.length}getTreeByIndex(){return this.text.getTreeByIndex()}getTreeByID(){return this.text.getTreeByID()}toString(){if(!this.context||!this.text)throw new Z(W.ErrNotInitialized,"Text is not initialized yet");return this.text.toString()}toJSON(){if(!this.context||!this.text)throw new Z(W.ErrNotInitialized,"Text is not initialized yet");return this.text.toJSON()}toJSForTest(){if(!this.context||!this.text)throw new Z(W.ErrNotInitialized,"Text is not initialized yet");return this.text.toJSForTest()}createRangeForTest(t,e){if(!this.context||!this.text)throw new Z(W.ErrNotInitialized,"Text is not initialized yet");return this.text.indexRangeToPosRange(t,e)}};class ja{constructor(t,e){A(this,"valueType");A(this,"value");A(this,"context");A(this,"counter");this.valueType=t,this.value=e}initialize(t,e){this.valueType=e.getValueType(),this.context=t,this.counter=e,this.value=e.getValue()}getID(){return this.counter.getID()}getValue(){return this.value}getValueType(){return this.valueType}increase(t){if(!this.context||!this.counter)throw new Z(W.ErrNotInitialized,"Counter is not initialized yet");const e=this.context.issueTimeTicket(),n=nt.of(t,e);if(!n.isNumericType())throw new TypeError(`Unsupported type of value: ${typeof n.getValue()}`);return this.counter.increase(n),this.context.push(Zi.create(this.counter.getCreatedAt(),n,e)),this}toJSForTest(){if(!this.context||!this.counter)throw new Z(W.ErrNotInitialized,"Counter is not initialized yet");return this.counter.toJSForTest()}}function Fa(i){if(i.isText)return{type:i.type,value:i.value};const t={type:i.type,children:i.children.map(e=>Fa(e))};return i.attrs&&(t.attributes=Jr(i.attrs.toObject())),t}function Ph(i,t){const e={type:i.isText?i.parent.type:i.type,children:i.isText?i.parent.getChildrenText().length===t?[]:[{type:Cn,value:i.parent.getChildrenText().slice(t)}]:i.children.slice(t).map(n=>Fa(n))};return i.attrs?e.attributes=Jr(i.attrs.toObject()):i.isText&&i.parent.attrs&&(e.attributes=Jr(i.parent.attrs.toObject())),e}function Ch(i,t){const{node:e}=i,n=[...t].slice(0,-1),r=e.isText?e.parent.getChildrenText().length:e.children.length,o=[...n,r],s=[...n],c=[];s[s.length-1]+=1,t.every((d,m)=>d===o[m])||c.push({fromPath:[...t],toPath:o});const u=Ph(e,t[t.length-1]);return u&&c.push({fromPath:s,toPath:s,content:u}),c}function Lh(i,t){const{node:e,offset:n}=i,r=e.children[n],o=e.children[n-1],{children:s}=r,c=[...t].slice(0,-1),u=[{fromPath:[...t],toPath:[...c,n+1]}];if(!r.children.length)return u;const d=[...c,n-1,o.hasTextChild()?o.getChildrenText().length:o.children.length],m=s.map(h=>Fa(h));return u.push({fromPath:d,toPath:d,content:m}),u}function Ua(i,t,e){const{type:n}=i,r=e.issueTimeTicket();if(n===Cn){$u(i);const{value:o}=i,s=kt.create(dt.of(r,0),n,o);t.append(s)}else{const{children:o=[]}=i,{attributes:s}=i;let c;if(typeof s=="object"&&!vu(s)){const d=Wi(s);c=new Vr;for(const[m,h]of Object.entries(d))c.set(m,h,r)}const u=kt.create(dt.of(r,0),n,void 0,c);t.append(u);for(const d of o)Ua(d,u,e)}}function Rh(i,t){const{type:e}=t,n=i.issueTimeTicket();let r;if(t.type===Cn){const{value:o}=t;r=kt.create(dt.of(n,0),e,o)}else if(t){const{children:o=[]}=t,{attributes:s}=t;let c;if(typeof s=="object"&&!vu(s)){const u=Wi(s);c=new Vr;for(const[d,m]of Object.entries(u))c.set(d,m,n)}r=kt.create(dt.of(i.issueTimeTicket(),0),e,void 0,c);for(const u of o)Ua(u,r,i)}return r}function $u(i){if(!i.value.length)throw new Z(W.ErrInvalidArgument,"text node cannot have empty value");return!0}function Nl(i){if(!i.length)return!0;if(i[0].type===Cn)for(const e of i){const{type:n}=e;if(n!==Cn)throw new Z(W.ErrInvalidArgument,"element node and text node cannot be passed together");$u(e)}else for(const e of i){const{type:n}=e;if(n===Cn)throw new Z(W.ErrInvalidArgument,"element node and text node cannot be passed together")}return!0}class Ja{constructor(t){A(this,"initialRoot");A(this,"context");A(this,"tree");this.initialRoot=t}initialize(t,e){this.context=t,this.tree=e}getID(){return this.tree.getID()}buildRoot(t){if(!this.initialRoot)return kt.create(dt.of(t.issueTimeTicket(),0),Nf);const e=kt.create(dt.of(t.issueTimeTicket(),0),this.initialRoot.type);for(const n of this.initialRoot.children)Ua(n,e,t);return e}getSize(){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getSize()}getNodeSize(){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getNodeSize()}getIndexTree(){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getIndexTree()}splitByPath(t){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");if(!t.length)throw new Z(W.ErrInvalidArgument,"path should not be empty");const e=this.tree.pathToTreePos(t),n=Ch(e,t);for(const r of n){const{fromPath:o,toPath:s,content:c}=r,u=this.tree.pathToPos(o),d=this.tree.pathToPos(s);this.editInternal(u,d,c?[c]:[],0)}}mergeByPath(t){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");if(!t.length)throw new Z(W.ErrInvalidArgument,"path should not be empty");const e=this.tree.pathToTreePos(t);if(e.node.isText)throw new Z(W.ErrInvalidArgument,"text node cannot be merged");const n=Lh(e,t);for(const r of n){const{fromPath:o,toPath:s,content:c}=r,u=this.tree.pathToPos(o),d=this.tree.pathToPos(s);this.editInternal(u,d,c??[],0)}}styleByPath(t,e){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");if(!t.length)throw new Z(W.ErrInvalidArgument,"path should not be empty");const[n,r]=this.tree.pathToPosRange(t),o=this.context.issueTimeTicket(),s=e?Wi(e):void 0,[c]=this.tree.style([n,r],s,o);for(const u of c)this.context.registerGCPair(u);this.context.push($r.create(this.tree.getCreatedAt(),n,r,s?new Map(Object.entries(s)):new Map,o))}style(t,e,n){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");if(t>e)throw new Z(W.ErrInvalidArgument,"from should be less than or equal to to");const r=this.tree.findPos(t),o=this.tree.findPos(e),s=this.context.issueTimeTicket(),c=n?Wi(n):void 0,[u]=this.tree.style([r,o],c,s);for(const d of u)this.context.registerGCPair(d);this.context.push($r.create(this.tree.getCreatedAt(),r,o,c?new Map(Object.entries(c)):new Map,s))}removeStyle(t,e,n){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");if(t>e)throw new Z(W.ErrInvalidArgument,"from should be less than or equal to to");const r=this.tree.findPos(t),o=this.tree.findPos(e),s=this.context.issueTimeTicket(),[c]=this.tree.removeStyle([r,o],n,s);for(const u of c)this.context.registerGCPair(u);this.context.push($r.createTreeRemoveStyleOperation(this.tree.getCreatedAt(),r,o,n,s))}editInternal(t,e,n,r=0){var u;if(n.length!==0&&n[0]&&(Nl(n),n[0].type!==Cn))for(const d of n){const{children:m=[]}=d;Nl(m)}const o=this.context.getLastTimeTicket();let s=new Array;if(((u=n[0])==null?void 0:u.type)===Cn){let d="";for(const m of n){const{value:h}=m;d+=h}s.push(kt.create(dt.of(this.context.issueTimeTicket(),0),Cn,d))}else s=n.map(d=>d&&Rh(this.context,d)).filter(d=>d);const[,c]=this.tree.edit([t,e],s.length?s.map(d=>d==null?void 0:d.deepcopy()):void 0,r,o,()=>this.context.issueTimeTicket());for(const d of c)this.context.registerGCPair(d);return this.context.push(No.create(this.tree.getCreatedAt(),t,e,s.length?s:void 0,r,o)),!0}editByPath(t,e,n,r=0){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");if(t.length!==e.length)throw new Z(W.ErrInvalidArgument,"path length should be equal");if(!t.length||!e.length)throw new Z(W.ErrInvalidArgument,"path should not be empty");const o=this.tree.pathToPos(t),s=this.tree.pathToPos(e);return this.editInternal(o,s,n?[n]:[],r)}editBulkByPath(t,e,n,r=0){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");if(t.length!==e.length)throw new Z(W.ErrInvalidArgument,"path length should be equal");if(!t.length||!e.length)throw new Z(W.ErrInvalidArgument,"path should not be empty");const o=this.tree.pathToPos(t),s=this.tree.pathToPos(e);return this.editInternal(o,s,n,r)}edit(t,e,n,r=0){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");if(t>e)throw new Z(W.ErrInvalidArgument,"from should be less than or equal to to");const o=this.tree.findPos(t),s=this.tree.findPos(e);return this.editInternal(o,s,n?[n]:[],r)}editBulk(t,e,n,r=0){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");if(t>e)throw new Z(W.ErrInvalidArgument,"from should be less than or equal to to");const o=this.tree.findPos(t),s=this.tree.findPos(e);return this.editInternal(o,s,n,r)}toXML(){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toXML()}toJSON(){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSON()}toJSForTest(){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSForTest()}toJSInfoForTest(){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSInfoForTest()}getRootTreeNode(){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getRootTreeNode()}indexToPath(t){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");return this.tree.indexToPath(t)}pathToIndex(t){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");return this.tree.pathToIndex(t)}pathRangeToPosRange(t){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");const e=[this.tree.pathToIndex(t[0]),this.tree.pathToIndex(t[1])],n=this.tree.indexRangeToPosRange(e);return[n[0].toStruct(),n[1].toStruct()]}indexRangeToPosRange(t){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");return this.tree.indexRangeToPosStructRange(t)}posRangeToIndexRange(t){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");const e=[nn.fromStruct(t[0]),nn.fromStruct(t[1])];return this.tree.posRangeToIndexRange(e)}posRangeToPathRange(t){if(!this.context||!this.tree)throw new Z(W.ErrNotInitialized,"Tree is not initialized yet");const e=[nn.fromStruct(t[0]),nn.fromStruct(t[1])];return this.tree.posRangeToPathRange(e)}}function _l(i,t){return Ju(i,t)}function ei(i,t){if(t){if(t instanceof nt)return t;if(t instanceof Tt)return Ju(i,t);if(t instanceof It)return Ih(i,t);if(t instanceof $t)return new _s(i,t);if(t instanceof Nt){const e=new ja(Dn.Int,0);return e.initialize(i,t),e}else if(t instanceof zt){const e=new Ja;return e.initialize(i,t),e}}else return;throw new TypeError(`Unsupported type of element: ${typeof t}`)}function yi(i,t){const e=ei(i,t);return e instanceof nt?e.getValue():e}function Ss(i,t,e){let n;if(nt.isSupport(t))n=nt.of(t,e);else if(Array.isArray(t))n=It.create(e,et.buildArrayElements(i,t));else if(typeof t=="object")t instanceof _s?(n=$t.create(Yi.create(),e),t.initialize(i,n)):t instanceof ja?(n=Nt.create(t.getValueType(),t.getValue(),e),t.initialize(i,n)):t instanceof Ja?(n=zt.create(t.buildRoot(i),e),t.initialize(i,n)):n=Tt.create(e,So.buildObjectMembers(i,t));else throw new TypeError(`Unsupported type of value: ${typeof t}`);return n}class Js{constructor(t,e){A(this,"context");A(this,"presence");this.context=t,this.presence=e}set(t,e){for(const n of Object.keys(t))this.presence[n]=t[n];this.context.setPresenceChange({type:Rn.Put,presence:Qt(this.presence)}),this.context.setReversePresence(t,e)}get(t){return this.presence[t]}clear(){this.presence={},this.context.setPresenceChange({type:Rn.Clear})}}const Pl=50;class Dh{constructor(){A(this,"undoStack",[]);A(this,"redoStack",[])}hasUndo(){return this.undoStack.length>0}hasRedo(){return this.redoStack.length>0}pushUndo(t){this.undoStack.length>=Pl&&this.undoStack.shift(),this.undoStack.push(t)}popUndo(){return this.undoStack.pop()}pushRedo(t){this.redoStack.length>=Pl&&this.redoStack.shift(),this.redoStack.push(t)}popRedo(){return this.redoStack.pop()}clearRedo(){this.redoStack=[]}getUndoStackForTest(){return this.undoStack}getRedoStackForTest(){return this.redoStack}}const Bh="yorkie-devtools-panel",qh="yorkie-devtools-sdk";function Mh(i){return[lt.StatusChanged,lt.Snapshot,lt.LocalChange,lt.RemoteChange,lt.Initialized,lt.Watched,lt.Unwatched,lt.PresenceChanged].includes(i.type)}function jh(i){return i.every(Mh)}let Di="disconnected";const Cl=new Map,Zo=new Map;typeof window<"u"&&(window.docEventsForReplayByDocKey=Zo);function zo(i,t){(t!=null&&t.force||Di!=="disconnected")&&window.postMessage({source:qh,...i},"*")}function Fh(i){if(!i.isEnableDevtools()||typeof window>"u"||Cl.has(i.getKey()))return;Zo.set(i.getKey(),[]);const t=i.subscribe("all",e=>{jh(e)&&(Zo.get(i.getKey()).push(e),Di==="synced"&&zo({msg:"doc::sync::partial",docKey:i.getKey(),event:e}))});Cl.set(i.getKey(),[t]),zo({msg:"refresh-devtools"},{force:!0}),window.addEventListener("message",e=>{var r;if(((r=e.data)==null?void 0:r.source)!==Bh)return;switch(e.data.msg){case"devtools::connect":if(Di!=="disconnected")break;Di="connected",zo({msg:"doc::available",docKey:i.getKey()}),Se.info(`[YD] Devtools connected. Doc: ${i.getKey()}`);break;case"devtools::disconnect":Di="disconnected",Se.info(`[YD] Devtools disconnected. Doc: ${i.getKey()}`);break;case"devtools::subscribe":Di="synced",zo({msg:"doc::sync::full",docKey:i.getKey(),events:Zo.get(i.getKey())}),Se.info(`[YD] Devtools subscribed. Doc: ${i.getKey()}`);break}})}var ti=(i=>(i.Detached="detached",i.Attached="attached",i.Removed="removed",i))(ti||{}),lt=(i=>(i.StatusChanged="status-changed",i.ConnectionChanged="connection-changed",i.SyncStatusChanged="sync-status-changed",i.Snapshot="snapshot",i.LocalChange="local-change",i.RemoteChange="remote-change",i.Initialized="initialized",i.Watched="watched",i.Unwatched="unwatched",i.PresenceChanged="presence-changed",i.Broadcast="broadcast",i.LocalBroadcast="local-broadcast",i.AuthError="auth-error",i))(lt||{}),Eo=(i=>(i.Connected="connected",i.Disconnected="disconnected",i))(Eo||{}),wa=(i=>(i.Synced="synced",i.SyncFailed="sync-failed",i))(wa||{});class zu{constructor(t,e){A(this,"key");A(this,"status");A(this,"opts");A(this,"changeID");A(this,"checkpoint");A(this,"localChanges");A(this,"root");A(this,"clone");A(this,"eventStream");A(this,"eventStreamObserver");A(this,"onlineClients");A(this,"presences");A(this,"history");A(this,"internalHistory");A(this,"isUpdating");this.opts=e||{},this.key=t,this.status="detached",this.root=Ao.create(),this.changeID=qf,this.checkpoint=Mf,this.localChanges=[],this.eventStream=kh(n=>{this.eventStreamObserver=n}),this.onlineClients=new Set,this.presences=new Map,this.isUpdating=!1,this.internalHistory=new Dh,this.history={canUndo:this.canUndo.bind(this),canRedo:this.canRedo.bind(this),undo:this.undo.bind(this),redo:this.redo.bind(this)},Fh(this)}update(t,e){if(this.getStatus()==="removed")throw new Z(W.ErrDocumentRemoved,`${this.key} is removed`);this.ensureClone();const n=this.changeID.getActorID(),r=ji.create(this.changeID,this.clone.root,this.clone.presences.get(n)||{},e);try{const o=_l(r,this.clone.root.getObject());this.presences.has(n)||this.clone.presences.set(n,{}),this.isUpdating=!0,t(o,new Js(r,this.clone.presences.get(n)))}catch(o){throw this.clone=void 0,o}finally{this.isUpdating=!1}if(r.hasChange()){Se.isEnabled(bt.Trivial)&&Se.trivial(`trying to update a local change: ${this.toJSON()}`);const o=r.toChange(),{opInfos:s,reverseOps:c}=o.execute(this.root,this.presences,Ge.Local),u=r.getReversePresence();u&&c.push({type:"presence",value:u}),this.localChanges.push(o),c.length>0&&this.internalHistory.pushUndo(c),s.length>0&&this.internalHistory.clearRedo(),this.changeID=r.getNextID();const d=[];s.length>0&&d.push({type:"local-change",source:Ge.Local,value:{message:o.getMessage()||"",operations:s,actor:n,clientSeq:o.getID().getClientSeq(),serverSeq:o.getID().getServerSeq()},rawChange:this.isEnableDevtools()?o.toStruct():void 0}),o.hasPresenceChange()&&d.push({type:"presence-changed",source:Ge.Local,value:{clientID:n,presence:this.getPresence(n)}}),this.publish(d),Se.isEnabled(bt.Trivial)&&Se.trivial(`after update a local change: ${this.toJSON()}`)}}subscribe(t,e,n,r){if(typeof t=="string"){if(typeof e!="function")throw new Z(W.ErrInvalidArgument,"Second argument must be a callback function");if(t==="presence"){const c=e;return this.eventStream.subscribe(u=>{for(const d of u)d.type!=="initialized"&&d.type!=="watched"&&d.type!=="unwatched"&&d.type!=="presence-changed"||c(d)},n,r)}if(t==="my-presence"){const c=e;return this.eventStream.subscribe(u=>{for(const d of u)d.type!=="initialized"&&d.type!=="presence-changed"||d.type==="presence-changed"&&d.value.clientID!==this.changeID.getActorID()||c(d)},n,r)}if(t==="others"){const c=e;return this.eventStream.subscribe(u=>{for(const d of u)d.type!=="watched"&&d.type!=="unwatched"&&d.type!=="presence-changed"||d.value.clientID!==this.changeID.getActorID()&&c(d)},n,r)}if(t==="connection"){const c=e;return this.eventStream.subscribe(u=>{for(const d of u)d.type==="connection-changed"&&c(d)},n,r)}if(t==="status"){const c=e;return this.eventStream.subscribe(u=>{for(const d of u)d.type==="status-changed"&&c(d)},n,r)}if(t==="sync"){const c=e;return this.eventStream.subscribe(u=>{for(const d of u)d.type==="sync-status-changed"&&c(d)},n,r)}if(t==="local-broadcast"){const c=e;return this.eventStream.subscribe(u=>{for(const d of u)d.type==="local-broadcast"&&c(d)},n)}if(t==="broadcast"){const c=e;return this.eventStream.subscribe(u=>{for(const d of u)d.type==="broadcast"&&c(d)},n)}if(t==="auth-error"){const c=e;return this.eventStream.subscribe(u=>{for(const d of u)d.type==="auth-error"&&c(d)},n)}if(t==="all"){const c=e;return this.eventStream.subscribe(c,n,r)}const o=t,s=e;return this.eventStream.subscribe(c=>{for(const u of c){if(u.type!=="local-change"&&u.type!=="remote-change")continue;const d=[];for(const m of u.value.operations)this.isSameElementOrChildOf(m.path,o)&&d.push(m);d.length&&s({...u,value:{...u.value,operations:d}})}},n,r)}if(typeof t=="function"){const o=t,s=e,c=n;return this.eventStream.subscribe(u=>{for(const d of u)d.type!=="snapshot"&&d.type!=="local-change"&&d.type!=="remote-change"||o(d)},s,c)}throw new Z(W.ErrInvalidArgument,`"${t}" is not a valid`)}publish(t){this.eventStreamObserver&&this.eventStreamObserver.next(t)}isSameElementOrChildOf(t,e){if(e===t)return!0;const n=t.split(".");return e.split(".").every((o,s)=>o===n[s])}removePushedLocalChanges(t){for(;this.localChanges.length&&!(this.localChanges[0].getID().getClientSeq()>t);)this.localChanges.shift()}applyChangePack(t){const e=t.hasSnapshot();e?this.applySnapshot(t.getCheckpoint().getServerSeq(),t.getVersionVector(),t.getSnapshot(),t.getCheckpoint().getClientSeq()):(this.applyChanges(t.getChanges(),Ge.Remote),this.removePushedLocalChanges(t.getCheckpoint().getClientSeq())),this.checkpoint=this.checkpoint.forward(t.getCheckpoint()),e||this.garbageCollect(t.getVersionVector()),t.getIsRemoved()&&this.applyStatus("removed"),Se.isEnabled(bt.Trivial)&&Se.trivial(`${this.root.toJSON()}`)}getCheckpoint(){return this.checkpoint}getChangeID(){return this.changeID}hasLocalChanges(){return this.localChanges.length>0}ensureClone(){this.clone||(this.clone={root:this.root.deepcopy(),presences:Qt(this.presences)})}createChangePack(){const t=Array.from(this.localChanges),e=this.checkpoint.increaseClientSeq(t.length);return Ns.create(this.key,e,!1,t,this.getVersionVector())}setActor(t){for(const e of this.localChanges)e.setActor(t);this.changeID=this.changeID.setActor(t)}isEnableDevtools(){return!!this.opts.enableDevtools}getKey(){return this.key}getStatus(){return this.status}getCloneRoot(){if(this.clone)return this.clone.root.getObject()}getRoot(){this.ensureClone();const t=ji.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});return _l(t,this.clone.root.getObject())}getDocSize(){return this.root.getDocSize()}garbageCollect(t){return this.opts.disableGC?0:(this.clone&&this.clone.root.garbageCollect(t),this.root.garbageCollect(t))}getRootObject(){return this.root.getObject()}getGarbageLen(){return this.root.getGarbageLen()}getGarbageLenFromClone(){return this.clone.root.getGarbageLen()}toJSON(){return this.root.toJSON()}toSortedJSON(){return this.root.toSortedJSON()}getStats(){return this.root.getStats()}toJSForTest(){return{...this.getRoot().toJSForTest(),key:"root"}}applySnapshot(t,e,n,r=-1){const{root:o,presences:s}=ot.bytesToSnapshot(n);this.root=new Ao(o),this.presences=s,this.changeID=this.changeID.setClocks(e.maxLamport(),e),this.clone=void 0,this.removePushedLocalChanges(r),this.applyChanges(this.localChanges,Ge.Local),this.publish([{type:"snapshot",source:Ge.Remote,value:{serverSeq:t.toString(),snapshot:this.isEnableDevtools()?ot.bytesToHex(n):void 0,snapshotVector:ot.versionVectorToHex(e)}}])}applyChanges(t,e){Se.isEnabled(bt.Debug)&&Se.debug(`trying to apply ${t.length} remote changes.elements:${this.root.getElementMapSize()}, removeds:${this.root.getGarbageElementSetSize()}`),Se.isEnabled(bt.Trivial)&&Se.trivial(t.map(n=>`${n.getID().toTestString()}	${n.toTestString()}`).join(`
`));for(const n of t)this.applyChange(n,e);Se.isEnabled(bt.Debug)&&Se.debug(`after appling ${t.length} remote changes.elements:${this.root.getElementMapSize()},  removeds:${this.root.getGarbageElementSetSize()}`)}applyChange(t,e){this.ensureClone(),t.execute(this.clone.root,this.clone.presences,e);const n=[],r=t.getID().getActorID();if(t.hasPresenceChange()&&this.onlineClients.has(r)){const s=t.getPresenceChange();switch(s.type){case Rn.Put:n.push(this.presences.has(r)?{type:"presence-changed",source:e,value:{clientID:r,presence:s.presence}}:{type:"watched",source:Ge.Remote,value:{clientID:r,presence:s.presence}});break;case Rn.Clear:n.push({type:"unwatched",source:Ge.Remote,value:{clientID:r,presence:this.getPresence(r)}}),this.removeOnlineClient(r);break}}const{opInfos:o}=t.execute(this.root,this.presences,e);if(this.changeID=this.changeID.syncClocks(t.getID()),o.length>0){const s=this.isEnableDevtools()?t.toStruct():void 0;n.push(e===Ge.Remote?{type:"remote-change",source:e,value:{actor:r,clientSeq:t.getID().getClientSeq(),serverSeq:t.getID().getServerSeq(),message:t.getMessage()||"",operations:o},rawChange:s}:{type:"local-change",source:e,value:{actor:r,clientSeq:t.getID().getClientSeq(),serverSeq:t.getID().getServerSeq(),message:t.getMessage()||"",operations:o},rawChange:s})}n.length>0&&this.publish(n)}applyWatchStream(t){if(t.body.case==="initialization"){const e=t.body.value.clientIds,n=new Set;for(const r of e)r!==this.changeID.getActorID()&&n.add(r);this.setOnlineClients(n),this.publish([{type:"initialized",source:Ge.Local,value:this.getPresences()}]);return}if(t.body.case==="event"){const{type:e,publisher:n}=t.body.value,r=[];if(e===Ei.DOCUMENT_WATCHED){if(this.onlineClients.has(n)&&this.hasPresence(n))return;this.addOnlineClient(n),this.hasPresence(n)&&r.push({type:"watched",source:Ge.Remote,value:{clientID:n,presence:this.getPresence(n)}})}else if(e===Ei.DOCUMENT_UNWATCHED){const o=this.getPresence(n);this.removeOnlineClient(n),o&&r.push({type:"unwatched",source:Ge.Remote,value:{clientID:n,presence:o}})}else if(e===Ei.DOCUMENT_BROADCAST&&t.body.value.body){const{topic:o,payload:s}=t.body.value.body,c=new TextDecoder;r.push({type:"broadcast",value:{clientID:n,topic:o,payload:JSON.parse(c.decode(s))}})}r.length>0&&this.publish(r)}}applyStatus(t){this.status=t,t==="detached"&&this.setActor(ks),this.publish([{source:t==="removed"?Ge.Remote:Ge.Local,type:"status-changed",value:t==="attached"?{status:t,actorID:this.changeID.getActorID()}:{status:t}}])}applyDocEventForReplay(t){if(t.type==="status-changed"){this.applyStatus(t.value.status),t.value.status==="attached"&&this.setActor(t.value.actorID);return}if(t.type==="snapshot"){const{snapshot:e,serverSeq:n,snapshotVector:r}=t.value;if(!e)return;this.applySnapshot(BigInt(n),ot.hexToVersionVector(r),ot.hexToBytes(e));return}if(t.type==="local-change"||t.type==="remote-change"){if(!t.rawChange)return;const e=Gi.fromStruct(t.rawChange);this.applyChange(e,t.source)}if(t.type==="initialized"){const e=new Set;for(const{clientID:n,presence:r}of t.value)e.add(n),this.presences.set(n,r);this.setOnlineClients(e);return}if(t.type==="watched"){const{clientID:e,presence:n}=t.value;this.addOnlineClient(e),this.presences.set(e,n);return}if(t.type==="unwatched"){const{clientID:e}=t.value;this.removeOnlineClient(e),this.presences.delete(e)}if(t.type==="presence-changed"){const{clientID:e,presence:n}=t.value;this.presences.set(e,n)}}applyDocEventsForReplay(t){for(const e of t)this.applyDocEventForReplay(e)}getValueByPath(t){if(!t.startsWith("$"))throw new Z(W.ErrInvalidArgument,'path must start with "$"');const e=t.split(".");e.shift();let n=this.getRoot();for(const r of e)if(n=n[r],n===void 0)return;return n}setOnlineClients(t){this.onlineClients=t}resetOnlineClients(){this.onlineClients=new Set}addOnlineClient(t){this.onlineClients.add(t)}removeOnlineClient(t){this.onlineClients.delete(t)}hasPresence(t){return this.presences.has(t)}getMyPresence(){if(this.status!=="attached")return{};const t=this.presences.get(this.changeID.getActorID());return t?Qt(t):{}}getPresence(t){if(t===this.changeID.getActorID())return this.getMyPresence();if(!this.onlineClients.has(t))return;const e=this.presences.get(t);return e?Qt(e):void 0}getPresenceForTest(t){const e=this.presences.get(t);return e?Qt(e):void 0}getPresences(){const t=[];t.push({clientID:this.changeID.getActorID(),presence:Qt(this.getMyPresence())});for(const e of this.onlineClients)this.presences.has(e)&&t.push({clientID:e,presence:Qt(this.presences.get(e))});return t}getSelfForTest(){return{clientID:this.getChangeID().getActorID(),presence:this.getMyPresence()}}getOthersForTest(){const t=this.getChangeID().getActorID();return this.getPresences().filter(e=>e.clientID!==t).sort((e,n)=>e.clientID>n.clientID?1:-1)}canUndo(){return this.internalHistory.hasUndo()&&!this.isUpdating}canRedo(){return this.internalHistory.hasRedo()&&!this.isUpdating}undo(){if(this.isUpdating)throw new Z(W.ErrRefused,"Undo is not allowed during an update");const t=this.internalHistory.popUndo();if(t===void 0)throw new Z(W.ErrRefused,"There is no operation to be undone");this.ensureClone();const e=ji.create(this.changeID,this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(const d of t){if(!(d instanceof on)){new Js(e,Qt(this.clone.presences.get(this.changeID.getActorID()))).set(d.value,{addToHistory:!0});continue}const m=e.issueTimeTicket();d.setExecutedAt(m),e.push(d)}const n=e.toChange();n.execute(this.clone.root,this.clone.presences,Ge.UndoRedo);const{opInfos:r,reverseOps:o}=n.execute(this.root,this.presences,Ge.UndoRedo),s=e.getReversePresence();if(s&&o.push({type:"presence",value:s}),o.length>0&&this.internalHistory.pushRedo(o),!n.hasPresenceChange()&&r.length===0)return;this.localChanges.push(n),this.changeID=e.getNextID();const c=this.changeID.getActorID(),u=[];r.length>0&&u.push({type:"local-change",source:Ge.UndoRedo,value:{message:n.getMessage()||"",operations:r,actor:c,clientSeq:n.getID().getClientSeq(),serverSeq:n.getID().getServerSeq()},rawChange:this.isEnableDevtools()?n.toStruct():void 0}),n.hasPresenceChange()&&u.push({type:"presence-changed",source:Ge.UndoRedo,value:{clientID:c,presence:this.getPresence(c)}}),this.publish(u)}redo(){if(this.isUpdating)throw new Z(W.ErrRefused,"Redo is not allowed during an update");const t=this.internalHistory.popRedo();if(t===void 0)throw new Z(W.ErrRefused,"There is no operation to be redone");this.ensureClone();const e=ji.create(this.changeID,this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(const d of t){if(!(d instanceof on)){new Js(e,Qt(this.clone.presences.get(this.changeID.getActorID()))).set(d.value,{addToHistory:!0});continue}const m=e.issueTimeTicket();d.setExecutedAt(m),e.push(d)}const n=e.toChange();n.execute(this.clone.root,this.clone.presences,Ge.UndoRedo);const{opInfos:r,reverseOps:o}=n.execute(this.root,this.presences,Ge.UndoRedo),s=e.getReversePresence();if(s&&o.push({type:"presence",value:s}),o.length>0&&this.internalHistory.pushUndo(o),!n.hasPresenceChange()&&r.length===0)return;this.localChanges.push(n),this.changeID=e.getNextID();const c=this.changeID.getActorID(),u=[];r.length>0&&u.push({type:"local-change",source:Ge.UndoRedo,value:{message:n.getMessage()||"",operations:r,actor:c,clientSeq:n.getID().getClientSeq(),serverSeq:n.getID().getServerSeq()},rawChange:this.isEnableDevtools()?n.toStruct():void 0}),n.hasPresenceChange()&&u.push({type:"presence-changed",source:Ge.UndoRedo,value:{clientID:c,presence:this.getPresence(c)}}),this.publish(u)}getUndoStackForTest(){return this.internalHistory.getUndoStackForTest()}getRedoStackForTest(){return this.internalHistory.getRedoStackForTest()}broadcast(t,e,n){const r={type:"local-broadcast",value:{topic:t,payload:e},options:n};this.publish([r])}getVersionVector(){return this.changeID.getVersionVector()}}function Uh(i,t){let e=t;return{authInterceptor:o=>async s=>(i&&s.header.set("x-api-key",i),e&&s.header.set("authorization",e),await o(s)),setToken:o=>{e=o}}}const Jh="@yorkie-js/sdk",$h="0.6.12",Ll={name:Jh,version:$h};function zh(i){return t=>async e=>(i?e.header.set("x-yorkie-user-agent",i):e.header.set("x-yorkie-user-agent",Ll.name+"/"+Ll.version),await t(e))}const Vh=i=>{try{if(JSON.stringify(i)===void 0)return!1}catch{return!1}return!0};var Xo=(i=>(i.Manual="manual",i.Realtime="realtime",i.RealtimePushOnly="realtime-pushonly",i.RealtimeSyncOff="realtime-syncoff",i))(Xo||{});const oo={rpcAddr:"https://api.yorkie.dev",syncLoopDuration:50,retrySyncLoopDelay:1e3,reconnectStreamDelay:1e3},$s={maxRetries:1/0,initialRetryInterval:1e3,maxBackoff:2e4};class Vu{constructor(t){A(this,"id");A(this,"key");A(this,"metadata");A(this,"status");A(this,"attachmentMap");A(this,"apiKey");A(this,"authTokenInjector");A(this,"conditions");A(this,"syncLoopDuration");A(this,"reconnectStreamDelay");A(this,"retrySyncLoopDelay");A(this,"rpcClient");A(this,"setAuthToken");A(this,"taskQueue");A(this,"processing",!1);A(this,"keepalive",!1);t=t||oo;const e=t.rpcAddr||oo.rpcAddr;this.key=t.key||Uu(),this.metadata=t.metadata||{},this.status="deactivated",this.attachmentMap=new Map,this.apiKey=t.apiKey||"",this.authTokenInjector=t.authTokenInjector,this.conditions={SyncLoop:!1,WatchLoop:!1},this.syncLoopDuration=t.syncLoopDuration??oo.syncLoopDuration,this.reconnectStreamDelay=t.reconnectStreamDelay??oo.reconnectStreamDelay,this.retrySyncLoopDelay=t.retrySyncLoopDelay??oo.retrySyncLoopDelay;const{authInterceptor:n,setToken:r}=Uh(this.apiKey);this.setAuthToken=r,this.rpcClient=Gc(bf,vf({baseUrl:e,interceptors:[n,zh(t==null?void 0:t.userAgent)],fetch:(o,s)=>{const c={...s,keepalive:this.keepalive};return fetch(o,c)}})),this.taskQueue=[]}async activate(){if(this.isActive())return Promise.resolve();if(this.authTokenInjector){const t=await this.authTokenInjector();this.setAuthToken(t)}return this.enqueueTask(async()=>{try{const t=await this.rpcClient.activateClient({clientKey:this.key,metadata:this.metadata},{headers:{"x-shard-key":this.apiKey}});this.id=t.clientId,this.status="activated",this.runSyncLoop(),Se.info(`[AC] c:"${this.getKey()}" activated, id:"${this.id}"`),typeof window<"u"&&window.addEventListener("beforeunload",async()=>{await this.deactivate({keepalive:!0})})}catch(t){throw Se.error(`[AC] c:"${this.getKey()}" err :`,t),await this.handleConnectError(t),t}})}deactivate(t={keepalive:!1}){if(this.status==="deactivated")return Promise.resolve();const e=async()=>{try{await this.rpcClient.deactivateClient({clientId:this.id},{headers:{"x-shard-key":this.apiKey}}),this.deactivateInternal(),Se.info(`[DC] c"${this.getKey()}" deactivated`)}catch(n){throw Se.error(`[DC] c:"${this.getKey()}" err :`,n),await this.handleConnectError(n),n}};if(t.keepalive){this.keepalive=!0;const n=e();return this.keepalive=!1,n}return this.enqueueTask(e)}hasDocument(t){return this.attachmentMap.has(t)}attach(t,e={}){if(!this.isActive())throw new Z(W.ErrClientNotActivated,`${this.key} is not active`);if(t.getStatus()!==ti.Detached)throw new Z(W.ErrDocumentNotDetached,`${t.getKey()} is not detached`);t.setActor(this.id),t.update((o,s)=>s.set(e.initialPresence||{}));const n=t.subscribe("local-broadcast",async o=>{var m;const{topic:s,payload:c}=o.value,u=(m=o.options)==null?void 0:m.error,d=o.options;try{await this.broadcast(t.getKey(),s,c,d)}catch(h){h instanceof Error&&(u==null||u(h))}}),r=e.syncMode??"realtime";return this.enqueueTask(async()=>{try{const o=await this.rpcClient.attachDocument({clientId:this.id,changePack:ot.toChangePack(t.createChangePack())},{headers:{"x-shard-key":`${this.apiKey}/${t.getKey()}`}}),s=ot.fromChangePack(o.changePack);if(t.applyChangePack(s),t.getStatus()===ti.Removed)return t;t.applyStatus(ti.Attached),this.attachmentMap.set(t.getKey(),new xh(this.reconnectStreamDelay,t,o.documentId,r,n)),r!=="manual"&&await this.runWatchLoop(t.getKey()),Se.info(`[AD] c:"${this.getKey()}" attaches d:"${t.getKey()}"`);const c=t.getRootObject();if(e.initialRoot){const u=e.initialRoot;t.update(d=>{for(const[m,h]of Object.entries(u))if(!c.has(m)){const l=m;d[l]=h}})}return t}catch(o){throw Se.error(`[AD] c:"${this.getKey()}" err :`,o),await this.handleConnectError(o),o}})}detach(t,e={keepalive:!1}){if(!this.isActive())throw new Z(W.ErrClientNotActivated,`${this.key} is not active`);const n=this.attachmentMap.get(t.getKey());if(!n)throw new Z(W.ErrDocumentNotAttached,`${t.getKey()} is not attached`);t.update((o,s)=>s.clear());const r=async()=>{try{const o=await this.rpcClient.detachDocument({clientId:this.id,documentId:n.docID,changePack:ot.toChangePack(t.createChangePack()),removeIfNotAttached:e.removeIfNotAttached??!1},{headers:{"x-shard-key":`${this.apiKey}/${t.getKey()}`}}),s=ot.fromChangePack(o.changePack);return t.applyChangePack(s),t.getStatus()!==ti.Removed&&t.applyStatus(ti.Detached),this.detachInternal(t.getKey()),Se.info(`[DD] c:"${this.getKey()}" detaches d:"${t.getKey()}"`),t}catch(o){throw Se.error(`[DD] c:"${this.getKey()}" err :`,o),await this.handleConnectError(o),o}};if(e.keepalive){this.keepalive=!0;const o=r();return this.keepalive=!1,o}return this.enqueueTask(r)}async changeSyncMode(t,e){if(!this.isActive())throw new Z(W.ErrClientNotActivated,`${this.key} is not active`);const n=this.attachmentMap.get(t.getKey());if(!n)throw new Z(W.ErrDocumentNotAttached,`${t.getKey()} is not attached`);const r=n.syncMode;return r===e?t:(n.changeSyncMode(e),e==="manual"?(n.cancelWatchStream(),t):(e==="realtime"&&(n.remoteChangeEventReceived=!0),r==="manual"&&await this.runWatchLoop(t.getKey()),t))}sync(t){if(!this.isActive())throw new Z(W.ErrClientNotActivated,`${this.key} is not active`);if(t){const e=this.attachmentMap.get(t.getKey());if(!e)throw new Z(W.ErrDocumentNotAttached,`${t.getKey()} is not attached`);return this.enqueueTask(async()=>this.syncInternal(e,"realtime").catch(async n=>{throw Se.error(`[SY] c:"${this.getKey()}" err :`,n),await this.handleConnectError(n),n}))}return this.enqueueTask(async()=>{const e=[];for(const[,n]of this.attachmentMap)e.push(this.syncInternal(n,n.syncMode));return Promise.all(e).catch(async n=>{throw Se.error(`[SY] c:"${this.getKey()}" err :`,n),await this.handleConnectError(n),n})})}remove(t){if(!this.isActive())throw new Z(W.ErrClientNotActivated,`${this.key} is not active`);const e=this.attachmentMap.get(t.getKey());if(!e)throw new Z(W.ErrDocumentNotAttached,`${t.getKey()} is not attached`);t.setActor(this.id);const n=ot.toChangePack(t.createChangePack());return n.isRemoved=!0,this.enqueueTask(async()=>{try{const r=await this.rpcClient.removeDocument({clientId:this.id,documentId:e.docID,changePack:n},{headers:{"x-shard-key":`${this.apiKey}/${t.getKey()}`}}),o=ot.fromChangePack(r.changePack);t.applyChangePack(o),this.detachInternal(t.getKey()),Se.info(`[RD] c:"${this.getKey()}" removes d:"${t.getKey()}"`)}catch(r){throw Se.error(`[RD] c:"${this.getKey()}" err :`,r),await this.handleConnectError(r),r}})}getID(){return this.id}getKey(){return this.key}isActive(){return this.status==="activated"}getStatus(){return this.status}getCondition(t){return this.conditions[t]}broadcast(t,e,n,r){if(!this.isActive())throw new Z(W.ErrClientNotActivated,`${this.key} is not active`);const o=this.attachmentMap.get(t);if(!o)throw new Z(W.ErrDocumentNotAttached,`${t} is not attached`);if(!Vh(n))throw new Z(W.ErrInvalidArgument,"payload is not serializable");const s=(r==null?void 0:r.maxRetries)??$s.maxRetries,c=$s.maxBackoff;let u=0;const d=h=>Math.min($s.initialRetryInterval*2**h,c),m=async()=>this.enqueueTask(async()=>{try{await this.rpcClient.broadcast({clientId:this.id,documentId:o.docID,topic:e,payload:new TextEncoder().encode(JSON.stringify(n))},{headers:{"x-shard-key":`${this.apiKey}/${t}`}}),Se.info(`[BC] c:"${this.getKey()}" broadcasts d:"${t}" t:"${e}"`)}catch(h){if(Se.error(`[BC] c:"${this.getKey()}" err:`,h),await this.handleConnectError(h))if(h instanceof We&&Qr(h)===W.ErrUnauthenticated&&o.doc.publish([{type:lt.AuthError,value:{reason:so(h).reason,method:"Broadcast"}}]),u<s)u++,setTimeout(()=>m(),d(u-1)),Se.info(`[BC] c:"${this.getKey()}" retry attempt ${u}/${s}`);else throw Se.error(`[BC] c:"${this.getKey()}" exceeded maximum retry attempts`),h;else throw h}});return m()}runSyncLoop(){const t=()=>{if(!this.isActive()){Se.debug(`[SL] c:"${this.getKey()}" exit sync loop`),this.conditions.SyncLoop=!1;return}const e=[];for(const[,n]of this.attachmentMap)n.needRealtimeSync()&&(n.remoteChangeEventReceived=!1,e.push(this.syncInternal(n,n.syncMode).catch(async r=>{throw r instanceof We&&Qr(r)===W.ErrUnauthenticated&&n.doc.publish([{type:lt.AuthError,value:{reason:so(r).reason,method:"PushPull"}}]),r})));Promise.all(e).then(()=>setTimeout(t,this.syncLoopDuration)).catch(async n=>{Se.error(`[SL] c:"${this.getKey()}" sync failed:`,n),await this.handleConnectError(n)?setTimeout(t,this.retrySyncLoopDelay):this.conditions.SyncLoop=!1})};Se.debug(`[SL] c:"${this.getKey()}" run sync loop`),this.conditions.SyncLoop=!0,t()}async runWatchLoop(t){const e=this.attachmentMap.get(t);if(!e)throw new Z(W.ErrDocumentNotAttached,`${t} is not attached`);return this.conditions.WatchLoop=!0,e.runWatchLoop(n=>{if(!this.isActive())return this.conditions.WatchLoop=!1,Promise.reject(new Z(W.ErrClientNotActivated,`${this.key} is not active`));const r=new AbortController,o=this.rpcClient.watchDocument({clientId:this.id,documentId:e.docID},{headers:{"x-shard-key":`${this.apiKey}/${t}`},signal:r.signal});return e.doc.publish([{type:lt.ConnectionChanged,value:Eo.Connected}]),Se.info(`[WD] c:"${this.getKey()}" watches d:"${t}"`),new Promise((s,c)=>{(async()=>{try{for await(const d of o)this.handleWatchDocumentsResponse(e,d),d.body.case==="initialization"&&s([o,r])}catch(d){e.doc.resetOnlineClients(),e.doc.publish([{type:lt.Initialized,source:Ge.Local,value:e.doc.getPresences()}]),e.doc.publish([{type:lt.ConnectionChanged,value:Eo.Disconnected}]),Se.debug(`[WD] c:"${this.getKey()}" unwatches`),await this.handleConnectError(d)?(d instanceof We&&Qr(d)===W.ErrUnauthenticated&&e.doc.publish([{type:lt.AuthError,value:{reason:so(d).reason,method:"WatchDocuments"}}]),n()):this.conditions.WatchLoop=!1,c(d)}})()})})}handleWatchDocumentsResponse(t,e){if(e.body.case==="event"&&e.body.value.type===Ei.DOCUMENT_CHANGED){t.remoteChangeEventReceived=!0;return}t.doc.applyWatchStream(e)}deactivateInternal(){this.status="deactivated";for(const[t,e]of this.attachmentMap)this.detachInternal(t),e.doc.applyStatus(ti.Detached)}detachInternal(t){const e=this.attachmentMap.get(t);e&&(e.cancelWatchStream(),e.unsubscribeBroadcastEvent(),this.attachmentMap.delete(t))}async syncInternal(t,e){const{doc:n,docID:r}=t,o=n.createChangePack();try{const s=await this.rpcClient.pushPullChanges({clientId:this.id,documentId:r,changePack:ot.toChangePack(o),pushOnly:e==="realtime-pushonly"},{headers:{"x-shard-key":`${this.apiKey}/${n.getKey()}`}}),c=ot.fromChangePack(s.changePack);if(c.hasChanges()&&(t.syncMode==="realtime-pushonly"||t.syncMode==="realtime-syncoff"))return n;n.applyChangePack(c),t.doc.publish([{type:lt.SyncStatusChanged,value:wa.Synced}]),n.getStatus()===ti.Removed&&this.detachInternal(n.getKey());const u=n.getKey(),d=c.getChangeSize();return Se.info(`[PP] c:"${this.getKey()}" sync d:"${u}", push:${o.getChangeSize()} pull:${d} cp:${c.getCheckpoint().toTestString()}`),n}catch(s){throw n.publish([{type:lt.SyncStatusChanged,value:wa.SyncFailed}]),Se.error(`[PP] c:"${this.getKey()}" err :`,s),s}}async handleConnectError(t){if(!(t instanceof We))return!1;if(t.code===Be.Canceled||t.code===Be.Unknown||t.code===Be.ResourceExhausted||t.code===Be.Unavailable)return!0;if(Qr(t)===W.ErrUnauthenticated){if(this.authTokenInjector){const e=await this.authTokenInjector(so(t).reason);this.setAuthToken(e)}return!0}return Qr(t)===W.ErrTooManySubscribers?(Se.error(`[WD] c:"${this.getKey()}" err :`,t.rawMessage),!0):(Qr(t)===W.ErrTooManyAttachments||(Qr(t)===W.ErrClientNotActivated||Qr(t)===W.ErrClientNotFound)&&this.deactivateInternal(),!1)}enqueueTask(t){return new Promise((e,n)=>{this.taskQueue.push(()=>t().then(e).catch(n)),this.processing||this.processNext()})}async processNext(){if(this.taskQueue.length===0){this.processing=!1;return}try{this.processing=!0,await this.taskQueue.shift()()}catch{Se.error(`[TQ] c:"${this.getKey()}" process failed, id:"${this.id}"`)}this.processNext()}}const zs={Client:Vu,Document:zu,Text:_s,IntType:Dn.Int,LongType:Dn.Long};typeof globalThis<"u"&&(globalThis.yorkie={Client:Vu,Document:zu,Primitive:nt,Text:_s,Counter:ja,Tree:Ja,LogLevel:bt,setLogLevel:Eh,IntType:Dn.Int,LongType:Dn.Long});var Kh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ku(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Hu={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */(function(i,t){(function(n,r){i.exports=r()})(typeof self<"u"?self:Kh,function(){return function(e){var n={};function r(o){if(n[o])return n[o].exports;var s=n[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=n,r.d=function(o,s,c){r.o(o,s)||Object.defineProperty(o,s,{configurable:!1,enumerable:!0,get:c})},r.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return r.d(s,"a",s),s},r.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},r.p="",r(r.s=109)}([function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=r(17),s=r(18),c=r(19),u=r(45),d=r(46),m=r(47),h=r(48),l=r(49),a=r(12),v=r(32),b=r(33),w=r(31),y=r(1),p={Scope:y.Scope,create:y.create,find:y.find,query:y.query,register:y.register,Container:o.default,Format:s.default,Leaf:c.default,Embed:h.default,Scroll:u.default,Block:m.default,Inline:d.default,Text:l.default,Attributor:{Attribute:a.default,Class:v.default,Style:b.default,Store:w.default}};n.default=p},function(e,n,r){var o=this&&this.__extends||function(){var w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,p){y.__proto__=p}||function(y,p){for(var g in p)p.hasOwnProperty(g)&&(y[g]=p[g])};return function(y,p){w(y,p);function g(){this.constructor=y}y.prototype=p===null?Object.create(p):(g.prototype=p.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=function(w){o(y,w);function y(p){var g=this;return p="[Parchment] "+p,g=w.call(this,p)||this,g.message=p,g.name=g.constructor.name,g}return y}(Error);n.ParchmentError=s;var c={},u={},d={},m={};n.DATA_KEY="__blot";var h;(function(w){w[w.TYPE=3]="TYPE",w[w.LEVEL=12]="LEVEL",w[w.ATTRIBUTE=13]="ATTRIBUTE",w[w.BLOT=14]="BLOT",w[w.INLINE=7]="INLINE",w[w.BLOCK=11]="BLOCK",w[w.BLOCK_BLOT=10]="BLOCK_BLOT",w[w.INLINE_BLOT=6]="INLINE_BLOT",w[w.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",w[w.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",w[w.ANY=15]="ANY"})(h=n.Scope||(n.Scope={}));function l(w,y){var p=v(w);if(p==null)throw new s("Unable to create "+w+" blot");var g=p,f=w instanceof Node||w.nodeType===Node.TEXT_NODE?w:g.create(y);return new g(f,y)}n.create=l;function a(w,y){return y===void 0&&(y=!1),w==null?null:w[n.DATA_KEY]!=null?w[n.DATA_KEY].blot:y?a(w.parentNode,y):null}n.find=a;function v(w,y){y===void 0&&(y=h.ANY);var p;if(typeof w=="string")p=m[w]||c[w];else if(w instanceof Text||w.nodeType===Node.TEXT_NODE)p=m.text;else if(typeof w=="number")w&h.LEVEL&h.BLOCK?p=m.block:w&h.LEVEL&h.INLINE&&(p=m.inline);else if(w instanceof HTMLElement){var g=(w.getAttribute("class")||"").split(/\s+/);for(var f in g)if(p=u[g[f]],p)break;p=p||d[w.tagName]}return p==null?null:y&h.LEVEL&p.scope&&y&h.TYPE&p.scope?p:null}n.query=v;function b(){for(var w=[],y=0;y<arguments.length;y++)w[y]=arguments[y];if(w.length>1)return w.map(function(f){return b(f)});var p=w[0];if(typeof p.blotName!="string"&&typeof p.attrName!="string")throw new s("Invalid definition");if(p.blotName==="abstract")throw new s("Cannot register abstract class");if(m[p.blotName||p.attrName]=p,typeof p.keyName=="string")c[p.keyName]=p;else if(p.className!=null&&(u[p.className]=p),p.tagName!=null){Array.isArray(p.tagName)?p.tagName=p.tagName.map(function(f){return f.toUpperCase()}):p.tagName=p.tagName.toUpperCase();var g=Array.isArray(p.tagName)?p.tagName:[p.tagName];g.forEach(function(f){(d[f]==null||p.className==null)&&(d[f]=p)})}return p}n.register=b},function(e,n,r){var o=r(51),s=r(11),c=r(3),u=r(20),d="\0",m=function(h){Array.isArray(h)?this.ops=h:h!=null&&Array.isArray(h.ops)?this.ops=h.ops:this.ops=[]};m.prototype.insert=function(h,l){var a={};return h.length===0?this:(a.insert=h,l!=null&&typeof l=="object"&&Object.keys(l).length>0&&(a.attributes=l),this.push(a))},m.prototype.delete=function(h){return h<=0?this:this.push({delete:h})},m.prototype.retain=function(h,l){if(h<=0)return this;var a={retain:h};return l!=null&&typeof l=="object"&&Object.keys(l).length>0&&(a.attributes=l),this.push(a)},m.prototype.push=function(h){var l=this.ops.length,a=this.ops[l-1];if(h=c(!0,{},h),typeof a=="object"){if(typeof h.delete=="number"&&typeof a.delete=="number")return this.ops[l-1]={delete:a.delete+h.delete},this;if(typeof a.delete=="number"&&h.insert!=null&&(l-=1,a=this.ops[l-1],typeof a!="object"))return this.ops.unshift(h),this;if(s(h.attributes,a.attributes)){if(typeof h.insert=="string"&&typeof a.insert=="string")return this.ops[l-1]={insert:a.insert+h.insert},typeof h.attributes=="object"&&(this.ops[l-1].attributes=h.attributes),this;if(typeof h.retain=="number"&&typeof a.retain=="number")return this.ops[l-1]={retain:a.retain+h.retain},typeof h.attributes=="object"&&(this.ops[l-1].attributes=h.attributes),this}}return l===this.ops.length?this.ops.push(h):this.ops.splice(l,0,h),this},m.prototype.chop=function(){var h=this.ops[this.ops.length-1];return h&&h.retain&&!h.attributes&&this.ops.pop(),this},m.prototype.filter=function(h){return this.ops.filter(h)},m.prototype.forEach=function(h){this.ops.forEach(h)},m.prototype.map=function(h){return this.ops.map(h)},m.prototype.partition=function(h){var l=[],a=[];return this.forEach(function(v){var b=h(v)?l:a;b.push(v)}),[l,a]},m.prototype.reduce=function(h,l){return this.ops.reduce(h,l)},m.prototype.changeLength=function(){return this.reduce(function(h,l){return l.insert?h+u.length(l):l.delete?h-l.delete:h},0)},m.prototype.length=function(){return this.reduce(function(h,l){return h+u.length(l)},0)},m.prototype.slice=function(h,l){h=h||0,typeof l!="number"&&(l=1/0);for(var a=[],v=u.iterator(this.ops),b=0;b<l&&v.hasNext();){var w;b<h?w=v.next(h-b):(w=v.next(l-b),a.push(w)),b+=u.length(w)}return new m(a)},m.prototype.compose=function(h){var l=u.iterator(this.ops),a=u.iterator(h.ops),v=[],b=a.peek();if(b!=null&&typeof b.retain=="number"&&b.attributes==null){for(var w=b.retain;l.peekType()==="insert"&&l.peekLength()<=w;)w-=l.peekLength(),v.push(l.next());b.retain-w>0&&a.next(b.retain-w)}for(var y=new m(v);l.hasNext()||a.hasNext();)if(a.peekType()==="insert")y.push(a.next());else if(l.peekType()==="delete")y.push(l.next());else{var p=Math.min(l.peekLength(),a.peekLength()),g=l.next(p),f=a.next(p);if(typeof f.retain=="number"){var T={};typeof g.retain=="number"?T.retain=p:T.insert=g.insert;var S=u.attributes.compose(g.attributes,f.attributes,typeof g.retain=="number");if(S&&(T.attributes=S),y.push(T),!a.hasNext()&&s(y.ops[y.ops.length-1],T)){var E=new m(l.rest());return y.concat(E).chop()}}else typeof f.delete=="number"&&typeof g.retain=="number"&&y.push(f)}return y.chop()},m.prototype.concat=function(h){var l=new m(this.ops.slice());return h.ops.length>0&&(l.push(h.ops[0]),l.ops=l.ops.concat(h.ops.slice(1))),l},m.prototype.diff=function(h,l){if(this.ops===h.ops)return new m;var a=[this,h].map(function(p){return p.map(function(g){if(g.insert!=null)return typeof g.insert=="string"?g.insert:d;var f=p===h?"on":"with";throw new Error("diff() called "+f+" non-document")}).join("")}),v=new m,b=o(a[0],a[1],l),w=u.iterator(this.ops),y=u.iterator(h.ops);return b.forEach(function(p){for(var g=p[1].length;g>0;){var f=0;switch(p[0]){case o.INSERT:f=Math.min(y.peekLength(),g),v.push(y.next(f));break;case o.DELETE:f=Math.min(g,w.peekLength()),w.next(f),v.delete(f);break;case o.EQUAL:f=Math.min(w.peekLength(),y.peekLength(),g);var T=w.next(f),S=y.next(f);s(T.insert,S.insert)?v.retain(f,u.attributes.diff(T.attributes,S.attributes)):v.push(S).delete(f);break}g-=f}}),v.chop()},m.prototype.eachLine=function(h,l){l=l||`
`;for(var a=u.iterator(this.ops),v=new m,b=0;a.hasNext();){if(a.peekType()!=="insert")return;var w=a.peek(),y=u.length(w)-a.peekLength(),p=typeof w.insert=="string"?w.insert.indexOf(l,y)-y:-1;if(p<0)v.push(a.next());else if(p>0)v.push(a.next(p));else{if(h(v,a.next(1).attributes||{},b)===!1)return;b+=1,v=new m}}v.length()>0&&h(v,{},b)},m.prototype.transform=function(h,l){if(l=!!l,typeof h=="number")return this.transformPosition(h,l);for(var a=u.iterator(this.ops),v=u.iterator(h.ops),b=new m;a.hasNext()||v.hasNext();)if(a.peekType()==="insert"&&(l||v.peekType()!=="insert"))b.retain(u.length(a.next()));else if(v.peekType()==="insert")b.push(v.next());else{var w=Math.min(a.peekLength(),v.peekLength()),y=a.next(w),p=v.next(w);if(y.delete)continue;p.delete?b.push(p):b.retain(w,u.attributes.transform(y.attributes,p.attributes,l))}return b.chop()},m.prototype.transformPosition=function(h,l){l=!!l;for(var a=u.iterator(this.ops),v=0;a.hasNext()&&v<=h;){var b=a.peekLength(),w=a.peekType();if(a.next(),w==="delete"){h-=Math.min(b,h-v);continue}else w==="insert"&&(v<h||!l)&&(h+=b);v+=b}return h},e.exports=m},function(e,n){var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,s=Object.defineProperty,c=Object.getOwnPropertyDescriptor,u=function(a){return typeof Array.isArray=="function"?Array.isArray(a):o.call(a)==="[object Array]"},d=function(a){if(!a||o.call(a)!=="[object Object]")return!1;var v=r.call(a,"constructor"),b=a.constructor&&a.constructor.prototype&&r.call(a.constructor.prototype,"isPrototypeOf");if(a.constructor&&!v&&!b)return!1;var w;for(w in a);return typeof w>"u"||r.call(a,w)},m=function(a,v){s&&v.name==="__proto__"?s(a,v.name,{enumerable:!0,configurable:!0,value:v.newValue,writable:!0}):a[v.name]=v.newValue},h=function(a,v){if(v==="__proto__")if(r.call(a,v)){if(c)return c(a,v).value}else return;return a[v]};e.exports=function l(){var a,v,b,w,y,p,g=arguments[0],f=1,T=arguments.length,S=!1;for(typeof g=="boolean"&&(S=g,g=arguments[1]||{},f=2),(g==null||typeof g!="object"&&typeof g!="function")&&(g={});f<T;++f)if(a=arguments[f],a!=null)for(v in a)b=h(g,v),w=h(a,v),g!==w&&(S&&w&&(d(w)||(y=u(w)))?(y?(y=!1,p=b&&u(b)?b:[]):p=b&&d(b)?b:{},m(g,{name:v,newValue:l(S,p,w)})):typeof w<"u"&&m(g,{name:v,newValue:w}));return g}},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BlockEmbed=n.bubbleFormats=void 0;var o=function(){function x(I,N){for(var _=0;_<N.length;_++){var R=N[_];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(I,R.key,R)}}return function(I,N,_){return N&&x(I.prototype,N),_&&x(I,_),I}}(),s=function x(I,N,_){I===null&&(I=Function.prototype);var R=Object.getOwnPropertyDescriptor(I,N);if(R===void 0){var M=Object.getPrototypeOf(I);return M===null?void 0:x(M,N,_)}else{if("value"in R)return R.value;var F=R.get;return F===void 0?void 0:F.call(_)}},c=r(3),u=g(c),d=r(2),m=g(d),h=r(0),l=g(h),a=r(16),v=g(a),b=r(6),w=g(b),y=r(7),p=g(y);function g(x){return x&&x.__esModule?x:{default:x}}function f(x,I){if(!(x instanceof I))throw new TypeError("Cannot call a class as a function")}function T(x,I){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:x}function S(x,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);x.prototype=Object.create(I&&I.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(x,I):x.__proto__=I)}var E=1,k=function(x){S(I,x);function I(){return f(this,I),T(this,(I.__proto__||Object.getPrototypeOf(I)).apply(this,arguments))}return o(I,[{key:"attach",value:function(){s(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"attach",this).call(this),this.attributes=new l.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new m.default().insert(this.value(),(0,u.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(_,R){var M=l.default.query(_,l.default.Scope.BLOCK_ATTRIBUTE);M!=null&&this.attributes.attribute(M,R)}},{key:"formatAt",value:function(_,R,M,F){this.format(M,F)}},{key:"insertAt",value:function(_,R,M){if(typeof R=="string"&&R.endsWith(`
`)){var F=l.default.create(P.blotName);this.parent.insertBefore(F,_===0?this:this.next),F.insertAt(0,R.slice(0,-1))}else s(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"insertAt",this).call(this,_,R,M)}}]),I}(l.default.Embed);k.scope=l.default.Scope.BLOCK_BLOT;var P=function(x){S(I,x);function I(N){f(this,I);var _=T(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,N));return _.cache={},_}return o(I,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(l.default.Leaf).reduce(function(_,R){return R.length()===0?_:_.insert(R.value(),O(R))},new m.default).insert(`
`,O(this))),this.cache.delta}},{key:"deleteAt",value:function(_,R){s(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"deleteAt",this).call(this,_,R),this.cache={}}},{key:"formatAt",value:function(_,R,M,F){R<=0||(l.default.query(M,l.default.Scope.BLOCK)?_+R===this.length()&&this.format(M,F):s(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"formatAt",this).call(this,_,Math.min(R,this.length()-_-1),M,F),this.cache={})}},{key:"insertAt",value:function(_,R,M){if(M!=null)return s(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"insertAt",this).call(this,_,R,M);if(R.length!==0){var F=R.split(`
`),Y=F.shift();Y.length>0&&(_<this.length()-1||this.children.tail==null?s(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"insertAt",this).call(this,Math.min(_,this.length()-1),Y):this.children.tail.insertAt(this.children.tail.length(),Y),this.cache={});var J=this;F.reduce(function(j,C){return J=J.split(j,!0),J.insertAt(0,C),C.length},_+Y.length)}}},{key:"insertBefore",value:function(_,R){var M=this.children.head;s(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"insertBefore",this).call(this,_,R),M instanceof v.default&&M.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=s(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"length",this).call(this)+E),this.cache.length}},{key:"moveChildren",value:function(_,R){s(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"moveChildren",this).call(this,_,R),this.cache={}}},{key:"optimize",value:function(_){s(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"optimize",this).call(this,_),this.cache={}}},{key:"path",value:function(_){return s(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"path",this).call(this,_,!0)}},{key:"removeChild",value:function(_){s(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"removeChild",this).call(this,_),this.cache={}}},{key:"split",value:function(_){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(R&&(_===0||_>=this.length()-E)){var M=this.clone();return _===0?(this.parent.insertBefore(M,this),this):(this.parent.insertBefore(M,this.next),M)}else{var F=s(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"split",this).call(this,_,R);return this.cache={},F}}}]),I}(l.default.Block);P.blotName="block",P.tagName="P",P.defaultChild="break",P.allowedChildren=[w.default,l.default.Embed,p.default];function O(x){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return x==null||(typeof x.formats=="function"&&(I=(0,u.default)(I,x.formats())),x.parent==null||x.parent.blotName=="scroll"||x.parent.statics.scope!==x.statics.scope)?I:O(x.parent,I)}n.bubbleFormats=O,n.BlockEmbed=k,n.default=P},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(J){return typeof J}:function(J){return J&&typeof Symbol=="function"&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},s=function(){function J(j,C){var q=[],B=!0,K=!1,z=void 0;try{for(var D=j[Symbol.iterator](),U;!(B=(U=D.next()).done)&&(q.push(U.value),!(C&&q.length===C));B=!0);}catch(V){K=!0,z=V}finally{try{!B&&D.return&&D.return()}finally{if(K)throw z}}return q}return function(j,C){if(Array.isArray(j))return j;if(Symbol.iterator in Object(j))return J(j,C);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function J(j,C){for(var q=0;q<C.length;q++){var B=C[q];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}return function(j,C,q){return C&&J(j.prototype,C),q&&J(j,q),j}}();r(50);var u=r(2),d=O(u),m=r(14),h=O(m),l=r(8),a=O(l),v=r(9),b=O(v),w=r(0),y=O(w),p=r(15),g=O(p),f=r(3),T=O(f),S=r(10),E=O(S),k=r(34),P=O(k);function O(J){return J&&J.__esModule?J:{default:J}}function x(J,j,C){return j in J?Object.defineProperty(J,j,{value:C,enumerable:!0,configurable:!0,writable:!0}):J[j]=C,J}function I(J,j){if(!(J instanceof j))throw new TypeError("Cannot call a class as a function")}var N=(0,E.default)("quill"),_=function(){c(J,null,[{key:"debug",value:function(C){C===!0&&(C="log"),E.default.level(C)}},{key:"find",value:function(C){return C.__quill||y.default.find(C)}},{key:"import",value:function(C){return this.imports[C]==null&&N.error("Cannot import "+C+". Are you sure it was registered?"),this.imports[C]}},{key:"register",value:function(C,q){var B=this,K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof C!="string"){var z=C.attrName||C.blotName;typeof z=="string"?this.register("formats/"+z,C,q):Object.keys(C).forEach(function(D){B.register(D,C[D],q)})}else this.imports[C]!=null&&!K&&N.warn("Overwriting "+C+" with",q),this.imports[C]=q,(C.startsWith("blots/")||C.startsWith("formats/"))&&q.blotName!=="abstract"?y.default.register(q):C.startsWith("modules")&&typeof q.register=="function"&&q.register()}}]);function J(j){var C=this,q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(I(this,J),this.options=R(j,q),this.container=this.options.container,this.container==null)return N.error("Invalid Quill container",j);this.options.debug&&J.debug(this.options.debug);var B=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new a.default,this.scroll=y.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new h.default(this.scroll),this.selection=new g.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(a.default.events.EDITOR_CHANGE,function(z){z===a.default.events.TEXT_CHANGE&&C.root.classList.toggle("ql-blank",C.editor.isBlank())}),this.emitter.on(a.default.events.SCROLL_UPDATE,function(z,D){var U=C.selection.lastRange,V=U&&U.length===0?U.index:void 0;M.call(C,function(){return C.editor.update(null,D,V)},z)});var K=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+B+"<p><br></p></div>");this.setContents(K),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return c(J,[{key:"addContainer",value:function(C){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof C=="string"){var B=C;C=document.createElement("div"),C.classList.add(B)}return this.container.insertBefore(C,q),C}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(C,q,B){var K=this,z=F(C,q,B),D=s(z,4);return C=D[0],q=D[1],B=D[3],M.call(this,function(){return K.editor.deleteText(C,q)},B,C,-1*q)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(C),this.container.classList.toggle("ql-disabled",!C)}},{key:"focus",value:function(){var C=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=C,this.scrollIntoView()}},{key:"format",value:function(C,q){var B=this,K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a.default.sources.API;return M.call(this,function(){var z=B.getSelection(!0),D=new d.default;if(z==null)return D;if(y.default.query(C,y.default.Scope.BLOCK))D=B.editor.formatLine(z.index,z.length,x({},C,q));else{if(z.length===0)return B.selection.format(C,q),D;D=B.editor.formatText(z.index,z.length,x({},C,q))}return B.setSelection(z,a.default.sources.SILENT),D},K)}},{key:"formatLine",value:function(C,q,B,K,z){var D=this,U=void 0,V=F(C,q,B,K,z),G=s(V,4);return C=G[0],q=G[1],U=G[2],z=G[3],M.call(this,function(){return D.editor.formatLine(C,q,U)},z,C,0)}},{key:"formatText",value:function(C,q,B,K,z){var D=this,U=void 0,V=F(C,q,B,K,z),G=s(V,4);return C=G[0],q=G[1],U=G[2],z=G[3],M.call(this,function(){return D.editor.formatText(C,q,U)},z,C,0)}},{key:"getBounds",value:function(C){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,B=void 0;typeof C=="number"?B=this.selection.getBounds(C,q):B=this.selection.getBounds(C.index,C.length);var K=this.container.getBoundingClientRect();return{bottom:B.bottom-K.top,height:B.height,left:B.left-K.left,right:B.right-K.left,top:B.top-K.top,width:B.width}}},{key:"getContents",value:function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-C,B=F(C,q),K=s(B,2);return C=K[0],q=K[1],this.editor.getContents(C,q)}},{key:"getFormat",value:function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof C=="number"?this.editor.getFormat(C,q):this.editor.getFormat(C.index,C.length)}},{key:"getIndex",value:function(C){return C.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(C){return this.scroll.leaf(C)}},{key:"getLine",value:function(C){return this.scroll.line(C)}},{key:"getLines",value:function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof C!="number"?this.scroll.lines(C.index,C.length):this.scroll.lines(C,q)}},{key:"getModule",value:function(C){return this.theme.modules[C]}},{key:"getSelection",value:function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return C&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-C,B=F(C,q),K=s(B,2);return C=K[0],q=K[1],this.editor.getText(C,q)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(C,q,B){var K=this,z=arguments.length>3&&arguments[3]!==void 0?arguments[3]:J.sources.API;return M.call(this,function(){return K.editor.insertEmbed(C,q,B)},z,C)}},{key:"insertText",value:function(C,q,B,K,z){var D=this,U=void 0,V=F(C,0,B,K,z),G=s(V,4);return C=G[0],U=G[2],z=G[3],M.call(this,function(){return D.editor.insertText(C,q,U)},z,C,q.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(C,q,B){this.clipboard.dangerouslyPasteHTML(C,q,B)}},{key:"removeFormat",value:function(C,q,B){var K=this,z=F(C,q,B),D=s(z,4);return C=D[0],q=D[1],B=D[3],M.call(this,function(){return K.editor.removeFormat(C,q)},B,C)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(C){var q=this,B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a.default.sources.API;return M.call(this,function(){C=new d.default(C);var K=q.getLength(),z=q.editor.deleteText(0,K),D=q.editor.applyDelta(C),U=D.ops[D.ops.length-1];U!=null&&typeof U.insert=="string"&&U.insert[U.insert.length-1]===`
`&&(q.editor.deleteText(q.getLength()-1,1),D.delete(1));var V=z.compose(D);return V},B)}},{key:"setSelection",value:function(C,q,B){if(C==null)this.selection.setRange(null,q||J.sources.API);else{var K=F(C,q,B),z=s(K,4);C=z[0],q=z[1],B=z[3],this.selection.setRange(new p.Range(C,q),B),B!==a.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(C){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a.default.sources.API,B=new d.default().insert(C);return this.setContents(B,q)}},{key:"update",value:function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a.default.sources.USER,q=this.scroll.update(C);return this.selection.update(C),q}},{key:"updateContents",value:function(C){var q=this,B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a.default.sources.API;return M.call(this,function(){return C=new d.default(C),q.editor.applyDelta(C,B)},B,!0)}}]),J}();_.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},_.events=a.default.events,_.sources=a.default.sources,_.version="1.3.7",_.imports={delta:d.default,parchment:y.default,"core/module":b.default,"core/theme":P.default};function R(J,j){if(j=(0,T.default)(!0,{container:J,modules:{clipboard:!0,keyboard:!0,history:!0}},j),!j.theme||j.theme===_.DEFAULTS.theme)j.theme=P.default;else if(j.theme=_.import("themes/"+j.theme),j.theme==null)throw new Error("Invalid theme "+j.theme+". Did you register it?");var C=(0,T.default)(!0,{},j.theme.DEFAULTS);[C,j].forEach(function(K){K.modules=K.modules||{},Object.keys(K.modules).forEach(function(z){K.modules[z]===!0&&(K.modules[z]={})})});var q=Object.keys(C.modules).concat(Object.keys(j.modules)),B=q.reduce(function(K,z){var D=_.import("modules/"+z);return D==null?N.error("Cannot load "+z+" module. Are you sure you registered it?"):K[z]=D.DEFAULTS||{},K},{});return j.modules!=null&&j.modules.toolbar&&j.modules.toolbar.constructor!==Object&&(j.modules.toolbar={container:j.modules.toolbar}),j=(0,T.default)(!0,{},_.DEFAULTS,{modules:B},C,j),["bounds","container","scrollingContainer"].forEach(function(K){typeof j[K]=="string"&&(j[K]=document.querySelector(j[K]))}),j.modules=Object.keys(j.modules).reduce(function(K,z){return j.modules[z]&&(K[z]=j.modules[z]),K},{}),j}function M(J,j,C,q){if(this.options.strict&&!this.isEnabled()&&j===a.default.sources.USER)return new d.default;var B=C==null?null:this.getSelection(),K=this.editor.delta,z=J();if(B!=null&&(C===!0&&(C=B.index),q==null?B=Y(B,z,j):q!==0&&(B=Y(B,C,q,j)),this.setSelection(B,a.default.sources.SILENT)),z.length()>0){var D,U=[a.default.events.TEXT_CHANGE,z,K,j];if((D=this.emitter).emit.apply(D,[a.default.events.EDITOR_CHANGE].concat(U)),j!==a.default.sources.SILENT){var V;(V=this.emitter).emit.apply(V,U)}}return z}function F(J,j,C,q,B){var K={};return typeof J.index=="number"&&typeof J.length=="number"?typeof j!="number"?(B=q,q=C,C=j,j=J.length,J=J.index):(j=J.length,J=J.index):typeof j!="number"&&(B=q,q=C,C=j,j=0),(typeof C>"u"?"undefined":o(C))==="object"?(K=C,B=q):typeof C=="string"&&(q!=null?K[C]=q:B=C),B=B||a.default.sources.API,[J,j,K,B]}function Y(J,j,C,q){if(J==null)return null;var B=void 0,K=void 0;if(j instanceof d.default){var z=[J.index,J.index+J.length].map(function(G){return j.transformPosition(G,q!==a.default.sources.USER)}),D=s(z,2);B=D[0],K=D[1]}else{var U=[J.index,J.index+J.length].map(function(G){return G<j||G===j&&q===a.default.sources.USER?G:C>=0?G+C:Math.max(j,G+C)}),V=s(U,2);B=V[0],K=V[1]}return new p.Range(B,K-B)}n.expandConfig=R,n.overload=F,n.default=_},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function w(y,p){for(var g=0;g<p.length;g++){var f=p[g];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}return function(y,p,g){return p&&w(y.prototype,p),g&&w(y,g),y}}(),s=function w(y,p,g){y===null&&(y=Function.prototype);var f=Object.getOwnPropertyDescriptor(y,p);if(f===void 0){var T=Object.getPrototypeOf(y);return T===null?void 0:w(T,p,g)}else{if("value"in f)return f.value;var S=f.get;return S===void 0?void 0:S.call(g)}},c=r(7),u=h(c),d=r(0),m=h(d);function h(w){return w&&w.__esModule?w:{default:w}}function l(w,y){if(!(w instanceof y))throw new TypeError("Cannot call a class as a function")}function a(w,y){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:w}function v(w,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);w.prototype=Object.create(y&&y.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(w,y):w.__proto__=y)}var b=function(w){v(y,w);function y(){return l(this,y),a(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return o(y,[{key:"formatAt",value:function(g,f,T,S){if(y.compare(this.statics.blotName,T)<0&&m.default.query(T,m.default.Scope.BLOT)){var E=this.isolate(g,f);S&&E.wrap(T,S)}else s(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"formatAt",this).call(this,g,f,T,S)}},{key:"optimize",value:function(g){if(s(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"optimize",this).call(this,g),this.parent instanceof y&&y.compare(this.statics.blotName,this.parent.statics.blotName)>0){var f=this.parent.isolate(this.offset(),this.length());this.moveChildren(f),f.wrap(this)}}}],[{key:"compare",value:function(g,f){var T=y.order.indexOf(g),S=y.order.indexOf(f);return T>=0||S>=0?T-S:g===f?0:g<f?-1:1}}]),y}(m.default.Inline);b.allowedChildren=[b,m.default.Embed,u.default],b.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=b},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=r(0),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}function u(l,a){if(!(l instanceof a))throw new TypeError("Cannot call a class as a function")}function d(l,a){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:l}function m(l,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);l.prototype=Object.create(a&&a.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(l,a):l.__proto__=a)}var h=function(l){m(a,l);function a(){return u(this,a),d(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return a}(s.default.Text);n.default=h},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function p(g,f){for(var T=0;T<f.length;T++){var S=f[T];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(g,S.key,S)}}return function(g,f,T){return f&&p(g.prototype,f),T&&p(g,T),g}}(),s=function p(g,f,T){g===null&&(g=Function.prototype);var S=Object.getOwnPropertyDescriptor(g,f);if(S===void 0){var E=Object.getPrototypeOf(g);return E===null?void 0:p(E,f,T)}else{if("value"in S)return S.value;var k=S.get;return k===void 0?void 0:k.call(T)}},c=r(54),u=h(c),d=r(10),m=h(d);function h(p){return p&&p.__esModule?p:{default:p}}function l(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")}function a(p,g){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:p}function v(p,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);p.prototype=Object.create(g&&g.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(p,g):p.__proto__=g)}var b=(0,m.default)("quill:events"),w=["selectionchange","mousedown","mouseup","click"];w.forEach(function(p){document.addEventListener(p,function(){for(var g=arguments.length,f=Array(g),T=0;T<g;T++)f[T]=arguments[T];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(S){if(S.__quill&&S.__quill.emitter){var E;(E=S.__quill.emitter).handleDOM.apply(E,f)}})})});var y=function(p){v(g,p);function g(){l(this,g);var f=a(this,(g.__proto__||Object.getPrototypeOf(g)).call(this));return f.listeners={},f.on("error",b.error),f}return o(g,[{key:"emit",value:function(){b.log.apply(b,arguments),s(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(T){for(var S=arguments.length,E=Array(S>1?S-1:0),k=1;k<S;k++)E[k-1]=arguments[k];(this.listeners[T.type]||[]).forEach(function(P){var O=P.node,x=P.handler;(T.target===O||O.contains(T.target))&&x.apply(void 0,[T].concat(E))})}},{key:"listenDOM",value:function(T,S,E){this.listeners[T]||(this.listeners[T]=[]),this.listeners[T].push({node:S,handler:E})}}]),g}(u.default);y.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},y.sources={API:"api",SILENT:"silent",USER:"user"},n.default=y},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});function o(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}var s=function c(u){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};o(this,c),this.quill=u,this.options=d};s.DEFAULTS={},n.default=s},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=["error","warn","log","info"],s="warn";function c(d){if(o.indexOf(d)<=o.indexOf(s)){for(var m,h=arguments.length,l=Array(h>1?h-1:0),a=1;a<h;a++)l[a-1]=arguments[a];(m=console)[d].apply(m,l)}}function u(d){return o.reduce(function(m,h){return m[h]=c.bind(console,h,d),m},{})}c.level=u.level=function(d){s=d},n.default=u},function(e,n,r){var o=Array.prototype.slice,s=r(52),c=r(53),u=e.exports=function(l,a,v){return v||(v={}),l===a?!0:l instanceof Date&&a instanceof Date?l.getTime()===a.getTime():!l||!a||typeof l!="object"&&typeof a!="object"?v.strict?l===a:l==a:h(l,a,v)};function d(l){return l==null}function m(l){return!(!l||typeof l!="object"||typeof l.length!="number"||typeof l.copy!="function"||typeof l.slice!="function"||l.length>0&&typeof l[0]!="number")}function h(l,a,v){var b,w;if(d(l)||d(a)||l.prototype!==a.prototype)return!1;if(c(l))return c(a)?(l=o.call(l),a=o.call(a),u(l,a,v)):!1;if(m(l)){if(!m(a)||l.length!==a.length)return!1;for(b=0;b<l.length;b++)if(l[b]!==a[b])return!1;return!0}try{var y=s(l),p=s(a)}catch{return!1}if(y.length!=p.length)return!1;for(y.sort(),p.sort(),b=y.length-1;b>=0;b--)if(y[b]!=p[b])return!1;for(b=y.length-1;b>=0;b--)if(w=y[b],!u(l[w],a[w],v))return!1;return typeof l==typeof a}},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=r(1),s=function(){function c(u,d,m){m===void 0&&(m={}),this.attrName=u,this.keyName=d;var h=o.Scope.TYPE&o.Scope.ATTRIBUTE;m.scope!=null?this.scope=m.scope&o.Scope.LEVEL|h:this.scope=o.Scope.ATTRIBUTE,m.whitelist!=null&&(this.whitelist=m.whitelist)}return c.keys=function(u){return[].map.call(u.attributes,function(d){return d.name})},c.prototype.add=function(u,d){return this.canAdd(u,d)?(u.setAttribute(this.keyName,d),!0):!1},c.prototype.canAdd=function(u,d){var m=o.query(u,o.Scope.BLOT&(this.scope|o.Scope.TYPE));return m==null?!1:this.whitelist==null?!0:typeof d=="string"?this.whitelist.indexOf(d.replace(/["']/g,""))>-1:this.whitelist.indexOf(d)>-1},c.prototype.remove=function(u){u.removeAttribute(this.keyName)},c.prototype.value=function(u){var d=u.getAttribute(this.keyName);return this.canAdd(u,d)&&d?d:""},c}();n.default=s},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var o=function(){function k(P,O){var x=[],I=!0,N=!1,_=void 0;try{for(var R=P[Symbol.iterator](),M;!(I=(M=R.next()).done)&&(x.push(M.value),!(O&&x.length===O));I=!0);}catch(F){N=!0,_=F}finally{try{!I&&R.return&&R.return()}finally{if(N)throw _}}return x}return function(P,O){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return k(P,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function k(P,O){for(var x=0;x<O.length;x++){var I=O[x];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(P,I.key,I)}}return function(P,O,x){return O&&k(P.prototype,O),x&&k(P,x),P}}(),c=function k(P,O,x){P===null&&(P=Function.prototype);var I=Object.getOwnPropertyDescriptor(P,O);if(I===void 0){var N=Object.getPrototypeOf(P);return N===null?void 0:k(N,O,x)}else{if("value"in I)return I.value;var _=I.get;return _===void 0?void 0:_.call(x)}},u=r(2),d=p(u),m=r(0),h=p(m),l=r(4),a=p(l),v=r(6),b=p(v),w=r(7),y=p(w);function p(k){return k&&k.__esModule?k:{default:k}}function g(k,P){if(!(k instanceof P))throw new TypeError("Cannot call a class as a function")}function f(k,P){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&(typeof P=="object"||typeof P=="function")?P:k}function T(k,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof P);k.prototype=Object.create(P&&P.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(k,P):k.__proto__=P)}var S=function(k){T(P,k);function P(){return g(this,P),f(this,(P.__proto__||Object.getPrototypeOf(P)).apply(this,arguments))}return P}(b.default);S.blotName="code",S.tagName="CODE";var E=function(k){T(P,k);function P(){return g(this,P),f(this,(P.__proto__||Object.getPrototypeOf(P)).apply(this,arguments))}return s(P,[{key:"delta",value:function(){var x=this,I=this.domNode.textContent;return I.endsWith(`
`)&&(I=I.slice(0,-1)),I.split(`
`).reduce(function(N,_){return N.insert(_).insert(`
`,x.formats())},new d.default)}},{key:"format",value:function(x,I){if(!(x===this.statics.blotName&&I)){var N=this.descendant(y.default,this.length()-1),_=o(N,1),R=_[0];R!=null&&R.deleteAt(R.length()-1,1),c(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"format",this).call(this,x,I)}}},{key:"formatAt",value:function(x,I,N,_){if(I!==0&&!(h.default.query(N,h.default.Scope.BLOCK)==null||N===this.statics.blotName&&_===this.statics.formats(this.domNode))){var R=this.newlineIndex(x);if(!(R<0||R>=x+I)){var M=this.newlineIndex(x,!0)+1,F=R-M+1,Y=this.isolate(M,F),J=Y.next;Y.format(N,_),J instanceof P&&J.formatAt(0,x-M+I-F,N,_)}}}},{key:"insertAt",value:function(x,I,N){if(N==null){var _=this.descendant(y.default,x),R=o(_,2),M=R[0],F=R[1];M.insertAt(F,I)}}},{key:"length",value:function(){var x=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?x:x+1}},{key:"newlineIndex",value:function(x){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(I)return this.domNode.textContent.slice(0,x).lastIndexOf(`
`);var N=this.domNode.textContent.slice(x).indexOf(`
`);return N>-1?x+N:-1}},{key:"optimize",value:function(x){this.domNode.textContent.endsWith(`
`)||this.appendChild(h.default.create("text",`
`)),c(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"optimize",this).call(this,x);var I=this.next;I!=null&&I.prev===this&&I.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===I.statics.formats(I.domNode)&&(I.optimize(x),I.moveChildren(this),I.remove())}},{key:"replace",value:function(x){c(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"replace",this).call(this,x),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(I){var N=h.default.find(I);N==null?I.parentNode.removeChild(I):N instanceof h.default.Embed?N.remove():N.unwrap()})}}],[{key:"create",value:function(x){var I=c(P.__proto__||Object.getPrototypeOf(P),"create",this).call(this,x);return I.setAttribute("spellcheck",!1),I}},{key:"formats",value:function(){return!0}}]),P}(a.default);E.blotName="code-block",E.tagName="PRE",E.TAB="  ",n.Code=S,n.default=E},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(J){return typeof J}:function(J){return J&&typeof Symbol=="function"&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},s=function(){function J(j,C){var q=[],B=!0,K=!1,z=void 0;try{for(var D=j[Symbol.iterator](),U;!(B=(U=D.next()).done)&&(q.push(U.value),!(C&&q.length===C));B=!0);}catch(V){K=!0,z=V}finally{try{!B&&D.return&&D.return()}finally{if(K)throw z}}return q}return function(j,C){if(Array.isArray(j))return j;if(Symbol.iterator in Object(j))return J(j,C);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function J(j,C){for(var q=0;q<C.length;q++){var B=C[q];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}return function(j,C,q){return C&&J(j.prototype,C),q&&J(j,q),j}}(),u=r(2),d=I(u),m=r(20),h=I(m),l=r(0),a=I(l),v=r(13),b=I(v),w=r(24),y=I(w),p=r(4),g=I(p),f=r(16),T=I(f),S=r(21),E=I(S),k=r(11),P=I(k),O=r(3),x=I(O);function I(J){return J&&J.__esModule?J:{default:J}}function N(J,j,C){return j in J?Object.defineProperty(J,j,{value:C,enumerable:!0,configurable:!0,writable:!0}):J[j]=C,J}function _(J,j){if(!(J instanceof j))throw new TypeError("Cannot call a class as a function")}var R=/^[ -~]*$/,M=function(){function J(j){_(this,J),this.scroll=j,this.delta=this.getDelta()}return c(J,[{key:"applyDelta",value:function(C){var q=this,B=!1;this.scroll.update();var K=this.scroll.length();return this.scroll.batchStart(),C=Y(C),C.reduce(function(z,D){var U=D.retain||D.delete||D.insert.length||1,V=D.attributes||{};if(D.insert!=null){if(typeof D.insert=="string"){var G=D.insert;G.endsWith(`
`)&&B&&(B=!1,G=G.slice(0,-1)),z>=K&&!G.endsWith(`
`)&&(B=!0),q.scroll.insertAt(z,G);var re=q.scroll.line(z),oe=s(re,2),ge=oe[0],ve=oe[1],ye=(0,x.default)({},(0,p.bubbleFormats)(ge));if(ge instanceof g.default){var Ne=ge.descendant(a.default.Leaf,ve),Ke=s(Ne,1),$e=Ke[0];ye=(0,x.default)(ye,(0,p.bubbleFormats)($e))}V=h.default.attributes.diff(ye,V)||{}}else if(o(D.insert)==="object"){var X=Object.keys(D.insert)[0];if(X==null)return z;q.scroll.insertAt(z,X,D.insert[X])}K+=U}return Object.keys(V).forEach(function(ee){q.scroll.formatAt(z,U,ee,V[ee])}),z+U},0),C.reduce(function(z,D){return typeof D.delete=="number"?(q.scroll.deleteAt(z,D.delete),z):z+(D.retain||D.insert.length||1)},0),this.scroll.batchEnd(),this.update(C)}},{key:"deleteText",value:function(C,q){return this.scroll.deleteAt(C,q),this.update(new d.default().retain(C).delete(q))}},{key:"formatLine",value:function(C,q){var B=this,K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(K).forEach(function(z){if(!(B.scroll.whitelist!=null&&!B.scroll.whitelist[z])){var D=B.scroll.lines(C,Math.max(q,1)),U=q;D.forEach(function(V){var G=V.length();if(!(V instanceof b.default))V.format(z,K[z]);else{var re=C-V.offset(B.scroll),oe=V.newlineIndex(re+U)-re+1;V.formatAt(re,oe,z,K[z])}U-=G})}}),this.scroll.optimize(),this.update(new d.default().retain(C).retain(q,(0,E.default)(K)))}},{key:"formatText",value:function(C,q){var B=this,K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(K).forEach(function(z){B.scroll.formatAt(C,q,z,K[z])}),this.update(new d.default().retain(C).retain(q,(0,E.default)(K)))}},{key:"getContents",value:function(C,q){return this.delta.slice(C,C+q)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(C,q){return C.concat(q.delta())},new d.default)}},{key:"getFormat",value:function(C){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,B=[],K=[];q===0?this.scroll.path(C).forEach(function(D){var U=s(D,1),V=U[0];V instanceof g.default?B.push(V):V instanceof a.default.Leaf&&K.push(V)}):(B=this.scroll.lines(C,q),K=this.scroll.descendants(a.default.Leaf,C,q));var z=[B,K].map(function(D){if(D.length===0)return{};for(var U=(0,p.bubbleFormats)(D.shift());Object.keys(U).length>0;){var V=D.shift();if(V==null)return U;U=F((0,p.bubbleFormats)(V),U)}return U});return x.default.apply(x.default,z)}},{key:"getText",value:function(C,q){return this.getContents(C,q).filter(function(B){return typeof B.insert=="string"}).map(function(B){return B.insert}).join("")}},{key:"insertEmbed",value:function(C,q,B){return this.scroll.insertAt(C,q,B),this.update(new d.default().retain(C).insert(N({},q,B)))}},{key:"insertText",value:function(C,q){var B=this,K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return q=q.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(C,q),Object.keys(K).forEach(function(z){B.scroll.formatAt(C,q.length,z,K[z])}),this.update(new d.default().retain(C).insert(q,(0,E.default)(K)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var C=this.scroll.children.head;return C.statics.blotName!==g.default.blotName||C.children.length>1?!1:C.children.head instanceof T.default}},{key:"removeFormat",value:function(C,q){var B=this.getText(C,q),K=this.scroll.line(C+q),z=s(K,2),D=z[0],U=z[1],V=0,G=new d.default;D!=null&&(D instanceof b.default?V=D.newlineIndex(U)-U+1:V=D.length()-U,G=D.delta().slice(U,U+V-1).insert(`
`));var re=this.getContents(C,q+V),oe=re.diff(new d.default().insert(B).concat(G)),ge=new d.default().retain(C).concat(oe);return this.applyDelta(ge)}},{key:"update",value:function(C){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,K=this.delta;if(q.length===1&&q[0].type==="characterData"&&q[0].target.data.match(R)&&a.default.find(q[0].target)){var z=a.default.find(q[0].target),D=(0,p.bubbleFormats)(z),U=z.offset(this.scroll),V=q[0].oldValue.replace(y.default.CONTENTS,""),G=new d.default().insert(V),re=new d.default().insert(z.value()),oe=new d.default().retain(U).concat(G.diff(re,B));C=oe.reduce(function(ge,ve){return ve.insert?ge.insert(ve.insert,D):ge.push(ve)},new d.default),this.delta=K.compose(C)}else this.delta=this.getDelta(),(!C||!(0,P.default)(K.compose(C),this.delta))&&(C=K.diff(this.delta,B));return C}}]),J}();function F(J,j){return Object.keys(j).reduce(function(C,q){return J[q]==null||(j[q]===J[q]?C[q]=j[q]:Array.isArray(j[q])?j[q].indexOf(J[q])<0&&(C[q]=j[q].concat([J[q]])):C[q]=[j[q],J[q]]),C},{})}function Y(J){return J.reduce(function(j,C){if(C.insert===1){var q=(0,E.default)(C.attributes);return delete q.image,j.insert({image:C.attributes.image},q)}if(C.attributes!=null&&(C.attributes.list===!0||C.attributes.bullet===!0)&&(C=(0,E.default)(C),C.attributes.list?C.attributes.list="ordered":(C.attributes.list="bullet",delete C.attributes.bullet)),typeof C.insert=="string"){var B=C.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return j.insert(B,C.attributes)}return j.push(C)},new d.default)}n.default=M},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var o=function(){function k(P,O){var x=[],I=!0,N=!1,_=void 0;try{for(var R=P[Symbol.iterator](),M;!(I=(M=R.next()).done)&&(x.push(M.value),!(O&&x.length===O));I=!0);}catch(F){N=!0,_=F}finally{try{!I&&R.return&&R.return()}finally{if(N)throw _}}return x}return function(P,O){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return k(P,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function k(P,O){for(var x=0;x<O.length;x++){var I=O[x];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(P,I.key,I)}}return function(P,O,x){return O&&k(P.prototype,O),x&&k(P,x),P}}(),c=r(0),u=y(c),d=r(21),m=y(d),h=r(11),l=y(h),a=r(8),v=y(a),b=r(10),w=y(b);function y(k){return k&&k.__esModule?k:{default:k}}function p(k){if(Array.isArray(k)){for(var P=0,O=Array(k.length);P<k.length;P++)O[P]=k[P];return O}else return Array.from(k)}function g(k,P){if(!(k instanceof P))throw new TypeError("Cannot call a class as a function")}var f=(0,w.default)("quill:selection"),T=function k(P){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;g(this,k),this.index=P,this.length=O},S=function(){function k(P,O){var x=this;g(this,k),this.emitter=O,this.scroll=P,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=u.default.create("cursor",this),this.lastRange=this.savedRange=new T(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){x.mouseDown||setTimeout(x.update.bind(x,v.default.sources.USER),1)}),this.emitter.on(v.default.events.EDITOR_CHANGE,function(I,N){I===v.default.events.TEXT_CHANGE&&N.length()>0&&x.update(v.default.sources.SILENT)}),this.emitter.on(v.default.events.SCROLL_BEFORE_UPDATE,function(){if(x.hasFocus()){var I=x.getNativeRange();I!=null&&I.start.node!==x.cursor.textNode&&x.emitter.once(v.default.events.SCROLL_UPDATE,function(){try{x.setNativeRange(I.start.node,I.start.offset,I.end.node,I.end.offset)}catch{}})}}),this.emitter.on(v.default.events.SCROLL_OPTIMIZE,function(I,N){if(N.range){var _=N.range,R=_.startNode,M=_.startOffset,F=_.endNode,Y=_.endOffset;x.setNativeRange(R,M,F,Y)}}),this.update(v.default.sources.SILENT)}return s(k,[{key:"handleComposition",value:function(){var O=this;this.root.addEventListener("compositionstart",function(){O.composing=!0}),this.root.addEventListener("compositionend",function(){if(O.composing=!1,O.cursor.parent){var x=O.cursor.restore();if(!x)return;setTimeout(function(){O.setNativeRange(x.startNode,x.startOffset,x.endNode,x.endOffset)},1)}})}},{key:"handleDragging",value:function(){var O=this;this.emitter.listenDOM("mousedown",document.body,function(){O.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){O.mouseDown=!1,O.update(v.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(O,x){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[O])){this.scroll.update();var I=this.getNativeRange();if(!(I==null||!I.native.collapsed||u.default.query(O,u.default.Scope.BLOCK))){if(I.start.node!==this.cursor.textNode){var N=u.default.find(I.start.node,!1);if(N==null)return;if(N instanceof u.default.Leaf){var _=N.split(I.start.offset);N.parent.insertBefore(this.cursor,_)}else N.insertBefore(this.cursor,I.start.node);this.cursor.attach()}this.cursor.format(O,x),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(O){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,I=this.scroll.length();O=Math.min(O,I-1),x=Math.min(O+x,I-1)-O;var N=void 0,_=this.scroll.leaf(O),R=o(_,2),M=R[0],F=R[1];if(M==null)return null;var Y=M.position(F,!0),J=o(Y,2);N=J[0],F=J[1];var j=document.createRange();if(x>0){j.setStart(N,F);var C=this.scroll.leaf(O+x),q=o(C,2);if(M=q[0],F=q[1],M==null)return null;var B=M.position(F,!0),K=o(B,2);return N=K[0],F=K[1],j.setEnd(N,F),j.getBoundingClientRect()}else{var z="left",D=void 0;return N instanceof Text?(F<N.data.length?(j.setStart(N,F),j.setEnd(N,F+1)):(j.setStart(N,F-1),j.setEnd(N,F),z="right"),D=j.getBoundingClientRect()):(D=M.domNode.getBoundingClientRect(),F>0&&(z="right")),{bottom:D.top+D.height,height:D.height,left:D[z],right:D[z],top:D.top,width:0}}}},{key:"getNativeRange",value:function(){var O=document.getSelection();if(O==null||O.rangeCount<=0)return null;var x=O.getRangeAt(0);if(x==null)return null;var I=this.normalizeNative(x);return f.info("getNativeRange",I),I}},{key:"getRange",value:function(){var O=this.getNativeRange();if(O==null)return[null,null];var x=this.normalizedToRange(O);return[x,O]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(O){var x=this,I=[[O.start.node,O.start.offset]];O.native.collapsed||I.push([O.end.node,O.end.offset]);var N=I.map(function(M){var F=o(M,2),Y=F[0],J=F[1],j=u.default.find(Y,!0),C=j.offset(x.scroll);return J===0?C:j instanceof u.default.Container?C+j.length():C+j.index(Y,J)}),_=Math.min(Math.max.apply(Math,p(N)),this.scroll.length()-1),R=Math.min.apply(Math,[_].concat(p(N)));return new T(R,_-R)}},{key:"normalizeNative",value:function(O){if(!E(this.root,O.startContainer)||!O.collapsed&&!E(this.root,O.endContainer))return null;var x={start:{node:O.startContainer,offset:O.startOffset},end:{node:O.endContainer,offset:O.endOffset},native:O};return[x.start,x.end].forEach(function(I){for(var N=I.node,_=I.offset;!(N instanceof Text)&&N.childNodes.length>0;)if(N.childNodes.length>_)N=N.childNodes[_],_=0;else if(N.childNodes.length===_)N=N.lastChild,_=N instanceof Text?N.data.length:N.childNodes.length+1;else break;I.node=N,I.offset=_}),x}},{key:"rangeToNative",value:function(O){var x=this,I=O.collapsed?[O.index]:[O.index,O.index+O.length],N=[],_=this.scroll.length();return I.forEach(function(R,M){R=Math.min(_-1,R);var F=void 0,Y=x.scroll.leaf(R),J=o(Y,2),j=J[0],C=J[1],q=j.position(C,M!==0),B=o(q,2);F=B[0],C=B[1],N.push(F,C)}),N.length<2&&(N=N.concat(N)),N}},{key:"scrollIntoView",value:function(O){var x=this.lastRange;if(x!=null){var I=this.getBounds(x.index,x.length);if(I!=null){var N=this.scroll.length()-1,_=this.scroll.line(Math.min(x.index,N)),R=o(_,1),M=R[0],F=M;if(x.length>0){var Y=this.scroll.line(Math.min(x.index+x.length,N)),J=o(Y,1);F=J[0]}if(!(M==null||F==null)){var j=O.getBoundingClientRect();I.top<j.top?O.scrollTop-=j.top-I.top:I.bottom>j.bottom&&(O.scrollTop+=I.bottom-j.bottom)}}}}},{key:"setNativeRange",value:function(O,x){var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:O,N=arguments.length>3&&arguments[3]!==void 0?arguments[3]:x,_=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(f.info("setNativeRange",O,x,I,N),!(O!=null&&(this.root.parentNode==null||O.parentNode==null||I.parentNode==null))){var R=document.getSelection();if(R!=null)if(O!=null){this.hasFocus()||this.root.focus();var M=(this.getNativeRange()||{}).native;if(M==null||_||O!==M.startContainer||x!==M.startOffset||I!==M.endContainer||N!==M.endOffset){O.tagName=="BR"&&(x=[].indexOf.call(O.parentNode.childNodes,O),O=O.parentNode),I.tagName=="BR"&&(N=[].indexOf.call(I.parentNode.childNodes,I),I=I.parentNode);var F=document.createRange();F.setStart(O,x),F.setEnd(I,N),R.removeAllRanges(),R.addRange(F)}}else R.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(O){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:v.default.sources.API;if(typeof x=="string"&&(I=x,x=!1),f.info("setRange",O),O!=null){var N=this.rangeToNative(O);this.setNativeRange.apply(this,p(N).concat([x]))}else this.setNativeRange(null);this.update(I)}},{key:"update",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v.default.sources.USER,x=this.lastRange,I=this.getRange(),N=o(I,2),_=N[0],R=N[1];if(this.lastRange=_,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,l.default)(x,this.lastRange)){var M;!this.composing&&R!=null&&R.native.collapsed&&R.start.node!==this.cursor.textNode&&this.cursor.restore();var F=[v.default.events.SELECTION_CHANGE,(0,m.default)(this.lastRange),(0,m.default)(x),O];if((M=this.emitter).emit.apply(M,[v.default.events.EDITOR_CHANGE].concat(F)),O!==v.default.sources.SILENT){var Y;(Y=this.emitter).emit.apply(Y,F)}}}}]),k}();function E(k,P){try{P.parentNode}catch{return!1}return P instanceof Text&&(P=P.parentNode),k.contains(P)}n.Range=T,n.default=S},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function v(b,w){for(var y=0;y<w.length;y++){var p=w[y];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(b,p.key,p)}}return function(b,w,y){return w&&v(b.prototype,w),y&&v(b,y),b}}(),s=function v(b,w,y){b===null&&(b=Function.prototype);var p=Object.getOwnPropertyDescriptor(b,w);if(p===void 0){var g=Object.getPrototypeOf(b);return g===null?void 0:v(g,w,y)}else{if("value"in p)return p.value;var f=p.get;return f===void 0?void 0:f.call(y)}},c=r(0),u=d(c);function d(v){return v&&v.__esModule?v:{default:v}}function m(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}function h(v,b){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:v}function l(v,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);v.prototype=Object.create(b&&b.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(v,b):v.__proto__=b)}var a=function(v){l(b,v);function b(){return m(this,b),h(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return o(b,[{key:"insertInto",value:function(y,p){y.children.length===0?s(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"insertInto",this).call(this,y,p):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),b}(u.default.Embed);a.blotName="break",a.tagName="BR",n.default=a},function(e,n,r){var o=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,a){l.__proto__=a}||function(l,a){for(var v in a)a.hasOwnProperty(v)&&(l[v]=a[v])};return function(l,a){h(l,a);function v(){this.constructor=l}l.prototype=a===null?Object.create(a):(v.prototype=a.prototype,new v)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=r(44),c=r(30),u=r(1),d=function(h){o(l,h);function l(a){var v=h.call(this,a)||this;return v.build(),v}return l.prototype.appendChild=function(a){this.insertBefore(a)},l.prototype.attach=function(){h.prototype.attach.call(this),this.children.forEach(function(a){a.attach()})},l.prototype.build=function(){var a=this;this.children=new s.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(v){try{var b=m(v);a.insertBefore(b,a.children.head||void 0)}catch(w){if(w instanceof u.ParchmentError)return;throw w}})},l.prototype.deleteAt=function(a,v){if(a===0&&v===this.length())return this.remove();this.children.forEachAt(a,v,function(b,w,y){b.deleteAt(w,y)})},l.prototype.descendant=function(a,v){var b=this.children.find(v),w=b[0],y=b[1];return a.blotName==null&&a(w)||a.blotName!=null&&w instanceof a?[w,y]:w instanceof l?w.descendant(a,y):[null,-1]},l.prototype.descendants=function(a,v,b){v===void 0&&(v=0),b===void 0&&(b=Number.MAX_VALUE);var w=[],y=b;return this.children.forEachAt(v,b,function(p,g,f){(a.blotName==null&&a(p)||a.blotName!=null&&p instanceof a)&&w.push(p),p instanceof l&&(w=w.concat(p.descendants(a,g,y))),y-=f}),w},l.prototype.detach=function(){this.children.forEach(function(a){a.detach()}),h.prototype.detach.call(this)},l.prototype.formatAt=function(a,v,b,w){this.children.forEachAt(a,v,function(y,p,g){y.formatAt(p,g,b,w)})},l.prototype.insertAt=function(a,v,b){var w=this.children.find(a),y=w[0],p=w[1];if(y)y.insertAt(p,v,b);else{var g=b==null?u.create("text",v):u.create(v,b);this.appendChild(g)}},l.prototype.insertBefore=function(a,v){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(b){return a instanceof b}))throw new u.ParchmentError("Cannot insert "+a.statics.blotName+" into "+this.statics.blotName);a.insertInto(this,v)},l.prototype.length=function(){return this.children.reduce(function(a,v){return a+v.length()},0)},l.prototype.moveChildren=function(a,v){this.children.forEach(function(b){a.insertBefore(b,v)})},l.prototype.optimize=function(a){if(h.prototype.optimize.call(this,a),this.children.length===0)if(this.statics.defaultChild!=null){var v=u.create(this.statics.defaultChild);this.appendChild(v),v.optimize(a)}else this.remove()},l.prototype.path=function(a,v){v===void 0&&(v=!1);var b=this.children.find(a,v),w=b[0],y=b[1],p=[[this,a]];return w instanceof l?p.concat(w.path(y,v)):(w!=null&&p.push([w,y]),p)},l.prototype.removeChild=function(a){this.children.remove(a)},l.prototype.replace=function(a){a instanceof l&&a.moveChildren(this),h.prototype.replace.call(this,a)},l.prototype.split=function(a,v){if(v===void 0&&(v=!1),!v){if(a===0)return this;if(a===this.length())return this.next}var b=this.clone();return this.parent.insertBefore(b,this.next),this.children.forEachAt(a,this.length(),function(w,y,p){w=w.split(y,v),b.appendChild(w)}),b},l.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},l.prototype.update=function(a,v){var b=this,w=[],y=[];a.forEach(function(p){p.target===b.domNode&&p.type==="childList"&&(w.push.apply(w,p.addedNodes),y.push.apply(y,p.removedNodes))}),y.forEach(function(p){if(!(p.parentNode!=null&&p.tagName!=="IFRAME"&&document.body.compareDocumentPosition(p)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var g=u.find(p);g!=null&&(g.domNode.parentNode==null||g.domNode.parentNode===b.domNode)&&g.detach()}}),w.filter(function(p){return p.parentNode==b.domNode}).sort(function(p,g){return p===g?0:p.compareDocumentPosition(g)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(p){var g=null;p.nextSibling!=null&&(g=u.find(p.nextSibling));var f=m(p);(f.next!=g||f.next==null)&&(f.parent!=null&&f.parent.removeChild(b),b.insertBefore(f,g||void 0))})},l}(c.default);function m(h){var l=u.find(h);if(l==null)try{l=u.create(h)}catch{l=u.create(u.Scope.INLINE),[].slice.call(h.childNodes).forEach(function(v){l.domNode.appendChild(v)}),h.parentNode&&h.parentNode.replaceChild(l.domNode,h),l.attach()}return l}n.default=d},function(e,n,r){var o=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,a){l.__proto__=a}||function(l,a){for(var v in a)a.hasOwnProperty(v)&&(l[v]=a[v])};return function(l,a){h(l,a);function v(){this.constructor=l}l.prototype=a===null?Object.create(a):(v.prototype=a.prototype,new v)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=r(12),c=r(31),u=r(17),d=r(1),m=function(h){o(l,h);function l(a){var v=h.call(this,a)||this;return v.attributes=new c.default(v.domNode),v}return l.formats=function(a){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return a.tagName.toLowerCase()},l.prototype.format=function(a,v){var b=d.query(a);b instanceof s.default?this.attributes.attribute(b,v):v&&b!=null&&(a!==this.statics.blotName||this.formats()[a]!==v)&&this.replaceWith(a,v)},l.prototype.formats=function(){var a=this.attributes.values(),v=this.statics.formats(this.domNode);return v!=null&&(a[this.statics.blotName]=v),a},l.prototype.replaceWith=function(a,v){var b=h.prototype.replaceWith.call(this,a,v);return this.attributes.copy(b),b},l.prototype.update=function(a,v){var b=this;h.prototype.update.call(this,a,v),a.some(function(w){return w.target===b.domNode&&w.type==="attributes"})&&this.attributes.build()},l.prototype.wrap=function(a,v){var b=h.prototype.wrap.call(this,a,v);return b instanceof l&&b.statics.scope===this.statics.scope&&this.attributes.move(b),b},l}(u.default);n.default=m},function(e,n,r){var o=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,h){m.__proto__=h}||function(m,h){for(var l in h)h.hasOwnProperty(l)&&(m[l]=h[l])};return function(m,h){d(m,h);function l(){this.constructor=m}m.prototype=h===null?Object.create(h):(l.prototype=h.prototype,new l)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=r(30),c=r(1),u=function(d){o(m,d);function m(){return d!==null&&d.apply(this,arguments)||this}return m.value=function(h){return!0},m.prototype.index=function(h,l){return this.domNode===h||this.domNode.compareDocumentPosition(h)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(l,1):-1},m.prototype.position=function(h,l){var a=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return h>0&&(a+=1),[this.parent.domNode,a]},m.prototype.value=function(){var h;return h={},h[this.statics.blotName]=this.statics.value(this.domNode)||!0,h},m.scope=c.Scope.INLINE_BLOT,m}(s.default);n.default=u},function(e,n,r){var o=r(11),s=r(3),c={attributes:{compose:function(d,m,h){typeof d!="object"&&(d={}),typeof m!="object"&&(m={});var l=s(!0,{},m);h||(l=Object.keys(l).reduce(function(v,b){return l[b]!=null&&(v[b]=l[b]),v},{}));for(var a in d)d[a]!==void 0&&m[a]===void 0&&(l[a]=d[a]);return Object.keys(l).length>0?l:void 0},diff:function(d,m){typeof d!="object"&&(d={}),typeof m!="object"&&(m={});var h=Object.keys(d).concat(Object.keys(m)).reduce(function(l,a){return o(d[a],m[a])||(l[a]=m[a]===void 0?null:m[a]),l},{});return Object.keys(h).length>0?h:void 0},transform:function(d,m,h){if(typeof d!="object")return m;if(typeof m=="object"){if(!h)return m;var l=Object.keys(m).reduce(function(a,v){return d[v]===void 0&&(a[v]=m[v]),a},{});return Object.keys(l).length>0?l:void 0}}},iterator:function(d){return new u(d)},length:function(d){return typeof d.delete=="number"?d.delete:typeof d.retain=="number"?d.retain:typeof d.insert=="string"?d.insert.length:1}};function u(d){this.ops=d,this.index=0,this.offset=0}u.prototype.hasNext=function(){return this.peekLength()<1/0},u.prototype.next=function(d){d||(d=1/0);var m=this.ops[this.index];if(m){var h=this.offset,l=c.length(m);if(d>=l-h?(d=l-h,this.index+=1,this.offset=0):this.offset+=d,typeof m.delete=="number")return{delete:d};var a={};return m.attributes&&(a.attributes=m.attributes),typeof m.retain=="number"?a.retain=d:typeof m.insert=="string"?a.insert=m.insert.substr(h,d):a.insert=m.insert,a}else return{retain:1/0}},u.prototype.peek=function(){return this.ops[this.index]},u.prototype.peekLength=function(){return this.ops[this.index]?c.length(this.ops[this.index])-this.offset:1/0},u.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},u.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var d=this.offset,m=this.index,h=this.next(),l=this.ops.slice(this.index);return this.offset=d,this.index=m,[h].concat(l)}else return[]},e.exports=c},function(e,n){var r=function(){function o(b,w){return w!=null&&b instanceof w}var s;try{s=Map}catch{s=function(){}}var c;try{c=Set}catch{c=function(){}}var u;try{u=Promise}catch{u=function(){}}function d(b,w,y,p,g){typeof w=="object"&&(y=w.depth,p=w.prototype,g=w.includeNonEnumerable,w=w.circular);var f=[],T=[],S=typeof Buffer<"u";typeof w>"u"&&(w=!0),typeof y>"u"&&(y=1/0);function E(k,P){if(k===null)return null;if(P===0)return k;var O,x;if(typeof k!="object")return k;if(o(k,s))O=new s;else if(o(k,c))O=new c;else if(o(k,u))O=new u(function(j,C){k.then(function(q){j(E(q,P-1))},function(q){C(E(q,P-1))})});else if(d.__isArray(k))O=[];else if(d.__isRegExp(k))O=new RegExp(k.source,v(k)),k.lastIndex&&(O.lastIndex=k.lastIndex);else if(d.__isDate(k))O=new Date(k.getTime());else{if(S&&Buffer.isBuffer(k))return Buffer.allocUnsafe?O=Buffer.allocUnsafe(k.length):O=new Buffer(k.length),k.copy(O),O;o(k,Error)?O=Object.create(k):typeof p>"u"?(x=Object.getPrototypeOf(k),O=Object.create(x)):(O=Object.create(p),x=p)}if(w){var I=f.indexOf(k);if(I!=-1)return T[I];f.push(k),T.push(O)}o(k,s)&&k.forEach(function(j,C){var q=E(C,P-1),B=E(j,P-1);O.set(q,B)}),o(k,c)&&k.forEach(function(j){var C=E(j,P-1);O.add(C)});for(var N in k){var _;x&&(_=Object.getOwnPropertyDescriptor(x,N)),!(_&&_.set==null)&&(O[N]=E(k[N],P-1))}if(Object.getOwnPropertySymbols)for(var R=Object.getOwnPropertySymbols(k),N=0;N<R.length;N++){var M=R[N],F=Object.getOwnPropertyDescriptor(k,M);F&&!F.enumerable&&!g||(O[M]=E(k[M],P-1),F.enumerable||Object.defineProperty(O,M,{enumerable:!1}))}if(g)for(var Y=Object.getOwnPropertyNames(k),N=0;N<Y.length;N++){var J=Y[N],F=Object.getOwnPropertyDescriptor(k,J);F&&F.enumerable||(O[J]=E(k[J],P-1),Object.defineProperty(O,J,{enumerable:!1}))}return O}return E(b,y)}d.clonePrototype=function(w){if(w===null)return null;var y=function(){};return y.prototype=w,new y};function m(b){return Object.prototype.toString.call(b)}d.__objToStr=m;function h(b){return typeof b=="object"&&m(b)==="[object Date]"}d.__isDate=h;function l(b){return typeof b=="object"&&m(b)==="[object Array]"}d.__isArray=l;function a(b){return typeof b=="object"&&m(b)==="[object RegExp]"}d.__isRegExp=a;function v(b){var w="";return b.global&&(w+="g"),b.ignoreCase&&(w+="i"),b.multiline&&(w+="m"),w}return d.__getRegExpFlags=v,d}();typeof e=="object"&&e.exports&&(e.exports=r)},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function O(x,I){var N=[],_=!0,R=!1,M=void 0;try{for(var F=x[Symbol.iterator](),Y;!(_=(Y=F.next()).done)&&(N.push(Y.value),!(I&&N.length===I));_=!0);}catch(J){R=!0,M=J}finally{try{!_&&F.return&&F.return()}finally{if(R)throw M}}return N}return function(x,I){if(Array.isArray(x))return x;if(Symbol.iterator in Object(x))return O(x,I);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function O(x,I){for(var N=0;N<I.length;N++){var _=I[N];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,_.key,_)}}return function(x,I,N){return I&&O(x.prototype,I),N&&O(x,N),x}}(),c=function O(x,I,N){x===null&&(x=Function.prototype);var _=Object.getOwnPropertyDescriptor(x,I);if(_===void 0){var R=Object.getPrototypeOf(x);return R===null?void 0:O(R,I,N)}else{if("value"in _)return _.value;var M=_.get;return M===void 0?void 0:M.call(N)}},u=r(0),d=f(u),m=r(8),h=f(m),l=r(4),a=f(l),v=r(16),b=f(v),w=r(13),y=f(w),p=r(25),g=f(p);function f(O){return O&&O.__esModule?O:{default:O}}function T(O,x){if(!(O instanceof x))throw new TypeError("Cannot call a class as a function")}function S(O,x){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:O}function E(O,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);O.prototype=Object.create(x&&x.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(O,x):O.__proto__=x)}function k(O){return O instanceof a.default||O instanceof l.BlockEmbed}var P=function(O){E(x,O);function x(I,N){T(this,x);var _=S(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,I));return _.emitter=N.emitter,Array.isArray(N.whitelist)&&(_.whitelist=N.whitelist.reduce(function(R,M){return R[M]=!0,R},{})),_.domNode.addEventListener("DOMNodeInserted",function(){}),_.optimize(),_.enable(),_}return s(x,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(N,_){var R=this.line(N),M=o(R,2),F=M[0],Y=M[1],J=this.line(N+_),j=o(J,1),C=j[0];if(c(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"deleteAt",this).call(this,N,_),C!=null&&F!==C&&Y>0){if(F instanceof l.BlockEmbed||C instanceof l.BlockEmbed){this.optimize();return}if(F instanceof y.default){var q=F.newlineIndex(F.length(),!0);if(q>-1&&(F=F.split(q+1),F===C)){this.optimize();return}}else if(C instanceof y.default){var B=C.newlineIndex(0);B>-1&&C.split(B+1)}var K=C.children.head instanceof b.default?null:C.children.head;F.moveChildren(C,K),F.remove()}this.optimize()}},{key:"enable",value:function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",N)}},{key:"formatAt",value:function(N,_,R,M){this.whitelist!=null&&!this.whitelist[R]||(c(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"formatAt",this).call(this,N,_,R,M),this.optimize())}},{key:"insertAt",value:function(N,_,R){if(!(R!=null&&this.whitelist!=null&&!this.whitelist[_])){if(N>=this.length())if(R==null||d.default.query(_,d.default.Scope.BLOCK)==null){var M=d.default.create(this.statics.defaultChild);this.appendChild(M),R==null&&_.endsWith(`
`)&&(_=_.slice(0,-1)),M.insertAt(0,_,R)}else{var F=d.default.create(_,R);this.appendChild(F)}else c(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"insertAt",this).call(this,N,_,R);this.optimize()}}},{key:"insertBefore",value:function(N,_){if(N.statics.scope===d.default.Scope.INLINE_BLOT){var R=d.default.create(this.statics.defaultChild);R.appendChild(N),N=R}c(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"insertBefore",this).call(this,N,_)}},{key:"leaf",value:function(N){return this.path(N).pop()||[null,-1]}},{key:"line",value:function(N){return N===this.length()?this.line(N-1):this.descendant(k,N)}},{key:"lines",value:function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,R=function M(F,Y,J){var j=[],C=J;return F.children.forEachAt(Y,J,function(q,B,K){k(q)?j.push(q):q instanceof d.default.Container&&(j=j.concat(M(q,B,C))),C-=K}),j};return R(this,N,_)}},{key:"optimize",value:function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(c(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"optimize",this).call(this,N,_),N.length>0&&this.emitter.emit(h.default.events.SCROLL_OPTIMIZE,N,_))}},{key:"path",value:function(N){return c(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"path",this).call(this,N).slice(1)}},{key:"update",value:function(N){if(this.batch!==!0){var _=h.default.sources.USER;typeof N=="string"&&(_=N),Array.isArray(N)||(N=this.observer.takeRecords()),N.length>0&&this.emitter.emit(h.default.events.SCROLL_BEFORE_UPDATE,_,N),c(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"update",this).call(this,N.concat([])),N.length>0&&this.emitter.emit(h.default.events.SCROLL_UPDATE,_,N)}}}]),x}(d.default.Scroll);P.blotName="scroll",P.className="ql-editor",P.tagName="DIV",P.defaultChild="block",P.allowedChildren=[a.default,l.BlockEmbed,g.default],n.default=P},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.SHORTKEY=n.default=void 0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},s=function(){function D(U,V){var G=[],re=!0,oe=!1,ge=void 0;try{for(var ve=U[Symbol.iterator](),ye;!(re=(ye=ve.next()).done)&&(G.push(ye.value),!(V&&G.length===V));re=!0);}catch(Ne){oe=!0,ge=Ne}finally{try{!re&&ve.return&&ve.return()}finally{if(oe)throw ge}}return G}return function(U,V){if(Array.isArray(U))return U;if(Symbol.iterator in Object(U))return D(U,V);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function D(U,V){for(var G=0;G<V.length;G++){var re=V[G];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(U,re.key,re)}}return function(U,V,G){return V&&D(U.prototype,V),G&&D(U,G),U}}(),u=r(21),d=O(u),m=r(11),h=O(m),l=r(3),a=O(l),v=r(2),b=O(v),w=r(20),y=O(w),p=r(0),g=O(p),f=r(5),T=O(f),S=r(10),E=O(S),k=r(9),P=O(k);function O(D){return D&&D.__esModule?D:{default:D}}function x(D,U,V){return U in D?Object.defineProperty(D,U,{value:V,enumerable:!0,configurable:!0,writable:!0}):D[U]=V,D}function I(D,U){if(!(D instanceof U))throw new TypeError("Cannot call a class as a function")}function N(D,U){if(!D)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U&&(typeof U=="object"||typeof U=="function")?U:D}function _(D,U){if(typeof U!="function"&&U!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof U);D.prototype=Object.create(U&&U.prototype,{constructor:{value:D,enumerable:!1,writable:!0,configurable:!0}}),U&&(Object.setPrototypeOf?Object.setPrototypeOf(D,U):D.__proto__=U)}var R=(0,E.default)("quill:keyboard"),M=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",F=function(D){_(U,D),c(U,null,[{key:"match",value:function(G,re){return re=z(re),["altKey","ctrlKey","metaKey","shiftKey"].some(function(oe){return!!re[oe]!==G[oe]&&re[oe]!==null})?!1:re.key===(G.which||G.keyCode)}}]);function U(V,G){I(this,U);var re=N(this,(U.__proto__||Object.getPrototypeOf(U)).call(this,V,G));return re.bindings={},Object.keys(re.options.bindings).forEach(function(oe){oe==="list autofill"&&V.scroll.whitelist!=null&&!V.scroll.whitelist.list||re.options.bindings[oe]&&re.addBinding(re.options.bindings[oe])}),re.addBinding({key:U.keys.ENTER,shiftKey:null},q),re.addBinding({key:U.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(re.addBinding({key:U.keys.BACKSPACE},{collapsed:!0},J),re.addBinding({key:U.keys.DELETE},{collapsed:!0},j)):(re.addBinding({key:U.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},J),re.addBinding({key:U.keys.DELETE},{collapsed:!0,suffix:/^.?$/},j)),re.addBinding({key:U.keys.BACKSPACE},{collapsed:!1},C),re.addBinding({key:U.keys.DELETE},{collapsed:!1},C),re.addBinding({key:U.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},J),re.listen(),re}return c(U,[{key:"addBinding",value:function(G){var re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},oe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ge=z(G);if(ge==null||ge.key==null)return R.warn("Attempted to add invalid keyboard binding",ge);typeof re=="function"&&(re={handler:re}),typeof oe=="function"&&(oe={handler:oe}),ge=(0,a.default)(ge,re,oe),this.bindings[ge.key]=this.bindings[ge.key]||[],this.bindings[ge.key].push(ge)}},{key:"listen",value:function(){var G=this;this.quill.root.addEventListener("keydown",function(re){if(!re.defaultPrevented){var oe=re.which||re.keyCode,ge=(G.bindings[oe]||[]).filter(function(Re){return U.match(re,Re)});if(ge.length!==0){var ve=G.quill.getSelection();if(!(ve==null||!G.quill.hasFocus())){var ye=G.quill.getLine(ve.index),Ne=s(ye,2),Ke=Ne[0],$e=Ne[1],X=G.quill.getLeaf(ve.index),ee=s(X,2),ae=ee[0],ce=ee[1],ie=ve.length===0?[ae,ce]:G.quill.getLeaf(ve.index+ve.length),we=s(ie,2),pe=we[0],Ae=we[1],je=ae instanceof g.default.Text?ae.value().slice(0,ce):"",ze=pe instanceof g.default.Text?pe.value().slice(Ae):"",ke={collapsed:ve.length===0,empty:ve.length===0&&Ke.length()<=1,format:G.quill.getFormat(ve),offset:$e,prefix:je,suffix:ze},ct=ge.some(function(Re){if(Re.collapsed!=null&&Re.collapsed!==ke.collapsed||Re.empty!=null&&Re.empty!==ke.empty||Re.offset!=null&&Re.offset!==ke.offset)return!1;if(Array.isArray(Re.format)){if(Re.format.every(function(yt){return ke.format[yt]==null}))return!1}else if(o(Re.format)==="object"&&!Object.keys(Re.format).every(function(yt){return Re.format[yt]===!0?ke.format[yt]!=null:Re.format[yt]===!1?ke.format[yt]==null:(0,h.default)(Re.format[yt],ke.format[yt])}))return!1;return Re.prefix!=null&&!Re.prefix.test(ke.prefix)||Re.suffix!=null&&!Re.suffix.test(ke.suffix)?!1:Re.handler.call(G,ve,ke)!==!0});ct&&re.preventDefault()}}}})}}]),U}(P.default);F.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},F.DEFAULTS={bindings:{bold:K("bold"),italic:K("italic"),underline:K("underline"),indent:{key:F.keys.TAB,format:["blockquote","indent","list"],handler:function(U,V){if(V.collapsed&&V.offset!==0)return!0;this.quill.format("indent","+1",T.default.sources.USER)}},outdent:{key:F.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(U,V){if(V.collapsed&&V.offset!==0)return!0;this.quill.format("indent","-1",T.default.sources.USER)}},"outdent backspace":{key:F.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(U,V){V.format.indent!=null?this.quill.format("indent","-1",T.default.sources.USER):V.format.list!=null&&this.quill.format("list",!1,T.default.sources.USER)}},"indent code-block":B(!0),"outdent code-block":B(!1),"remove tab":{key:F.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(U){this.quill.deleteText(U.index-1,1,T.default.sources.USER)}},tab:{key:F.keys.TAB,handler:function(U){this.quill.history.cutoff();var V=new b.default().retain(U.index).delete(U.length).insert("	");this.quill.updateContents(V,T.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(U.index+1,T.default.sources.SILENT)}},"list empty enter":{key:F.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(U,V){this.quill.format("list",!1,T.default.sources.USER),V.format.indent&&this.quill.format("indent",!1,T.default.sources.USER)}},"checklist enter":{key:F.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(U){var V=this.quill.getLine(U.index),G=s(V,2),re=G[0],oe=G[1],ge=(0,a.default)({},re.formats(),{list:"checked"}),ve=new b.default().retain(U.index).insert(`
`,ge).retain(re.length()-oe-1).retain(1,{list:"unchecked"});this.quill.updateContents(ve,T.default.sources.USER),this.quill.setSelection(U.index+1,T.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:F.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(U,V){var G=this.quill.getLine(U.index),re=s(G,2),oe=re[0],ge=re[1],ve=new b.default().retain(U.index).insert(`
`,V.format).retain(oe.length()-ge-1).retain(1,{header:null});this.quill.updateContents(ve,T.default.sources.USER),this.quill.setSelection(U.index+1,T.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(U,V){var G=V.prefix.length,re=this.quill.getLine(U.index),oe=s(re,2),ge=oe[0],ve=oe[1];if(ve>G)return!0;var ye=void 0;switch(V.prefix.trim()){case"[]":case"[ ]":ye="unchecked";break;case"[x]":ye="checked";break;case"-":case"*":ye="bullet";break;default:ye="ordered"}this.quill.insertText(U.index," ",T.default.sources.USER),this.quill.history.cutoff();var Ne=new b.default().retain(U.index-ve).delete(G+1).retain(ge.length()-2-ve).retain(1,{list:ye});this.quill.updateContents(Ne,T.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(U.index-G,T.default.sources.SILENT)}},"code exit":{key:F.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(U){var V=this.quill.getLine(U.index),G=s(V,2),re=G[0],oe=G[1],ge=new b.default().retain(U.index+re.length()-oe-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(ge,T.default.sources.USER)}},"embed left":Y(F.keys.LEFT,!1),"embed left shift":Y(F.keys.LEFT,!0),"embed right":Y(F.keys.RIGHT,!1),"embed right shift":Y(F.keys.RIGHT,!0)}};function Y(D,U){var V,G=D===F.keys.LEFT?"prefix":"suffix";return V={key:D,shiftKey:U,altKey:null},x(V,G,/^$/),x(V,"handler",function(oe){var ge=oe.index;D===F.keys.RIGHT&&(ge+=oe.length+1);var ve=this.quill.getLeaf(ge),ye=s(ve,1),Ne=ye[0];return Ne instanceof g.default.Embed?(D===F.keys.LEFT?U?this.quill.setSelection(oe.index-1,oe.length+1,T.default.sources.USER):this.quill.setSelection(oe.index-1,T.default.sources.USER):U?this.quill.setSelection(oe.index,oe.length+1,T.default.sources.USER):this.quill.setSelection(oe.index+oe.length+1,T.default.sources.USER),!1):!0}),V}function J(D,U){if(!(D.index===0||this.quill.getLength()<=1)){var V=this.quill.getLine(D.index),G=s(V,1),re=G[0],oe={};if(U.offset===0){var ge=this.quill.getLine(D.index-1),ve=s(ge,1),ye=ve[0];if(ye!=null&&ye.length()>1){var Ne=re.formats(),Ke=this.quill.getFormat(D.index-1,1);oe=y.default.attributes.diff(Ne,Ke)||{}}}var $e=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(U.prefix)?2:1;this.quill.deleteText(D.index-$e,$e,T.default.sources.USER),Object.keys(oe).length>0&&this.quill.formatLine(D.index-$e,$e,oe,T.default.sources.USER),this.quill.focus()}}function j(D,U){var V=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(U.suffix)?2:1;if(!(D.index>=this.quill.getLength()-V)){var G={},re=0,oe=this.quill.getLine(D.index),ge=s(oe,1),ve=ge[0];if(U.offset>=ve.length()-1){var ye=this.quill.getLine(D.index+1),Ne=s(ye,1),Ke=Ne[0];if(Ke){var $e=ve.formats(),X=this.quill.getFormat(D.index,1);G=y.default.attributes.diff($e,X)||{},re=Ke.length()}}this.quill.deleteText(D.index,V,T.default.sources.USER),Object.keys(G).length>0&&this.quill.formatLine(D.index+re-1,V,G,T.default.sources.USER)}}function C(D){var U=this.quill.getLines(D),V={};if(U.length>1){var G=U[0].formats(),re=U[U.length-1].formats();V=y.default.attributes.diff(re,G)||{}}this.quill.deleteText(D,T.default.sources.USER),Object.keys(V).length>0&&this.quill.formatLine(D.index,1,V,T.default.sources.USER),this.quill.setSelection(D.index,T.default.sources.SILENT),this.quill.focus()}function q(D,U){var V=this;D.length>0&&this.quill.scroll.deleteAt(D.index,D.length);var G=Object.keys(U.format).reduce(function(re,oe){return g.default.query(oe,g.default.Scope.BLOCK)&&!Array.isArray(U.format[oe])&&(re[oe]=U.format[oe]),re},{});this.quill.insertText(D.index,`
`,G,T.default.sources.USER),this.quill.setSelection(D.index+1,T.default.sources.SILENT),this.quill.focus(),Object.keys(U.format).forEach(function(re){G[re]==null&&(Array.isArray(U.format[re])||re!=="link"&&V.quill.format(re,U.format[re],T.default.sources.USER))})}function B(D){return{key:F.keys.TAB,shiftKey:!D,format:{"code-block":!0},handler:function(V){var G=g.default.query("code-block"),re=V.index,oe=V.length,ge=this.quill.scroll.descendant(G,re),ve=s(ge,2),ye=ve[0],Ne=ve[1];if(ye!=null){var Ke=this.quill.getIndex(ye),$e=ye.newlineIndex(Ne,!0)+1,X=ye.newlineIndex(Ke+Ne+oe),ee=ye.domNode.textContent.slice($e,X).split(`
`);Ne=0,ee.forEach(function(ae,ce){D?(ye.insertAt($e+Ne,G.TAB),Ne+=G.TAB.length,ce===0?re+=G.TAB.length:oe+=G.TAB.length):ae.startsWith(G.TAB)&&(ye.deleteAt($e+Ne,G.TAB.length),Ne-=G.TAB.length,ce===0?re-=G.TAB.length:oe-=G.TAB.length),Ne+=ae.length+1}),this.quill.update(T.default.sources.USER),this.quill.setSelection(re,oe,T.default.sources.SILENT)}}}}function K(D){return{key:D[0].toUpperCase(),shortKey:!0,handler:function(V,G){this.quill.format(D,!G.format[D],T.default.sources.USER)}}}function z(D){if(typeof D=="string"||typeof D=="number")return z({key:D});if((typeof D>"u"?"undefined":o(D))==="object"&&(D=(0,d.default)(D,!1)),typeof D.key=="string")if(F.keys[D.key.toUpperCase()]!=null)D.key=F.keys[D.key.toUpperCase()];else if(D.key.length===1)D.key=D.key.toUpperCase().charCodeAt(0);else return null;return D.shortKey&&(D[M]=D.shortKey,delete D.shortKey),D}n.default=F,n.SHORTKEY=M},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function y(p,g){var f=[],T=!0,S=!1,E=void 0;try{for(var k=p[Symbol.iterator](),P;!(T=(P=k.next()).done)&&(f.push(P.value),!(g&&f.length===g));T=!0);}catch(O){S=!0,E=O}finally{try{!T&&k.return&&k.return()}finally{if(S)throw E}}return f}return function(p,g){if(Array.isArray(p))return p;if(Symbol.iterator in Object(p))return y(p,g);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function y(p,g,f){p===null&&(p=Function.prototype);var T=Object.getOwnPropertyDescriptor(p,g);if(T===void 0){var S=Object.getPrototypeOf(p);return S===null?void 0:y(S,g,f)}else{if("value"in T)return T.value;var E=T.get;return E===void 0?void 0:E.call(f)}},c=function(){function y(p,g){for(var f=0;f<g.length;f++){var T=g[f];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(p,T.key,T)}}return function(p,g,f){return g&&y(p.prototype,g),f&&y(p,f),p}}(),u=r(0),d=l(u),m=r(7),h=l(m);function l(y){return y&&y.__esModule?y:{default:y}}function a(y,p){if(!(y instanceof p))throw new TypeError("Cannot call a class as a function")}function v(y,p){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:y}function b(y,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);y.prototype=Object.create(p&&p.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(y,p):y.__proto__=p)}var w=function(y){b(p,y),c(p,null,[{key:"value",value:function(){}}]);function p(g,f){a(this,p);var T=v(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,g));return T.selection=f,T.textNode=document.createTextNode(p.CONTENTS),T.domNode.appendChild(T.textNode),T._length=0,T}return c(p,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(f,T){if(this._length!==0)return s(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"format",this).call(this,f,T);for(var S=this,E=0;S!=null&&S.statics.scope!==d.default.Scope.BLOCK_BLOT;)E+=S.offset(S.parent),S=S.parent;S!=null&&(this._length=p.CONTENTS.length,S.optimize(),S.formatAt(E,p.CONTENTS.length,f,T),this._length=0)}},{key:"index",value:function(f,T){return f===this.textNode?0:s(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"index",this).call(this,f,T)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){s(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var f=this.textNode,T=this.selection.getNativeRange(),S=void 0,E=void 0,k=void 0;if(T!=null&&T.start.node===f&&T.end.node===f){var P=[f,T.start.offset,T.end.offset];S=P[0],E=P[1],k=P[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==p.CONTENTS){var O=this.textNode.data.split(p.CONTENTS).join("");this.next instanceof h.default?(S=this.next.domNode,this.next.insertAt(0,O),this.textNode.data=p.CONTENTS):(this.textNode.data=O,this.parent.insertBefore(d.default.create(this.textNode),this),this.textNode=document.createTextNode(p.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),E!=null){var x=[E,k].map(function(N){return Math.max(0,Math.min(S.data.length,N-1))}),I=o(x,2);return E=I[0],k=I[1],{startNode:S,startOffset:E,endNode:S,endOffset:k}}}}},{key:"update",value:function(f,T){var S=this;if(f.some(function(k){return k.type==="characterData"&&k.target===S.textNode})){var E=this.restore();E&&(T.range=E)}}},{key:"value",value:function(){return""}}]),p}(d.default.Embed);w.blotName="cursor",w.className="ql-cursor",w.tagName="span",w.CONTENTS="\uFEFF",n.default=w},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=r(0),s=d(o),c=r(4),u=d(c);function d(v){return v&&v.__esModule?v:{default:v}}function m(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}function h(v,b){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:v}function l(v,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);v.prototype=Object.create(b&&b.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(v,b):v.__proto__=b)}var a=function(v){l(b,v);function b(){return m(this,b),h(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return b}(s.default.Container);a.allowedChildren=[u.default,c.BlockEmbed,a],n.default=a},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.ColorStyle=n.ColorClass=n.ColorAttributor=void 0;var o=function(){function w(y,p){for(var g=0;g<p.length;g++){var f=p[g];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}return function(y,p,g){return p&&w(y.prototype,p),g&&w(y,g),y}}(),s=function w(y,p,g){y===null&&(y=Function.prototype);var f=Object.getOwnPropertyDescriptor(y,p);if(f===void 0){var T=Object.getPrototypeOf(y);return T===null?void 0:w(T,p,g)}else{if("value"in f)return f.value;var S=f.get;return S===void 0?void 0:S.call(g)}},c=r(0),u=d(c);function d(w){return w&&w.__esModule?w:{default:w}}function m(w,y){if(!(w instanceof y))throw new TypeError("Cannot call a class as a function")}function h(w,y){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:w}function l(w,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);w.prototype=Object.create(y&&y.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(w,y):w.__proto__=y)}var a=function(w){l(y,w);function y(){return m(this,y),h(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return o(y,[{key:"value",value:function(g){var f=s(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"value",this).call(this,g);return f.startsWith("rgb(")?(f=f.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+f.split(",").map(function(T){return("00"+parseInt(T).toString(16)).slice(-2)}).join("")):f}}]),y}(u.default.Attributor.Style),v=new u.default.Attributor.Class("color","ql-color",{scope:u.default.Scope.INLINE}),b=new a("color","color",{scope:u.default.Scope.INLINE});n.ColorAttributor=a,n.ColorClass=v,n.ColorStyle=b},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitize=n.default=void 0;var o=function(){function b(w,y){for(var p=0;p<y.length;p++){var g=y[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(w,g.key,g)}}return function(w,y,p){return y&&b(w.prototype,y),p&&b(w,p),w}}(),s=function b(w,y,p){w===null&&(w=Function.prototype);var g=Object.getOwnPropertyDescriptor(w,y);if(g===void 0){var f=Object.getPrototypeOf(w);return f===null?void 0:b(f,y,p)}else{if("value"in g)return g.value;var T=g.get;return T===void 0?void 0:T.call(p)}},c=r(6),u=d(c);function d(b){return b&&b.__esModule?b:{default:b}}function m(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}function h(b,w){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:b}function l(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(b,w):b.__proto__=w)}var a=function(b){l(w,b);function w(){return m(this,w),h(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return o(w,[{key:"format",value:function(p,g){if(p!==this.statics.blotName||!g)return s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"format",this).call(this,p,g);g=this.constructor.sanitize(g),this.domNode.setAttribute("href",g)}}],[{key:"create",value:function(p){var g=s(w.__proto__||Object.getPrototypeOf(w),"create",this).call(this,p);return p=this.sanitize(p),g.setAttribute("href",p),g.setAttribute("rel","noopener noreferrer"),g.setAttribute("target","_blank"),g}},{key:"formats",value:function(p){return p.getAttribute("href")}},{key:"sanitize",value:function(p){return v(p,this.PROTOCOL_WHITELIST)?p:this.SANITIZED_URL}}]),w}(u.default);a.blotName="link",a.tagName="A",a.SANITIZED_URL="about:blank",a.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function v(b,w){var y=document.createElement("a");y.href=b;var p=y.href.slice(0,y.href.indexOf(":"));return w.indexOf(p)>-1}n.default=a,n.sanitize=v},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},s=function(){function w(y,p){for(var g=0;g<p.length;g++){var f=p[g];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}return function(y,p,g){return p&&w(y.prototype,p),g&&w(y,g),y}}(),c=r(23),u=h(c),d=r(107),m=h(d);function h(w){return w&&w.__esModule?w:{default:w}}function l(w,y){if(!(w instanceof y))throw new TypeError("Cannot call a class as a function")}var a=0;function v(w,y){w.setAttribute(y,w.getAttribute(y)!=="true")}var b=function(){function w(y){var p=this;l(this,w),this.select=y,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){p.togglePicker()}),this.label.addEventListener("keydown",function(g){switch(g.keyCode){case u.default.keys.ENTER:p.togglePicker();break;case u.default.keys.ESCAPE:p.escape(),g.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return s(w,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),v(this.label,"aria-expanded"),v(this.options,"aria-hidden")}},{key:"buildItem",value:function(p){var g=this,f=document.createElement("span");return f.tabIndex="0",f.setAttribute("role","button"),f.classList.add("ql-picker-item"),p.hasAttribute("value")&&f.setAttribute("data-value",p.getAttribute("value")),p.textContent&&f.setAttribute("data-label",p.textContent),f.addEventListener("click",function(){g.selectItem(f,!0)}),f.addEventListener("keydown",function(T){switch(T.keyCode){case u.default.keys.ENTER:g.selectItem(f,!0),T.preventDefault();break;case u.default.keys.ESCAPE:g.escape(),T.preventDefault();break}}),f}},{key:"buildLabel",value:function(){var p=document.createElement("span");return p.classList.add("ql-picker-label"),p.innerHTML=m.default,p.tabIndex="0",p.setAttribute("role","button"),p.setAttribute("aria-expanded","false"),this.container.appendChild(p),p}},{key:"buildOptions",value:function(){var p=this,g=document.createElement("span");g.classList.add("ql-picker-options"),g.setAttribute("aria-hidden","true"),g.tabIndex="-1",g.id="ql-picker-options-"+a,a+=1,this.label.setAttribute("aria-controls",g.id),this.options=g,[].slice.call(this.select.options).forEach(function(f){var T=p.buildItem(f);g.appendChild(T),f.selected===!0&&p.selectItem(T)}),this.container.appendChild(g)}},{key:"buildPicker",value:function(){var p=this;[].slice.call(this.select.attributes).forEach(function(g){p.container.setAttribute(g.name,g.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var p=this;this.close(),setTimeout(function(){return p.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(p){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,f=this.container.querySelector(".ql-selected");if(p!==f&&(f!=null&&f.classList.remove("ql-selected"),p!=null&&(p.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(p.parentNode.children,p),p.hasAttribute("data-value")?this.label.setAttribute("data-value",p.getAttribute("data-value")):this.label.removeAttribute("data-value"),p.hasAttribute("data-label")?this.label.setAttribute("data-label",p.getAttribute("data-label")):this.label.removeAttribute("data-label"),g))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":o(Event))==="object"){var T=document.createEvent("Event");T.initEvent("change",!0,!0),this.select.dispatchEvent(T)}this.close()}}},{key:"update",value:function(){var p=void 0;if(this.select.selectedIndex>-1){var g=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];p=this.select.options[this.select.selectedIndex],this.selectItem(g)}else this.selectItem(null);var f=p!=null&&p!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",f)}}]),w}();n.default=b},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=r(0),s=R(o),c=r(5),u=R(c),d=r(4),m=R(d),h=r(16),l=R(h),a=r(25),v=R(a),b=r(24),w=R(b),y=r(35),p=R(y),g=r(6),f=R(g),T=r(22),S=R(T),E=r(7),k=R(E),P=r(55),O=R(P),x=r(42),I=R(x),N=r(23),_=R(N);function R(M){return M&&M.__esModule?M:{default:M}}u.default.register({"blots/block":m.default,"blots/block/embed":d.BlockEmbed,"blots/break":l.default,"blots/container":v.default,"blots/cursor":w.default,"blots/embed":p.default,"blots/inline":f.default,"blots/scroll":S.default,"blots/text":k.default,"modules/clipboard":O.default,"modules/history":I.default,"modules/keyboard":_.default}),s.default.register(m.default,l.default,w.default,f.default,S.default,k.default),n.default=u.default},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=r(1),s=function(){function c(u){this.domNode=u,this.domNode[o.DATA_KEY]={blot:this}}return Object.defineProperty(c.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),c.create=function(u){if(this.tagName==null)throw new o.ParchmentError("Blot definition missing tagName");var d;return Array.isArray(this.tagName)?(typeof u=="string"&&(u=u.toUpperCase(),parseInt(u).toString()===u&&(u=parseInt(u))),typeof u=="number"?d=document.createElement(this.tagName[u-1]):this.tagName.indexOf(u)>-1?d=document.createElement(u):d=document.createElement(this.tagName[0])):d=document.createElement(this.tagName),this.className&&d.classList.add(this.className),d},c.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},c.prototype.clone=function(){var u=this.domNode.cloneNode(!1);return o.create(u)},c.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[o.DATA_KEY]},c.prototype.deleteAt=function(u,d){var m=this.isolate(u,d);m.remove()},c.prototype.formatAt=function(u,d,m,h){var l=this.isolate(u,d);if(o.query(m,o.Scope.BLOT)!=null&&h)l.wrap(m,h);else if(o.query(m,o.Scope.ATTRIBUTE)!=null){var a=o.create(this.statics.scope);l.wrap(a),a.format(m,h)}},c.prototype.insertAt=function(u,d,m){var h=m==null?o.create("text",d):o.create(d,m),l=this.split(u);this.parent.insertBefore(h,l)},c.prototype.insertInto=function(u,d){d===void 0&&(d=null),this.parent!=null&&this.parent.children.remove(this);var m=null;u.children.insertBefore(this,d),d!=null&&(m=d.domNode),(this.domNode.parentNode!=u.domNode||this.domNode.nextSibling!=m)&&u.domNode.insertBefore(this.domNode,m),this.parent=u,this.attach()},c.prototype.isolate=function(u,d){var m=this.split(u);return m.split(d),m},c.prototype.length=function(){return 1},c.prototype.offset=function(u){return u===void 0&&(u=this.parent),this.parent==null||this==u?0:this.parent.children.offset(this)+this.parent.offset(u)},c.prototype.optimize=function(u){this.domNode[o.DATA_KEY]!=null&&delete this.domNode[o.DATA_KEY].mutations},c.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},c.prototype.replace=function(u){u.parent!=null&&(u.parent.insertBefore(this,u.next),u.remove())},c.prototype.replaceWith=function(u,d){var m=typeof u=="string"?o.create(u,d):u;return m.replace(this),m},c.prototype.split=function(u,d){return u===0?this:this.next},c.prototype.update=function(u,d){},c.prototype.wrap=function(u,d){var m=typeof u=="string"?o.create(u,d):u;return this.parent!=null&&this.parent.insertBefore(m,this.next),m.appendChild(this),m},c.blotName="abstract",c}();n.default=s},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=r(12),s=r(32),c=r(33),u=r(1),d=function(){function m(h){this.attributes={},this.domNode=h,this.build()}return m.prototype.attribute=function(h,l){l?h.add(this.domNode,l)&&(h.value(this.domNode)!=null?this.attributes[h.attrName]=h:delete this.attributes[h.attrName]):(h.remove(this.domNode),delete this.attributes[h.attrName])},m.prototype.build=function(){var h=this;this.attributes={};var l=o.default.keys(this.domNode),a=s.default.keys(this.domNode),v=c.default.keys(this.domNode);l.concat(a).concat(v).forEach(function(b){var w=u.query(b,u.Scope.ATTRIBUTE);w instanceof o.default&&(h.attributes[w.attrName]=w)})},m.prototype.copy=function(h){var l=this;Object.keys(this.attributes).forEach(function(a){var v=l.attributes[a].value(l.domNode);h.format(a,v)})},m.prototype.move=function(h){var l=this;this.copy(h),Object.keys(this.attributes).forEach(function(a){l.attributes[a].remove(l.domNode)}),this.attributes={}},m.prototype.values=function(){var h=this;return Object.keys(this.attributes).reduce(function(l,a){return l[a]=h.attributes[a].value(h.domNode),l},{})},m}();n.default=d},function(e,n,r){var o=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,h){m.__proto__=h}||function(m,h){for(var l in h)h.hasOwnProperty(l)&&(m[l]=h[l])};return function(m,h){d(m,h);function l(){this.constructor=m}m.prototype=h===null?Object.create(h):(l.prototype=h.prototype,new l)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=r(12);function c(d,m){var h=d.getAttribute("class")||"";return h.split(/\s+/).filter(function(l){return l.indexOf(m+"-")===0})}var u=function(d){o(m,d);function m(){return d!==null&&d.apply(this,arguments)||this}return m.keys=function(h){return(h.getAttribute("class")||"").split(/\s+/).map(function(l){return l.split("-").slice(0,-1).join("-")})},m.prototype.add=function(h,l){return this.canAdd(h,l)?(this.remove(h),h.classList.add(this.keyName+"-"+l),!0):!1},m.prototype.remove=function(h){var l=c(h,this.keyName);l.forEach(function(a){h.classList.remove(a)}),h.classList.length===0&&h.removeAttribute("class")},m.prototype.value=function(h){var l=c(h,this.keyName)[0]||"",a=l.slice(this.keyName.length+1);return this.canAdd(h,a)?a:""},m}(s.default);n.default=u},function(e,n,r){var o=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,h){m.__proto__=h}||function(m,h){for(var l in h)h.hasOwnProperty(l)&&(m[l]=h[l])};return function(m,h){d(m,h);function l(){this.constructor=m}m.prototype=h===null?Object.create(h):(l.prototype=h.prototype,new l)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=r(12);function c(d){var m=d.split("-"),h=m.slice(1).map(function(l){return l[0].toUpperCase()+l.slice(1)}).join("");return m[0]+h}var u=function(d){o(m,d);function m(){return d!==null&&d.apply(this,arguments)||this}return m.keys=function(h){return(h.getAttribute("style")||"").split(";").map(function(l){var a=l.split(":");return a[0].trim()})},m.prototype.add=function(h,l){return this.canAdd(h,l)?(h.style[c(this.keyName)]=l,!0):!1},m.prototype.remove=function(h){h.style[c(this.keyName)]="",h.getAttribute("style")||h.removeAttribute("style")},m.prototype.value=function(h){var l=h.style[c(this.keyName)];return this.canAdd(h,l)?l:""},m}(s.default);n.default=u},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function u(d,m){for(var h=0;h<m.length;h++){var l=m[h];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(d,l.key,l)}}return function(d,m,h){return m&&u(d.prototype,m),h&&u(d,h),d}}();function s(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}var c=function(){function u(d,m){s(this,u),this.quill=d,this.options=m,this.modules={}}return o(u,[{key:"init",value:function(){var m=this;Object.keys(this.options.modules).forEach(function(h){m.modules[h]==null&&m.addModule(h)})}},{key:"addModule",value:function(m){var h=this.quill.constructor.import("modules/"+m);return this.modules[m]=new h(this.quill,this.options.modules[m]||{}),this.modules[m]}}]),u}();c.DEFAULTS={modules:{}},c.themes={default:c},n.default=c},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function y(p,g){for(var f=0;f<g.length;f++){var T=g[f];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(p,T.key,T)}}return function(p,g,f){return g&&y(p.prototype,g),f&&y(p,f),p}}(),s=function y(p,g,f){p===null&&(p=Function.prototype);var T=Object.getOwnPropertyDescriptor(p,g);if(T===void 0){var S=Object.getPrototypeOf(p);return S===null?void 0:y(S,g,f)}else{if("value"in T)return T.value;var E=T.get;return E===void 0?void 0:E.call(f)}},c=r(0),u=h(c),d=r(7),m=h(d);function h(y){return y&&y.__esModule?y:{default:y}}function l(y,p){if(!(y instanceof p))throw new TypeError("Cannot call a class as a function")}function a(y,p){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:y}function v(y,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);y.prototype=Object.create(p&&p.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(y,p):y.__proto__=p)}var b="\uFEFF",w=function(y){v(p,y);function p(g){l(this,p);var f=a(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,g));return f.contentNode=document.createElement("span"),f.contentNode.setAttribute("contenteditable",!1),[].slice.call(f.domNode.childNodes).forEach(function(T){f.contentNode.appendChild(T)}),f.leftGuard=document.createTextNode(b),f.rightGuard=document.createTextNode(b),f.domNode.appendChild(f.leftGuard),f.domNode.appendChild(f.contentNode),f.domNode.appendChild(f.rightGuard),f}return o(p,[{key:"index",value:function(f,T){return f===this.leftGuard?0:f===this.rightGuard?1:s(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"index",this).call(this,f,T)}},{key:"restore",value:function(f){var T=void 0,S=void 0,E=f.data.split(b).join("");if(f===this.leftGuard)if(this.prev instanceof m.default){var k=this.prev.length();this.prev.insertAt(k,E),T={startNode:this.prev.domNode,startOffset:k+E.length}}else S=document.createTextNode(E),this.parent.insertBefore(u.default.create(S),this),T={startNode:S,startOffset:E.length};else f===this.rightGuard&&(this.next instanceof m.default?(this.next.insertAt(0,E),T={startNode:this.next.domNode,startOffset:E.length}):(S=document.createTextNode(E),this.parent.insertBefore(u.default.create(S),this.next),T={startNode:S,startOffset:E.length}));return f.data=b,T}},{key:"update",value:function(f,T){var S=this;f.forEach(function(E){if(E.type==="characterData"&&(E.target===S.leftGuard||E.target===S.rightGuard)){var k=S.restore(E.target);k&&(T.range=k)}})}}]),p}(u.default.Embed);n.default=w},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.AlignStyle=n.AlignClass=n.AlignAttribute=void 0;var o=r(0),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}var u={scope:s.default.Scope.BLOCK,whitelist:["right","center","justify"]},d=new s.default.Attributor.Attribute("align","align",u),m=new s.default.Attributor.Class("align","ql-align",u),h=new s.default.Attributor.Style("align","text-align",u);n.AlignAttribute=d,n.AlignClass=m,n.AlignStyle=h},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.BackgroundStyle=n.BackgroundClass=void 0;var o=r(0),s=u(o),c=r(26);function u(h){return h&&h.__esModule?h:{default:h}}var d=new s.default.Attributor.Class("background","ql-bg",{scope:s.default.Scope.INLINE}),m=new c.ColorAttributor("background","background-color",{scope:s.default.Scope.INLINE});n.BackgroundClass=d,n.BackgroundStyle=m},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.DirectionStyle=n.DirectionClass=n.DirectionAttribute=void 0;var o=r(0),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}var u={scope:s.default.Scope.BLOCK,whitelist:["rtl"]},d=new s.default.Attributor.Attribute("direction","dir",u),m=new s.default.Attributor.Class("direction","ql-direction",u),h=new s.default.Attributor.Style("direction","direction",u);n.DirectionAttribute=d,n.DirectionClass=m,n.DirectionStyle=h},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.FontClass=n.FontStyle=void 0;var o=function(){function y(p,g){for(var f=0;f<g.length;f++){var T=g[f];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(p,T.key,T)}}return function(p,g,f){return g&&y(p.prototype,g),f&&y(p,f),p}}(),s=function y(p,g,f){p===null&&(p=Function.prototype);var T=Object.getOwnPropertyDescriptor(p,g);if(T===void 0){var S=Object.getPrototypeOf(p);return S===null?void 0:y(S,g,f)}else{if("value"in T)return T.value;var E=T.get;return E===void 0?void 0:E.call(f)}},c=r(0),u=d(c);function d(y){return y&&y.__esModule?y:{default:y}}function m(y,p){if(!(y instanceof p))throw new TypeError("Cannot call a class as a function")}function h(y,p){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:y}function l(y,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);y.prototype=Object.create(p&&p.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(y,p):y.__proto__=p)}var a={scope:u.default.Scope.INLINE,whitelist:["serif","monospace"]},v=new u.default.Attributor.Class("font","ql-font",a),b=function(y){l(p,y);function p(){return m(this,p),h(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return o(p,[{key:"value",value:function(f){return s(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"value",this).call(this,f).replace(/["']/g,"")}}]),p}(u.default.Attributor.Style),w=new b("font","font-family",a);n.FontStyle=w,n.FontClass=v},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.SizeStyle=n.SizeClass=void 0;var o=r(0),s=c(o);function c(m){return m&&m.__esModule?m:{default:m}}var u=new s.default.Attributor.Class("size","ql-size",{scope:s.default.Scope.INLINE,whitelist:["small","large","huge"]}),d=new s.default.Attributor.Style("size","font-size",{scope:s.default.Scope.INLINE,whitelist:["10px","18px","32px"]});n.SizeClass=u,n.SizeStyle=d},function(e,n,r){e.exports={align:{"":r(76),center:r(77),right:r(78),justify:r(79)},background:r(80),blockquote:r(81),bold:r(82),clean:r(83),code:r(58),"code-block":r(58),color:r(84),direction:{"":r(85),rtl:r(86)},float:{center:r(87),full:r(88),left:r(89),right:r(90)},formula:r(91),header:{1:r(92),2:r(93)},italic:r(94),image:r(95),indent:{"+1":r(96),"-1":r(97)},link:r(98),list:{ordered:r(99),bullet:r(100),check:r(101)},script:{sub:r(102),super:r(103)},strike:r(104),underline:r(105),video:r(106)}},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.getLastChangeIndex=n.default=void 0;var o=function(){function g(f,T){for(var S=0;S<T.length;S++){var E=T[S];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}return function(f,T,S){return T&&g(f.prototype,T),S&&g(f,S),f}}(),s=r(0),c=l(s),u=r(5),d=l(u),m=r(9),h=l(m);function l(g){return g&&g.__esModule?g:{default:g}}function a(g,f){if(!(g instanceof f))throw new TypeError("Cannot call a class as a function")}function v(g,f){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:g}function b(g,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);g.prototype=Object.create(f&&f.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(g,f):g.__proto__=f)}var w=function(g){b(f,g);function f(T,S){a(this,f);var E=v(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,T,S));return E.lastRecorded=0,E.ignoreChange=!1,E.clear(),E.quill.on(d.default.events.EDITOR_CHANGE,function(k,P,O,x){k!==d.default.events.TEXT_CHANGE||E.ignoreChange||(!E.options.userOnly||x===d.default.sources.USER?E.record(P,O):E.transform(P))}),E.quill.keyboard.addBinding({key:"Z",shortKey:!0},E.undo.bind(E)),E.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},E.redo.bind(E)),/Win/i.test(navigator.platform)&&E.quill.keyboard.addBinding({key:"Y",shortKey:!0},E.redo.bind(E)),E}return o(f,[{key:"change",value:function(S,E){if(this.stack[S].length!==0){var k=this.stack[S].pop();this.stack[E].push(k),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(k[S],d.default.sources.USER),this.ignoreChange=!1;var P=p(k[S]);this.quill.setSelection(P)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(S,E){if(S.ops.length!==0){this.stack.redo=[];var k=this.quill.getContents().diff(E),P=Date.now();if(this.lastRecorded+this.options.delay>P&&this.stack.undo.length>0){var O=this.stack.undo.pop();k=k.compose(O.undo),S=O.redo.compose(S)}else this.lastRecorded=P;this.stack.undo.push({redo:S,undo:k}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(S){this.stack.undo.forEach(function(E){E.undo=S.transform(E.undo,!0),E.redo=S.transform(E.redo,!0)}),this.stack.redo.forEach(function(E){E.undo=S.transform(E.undo,!0),E.redo=S.transform(E.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),f}(h.default);w.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function y(g){var f=g.ops[g.ops.length-1];return f==null?!1:f.insert!=null?typeof f.insert=="string"&&f.insert.endsWith(`
`):f.attributes!=null?Object.keys(f.attributes).some(function(T){return c.default.query(T,c.default.Scope.BLOCK)!=null}):!1}function p(g){var f=g.reduce(function(S,E){return S+=E.delete||0,S},0),T=g.length()-f;return y(g)&&(T-=1),T}n.default=w,n.getLastChangeIndex=p},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var o=function(){function q(B,K){for(var z=0;z<K.length;z++){var D=K[z];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(B,D.key,D)}}return function(B,K,z){return K&&q(B.prototype,K),z&&q(B,z),B}}(),s=function q(B,K,z){B===null&&(B=Function.prototype);var D=Object.getOwnPropertyDescriptor(B,K);if(D===void 0){var U=Object.getPrototypeOf(B);return U===null?void 0:q(U,K,z)}else{if("value"in D)return D.value;var V=D.get;return V===void 0?void 0:V.call(z)}},c=r(3),u=P(c),d=r(2),m=P(d),h=r(8),l=P(h),a=r(23),v=P(a),b=r(34),w=P(b),y=r(59),p=P(y),g=r(60),f=P(g),T=r(28),S=P(T),E=r(61),k=P(E);function P(q){return q&&q.__esModule?q:{default:q}}function O(q,B){if(!(q instanceof B))throw new TypeError("Cannot call a class as a function")}function x(q,B){if(!q)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return B&&(typeof B=="object"||typeof B=="function")?B:q}function I(q,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);q.prototype=Object.create(B&&B.prototype,{constructor:{value:q,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(q,B):q.__proto__=B)}var N=[!1,"center","right","justify"],_=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],R=[!1,"serif","monospace"],M=["1","2","3",!1],F=["small",!1,"large","huge"],Y=function(q){I(B,q);function B(K,z){O(this,B);var D=x(this,(B.__proto__||Object.getPrototypeOf(B)).call(this,K,z)),U=function V(G){if(!document.body.contains(K.root))return document.body.removeEventListener("click",V);D.tooltip!=null&&!D.tooltip.root.contains(G.target)&&document.activeElement!==D.tooltip.textbox&&!D.quill.hasFocus()&&D.tooltip.hide(),D.pickers!=null&&D.pickers.forEach(function(re){re.container.contains(G.target)||re.close()})};return K.emitter.listenDOM("click",document.body,U),D}return o(B,[{key:"addModule",value:function(z){var D=s(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"addModule",this).call(this,z);return z==="toolbar"&&this.extendToolbar(D),D}},{key:"buildButtons",value:function(z,D){z.forEach(function(U){var V=U.getAttribute("class")||"";V.split(/\s+/).forEach(function(G){if(G.startsWith("ql-")&&(G=G.slice(3),D[G]!=null))if(G==="direction")U.innerHTML=D[G][""]+D[G].rtl;else if(typeof D[G]=="string")U.innerHTML=D[G];else{var re=U.value||"";re!=null&&D[G][re]&&(U.innerHTML=D[G][re])}})})}},{key:"buildPickers",value:function(z,D){var U=this;this.pickers=z.map(function(G){if(G.classList.contains("ql-align"))return G.querySelector("option")==null&&C(G,N),new f.default(G,D.align);if(G.classList.contains("ql-background")||G.classList.contains("ql-color")){var re=G.classList.contains("ql-background")?"background":"color";return G.querySelector("option")==null&&C(G,_,re==="background"?"#ffffff":"#000000"),new p.default(G,D[re])}else return G.querySelector("option")==null&&(G.classList.contains("ql-font")?C(G,R):G.classList.contains("ql-header")?C(G,M):G.classList.contains("ql-size")&&C(G,F)),new S.default(G)});var V=function(){U.pickers.forEach(function(re){re.update()})};this.quill.on(l.default.events.EDITOR_CHANGE,V)}}]),B}(w.default);Y.DEFAULTS=(0,u.default)(!0,{},w.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var B=this,K=this.container.querySelector("input.ql-image[type=file]");K==null&&(K=document.createElement("input"),K.setAttribute("type","file"),K.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),K.classList.add("ql-image"),K.addEventListener("change",function(){if(K.files!=null&&K.files[0]!=null){var z=new FileReader;z.onload=function(D){var U=B.quill.getSelection(!0);B.quill.updateContents(new m.default().retain(U.index).delete(U.length).insert({image:D.target.result}),l.default.sources.USER),B.quill.setSelection(U.index+1,l.default.sources.SILENT),K.value=""},z.readAsDataURL(K.files[0])}}),this.container.appendChild(K)),K.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var J=function(q){I(B,q);function B(K,z){O(this,B);var D=x(this,(B.__proto__||Object.getPrototypeOf(B)).call(this,K,z));return D.textbox=D.root.querySelector('input[type="text"]'),D.listen(),D}return o(B,[{key:"listen",value:function(){var z=this;this.textbox.addEventListener("keydown",function(D){v.default.match(D,"enter")?(z.save(),D.preventDefault()):v.default.match(D,"escape")&&(z.cancel(),D.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),D!=null?this.textbox.value=D:z!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+z)||""),this.root.setAttribute("data-mode",z)}},{key:"restoreFocus",value:function(){var z=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=z}},{key:"save",value:function(){var z=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var D=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",z,l.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",z,l.default.sources.USER)),this.quill.root.scrollTop=D;break}case"video":z=j(z);case"formula":{if(!z)break;var U=this.quill.getSelection(!0);if(U!=null){var V=U.index+U.length;this.quill.insertEmbed(V,this.root.getAttribute("data-mode"),z,l.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(V+1," ",l.default.sources.USER),this.quill.setSelection(V+2,l.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),B}(k.default);function j(q){var B=q.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||q.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return B?(B[1]||"https")+"://www.youtube.com/embed/"+B[2]+"?showinfo=0":(B=q.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(B[1]||"https")+"://player.vimeo.com/video/"+B[2]+"/":q}function C(q,B){var K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;B.forEach(function(z){var D=document.createElement("option");z===K?D.setAttribute("selected","selected"):D.setAttribute("value",z),q.appendChild(D)})}n.BaseTooltip=J,n.default=Y},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function s(){this.head=this.tail=null,this.length=0}return s.prototype.append=function(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];this.insertBefore(c[0],null),c.length>1&&this.append.apply(this,c.slice(1))},s.prototype.contains=function(c){for(var u,d=this.iterator();u=d();)if(u===c)return!0;return!1},s.prototype.insertBefore=function(c,u){c&&(c.next=u,u!=null?(c.prev=u.prev,u.prev!=null&&(u.prev.next=c),u.prev=c,u===this.head&&(this.head=c)):this.tail!=null?(this.tail.next=c,c.prev=this.tail,this.tail=c):(c.prev=null,this.head=this.tail=c),this.length+=1)},s.prototype.offset=function(c){for(var u=0,d=this.head;d!=null;){if(d===c)return u;u+=d.length(),d=d.next}return-1},s.prototype.remove=function(c){this.contains(c)&&(c.prev!=null&&(c.prev.next=c.next),c.next!=null&&(c.next.prev=c.prev),c===this.head&&(this.head=c.next),c===this.tail&&(this.tail=c.prev),this.length-=1)},s.prototype.iterator=function(c){return c===void 0&&(c=this.head),function(){var u=c;return c!=null&&(c=c.next),u}},s.prototype.find=function(c,u){u===void 0&&(u=!1);for(var d,m=this.iterator();d=m();){var h=d.length();if(c<h||u&&c===h&&(d.next==null||d.next.length()!==0))return[d,c];c-=h}return[null,0]},s.prototype.forEach=function(c){for(var u,d=this.iterator();u=d();)c(u)},s.prototype.forEachAt=function(c,u,d){if(!(u<=0))for(var m=this.find(c),h=m[0],l=m[1],a,v=c-l,b=this.iterator(h);(a=b())&&v<c+u;){var w=a.length();c>v?d(a,c-v,Math.min(u,v+w-c)):d(a,0,Math.min(w,c+u-v)),v+=w}},s.prototype.map=function(c){return this.reduce(function(u,d){return u.push(c(d)),u},[])},s.prototype.reduce=function(c,u){for(var d,m=this.iterator();d=m();)u=c(u,d);return u},s}();n.default=o},function(e,n,r){var o=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,a){l.__proto__=a}||function(l,a){for(var v in a)a.hasOwnProperty(v)&&(l[v]=a[v])};return function(l,a){h(l,a);function v(){this.constructor=l}l.prototype=a===null?Object.create(a):(v.prototype=a.prototype,new v)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=r(17),c=r(1),u={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},d=100,m=function(h){o(l,h);function l(a){var v=h.call(this,a)||this;return v.scroll=v,v.observer=new MutationObserver(function(b){v.update(b)}),v.observer.observe(v.domNode,u),v.attach(),v}return l.prototype.detach=function(){h.prototype.detach.call(this),this.observer.disconnect()},l.prototype.deleteAt=function(a,v){this.update(),a===0&&v===this.length()?this.children.forEach(function(b){b.remove()}):h.prototype.deleteAt.call(this,a,v)},l.prototype.formatAt=function(a,v,b,w){this.update(),h.prototype.formatAt.call(this,a,v,b,w)},l.prototype.insertAt=function(a,v,b){this.update(),h.prototype.insertAt.call(this,a,v,b)},l.prototype.optimize=function(a,v){var b=this;a===void 0&&(a=[]),v===void 0&&(v={}),h.prototype.optimize.call(this,v);for(var w=[].slice.call(this.observer.takeRecords());w.length>0;)a.push(w.pop());for(var y=function(T,S){S===void 0&&(S=!0),!(T==null||T===b)&&T.domNode.parentNode!=null&&(T.domNode[c.DATA_KEY].mutations==null&&(T.domNode[c.DATA_KEY].mutations=[]),S&&y(T.parent))},p=function(T){T.domNode[c.DATA_KEY]==null||T.domNode[c.DATA_KEY].mutations==null||(T instanceof s.default&&T.children.forEach(p),T.optimize(v))},g=a,f=0;g.length>0;f+=1){if(f>=d)throw new Error("[Parchment] Maximum optimize iterations reached");for(g.forEach(function(T){var S=c.find(T.target,!0);S!=null&&(S.domNode===T.target&&(T.type==="childList"?(y(c.find(T.previousSibling,!1)),[].forEach.call(T.addedNodes,function(E){var k=c.find(E,!1);y(k,!1),k instanceof s.default&&k.children.forEach(function(P){y(P,!1)})})):T.type==="attributes"&&y(S.prev)),y(S))}),this.children.forEach(p),g=[].slice.call(this.observer.takeRecords()),w=g.slice();w.length>0;)a.push(w.pop())}},l.prototype.update=function(a,v){var b=this;v===void 0&&(v={}),a=a||this.observer.takeRecords(),a.map(function(w){var y=c.find(w.target,!0);return y==null?null:y.domNode[c.DATA_KEY].mutations==null?(y.domNode[c.DATA_KEY].mutations=[w],y):(y.domNode[c.DATA_KEY].mutations.push(w),null)}).forEach(function(w){w==null||w===b||w.domNode[c.DATA_KEY]==null||w.update(w.domNode[c.DATA_KEY].mutations||[],v)}),this.domNode[c.DATA_KEY].mutations!=null&&h.prototype.update.call(this,this.domNode[c.DATA_KEY].mutations,v),this.optimize(a,v)},l.blotName="scroll",l.defaultChild="block",l.scope=c.Scope.BLOCK_BLOT,l.tagName="DIV",l}(s.default);n.default=m},function(e,n,r){var o=this&&this.__extends||function(){var m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,l){h.__proto__=l}||function(h,l){for(var a in l)l.hasOwnProperty(a)&&(h[a]=l[a])};return function(h,l){m(h,l);function a(){this.constructor=h}h.prototype=l===null?Object.create(l):(a.prototype=l.prototype,new a)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=r(18),c=r(1);function u(m,h){if(Object.keys(m).length!==Object.keys(h).length)return!1;for(var l in m)if(m[l]!==h[l])return!1;return!0}var d=function(m){o(h,m);function h(){return m!==null&&m.apply(this,arguments)||this}return h.formats=function(l){if(l.tagName!==h.tagName)return m.formats.call(this,l)},h.prototype.format=function(l,a){var v=this;l===this.statics.blotName&&!a?(this.children.forEach(function(b){b instanceof s.default||(b=b.wrap(h.blotName,!0)),v.attributes.copy(b)}),this.unwrap()):m.prototype.format.call(this,l,a)},h.prototype.formatAt=function(l,a,v,b){if(this.formats()[v]!=null||c.query(v,c.Scope.ATTRIBUTE)){var w=this.isolate(l,a);w.format(v,b)}else m.prototype.formatAt.call(this,l,a,v,b)},h.prototype.optimize=function(l){m.prototype.optimize.call(this,l);var a=this.formats();if(Object.keys(a).length===0)return this.unwrap();var v=this.next;v instanceof h&&v.prev===this&&u(a,v.formats())&&(v.moveChildren(this),v.remove())},h.blotName="inline",h.scope=c.Scope.INLINE_BLOT,h.tagName="SPAN",h}(s.default);n.default=d},function(e,n,r){var o=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,h){m.__proto__=h}||function(m,h){for(var l in h)h.hasOwnProperty(l)&&(m[l]=h[l])};return function(m,h){d(m,h);function l(){this.constructor=m}m.prototype=h===null?Object.create(h):(l.prototype=h.prototype,new l)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=r(18),c=r(1),u=function(d){o(m,d);function m(){return d!==null&&d.apply(this,arguments)||this}return m.formats=function(h){var l=c.query(m.blotName).tagName;if(h.tagName!==l)return d.formats.call(this,h)},m.prototype.format=function(h,l){c.query(h,c.Scope.BLOCK)!=null&&(h===this.statics.blotName&&!l?this.replaceWith(m.blotName):d.prototype.format.call(this,h,l))},m.prototype.formatAt=function(h,l,a,v){c.query(a,c.Scope.BLOCK)!=null?this.format(a,v):d.prototype.formatAt.call(this,h,l,a,v)},m.prototype.insertAt=function(h,l,a){if(a==null||c.query(l,c.Scope.INLINE)!=null)d.prototype.insertAt.call(this,h,l,a);else{var v=this.split(h),b=c.create(l,a);v.parent.insertBefore(b,v)}},m.prototype.update=function(h,l){navigator.userAgent.match(/Trident/)?this.build():d.prototype.update.call(this,h,l)},m.blotName="block",m.scope=c.Scope.BLOCK_BLOT,m.tagName="P",m}(s.default);n.default=u},function(e,n,r){var o=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,m){d.__proto__=m}||function(d,m){for(var h in m)m.hasOwnProperty(h)&&(d[h]=m[h])};return function(d,m){u(d,m);function h(){this.constructor=d}d.prototype=m===null?Object.create(m):(h.prototype=m.prototype,new h)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=r(19),c=function(u){o(d,u);function d(){return u!==null&&u.apply(this,arguments)||this}return d.formats=function(m){},d.prototype.format=function(m,h){u.prototype.formatAt.call(this,0,this.length(),m,h)},d.prototype.formatAt=function(m,h,l,a){m===0&&h===this.length()?this.format(l,a):u.prototype.formatAt.call(this,m,h,l,a)},d.prototype.formats=function(){return this.statics.formats(this.domNode)},d}(s.default);n.default=c},function(e,n,r){var o=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,h){m.__proto__=h}||function(m,h){for(var l in h)h.hasOwnProperty(l)&&(m[l]=h[l])};return function(m,h){d(m,h);function l(){this.constructor=m}m.prototype=h===null?Object.create(h):(l.prototype=h.prototype,new l)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=r(19),c=r(1),u=function(d){o(m,d);function m(h){var l=d.call(this,h)||this;return l.text=l.statics.value(l.domNode),l}return m.create=function(h){return document.createTextNode(h)},m.value=function(h){var l=h.data;return l.normalize&&(l=l.normalize()),l},m.prototype.deleteAt=function(h,l){this.domNode.data=this.text=this.text.slice(0,h)+this.text.slice(h+l)},m.prototype.index=function(h,l){return this.domNode===h?l:-1},m.prototype.insertAt=function(h,l,a){a==null?(this.text=this.text.slice(0,h)+l+this.text.slice(h),this.domNode.data=this.text):d.prototype.insertAt.call(this,h,l,a)},m.prototype.length=function(){return this.text.length},m.prototype.optimize=function(h){d.prototype.optimize.call(this,h),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof m&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},m.prototype.position=function(h,l){return[this.domNode,h]},m.prototype.split=function(h,l){if(l===void 0&&(l=!1),!l){if(h===0)return this;if(h===this.length())return this.next}var a=c.create(this.domNode.splitText(h));return this.parent.insertBefore(a,this.next),this.text=this.statics.value(this.domNode),a},m.prototype.update=function(h,l){var a=this;h.some(function(v){return v.type==="characterData"&&v.target===a.domNode})&&(this.text=this.statics.value(this.domNode))},m.prototype.value=function(){return this.text},m.blotName="text",m.scope=c.Scope.INLINE_BLOT,m}(s.default);n.default=u},function(e,n,r){var o=document.createElement("div");if(o.classList.toggle("test-class",!1),o.classList.contains("test-class")){var s=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(c,u){return arguments.length>1&&!this.contains(c)==!u?u:s.call(this,c)}}String.prototype.startsWith||(String.prototype.startsWith=function(c,u){return u=u||0,this.substr(u,c.length)===c}),String.prototype.endsWith||(String.prototype.endsWith=function(c,u){var d=this.toString();(typeof u!="number"||!isFinite(u)||Math.floor(u)!==u||u>d.length)&&(u=d.length),u-=c.length;var m=d.indexOf(c,u);return m!==-1&&m===u}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(u){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof u!="function")throw new TypeError("predicate must be a function");for(var d=Object(this),m=d.length>>>0,h=arguments[1],l,a=0;a<m;a++)if(l=d[a],u.call(h,l,a,d))return l}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(e,n){var r=-1,o=1,s=0;function c(f,T,S){if(f==T)return f?[[s,f]]:[];(S<0||f.length<S)&&(S=null);var E=h(f,T),k=f.substring(0,E);f=f.substring(E),T=T.substring(E),E=l(f,T);var P=f.substring(f.length-E);f=f.substring(0,f.length-E),T=T.substring(0,T.length-E);var O=u(f,T);return k&&O.unshift([s,k]),P&&O.push([s,P]),v(O),S!=null&&(O=y(O,S)),O=p(O),O}function u(f,T){var S;if(!f)return[[o,T]];if(!T)return[[r,f]];var E=f.length>T.length?f:T,k=f.length>T.length?T:f,P=E.indexOf(k);if(P!=-1)return S=[[o,E.substring(0,P)],[s,k],[o,E.substring(P+k.length)]],f.length>T.length&&(S[0][0]=S[2][0]=r),S;if(k.length==1)return[[r,f],[o,T]];var O=a(f,T);if(O){var x=O[0],I=O[1],N=O[2],_=O[3],R=O[4],M=c(x,N),F=c(I,_);return M.concat([[s,R]],F)}return d(f,T)}function d(f,T){for(var S=f.length,E=T.length,k=Math.ceil((S+E)/2),P=k,O=2*k,x=new Array(O),I=new Array(O),N=0;N<O;N++)x[N]=-1,I[N]=-1;x[P+1]=0,I[P+1]=0;for(var _=S-E,R=_%2!=0,M=0,F=0,Y=0,J=0,j=0;j<k;j++){for(var C=-j+M;C<=j-F;C+=2){var q=P+C,B;C==-j||C!=j&&x[q-1]<x[q+1]?B=x[q+1]:B=x[q-1]+1;for(var K=B-C;B<S&&K<E&&f.charAt(B)==T.charAt(K);)B++,K++;if(x[q]=B,B>S)F+=2;else if(K>E)M+=2;else if(R){var z=P+_-C;if(z>=0&&z<O&&I[z]!=-1){var D=S-I[z];if(B>=D)return m(f,T,B,K)}}}for(var U=-j+Y;U<=j-J;U+=2){var z=P+U,D;U==-j||U!=j&&I[z-1]<I[z+1]?D=I[z+1]:D=I[z-1]+1;for(var V=D-U;D<S&&V<E&&f.charAt(S-D-1)==T.charAt(E-V-1);)D++,V++;if(I[z]=D,D>S)J+=2;else if(V>E)Y+=2;else if(!R){var q=P+_-U;if(q>=0&&q<O&&x[q]!=-1){var B=x[q],K=P+B-q;if(D=S-D,B>=D)return m(f,T,B,K)}}}}return[[r,f],[o,T]]}function m(f,T,S,E){var k=f.substring(0,S),P=T.substring(0,E),O=f.substring(S),x=T.substring(E),I=c(k,P),N=c(O,x);return I.concat(N)}function h(f,T){if(!f||!T||f.charAt(0)!=T.charAt(0))return 0;for(var S=0,E=Math.min(f.length,T.length),k=E,P=0;S<k;)f.substring(P,k)==T.substring(P,k)?(S=k,P=S):E=k,k=Math.floor((E-S)/2+S);return k}function l(f,T){if(!f||!T||f.charAt(f.length-1)!=T.charAt(T.length-1))return 0;for(var S=0,E=Math.min(f.length,T.length),k=E,P=0;S<k;)f.substring(f.length-k,f.length-P)==T.substring(T.length-k,T.length-P)?(S=k,P=S):E=k,k=Math.floor((E-S)/2+S);return k}function a(f,T){var S=f.length>T.length?f:T,E=f.length>T.length?T:f;if(S.length<4||E.length*2<S.length)return null;function k(F,Y,J){for(var j=F.substring(J,J+Math.floor(F.length/4)),C=-1,q="",B,K,z,D;(C=Y.indexOf(j,C+1))!=-1;){var U=h(F.substring(J),Y.substring(C)),V=l(F.substring(0,J),Y.substring(0,C));q.length<V+U&&(q=Y.substring(C-V,C)+Y.substring(C,C+U),B=F.substring(0,J-V),K=F.substring(J+U),z=Y.substring(0,C-V),D=Y.substring(C+U))}return q.length*2>=F.length?[B,K,z,D,q]:null}var P=k(S,E,Math.ceil(S.length/4)),O=k(S,E,Math.ceil(S.length/2)),x;if(!P&&!O)return null;O?P?x=P[4].length>O[4].length?P:O:x=O:x=P;var I,N,_,R;f.length>T.length?(I=x[0],N=x[1],_=x[2],R=x[3]):(_=x[0],R=x[1],I=x[2],N=x[3]);var M=x[4];return[I,N,_,R,M]}function v(f){f.push([s,""]);for(var T=0,S=0,E=0,k="",P="",O;T<f.length;)switch(f[T][0]){case o:E++,P+=f[T][1],T++;break;case r:S++,k+=f[T][1],T++;break;case s:S+E>1?(S!==0&&E!==0&&(O=h(P,k),O!==0&&(T-S-E>0&&f[T-S-E-1][0]==s?f[T-S-E-1][1]+=P.substring(0,O):(f.splice(0,0,[s,P.substring(0,O)]),T++),P=P.substring(O),k=k.substring(O)),O=l(P,k),O!==0&&(f[T][1]=P.substring(P.length-O)+f[T][1],P=P.substring(0,P.length-O),k=k.substring(0,k.length-O))),S===0?f.splice(T-E,S+E,[o,P]):E===0?f.splice(T-S,S+E,[r,k]):f.splice(T-S-E,S+E,[r,k],[o,P]),T=T-S-E+(S?1:0)+(E?1:0)+1):T!==0&&f[T-1][0]==s?(f[T-1][1]+=f[T][1],f.splice(T,1)):T++,E=0,S=0,k="",P="";break}f[f.length-1][1]===""&&f.pop();var x=!1;for(T=1;T<f.length-1;)f[T-1][0]==s&&f[T+1][0]==s&&(f[T][1].substring(f[T][1].length-f[T-1][1].length)==f[T-1][1]?(f[T][1]=f[T-1][1]+f[T][1].substring(0,f[T][1].length-f[T-1][1].length),f[T+1][1]=f[T-1][1]+f[T+1][1],f.splice(T-1,1),x=!0):f[T][1].substring(0,f[T+1][1].length)==f[T+1][1]&&(f[T-1][1]+=f[T+1][1],f[T][1]=f[T][1].substring(f[T+1][1].length)+f[T+1][1],f.splice(T+1,1),x=!0)),T++;x&&v(f)}var b=c;b.INSERT=o,b.DELETE=r,b.EQUAL=s,e.exports=b;function w(f,T){if(T===0)return[s,f];for(var S=0,E=0;E<f.length;E++){var k=f[E];if(k[0]===r||k[0]===s){var P=S+k[1].length;if(T===P)return[E+1,f];if(T<P){f=f.slice();var O=T-S,x=[k[0],k[1].slice(0,O)],I=[k[0],k[1].slice(O)];return f.splice(E,1,x,I),[E+1,f]}else S=P}}throw new Error("cursor_pos is out of bounds!")}function y(f,T){var S=w(f,T),E=S[1],k=S[0],P=E[k],O=E[k+1];if(P==null)return f;if(P[0]!==s)return f;if(O!=null&&P[1]+O[1]===O[1]+P[1])return E.splice(k,2,O,P),g(E,k,2);if(O!=null&&O[1].indexOf(P[1])===0){E.splice(k,2,[O[0],P[1]],[0,P[1]]);var x=O[1].slice(P[1].length);return x.length>0&&E.splice(k+2,0,[O[0],x]),g(E,k,3)}else return f}function p(f){for(var T=!1,S=function(O){return O.charCodeAt(0)>=56320&&O.charCodeAt(0)<=57343},E=function(O){return O.charCodeAt(O.length-1)>=55296&&O.charCodeAt(O.length-1)<=56319},k=2;k<f.length;k+=1)f[k-2][0]===s&&E(f[k-2][1])&&f[k-1][0]===r&&S(f[k-1][1])&&f[k][0]===o&&S(f[k][1])&&(T=!0,f[k-1][1]=f[k-2][1].slice(-1)+f[k-1][1],f[k][1]=f[k-2][1].slice(-1)+f[k][1],f[k-2][1]=f[k-2][1].slice(0,-1));if(!T)return f;for(var P=[],k=0;k<f.length;k+=1)f[k][1].length>0&&P.push(f[k]);return P}function g(f,T,S){for(var E=T+S-1;E>=0&&E>=T-1;E--)if(E+1<f.length){var k=f[E],P=f[E+1];k[0]===P[1]&&f.splice(E,2,[k[0],k[1]+P[1]])}return f}},function(e,n){n=e.exports=typeof Object.keys=="function"?Object.keys:r,n.shim=r;function r(o){var s=[];for(var c in o)s.push(c);return s}},function(e,n){var r=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";n=e.exports=r?o:s,n.supported=o;function o(c){return Object.prototype.toString.call(c)=="[object Arguments]"}n.unsupported=s;function s(c){return c&&typeof c=="object"&&typeof c.length=="number"&&Object.prototype.hasOwnProperty.call(c,"callee")&&!Object.prototype.propertyIsEnumerable.call(c,"callee")||!1}},function(e,n){var r=Object.prototype.hasOwnProperty,o="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(o=!1));function c(d,m,h){this.fn=d,this.context=m,this.once=h||!1}function u(){this._events=new s,this._eventsCount=0}u.prototype.eventNames=function(){var m=[],h,l;if(this._eventsCount===0)return m;for(l in h=this._events)r.call(h,l)&&m.push(o?l.slice(1):l);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(h)):m},u.prototype.listeners=function(m,h){var l=o?o+m:m,a=this._events[l];if(h)return!!a;if(!a)return[];if(a.fn)return[a.fn];for(var v=0,b=a.length,w=new Array(b);v<b;v++)w[v]=a[v].fn;return w},u.prototype.emit=function(m,h,l,a,v,b){var w=o?o+m:m;if(!this._events[w])return!1;var y=this._events[w],p=arguments.length,g,f;if(y.fn){switch(y.once&&this.removeListener(m,y.fn,void 0,!0),p){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,h),!0;case 3:return y.fn.call(y.context,h,l),!0;case 4:return y.fn.call(y.context,h,l,a),!0;case 5:return y.fn.call(y.context,h,l,a,v),!0;case 6:return y.fn.call(y.context,h,l,a,v,b),!0}for(f=1,g=new Array(p-1);f<p;f++)g[f-1]=arguments[f];y.fn.apply(y.context,g)}else{var T=y.length,S;for(f=0;f<T;f++)switch(y[f].once&&this.removeListener(m,y[f].fn,void 0,!0),p){case 1:y[f].fn.call(y[f].context);break;case 2:y[f].fn.call(y[f].context,h);break;case 3:y[f].fn.call(y[f].context,h,l);break;case 4:y[f].fn.call(y[f].context,h,l,a);break;default:if(!g)for(S=1,g=new Array(p-1);S<p;S++)g[S-1]=arguments[S];y[f].fn.apply(y[f].context,g)}}return!0},u.prototype.on=function(m,h,l){var a=new c(h,l||this),v=o?o+m:m;return this._events[v]?this._events[v].fn?this._events[v]=[this._events[v],a]:this._events[v].push(a):(this._events[v]=a,this._eventsCount++),this},u.prototype.once=function(m,h,l){var a=new c(h,l||this,!0),v=o?o+m:m;return this._events[v]?this._events[v].fn?this._events[v]=[this._events[v],a]:this._events[v].push(a):(this._events[v]=a,this._eventsCount++),this},u.prototype.removeListener=function(m,h,l,a){var v=o?o+m:m;if(!this._events[v])return this;if(!h)return--this._eventsCount===0?this._events=new s:delete this._events[v],this;var b=this._events[v];if(b.fn)b.fn===h&&(!a||b.once)&&(!l||b.context===l)&&(--this._eventsCount===0?this._events=new s:delete this._events[v]);else{for(var w=0,y=[],p=b.length;w<p;w++)(b[w].fn!==h||a&&!b[w].once||l&&b[w].context!==l)&&y.push(b[w]);y.length?this._events[v]=y.length===1?y[0]:y:--this._eventsCount===0?this._events=new s:delete this._events[v]}return this},u.prototype.removeAllListeners=function(m){var h;return m?(h=o?o+m:m,this._events[h]&&(--this._eventsCount===0?this._events=new s:delete this._events[h])):(this._events=new s,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prototype.setMaxListeners=function(){return this},u.prefixed=o,u.EventEmitter=u,typeof e<"u"&&(e.exports=u)},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(X){return typeof X}:function(X){return X&&typeof Symbol=="function"&&X.constructor===Symbol&&X!==Symbol.prototype?"symbol":typeof X},s=function(){function X(ee,ae){var ce=[],ie=!0,we=!1,pe=void 0;try{for(var Ae=ee[Symbol.iterator](),je;!(ie=(je=Ae.next()).done)&&(ce.push(je.value),!(ae&&ce.length===ae));ie=!0);}catch(ze){we=!0,pe=ze}finally{try{!ie&&Ae.return&&Ae.return()}finally{if(we)throw pe}}return ce}return function(ee,ae){if(Array.isArray(ee))return ee;if(Symbol.iterator in Object(ee))return X(ee,ae);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function X(ee,ae){for(var ce=0;ce<ae.length;ce++){var ie=ae[ce];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(ee,ie.key,ie)}}return function(ee,ae,ce){return ae&&X(ee.prototype,ae),ce&&X(ee,ce),ee}}(),u=r(3),d=I(u),m=r(2),h=I(m),l=r(0),a=I(l),v=r(5),b=I(v),w=r(10),y=I(w),p=r(9),g=I(p),f=r(36),T=r(37),S=r(13),E=I(S),k=r(26),P=r(38),O=r(39),x=r(40);function I(X){return X&&X.__esModule?X:{default:X}}function N(X,ee,ae){return ee in X?Object.defineProperty(X,ee,{value:ae,enumerable:!0,configurable:!0,writable:!0}):X[ee]=ae,X}function _(X,ee){if(!(X instanceof ee))throw new TypeError("Cannot call a class as a function")}function R(X,ee){if(!X)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ee&&(typeof ee=="object"||typeof ee=="function")?ee:X}function M(X,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ee);X.prototype=Object.create(ee&&ee.prototype,{constructor:{value:X,enumerable:!1,writable:!0,configurable:!0}}),ee&&(Object.setPrototypeOf?Object.setPrototypeOf(X,ee):X.__proto__=ee)}var F=(0,y.default)("quill:clipboard"),Y="__ql-matcher",J=[[Node.TEXT_NODE,$e],[Node.TEXT_NODE,ye],["br",oe],[Node.ELEMENT_NODE,ye],[Node.ELEMENT_NODE,re],[Node.ELEMENT_NODE,Ne],[Node.ELEMENT_NODE,G],[Node.ELEMENT_NODE,Ke],["li",ve],["b",V.bind(V,"bold")],["i",V.bind(V,"italic")],["style",ge]],j=[f.AlignAttribute,P.DirectionAttribute].reduce(function(X,ee){return X[ee.keyName]=ee,X},{}),C=[f.AlignStyle,T.BackgroundStyle,k.ColorStyle,P.DirectionStyle,O.FontStyle,x.SizeStyle].reduce(function(X,ee){return X[ee.keyName]=ee,X},{}),q=function(X){M(ee,X);function ee(ae,ce){_(this,ee);var ie=R(this,(ee.__proto__||Object.getPrototypeOf(ee)).call(this,ae,ce));return ie.quill.root.addEventListener("paste",ie.onPaste.bind(ie)),ie.container=ie.quill.addContainer("ql-clipboard"),ie.container.setAttribute("contenteditable",!0),ie.container.setAttribute("tabindex",-1),ie.matchers=[],J.concat(ie.options.matchers).forEach(function(we){var pe=s(we,2),Ae=pe[0],je=pe[1];!ce.matchVisual&&je===Ne||ie.addMatcher(Ae,je)}),ie}return c(ee,[{key:"addMatcher",value:function(ce,ie){this.matchers.push([ce,ie])}},{key:"convert",value:function(ce){if(typeof ce=="string")return this.container.innerHTML=ce.replace(/\>\r?\n +\</g,"><"),this.convert();var ie=this.quill.getFormat(this.quill.selection.savedRange.index);if(ie[E.default.blotName]){var we=this.container.innerText;return this.container.innerHTML="",new h.default().insert(we,N({},E.default.blotName,ie[E.default.blotName]))}var pe=this.prepareMatching(),Ae=s(pe,2),je=Ae[0],ze=Ae[1],ke=U(this.container,je,ze);return z(ke,`
`)&&ke.ops[ke.ops.length-1].attributes==null&&(ke=ke.compose(new h.default().retain(ke.length()-1).delete(1))),F.log("convert",this.container.innerHTML,ke),this.container.innerHTML="",ke}},{key:"dangerouslyPasteHTML",value:function(ce,ie){var we=arguments.length>2&&arguments[2]!==void 0?arguments[2]:b.default.sources.API;if(typeof ce=="string")this.quill.setContents(this.convert(ce),ie),this.quill.setSelection(0,b.default.sources.SILENT);else{var pe=this.convert(ie);this.quill.updateContents(new h.default().retain(ce).concat(pe),we),this.quill.setSelection(ce+pe.length(),b.default.sources.SILENT)}}},{key:"onPaste",value:function(ce){var ie=this;if(!(ce.defaultPrevented||!this.quill.isEnabled())){var we=this.quill.getSelection(),pe=new h.default().retain(we.index),Ae=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(b.default.sources.SILENT),setTimeout(function(){pe=pe.concat(ie.convert()).delete(we.length),ie.quill.updateContents(pe,b.default.sources.USER),ie.quill.setSelection(pe.length()-we.length,b.default.sources.SILENT),ie.quill.scrollingContainer.scrollTop=Ae,ie.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var ce=this,ie=[],we=[];return this.matchers.forEach(function(pe){var Ae=s(pe,2),je=Ae[0],ze=Ae[1];switch(je){case Node.TEXT_NODE:we.push(ze);break;case Node.ELEMENT_NODE:ie.push(ze);break;default:[].forEach.call(ce.container.querySelectorAll(je),function(ke){ke[Y]=ke[Y]||[],ke[Y].push(ze)});break}}),[ie,we]}}]),ee}(g.default);q.DEFAULTS={matchers:[],matchVisual:!0};function B(X,ee,ae){return(typeof ee>"u"?"undefined":o(ee))==="object"?Object.keys(ee).reduce(function(ce,ie){return B(ce,ie,ee[ie])},X):X.reduce(function(ce,ie){return ie.attributes&&ie.attributes[ee]?ce.push(ie):ce.insert(ie.insert,(0,d.default)({},N({},ee,ae),ie.attributes))},new h.default)}function K(X){if(X.nodeType!==Node.ELEMENT_NODE)return{};var ee="__ql-computed-style";return X[ee]||(X[ee]=window.getComputedStyle(X))}function z(X,ee){for(var ae="",ce=X.ops.length-1;ce>=0&&ae.length<ee.length;--ce){var ie=X.ops[ce];if(typeof ie.insert!="string")break;ae=ie.insert+ae}return ae.slice(-1*ee.length)===ee}function D(X){if(X.childNodes.length===0)return!1;var ee=K(X);return["block","list-item"].indexOf(ee.display)>-1}function U(X,ee,ae){return X.nodeType===X.TEXT_NODE?ae.reduce(function(ce,ie){return ie(X,ce)},new h.default):X.nodeType===X.ELEMENT_NODE?[].reduce.call(X.childNodes||[],function(ce,ie){var we=U(ie,ee,ae);return ie.nodeType===X.ELEMENT_NODE&&(we=ee.reduce(function(pe,Ae){return Ae(ie,pe)},we),we=(ie[Y]||[]).reduce(function(pe,Ae){return Ae(ie,pe)},we)),ce.concat(we)},new h.default):new h.default}function V(X,ee,ae){return B(ae,X,!0)}function G(X,ee){var ae=a.default.Attributor.Attribute.keys(X),ce=a.default.Attributor.Class.keys(X),ie=a.default.Attributor.Style.keys(X),we={};return ae.concat(ce).concat(ie).forEach(function(pe){var Ae=a.default.query(pe,a.default.Scope.ATTRIBUTE);Ae!=null&&(we[Ae.attrName]=Ae.value(X),we[Ae.attrName])||(Ae=j[pe],Ae!=null&&(Ae.attrName===pe||Ae.keyName===pe)&&(we[Ae.attrName]=Ae.value(X)||void 0),Ae=C[pe],Ae!=null&&(Ae.attrName===pe||Ae.keyName===pe)&&(Ae=C[pe],we[Ae.attrName]=Ae.value(X)||void 0))}),Object.keys(we).length>0&&(ee=B(ee,we)),ee}function re(X,ee){var ae=a.default.query(X);if(ae==null)return ee;if(ae.prototype instanceof a.default.Embed){var ce={},ie=ae.value(X);ie!=null&&(ce[ae.blotName]=ie,ee=new h.default().insert(ce,ae.formats(X)))}else typeof ae.formats=="function"&&(ee=B(ee,ae.blotName,ae.formats(X)));return ee}function oe(X,ee){return z(ee,`
`)||ee.insert(`
`),ee}function ge(){return new h.default}function ve(X,ee){var ae=a.default.query(X);if(ae==null||ae.blotName!=="list-item"||!z(ee,`
`))return ee;for(var ce=-1,ie=X.parentNode;!ie.classList.contains("ql-clipboard");)(a.default.query(ie)||{}).blotName==="list"&&(ce+=1),ie=ie.parentNode;return ce<=0?ee:ee.compose(new h.default().retain(ee.length()-1).retain(1,{indent:ce}))}function ye(X,ee){return z(ee,`
`)||(D(X)||ee.length()>0&&X.nextSibling&&D(X.nextSibling))&&ee.insert(`
`),ee}function Ne(X,ee){if(D(X)&&X.nextElementSibling!=null&&!z(ee,`

`)){var ae=X.offsetHeight+parseFloat(K(X).marginTop)+parseFloat(K(X).marginBottom);X.nextElementSibling.offsetTop>X.offsetTop+ae*1.5&&ee.insert(`
`)}return ee}function Ke(X,ee){var ae={},ce=X.style||{};return ce.fontStyle&&K(X).fontStyle==="italic"&&(ae.italic=!0),ce.fontWeight&&(K(X).fontWeight.startsWith("bold")||parseInt(K(X).fontWeight)>=700)&&(ae.bold=!0),Object.keys(ae).length>0&&(ee=B(ee,ae)),parseFloat(ce.textIndent||0)>0&&(ee=new h.default().insert("	").concat(ee)),ee}function $e(X,ee){var ae=X.data;if(X.parentNode.tagName==="O:P")return ee.insert(ae.trim());if(ae.trim().length===0&&X.parentNode.classList.contains("ql-clipboard"))return ee;if(!K(X.parentNode).whiteSpace.startsWith("pre")){var ce=function(we,pe){return pe=pe.replace(/[^\u00a0]/g,""),pe.length<1&&we?" ":pe};ae=ae.replace(/\r\n/g," ").replace(/\n/g," "),ae=ae.replace(/\s\s+/g,ce.bind(ce,!0)),(X.previousSibling==null&&D(X.parentNode)||X.previousSibling!=null&&D(X.previousSibling))&&(ae=ae.replace(/^\s+/,ce.bind(ce,!1))),(X.nextSibling==null&&D(X.parentNode)||X.nextSibling!=null&&D(X.nextSibling))&&(ae=ae.replace(/\s+$/,ce.bind(ce,!1)))}return ee.insert(ae)}n.default=q,n.matchAttributor=G,n.matchBlot=re,n.matchNewline=ye,n.matchSpacing=Ne,n.matchText=$e},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function v(b,w){for(var y=0;y<w.length;y++){var p=w[y];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(b,p.key,p)}}return function(b,w,y){return w&&v(b.prototype,w),y&&v(b,y),b}}(),s=function v(b,w,y){b===null&&(b=Function.prototype);var p=Object.getOwnPropertyDescriptor(b,w);if(p===void 0){var g=Object.getPrototypeOf(b);return g===null?void 0:v(g,w,y)}else{if("value"in p)return p.value;var f=p.get;return f===void 0?void 0:f.call(y)}},c=r(6),u=d(c);function d(v){return v&&v.__esModule?v:{default:v}}function m(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}function h(v,b){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:v}function l(v,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);v.prototype=Object.create(b&&b.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(v,b):v.__proto__=b)}var a=function(v){l(b,v);function b(){return m(this,b),h(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return o(b,[{key:"optimize",value:function(y){s(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"optimize",this).call(this,y),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return s(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),b}(u.default);a.blotName="bold",a.tagName=["STRONG","B"],n.default=a},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var o=function(){function x(I,N){var _=[],R=!0,M=!1,F=void 0;try{for(var Y=I[Symbol.iterator](),J;!(R=(J=Y.next()).done)&&(_.push(J.value),!(N&&_.length===N));R=!0);}catch(j){M=!0,F=j}finally{try{!R&&Y.return&&Y.return()}finally{if(M)throw F}}return _}return function(I,N){if(Array.isArray(I))return I;if(Symbol.iterator in Object(I))return x(I,N);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function x(I,N){for(var _=0;_<N.length;_++){var R=N[_];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(I,R.key,R)}}return function(I,N,_){return N&&x(I.prototype,N),_&&x(I,_),I}}(),c=r(2),u=y(c),d=r(0),m=y(d),h=r(5),l=y(h),a=r(10),v=y(a),b=r(9),w=y(b);function y(x){return x&&x.__esModule?x:{default:x}}function p(x,I,N){return I in x?Object.defineProperty(x,I,{value:N,enumerable:!0,configurable:!0,writable:!0}):x[I]=N,x}function g(x,I){if(!(x instanceof I))throw new TypeError("Cannot call a class as a function")}function f(x,I){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:x}function T(x,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);x.prototype=Object.create(I&&I.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(x,I):x.__proto__=I)}var S=(0,v.default)("quill:toolbar"),E=function(x){T(I,x);function I(N,_){g(this,I);var R=f(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,N,_));if(Array.isArray(R.options.container)){var M=document.createElement("div");P(M,R.options.container),N.container.parentNode.insertBefore(M,N.container),R.container=M}else typeof R.options.container=="string"?R.container=document.querySelector(R.options.container):R.container=R.options.container;if(!(R.container instanceof HTMLElement)){var F;return F=S.error("Container required for toolbar",R.options),f(R,F)}return R.container.classList.add("ql-toolbar"),R.controls=[],R.handlers={},Object.keys(R.options.handlers).forEach(function(Y){R.addHandler(Y,R.options.handlers[Y])}),[].forEach.call(R.container.querySelectorAll("button, select"),function(Y){R.attach(Y)}),R.quill.on(l.default.events.EDITOR_CHANGE,function(Y,J){Y===l.default.events.SELECTION_CHANGE&&R.update(J)}),R.quill.on(l.default.events.SCROLL_OPTIMIZE,function(){var Y=R.quill.selection.getRange(),J=o(Y,1),j=J[0];R.update(j)}),R}return s(I,[{key:"addHandler",value:function(_,R){this.handlers[_]=R}},{key:"attach",value:function(_){var R=this,M=[].find.call(_.classList,function(Y){return Y.indexOf("ql-")===0});if(M){if(M=M.slice(3),_.tagName==="BUTTON"&&_.setAttribute("type","button"),this.handlers[M]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[M]==null){S.warn("ignoring attaching to disabled format",M,_);return}if(m.default.query(M)==null){S.warn("ignoring attaching to nonexistent format",M,_);return}}var F=_.tagName==="SELECT"?"change":"click";_.addEventListener(F,function(Y){var J=void 0;if(_.tagName==="SELECT"){if(_.selectedIndex<0)return;var j=_.options[_.selectedIndex];j.hasAttribute("selected")?J=!1:J=j.value||!1}else _.classList.contains("ql-active")?J=!1:J=_.value||!_.hasAttribute("value"),Y.preventDefault();R.quill.focus();var C=R.quill.selection.getRange(),q=o(C,1),B=q[0];if(R.handlers[M]!=null)R.handlers[M].call(R,J);else if(m.default.query(M).prototype instanceof m.default.Embed){if(J=prompt("Enter "+M),!J)return;R.quill.updateContents(new u.default().retain(B.index).delete(B.length).insert(p({},M,J)),l.default.sources.USER)}else R.quill.format(M,J,l.default.sources.USER);R.update(B)}),this.controls.push([M,_])}}},{key:"update",value:function(_){var R=_==null?{}:this.quill.getFormat(_);this.controls.forEach(function(M){var F=o(M,2),Y=F[0],J=F[1];if(J.tagName==="SELECT"){var j=void 0;if(_==null)j=null;else if(R[Y]==null)j=J.querySelector("option[selected]");else if(!Array.isArray(R[Y])){var C=R[Y];typeof C=="string"&&(C=C.replace(/\"/g,'\\"')),j=J.querySelector('option[value="'+C+'"]')}j==null?(J.value="",J.selectedIndex=-1):j.selected=!0}else if(_==null)J.classList.remove("ql-active");else if(J.hasAttribute("value")){var q=R[Y]===J.getAttribute("value")||R[Y]!=null&&R[Y].toString()===J.getAttribute("value")||R[Y]==null&&!J.getAttribute("value");J.classList.toggle("ql-active",q)}else J.classList.toggle("ql-active",R[Y]!=null)})}}]),I}(w.default);E.DEFAULTS={};function k(x,I,N){var _=document.createElement("button");_.setAttribute("type","button"),_.classList.add("ql-"+I),N!=null&&(_.value=N),x.appendChild(_)}function P(x,I){Array.isArray(I[0])||(I=[I]),I.forEach(function(N){var _=document.createElement("span");_.classList.add("ql-formats"),N.forEach(function(R){if(typeof R=="string")k(_,R);else{var M=Object.keys(R)[0],F=R[M];Array.isArray(F)?O(_,M,F):k(_,M,F)}}),x.appendChild(_)})}function O(x,I,N){var _=document.createElement("select");_.classList.add("ql-"+I),N.forEach(function(R){var M=document.createElement("option");R!==!1?M.setAttribute("value",R):M.setAttribute("selected","selected"),_.appendChild(M)}),x.appendChild(_)}E.DEFAULTS={container:null,handlers:{clean:function(){var I=this,N=this.quill.getSelection();if(N!=null)if(N.length==0){var _=this.quill.getFormat();Object.keys(_).forEach(function(R){m.default.query(R,m.default.Scope.INLINE)!=null&&I.quill.format(R,!1)})}else this.quill.removeFormat(N,l.default.sources.USER)},direction:function(I){var N=this.quill.getFormat().align;I==="rtl"&&N==null?this.quill.format("align","right",l.default.sources.USER):!I&&N==="right"&&this.quill.format("align",!1,l.default.sources.USER),this.quill.format("direction",I,l.default.sources.USER)},indent:function(I){var N=this.quill.getSelection(),_=this.quill.getFormat(N),R=parseInt(_.indent||0);if(I==="+1"||I==="-1"){var M=I==="+1"?1:-1;_.direction==="rtl"&&(M*=-1),this.quill.format("indent",R+M,l.default.sources.USER)}},link:function(I){I===!0&&(I=prompt("Enter link URL:")),this.quill.format("link",I,l.default.sources.USER)},list:function(I){var N=this.quill.getSelection(),_=this.quill.getFormat(N);I==="check"?_.list==="checked"||_.list==="unchecked"?this.quill.format("list",!1,l.default.sources.USER):this.quill.format("list","unchecked",l.default.sources.USER):this.quill.format("list",I,l.default.sources.USER)}}},n.default=E,n.addControls=P},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function v(b,w){for(var y=0;y<w.length;y++){var p=w[y];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(b,p.key,p)}}return function(b,w,y){return w&&v(b.prototype,w),y&&v(b,y),b}}(),s=function v(b,w,y){b===null&&(b=Function.prototype);var p=Object.getOwnPropertyDescriptor(b,w);if(p===void 0){var g=Object.getPrototypeOf(b);return g===null?void 0:v(g,w,y)}else{if("value"in p)return p.value;var f=p.get;return f===void 0?void 0:f.call(y)}},c=r(28),u=d(c);function d(v){return v&&v.__esModule?v:{default:v}}function m(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}function h(v,b){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:v}function l(v,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);v.prototype=Object.create(b&&b.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(v,b):v.__proto__=b)}var a=function(v){l(b,v);function b(w,y){m(this,b);var p=h(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,w));return p.label.innerHTML=y,p.container.classList.add("ql-color-picker"),[].slice.call(p.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(g){g.classList.add("ql-primary")}),p}return o(b,[{key:"buildItem",value:function(y){var p=s(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"buildItem",this).call(this,y);return p.style.backgroundColor=y.getAttribute("value")||"",p}},{key:"selectItem",value:function(y,p){s(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"selectItem",this).call(this,y,p);var g=this.label.querySelector(".ql-color-label"),f=y&&y.getAttribute("data-value")||"";g&&(g.tagName==="line"?g.style.stroke=f:g.style.fill=f)}}]),b}(u.default);n.default=a},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function v(b,w){for(var y=0;y<w.length;y++){var p=w[y];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(b,p.key,p)}}return function(b,w,y){return w&&v(b.prototype,w),y&&v(b,y),b}}(),s=function v(b,w,y){b===null&&(b=Function.prototype);var p=Object.getOwnPropertyDescriptor(b,w);if(p===void 0){var g=Object.getPrototypeOf(b);return g===null?void 0:v(g,w,y)}else{if("value"in p)return p.value;var f=p.get;return f===void 0?void 0:f.call(y)}},c=r(28),u=d(c);function d(v){return v&&v.__esModule?v:{default:v}}function m(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}function h(v,b){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:v}function l(v,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);v.prototype=Object.create(b&&b.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(v,b):v.__proto__=b)}var a=function(v){l(b,v);function b(w,y){m(this,b);var p=h(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,w));return p.container.classList.add("ql-icon-picker"),[].forEach.call(p.container.querySelectorAll(".ql-picker-item"),function(g){g.innerHTML=y[g.getAttribute("data-value")||""]}),p.defaultItem=p.container.querySelector(".ql-selected"),p.selectItem(p.defaultItem),p}return o(b,[{key:"selectItem",value:function(y,p){s(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"selectItem",this).call(this,y,p),y=y||this.defaultItem,this.label.innerHTML=y.innerHTML}}]),b}(u.default);n.default=a},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function u(d,m){for(var h=0;h<m.length;h++){var l=m[h];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(d,l.key,l)}}return function(d,m,h){return m&&u(d.prototype,m),h&&u(d,h),d}}();function s(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}var c=function(){function u(d,m){var h=this;s(this,u),this.quill=d,this.boundsContainer=m||document.body,this.root=d.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){h.root.style.marginTop=-1*h.quill.root.scrollTop+"px"}),this.hide()}return o(u,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(m){var h=m.left+m.width/2-this.root.offsetWidth/2,l=m.bottom+this.quill.root.scrollTop;this.root.style.left=h+"px",this.root.style.top=l+"px",this.root.classList.remove("ql-flip");var a=this.boundsContainer.getBoundingClientRect(),v=this.root.getBoundingClientRect(),b=0;if(v.right>a.right&&(b=a.right-v.right,this.root.style.left=h+b+"px"),v.left<a.left&&(b=a.left-v.left,this.root.style.left=h+b+"px"),v.bottom>a.bottom){var w=v.bottom-v.top,y=m.bottom-m.top+w;this.root.style.top=l-y+"px",this.root.classList.add("ql-flip")}return b}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),u}();n.default=c},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function O(x,I){var N=[],_=!0,R=!1,M=void 0;try{for(var F=x[Symbol.iterator](),Y;!(_=(Y=F.next()).done)&&(N.push(Y.value),!(I&&N.length===I));_=!0);}catch(J){R=!0,M=J}finally{try{!_&&F.return&&F.return()}finally{if(R)throw M}}return N}return function(x,I){if(Array.isArray(x))return x;if(Symbol.iterator in Object(x))return O(x,I);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function O(x,I,N){x===null&&(x=Function.prototype);var _=Object.getOwnPropertyDescriptor(x,I);if(_===void 0){var R=Object.getPrototypeOf(x);return R===null?void 0:O(R,I,N)}else{if("value"in _)return _.value;var M=_.get;return M===void 0?void 0:M.call(N)}},c=function(){function O(x,I){for(var N=0;N<I.length;N++){var _=I[N];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,_.key,_)}}return function(x,I,N){return I&&O(x.prototype,I),N&&O(x,N),x}}(),u=r(3),d=g(u),m=r(8),h=g(m),l=r(43),a=g(l),v=r(27),b=g(v),w=r(15),y=r(41),p=g(y);function g(O){return O&&O.__esModule?O:{default:O}}function f(O,x){if(!(O instanceof x))throw new TypeError("Cannot call a class as a function")}function T(O,x){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:O}function S(O,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);O.prototype=Object.create(x&&x.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(O,x):O.__proto__=x)}var E=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],k=function(O){S(x,O);function x(I,N){f(this,x),N.modules.toolbar!=null&&N.modules.toolbar.container==null&&(N.modules.toolbar.container=E);var _=T(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,I,N));return _.quill.container.classList.add("ql-snow"),_}return c(x,[{key:"extendToolbar",value:function(N){N.container.classList.add("ql-snow"),this.buildButtons([].slice.call(N.container.querySelectorAll("button")),p.default),this.buildPickers([].slice.call(N.container.querySelectorAll("select")),p.default),this.tooltip=new P(this.quill,this.options.bounds),N.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(_,R){N.handlers.link.call(N,!R.format.link)})}}]),x}(a.default);k.DEFAULTS=(0,d.default)(!0,{},a.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(x){if(x){var I=this.quill.getSelection();if(I==null||I.length==0)return;var N=this.quill.getText(I);/^\S+@\S+\.\S+$/.test(N)&&N.indexOf("mailto:")!==0&&(N="mailto:"+N);var _=this.quill.theme.tooltip;_.edit("link",N)}else this.quill.format("link",!1)}}}}});var P=function(O){S(x,O);function x(I,N){f(this,x);var _=T(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,I,N));return _.preview=_.root.querySelector("a.ql-preview"),_}return c(x,[{key:"listen",value:function(){var N=this;s(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(_){N.root.classList.contains("ql-editing")?N.save():N.edit("link",N.preview.textContent),_.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(_){if(N.linkRange!=null){var R=N.linkRange;N.restoreFocus(),N.quill.formatText(R,"link",!1,h.default.sources.USER),delete N.linkRange}_.preventDefault(),N.hide()}),this.quill.on(h.default.events.SELECTION_CHANGE,function(_,R,M){if(_!=null){if(_.length===0&&M===h.default.sources.USER){var F=N.quill.scroll.descendant(b.default,_.index),Y=o(F,2),J=Y[0],j=Y[1];if(J!=null){N.linkRange=new w.Range(_.index-j,J.length());var C=b.default.formats(J.domNode);N.preview.textContent=C,N.preview.setAttribute("href",C),N.show(),N.position(N.quill.getBounds(N.linkRange));return}}else delete N.linkRange;N.hide()}})}},{key:"show",value:function(){s(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),x}(l.BaseTooltip);P.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=k},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=r(29),s=ie(o),c=r(36),u=r(38),d=r(64),m=r(65),h=ie(m),l=r(66),a=ie(l),v=r(67),b=ie(v),w=r(37),y=r(26),p=r(39),g=r(40),f=r(56),T=ie(f),S=r(68),E=ie(S),k=r(27),P=ie(k),O=r(69),x=ie(O),I=r(70),N=ie(I),_=r(71),R=ie(_),M=r(72),F=ie(M),Y=r(73),J=ie(Y),j=r(13),C=ie(j),q=r(74),B=ie(q),K=r(75),z=ie(K),D=r(57),U=ie(D),V=r(41),G=ie(V),re=r(28),oe=ie(re),ge=r(59),ve=ie(ge),ye=r(60),Ne=ie(ye),Ke=r(61),$e=ie(Ke),X=r(108),ee=ie(X),ae=r(62),ce=ie(ae);function ie(we){return we&&we.__esModule?we:{default:we}}s.default.register({"attributors/attribute/direction":u.DirectionAttribute,"attributors/class/align":c.AlignClass,"attributors/class/background":w.BackgroundClass,"attributors/class/color":y.ColorClass,"attributors/class/direction":u.DirectionClass,"attributors/class/font":p.FontClass,"attributors/class/size":g.SizeClass,"attributors/style/align":c.AlignStyle,"attributors/style/background":w.BackgroundStyle,"attributors/style/color":y.ColorStyle,"attributors/style/direction":u.DirectionStyle,"attributors/style/font":p.FontStyle,"attributors/style/size":g.SizeStyle},!0),s.default.register({"formats/align":c.AlignClass,"formats/direction":u.DirectionClass,"formats/indent":d.IndentClass,"formats/background":w.BackgroundStyle,"formats/color":y.ColorStyle,"formats/font":p.FontClass,"formats/size":g.SizeClass,"formats/blockquote":h.default,"formats/code-block":C.default,"formats/header":a.default,"formats/list":b.default,"formats/bold":T.default,"formats/code":j.Code,"formats/italic":E.default,"formats/link":P.default,"formats/script":x.default,"formats/strike":N.default,"formats/underline":R.default,"formats/image":F.default,"formats/video":J.default,"formats/list/item":v.ListItem,"modules/formula":B.default,"modules/syntax":z.default,"modules/toolbar":U.default,"themes/bubble":ee.default,"themes/snow":ce.default,"ui/icons":G.default,"ui/picker":oe.default,"ui/icon-picker":Ne.default,"ui/color-picker":ve.default,"ui/tooltip":$e.default},!0),n.default=s.default},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var o=function(){function b(w,y){for(var p=0;p<y.length;p++){var g=y[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(w,g.key,g)}}return function(w,y,p){return y&&b(w.prototype,y),p&&b(w,p),w}}(),s=function b(w,y,p){w===null&&(w=Function.prototype);var g=Object.getOwnPropertyDescriptor(w,y);if(g===void 0){var f=Object.getPrototypeOf(w);return f===null?void 0:b(f,y,p)}else{if("value"in g)return g.value;var T=g.get;return T===void 0?void 0:T.call(p)}},c=r(0),u=d(c);function d(b){return b&&b.__esModule?b:{default:b}}function m(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}function h(b,w){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:b}function l(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(b,w):b.__proto__=w)}var a=function(b){l(w,b);function w(){return m(this,w),h(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return o(w,[{key:"add",value:function(p,g){if(g==="+1"||g==="-1"){var f=this.value(p)||0;g=g==="+1"?f+1:f-1}return g===0?(this.remove(p),!0):s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"add",this).call(this,p,g)}},{key:"canAdd",value:function(p,g){return s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"canAdd",this).call(this,p,g)||s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"canAdd",this).call(this,p,parseInt(g))}},{key:"value",value:function(p){return parseInt(s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"value",this).call(this,p))||void 0}}]),w}(u.default.Attributor.Class),v=new a("indent","ql-indent",{scope:u.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=v},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=r(4),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}function u(l,a){if(!(l instanceof a))throw new TypeError("Cannot call a class as a function")}function d(l,a){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:l}function m(l,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);l.prototype=Object.create(a&&a.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(l,a):l.__proto__=a)}var h=function(l){m(a,l);function a(){return u(this,a),d(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return a}(s.default);h.blotName="blockquote",h.tagName="blockquote",n.default=h},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function a(v,b){for(var w=0;w<b.length;w++){var y=b[w];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(v,y.key,y)}}return function(v,b,w){return b&&a(v.prototype,b),w&&a(v,w),v}}(),s=r(4),c=u(s);function u(a){return a&&a.__esModule?a:{default:a}}function d(a,v){if(!(a instanceof v))throw new TypeError("Cannot call a class as a function")}function m(a,v){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:a}function h(a,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);a.prototype=Object.create(v&&v.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(a,v):a.__proto__=v)}var l=function(a){h(v,a);function v(){return d(this,v),m(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return o(v,null,[{key:"formats",value:function(w){return this.tagName.indexOf(w.tagName)+1}}]),v}(c.default);l.blotName="header",l.tagName=["H1","H2","H3","H4","H5","H6"],n.default=l},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var o=function(){function f(T,S){for(var E=0;E<S.length;E++){var k=S[E];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(T,k.key,k)}}return function(T,S,E){return S&&f(T.prototype,S),E&&f(T,E),T}}(),s=function f(T,S,E){T===null&&(T=Function.prototype);var k=Object.getOwnPropertyDescriptor(T,S);if(k===void 0){var P=Object.getPrototypeOf(T);return P===null?void 0:f(P,S,E)}else{if("value"in k)return k.value;var O=k.get;return O===void 0?void 0:O.call(E)}},c=r(0),u=a(c),d=r(4),m=a(d),h=r(25),l=a(h);function a(f){return f&&f.__esModule?f:{default:f}}function v(f,T,S){return T in f?Object.defineProperty(f,T,{value:S,enumerable:!0,configurable:!0,writable:!0}):f[T]=S,f}function b(f,T){if(!(f instanceof T))throw new TypeError("Cannot call a class as a function")}function w(f,T){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:f}function y(f,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);f.prototype=Object.create(T&&T.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(f,T):f.__proto__=T)}var p=function(f){y(T,f);function T(){return b(this,T),w(this,(T.__proto__||Object.getPrototypeOf(T)).apply(this,arguments))}return o(T,[{key:"format",value:function(E,k){E===g.blotName&&!k?this.replaceWith(u.default.create(this.statics.scope)):s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"format",this).call(this,E,k)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(E,k){return this.parent.isolate(this.offset(this.parent),this.length()),E===this.parent.statics.blotName?(this.parent.replaceWith(E,k),this):(this.parent.unwrap(),s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"replaceWith",this).call(this,E,k))}}],[{key:"formats",value:function(E){return E.tagName===this.tagName?void 0:s(T.__proto__||Object.getPrototypeOf(T),"formats",this).call(this,E)}}]),T}(m.default);p.blotName="list-item",p.tagName="LI";var g=function(f){y(T,f),o(T,null,[{key:"create",value:function(E){var k=E==="ordered"?"OL":"UL",P=s(T.__proto__||Object.getPrototypeOf(T),"create",this).call(this,k);return(E==="checked"||E==="unchecked")&&P.setAttribute("data-checked",E==="checked"),P}},{key:"formats",value:function(E){if(E.tagName==="OL")return"ordered";if(E.tagName==="UL")return E.hasAttribute("data-checked")?E.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function T(S){b(this,T);var E=w(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,S)),k=function(O){if(O.target.parentNode===S){var x=E.statics.formats(S),I=u.default.find(O.target);x==="checked"?I.format("list","unchecked"):x==="unchecked"&&I.format("list","checked")}};return S.addEventListener("touchstart",k),S.addEventListener("mousedown",k),E}return o(T,[{key:"format",value:function(E,k){this.children.length>0&&this.children.tail.format(E,k)}},{key:"formats",value:function(){return v({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(E,k){if(E instanceof p)s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"insertBefore",this).call(this,E,k);else{var P=k==null?this.length():k.offset(this),O=this.split(P);O.parent.insertBefore(E,O)}}},{key:"optimize",value:function(E){s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"optimize",this).call(this,E);var k=this.next;k!=null&&k.prev===this&&k.statics.blotName===this.statics.blotName&&k.domNode.tagName===this.domNode.tagName&&k.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(k.moveChildren(this),k.remove())}},{key:"replace",value:function(E){if(E.statics.blotName!==this.statics.blotName){var k=u.default.create(this.statics.defaultChild);E.moveChildren(k),this.appendChild(k)}s(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"replace",this).call(this,E)}}]),T}(l.default);g.blotName="list",g.scope=u.default.Scope.BLOCK_BLOT,g.tagName=["OL","UL"],g.defaultChild="list-item",g.allowedChildren=[p],n.ListItem=p,n.default=g},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=r(56),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}function u(l,a){if(!(l instanceof a))throw new TypeError("Cannot call a class as a function")}function d(l,a){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:l}function m(l,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);l.prototype=Object.create(a&&a.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(l,a):l.__proto__=a)}var h=function(l){m(a,l);function a(){return u(this,a),d(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return a}(s.default);h.blotName="italic",h.tagName=["EM","I"],n.default=h},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function v(b,w){for(var y=0;y<w.length;y++){var p=w[y];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(b,p.key,p)}}return function(b,w,y){return w&&v(b.prototype,w),y&&v(b,y),b}}(),s=function v(b,w,y){b===null&&(b=Function.prototype);var p=Object.getOwnPropertyDescriptor(b,w);if(p===void 0){var g=Object.getPrototypeOf(b);return g===null?void 0:v(g,w,y)}else{if("value"in p)return p.value;var f=p.get;return f===void 0?void 0:f.call(y)}},c=r(6),u=d(c);function d(v){return v&&v.__esModule?v:{default:v}}function m(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}function h(v,b){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:v}function l(v,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);v.prototype=Object.create(b&&b.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(v,b):v.__proto__=b)}var a=function(v){l(b,v);function b(){return m(this,b),h(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return o(b,null,[{key:"create",value:function(y){return y==="super"?document.createElement("sup"):y==="sub"?document.createElement("sub"):s(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,y)}},{key:"formats",value:function(y){if(y.tagName==="SUB")return"sub";if(y.tagName==="SUP")return"super"}}]),b}(u.default);a.blotName="script",a.tagName=["SUB","SUP"],n.default=a},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=r(6),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}function u(l,a){if(!(l instanceof a))throw new TypeError("Cannot call a class as a function")}function d(l,a){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:l}function m(l,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);l.prototype=Object.create(a&&a.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(l,a):l.__proto__=a)}var h=function(l){m(a,l);function a(){return u(this,a),d(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return a}(s.default);h.blotName="strike",h.tagName="S",n.default=h},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=r(6),s=c(o);function c(l){return l&&l.__esModule?l:{default:l}}function u(l,a){if(!(l instanceof a))throw new TypeError("Cannot call a class as a function")}function d(l,a){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:l}function m(l,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);l.prototype=Object.create(a&&a.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(l,a):l.__proto__=a)}var h=function(l){m(a,l);function a(){return u(this,a),d(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return a}(s.default);h.blotName="underline",h.tagName="U",n.default=h},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function w(y,p){for(var g=0;g<p.length;g++){var f=p[g];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}return function(y,p,g){return p&&w(y.prototype,p),g&&w(y,g),y}}(),s=function w(y,p,g){y===null&&(y=Function.prototype);var f=Object.getOwnPropertyDescriptor(y,p);if(f===void 0){var T=Object.getPrototypeOf(y);return T===null?void 0:w(T,p,g)}else{if("value"in f)return f.value;var S=f.get;return S===void 0?void 0:S.call(g)}},c=r(0),u=m(c),d=r(27);function m(w){return w&&w.__esModule?w:{default:w}}function h(w,y){if(!(w instanceof y))throw new TypeError("Cannot call a class as a function")}function l(w,y){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:w}function a(w,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);w.prototype=Object.create(y&&y.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(w,y):w.__proto__=y)}var v=["alt","height","width"],b=function(w){a(y,w);function y(){return h(this,y),l(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return o(y,[{key:"format",value:function(g,f){v.indexOf(g)>-1?f?this.domNode.setAttribute(g,f):this.domNode.removeAttribute(g):s(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"format",this).call(this,g,f)}}],[{key:"create",value:function(g){var f=s(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this,g);return typeof g=="string"&&f.setAttribute("src",this.sanitize(g)),f}},{key:"formats",value:function(g){return v.reduce(function(f,T){return g.hasAttribute(T)&&(f[T]=g.getAttribute(T)),f},{})}},{key:"match",value:function(g){return/\.(jpe?g|gif|png)$/.test(g)||/^data:image\/.+;base64/.test(g)}},{key:"sanitize",value:function(g){return(0,d.sanitize)(g,["http","https","data"])?g:"//:0"}},{key:"value",value:function(g){return g.getAttribute("src")}}]),y}(u.default.Embed);b.blotName="image",b.tagName="IMG",n.default=b},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function w(y,p){for(var g=0;g<p.length;g++){var f=p[g];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}return function(y,p,g){return p&&w(y.prototype,p),g&&w(y,g),y}}(),s=function w(y,p,g){y===null&&(y=Function.prototype);var f=Object.getOwnPropertyDescriptor(y,p);if(f===void 0){var T=Object.getPrototypeOf(y);return T===null?void 0:w(T,p,g)}else{if("value"in f)return f.value;var S=f.get;return S===void 0?void 0:S.call(g)}},c=r(4),u=r(27),d=m(u);function m(w){return w&&w.__esModule?w:{default:w}}function h(w,y){if(!(w instanceof y))throw new TypeError("Cannot call a class as a function")}function l(w,y){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:w}function a(w,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);w.prototype=Object.create(y&&y.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(w,y):w.__proto__=y)}var v=["height","width"],b=function(w){a(y,w);function y(){return h(this,y),l(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return o(y,[{key:"format",value:function(g,f){v.indexOf(g)>-1?f?this.domNode.setAttribute(g,f):this.domNode.removeAttribute(g):s(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"format",this).call(this,g,f)}}],[{key:"create",value:function(g){var f=s(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this,g);return f.setAttribute("frameborder","0"),f.setAttribute("allowfullscreen",!0),f.setAttribute("src",this.sanitize(g)),f}},{key:"formats",value:function(g){return v.reduce(function(f,T){return g.hasAttribute(T)&&(f[T]=g.getAttribute(T)),f},{})}},{key:"sanitize",value:function(g){return d.default.sanitize(g)}},{key:"value",value:function(g){return g.getAttribute("src")}}]),y}(c.BlockEmbed);b.blotName="video",b.className="ql-video",b.tagName="IFRAME",n.default=b},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var o=function(){function g(f,T){for(var S=0;S<T.length;S++){var E=T[S];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}return function(f,T,S){return T&&g(f.prototype,T),S&&g(f,S),f}}(),s=function g(f,T,S){f===null&&(f=Function.prototype);var E=Object.getOwnPropertyDescriptor(f,T);if(E===void 0){var k=Object.getPrototypeOf(f);return k===null?void 0:g(k,T,S)}else{if("value"in E)return E.value;var P=E.get;return P===void 0?void 0:P.call(S)}},c=r(35),u=a(c),d=r(5),m=a(d),h=r(9),l=a(h);function a(g){return g&&g.__esModule?g:{default:g}}function v(g,f){if(!(g instanceof f))throw new TypeError("Cannot call a class as a function")}function b(g,f){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:g}function w(g,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);g.prototype=Object.create(f&&f.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(g,f):g.__proto__=f)}var y=function(g){w(f,g);function f(){return v(this,f),b(this,(f.__proto__||Object.getPrototypeOf(f)).apply(this,arguments))}return o(f,null,[{key:"create",value:function(S){var E=s(f.__proto__||Object.getPrototypeOf(f),"create",this).call(this,S);return typeof S=="string"&&(window.katex.render(S,E,{throwOnError:!1,errorColor:"#f00"}),E.setAttribute("data-value",S)),E}},{key:"value",value:function(S){return S.getAttribute("data-value")}}]),f}(u.default);y.blotName="formula",y.className="ql-formula",y.tagName="SPAN";var p=function(g){w(f,g),o(f,null,[{key:"register",value:function(){m.default.register(y,!0)}}]);function f(){v(this,f);var T=b(this,(f.__proto__||Object.getPrototypeOf(f)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return T}return f}(l.default);n.FormulaBlot=y,n.default=p},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var o=function(){function S(E,k){for(var P=0;P<k.length;P++){var O=k[P];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(E,O.key,O)}}return function(E,k,P){return k&&S(E.prototype,k),P&&S(E,P),E}}(),s=function S(E,k,P){E===null&&(E=Function.prototype);var O=Object.getOwnPropertyDescriptor(E,k);if(O===void 0){var x=Object.getPrototypeOf(E);return x===null?void 0:S(x,k,P)}else{if("value"in O)return O.value;var I=O.get;return I===void 0?void 0:I.call(P)}},c=r(0),u=b(c),d=r(5),m=b(d),h=r(9),l=b(h),a=r(13),v=b(a);function b(S){return S&&S.__esModule?S:{default:S}}function w(S,E){if(!(S instanceof E))throw new TypeError("Cannot call a class as a function")}function y(S,E){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:S}function p(S,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);S.prototype=Object.create(E&&E.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(S,E):S.__proto__=E)}var g=function(S){p(E,S);function E(){return w(this,E),y(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return o(E,[{key:"replaceWith",value:function(P){this.domNode.textContent=this.domNode.textContent,this.attach(),s(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"replaceWith",this).call(this,P)}},{key:"highlight",value:function(P){var O=this.domNode.textContent;this.cachedText!==O&&((O.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=P(O),this.domNode.normalize(),this.attach()),this.cachedText=O)}}]),E}(v.default);g.className="ql-syntax";var f=new u.default.Attributor.Class("token","hljs",{scope:u.default.Scope.INLINE}),T=function(S){p(E,S),o(E,null,[{key:"register",value:function(){m.default.register(f,!0),m.default.register(g,!0)}}]);function E(k,P){w(this,E);var O=y(this,(E.__proto__||Object.getPrototypeOf(E)).call(this,k,P));if(typeof O.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var x=null;return O.quill.on(m.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(x),x=setTimeout(function(){O.highlight(),x=null},O.options.interval)}),O.highlight(),O}return o(E,[{key:"highlight",value:function(){var P=this;if(!this.quill.selection.composing){this.quill.update(m.default.sources.USER);var O=this.quill.getSelection();this.quill.scroll.descendants(g).forEach(function(x){x.highlight(P.options.highlight)}),this.quill.update(m.default.sources.SILENT),O!=null&&this.quill.setSelection(O,m.default.sources.SILENT)}}}]),E}(l.default);T.DEFAULTS={highlight:function(){return window.hljs==null?null:function(S){var E=window.hljs.highlightAuto(S);return E.value}}(),interval:1e3},n.CodeBlock=g,n.CodeToken=f,n.default=T},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(e,n){e.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(e,n){e.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(e,n){e.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(e,n){e.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(e,n){e.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(e,n,r){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var o=function E(k,P,O){k===null&&(k=Function.prototype);var x=Object.getOwnPropertyDescriptor(k,P);if(x===void 0){var I=Object.getPrototypeOf(k);return I===null?void 0:E(I,P,O)}else{if("value"in x)return x.value;var N=x.get;return N===void 0?void 0:N.call(O)}},s=function(){function E(k,P){for(var O=0;O<P.length;O++){var x=P[O];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(k,x.key,x)}}return function(k,P,O){return P&&E(k.prototype,P),O&&E(k,O),k}}(),c=r(3),u=w(c),d=r(8),m=w(d),h=r(43),l=w(h),a=r(15),v=r(41),b=w(v);function w(E){return E&&E.__esModule?E:{default:E}}function y(E,k){if(!(E instanceof k))throw new TypeError("Cannot call a class as a function")}function p(E,k){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:E}function g(E,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);E.prototype=Object.create(k&&k.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(E,k):E.__proto__=k)}var f=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],T=function(E){g(k,E);function k(P,O){y(this,k),O.modules.toolbar!=null&&O.modules.toolbar.container==null&&(O.modules.toolbar.container=f);var x=p(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,P,O));return x.quill.container.classList.add("ql-bubble"),x}return s(k,[{key:"extendToolbar",value:function(O){this.tooltip=new S(this.quill,this.options.bounds),this.tooltip.root.appendChild(O.container),this.buildButtons([].slice.call(O.container.querySelectorAll("button")),b.default),this.buildPickers([].slice.call(O.container.querySelectorAll("select")),b.default)}}]),k}(l.default);T.DEFAULTS=(0,u.default)(!0,{},l.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(k){k?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var S=function(E){g(k,E);function k(P,O){y(this,k);var x=p(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,P,O));return x.quill.on(m.default.events.EDITOR_CHANGE,function(I,N,_,R){if(I===m.default.events.SELECTION_CHANGE)if(N!=null&&N.length>0&&R===m.default.sources.USER){x.show(),x.root.style.left="0px",x.root.style.width="",x.root.style.width=x.root.offsetWidth+"px";var M=x.quill.getLines(N.index,N.length);if(M.length===1)x.position(x.quill.getBounds(N));else{var F=M[M.length-1],Y=x.quill.getIndex(F),J=Math.min(F.length()-1,N.index+N.length-Y),j=x.quill.getBounds(new a.Range(Y,J));x.position(j)}}else document.activeElement!==x.textbox&&x.quill.hasFocus()&&x.hide()}),x}return s(k,[{key:"listen",value:function(){var O=this;o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){O.root.classList.remove("ql-editing")}),this.quill.on(m.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!O.root.classList.contains("ql-hidden")){var x=O.quill.getSelection();x!=null&&O.position(O.quill.getBounds(x))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(O){var x=o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"position",this).call(this,O),I=this.root.querySelector(".ql-tooltip-arrow");if(I.style.marginLeft="",x===0)return x;I.style.marginLeft=-1*x-I.offsetWidth/2+"px"}}]),k}(h.BaseTooltip);S.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=S,n.default=T},function(e,n,r){e.exports=r(63)}]).default})})(Hu);var Hh=Hu.exports;const Rl=Ku(Hh);var Wu={exports:{}};/*! For license information please see quill-cursors.js.LICENSE.txt */(function(i,t){(function(e,n){i.exports=n()})(self,()=>(()=>{var e={582:(s,c,u)=>{u.d(c,{Z:()=>a});var d=u(81),m=u.n(d),h=u(645),l=u.n(h)()(m());l.push([s.id,".ql-container{position:relative;overflow:hidden}@media(pointer: coarse){.ql-cursor-caret-container{z-index:-1}}.ql-cursor.hidden{display:none}.ql-cursor .ql-cursor-caret-container,.ql-cursor .ql-cursor-flag{position:absolute}.ql-cursor .ql-cursor-flag{z-index:1;transform:translate3d(-1px, -100%, 0);opacity:0;visibility:hidden;color:#fff;padding-bottom:2px;border-radius:0 3px 3px 0}.ql-cursor .ql-cursor-flag.flag-flipped{border-radius:3px 0 0 3px;transform:translate3d(calc(-100% + 1px ), -100%, 0)}@media screen{.ql-cursor .ql-cursor-flag{transition:opacity 0ms cubic-bezier(0.25, 0.46, 0.45, 0.94) 0ms,visibility 0ms cubic-bezier(0.25, 0.46, 0.45, 0.94) 0ms}}.ql-cursor .ql-cursor-flag .ql-cursor-name{margin-left:5px;margin-right:5px;display:inline-block;margin-top:-2px;white-space:nowrap}.ql-cursor .ql-cursor-flag.no-delay[style]{transition-delay:unset !important}.ql-cursor .ql-cursor-caret-container{cursor:text;margin-left:-9px;padding:0 9px}.ql-cursor .ql-cursor-caret-container.hover+.ql-cursor-flag{opacity:1;visibility:visible;transition:none}.ql-cursor .ql-cursor-caret-container.no-pointer{pointer-events:none}.ql-cursor .ql-cursor-caret-container .ql-cursor-caret{position:absolute;top:0;bottom:0;width:2px;margin-left:-1px;background-color:attr(data-color)}.ql-cursor .ql-cursor-selection-block{position:absolute;pointer-events:none}",""]);const a=l},645:s=>{s.exports=function(c){var u=[];return u.toString=function(){return this.map(function(d){var m="",h=d[5]!==void 0;return d[4]&&(m+="@supports (".concat(d[4],") {")),d[2]&&(m+="@media ".concat(d[2]," {")),h&&(m+="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {")),m+=c(d),h&&(m+="}"),d[2]&&(m+="}"),d[4]&&(m+="}"),m}).join("")},u.i=function(d,m,h,l,a){typeof d=="string"&&(d=[[null,d,void 0]]);var v={};if(h)for(var b=0;b<this.length;b++){var w=this[b][0];w!=null&&(v[w]=!0)}for(var y=0;y<d.length;y++){var p=[].concat(d[y]);h&&v[p[0]]||(a!==void 0&&(p[5]===void 0||(p[1]="@layer".concat(p[5].length>0?" ".concat(p[5]):""," {").concat(p[1],"}")),p[5]=a),m&&(p[2]&&(p[1]="@media ".concat(p[2]," {").concat(p[1],"}")),p[2]=m),l&&(p[4]?(p[1]="@supports (".concat(p[4],") {").concat(p[1],"}"),p[4]=l):p[4]="".concat(l)),u.push(p))}},u}},81:s=>{s.exports=function(c){return c[1]}},529:s=>{var c=-1;function u(g,f,T,S){if(g===f)return g?[[0,g]]:[];if(T!=null){var E=function(I,N,_){var R=typeof _=="number"?{index:_,length:0}:_.oldRange,M=typeof _=="number"?null:_.newRange,F=I.length,Y=N.length;if(R.length===0&&(M===null||M.length===0)){var J=R.index,j=I.slice(0,J),C=I.slice(J),q=M?M.index:null,B=J+Y-F;if((q===null||q===B)&&!(B<0||B>Y)){var K=N.slice(0,B);if((U=N.slice(B))===C){var z=Math.min(J,B);if((G=j.slice(0,z))===(oe=K.slice(0,z)))return y(G,j.slice(z),K.slice(z),C)}}if(q===null||q===J){var D=J,U=(K=N.slice(0,D),N.slice(D));if(K===j){var V=Math.min(F-D,Y-D);if((re=C.slice(C.length-V))===(ge=U.slice(U.length-V)))return y(j,C.slice(0,C.length-V),U.slice(0,U.length-V),re)}}}if(R.length>0&&M&&M.length===0){var G=I.slice(0,R.index),re=I.slice(R.index+R.length);if(!(Y<(z=G.length)+(V=re.length))){var oe=N.slice(0,z),ge=N.slice(Y-V);if(G===oe&&re===ge)return y(G,I.slice(z,F-V),N.slice(z,Y-V),re)}}return null}(g,f,T);if(E)return E}var k=m(g,f),P=g.substring(0,k);k=h(g=g.substring(k),f=f.substring(k));var O=g.substring(g.length-k),x=function(I,N){var _;if(!I)return[[1,N]];if(!N)return[[c,I]];var R=I.length>N.length?I:N,M=I.length>N.length?N:I,F=R.indexOf(M);if(F!==-1)return _=[[1,R.substring(0,F)],[0,M],[1,R.substring(F+M.length)]],I.length>N.length&&(_[0][0]=_[2][0]=c),_;if(M.length===1)return[[c,I],[1,N]];var Y=function(D,U){var V=D.length>U.length?D:U,G=D.length>U.length?U:D;if(V.length<4||2*G.length<V.length)return null;function re(X,ee,ae){for(var ce,ie,we,pe,Ae=X.substring(ae,ae+Math.floor(X.length/4)),je=-1,ze="";(je=ee.indexOf(Ae,je+1))!==-1;){var ke=m(X.substring(ae),ee.substring(je)),ct=h(X.substring(0,ae),ee.substring(0,je));ze.length<ct+ke&&(ze=ee.substring(je-ct,je)+ee.substring(je,je+ke),ce=X.substring(0,ae-ct),ie=X.substring(ae+ke),we=ee.substring(0,je-ct),pe=ee.substring(je+ke))}return 2*ze.length>=X.length?[ce,ie,we,pe,ze]:null}var oe,ge,ve,ye,Ne,Ke=re(V,G,Math.ceil(V.length/4)),$e=re(V,G,Math.ceil(V.length/2));return Ke||$e?(oe=$e?Ke&&Ke[4].length>$e[4].length?Ke:$e:Ke,D.length>U.length?(ge=oe[0],ve=oe[1],ye=oe[2],Ne=oe[3]):(ye=oe[0],Ne=oe[1],ge=oe[2],ve=oe[3]),[ge,ve,ye,Ne,oe[4]]):null}(I,N);if(Y){var J=Y[0],j=Y[1],C=Y[2],q=Y[3],B=Y[4],K=u(J,C),z=u(j,q);return K.concat([[0,B]],z)}return function(D,U){for(var V=D.length,G=U.length,re=Math.ceil((V+G)/2),oe=re,ge=2*re,ve=new Array(ge),ye=new Array(ge),Ne=0;Ne<ge;Ne++)ve[Ne]=-1,ye[Ne]=-1;ve[oe+1]=0,ye[oe+1]=0;for(var Ke=V-G,$e=Ke%2!=0,X=0,ee=0,ae=0,ce=0,ie=0;ie<re;ie++){for(var we=-ie+X;we<=ie-ee;we+=2){for(var pe=oe+we,Ae=(Re=we===-ie||we!==ie&&ve[pe-1]<ve[pe+1]?ve[pe+1]:ve[pe-1]+1)-we;Re<V&&Ae<G&&D.charAt(Re)===U.charAt(Ae);)Re++,Ae++;if(ve[pe]=Re,Re>V)ee+=2;else if(Ae>G)X+=2;else if($e&&(ke=oe+Ke-we)>=0&&ke<ge&&ye[ke]!==-1&&Re>=(ze=V-ye[ke]))return d(D,U,Re,Ae)}for(var je=-ie+ae;je<=ie-ce;je+=2){for(var ze,ke=oe+je,ct=(ze=je===-ie||je!==ie&&ye[ke-1]<ye[ke+1]?ye[ke+1]:ye[ke-1]+1)-je;ze<V&&ct<G&&D.charAt(V-ze-1)===U.charAt(G-ct-1);)ze++,ct++;if(ye[ke]=ze,ze>V)ce+=2;else if(ct>G)ae+=2;else if(!$e){var Re;if((pe=oe+Ke-je)>=0&&pe<ge&&ve[pe]!==-1&&(Ae=oe+(Re=ve[pe])-pe,Re>=(ze=V-ze)))return d(D,U,Re,Ae)}}}return[[c,D],[1,U]]}(I,N)}(g=g.substring(0,g.length-k),f=f.substring(0,f.length-k));return P&&x.unshift([0,P]),O&&x.push([0,O]),l(x,S),x}function d(g,f,T,S){var E=g.substring(0,T),k=f.substring(0,S),P=g.substring(T),O=f.substring(S),x=u(E,k),I=u(P,O);return x.concat(I)}function m(g,f){if(!g||!f||g.charAt(0)!==f.charAt(0))return 0;for(var T=0,S=Math.min(g.length,f.length),E=S,k=0;T<E;)g.substring(k,E)==f.substring(k,E)?k=T=E:S=E,E=Math.floor((S-T)/2+T);return a(g.charCodeAt(E-1))&&E--,E}function h(g,f){if(!g||!f||g.slice(-1)!==f.slice(-1))return 0;for(var T=0,S=Math.min(g.length,f.length),E=S,k=0;T<E;)g.substring(g.length-E,g.length-k)==f.substring(f.length-E,f.length-k)?k=T=E:S=E,E=Math.floor((S-T)/2+T);return v(g.charCodeAt(g.length-E))&&E--,E}function l(g,f){g.push([0,""]);for(var T,S=0,E=0,k=0,P="",O="";S<g.length;)if(S<g.length-1&&!g[S][1])g.splice(S,1);else switch(g[S][0]){case 1:k++,O+=g[S][1],S++;break;case c:E++,P+=g[S][1],S++;break;case 0:var x=S-k-E-1;if(f){if(x>=0&&w(g[x][1])){var I=g[x][1].slice(-1);if(g[x][1]=g[x][1].slice(0,-1),P=I+P,O=I+O,!g[x][1]){g.splice(x,1),S--;var N=x-1;g[N]&&g[N][0]===1&&(k++,O=g[N][1]+O,N--),g[N]&&g[N][0]===c&&(E++,P=g[N][1]+P,N--),x=N}}b(g[S][1])&&(I=g[S][1].charAt(0),g[S][1]=g[S][1].slice(1),P+=I,O+=I)}if(S<g.length-1&&!g[S][1]){g.splice(S,1);break}if(P.length>0||O.length>0){P.length>0&&O.length>0&&((T=m(O,P))!==0&&(x>=0?g[x][1]+=O.substring(0,T):(g.splice(0,0,[0,O.substring(0,T)]),S++),O=O.substring(T),P=P.substring(T)),(T=h(O,P))!==0&&(g[S][1]=O.substring(O.length-T)+g[S][1],O=O.substring(0,O.length-T),P=P.substring(0,P.length-T)));var _=k+E;P.length===0&&O.length===0?(g.splice(S-_,_),S-=_):P.length===0?(g.splice(S-_,_,[1,O]),S=S-_+1):O.length===0?(g.splice(S-_,_,[c,P]),S=S-_+1):(g.splice(S-_,_,[c,P],[1,O]),S=S-_+2)}S!==0&&g[S-1][0]===0?(g[S-1][1]+=g[S][1],g.splice(S,1)):S++,k=0,E=0,P="",O=""}g[g.length-1][1]===""&&g.pop();var R=!1;for(S=1;S<g.length-1;)g[S-1][0]===0&&g[S+1][0]===0&&(g[S][1].substring(g[S][1].length-g[S-1][1].length)===g[S-1][1]?(g[S][1]=g[S-1][1]+g[S][1].substring(0,g[S][1].length-g[S-1][1].length),g[S+1][1]=g[S-1][1]+g[S+1][1],g.splice(S-1,1),R=!0):g[S][1].substring(0,g[S+1][1].length)==g[S+1][1]&&(g[S-1][1]+=g[S+1][1],g[S][1]=g[S][1].substring(g[S+1][1].length)+g[S+1][1],g.splice(S+1,1),R=!0)),S++;R&&l(g,f)}function a(g){return g>=55296&&g<=56319}function v(g){return g>=56320&&g<=57343}function b(g){return v(g.charCodeAt(0))}function w(g){return a(g.charCodeAt(g.length-1))}function y(g,f,T,S){return w(g)||b(S)?null:function(E){for(var k=[],P=0;P<E.length;P++)E[P][1].length>0&&k.push(E[P]);return k}([[0,g],[c,f],[1,T],[0,S]])}function p(g,f,T){return u(g,f,T,!0)}p.INSERT=1,p.DELETE=c,p.EQUAL=0,s.exports=p},465:(s,c,u)=>{s=u.nmd(s);var d="__lodash_hash_undefined__",m=9007199254740991,h="[object Arguments]",l="[object Boolean]",a="[object Date]",v="[object Function]",b="[object GeneratorFunction]",w="[object Map]",y="[object Number]",p="[object Object]",g="[object Promise]",f="[object RegExp]",T="[object Set]",S="[object String]",E="[object Symbol]",k="[object WeakMap]",P="[object ArrayBuffer]",O="[object DataView]",x="[object Float32Array]",I="[object Float64Array]",N="[object Int8Array]",_="[object Int16Array]",R="[object Int32Array]",M="[object Uint8Array]",F="[object Uint8ClampedArray]",Y="[object Uint16Array]",J="[object Uint32Array]",j=/\w*$/,C=/^\[object .+?Constructor\]$/,q=/^(?:0|[1-9]\d*)$/,B={};B[h]=B["[object Array]"]=B[P]=B[O]=B[l]=B[a]=B[x]=B[I]=B[N]=B[_]=B[R]=B[w]=B[y]=B[p]=B[f]=B[T]=B[S]=B[E]=B[M]=B[F]=B[Y]=B[J]=!0,B["[object Error]"]=B[v]=B[k]=!1;var K=typeof u.g=="object"&&u.g&&u.g.Object===Object&&u.g,z=typeof self=="object"&&self&&self.Object===Object&&self,D=K||z||Function("return this")(),U=c&&!c.nodeType&&c,V=U&&s&&!s.nodeType&&s,G=V&&V.exports===U;function re($,Q){return $.set(Q[0],Q[1]),$}function oe($,Q){return $.add(Q),$}function ge($,Q,ue,he){var Ce=-1,He=$?$.length:0;for(he;++Ce<He;)ue=Q(ue,$[Ce],Ce,$);return ue}function ve($){var Q=!1;if($!=null&&typeof $.toString!="function")try{Q=!!($+"")}catch{}return Q}function ye($){var Q=-1,ue=Array($.size);return $.forEach(function(he,Ce){ue[++Q]=[Ce,he]}),ue}function Ne($,Q){return function(ue){return $(Q(ue))}}function Ke($){var Q=-1,ue=Array($.size);return $.forEach(function(he){ue[++Q]=he}),ue}var $e,X=Array.prototype,ee=Function.prototype,ae=Object.prototype,ce=D["__core-js_shared__"],ie=($e=/[^.]+$/.exec(ce&&ce.keys&&ce.keys.IE_PROTO||""))?"Symbol(src)_1."+$e:"",we=ee.toString,pe=ae.hasOwnProperty,Ae=ae.toString,je=RegExp("^"+we.call(pe).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ze=G?D.Buffer:void 0,ke=D.Symbol,ct=D.Uint8Array,Re=Ne(Object.getPrototypeOf,Object),yt=Object.create,hi=ae.propertyIsEnumerable,Ps=X.splice,_o=Object.getOwnPropertySymbols,Cs=ze?ze.isBuffer:void 0,Ls=Ne(Object.keys,Object),Xi=ln(D,"DataView"),Hr=ln(D,"Map"),di=ln(D,"Promise"),Kt=ln(D,"Set"),St=ln(D,"WeakMap"),Et=ln(Object,"create"),Ni=cn(Xi),sn=cn(Hr),_i=cn(di),gi=cn(Kt),Po=cn(St),Qi=ke?ke.prototype:void 0,eo=Qi?Qi.valueOf:void 0;function an($){var Q=-1,ue=$?$.length:0;for(this.clear();++Q<ue;){var he=$[Q];this.set(he[0],he[1])}}function vt($){var Q=-1,ue=$?$.length:0;for(this.clear();++Q<ue;){var he=$[Q];this.set(he[0],he[1])}}function xt($){var Q=-1,ue=$?$.length:0;for(this.clear();++Q<ue;){var he=$[Q];this.set(he[0],he[1])}}function Wr($){this.__data__=new vt($)}function Ht($,Q,ue){var he=$[Q];pe.call($,Q)&&Ro(he,ue)&&(ue!==void 0||Q in $)||($[Q]=ue)}function Pi($,Q){for(var ue=$.length;ue--;)if(Ro($[ue][0],Q))return ue;return-1}function Wt($,Q,ue,he,Ce,He,Ze){var De;if(he&&(De=He?he($,Ce,He,Ze):he($)),De!==void 0)return De;if(!Ue($))return $;var rt=H($);if(rt){if(De=function(Oe){var Ve=Oe.length,it=Oe.constructor(Ve);return Ve&&typeof Oe[0]=="string"&&pe.call(Oe,"index")&&(it.index=Oe.index,it.input=Oe.input),it}($),!Q)return function(Oe,Ve){var it=-1,Le=Oe.length;for(Ve||(Ve=Array(Le));++it<Le;)Ve[it]=Oe[it];return Ve}($,De)}else{var Xe=un($),fn=Xe==v||Xe==b;if(le($))return function(Oe,Ve){if(Ve)return Oe.slice();var it=new Oe.constructor(Oe.length);return Oe.copy(it),it}($,Q);if(Xe==p||Xe==h||fn&&!He){if(ve($))return He?$:{};if(De=function(Oe){return typeof Oe.constructor!="function"||Gr(Oe)?{}:Ue(Ve=Re(Oe))?yt(Ve):{};var Ve}(fn?{}:$),!Q)return function(Oe,Ve){return Co(Oe,to(Oe),Ve)}($,function(Oe,Ve){return Oe&&Co(Ve,Pe(Ve),Oe)}(De,$))}else{if(!B[Xe])return He?$:{};De=function(Oe,Ve,it,Le){var Fe,Gt=Oe.constructor;switch(Ve){case P:return Ci(Oe);case l:case a:return new Gt(+Oe);case O:return function(qe,ft){var Qe=ft?Ci(qe.buffer):qe.buffer;return new qe.constructor(Qe,qe.byteOffset,qe.byteLength)}(Oe,Le);case x:case I:case N:case _:case R:case M:case F:case Y:case J:return function(qe,ft){var Qe=ft?Ci(qe.buffer):qe.buffer;return new qe.constructor(Qe,qe.byteOffset,qe.length)}(Oe,Le);case w:return function(qe,ft,Qe){return ge(ft?Qe(ye(qe),!0):ye(qe),re,new qe.constructor)}(Oe,Le,it);case y:case S:return new Gt(Oe);case f:return function(qe){var ft=new qe.constructor(qe.source,j.exec(qe));return ft.lastIndex=qe.lastIndex,ft}(Oe);case T:return function(qe,ft,Qe){return ge(ft?Qe(Ke(qe),!0):Ke(qe),oe,new qe.constructor)}(Oe,Le,it);case E:return Fe=Oe,eo?Object(eo.call(Fe)):{}}}($,Xe,Wt,Q)}}Ze||(Ze=new Wr);var qn=Ze.get($);if(qn)return qn;if(Ze.set($,De),!rt)var Yr=ue?function(Oe){return function(Ve,it,Le){var Fe=it(Ve);return H(Ve)?Fe:function(Gt,qe){for(var ft=-1,Qe=qe.length,Yt=Gt.length;++ft<Qe;)Gt[Yt+ft]=qe[ft];return Gt}(Fe,Le(Ve))}(Oe,Pe,to)}($):Pe($);return function(Oe,Ve){for(var it=-1,Le=Oe?Oe.length:0;++it<Le&&Ve(Oe[it],it)!==!1;);}(Yr||$,function(Oe,Ve){Yr&&(Oe=$[Ve=Oe]),Ht(De,Ve,Wt(Oe,Q,ue,he,Ve,$,Ze))}),De}function Ci($){var Q=new $.constructor($.byteLength);return new ct(Q).set(new ct($)),Q}function Co($,Q,ue,he){ue||(ue={});for(var Ce=-1,He=Q.length;++Ce<He;){var Ze=Q[Ce],De=void 0;Ht(ue,Ze,De===void 0?$[Ze]:De)}return ue}function Bn($,Q){var ue,he,Ce=$.__data__;return((he=typeof(ue=Q))=="string"||he=="number"||he=="symbol"||he=="boolean"?ue!=="__proto__":ue===null)?Ce[typeof Q=="string"?"string":"hash"]:Ce.map}function ln($,Q){var ue=function(he,Ce){return he==null?void 0:he[Ce]}($,Q);return function(he){return!(!Ue(he)||(Ce=he,ie&&ie in Ce))&&(be(he)||ve(he)?je:C).test(cn(he));var Ce}(ue)?ue:void 0}an.prototype.clear=function(){this.__data__=Et?Et(null):{}},an.prototype.delete=function($){return this.has($)&&delete this.__data__[$]},an.prototype.get=function($){var Q=this.__data__;if(Et){var ue=Q[$];return ue===d?void 0:ue}return pe.call(Q,$)?Q[$]:void 0},an.prototype.has=function($){var Q=this.__data__;return Et?Q[$]!==void 0:pe.call(Q,$)},an.prototype.set=function($,Q){return this.__data__[$]=Et&&Q===void 0?d:Q,this},vt.prototype.clear=function(){this.__data__=[]},vt.prototype.delete=function($){var Q=this.__data__,ue=Pi(Q,$);return!(ue<0||(ue==Q.length-1?Q.pop():Ps.call(Q,ue,1),0))},vt.prototype.get=function($){var Q=this.__data__,ue=Pi(Q,$);return ue<0?void 0:Q[ue][1]},vt.prototype.has=function($){return Pi(this.__data__,$)>-1},vt.prototype.set=function($,Q){var ue=this.__data__,he=Pi(ue,$);return he<0?ue.push([$,Q]):ue[he][1]=Q,this},xt.prototype.clear=function(){this.__data__={hash:new an,map:new(Hr||vt),string:new an}},xt.prototype.delete=function($){return Bn(this,$).delete($)},xt.prototype.get=function($){return Bn(this,$).get($)},xt.prototype.has=function($){return Bn(this,$).has($)},xt.prototype.set=function($,Q){return Bn(this,$).set($,Q),this},Wr.prototype.clear=function(){this.__data__=new vt},Wr.prototype.delete=function($){return this.__data__.delete($)},Wr.prototype.get=function($){return this.__data__.get($)},Wr.prototype.has=function($){return this.__data__.has($)},Wr.prototype.set=function($,Q){var ue=this.__data__;if(ue instanceof vt){var he=ue.__data__;if(!Hr||he.length<199)return he.push([$,Q]),this;ue=this.__data__=new xt(he)}return ue.set($,Q),this};var to=_o?Ne(_o,Object):function(){return[]},un=function($){return Ae.call($)};function Lo($,Q){return!!(Q=Q??m)&&(typeof $=="number"||q.test($))&&$>-1&&$%1==0&&$<Q}function Gr($){var Q=$&&$.constructor;return $===(typeof Q=="function"&&Q.prototype||ae)}function cn($){if($!=null){try{return we.call($)}catch{}try{return $+""}catch{}}return""}function Ro($,Q){return $===Q||$!=$&&Q!=Q}(Xi&&un(new Xi(new ArrayBuffer(1)))!=O||Hr&&un(new Hr)!=w||di&&un(di.resolve())!=g||Kt&&un(new Kt)!=T||St&&un(new St)!=k)&&(un=function($){var Q=Ae.call($),ue=Q==p?$.constructor:void 0,he=ue?cn(ue):void 0;if(he)switch(he){case Ni:return O;case sn:return w;case _i:return g;case gi:return T;case Po:return k}return Q});var H=Array.isArray;function te($){return $!=null&&function(Q){return typeof Q=="number"&&Q>-1&&Q%1==0&&Q<=m}($.length)&&!be($)}var le=Cs||function(){return!1};function be($){var Q=Ue($)?Ae.call($):"";return Q==v||Q==b}function Ue($){var Q=typeof $;return!!$&&(Q=="object"||Q=="function")}function Pe($){return te($)?function(Q,ue){var he=H(Q)||function(De){return function(rt){return function(Xe){return!!Xe&&typeof Xe=="object"}(rt)&&te(rt)}(De)&&pe.call(De,"callee")&&(!hi.call(De,"callee")||Ae.call(De)==h)}(Q)?function(De,rt){for(var Xe=-1,fn=Array(De);++Xe<De;)fn[Xe]=rt(Xe);return fn}(Q.length,String):[],Ce=he.length,He=!!Ce;for(var Ze in Q)!pe.call(Q,Ze)||He&&(Ze=="length"||Lo(Ze,Ce))||he.push(Ze);return he}($):function(Q){if(!Gr(Q))return Ls(Q);var ue=[];for(var he in Object(Q))pe.call(Q,he)&&he!="constructor"&&ue.push(he);return ue}($)}s.exports=function($){return Wt($,!0,!0)}},307:(s,c,u)=>{s=u.nmd(s);var d="__lodash_hash_undefined__",m=9007199254740991,h="[object Arguments]",l="[object Array]",a="[object Boolean]",v="[object Date]",b="[object Error]",w="[object Function]",y="[object Map]",p="[object Number]",g="[object Object]",f="[object Promise]",T="[object RegExp]",S="[object Set]",E="[object String]",k="[object WeakMap]",P="[object ArrayBuffer]",O="[object DataView]",x=/^\[object .+?Constructor\]$/,I=/^(?:0|[1-9]\d*)$/,N={};N["[object Float32Array]"]=N["[object Float64Array]"]=N["[object Int8Array]"]=N["[object Int16Array]"]=N["[object Int32Array]"]=N["[object Uint8Array]"]=N["[object Uint8ClampedArray]"]=N["[object Uint16Array]"]=N["[object Uint32Array]"]=!0,N[h]=N[l]=N[P]=N[a]=N[O]=N[v]=N[b]=N[w]=N[y]=N[p]=N[g]=N[T]=N[S]=N[E]=N[k]=!1;var _=typeof u.g=="object"&&u.g&&u.g.Object===Object&&u.g,R=typeof self=="object"&&self&&self.Object===Object&&self,M=_||R||Function("return this")(),F=c&&!c.nodeType&&c,Y=F&&s&&!s.nodeType&&s,J=Y&&Y.exports===F,j=J&&_.process,C=function(){try{return j&&j.binding&&j.binding("util")}catch{}}(),q=C&&C.isTypedArray;function B(H,te){for(var le=-1,be=H==null?0:H.length;++le<be;)if(te(H[le],le,H))return!0;return!1}function K(H){var te=-1,le=Array(H.size);return H.forEach(function(be,Ue){le[++te]=[Ue,be]}),le}function z(H){var te=-1,le=Array(H.size);return H.forEach(function(be){le[++te]=be}),le}var D,U,V,G=Array.prototype,re=Function.prototype,oe=Object.prototype,ge=M["__core-js_shared__"],ve=re.toString,ye=oe.hasOwnProperty,Ne=(D=/[^.]+$/.exec(ge&&ge.keys&&ge.keys.IE_PROTO||""))?"Symbol(src)_1."+D:"",Ke=oe.toString,$e=RegExp("^"+ve.call(ye).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),X=J?M.Buffer:void 0,ee=M.Symbol,ae=M.Uint8Array,ce=oe.propertyIsEnumerable,ie=G.splice,we=ee?ee.toStringTag:void 0,pe=Object.getOwnPropertySymbols,Ae=X?X.isBuffer:void 0,je=(U=Object.keys,V=Object,function(H){return U(V(H))}),ze=xt(M,"DataView"),ke=xt(M,"Map"),ct=xt(M,"Promise"),Re=xt(M,"Set"),yt=xt(M,"WeakMap"),hi=xt(Object,"create"),Ps=Wt(ze),_o=Wt(ke),Cs=Wt(ct),Ls=Wt(Re),Xi=Wt(yt),Hr=ee?ee.prototype:void 0,di=Hr?Hr.valueOf:void 0;function Kt(H){var te=-1,le=H==null?0:H.length;for(this.clear();++te<le;){var be=H[te];this.set(be[0],be[1])}}function St(H){var te=-1,le=H==null?0:H.length;for(this.clear();++te<le;){var be=H[te];this.set(be[0],be[1])}}function Et(H){var te=-1,le=H==null?0:H.length;for(this.clear();++te<le;){var be=H[te];this.set(be[0],be[1])}}function Ni(H){var te=-1,le=H==null?0:H.length;for(this.__data__=new Et;++te<le;)this.add(H[te])}function sn(H){var te=this.__data__=new St(H);this.size=te.size}function _i(H,te){for(var le=H.length;le--;)if(Ci(H[le][0],te))return le;return-1}function gi(H){return H==null?H===void 0?"[object Undefined]":"[object Null]":we&&we in Object(H)?function(te){var le=ye.call(te,we),be=te[we];try{te[we]=void 0;var Ue=!0}catch{}var Pe=Ke.call(te);return Ue&&(le?te[we]=be:delete te[we]),Pe}(H):function(te){return Ke.call(te)}(H)}function Po(H){return Gr(H)&&gi(H)==h}function Qi(H,te,le,be,Ue){return H===te||(H==null||te==null||!Gr(H)&&!Gr(te)?H!=H&&te!=te:function(Pe,$,Q,ue,he,Ce){var He=Bn(Pe),Ze=Bn($),De=He?l:Ht(Pe),rt=Ze?l:Ht($),Xe=(De=De==h?g:De)==g,fn=(rt=rt==h?g:rt)==g,qn=De==rt;if(qn&&ln(Pe)){if(!ln($))return!1;He=!0,Xe=!1}if(qn&&!Xe)return Ce||(Ce=new sn),He||cn(Pe)?eo(Pe,$,Q,ue,he,Ce):function(Le,Fe,Gt,qe,ft,Qe,Yt){switch(Gt){case O:if(Le.byteLength!=Fe.byteLength||Le.byteOffset!=Fe.byteOffset)return!1;Le=Le.buffer,Fe=Fe.buffer;case P:return!(Le.byteLength!=Fe.byteLength||!Qe(new ae(Le),new ae(Fe)));case a:case v:case p:return Ci(+Le,+Fe);case b:return Le.name==Fe.name&&Le.message==Fe.message;case T:case E:return Le==Fe+"";case y:var Zr=K;case S:var no=1&qe;if(Zr||(Zr=z),Le.size!=Fe.size&&!no)return!1;var pi=Yt.get(Le);if(pi)return pi==Fe;qe|=2,Yt.set(Le,Fe);var Mn=eo(Zr(Le),Zr(Fe),qe,ft,Qe,Yt);return Yt.delete(Le),Mn;case"[object Symbol]":if(di)return di.call(Le)==di.call(Fe)}return!1}(Pe,$,De,Q,ue,he,Ce);if(!(1&Q)){var Yr=Xe&&ye.call(Pe,"__wrapped__"),Oe=fn&&ye.call($,"__wrapped__");if(Yr||Oe){var Ve=Yr?Pe.value():Pe,it=Oe?$.value():$;return Ce||(Ce=new sn),he(Ve,it,Q,ue,Ce)}}return!!qn&&(Ce||(Ce=new sn),function(Le,Fe,Gt,qe,ft,Qe){var Yt=1&Gt,Zr=an(Le),no=Zr.length;if(no!=an(Fe).length&&!Yt)return!1;for(var pi=no;pi--;){var Mn=Zr[pi];if(!(Yt?Mn in Fe:ye.call(Fe,Mn)))return!1}var $a=Qe.get(Le);if($a&&Qe.get(Fe))return $a==Fe;var Do=!0;Qe.set(Le,Fe),Qe.set(Fe,Le);for(var Rs=Yt;++pi<no;){var Bo=Le[Mn=Zr[pi]],qo=Fe[Mn];if(qe)var za=Yt?qe(qo,Bo,Mn,Fe,Le,Qe):qe(Bo,qo,Mn,Le,Fe,Qe);if(!(za===void 0?Bo===qo||ft(Bo,qo,Gt,qe,Qe):za)){Do=!1;break}Rs||(Rs=Mn=="constructor")}if(Do&&!Rs){var Mo=Le.constructor,jo=Fe.constructor;Mo==jo||!("constructor"in Le)||!("constructor"in Fe)||typeof Mo=="function"&&Mo instanceof Mo&&typeof jo=="function"&&jo instanceof jo||(Do=!1)}return Qe.delete(Le),Qe.delete(Fe),Do}(Pe,$,Q,ue,he,Ce))}(H,te,le,be,Qi,Ue))}function eo(H,te,le,be,Ue,Pe){var $=1&le,Q=H.length,ue=te.length;if(Q!=ue&&!($&&ue>Q))return!1;var he=Pe.get(H);if(he&&Pe.get(te))return he==te;var Ce=-1,He=!0,Ze=2&le?new Ni:void 0;for(Pe.set(H,te),Pe.set(te,H);++Ce<Q;){var De=H[Ce],rt=te[Ce];if(be)var Xe=$?be(rt,De,Ce,te,H,Pe):be(De,rt,Ce,H,te,Pe);if(Xe!==void 0){if(Xe)continue;He=!1;break}if(Ze){if(!B(te,function(fn,qn){if(Yr=qn,!Ze.has(Yr)&&(De===fn||Ue(De,fn,le,be,Pe)))return Ze.push(qn);var Yr})){He=!1;break}}else if(De!==rt&&!Ue(De,rt,le,be,Pe)){He=!1;break}}return Pe.delete(H),Pe.delete(te),He}function an(H){return function(te,le,be){var Ue=le(te);return Bn(te)?Ue:function(Pe,$){for(var Q=-1,ue=$.length,he=Pe.length;++Q<ue;)Pe[he+Q]=$[Q];return Pe}(Ue,be(te))}(H,Ro,Wr)}function vt(H,te){var le,be,Ue=H.__data__;return((be=typeof(le=te))=="string"||be=="number"||be=="symbol"||be=="boolean"?le!=="__proto__":le===null)?Ue[typeof te=="string"?"string":"hash"]:Ue.map}function xt(H,te){var le=function(be,Ue){return be==null?void 0:be[Ue]}(H,te);return function(be){return!(!Lo(be)||function(Ue){return!!Ne&&Ne in Ue}(be))&&(to(be)?$e:x).test(Wt(be))}(le)?le:void 0}Kt.prototype.clear=function(){this.__data__=hi?hi(null):{},this.size=0},Kt.prototype.delete=function(H){var te=this.has(H)&&delete this.__data__[H];return this.size-=te?1:0,te},Kt.prototype.get=function(H){var te=this.__data__;if(hi){var le=te[H];return le===d?void 0:le}return ye.call(te,H)?te[H]:void 0},Kt.prototype.has=function(H){var te=this.__data__;return hi?te[H]!==void 0:ye.call(te,H)},Kt.prototype.set=function(H,te){var le=this.__data__;return this.size+=this.has(H)?0:1,le[H]=hi&&te===void 0?d:te,this},St.prototype.clear=function(){this.__data__=[],this.size=0},St.prototype.delete=function(H){var te=this.__data__,le=_i(te,H);return!(le<0||(le==te.length-1?te.pop():ie.call(te,le,1),--this.size,0))},St.prototype.get=function(H){var te=this.__data__,le=_i(te,H);return le<0?void 0:te[le][1]},St.prototype.has=function(H){return _i(this.__data__,H)>-1},St.prototype.set=function(H,te){var le=this.__data__,be=_i(le,H);return be<0?(++this.size,le.push([H,te])):le[be][1]=te,this},Et.prototype.clear=function(){this.size=0,this.__data__={hash:new Kt,map:new(ke||St),string:new Kt}},Et.prototype.delete=function(H){var te=vt(this,H).delete(H);return this.size-=te?1:0,te},Et.prototype.get=function(H){return vt(this,H).get(H)},Et.prototype.has=function(H){return vt(this,H).has(H)},Et.prototype.set=function(H,te){var le=vt(this,H),be=le.size;return le.set(H,te),this.size+=le.size==be?0:1,this},Ni.prototype.add=Ni.prototype.push=function(H){return this.__data__.set(H,d),this},Ni.prototype.has=function(H){return this.__data__.has(H)},sn.prototype.clear=function(){this.__data__=new St,this.size=0},sn.prototype.delete=function(H){var te=this.__data__,le=te.delete(H);return this.size=te.size,le},sn.prototype.get=function(H){return this.__data__.get(H)},sn.prototype.has=function(H){return this.__data__.has(H)},sn.prototype.set=function(H,te){var le=this.__data__;if(le instanceof St){var be=le.__data__;if(!ke||be.length<199)return be.push([H,te]),this.size=++le.size,this;le=this.__data__=new Et(be)}return le.set(H,te),this.size=le.size,this};var Wr=pe?function(H){return H==null?[]:(H=Object(H),function(te,le){for(var be=-1,Ue=te==null?0:te.length,Pe=0,$=[];++be<Ue;){var Q=te[be];ue=Q,ce.call(H,ue)&&($[Pe++]=Q)}var ue;return $}(pe(H)))}:function(){return[]},Ht=gi;function Pi(H,te){return!!(te=te??m)&&(typeof H=="number"||I.test(H))&&H>-1&&H%1==0&&H<te}function Wt(H){if(H!=null){try{return ve.call(H)}catch{}try{return H+""}catch{}}return""}function Ci(H,te){return H===te||H!=H&&te!=te}(ze&&Ht(new ze(new ArrayBuffer(1)))!=O||ke&&Ht(new ke)!=y||ct&&Ht(ct.resolve())!=f||Re&&Ht(new Re)!=S||yt&&Ht(new yt)!=k)&&(Ht=function(H){var te=gi(H),le=te==g?H.constructor:void 0,be=le?Wt(le):"";if(be)switch(be){case Ps:return O;case _o:return y;case Cs:return f;case Ls:return S;case Xi:return k}return te});var Co=Po(function(){return arguments}())?Po:function(H){return Gr(H)&&ye.call(H,"callee")&&!ce.call(H,"callee")},Bn=Array.isArray,ln=Ae||function(){return!1};function to(H){if(!Lo(H))return!1;var te=gi(H);return te==w||te=="[object GeneratorFunction]"||te=="[object AsyncFunction]"||te=="[object Proxy]"}function un(H){return typeof H=="number"&&H>-1&&H%1==0&&H<=m}function Lo(H){var te=typeof H;return H!=null&&(te=="object"||te=="function")}function Gr(H){return H!=null&&typeof H=="object"}var cn=q?function(H){return function(te){return H(te)}}(q):function(H){return Gr(H)&&un(H.length)&&!!N[gi(H)]};function Ro(H){return(te=H)!=null&&un(te.length)&&!to(te)?function(le,be){var Ue=Bn(le),Pe=!Ue&&Co(le),$=!Ue&&!Pe&&ln(le),Q=!Ue&&!Pe&&!$&&cn(le),ue=Ue||Pe||$||Q,he=ue?function(Ze,De){for(var rt=-1,Xe=Array(Ze);++rt<Ze;)Xe[rt]=De(rt);return Xe}(le.length,String):[],Ce=he.length;for(var He in le)!ye.call(le,He)||ue&&(He=="length"||$&&(He=="offset"||He=="parent")||Q&&(He=="buffer"||He=="byteLength"||He=="byteOffset")||Pi(He,Ce))||he.push(He);return he}(H):function(le){if(Ue=(be=le)&&be.constructor,be!==(typeof Ue=="function"&&Ue.prototype||oe))return je(le);var be,Ue,Pe=[];for(var $ in Object(le))ye.call(le,$)&&$!="constructor"&&Pe.push($);return Pe}(H);var te}s.exports=function(H,te){return Qi(H,te)}},210:function(s,c,u){var d=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0});var m,h=d(u(465)),l=d(u(307));(function(a){a.compose=function(v,b,w){v===void 0&&(v={}),b===void 0&&(b={}),typeof v!="object"&&(v={}),typeof b!="object"&&(b={});var y=h.default(b);for(var p in w||(y=Object.keys(y).reduce(function(g,f){return y[f]!=null&&(g[f]=y[f]),g},{})),v)v[p]!==void 0&&b[p]===void 0&&(y[p]=v[p]);return Object.keys(y).length>0?y:void 0},a.diff=function(v,b){v===void 0&&(v={}),b===void 0&&(b={}),typeof v!="object"&&(v={}),typeof b!="object"&&(b={});var w=Object.keys(v).concat(Object.keys(b)).reduce(function(y,p){return l.default(v[p],b[p])||(y[p]=b[p]===void 0?null:b[p]),y},{});return Object.keys(w).length>0?w:void 0},a.invert=function(v,b){v===void 0&&(v={}),b===void 0&&(b={}),v=v||{};var w=Object.keys(b).reduce(function(y,p){return b[p]!==v[p]&&v[p]!==void 0&&(y[p]=b[p]),y},{});return Object.keys(v).reduce(function(y,p){return v[p]!==b[p]&&b[p]===void 0&&(y[p]=null),y},w)},a.transform=function(v,b,w){if(w===void 0&&(w=!1),typeof v!="object")return b;if(typeof b=="object"){if(!w)return b;var y=Object.keys(b).reduce(function(p,g){return v[g]===void 0&&(p[g]=b[g]),p},{});return Object.keys(y).length>0?y:void 0}}})(m||(m={})),c.default=m},895:function(s,c,u){var d=this&&this.__importDefault||function(y){return y&&y.__esModule?y:{default:y}},m=d(u(529)),h=d(u(465)),l=d(u(307)),a=d(u(210)),v=d(u(430)),b="\0",w=function(){function y(p){Array.isArray(p)?this.ops=p:p!=null&&Array.isArray(p.ops)?this.ops=p.ops:this.ops=[]}return y.prototype.insert=function(p,g){var f={};return typeof p=="string"&&p.length===0?this:(f.insert=p,g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(f.attributes=g),this.push(f))},y.prototype.delete=function(p){return p<=0?this:this.push({delete:p})},y.prototype.retain=function(p,g){if(p<=0)return this;var f={retain:p};return g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(f.attributes=g),this.push(f)},y.prototype.push=function(p){var g=this.ops.length,f=this.ops[g-1];if(p=h.default(p),typeof f=="object"){if(typeof p.delete=="number"&&typeof f.delete=="number")return this.ops[g-1]={delete:f.delete+p.delete},this;if(typeof f.delete=="number"&&p.insert!=null&&(g-=1,typeof(f=this.ops[g-1])!="object"))return this.ops.unshift(p),this;if(l.default(p.attributes,f.attributes)){if(typeof p.insert=="string"&&typeof f.insert=="string")return this.ops[g-1]={insert:f.insert+p.insert},typeof p.attributes=="object"&&(this.ops[g-1].attributes=p.attributes),this;if(typeof p.retain=="number"&&typeof f.retain=="number")return this.ops[g-1]={retain:f.retain+p.retain},typeof p.attributes=="object"&&(this.ops[g-1].attributes=p.attributes),this}}return g===this.ops.length?this.ops.push(p):this.ops.splice(g,0,p),this},y.prototype.chop=function(){var p=this.ops[this.ops.length-1];return p&&p.retain&&!p.attributes&&this.ops.pop(),this},y.prototype.filter=function(p){return this.ops.filter(p)},y.prototype.forEach=function(p){this.ops.forEach(p)},y.prototype.map=function(p){return this.ops.map(p)},y.prototype.partition=function(p){var g=[],f=[];return this.forEach(function(T){(p(T)?g:f).push(T)}),[g,f]},y.prototype.reduce=function(p,g){return this.ops.reduce(p,g)},y.prototype.changeLength=function(){return this.reduce(function(p,g){return g.insert?p+v.default.length(g):g.delete?p-g.delete:p},0)},y.prototype.length=function(){return this.reduce(function(p,g){return p+v.default.length(g)},0)},y.prototype.slice=function(p,g){p===void 0&&(p=0),g===void 0&&(g=1/0);for(var f=[],T=v.default.iterator(this.ops),S=0;S<g&&T.hasNext();){var E=void 0;S<p?E=T.next(p-S):(E=T.next(g-S),f.push(E)),S+=v.default.length(E)}return new y(f)},y.prototype.compose=function(p){var g=v.default.iterator(this.ops),f=v.default.iterator(p.ops),T=[],S=f.peek();if(S!=null&&typeof S.retain=="number"&&S.attributes==null){for(var E=S.retain;g.peekType()==="insert"&&g.peekLength()<=E;)E-=g.peekLength(),T.push(g.next());S.retain-E>0&&f.next(S.retain-E)}for(var k=new y(T);g.hasNext()||f.hasNext();)if(f.peekType()==="insert")k.push(f.next());else if(g.peekType()==="delete")k.push(g.next());else{var P=Math.min(g.peekLength(),f.peekLength()),O=g.next(P),x=f.next(P);if(typeof x.retain=="number"){var I={};typeof O.retain=="number"?I.retain=P:I.insert=O.insert;var N=a.default.compose(O.attributes,x.attributes,typeof O.retain=="number");if(N&&(I.attributes=N),k.push(I),!f.hasNext()&&l.default(k.ops[k.ops.length-1],I)){var _=new y(g.rest());return k.concat(_).chop()}}else typeof x.delete=="number"&&typeof O.retain=="number"&&k.push(x)}return k.chop()},y.prototype.concat=function(p){var g=new y(this.ops.slice());return p.ops.length>0&&(g.push(p.ops[0]),g.ops=g.ops.concat(p.ops.slice(1))),g},y.prototype.diff=function(p,g){if(this.ops===p.ops)return new y;var f=[this,p].map(function(P){return P.map(function(O){if(O.insert!=null)return typeof O.insert=="string"?O.insert:b;throw new Error("diff() called "+(P===p?"on":"with")+" non-document")}).join("")}),T=new y,S=m.default(f[0],f[1],g),E=v.default.iterator(this.ops),k=v.default.iterator(p.ops);return S.forEach(function(P){for(var O=P[1].length;O>0;){var x=0;switch(P[0]){case m.default.INSERT:x=Math.min(k.peekLength(),O),T.push(k.next(x));break;case m.default.DELETE:x=Math.min(O,E.peekLength()),E.next(x),T.delete(x);break;case m.default.EQUAL:x=Math.min(E.peekLength(),k.peekLength(),O);var I=E.next(x),N=k.next(x);l.default(I.insert,N.insert)?T.retain(x,a.default.diff(I.attributes,N.attributes)):T.push(N).delete(x)}O-=x}}),T.chop()},y.prototype.eachLine=function(p,g){g===void 0&&(g=`
`);for(var f=v.default.iterator(this.ops),T=new y,S=0;f.hasNext();){if(f.peekType()!=="insert")return;var E=f.peek(),k=v.default.length(E)-f.peekLength(),P=typeof E.insert=="string"?E.insert.indexOf(g,k)-k:-1;if(P<0)T.push(f.next());else if(P>0)T.push(f.next(P));else{if(p(T,f.next(1).attributes||{},S)===!1)return;S+=1,T=new y}}T.length()>0&&p(T,{},S)},y.prototype.invert=function(p){var g=new y;return this.reduce(function(f,T){if(T.insert)g.delete(v.default.length(T));else{if(T.retain&&T.attributes==null)return g.retain(T.retain),f+T.retain;if(T.delete||T.retain&&T.attributes){var S=T.delete||T.retain;return p.slice(f,f+S).forEach(function(E){T.delete?g.push(E):T.retain&&T.attributes&&g.retain(v.default.length(E),a.default.invert(T.attributes,E.attributes))}),f+S}}return f},0),g.chop()},y.prototype.transform=function(p,g){if(g===void 0&&(g=!1),g=!!g,typeof p=="number")return this.transformPosition(p,g);for(var f=p,T=v.default.iterator(this.ops),S=v.default.iterator(f.ops),E=new y;T.hasNext()||S.hasNext();)if(T.peekType()!=="insert"||!g&&S.peekType()==="insert")if(S.peekType()==="insert")E.push(S.next());else{var k=Math.min(T.peekLength(),S.peekLength()),P=T.next(k),O=S.next(k);if(P.delete)continue;O.delete?E.push(O):E.retain(k,a.default.transform(P.attributes,O.attributes,g))}else E.retain(v.default.length(T.next()));return E.chop()},y.prototype.transformPosition=function(p,g){g===void 0&&(g=!1),g=!!g;for(var f=v.default.iterator(this.ops),T=0;f.hasNext()&&T<=p;){var S=f.peekLength(),E=f.peekType();f.next(),E!=="delete"?(E==="insert"&&(T<p||!g)&&(p+=S),T+=S):p-=Math.min(S,p-T)}return p},y.Op=v.default,y.AttributeMap=a.default,y}();s.exports=w},977:function(s,c,u){var d=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(c,"__esModule",{value:!0});var m=d(u(430)),h=function(){function l(a){this.ops=a,this.index=0,this.offset=0}return l.prototype.hasNext=function(){return this.peekLength()<1/0},l.prototype.next=function(a){a||(a=1/0);var v=this.ops[this.index];if(v){var b=this.offset,w=m.default.length(v);if(a>=w-b?(a=w-b,this.index+=1,this.offset=0):this.offset+=a,typeof v.delete=="number")return{delete:a};var y={};return v.attributes&&(y.attributes=v.attributes),typeof v.retain=="number"?y.retain=a:typeof v.insert=="string"?y.insert=v.insert.substr(b,a):y.insert=v.insert,y}return{retain:1/0}},l.prototype.peek=function(){return this.ops[this.index]},l.prototype.peekLength=function(){return this.ops[this.index]?m.default.length(this.ops[this.index])-this.offset:1/0},l.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},l.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var a=this.offset,v=this.index,b=this.next(),w=this.ops.slice(this.index);return this.offset=a,this.index=v,[b].concat(w)}return[]},l}();c.default=h},430:function(s,c,u){var d=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(c,"__esModule",{value:!0});var m,h=d(u(977));(function(l){l.iterator=function(a){return new h.default(a)},l.length=function(a){return typeof a.delete=="number"?a.delete:typeof a.retain=="number"?a.retain:typeof a.insert=="string"?a.insert.length:1}})(m||(m={})),c.default=m},165:function(s,c,u){var d,m;(m=typeof(d=function(){var h,l={};function a(w,y,p){var g=w.getClientRects();if(g.length===2){var f=w.getBoundingClientRect();return g[y][p]<f[p]}return!1}function v(w){if(!w||screen.deviceXDPI===screen.logicalXDPI)return w;if("length"in w)return Array.prototype.map.call(w,v);var y=screen.deviceXDPI/screen.logicalXDPI;return{top:w.top/y,bottom:w.bottom/y,left:w.left/y,right:w.right/y,width:w.width/y,height:w.height/y}}function b(w,y){var p,g=0,f=1024;if(f>=y.length)return Array.prototype.push.apply(w,y);for(;g<y.length;)p=Array.prototype.push.apply(w,Array.prototype.slice.call(y,g,g+f)),g+=f;return p}return l.isBroken=function(){if(h===void 0){var w=document.createElement("p"),y=document.createElement("span"),p=document.createTextNode("aa"),g=document.createTextNode("aa"),f=document.createElement("img");f.setAttribute("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=");var T=document.createRange();if(h={},w.appendChild(p),w.appendChild(y),y.appendChild(f),y.appendChild(g),document.body.appendChild(w),T.setStart(p,1),T.setEnd(y,0),h.getClientRects=h.getBoundingClientRect=T.getClientRects().length>1,h.getClientRects||(T.setEnd(g,1),h.getClientRects=h.getBoundingClientRect=T.getClientRects().length===2),!h.getBoundingClientRect){T.setEnd(T.startContainer,T.startOffset);var S=T.getBoundingClientRect();h.getBoundingClientRect=S.top===0&&S.left===0}if(document.body.removeChild(w),!h.getBoundingClientRect){var E=document.createElement("p");E.style.width="0px",E.style.fontSize="20px",E.style.whiteSpace="normal",E.style.wordBreak="normal";var k=document.createTextNode("m mm");E.appendChild(k),document.body.appendChild(E),T.setStart(k,1),T.setEnd(k,2),a(T,1,"left")?h.getBoundingClientRect=!0:(T.setStart(k,1),T.setEnd(k,3),a(T,0,"top")&&(h.getBoundingClientRect=!0)),document.body.removeChild(E)}var P=window.ActiveXObject&&new Function("/*@cc_on return @_jscript_version; @*/")();h.ieZoom=!!P&&P<=10}return h},l.getClientRects=function(w){var y=this.isBroken();if(y.ieZoom)return v(w.getClientRects());if(!y.getClientRects)return w.getClientRects();var p=[],g=[],f=w.endContainer,T=w.endOffset,S=document.createRange();function E(k){for(var P=0;k=k.previousSibling;)P++;return P}for(;f!==w.commonAncestorContainer;)S.setStart(f,0),S.setEnd(f,T),b(g,S.getClientRects()),T=E(f),f=f.parentNode;return(S=w.cloneRange()).setEnd(f,T),b(p,S.getClientRects()),b(p,g),p},l.getBoundingClientRect=function(w){var y=this.getClientRects(w);if(y.length===0)return null;var p,g=w.getBoundingClientRect(),f=this.isBroken();if(f.ieZoom)return v(g);if(!f.getBoundingClientRect)return g;if(g.width===0&&g.height===0)return y[0];for(var T=0,S=y.length;T<S;T++){var E=y[T];p?(p.left=Math.min(p.left,E.left),p.top=Math.min(p.top,E.top),p.right=Math.max(p.right,E.right),p.bottom=Math.max(p.bottom,E.bottom)):p={left:E.left,top:E.top,right:E.right,bottom:E.bottom}}return p&&(p.width=p.right-p.left,p.height=p.bottom-p.top),p},l})=="function"?d.call(c,u,c,s):d)===void 0||(s.exports=m)},33:(s,c,u)=>{u.r(c),u.d(c,{default:()=>N});var d=function(){if(typeof Map<"u")return Map;function _(R,M){var F=-1;return R.some(function(Y,J){return Y[0]===M&&(F=J,!0)}),F}return function(){function R(){this.__entries__=[]}return Object.defineProperty(R.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),R.prototype.get=function(M){var F=_(this.__entries__,M),Y=this.__entries__[F];return Y&&Y[1]},R.prototype.set=function(M,F){var Y=_(this.__entries__,M);~Y?this.__entries__[Y][1]=F:this.__entries__.push([M,F])},R.prototype.delete=function(M){var F=this.__entries__,Y=_(F,M);~Y&&F.splice(Y,1)},R.prototype.has=function(M){return!!~_(this.__entries__,M)},R.prototype.clear=function(){this.__entries__.splice(0)},R.prototype.forEach=function(M,F){F===void 0&&(F=null);for(var Y=0,J=this.__entries__;Y<J.length;Y++){var j=J[Y];M.call(F,j[1],j[0])}},R}()}(),m=typeof window<"u"&&typeof document<"u"&&window.document===document,h=u.g!==void 0&&u.g.Math===Math?u.g:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")(),l=typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(h):function(_){return setTimeout(function(){return _(Date.now())},1e3/60)},a=["top","right","bottom","left","width","height","size","weight"],v=typeof MutationObserver<"u",b=function(){function _(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(R,M){var F=!1,Y=!1,J=0;function j(){F&&(F=!1,R()),Y&&q()}function C(){l(j)}function q(){var B=Date.now();if(F){if(B-J<2)return;Y=!0}else F=!0,Y=!1,setTimeout(C,20);J=B}return q}(this.refresh.bind(this))}return _.prototype.addObserver=function(R){~this.observers_.indexOf(R)||this.observers_.push(R),this.connected_||this.connect_()},_.prototype.removeObserver=function(R){var M=this.observers_,F=M.indexOf(R);~F&&M.splice(F,1),!M.length&&this.connected_&&this.disconnect_()},_.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},_.prototype.updateObservers_=function(){var R=this.observers_.filter(function(M){return M.gatherActive(),M.hasActive()});return R.forEach(function(M){return M.broadcastActive()}),R.length>0},_.prototype.connect_=function(){m&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),v?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},_.prototype.disconnect_=function(){m&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},_.prototype.onTransitionEnd_=function(R){var M=R.propertyName,F=M===void 0?"":M;a.some(function(Y){return!!~F.indexOf(Y)})&&this.refresh()},_.getInstance=function(){return this.instance_||(this.instance_=new _),this.instance_},_.instance_=null,_}(),w=function(_,R){for(var M=0,F=Object.keys(R);M<F.length;M++){var Y=F[M];Object.defineProperty(_,Y,{value:R[Y],enumerable:!1,writable:!1,configurable:!0})}return _},y=function(_){return _&&_.ownerDocument&&_.ownerDocument.defaultView||h},p=E(0,0,0,0);function g(_){return parseFloat(_)||0}function f(_){for(var R=[],M=1;M<arguments.length;M++)R[M-1]=arguments[M];return R.reduce(function(F,Y){return F+g(_["border-"+Y+"-width"])},0)}var T=typeof SVGGraphicsElement<"u"?function(_){return _ instanceof y(_).SVGGraphicsElement}:function(_){return _ instanceof y(_).SVGElement&&typeof _.getBBox=="function"};function S(_){return m?T(_)?function(R){var M=R.getBBox();return E(0,0,M.width,M.height)}(_):function(R){var M=R.clientWidth,F=R.clientHeight;if(!M&&!F)return p;var Y=y(R).getComputedStyle(R),J=function(D){for(var U={},V=0,G=["top","right","bottom","left"];V<G.length;V++){var re=G[V],oe=D["padding-"+re];U[re]=g(oe)}return U}(Y),j=J.left+J.right,C=J.top+J.bottom,q=g(Y.width),B=g(Y.height);if(Y.boxSizing==="border-box"&&(Math.round(q+j)!==M&&(q-=f(Y,"left","right")+j),Math.round(B+C)!==F&&(B-=f(Y,"top","bottom")+C)),!function(D){return D===y(D).document.documentElement}(R)){var K=Math.round(q+j)-M,z=Math.round(B+C)-F;Math.abs(K)!==1&&(q-=K),Math.abs(z)!==1&&(B-=z)}return E(J.left,J.top,q,B)}(_):p}function E(_,R,M,F){return{x:_,y:R,width:M,height:F}}var k=function(){function _(R){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=E(0,0,0,0),this.target=R}return _.prototype.isActive=function(){var R=S(this.target);return this.contentRect_=R,R.width!==this.broadcastWidth||R.height!==this.broadcastHeight},_.prototype.broadcastRect=function(){var R=this.contentRect_;return this.broadcastWidth=R.width,this.broadcastHeight=R.height,R},_}(),P=function(_,R){var M,F,Y,J,j,C,q,B=(F=(M=R).x,Y=M.y,J=M.width,j=M.height,C=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,q=Object.create(C.prototype),w(q,{x:F,y:Y,width:J,height:j,top:Y,right:F+J,bottom:j+Y,left:F}),q);w(this,{target:_,contentRect:B})},O=function(){function _(R,M,F){if(this.activeObservations_=[],this.observations_=new d,typeof R!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=R,this.controller_=M,this.callbackCtx_=F}return _.prototype.observe=function(R){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element<"u"&&Element instanceof Object){if(!(R instanceof y(R).Element))throw new TypeError('parameter 1 is not of type "Element".');var M=this.observations_;M.has(R)||(M.set(R,new k(R)),this.controller_.addObserver(this),this.controller_.refresh())}},_.prototype.unobserve=function(R){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element<"u"&&Element instanceof Object){if(!(R instanceof y(R).Element))throw new TypeError('parameter 1 is not of type "Element".');var M=this.observations_;M.has(R)&&(M.delete(R),M.size||this.controller_.removeObserver(this))}},_.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},_.prototype.gatherActive=function(){var R=this;this.clearActive(),this.observations_.forEach(function(M){M.isActive()&&R.activeObservations_.push(M)})},_.prototype.broadcastActive=function(){if(this.hasActive()){var R=this.callbackCtx_,M=this.activeObservations_.map(function(F){return new P(F.target,F.broadcastRect())});this.callback_.call(R,M,R),this.clearActive()}},_.prototype.clearActive=function(){this.activeObservations_.splice(0)},_.prototype.hasActive=function(){return this.activeObservations_.length>0},_}(),x=typeof WeakMap<"u"?new WeakMap:new d,I=function _(R){if(!(this instanceof _))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var M=b.getInstance(),F=new O(R,M,this);x.set(this,F)};["observe","unobserve","disconnect"].forEach(function(_){I.prototype[_]=function(){var R;return(R=x.get(this))[_].apply(R,arguments)}});const N=h.ResizeObserver!==void 0?h.ResizeObserver:I},413:(s,c,u)=>{u.r(c),u.d(c,{default:()=>E});var d=u(379),m=u.n(d),h=u(795),l=u.n(h),a=u(569),v=u.n(a),b=u(565),w=u.n(b),y=u(216),p=u.n(y),g=u(589),f=u.n(g),T=u(582),S={};S.styleTagTransform=f(),S.setAttributes=w(),S.insert=v().bind(null,"head"),S.domAPI=l(),S.insertStyleElement=p(),m()(T.Z,S);const E=T.Z&&T.Z.locals?T.Z.locals:void 0},379:s=>{var c=[];function u(h){for(var l=-1,a=0;a<c.length;a++)if(c[a].identifier===h){l=a;break}return l}function d(h,l){for(var a={},v=[],b=0;b<h.length;b++){var w=h[b],y=l.base?w[0]+l.base:w[0],p=a[y]||0,g="".concat(y," ").concat(p);a[y]=p+1;var f=u(g),T={css:w[1],media:w[2],sourceMap:w[3],supports:w[4],layer:w[5]};if(f!==-1)c[f].references++,c[f].updater(T);else{var S=m(T,l);l.byIndex=b,c.splice(b,0,{identifier:g,updater:S,references:1})}v.push(g)}return v}function m(h,l){var a=l.domAPI(l);return a.update(h),function(v){if(v){if(v.css===h.css&&v.media===h.media&&v.sourceMap===h.sourceMap&&v.supports===h.supports&&v.layer===h.layer)return;a.update(h=v)}else a.remove()}}s.exports=function(h,l){var a=d(h=h||[],l=l||{});return function(v){v=v||[];for(var b=0;b<a.length;b++){var w=u(a[b]);c[w].references--}for(var y=d(v,l),p=0;p<a.length;p++){var g=u(a[p]);c[g].references===0&&(c[g].updater(),c.splice(g,1))}a=y}}},569:s=>{var c={};s.exports=function(u,d){var m=function(h){if(c[h]===void 0){var l=document.querySelector(h);if(window.HTMLIFrameElement&&l instanceof window.HTMLIFrameElement)try{l=l.contentDocument.head}catch{l=null}c[h]=l}return c[h]}(u);if(!m)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");m.appendChild(d)}},216:s=>{s.exports=function(c){var u=document.createElement("style");return c.setAttributes(u,c.attributes),c.insert(u,c.options),u}},565:(s,c,u)=>{s.exports=function(d){var m=u.nc;m&&d.setAttribute("nonce",m)}},795:s=>{s.exports=function(c){var u=c.insertStyleElement(c);return{update:function(d){(function(m,h,l){var a="";l.supports&&(a+="@supports (".concat(l.supports,") {")),l.media&&(a+="@media ".concat(l.media," {"));var v=l.layer!==void 0;v&&(a+="@layer".concat(l.layer.length>0?" ".concat(l.layer):""," {")),a+=l.css,v&&(a+="}"),l.media&&(a+="}"),l.supports&&(a+="}");var b=l.sourceMap;b&&typeof btoa<"u"&&(a+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(b))))," */")),h.styleTagTransform(a,m,h.options)})(u,c,d)},remove:function(){(function(d){if(d.parentNode===null)return!1;d.parentNode.removeChild(d)})(u)}}}},589:s=>{s.exports=function(c,u){if(u.styleSheet)u.styleSheet.cssText=c;else{for(;u.firstChild;)u.removeChild(u.firstChild);u.appendChild(document.createTextNode(c))}}},607:function(s,c,u){var d=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(c,"__esModule",{value:!0}),c.Cursor=c.default=void 0;var m=d(u(678));c.default=m.default;var h=d(u(353));c.Cursor=h.default,u(413)},353:(s,c)=>{Object.defineProperty(c,"__esModule",{value:!0});var u=function(){function d(m,h,l){this.id=m,this.name=h,this.color=l,this.toggleNearCursor=this.toggleNearCursor.bind(this),this._toggleOpenedCursor=this._toggleOpenedCursor.bind(this),this._setHoverState=this._setHoverState.bind(this)}return d.prototype.build=function(m){var h=document.createElement(d.CONTAINER_ELEMENT_TAG);h.classList.add(d.CURSOR_CLASS),h.id="ql-cursor-".concat(this.id),h.innerHTML=m.template;var l=h.getElementsByClassName(d.SELECTION_CLASS)[0],a=h.getElementsByClassName(d.CARET_CONTAINER_CLASS)[0],v=a.getElementsByClassName(d.CARET_CLASS)[0],b=h.getElementsByClassName(d.FLAG_CLASS)[0];return b.style.backgroundColor=this.color,v.style.backgroundColor=this.color,h.getElementsByClassName(d.NAME_CLASS)[0].textContent=this.name,this._hideDelay="".concat(m.hideDelayMs,"ms"),this._hideSpeedMs=m.hideSpeedMs,this._positionFlag=m.positionFlag,b.style.transitionDelay=this._hideDelay,b.style.transitionDuration="".concat(this._hideSpeedMs,"ms"),this._el=h,this._selectionEl=l,this._caretEl=a,this._flagEl=b,a.addEventListener("mouseover",this._setHoverState,{passive:!0}),this._el},d.prototype.show=function(){this._el.classList.remove(d.HIDDEN_CLASS)},d.prototype.hide=function(){this._el.classList.add(d.HIDDEN_CLASS)},d.prototype.remove=function(){this._el.parentNode.removeChild(this._el)},d.prototype.toggleNearCursor=function(m,h){var l=this._getCoordinates(),a=l.left,v=l.right,b=l.top,w=l.bottom,y=m>=a&&m<=v&&h>=b&&h<=w;return this._caretEl.classList.toggle(d.CONTAINER_HOVER_CLASS,y),y},d.prototype.toggleFlag=function(m){var h=this;this._caretEl.classList.toggle(d.CONTAINER_HOVER_CLASS,m)||(this._flagEl.classList.add(d.NO_DELAY_CLASS),setTimeout(function(){return h._flagEl.classList.remove(d.NO_DELAY_CLASS)},this._hideSpeedMs))},d.prototype.updateCaret=function(m,h){this._caretEl.style.top="".concat(m.top,"px"),this._caretEl.style.left="".concat(m.left,"px"),this._caretEl.style.height="".concat(m.height,"px"),this._positionFlag?this._positionFlag(this._flagEl,m,h):this._updateCaretFlag(m,h)},d.prototype.updateSelection=function(m,h){var l=this;this._clearSelection(),m=m||[],m=Array.from(m),m=this._sanitize(m),(m=this._sortByDomPosition(m)).forEach(function(a){return l._addSelection(a,h)})},d.prototype._setHoverState=function(){document.addEventListener("mousemove",this._toggleOpenedCursor,{passive:!0})},d.prototype._toggleOpenedCursor=function(m){var h=this.toggleNearCursor(m.clientX,m.clientY);this._caretEl.classList.toggle(d.CONTAINER_NO_POINTER_CLASS,h),h||document.removeEventListener("mousemove",this._toggleOpenedCursor)},d.prototype._getCoordinates=function(){return this._caretEl.getBoundingClientRect()},d.prototype._updateCaretFlag=function(m,h){this._flagEl.style.width="";var l=this._flagEl.getBoundingClientRect();this._flagEl.classList.remove(d.FLAG_FLIPPED_CLASS),m.left>h.width-l.width&&this._flagEl.classList.add(d.FLAG_FLIPPED_CLASS),this._flagEl.style.left="".concat(m.left,"px"),this._flagEl.style.top="".concat(m.top,"px"),this._flagEl.style.width="".concat(Math.ceil(l.width),"px")},d.prototype._clearSelection=function(){this._selectionEl.innerHTML=""},d.prototype._addSelection=function(m,h){var l=this._selectionBlock(m,h);this._selectionEl.appendChild(l)},d.prototype._selectionBlock=function(m,h){var l=document.createElement(d.SELECTION_ELEMENT_TAG);return l.classList.add(d.SELECTION_BLOCK_CLASS),l.style.top="".concat(m.top-h.top,"px"),l.style.left="".concat(m.left-h.left,"px"),l.style.width="".concat(m.width,"px"),l.style.height="".concat(m.height,"px"),l.style.backgroundColor=this.color,l.style.opacity="0.3",l},d.prototype._sortByDomPosition=function(m){return m.sort(function(h,l){return h.top===l.top?h.left-l.left:h.top-l.top})},d.prototype._sanitize=function(m){var h=this,l=new Set;return m.filter(function(a){if(!a.width||!a.height)return!1;var v=h._serialize(a);return!l.has(v)&&(l.add(v),!0)})},d.prototype._serialize=function(m){return["top:".concat(m.top),"right:".concat(m.right),"bottom:".concat(m.bottom),"left:".concat(m.left)].join(";")},d.CONTAINER_ELEMENT_TAG="SPAN",d.SELECTION_ELEMENT_TAG="SPAN",d.CURSOR_CLASS="ql-cursor",d.SELECTION_CLASS="ql-cursor-selections",d.SELECTION_BLOCK_CLASS="ql-cursor-selection-block",d.CARET_CLASS="ql-cursor-caret",d.CARET_CONTAINER_CLASS="ql-cursor-caret-container",d.CONTAINER_HOVER_CLASS="hover",d.CONTAINER_NO_POINTER_CLASS="no-pointer",d.FLAG_CLASS="ql-cursor-flag",d.FLAG_FLIPPED_CLASS="flag-flipped",d.NAME_CLASS="ql-cursor-name",d.HIDDEN_CLASS="hidden",d.NO_DELAY_CLASS="no-delay",d}();c.default=u},678:function(s,c,u){var d=this&&this.__createBinding||(Object.create?function(g,f,T,S){S===void 0&&(S=T);var E=Object.getOwnPropertyDescriptor(f,T);E&&!("get"in E?!f.__esModule:E.writable||E.configurable)||(E={enumerable:!0,get:function(){return f[T]}}),Object.defineProperty(g,S,E)}:function(g,f,T,S){S===void 0&&(S=T),g[S]=f[T]}),m=this&&this.__setModuleDefault||(Object.create?function(g,f){Object.defineProperty(g,"default",{enumerable:!0,value:f})}:function(g,f){g.default=f}),h=this&&this.__importStar||function(g){if(g&&g.__esModule)return g;var f={};if(g!=null)for(var T in g)T!=="default"&&Object.prototype.hasOwnProperty.call(g,T)&&d(f,g,T);return m(f,g),f},l=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(c,"__esModule",{value:!0});var a=l(u(353)),v=h(u(165)),b=l(u(338)),w=l(u(33)),y=u(895),p=function(){function g(f,T){T===void 0&&(T={}),this._cursors={},this._isObserving=!1,this._handleCursorTouch=this._handleCursorTouch.bind(this),this.quill=f,this.options=this._setDefaults(T),this._container=this.quill.addContainer(this.options.containerClass),this._boundsContainer=this.options.boundsContainer||this.quill.container,this._currentSelection=this.quill.getSelection(),this._registerSelectionChangeListeners(),this._registerTextChangeListener(),this._registerDomListeners()}return g.prototype.createCursor=function(f,T,S){var E=this._cursors[f];if(!E){E=new a.default(f,T,S),this._cursors[f]=E;var k=E.build(this.options);this._container.appendChild(k)}return E},g.prototype.moveCursor=function(f,T){var S=this._cursors[f];S&&(S.range=T,this._updateCursor(S))},g.prototype.removeCursor=function(f){var T=this._cursors[f];T&&(T.remove(),delete this._cursors[f])},g.prototype.update=function(){var f=this;this.cursors().forEach(function(T){return f._updateCursor(T)})},g.prototype.clearCursors=function(){var f=this;this.cursors().forEach(function(T){return f.removeCursor(T.id)})},g.prototype.toggleFlag=function(f,T){var S=this._cursors[f];S&&S.toggleFlag(T)},g.prototype.cursors=function(){var f=this;return Object.keys(this._cursors).map(function(T){return f._cursors[T]})},g.prototype._registerSelectionChangeListeners=function(){var f=this;this.quill.on(this.quill.constructor.events.SELECTION_CHANGE,function(T){f._currentSelection=T})},g.prototype._registerTextChangeListener=function(){var f=this;this.quill.on(this.quill.constructor.events.TEXT_CHANGE,function(T){return f._handleTextChange(T)})},g.prototype._registerDomListeners=function(){var f=this,T=this.quill.container.getElementsByClassName("ql-editor")[0];T.addEventListener("scroll",function(){return f.update()},{passive:!0}),T.addEventListener("touchstart",this._handleCursorTouch,{passive:!0})},g.prototype._handleCursorTouch=function(f){var T=this;this.cursors().forEach(function(S){S.toggleNearCursor(f.pageX,f.pageY),setTimeout(function(){return S.toggleFlag(!1)},T.options.hideDelayMs)})},g.prototype._registerResizeObserver=function(){var f=this;if(!this._isObserving){var T=this.quill.container.getElementsByClassName("ql-editor")[0],S=new w.default(function(E){if(!E[0].target.isConnected)return S.disconnect(),void(f._isObserving=!1);f.update()});S.observe(T),this._isObserving=!0}},g.prototype._updateCursor=function(f){if(this._registerResizeObserver(),!f.range)return f.hide();var T=this._indexWithinQuillBounds(f.range.index),S=this._indexWithinQuillBounds(f.range.index+f.range.length),E=this.quill.getLeaf(T),k=this.quill.getLeaf(S);if(!this._leafIsValid(E)||!this._leafIsValid(k))return f.hide();f.show();var P=this._boundsContainer.getBoundingClientRect(),O=this.quill.getBounds(S);f.updateCaret(O,P);var x=this._lineRanges(f,E,k).reduce(function(I,N){return I.concat(Array.from(v.getClientRects(N)))},[]);f.updateSelection(x,P)},g.prototype._indexWithinQuillBounds=function(f){var T=this.quill.getLength(),S=T?T-1:0;return f=Math.max(f,0),Math.min(f,S)},g.prototype._leafIsValid=function(f){return f&&f[0]&&f[0].domNode&&f[1]>=0},g.prototype._handleTextChange=function(f){var T=this;window.setTimeout(function(){T.options.transformOnTextChange&&T._transformCursors(f),T.options.selectionChangeSource&&(T._emitSelection(),T.update())})},g.prototype._emitSelection=function(){this.quill.emitter.emit(this.quill.constructor.events.SELECTION_CHANGE,this.quill.getSelection(),this._currentSelection,this.options.selectionChangeSource)},g.prototype._setDefaults=function(f){return(f=Object.assign({},f)).template||(f.template=g.DEFAULTS.template),f.containerClass||(f.containerClass=g.DEFAULTS.containerClass),f.selectionChangeSource!==null&&(f.selectionChangeSource||(f.selectionChangeSource=g.DEFAULTS.selectionChangeSource)),f.hideDelayMs=Number.isInteger(f.hideDelayMs)?f.hideDelayMs:g.DEFAULTS.hideDelayMs,f.hideSpeedMs=Number.isInteger(f.hideSpeedMs)?f.hideSpeedMs:g.DEFAULTS.hideSpeedMs,f.transformOnTextChange=!!f.transformOnTextChange,f},g.prototype._lineRanges=function(f,T,S){var E=this.quill.getLines(f.range);return E.reduce(function(k,P,O){if(!P.children){var x=document.createRange();return x.selectNode(P.domNode),k.concat(x)}var I=O===0?T:P.path(0).pop(),N=I[0],_=I[1],R=O===E.length-1?S:P.path(P.length()-1).pop(),M=R[0],F=R[1],Y=document.createRange();return N.domNode.nodeType===Node.TEXT_NODE?Y.setStart(N.domNode,_):Y.setStartBefore(N.domNode),M.domNode.nodeType===Node.TEXT_NODE?Y.setEnd(M.domNode,F):Y.setEndAfter(M.domNode),k.concat(Y)},[])},g.prototype._transformCursors=function(f){var T=this;f=new y(f),this.cursors().filter(function(S){return S.range}).forEach(function(S){S.range.index=f.transformPosition(S.range.index),T._updateCursor(S)})},g.DEFAULTS={template:b.default,containerClass:"ql-cursors",selectionChangeSource:"api",hideDelayMs:3e3,hideSpeedMs:400},g}();c.default=p},338:function(s,c,u){var d=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(c,"__esModule",{value:!0});var m=d(u(353)),h=`
  <span class="`.concat(m.default.SELECTION_CLASS,`"></span>
  <span class="`).concat(m.default.CARET_CONTAINER_CLASS,`">
    <span class="`).concat(m.default.CARET_CLASS,`"></span>
  </span>
  <div class="`).concat(m.default.FLAG_CLASS,`">
    <small class="`).concat(m.default.NAME_CLASS,`"></small>
  </div>
`);c.default=h}},n={};function r(s){var c=n[s];if(c!==void 0)return c.exports;var u=n[s]={id:s,loaded:!1,exports:{}};return e[s].call(u.exports,u,u.exports,r),u.loaded=!0,u.exports}r.n=s=>{var c=s&&s.__esModule?()=>s.default:()=>s;return r.d(c,{a:c}),c},r.d=(s,c)=>{for(var u in c)r.o(c,u)&&!r.o(s,u)&&Object.defineProperty(s,u,{enumerable:!0,get:c[u]})},r.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),r.o=(s,c)=>Object.prototype.hasOwnProperty.call(s,c),r.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r.nmd=s=>(s.paths=[],s.children||(s.children=[]),s),r.nc=void 0;var o=r(607);return o.default})())})(Wu);var Wh=Wu.exports;const Gh=Ku(Wh);var Ie=function(i,t,e){if(!t.has(i))throw new TypeError("attempted to set private field on non-instance");return t.set(i,e),e},de=function(i,t){if(!t.has(i))throw new TypeError("attempted to get private field on non-instance");return t.get(i)},ni,vi,Xt,Bi,ao,hn,dn,gn,pn,mn,yn,vn,bn,bi,qi,ri,Qo,ii;const Yh=function(i){var t=131,e=137,n=0;i+="x";var r=Math.floor(9007199254740991/e);for(let o=0;o<i.length;o++)n>r&&(n=Math.floor(n/e)),n=n*t+i.charCodeAt(o);return n},me="0123456789abcdef".split(""),Zh=[-2147483648,8388608,32768,128],Zt=[24,16,8,0],Vo=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],ht=[];class Xh{constructor(t=!1,e=!1){ni.set(this,void 0),vi.set(this,void 0),Xt.set(this,void 0),Bi.set(this,void 0),ao.set(this,void 0),hn.set(this,void 0),dn.set(this,void 0),gn.set(this,void 0),pn.set(this,void 0),mn.set(this,void 0),yn.set(this,void 0),vn.set(this,void 0),bn.set(this,void 0),bi.set(this,void 0),qi.set(this,void 0),ri.set(this,void 0),Qo.set(this,0),ii.set(this,void 0),this.init(t,e)}init(t,e){e?(ht[0]=ht[16]=ht[1]=ht[2]=ht[3]=ht[4]=ht[5]=ht[6]=ht[7]=ht[8]=ht[9]=ht[10]=ht[11]=ht[12]=ht[13]=ht[14]=ht[15]=0,Ie(this,vi,ht)):Ie(this,vi,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),t?(Ie(this,hn,3238371032),Ie(this,dn,914150663),Ie(this,gn,812702999),Ie(this,pn,4144912697),Ie(this,mn,4290775857),Ie(this,yn,1750603025),Ie(this,vn,1694076839),Ie(this,bn,3204075428)):(Ie(this,hn,1779033703),Ie(this,dn,3144134277),Ie(this,gn,1013904242),Ie(this,pn,2773480762),Ie(this,mn,1359893119),Ie(this,yn,2600822924),Ie(this,vn,528734635),Ie(this,bn,1541459225)),Ie(this,ni,Ie(this,ii,Ie(this,Xt,Ie(this,qi,0)))),Ie(this,Bi,Ie(this,bi,!1)),Ie(this,ao,!0),Ie(this,ri,t)}update(t){if(de(this,Bi))return this;let e;t instanceof ArrayBuffer?e=new Uint8Array(t):e=t;let n=0;const r=e.length,o=de(this,vi);for(;n<r;){let s;if(de(this,bi)&&(Ie(this,bi,!1),o[0]=de(this,ni),o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),typeof e!="string")for(s=de(this,ii);n<r&&s<64;++n)o[s>>2]|=e[n]<<Zt[s++&3];else for(s=de(this,ii);n<r&&s<64;++n){let c=e.charCodeAt(n);c<128?o[s>>2]|=c<<Zt[s++&3]:c<2048?(o[s>>2]|=(192|c>>6)<<Zt[s++&3],o[s>>2]|=(128|c&63)<<Zt[s++&3]):c<55296||c>=57344?(o[s>>2]|=(224|c>>12)<<Zt[s++&3],o[s>>2]|=(128|c>>6&63)<<Zt[s++&3],o[s>>2]|=(128|c&63)<<Zt[s++&3]):(c=65536+((c&1023)<<10|e.charCodeAt(++n)&1023),o[s>>2]|=(240|c>>18)<<Zt[s++&3],o[s>>2]|=(128|c>>12&63)<<Zt[s++&3],o[s>>2]|=(128|c>>6&63)<<Zt[s++&3],o[s>>2]|=(128|c&63)<<Zt[s++&3])}Ie(this,Qo,s),Ie(this,Xt,de(this,Xt)+(s-de(this,ii))),s>=64?(Ie(this,ni,o[16]),Ie(this,ii,s-64),this.hash(),Ie(this,bi,!0)):Ie(this,ii,s)}return de(this,Xt)>4294967295&&(Ie(this,qi,de(this,qi)+(de(this,Xt)/4294967296<<0)),Ie(this,Xt,de(this,Xt)%4294967296)),this}finalize(){if(de(this,Bi))return;Ie(this,Bi,!0);const t=de(this,vi),e=de(this,Qo);t[16]=de(this,ni),t[e>>2]|=Zh[e&3],Ie(this,ni,t[16]),e>=56&&(de(this,bi)||this.hash(),t[0]=de(this,ni),t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=de(this,qi)<<3|de(this,Xt)>>>29,t[15]=de(this,Xt)<<3,this.hash()}hash(){let t=de(this,hn),e=de(this,dn),n=de(this,gn),r=de(this,pn),o=de(this,mn),s=de(this,yn),c=de(this,vn),u=de(this,bn);const d=de(this,vi);let m,h,l,a,v,b,w,y,p,g;for(let f=16;f<64;++f)a=d[f-15],m=(a>>>7|a<<25)^(a>>>18|a<<14)^a>>>3,a=d[f-2],h=(a>>>17|a<<15)^(a>>>19|a<<13)^a>>>10,d[f]=d[f-16]+m+d[f-7]+h<<0;g=e&n;for(let f=0;f<64;f+=4)de(this,ao)?(de(this,ri)?(w=300032,a=d[0]-1413257819,u=a-150054599<<0,r=a+24177077<<0):(w=704751109,a=d[0]-210244248,u=a-1521486534<<0,r=a+143694565<<0),Ie(this,ao,!1)):(m=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),h=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),w=t&e,l=w^t&n^g,b=o&s^~o&c,a=u+h+b+Vo[f]+d[f],v=m+l,u=r+a<<0,r=a+v<<0),m=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10),h=(u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7),y=r&t,l=y^r&e^w,b=u&o^~u&s,a=c+h+b+Vo[f+1]+d[f+1],v=m+l,c=n+a<<0,n=a+v<<0,m=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),h=(c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7),p=n&r,l=p^n&t^y,b=c&u^~c&o,a=s+h+b+Vo[f+2]+d[f+2],v=m+l,s=e+a<<0,e=a+v<<0,m=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),h=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7),g=e&n,l=g^e&r^p,b=s&c^~s&u,a=o+h+b+Vo[f+3]+d[f+3],v=m+l,o=t+a<<0,t=a+v<<0;Ie(this,hn,de(this,hn)+t<<0),Ie(this,dn,de(this,dn)+e<<0),Ie(this,gn,de(this,gn)+n<<0),Ie(this,pn,de(this,pn)+r<<0),Ie(this,mn,de(this,mn)+o<<0),Ie(this,yn,de(this,yn)+s<<0),Ie(this,vn,de(this,vn)+c<<0),Ie(this,bn,de(this,bn)+u<<0)}hex(){this.finalize();const t=de(this,hn),e=de(this,dn),n=de(this,gn),r=de(this,pn),o=de(this,mn),s=de(this,yn),c=de(this,vn),u=de(this,bn);let d=me[t>>28&15]+me[t>>24&15]+me[t>>20&15]+me[t>>16&15]+me[t>>12&15]+me[t>>8&15]+me[t>>4&15]+me[t&15]+me[e>>28&15]+me[e>>24&15]+me[e>>20&15]+me[e>>16&15]+me[e>>12&15]+me[e>>8&15]+me[e>>4&15]+me[e&15]+me[n>>28&15]+me[n>>24&15]+me[n>>20&15]+me[n>>16&15]+me[n>>12&15]+me[n>>8&15]+me[n>>4&15]+me[n&15]+me[r>>28&15]+me[r>>24&15]+me[r>>20&15]+me[r>>16&15]+me[r>>12&15]+me[r>>8&15]+me[r>>4&15]+me[r&15]+me[o>>28&15]+me[o>>24&15]+me[o>>20&15]+me[o>>16&15]+me[o>>12&15]+me[o>>8&15]+me[o>>4&15]+me[o&15]+me[s>>28&15]+me[s>>24&15]+me[s>>20&15]+me[s>>16&15]+me[s>>12&15]+me[s>>8&15]+me[s>>4&15]+me[s&15]+me[c>>28&15]+me[c>>24&15]+me[c>>20&15]+me[c>>16&15]+me[c>>12&15]+me[c>>8&15]+me[c>>4&15]+me[c&15];return de(this,ri)||(d+=me[u>>28&15]+me[u>>24&15]+me[u>>20&15]+me[u>>16&15]+me[u>>12&15]+me[u>>8&15]+me[u>>4&15]+me[u&15]),d}toString(){return this.hex()}digest(){this.finalize();const t=de(this,hn),e=de(this,dn),n=de(this,gn),r=de(this,pn),o=de(this,mn),s=de(this,yn),c=de(this,vn),u=de(this,bn),d=[t>>24&255,t>>16&255,t>>8&255,t&255,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255,o>>24&255,o>>16&255,o>>8&255,o&255,s>>24&255,s>>16&255,s>>8&255,s&255,c>>24&255,c>>16&255,c>>8&255,c&255];return de(this,ri)||d.push(u>>24&255,u>>16&255,u>>8&255,u&255),d}array(){return this.digest()}arrayBuffer(){this.finalize();const t=new ArrayBuffer(de(this,ri)?28:32),e=new DataView(t);return e.setUint32(0,de(this,hn)),e.setUint32(4,de(this,dn)),e.setUint32(8,de(this,gn)),e.setUint32(12,de(this,pn)),e.setUint32(16,de(this,mn)),e.setUint32(20,de(this,yn)),e.setUint32(24,de(this,vn)),de(this,ri)||e.setUint32(28,de(this,bn)),t}}ni=new WeakMap,vi=new WeakMap,Xt=new WeakMap,Bi=new WeakMap,ao=new WeakMap,hn=new WeakMap,dn=new WeakMap,gn=new WeakMap,pn=new WeakMap,mn=new WeakMap,yn=new WeakMap,vn=new WeakMap,bn=new WeakMap,bi=new WeakMap,qi=new WeakMap,ri=new WeakMap,Qo=new WeakMap,ii=new WeakMap;function Qh(i){const t=new Xh;return t.update(i),parseInt(t.hex().substring(0,8),16)}const ed=function(i){var t="#";return i.forEach(function(e){e<16&&(t+=0),t+=e.toString(16)}),t},td=function(i,t,e){i/=360;var n=e<.5?e*(1+t):e+t-e*t,r=2*e-n;return[i+1/3,i,i-1/3].map(function(o){return o<0&&o++,o>1&&o--,o<1/6?o=r+(n-r)*6*o:o<.5?o=n:o<2/3?o=r+(n-r)*6*(2/3-o):o=r,Math.round(o*255)})};class nd{constructor(t={}){const[e,n]=[t.lightness,t.saturation].map(function(r){return r=r!==void 0?r:[.35,.5,.65],Array.isArray(r)?r.concat():[r]});this.L=e,this.S=n,typeof t.hue=="number"&&(t.hue={min:t.hue,max:t.hue}),typeof t.hue=="object"&&!Array.isArray(t.hue)&&(t.hue=[t.hue]),typeof t.hue>"u"&&(t.hue=[]),this.hueRanges=t.hue.map(function(r){return{min:typeof r.min>"u"?0:r.min,max:typeof r.max>"u"?360:r.max}}),this.hash=Qh,typeof t.hash=="function"&&(this.hash=t.hash),t.hash==="bkdr"&&(this.hash=Yh)}hsl(t){var e,n,r,o=this.hash(t),s=727;if(this.hueRanges.length){const c=this.hueRanges[o%this.hueRanges.length];e=o/this.hueRanges.length%s*(c.max-c.min)/s+c.min}else e=o%359;return o=Math.ceil(o/360),n=this.S[o%this.S.length],o=Math.ceil(o/this.S.length),r=this.L[o%this.L.length],[e,n,r]}rgb(t){var e=this.hsl(t);return td.apply(this,e)}hex(t){var e=this.rgb(t);return ed(e)}}const wi={isOnline:!1,showOffline:i=>{wi.isOnline=!1,i.innerHTML='<span class="red"> </span>'},showOnline:i=>{wi.isOnline=!0,i.innerHTML='<span class="green"> </span>'},statusListener:i=>t=>{wi.isOnline&&t.value==Eo.Disconnected?wi.showOffline(i):!wi.isOnline&&t.value==Eo.Connected&&wi.showOnline(i)}};function rd(i,t,e){const n=[];for(const{clientID:r,presence:o}of t)n.push(e===r?`<b>${o.username}</b>`:o.username);i.innerHTML=JSON.stringify(n)}function Dl(i,t,e){i.innerText=e.toJSON(),t.innerText=e.getRoot().content.toTestString()}const id=document.getElementById("peers"),Bl=document.getElementById("document"),ql=document.getElementById("document-text"),od=document.getElementById("network-status"),sd=new nd,ad=`vanilla-quill-${new Date().toISOString().substring(0,10).replace(/-/g,"")}`;function Vs(i){const{embed:t,...e}=i.attributes??{};return t?{insert:t,attributes:e}:{insert:i.content||"",attributes:i.attributes}}async function ld(){const i=new zs.Client({rpcAddr:"https://api.yorkie.dev",apiKey:"cedaovjuioqlk4pjqn6g"});await i.activate();const t=new zs.Document(ad,{enableDevtools:!0});t.subscribe("connection",u=>{wi.statusListener(od)(u)}),t.subscribe("presence",u=>{u.type!==lt.PresenceChanged&&rd(id,t.getPresences(),i.getID())}),await i.attach(t,{initialPresence:{username:i.getID().slice(-2),color:sd.hex(i.getID().slice(-2)),selection:void 0}}),t.update(u=>{u.content||(u.content=new zs.Text,u.content.edit(0,0,`
`))},"create content if not exists"),t.subscribe(u=>{u.type==="snapshot"&&c(),Dl(Bl,ql,t)}),t.subscribe("$.content",u=>{u.type==="remote-change"&&s(u.value.operations),n()}),t.subscribe("others",u=>{u.type===lt.Unwatched?o.removeCursor(u.value.clientID):u.type===lt.PresenceChanged&&e(u.value)});function e(u){const{clientID:d,presence:m}=u;if(d===i.getID()||!m)return;const{username:h,color:l,selection:a}=m;if(!a)return;const v=t.getRoot().content.posRangeToIndexRange(a);o.createCursor(d,h,l),o.moveCursor(d,{index:v[0],length:v[1]-v[0]})}function n(){for(const u of t.getPresences())e(u)}await i.sync(),Rl.register("modules/cursors",Gh);const r=new Rl("#editor",{modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["image","video"],["clean"]],cursors:!0},theme:"snow"}),o=r.getModule("cursors");r.on("text-change",(u,d,m)=>{if(m==="api"||!u.ops)return;let h=0,l=0;console.log(`%c quill: ${JSON.stringify(u.ops)}`,"color: green");for(const a of u.ops)a.attributes!==void 0||a.insert!==void 0?(a.retain!==void 0&&(l=h+a.retain),console.log(`%c local: ${h}-${l}: ${a.insert} ${a.attributes?JSON.stringify(a.attributes):"{}"}`,"color: green"),t.update((v,b)=>{let w;a.attributes!==void 0&&a.insert===void 0?v.content.setStyle(h,l,a.attributes):a.insert!==void 0&&(l<h&&(l=h),typeof a.insert=="object"?w=v.content.edit(h,l," ",{embed:JSON.stringify(a.insert),...a.attributes}):w=v.content.edit(h,l,a.insert,a.attributes),h=l+a.insert.length),w&&b.set({selection:v.content.indexRangeToPosRange(w)})},`update style by ${i.getID()}`)):a.delete!==void 0?(l=h+a.delete,console.log(`%c local: ${h}-${l}: ''`,"color: green"),t.update((v,b)=>{const w=v.content.edit(h,l,"");w&&b.set({selection:v.content.indexRangeToPosRange(w)})},`update content by ${i.getID()}`)):a.retain!==void 0&&(h=l+a.retain,l=h)}).on("selection-change",(u,d,m)=>{if(u){if(m==="api"){const{selection:h}=t.getMyPresence();if(h){const[l,a]=t.getRoot().content.posRangeToIndexRange(h),{index:v,length:b}=u;if(l===v&&a===v+b)return}}t.update((h,l)=>{l.set({selection:h.content.indexRangeToPosRange([u.index,u.index+u.length])})},`update selection by ${i.getID()}`)}});function s(u){const d=[];let m=0;for(const h of u)if(h.type==="edit"){const l=h.from,a=h.to,v=l-m,b=a-l,{insert:w,attributes:y}=Vs(h.value);if(console.log(`%c remote: ${l}-${a}: ${w}`,"color: skyblue"),v&&d.push({retain:v}),b&&d.push({delete:b}),w){const p={insert:w};y&&(p.attributes=y),d.push(p)}m=a}else if(h.type==="style"){const l=h.from,a=h.to,v=l-m,b=a-l,{attributes:w}=Vs(h.value);if(console.log(`%c remote: ${l}-${a}: ${JSON.stringify(w)}`,"color: skyblue"),v&&d.push({retain:v}),w){const y={attributes:w};b&&(y.retain=b),d.push(y)}m=a}if(d.length){console.log(`%c to quill: ${JSON.stringify(d)}`,"color: green");const h={ops:d};r.updateContents(h,"api")}}function c(){const d={ops:t.getRoot().content.values().map(m=>Vs(m))};r.setContents(d,"api")}c(),n(),Dl(Bl,ql,t)}ld();
