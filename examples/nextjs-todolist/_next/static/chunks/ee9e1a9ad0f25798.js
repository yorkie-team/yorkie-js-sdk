(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,82052,e=>{"use strict";let t,r,n,i,s,a,o,l,u;var d,c,h,g,f,m,p,y,b,v,A,S,E,I,w,N,R,C,T,x,V,D,k,B,W,L,O,Z,F,P,U,G,Y,K,M,_,X,J,z,$,j,Q,H,q,ee,et,er,en,ei,es,ea,eo,el,eu,ed,ec,eh,eg,ef,em,ep,ey,eb,ev,eA,eS,eE,eI,ew,eN,eR,eC,eT,ex=e.i(24647),eV=e.i(39311);function eD(e,t){return!!(null!==e&&"object"==typeof e&&"$typeName"in e&&"string"==typeof e.$typeName)&&(void 0===t||t.typeName===e.$typeName)}function ek(){let e=0,t=0;for(let r=0;r<28;r+=7){let n=this.buf[this.pos++];if(e|=(127&n)<<r,(128&n)==0)return this.assertBounds(),[e,t]}let r=this.buf[this.pos++];if(e|=(15&r)<<28,t=(112&r)>>4,(128&r)==0)return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let n=this.buf[this.pos++];if(t|=(127&n)<<r,(128&n)==0)return this.assertBounds(),[e,t]}throw Error("invalid varint")}function eB(e,t,r){for(let n=0;n<28;n+=7){let i=e>>>n,s=i>>>7!=0||0!=t,a=(s?128|i:i)&255;if(r.push(a),!s)return}let n=e>>>28&15|(7&t)<<4,i=t>>3!=0;if(r.push((i?128|n:n)&255),i){for(let e=3;e<31;e+=7){let n=t>>>e,i=n>>>7!=0,s=(i?128|n:n)&255;if(r.push(s),!i)return}r.push(t>>>31&1)}}function eW(e){let t="-"===e[0];t&&(e=e.slice(1));let r=0,n=0;function i(t,i){let s=Number(e.slice(t,i));n*=1e6,(r=1e6*r+s)>=0x100000000&&(n+=r/0x100000000|0,r%=0x100000000)}return i(-24,-18),i(-18,-12),i(-12,-6),i(-6),t?eZ(r,n):eO(r,n)}function eL(e,t){if({lo:e,hi:t}={lo:e>>>0,hi:t>>>0},t<=2097151)return String(0x100000000*t+e);let r=0xffffff&e,n=(e>>>24|t<<8)&0xffffff,i=t>>16&65535,s=r+6777216*n+6710656*i,a=n+8147497*i,o=2*i;return s>=1e7&&(a+=Math.floor(s/1e7),s%=1e7),a>=1e7&&(o+=Math.floor(a/1e7),a%=1e7),o.toString()+eF(a)+eF(s)}function eO(e,t){return{lo:0|e,hi:0|t}}function eZ(e,t){return t=~t,e?e=~e+1:t+=1,eO(e,t)}(g=es||(es={}))[g.Canceled=1]="Canceled",g[g.Unknown=2]="Unknown",g[g.InvalidArgument=3]="InvalidArgument",g[g.DeadlineExceeded=4]="DeadlineExceeded",g[g.NotFound=5]="NotFound",g[g.AlreadyExists=6]="AlreadyExists",g[g.PermissionDenied=7]="PermissionDenied",g[g.ResourceExhausted=8]="ResourceExhausted",g[g.FailedPrecondition=9]="FailedPrecondition",g[g.Aborted=10]="Aborted",g[g.OutOfRange=11]="OutOfRange",g[g.Unimplemented=12]="Unimplemented",g[g.Internal=13]="Internal",g[g.Unavailable=14]="Unavailable",g[g.DataLoss=15]="DataLoss",g[g.Unauthenticated=16]="Unauthenticated",(f=ea||(ea={}))[f.DOUBLE=1]="DOUBLE",f[f.FLOAT=2]="FLOAT",f[f.INT64=3]="INT64",f[f.UINT64=4]="UINT64",f[f.INT32=5]="INT32",f[f.FIXED64=6]="FIXED64",f[f.FIXED32=7]="FIXED32",f[f.BOOL=8]="BOOL",f[f.STRING=9]="STRING",f[f.BYTES=12]="BYTES",f[f.UINT32=13]="UINT32",f[f.SFIXED32=15]="SFIXED32",f[f.SFIXED64=16]="SFIXED64",f[f.SINT32=17]="SINT32",f[f.SINT64=18]="SINT64";let eF=e=>{let t=String(e);return"0000000".slice(t.length)+t};function eP(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let r=0;r<9;r++)t.push(127&e|128),e>>=7;t.push(1)}}function eU(){let e=this.buf[this.pos++],t=127&e;if((128&e)==0||(t|=(127&(e=this.buf[this.pos++]))<<7,(128&e)==0)||(t|=(127&(e=this.buf[this.pos++]))<<14,(128&e)==0)||(t|=(127&(e=this.buf[this.pos++]))<<21,(128&e)==0))return this.assertBounds(),t;t|=(15&(e=this.buf[this.pos++]))<<28;for(let t=5;(128&e)!=0&&t<10;t++)e=this.buf[this.pos++];if((128&e)!=0)throw Error("invalid varint");return this.assertBounds(),t>>>0}let eG=function(){let e=new DataView(new ArrayBuffer(8));if("function"==typeof BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&(globalThis.Deno||"object"!=typeof ex.default||"object"!=typeof ex.default.env||"1"!==ex.default.env.BUF_BIGINT_DISABLE)){let t=BigInt("-9223372036854775808"),r=BigInt("9223372036854775807"),n=BigInt("0"),i=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){let n="bigint"==typeof e?e:BigInt(e);if(n>r||n<t)throw Error(`invalid int64: ${e}`);return n},uParse(e){let t="bigint"==typeof e?e:BigInt(e);if(t>i||t<n)throw Error(`invalid uint64: ${e}`);return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,r)=>(e.setInt32(0,t,!0),e.setInt32(4,r,!0),e.getBigInt64(0,!0)),uDec:(t,r)=>(e.setInt32(0,t,!0),e.setInt32(4,r,!0),e.getBigUint64(0,!0))}}return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),eY(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),eK(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),eY(e),eW(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),eK(e),eW(e)),dec:(e,t)=>{let r,n,i;return(n=0x80000000&(r=eO(e,t)).hi)&&(r=eZ(r.lo,r.hi)),i=eL(r.lo,r.hi),n?"-"+i:i},uDec:(e,t)=>eL(e,t)}}();function eY(e){if(!/^-?[0-9]+$/.test(e))throw Error("invalid int64: "+e)}function eK(e){if(!/^[0-9]+$/.test(e))throw Error("invalid uint64: "+e)}function eM(e,t){switch(e){case ea.STRING:return"";case ea.BOOL:return!1;case ea.DOUBLE:case ea.FLOAT:return 0;case ea.INT64:case ea.UINT64:case ea.SFIXED64:case ea.FIXED64:case ea.SINT64:return t?"0":eG.zero;case ea.BYTES:return new Uint8Array(0);default:return 0}}let e_=Symbol.for("reflect unsafe local");function eX(e,t){let r=e[t.localName].case;return void 0===r?r:t.fields.find(e=>e.localName===r)}function eJ(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&void 0!==e[t]}function ez(e,t){if(t.oneof){let r=e[t.oneof.localName];return r.case===t.localName?r.value:void 0}return e[t.localName]}function e$(e,t,r){t.oneof?e[t.oneof.localName]={case:t.localName,value:r}:e[t.localName]=r}function ej(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}function eQ(e,t){var r,n,i,s;if(ej(e)&&e_ in e&&"add"in e&&"field"in e&&"function"==typeof e.field){if(void 0!==t){let a=e.field();return t.listKind==a.listKind&&t.scalar===a.scalar&&(null==(r=t.message)?void 0:r.typeName)===(null==(n=a.message)?void 0:n.typeName)&&(null==(i=t.enum)?void 0:i.typeName)===(null==(s=a.enum)?void 0:s.typeName)}return!0}return!1}function eH(e,t){var r,n,i,s;if(ej(e)&&e_ in e&&"has"in e&&"field"in e&&"function"==typeof e.field){if(void 0!==t){let a=e.field();return t.mapKey===a.mapKey&&t.mapKind==a.mapKind&&t.scalar===a.scalar&&(null==(r=t.message)?void 0:r.typeName)===(null==(n=a.message)?void 0:n.typeName)&&(null==(i=t.enum)?void 0:i.typeName)===(null==(s=a.enum)?void 0:s.typeName)}return!0}return!1}function eq(e,t){return ej(e)&&e_ in e&&"desc"in e&&ej(e.desc)&&"message"===e.desc.kind&&(void 0===t||e.desc.typeName==t.typeName)}function e0(e){let t=e.fields[0];return e1(e.typeName)&&void 0!==t&&"scalar"==t.fieldKind&&"value"==t.name&&1==t.number}function e1(e){return e.startsWith("google.protobuf.")&&["DoubleValue","FloatValue","Int64Value","UInt64Value","Int32Value","UInt32Value","BoolValue","StringValue","BytesValue"].includes(e.substring(16))}function e2(e,t){if(eD(t,e))return t;let r=function(e){let t;if(function(e){switch(e.file.edition){case 999:return!1;case 998:return!0;default:return e.fields.some(e=>2!=e.presence&&"message"!=e.fieldKind&&!e.oneof)}}(e)){let r,n,i=e8.get(e);if(i)({prototype:r,members:n}=i);else{for(let t of(r={},n=new Set,e.members))"oneof"!=t.kind&&("scalar"==t.fieldKind||"enum"==t.fieldKind)&&2!=t.presence&&(n.add(t),r[t.localName]=e7(t));e8.set(e,{prototype:r,members:n})}for(let i of((t=Object.create(r)).$typeName=e.typeName,e.members))if(!n.has(i)){if("field"==i.kind&&("message"==i.fieldKind||("scalar"==i.fieldKind||"enum"==i.fieldKind)&&2!=i.presence))continue;t[i.localName]=e7(i)}}else for(let r of(t={$typeName:e.typeName},e.members))("oneof"==r.kind||2==r.presence)&&(t[r.localName]=e7(r));return t}(e);return void 0!==t&&function(e,t,r){for(let n of e.members){let e,i=r[n.localName];if(null!=i){if("oneof"==n.kind){let t=eX(r,n);if(!t)continue;e=t,i=ez(r,t)}else e=n;switch(e.fieldKind){case"message":i=e5(e,i);break;case"scalar":i=e3(e,i);break;case"list":i=function(e,t){if(Array.isArray(t)){if(e.scalar==ea.BYTES)return t.map(e9);if("message"==e.listKind)return t.map(t=>e5(e,t))}return t}(e,i);break;case"map":i=function(e,t){if(ej(t)){if(e.scalar==ea.BYTES)return e4(t,e9);if("message"==e.mapKind)return e4(t,t=>e5(e,t))}return t}(e,i)}e$(t,e,i)}}}(e,r,t),r}function e3(e,t){return e.scalar==ea.BYTES?e9(t):t}function e5(e,t){if("message"==e.fieldKind&&!e.oneof&&e0(e.message))return e3(e.message.fields[0],t);if(ej(t)){if("google.protobuf.Struct"==e.message.typeName&&"google.protobuf.Value"!==e.parent.typeName)return t;if(!eD(t,e.message))return e2(e.message,t)}return t}function e9(e){return Array.isArray(e)?new Uint8Array(e):e}function e4(e,t){let r={};for(let n of Object.entries(e))r[n[0]]=t(n[1]);return r}let e6=Symbol(),e8=new WeakMap;function e7(e){if("oneof"==e.kind)return{case:void 0};if("list"==e.fieldKind)return[];if("map"==e.fieldKind)return{};if("message"==e.fieldKind)return e6;let t=e.getDefaultValue();return void 0!==t?"scalar"==e.fieldKind&&e.longAsString?t.toString():t:"scalar"==e.fieldKind?eM(e.scalar,e.longAsString):e.enum.values[0].number}let te=["FieldValueInvalidError","FieldListRangeError","ForeignFieldError"];class tt extends Error{constructor(e,t,r="FieldValueInvalidError"){super(t),this.name=r,this.field=()=>e}}let tr=Symbol.for("@bufbuild/protobuf/text-encoding");function tn(){if(void 0==globalThis[tr]){let e=new globalThis.TextEncoder,t=new globalThis.TextDecoder;globalThis[tr]={encodeUtf8:t=>e.encode(t),decodeUtf8:e=>t.decode(e),checkUtf8(e){try{return encodeURIComponent(e),!0}catch(e){return!1}}}}return globalThis[tr]}(m=eo||(eo={}))[m.Varint=0]="Varint",m[m.Bit64=1]="Bit64",m[m.LengthDelimited=2]="LengthDelimited",m[m.StartGroup=3]="StartGroup",m[m.EndGroup=4]="EndGroup",m[m.Bit32=5]="Bit32";class ti{constructor(e=tn().encodeUtf8){this.encodeUtf8=e,this.stack=[],this.chunks=[],this.buf=[]}finish(){this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]);let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),r=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],r),r+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(to(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return ta(e),eP(e,this.buf),this}bool(e){return this.buf.push(+!!e),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.encodeUtf8(e);return this.uint32(t.byteLength),this.raw(t)}float(e){var t=e;if("string"==typeof t){let e=t;if(Number.isNaN(t=Number(t))&&"NaN"!==e)throw Error("invalid float32: "+e)}else if("number"!=typeof t)throw Error("invalid float32: "+typeof t);if(Number.isFinite(t)&&(t>34028234663852886e22||t<-34028234663852886e22))throw Error("invalid float32: "+t);let r=new Uint8Array(4);return new DataView(r.buffer).setFloat32(0,e,!0),this.raw(r)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){to(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){ta(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return ta(e),eP(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),n=eG.enc(e);return r.setInt32(0,n.lo,!0),r.setInt32(4,n.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),n=eG.uEnc(e);return r.setInt32(0,n.lo,!0),r.setInt32(4,n.hi,!0),this.raw(t)}int64(e){let t=eG.enc(e);return eB(t.lo,t.hi,this.buf),this}sint64(e){let t=eG.enc(e),r=t.hi>>31;return eB(t.lo<<1^r,(t.hi<<1|t.lo>>>31)^r,this.buf),this}uint64(e){let t=eG.uEnc(e);return eB(t.lo,t.hi,this.buf),this}}class ts{constructor(e,t=tn().decodeUtf8){this.decodeUtf8=t,this.varint64=ek,this.uint32=eU,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength)}tag(){let e=this.uint32(),t=e>>>3,r=7&e;if(t<=0||r<0||r>5)throw Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e,t){let r=this.pos;switch(e){case eo.Varint:for(;128&this.buf[this.pos++];);break;case eo.Bit64:this.pos+=4;case eo.Bit32:this.pos+=4;break;case eo.LengthDelimited:let n=this.uint32();this.pos+=n;break;case eo.StartGroup:for(;;){let[e,r]=this.tag();if(r===eo.EndGroup){if(void 0!==t&&e!==t)throw Error("invalid end group tag");break}this.skip(r,e)}break;default:throw Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return eG.dec(...this.varint64())}uint64(){return eG.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(1&e);return e=(e>>>1|(1&t)<<31)^r,t=t>>>1^r,eG.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return eG.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return eG.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.decodeUtf8(this.bytes())}}function ta(e){if("string"==typeof e)e=Number(e);else if("number"!=typeof e)throw Error("invalid int32: "+typeof e);if(!Number.isInteger(e)||e>0x7fffffff||e<-0x80000000)throw Error("invalid int32: "+e)}function to(e){if("string"==typeof e)e=Number(e);else if("number"!=typeof e)throw Error("invalid uint32: "+typeof e);if(!Number.isInteger(e)||e>0xffffffff||e<0)throw Error("invalid uint32: "+e)}function tl(e,t){let r,n="list"==e.fieldKind?eQ(t,e):"map"==e.fieldKind?eH(t,e):td(e,t);if(!0!==n){switch(e.fieldKind){case"list":r=`expected ${tm(e)}, got ${tg(t)}`;break;case"map":r=`expected ${tp(e)}, got ${tg(t)}`;break;default:r=th(e,t,n)}return new tt(e,r)}}function tu(e,t,r){let n=td(e,r);if(!0!==n)return new tt(e,`list item #${t+1}: ${th(e,r,n)}`)}function td(e,t){return void 0!==e.scalar?tc(t,e.scalar):void 0!==e.enum?e.enum.open?Number.isInteger(t):e.enum.values.some(e=>e.number===t):eq(t,e.message)}function tc(e,t){switch(t){case ea.DOUBLE:return"number"==typeof e;case ea.FLOAT:if("number"!=typeof e)return!1;if(Number.isNaN(e)||!Number.isFinite(e))return!0;if(e>34028234663852886e22||e<-34028234663852886e22)return`${e.toFixed()} out of range`;return!0;case ea.INT32:case ea.SFIXED32:case ea.SINT32:if("number"!=typeof e||!Number.isInteger(e))return!1;if(e>0x7fffffff||e<-0x80000000)return`${e.toFixed()} out of range`;return!0;case ea.FIXED32:case ea.UINT32:if("number"!=typeof e||!Number.isInteger(e))return!1;if(e>0xffffffff||e<0)return`${e.toFixed()} out of range`;return!0;case ea.BOOL:return"boolean"==typeof e;case ea.STRING:if("string"!=typeof e)return!1;return tn().checkUtf8(e)||"invalid UTF8";case ea.BYTES:return e instanceof Uint8Array;case ea.INT64:case ea.SFIXED64:case ea.SINT64:if("bigint"==typeof e||"number"==typeof e||"string"==typeof e&&e.length>0)try{return eG.parse(e),!0}catch(t){return`${e} out of range`}return!1;case ea.FIXED64:case ea.UINT64:if("bigint"==typeof e||"number"==typeof e||"string"==typeof e&&e.length>0)try{return eG.uParse(e),!0}catch(t){return`${e} out of range`}return!1}}function th(e,t,r){return(r="string"==typeof r?`: ${r}`:`, got ${tg(t)}`,void 0!==e.scalar)?`expected ${function(e){switch(e){case ea.STRING:return"string";case ea.BOOL:return"boolean";case ea.INT64:case ea.SINT64:case ea.SFIXED64:return"bigint (int64)";case ea.UINT64:case ea.FIXED64:return"bigint (uint64)";case ea.BYTES:return"Uint8Array";case ea.DOUBLE:return"number (float64)";case ea.FLOAT:return"number (float32)";case ea.FIXED32:case ea.UINT32:return"number (uint32)";case ea.INT32:case ea.SFIXED32:case ea.SINT32:return"number (int32)"}}(e.scalar)}`+r:void 0!==e.enum?`expected ${e.enum.toString()}`+r:`expected ${tf(e.message)}`+r}function tg(e){switch(typeof e){case"object":if(null===e)return"null";if(e instanceof Uint8Array)return`Uint8Array(${e.length})`;if(Array.isArray(e))return`Array(${e.length})`;if(eQ(e))return tm(e.field());if(eH(e))return tp(e.field());if(eq(e))return tf(e.desc);if(eD(e))return`message ${e.$typeName}`;return"object";case"string":return e.length>30?"string":`"${e.split('"').join('\\"')}"`;case"boolean":case"number":return String(e);case"bigint":return String(e)+"n";default:return typeof e}}function tf(e){return`ReflectMessage (${e.typeName})`}function tm(e){switch(e.listKind){case"message":return`ReflectList (${e.message.toString()})`;case"enum":return`ReflectList (${e.enum.toString()})`;case"scalar":return`ReflectList (${ea[e.scalar]})`}}function tp(e){switch(e.mapKind){case"message":return`ReflectMap (${ea[e.mapKey]}, ${e.message.toString()})`;case"enum":return`ReflectMap (${ea[e.mapKey]}, ${e.enum.toString()})`;case"scalar":return`ReflectMap (${ea[e.mapKey]}, ${ea[e.scalar]})`}}function ty(e,t,r=!0){return new tv(e,t,r)}let tb=new WeakMap;class tv{get sortedFields(){let e=tb.get(this.desc);if(e)return e;let t=this.desc.fields.concat().sort((e,t)=>e.number-t.number);return tb.set(this.desc,t),t}constructor(e,t,r=!0){this.lists=new Map,this.maps=new Map,this.check=r,this.desc=e,this.message=this[e_]=null!=t?t:e2(e),this.fields=e.fields,this.oneofs=e.oneofs,this.members=e.members}findNumber(e){return this._fieldsByNumber||(this._fieldsByNumber=new Map(this.desc.fields.map(e=>[e.number,e]))),this._fieldsByNumber.get(e)}oneofCase(e){return tA(this.message,e),eX(this.message,e)}isSet(e){tA(this.message,e);var t=this.message;let r=e.localName;if(e.oneof)return t[e.oneof.localName].case===r;if(2!=e.presence)return void 0!==t[r]&&Object.prototype.hasOwnProperty.call(t,r);switch(e.fieldKind){case"list":return t[r].length>0;case"map":return Object.keys(t[r]).length>0;case"scalar":return!function(e,t){switch(e){case ea.BOOL:return!1===t;case ea.STRING:return""===t;case ea.BYTES:return t instanceof Uint8Array&&!t.byteLength;default:return 0==t}}(e.scalar,t[r]);case"enum":return t[r]!==e.enum.values[0].number}throw Error("message field with implicit presence")}clear(e){tA(this.message,e);var t=this.message;let r=e.localName;if(e.oneof){let n=e.oneof.localName;t[n].case===r&&(t[n]={case:void 0})}else if(2!=e.presence)delete t[r];else switch(e.fieldKind){case"map":t[r]={};break;case"list":t[r]=[];break;case"enum":t[r]=e.enum.values[0].number;break;case"scalar":t[r]=eM(e.scalar,e.longAsString)}}get(e){tA(this.message,e);let t=ez(this.message,e);switch(e.fieldKind){case"list":let r=this.lists.get(e);return r&&r[e_]===t||this.lists.set(e,r=new tS(e,t,this.check)),r;case"map":let n=this.maps.get(e);return n&&n[e_]===t||this.maps.set(e,n=new tE(e,t,this.check)),n;case"message":return tw(e,t,this.check);case"scalar":return void 0===t?eM(e.scalar,!1):tV(e,t);case"enum":return null!=t?t:e.enum.values[0].number}}set(e,t){let r;if(tA(this.message,e),this.check){let r=tl(e,t);if(r)throw r}r="message"==e.fieldKind?tI(e,t):eH(t)||eQ(t)?t[e_]:tD(e,t),e$(this.message,e,r)}getUnknown(){return this.message.$unknown}setUnknown(e){this.message.$unknown=e}}function tA(e,t){if(t.parent.typeName!==e.$typeName)throw new tt(t,`cannot use ${t.toString()} with message ${e.$typeName}`,"ForeignFieldError")}class tS{field(){return this._field}get size(){return this._arr.length}constructor(e,t,r){this._field=e,this._arr=this[e_]=t,this.check=r}get(e){let t=this._arr[e];return void 0===t?void 0:tR(this._field,t,this.check)}set(e,t){if(e<0||e>=this._arr.length)throw new tt(this._field,`list item #${e+1}: out of range`);if(this.check){let r=tu(this._field,e,t);if(r)throw r}this._arr[e]=tN(this._field,t)}add(e){if(this.check){let t=tu(this._field,this._arr.length,e);if(t)throw t}this._arr.push(tN(this._field,e))}clear(){this._arr.splice(0,this._arr.length)}[Symbol.iterator](){return this.values()}keys(){return this._arr.keys()}*values(){for(let e of this._arr)yield tR(this._field,e,this.check)}*entries(){for(let e=0;e<this._arr.length;e++)yield[e,tR(this._field,this._arr[e],this.check)]}}class tE{constructor(e,t,r=!0){this.obj=this[e_]=null!=t?t:{},this.check=r,this._field=e}field(){return this._field}set(e,t){var r,n;if(this.check){let r=function(e,t,r){let n=tc(t,e.mapKey);if(!0!==n)return new tt(e,`invalid map key: ${th({scalar:e.mapKey},t,n)}`);let i=td(e,r);if(!0!==i)return new tt(e,`map entry ${tg(t)}: ${th(e,r,i)}`)}(this._field,e,t);if(r)throw r}return this.obj[tT(e)]=(r=this._field,n=t,"message"==r.mapKind?tI(r,n):tD(r,n)),this}delete(e){let t=tT(e),r=Object.prototype.hasOwnProperty.call(this.obj,t);return r&&delete this.obj[t],r}clear(){for(let e of Object.keys(this.obj))delete this.obj[e]}get(e){let t=this.obj[tT(e)];return void 0!==t&&(t=tC(this._field,t,this.check)),t}has(e){return Object.prototype.hasOwnProperty.call(this.obj,tT(e))}*keys(){for(let e of Object.keys(this.obj))yield tx(e,this._field.mapKey)}*entries(){for(let e of Object.entries(this.obj))yield[tx(e[0],this._field.mapKey),tC(this._field,e[1],this.check)]}[Symbol.iterator](){return this.entries()}get size(){return Object.keys(this.obj).length}*values(){for(let e of Object.values(this.obj))yield tC(this._field,e,this.check)}forEach(e,t){for(let r of this.entries())e.call(t,r[1],r[0],this)}}function tI(e,t){return eq(t)?e1(t.message.$typeName)&&!e.oneof&&"message"==e.fieldKind?t.message.value:"google.protobuf.Struct"==t.desc.typeName&&"google.protobuf.Value"!=e.parent.typeName?function e(t){let r={};for(let[n,i]of Object.entries(t.fields))r[n]=function t(r){switch(r.kind.case){case"structValue":return e(r.kind.value);case"listValue":return r.kind.value.values.map(t);case"nullValue":case void 0:return null;default:return r.kind.value}}(i);return r}(t.message):t.message:t}function tw(e,t,r){return void 0!==t&&(e0(e.message)&&!e.oneof&&"message"==e.fieldKind?t={$typeName:e.message.typeName,value:tV(e.message.fields[0],t)}:"google.protobuf.Struct"==e.message.typeName&&"google.protobuf.Value"!=e.parent.typeName&&ej(t)&&(t=function e(t){let r={$typeName:"google.protobuf.Struct",fields:{}};if(ej(t))for(let[n,i]of Object.entries(t))r.fields[n]=function t(r){let n={$typeName:"google.protobuf.Value",kind:{case:void 0}};switch(typeof r){case"number":n.kind={case:"numberValue",value:r};break;case"string":n.kind={case:"stringValue",value:r};break;case"boolean":n.kind={case:"boolValue",value:r};break;case"object":if(null===r)n.kind={case:"nullValue",value:0};else if(Array.isArray(r)){let e={$typeName:"google.protobuf.ListValue",values:[]};if(Array.isArray(r))for(let n of r)e.values.push(t(n));n.kind={case:"listValue",value:e}}else n.kind={case:"structValue",value:e(r)}}return n}(i);return r}(t))),new tv(e.message,t,r)}function tN(e,t){return"message"==e.listKind?tI(e,t):tD(e,t)}function tR(e,t,r){return"message"==e.listKind?tw(e,t,r):tV(e,t)}function tC(e,t,r){return"message"==e.mapKind?tw(e,t,r):t}function tT(e){return"string"==typeof e||"number"==typeof e?e:String(e)}function tx(e,t){switch(t){case ea.STRING:break;case ea.INT32:case ea.FIXED32:case ea.UINT32:case ea.SFIXED32:case ea.SINT32:{let t=Number.parseInt(e);if(Number.isFinite(t))return t;break}case ea.BOOL:switch(e){case"true":return!0;case"false":return!1}break;case ea.UINT64:case ea.FIXED64:try{return eG.uParse(e)}catch(e){}break;default:try{return eG.parse(e)}catch(e){}}return e}function tV(e,t){switch(e.scalar){case ea.INT64:case ea.SFIXED64:case ea.SINT64:"longAsString"in e&&e.longAsString&&"string"==typeof t&&(t=eG.parse(t));break;case ea.FIXED64:case ea.UINT64:"longAsString"in e&&e.longAsString&&"string"==typeof t&&(t=eG.uParse(t))}return t}function tD(e,t){switch(e.scalar){case ea.INT64:case ea.SFIXED64:case ea.SINT64:"longAsString"in e&&e.longAsString?t=String(t):("string"==typeof t||"number"==typeof t)&&(t=eG.parse(t));break;case ea.FIXED64:case ea.UINT64:"longAsString"in e&&e.longAsString?t=String(t):("string"==typeof t||"number"==typeof t)&&(t=eG.uParse(t))}return t}let tk={readUnknownFields:!0};function tB(e,t,r){let n=ty(e,void 0,!1);return tW(n,new ts(t),r?Object.assign(Object.assign({},tk),r):tk,!1,t.byteLength),n.message}function tW(e,t,r,n,i){var s;let a,o,l=n?t.len:t.pos+i,u=null!=(s=e.getUnknown())?s:[];for(;t.pos<l&&([a,o]=t.tag(),!n||o!=eo.EndGroup);){let n=e.findNumber(a);if(!n){let e=t.skip(o,a);r.readUnknownFields&&u.push({no:a,wireType:o,data:e});continue}tL(e,t,n,o,r)}if(n&&(o!=eo.EndGroup||a!==i))throw Error("invalid end group tag");u.length>0&&e.setUnknown(u)}function tL(e,t,r,n,i){var s;switch(r.fieldKind){case"scalar":e.set(r,tZ(t,r.scalar));break;case"enum":let a=tZ(t,ea.INT32);if(r.enum.open)e.set(r,a);else if(r.enum.values.some(e=>e.number===a))e.set(r,a);else if(i.readUnknownFields){let t=[];eP(a,t);let i=null!=(s=e.getUnknown())?s:[];i.push({no:r.number,wireType:n,data:new Uint8Array(t)}),e.setUnknown(i)}break;case"message":e.set(r,tO(t,i,r,e.get(r)));break;case"list":!function(e,t,r,n){var i;let s=r.field();if("message"===s.listKind)return r.add(tO(e,n,s));let a=null!=(i=s.scalar)?i:ea.INT32;if(t!=eo.LengthDelimited||a==ea.STRING||a==ea.BYTES)return r.add(tZ(e,a));let o=e.uint32()+e.pos;for(;e.pos<o;)r.add(tZ(e,a))}(t,n,e.get(r),i);break;case"map":!function(e,t,r){let n,i,s=t.field(),a=e.uint32(),o=e.pos+a;for(;e.pos<o;){let[t]=e.tag();switch(t){case 1:n=tZ(e,s.mapKey);break;case 2:switch(s.mapKind){case"scalar":i=tZ(e,s.scalar);break;case"enum":i=e.int32();break;case"message":i=tO(e,r,s)}}}if(void 0===n&&(n=eM(s.mapKey,!1)),void 0===i)switch(s.mapKind){case"scalar":i=eM(s.scalar,!1);break;case"enum":i=s.enum.values[0].number;break;case"message":i=ty(s.message,void 0,!1)}t.set(n,i)}(t,e.get(r),i)}}function tO(e,t,r,n){let i=r.delimitedEncoding,s=null!=n?n:ty(r.message,void 0,!1);return tW(s,e,t,i,i?r.number:e.uint32()),s}function tZ(e,t){switch(t){case ea.STRING:return e.string();case ea.BOOL:return e.bool();case ea.DOUBLE:return e.double();case ea.FLOAT:return e.float();case ea.INT32:return e.int32();case ea.INT64:return e.int64();case ea.UINT64:return e.uint64();case ea.FIXED64:return e.fixed64();case ea.BYTES:return e.bytes();case ea.FIXED32:return e.fixed32();case ea.SFIXED32:return e.sfixed32();case ea.SFIXED64:return e.sfixed64();case ea.SINT64:return e.sint64();case ea.UINT32:return e.uint32();case ea.SINT32:return e.sint32()}}function tF(e){let t=es[e];return"string"!=typeof t?e.toString():t[0].toLowerCase()+t.substring(1).replace(/[A-Z]/g,e=>"_"+e.toLowerCase())}class tP extends Error{constructor(e,t=es.Unknown,r,n,i){super(function(e,t){return e.length?`[${tF(t)}] ${e}`:`[${tF(t)}]`}(e,t)),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=e,this.code=t,this.metadata=new Headers(null!=r?r:{}),this.details=null!=n?n:[],this.cause=i}static from(e,t=es.Unknown){return e instanceof tP?e:e instanceof Error?"AbortError"==e.name||"TimeoutError"==e.name?new tP(e.message,es.Canceled):new tP(e.message,t,void 0,void 0,e):new tP(String(e),t,void 0,void 0,e)}static[Symbol.hasInstance](e){return e instanceof Error&&(Object.getPrototypeOf(e)===tP.prototype||"ConnectError"===e.name&&"code"in e&&"number"==typeof e.code&&"metadata"in e&&"details"in e&&Array.isArray(e.details)&&"rawMessage"in e&&"string"==typeof e.rawMessage&&"cause"in e)}findDetails(e){let t="message"===e.kind?{getMessage:t=>t===e.typeName?e:void 0}:e,r=[];for(let e of this.details){if("desc"in e){t.getMessage(e.desc.typeName)&&r.push(e2(e.desc,e.value));continue}let n=t.getMessage(e.type);if(n)try{r.push(tB(n,e.value))}catch(e){}}return r}}class tU{constructor(e){this.readMaxBytes=e,this.header=new Uint8Array(5),this.headerView=new DataView(this.header.buffer),this.buf=[]}get byteLength(){return this.buf.reduce((e,t)=>e+t.byteLength,0)}decode(e){this.buf.push(e);let t=[];for(;;){let e=this.pop();if(!e)break;t.push(e)}return t}pop(){if((this.env||(this.env=this.head(),this.env))&&this.cons(this.env.data)){let e=this.env;return this.env=void 0,e}}head(){if(!this.cons(this.header))return;let e=this.headerView.getUint8(0),t=this.headerView.getUint32(1);return!function(e,t,r=!1){if(t>e){let n=`message size is larger than configured readMaxBytes ${e}`;throw r&&(n=`message size ${t} is larger than configured readMaxBytes ${e}`),new tP(n,es.ResourceExhausted)}}(this.readMaxBytes,t,!0),{flags:e,data:new Uint8Array(t)}}cons(e){let t=e.byteLength;if(this.byteLength<t)return!1;let r=0;for(;r<t;){let n=this.buf.shift();n.byteLength>t-r?(e.set(n.subarray(0,t-r),r),this.buf.unshift(n.subarray(t-r)),r+=t-r):(e.set(n,r),r+=n.byteLength)}return!0}}function tG(e){let t,r=new tU(0xffffffff);return new ReadableStream({start(){t=e.getReader()},async pull(e){let n=!1;for(;!n;){let i=await t.read();if(i.done)r.byteLength>0&&e.error(new tP("protocol error: incomplete envelope",es.InvalidArgument)),e.close();else for(let t of r.decode(i.value))e.enqueue(t),n=!0}}})}function tY(e,t){let r=new Uint8Array(t.length+5);r.set(t,5);let n=new DataView(r.buffer,r.byteOffset,r.byteLength);return n.setUint8(0,e),n.setUint32(1,t.length),r}var tK=function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){var s,a,o;s=n,a=i,o=(t=e[r](t)).done,Promise.resolve(t.value).then(function(e){s({value:e,done:o})},a)})}}},tM=function(e){return this instanceof tM?(this.v=e,this):new tM(e)},t_=function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),n[Symbol.asyncIterator]=function(){return this},n;function a(e,t){i[e]&&(n[e]=function(t){return new Promise(function(r,n){s.push([e,t,r,n])>1||o(e,t)})},t&&(n[e]=t(n[e])))}function o(e,t){try{var r;(r=i[e](t)).value instanceof tM?Promise.resolve(r.value.v).then(l,u):d(s[0][2],r)}catch(e){d(s[0][3],e)}}function l(e){o("next",e)}function u(e){o("throw",e)}function d(e,t){e(t),s.shift(),s.length&&o(s[0][0],s[0][1])}},tX=function(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:tM(e[n](t)),done:!1}:i?i(t):t}:i}},tJ=function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){var s,a,o;s=n,a=i,o=(t=e[r](t)).done,Promise.resolve(t.value).then(function(e){s({value:e,done:o})},a)})}}},tz=function(e){return this instanceof tz?(this.v=e,this):new tz(e)},t$=function(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:tz(e[n](t)),done:!1}:i?i(t):t}:i}},tj=function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),n[Symbol.asyncIterator]=function(){return this},n;function a(e,t){i[e]&&(n[e]=function(t){return new Promise(function(r,n){s.push([e,t,r,n])>1||o(e,t)})},t&&(n[e]=t(n[e])))}function o(e,t){try{var r;(r=i[e](t)).value instanceof tz?Promise.resolve(r.value.v).then(l,u):d(s[0][2],r)}catch(e){d(s[0][3],e)}}function l(e){o("next",e)}function u(e){o("throw",e)}function d(e,t){e(t),s.shift(),s.length&&o(s[0][0],s[0][1])}};function tQ(e,t){let r=(function(){return tj(this,arguments,function*(){var r,n;let i=yield tz(e);null==(r=null==t?void 0:t.onHeader)||r.call(t,i.header),yield tz((yield*t$(tJ(i.message)))),null==(n=null==t?void 0:t.onTrailer)||n.call(t,i.trailer)})})()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>r.next()})}}function tH(){return{get(e){return e.id in this?this[e.id]:e.defaultValue},set(e,t){return this[e.id]=t,this},delete(e){return delete this[e.id],this}}}function tq(e){let t=function(){if(!n){n=[];let e=t0("std");for(let t=0;t<e.length;t++)n[e[t].charCodeAt(0)]=t;n[45]=e.indexOf("+"),n[95]=e.indexOf("/")}return n}(),r=3*e.length/4;"="==e[e.length-2]?r-=2:"="==e[e.length-1]&&(r-=1);let i=new Uint8Array(r),s=0,a=0,o,l=0;for(let r=0;r<e.length;r++){if(void 0===(o=t[e.charCodeAt(r)]))switch(e[r]){case"=":a=0;case"\n":case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string")}switch(a){case 0:l=o,a=1;break;case 1:i[s++]=l<<2|(48&o)>>4,l=o,a=2;break;case 2:i[s++]=(15&l)<<4|(60&o)>>2,l=o,a=3;break;case 3:i[s++]=(3&l)<<6|o,a=0}}if(1==a)throw Error("invalid base64 string");return i.subarray(0,s)}function t0(e){return t||(r=(t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("")).slice(0,-2).concat("-","_")),"url"==e?r:t}function t1(e){let t=!1,r=[];for(let n=0;n<e.length;n++){let i=e.charAt(n);switch(i){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r.push(i),t=!1;break;default:t&&(t=!1,i=i.toUpperCase()),r.push(i)}}return r.join("")}let t2=new Set(["constructor","toString","toJSON","valueOf"]);function t3(e){return t2.has(e)?e+"$":e}function t5(e){for(let t of e.field)eJ(t,"jsonName")||(t.jsonName=t1(t.name));e.nestedType.forEach(t5)}function t9(...e){let t,r,n,i=(t=new Map,r=new Map,n=new Map,{kind:"registry",types:t,extendees:r,[Symbol.iterator]:()=>t.values(),get files(){return n.values()},addFile(e,t,r){if(n.set(e.proto.name,e),!t)for(let t of function* e(t){switch(t.kind){case"file":for(let r of t.messages)yield r,yield*e(r);yield*t.enums,yield*t.services,yield*t.extensions;break;case"message":for(let r of t.nestedMessages)yield r,yield*e(r);yield*t.nestedEnums,yield*t.nestedExtensions}}(e))this.add(t);if(r)for(let n of e.dependencies)this.addFile(n,t,r)},add(e){if("extension"==e.kind){let t=r.get(e.extendee.typeName);t||r.set(e.extendee.typeName,t=new Map),t.set(e.number,e)}t.set(e.typeName,e)},get:e=>t.get(e),getFile:e=>n.get(e),getMessage(e){let r=t.get(e);return(null==r?void 0:r.kind)=="message"?r:void 0},getEnum(e){let r=t.get(e);return(null==r?void 0:r.kind)=="enum"?r:void 0},getExtension(e){let r=t.get(e);return(null==r?void 0:r.kind)=="extension"?r:void 0},getExtensionFor(e,t){var n;return null==(n=r.get(e.typeName))?void 0:n.get(t)},getService(e){let r=t.get(e);return(null==r?void 0:r.kind)=="service"?r:void 0}});if(!e.length)return i;if("$typeName"in e[0]&&"google.protobuf.FileDescriptorSet"==e[0].$typeName){for(let t of e[0].file)t6(t,i);return i}if("$typeName"in e[0]){let t=e[0],r=e[1],n=new Set;for(let e of[t,...function e(t){let s=[];for(let e of t.dependency){if(void 0!=i.getFile(e)||n.has(e))continue;let a=r(e);if(!a)throw Error(`Unable to resolve ${e}, imported by ${t.name}`);"kind"in a?i.addFile(a,!1,!0):(n.add(a.name),s.push(a))}return s.concat(...s.map(e))}(t)].reverse())t6(e,i)}else for(let t of e)for(let e of t.files)i.addFile(e);return i}let t4={998:{fieldPresence:1,enumType:2,repeatedFieldEncoding:2,utf8Validation:3,messageEncoding:1,jsonFormat:2,enforceNamingStyle:2,defaultSymbolVisibility:1},999:{fieldPresence:2,enumType:1,repeatedFieldEncoding:1,utf8Validation:2,messageEncoding:1,jsonFormat:1,enforceNamingStyle:2,defaultSymbolVisibility:1},1e3:{fieldPresence:1,enumType:1,repeatedFieldEncoding:1,utf8Validation:2,messageEncoding:1,jsonFormat:1,enforceNamingStyle:2,defaultSymbolVisibility:1},1001:{fieldPresence:1,enumType:1,repeatedFieldEncoding:1,utf8Validation:2,messageEncoding:1,jsonFormat:1,enforceNamingStyle:1,defaultSymbolVisibility:2}};function t6(e,t){var r,n,i,s;let a={kind:"file",proto:e,deprecated:null!=(n=null==(r=e.options)?void 0:r.deprecated)&&n,edition:function(e){switch(e.syntax){case"":case"proto2":return 998;case"proto3":return 999;case"editions":if(e.edition in t4)return e.edition;throw Error(`${e.name}: unsupported edition`);default:throw Error(`${e.name}: unsupported syntax "${e.syntax}"`)}}(e),name:e.name.replace(/\.proto$/,""),dependencies:(i=e,s=t,i.dependency.map(e=>{let t=s.getFile(e);if(!t)throw Error(`Cannot find ${e}, imported by ${i.name}`);return t})),enums:[],messages:[],extensions:[],services:[],toString:()=>`file ${e.name}`},o=new Map,l={get:e=>o.get(e),add(e){var t;ra((null==(t=e.proto.options)?void 0:t.mapEntry)===!0),o.set(e.typeName,e)}};for(let r of e.enumType)re(r,a,void 0,t);for(let r of e.messageType)!function e(t,r,n,i,s){var a,o,l,u;let d={kind:"message",proto:t,deprecated:null!=(o=null==(a=t.options)?void 0:a.deprecated)&&o,file:r,parent:n,name:t.name,typeName:rr(t,n,r),fields:[],field:{},oneofs:[],members:[],nestedEnums:[],nestedMessages:[],nestedExtensions:[],toString(){return`message ${this.typeName}`}};for(let e of((null==(l=t.options)?void 0:l.mapEntry)===!0?s.add(d):((null!=(u=null==n?void 0:n.nestedMessages)?u:r.messages).push(d),i.add(d)),t.enumType))re(e,r,d,i);for(let n of t.nestedType)e(n,r,d,i,s)}(r,a,void 0,t,l);for(let r of e.service)!function(e,t,r){var n,i;let s={kind:"service",proto:e,deprecated:null!=(i=null==(n=e.options)?void 0:n.deprecated)&&i,file:t,name:e.name,typeName:rr(e,void 0,t),methods:[],method:{},toString(){return`service ${this.typeName}`}};for(let n of(t.services.push(s),r.add(s),e.method)){let e=function(e,t,r){var n,i,s,a;let o;o=e.clientStreaming&&e.serverStreaming?"bidi_streaming":e.clientStreaming?"client_streaming":e.serverStreaming?"server_streaming":"unary";let l=r.getMessage(rn(e.inputType)),u=r.getMessage(rn(e.outputType));ra(l,`invalid MethodDescriptorProto: input_type ${e.inputType} not found`),ra(u,`invalid MethodDescriptorProto: output_type ${e.inputType} not found`);let d=e.name;return{kind:"rpc",proto:e,deprecated:null!=(i=null==(n=e.options)?void 0:n.deprecated)&&i,parent:t,name:d,localName:t3(d.length?t3(d[0].toLowerCase()+d.substring(1)):d),methodKind:o,input:l,output:u,idempotency:null!=(a=null==(s=e.options)?void 0:s.idempotencyLevel)?a:0,toString:()=>`rpc ${t.typeName}.${d}`}}(n,s,r);s.methods.push(e),s.method[e.localName]=e}}(r,a,t);for(let e of(t8(a,t),o.values()))t7(e,t,l);for(let e of a.messages)t7(e,t,l),t8(e,t);t.addFile(a,!0)}function t8(e,t){switch(e.kind){case"file":for(let r of e.proto.extension){let n=rt(r,e,t);e.extensions.push(n),t.add(n)}break;case"message":for(let r of e.proto.extension){let n=rt(r,e,t);e.nestedExtensions.push(n),t.add(n)}for(let r of e.nestedMessages)t8(r,t)}}function t7(e,t,r){let n=e.proto.oneofDecl.map(t=>{var r,n;return r=t,{kind:"oneof",proto:r,deprecated:!1,parent:n=e,fields:[],name:r.name,localName:t3(t1(r.name)),toString(){return`oneof ${n.typeName}.${this.name}`}}}),i=new Set;for(let s of e.proto.field){let a=function(e,t){if(!eJ(e,"oneofIndex")||e.proto3Optional)return;let r=t[e.oneofIndex];return ra(r,`invalid FieldDescriptorProto: oneof #${e.oneofIndex} for field #${e.number} not found`),r}(s,n),o=rt(s,e,t,a,r);e.fields.push(o),e.field[o.localName]=o,void 0===a?e.members.push(o):(a.fields.push(o),i.has(a)||(i.add(a),e.members.push(a)))}for(let t of n.filter(e=>i.has(e)))e.oneofs.push(t);for(let n of e.nestedMessages)t7(n,t,r)}function re(e,t,r,n){var i,s,a,o,l,u,d;let c=function(e,t){var r;let n=((r=e).substring(0,1)+r.substring(1).replace(/[A-Z]/g,e=>"_"+e)).toLowerCase()+"_";for(let e of t){if(!e.name.toLowerCase().startsWith(n))return;let t=e.name.substring(n.length);if(0==t.length||/^\d/.test(t))return}return n}(e.name,e.value),h={kind:"enum",proto:e,deprecated:null!=(s=null==(i=e.options)?void 0:i.deprecated)&&s,file:t,parent:r,open:!0,name:e.name,typeName:rr(e,r,t),value:{},values:[],sharedPrefix:c,toString(){return`enum ${this.typeName}`}};for(let t of(h.open=1==rs("enumType",{proto:(u=h).proto,parent:null!=(d=u.parent)?d:u.file}),n.add(h),e.value)){let e=t.name;h.values.push(h.value[t.number]={kind:"enum_value",proto:t,deprecated:null!=(o=null==(a=t.options)?void 0:a.deprecated)&&o,parent:h,name:e,localName:t3(void 0==c?e:e.substring(c.length)),number:t.number,toString:()=>`enum value ${h.typeName}.${e}`})}(null!=(l=null==r?void 0:r.nestedEnums)?l:t.enums).push(h)}function rt(e,t,r,n,i){var s,a,o,l;let u=void 0===i,d={kind:"field",proto:e,deprecated:null!=(a=null==(s=e.options)?void 0:s.deprecated)&&a,name:e.name,number:e.number,scalar:void 0,message:void 0,enum:void 0,presence:function(e,t,r,n){if(2==e.label)return 3;if(3==e.label)return 2;if(t||e.proto3Optional||r)return 1;let i=rs("fieldPresence",{proto:e,parent:n});return 2==i&&(11==e.type||10==e.type)?1:i}(e,n,u,t),listKind:void 0,mapKind:void 0,mapKey:void 0,delimitedEncoding:void 0,packed:void 0,longAsString:!1,getDefaultValue:void 0};if(u){let n="file"==t.kind?t:t.file,i="file"==t.kind?void 0:t,s=rr(e,i,n);d.kind="extension",d.file=n,d.parent=i,d.oneof=void 0,d.typeName=s,d.jsonName=`[${s}]`,d.toString=()=>`extension ${s}`;let a=r.getMessage(rn(e.extendee));ra(a,`invalid FieldDescriptorProto: extendee ${e.extendee} not found`),d.extendee=a}else ra("message"==t.kind),d.parent=t,d.oneof=n,d.localName=n?t1(e.name):t3(t1(e.name)),d.jsonName=e.jsonName,d.toString=()=>`field ${t.typeName}.${e.name}`;let c=e.label,h=e.type,g=null==(o=e.options)?void 0:o.jstype;if(3===c){let n=11==h?null==i?void 0:i.get(rn(e.typeName)):void 0;if(n){let e,t;d.fieldKind="map";let{key:r,value:i}=(e=(l=n).fields.find(e=>1===e.number),t=l.fields.find(e=>2===e.number),ra(e&&"scalar"==e.fieldKind&&e.scalar!=ea.BYTES&&e.scalar!=ea.FLOAT&&e.scalar!=ea.DOUBLE&&t&&"list"!=t.fieldKind&&"map"!=t.fieldKind),{key:e,value:t});return d.mapKey=r.scalar,d.mapKind=i.fieldKind,d.message=i.message,d.delimitedEncoding=!1,d.enum=i.enum,d.scalar=i.scalar,d}switch(d.fieldKind="list",h){case 11:case 10:d.listKind="message",d.message=r.getMessage(rn(e.typeName)),ra(d.message),d.delimitedEncoding=ri(e,t);break;case 14:d.listKind="enum",d.enum=r.getEnum(rn(e.typeName)),ra(d.enum);break;default:d.listKind="scalar",d.scalar=h,d.longAsString=1==g}return d.packed=function(e,t){if(3!=e.label)return!1;switch(e.type){case 9:case 12:case 10:case 11:return!1}let r=e.options;return r&&eJ(r,"packed")?r.packed:1==rs("repeatedFieldEncoding",{proto:e,parent:t})}(e,t),d}switch(h){case 11:case 10:d.fieldKind="message",d.message=r.getMessage(rn(e.typeName)),ra(d.message,`invalid FieldDescriptorProto: type_name ${e.typeName} not found`),d.delimitedEncoding=ri(e,t),d.getDefaultValue=()=>void 0;break;case 14:{let t=r.getEnum(rn(e.typeName));ra(void 0!==t,`invalid FieldDescriptorProto: type_name ${e.typeName} not found`),d.fieldKind="enum",d.enum=r.getEnum(rn(e.typeName)),d.getDefaultValue=()=>eJ(e,"defaultValue")?function(e,t){let r=e.values.find(e=>e.name===t);if(!r)throw Error(`cannot parse ${e} default value: ${t}`);return r.number}(t,e.defaultValue):void 0;break}default:d.fieldKind="scalar",d.scalar=h,d.longAsString=1==g,d.getDefaultValue=()=>eJ(e,"defaultValue")?function(e,t){switch(e){case ea.STRING:return t;case ea.BYTES:{let r=function(e){let t=[],r={tail:e,c:"",next(){return 0!=this.tail.length&&(this.c=this.tail[0],this.tail=this.tail.substring(1),!0)},take(e){if(this.tail.length>=e){let t=this.tail.substring(0,e);return this.tail=this.tail.substring(e),t}return!1}};for(;r.next();)if("\\"===r.c){if(r.next())switch(r.c){case"\\":t.push(r.c.charCodeAt(0));break;case"b":t.push(8);break;case"f":t.push(12);break;case"n":t.push(10);break;case"r":t.push(13);break;case"t":t.push(9);break;case"v":t.push(11);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":{let e=r.c,n=r.take(2);if(!1===n)return!1;let i=parseInt(e+n,8);if(Number.isNaN(i))return!1;t.push(i);break}case"x":{let e=r.c,n=r.take(2);if(!1===n)return!1;let i=parseInt(e+n,16);if(Number.isNaN(i))return!1;t.push(i);break}case"u":{let e=r.c,n=r.take(4);if(!1===n)return!1;let i=parseInt(e+n,16);if(Number.isNaN(i))return!1;let s=new Uint8Array(4);new DataView(s.buffer).setInt32(0,i,!0),t.push(s[0],s[1],s[2],s[3]);break}case"U":{let e=r.c,n=r.take(8);if(!1===n)return!1;let i=eG.uEnc(e+n),s=new Uint8Array(8),a=new DataView(s.buffer);a.setInt32(0,i.lo,!0),a.setInt32(4,i.hi,!0),t.push(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7])}}}else t.push(r.c.charCodeAt(0));return new Uint8Array(t)}(t);if(!1===r)throw Error(`cannot parse ${ea[e]} default value: ${t}`);return r}case ea.INT64:case ea.SFIXED64:case ea.SINT64:return eG.parse(t);case ea.UINT64:case ea.FIXED64:return eG.uParse(t);case ea.DOUBLE:case ea.FLOAT:switch(t){case"inf":return 1/0;case"-inf":return-1/0;case"nan":return NaN;default:return parseFloat(t)}case ea.BOOL:return"true"===t;case ea.INT32:case ea.UINT32:case ea.SINT32:case ea.FIXED32:case ea.SFIXED32:return parseInt(t,10)}}(h,e.defaultValue):void 0}return d}function rr(e,t,r){return t?`${t.typeName}.${e.name}`:r.proto.package.length>0?`${r.proto.package}.${e.name}`:`${e.name}`}function rn(e){return e.startsWith(".")?e.substring(1):e}function ri(e,t){return 10==e.type||2==rs("messageEncoding",{proto:e,parent:t})}function rs(e,t){var r,n;let i=null==(r=t.proto.options)?void 0:r.features;if(i){let t=i[e];if(0!=t)return t}if("kind"in t){if("message"==t.kind)return rs(e,null!=(n=t.parent)?n:t.file);let r=t4[t.edition];if(!r)throw Error(`feature default for edition ${t.edition} not found`);return r[e]}return rs(e,t.parent)}function ra(e,t){if(!e)throw Error(t)}function ro(e){var t,r,n,i,s,a,o,l;return Object.assign(Object.create({visibility:0}),{$typeName:"google.protobuf.DescriptorProto",name:e.name,field:null!=(r=null==(t=e.field)?void 0:t.map(rl))?r:[],extension:[],nestedType:null!=(i=null==(n=e.nestedType)?void 0:n.map(ro))?i:[],enumType:null!=(a=null==(s=e.enumType)?void 0:s.map(ru))?a:[],extensionRange:null!=(l=null==(o=e.extensionRange)?void 0:o.map(e=>Object.assign({$typeName:"google.protobuf.DescriptorProto.ExtensionRange"},e)))?l:[],oneofDecl:[],reservedRange:[],reservedName:[]})}function rl(e){var t,r,n,i;return Object.assign(Object.create({label:1,typeName:"",extendee:"",defaultValue:"",oneofIndex:0,jsonName:"",proto3Optional:!1}),Object.assign(Object.assign({$typeName:"google.protobuf.FieldDescriptorProto"},e),{options:e.options?(t=e.options,Object.assign(Object.create({ctype:0,packed:!1,jstype:0,lazy:!1,unverifiedLazy:!1,deprecated:!1,weak:!1,debugRedact:!1,retention:0}),Object.assign(Object.assign({$typeName:"google.protobuf.FieldOptions"},t),{targets:null!=(r=t.targets)?r:[],editionDefaults:null!=(i=null==(n=t.editionDefaults)?void 0:n.map(e=>Object.assign({$typeName:"google.protobuf.FieldOptions.EditionDefault"},e)))?i:[],uninterpretedOption:[]}))):void 0}))}function ru(e){return Object.assign(Object.create({visibility:0}),{$typeName:"google.protobuf.EnumDescriptorProto",name:e.name,reservedName:[],reservedRange:[],value:e.value.map(e=>Object.assign({$typeName:"google.protobuf.EnumValueDescriptorProto"},e))})}function rd(e,t,...r){return r.reduce((e,t)=>e.nestedMessages[t],e.messages[t])}let rc=rd((d={name:"google/protobuf/descriptor.proto",package:"google.protobuf",messageType:[{name:"FileDescriptorSet",field:[{name:"file",number:1,type:11,label:3,typeName:".google.protobuf.FileDescriptorProto"}],extensionRange:[{start:536e6,end:0x1ff2b601}]},{name:"FileDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"package",number:2,type:9,label:1},{name:"dependency",number:3,type:9,label:3},{name:"public_dependency",number:10,type:5,label:3},{name:"weak_dependency",number:11,type:5,label:3},{name:"option_dependency",number:15,type:9,label:3},{name:"message_type",number:4,type:11,label:3,typeName:".google.protobuf.DescriptorProto"},{name:"enum_type",number:5,type:11,label:3,typeName:".google.protobuf.EnumDescriptorProto"},{name:"service",number:6,type:11,label:3,typeName:".google.protobuf.ServiceDescriptorProto"},{name:"extension",number:7,type:11,label:3,typeName:".google.protobuf.FieldDescriptorProto"},{name:"options",number:8,type:11,label:1,typeName:".google.protobuf.FileOptions"},{name:"source_code_info",number:9,type:11,label:1,typeName:".google.protobuf.SourceCodeInfo"},{name:"syntax",number:12,type:9,label:1},{name:"edition",number:14,type:14,label:1,typeName:".google.protobuf.Edition"}]},{name:"DescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"field",number:2,type:11,label:3,typeName:".google.protobuf.FieldDescriptorProto"},{name:"extension",number:6,type:11,label:3,typeName:".google.protobuf.FieldDescriptorProto"},{name:"nested_type",number:3,type:11,label:3,typeName:".google.protobuf.DescriptorProto"},{name:"enum_type",number:4,type:11,label:3,typeName:".google.protobuf.EnumDescriptorProto"},{name:"extension_range",number:5,type:11,label:3,typeName:".google.protobuf.DescriptorProto.ExtensionRange"},{name:"oneof_decl",number:8,type:11,label:3,typeName:".google.protobuf.OneofDescriptorProto"},{name:"options",number:7,type:11,label:1,typeName:".google.protobuf.MessageOptions"},{name:"reserved_range",number:9,type:11,label:3,typeName:".google.protobuf.DescriptorProto.ReservedRange"},{name:"reserved_name",number:10,type:9,label:3},{name:"visibility",number:11,type:14,label:1,typeName:".google.protobuf.SymbolVisibility"}],nestedType:[{name:"ExtensionRange",field:[{name:"start",number:1,type:5,label:1},{name:"end",number:2,type:5,label:1},{name:"options",number:3,type:11,label:1,typeName:".google.protobuf.ExtensionRangeOptions"}]},{name:"ReservedRange",field:[{name:"start",number:1,type:5,label:1},{name:"end",number:2,type:5,label:1}]}]},{name:"ExtensionRangeOptions",field:[{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"},{name:"declaration",number:2,type:11,label:3,typeName:".google.protobuf.ExtensionRangeOptions.Declaration",options:{retention:2}},{name:"features",number:50,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"verification",number:3,type:14,label:1,typeName:".google.protobuf.ExtensionRangeOptions.VerificationState",defaultValue:"UNVERIFIED",options:{retention:2}}],nestedType:[{name:"Declaration",field:[{name:"number",number:1,type:5,label:1},{name:"full_name",number:2,type:9,label:1},{name:"type",number:3,type:9,label:1},{name:"reserved",number:5,type:8,label:1},{name:"repeated",number:6,type:8,label:1}]}],enumType:[{name:"VerificationState",value:[{name:"DECLARATION",number:0},{name:"UNVERIFIED",number:1}]}],extensionRange:[{start:1e3,end:0x20000000}]},{name:"FieldDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"number",number:3,type:5,label:1},{name:"label",number:4,type:14,label:1,typeName:".google.protobuf.FieldDescriptorProto.Label"},{name:"type",number:5,type:14,label:1,typeName:".google.protobuf.FieldDescriptorProto.Type"},{name:"type_name",number:6,type:9,label:1},{name:"extendee",number:2,type:9,label:1},{name:"default_value",number:7,type:9,label:1},{name:"oneof_index",number:9,type:5,label:1},{name:"json_name",number:10,type:9,label:1},{name:"options",number:8,type:11,label:1,typeName:".google.protobuf.FieldOptions"},{name:"proto3_optional",number:17,type:8,label:1}],enumType:[{name:"Type",value:[{name:"TYPE_DOUBLE",number:1},{name:"TYPE_FLOAT",number:2},{name:"TYPE_INT64",number:3},{name:"TYPE_UINT64",number:4},{name:"TYPE_INT32",number:5},{name:"TYPE_FIXED64",number:6},{name:"TYPE_FIXED32",number:7},{name:"TYPE_BOOL",number:8},{name:"TYPE_STRING",number:9},{name:"TYPE_GROUP",number:10},{name:"TYPE_MESSAGE",number:11},{name:"TYPE_BYTES",number:12},{name:"TYPE_UINT32",number:13},{name:"TYPE_ENUM",number:14},{name:"TYPE_SFIXED32",number:15},{name:"TYPE_SFIXED64",number:16},{name:"TYPE_SINT32",number:17},{name:"TYPE_SINT64",number:18}]},{name:"Label",value:[{name:"LABEL_OPTIONAL",number:1},{name:"LABEL_REPEATED",number:3},{name:"LABEL_REQUIRED",number:2}]}]},{name:"OneofDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"options",number:2,type:11,label:1,typeName:".google.protobuf.OneofOptions"}]},{name:"EnumDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"value",number:2,type:11,label:3,typeName:".google.protobuf.EnumValueDescriptorProto"},{name:"options",number:3,type:11,label:1,typeName:".google.protobuf.EnumOptions"},{name:"reserved_range",number:4,type:11,label:3,typeName:".google.protobuf.EnumDescriptorProto.EnumReservedRange"},{name:"reserved_name",number:5,type:9,label:3},{name:"visibility",number:6,type:14,label:1,typeName:".google.protobuf.SymbolVisibility"}],nestedType:[{name:"EnumReservedRange",field:[{name:"start",number:1,type:5,label:1},{name:"end",number:2,type:5,label:1}]}]},{name:"EnumValueDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"number",number:2,type:5,label:1},{name:"options",number:3,type:11,label:1,typeName:".google.protobuf.EnumValueOptions"}]},{name:"ServiceDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"method",number:2,type:11,label:3,typeName:".google.protobuf.MethodDescriptorProto"},{name:"options",number:3,type:11,label:1,typeName:".google.protobuf.ServiceOptions"}]},{name:"MethodDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"input_type",number:2,type:9,label:1},{name:"output_type",number:3,type:9,label:1},{name:"options",number:4,type:11,label:1,typeName:".google.protobuf.MethodOptions"},{name:"client_streaming",number:5,type:8,label:1,defaultValue:"false"},{name:"server_streaming",number:6,type:8,label:1,defaultValue:"false"}]},{name:"FileOptions",field:[{name:"java_package",number:1,type:9,label:1},{name:"java_outer_classname",number:8,type:9,label:1},{name:"java_multiple_files",number:10,type:8,label:1,defaultValue:"false"},{name:"java_generate_equals_and_hash",number:20,type:8,label:1,options:{deprecated:!0}},{name:"java_string_check_utf8",number:27,type:8,label:1,defaultValue:"false"},{name:"optimize_for",number:9,type:14,label:1,typeName:".google.protobuf.FileOptions.OptimizeMode",defaultValue:"SPEED"},{name:"go_package",number:11,type:9,label:1},{name:"cc_generic_services",number:16,type:8,label:1,defaultValue:"false"},{name:"java_generic_services",number:17,type:8,label:1,defaultValue:"false"},{name:"py_generic_services",number:18,type:8,label:1,defaultValue:"false"},{name:"deprecated",number:23,type:8,label:1,defaultValue:"false"},{name:"cc_enable_arenas",number:31,type:8,label:1,defaultValue:"true"},{name:"objc_class_prefix",number:36,type:9,label:1},{name:"csharp_namespace",number:37,type:9,label:1},{name:"swift_prefix",number:39,type:9,label:1},{name:"php_class_prefix",number:40,type:9,label:1},{name:"php_namespace",number:41,type:9,label:1},{name:"php_metadata_namespace",number:44,type:9,label:1},{name:"ruby_package",number:45,type:9,label:1},{name:"features",number:50,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],enumType:[{name:"OptimizeMode",value:[{name:"SPEED",number:1},{name:"CODE_SIZE",number:2},{name:"LITE_RUNTIME",number:3}]}],extensionRange:[{start:1e3,end:0x20000000}]},{name:"MessageOptions",field:[{name:"message_set_wire_format",number:1,type:8,label:1,defaultValue:"false"},{name:"no_standard_descriptor_accessor",number:2,type:8,label:1,defaultValue:"false"},{name:"deprecated",number:3,type:8,label:1,defaultValue:"false"},{name:"map_entry",number:7,type:8,label:1},{name:"deprecated_legacy_json_field_conflicts",number:11,type:8,label:1,options:{deprecated:!0}},{name:"features",number:12,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:0x20000000}]},{name:"FieldOptions",field:[{name:"ctype",number:1,type:14,label:1,typeName:".google.protobuf.FieldOptions.CType",defaultValue:"STRING"},{name:"packed",number:2,type:8,label:1},{name:"jstype",number:6,type:14,label:1,typeName:".google.protobuf.FieldOptions.JSType",defaultValue:"JS_NORMAL"},{name:"lazy",number:5,type:8,label:1,defaultValue:"false"},{name:"unverified_lazy",number:15,type:8,label:1,defaultValue:"false"},{name:"deprecated",number:3,type:8,label:1,defaultValue:"false"},{name:"weak",number:10,type:8,label:1,defaultValue:"false",options:{deprecated:!0}},{name:"debug_redact",number:16,type:8,label:1,defaultValue:"false"},{name:"retention",number:17,type:14,label:1,typeName:".google.protobuf.FieldOptions.OptionRetention"},{name:"targets",number:19,type:14,label:3,typeName:".google.protobuf.FieldOptions.OptionTargetType"},{name:"edition_defaults",number:20,type:11,label:3,typeName:".google.protobuf.FieldOptions.EditionDefault"},{name:"features",number:21,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"feature_support",number:22,type:11,label:1,typeName:".google.protobuf.FieldOptions.FeatureSupport"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],nestedType:[{name:"EditionDefault",field:[{name:"edition",number:3,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"value",number:2,type:9,label:1}]},{name:"FeatureSupport",field:[{name:"edition_introduced",number:1,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"edition_deprecated",number:2,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"deprecation_warning",number:3,type:9,label:1},{name:"edition_removed",number:4,type:14,label:1,typeName:".google.protobuf.Edition"}]}],enumType:[{name:"CType",value:[{name:"STRING",number:0},{name:"CORD",number:1},{name:"STRING_PIECE",number:2}]},{name:"JSType",value:[{name:"JS_NORMAL",number:0},{name:"JS_STRING",number:1},{name:"JS_NUMBER",number:2}]},{name:"OptionRetention",value:[{name:"RETENTION_UNKNOWN",number:0},{name:"RETENTION_RUNTIME",number:1},{name:"RETENTION_SOURCE",number:2}]},{name:"OptionTargetType",value:[{name:"TARGET_TYPE_UNKNOWN",number:0},{name:"TARGET_TYPE_FILE",number:1},{name:"TARGET_TYPE_EXTENSION_RANGE",number:2},{name:"TARGET_TYPE_MESSAGE",number:3},{name:"TARGET_TYPE_FIELD",number:4},{name:"TARGET_TYPE_ONEOF",number:5},{name:"TARGET_TYPE_ENUM",number:6},{name:"TARGET_TYPE_ENUM_ENTRY",number:7},{name:"TARGET_TYPE_SERVICE",number:8},{name:"TARGET_TYPE_METHOD",number:9}]}],extensionRange:[{start:1e3,end:0x20000000}]},{name:"OneofOptions",field:[{name:"features",number:1,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:0x20000000}]},{name:"EnumOptions",field:[{name:"allow_alias",number:2,type:8,label:1},{name:"deprecated",number:3,type:8,label:1,defaultValue:"false"},{name:"deprecated_legacy_json_field_conflicts",number:6,type:8,label:1,options:{deprecated:!0}},{name:"features",number:7,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:0x20000000}]},{name:"EnumValueOptions",field:[{name:"deprecated",number:1,type:8,label:1,defaultValue:"false"},{name:"features",number:2,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"debug_redact",number:3,type:8,label:1,defaultValue:"false"},{name:"feature_support",number:4,type:11,label:1,typeName:".google.protobuf.FieldOptions.FeatureSupport"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:0x20000000}]},{name:"ServiceOptions",field:[{name:"features",number:34,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"deprecated",number:33,type:8,label:1,defaultValue:"false"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:0x20000000}]},{name:"MethodOptions",field:[{name:"deprecated",number:33,type:8,label:1,defaultValue:"false"},{name:"idempotency_level",number:34,type:14,label:1,typeName:".google.protobuf.MethodOptions.IdempotencyLevel",defaultValue:"IDEMPOTENCY_UNKNOWN"},{name:"features",number:35,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],enumType:[{name:"IdempotencyLevel",value:[{name:"IDEMPOTENCY_UNKNOWN",number:0},{name:"NO_SIDE_EFFECTS",number:1},{name:"IDEMPOTENT",number:2}]}],extensionRange:[{start:1e3,end:0x20000000}]},{name:"UninterpretedOption",field:[{name:"name",number:2,type:11,label:3,typeName:".google.protobuf.UninterpretedOption.NamePart"},{name:"identifier_value",number:3,type:9,label:1},{name:"positive_int_value",number:4,type:4,label:1},{name:"negative_int_value",number:5,type:3,label:1},{name:"double_value",number:6,type:1,label:1},{name:"string_value",number:7,type:12,label:1},{name:"aggregate_value",number:8,type:9,label:1}],nestedType:[{name:"NamePart",field:[{name:"name_part",number:1,type:9,label:2},{name:"is_extension",number:2,type:8,label:2}]}]},{name:"FeatureSet",field:[{name:"field_presence",number:1,type:14,label:1,typeName:".google.protobuf.FeatureSet.FieldPresence",options:{retention:1,targets:[4,1],editionDefaults:[{value:"EXPLICIT",edition:900},{value:"IMPLICIT",edition:999},{value:"EXPLICIT",edition:1e3}]}},{name:"enum_type",number:2,type:14,label:1,typeName:".google.protobuf.FeatureSet.EnumType",options:{retention:1,targets:[6,1],editionDefaults:[{value:"CLOSED",edition:900},{value:"OPEN",edition:999}]}},{name:"repeated_field_encoding",number:3,type:14,label:1,typeName:".google.protobuf.FeatureSet.RepeatedFieldEncoding",options:{retention:1,targets:[4,1],editionDefaults:[{value:"EXPANDED",edition:900},{value:"PACKED",edition:999}]}},{name:"utf8_validation",number:4,type:14,label:1,typeName:".google.protobuf.FeatureSet.Utf8Validation",options:{retention:1,targets:[4,1],editionDefaults:[{value:"NONE",edition:900},{value:"VERIFY",edition:999}]}},{name:"message_encoding",number:5,type:14,label:1,typeName:".google.protobuf.FeatureSet.MessageEncoding",options:{retention:1,targets:[4,1],editionDefaults:[{value:"LENGTH_PREFIXED",edition:900}]}},{name:"json_format",number:6,type:14,label:1,typeName:".google.protobuf.FeatureSet.JsonFormat",options:{retention:1,targets:[3,6,1],editionDefaults:[{value:"LEGACY_BEST_EFFORT",edition:900},{value:"ALLOW",edition:999}]}},{name:"enforce_naming_style",number:7,type:14,label:1,typeName:".google.protobuf.FeatureSet.EnforceNamingStyle",options:{retention:2,targets:[1,2,3,4,5,6,7,8,9],editionDefaults:[{value:"STYLE_LEGACY",edition:900},{value:"STYLE2024",edition:1001}]}},{name:"default_symbol_visibility",number:8,type:14,label:1,typeName:".google.protobuf.FeatureSet.VisibilityFeature.DefaultSymbolVisibility",options:{retention:2,targets:[1],editionDefaults:[{value:"EXPORT_ALL",edition:900},{value:"EXPORT_TOP_LEVEL",edition:1001}]}}],nestedType:[{name:"VisibilityFeature",enumType:[{name:"DefaultSymbolVisibility",value:[{name:"DEFAULT_SYMBOL_VISIBILITY_UNKNOWN",number:0},{name:"EXPORT_ALL",number:1},{name:"EXPORT_TOP_LEVEL",number:2},{name:"LOCAL_ALL",number:3},{name:"STRICT",number:4}]}]}],enumType:[{name:"FieldPresence",value:[{name:"FIELD_PRESENCE_UNKNOWN",number:0},{name:"EXPLICIT",number:1},{name:"IMPLICIT",number:2},{name:"LEGACY_REQUIRED",number:3}]},{name:"EnumType",value:[{name:"ENUM_TYPE_UNKNOWN",number:0},{name:"OPEN",number:1},{name:"CLOSED",number:2}]},{name:"RepeatedFieldEncoding",value:[{name:"REPEATED_FIELD_ENCODING_UNKNOWN",number:0},{name:"PACKED",number:1},{name:"EXPANDED",number:2}]},{name:"Utf8Validation",value:[{name:"UTF8_VALIDATION_UNKNOWN",number:0},{name:"VERIFY",number:2},{name:"NONE",number:3}]},{name:"MessageEncoding",value:[{name:"MESSAGE_ENCODING_UNKNOWN",number:0},{name:"LENGTH_PREFIXED",number:1},{name:"DELIMITED",number:2}]},{name:"JsonFormat",value:[{name:"JSON_FORMAT_UNKNOWN",number:0},{name:"ALLOW",number:1},{name:"LEGACY_BEST_EFFORT",number:2}]},{name:"EnforceNamingStyle",value:[{name:"ENFORCE_NAMING_STYLE_UNKNOWN",number:0},{name:"STYLE2024",number:1},{name:"STYLE_LEGACY",number:2}]}],extensionRange:[{start:1e3,end:9995},{start:9995,end:1e4},{start:1e4,end:10001}]},{name:"FeatureSetDefaults",field:[{name:"defaults",number:1,type:11,label:3,typeName:".google.protobuf.FeatureSetDefaults.FeatureSetEditionDefault"},{name:"minimum_edition",number:4,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"maximum_edition",number:5,type:14,label:1,typeName:".google.protobuf.Edition"}],nestedType:[{name:"FeatureSetEditionDefault",field:[{name:"edition",number:3,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"overridable_features",number:4,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"fixed_features",number:5,type:11,label:1,typeName:".google.protobuf.FeatureSet"}]}]},{name:"SourceCodeInfo",field:[{name:"location",number:1,type:11,label:3,typeName:".google.protobuf.SourceCodeInfo.Location"}],nestedType:[{name:"Location",field:[{name:"path",number:1,type:5,label:3,options:{packed:!0}},{name:"span",number:2,type:5,label:3,options:{packed:!0}},{name:"leading_comments",number:3,type:9,label:1},{name:"trailing_comments",number:4,type:9,label:1},{name:"leading_detached_comments",number:6,type:9,label:3}]}],extensionRange:[{start:536e6,end:0x1ff2b601}]},{name:"GeneratedCodeInfo",field:[{name:"annotation",number:1,type:11,label:3,typeName:".google.protobuf.GeneratedCodeInfo.Annotation"}],nestedType:[{name:"Annotation",field:[{name:"path",number:1,type:5,label:3,options:{packed:!0}},{name:"source_file",number:2,type:9,label:1},{name:"begin",number:3,type:5,label:1},{name:"end",number:4,type:5,label:1},{name:"semantic",number:5,type:14,label:1,typeName:".google.protobuf.GeneratedCodeInfo.Annotation.Semantic"}],enumType:[{name:"Semantic",value:[{name:"NONE",number:0},{name:"SET",number:1},{name:"ALIAS",number:2}]}]}]}],enumType:[{name:"Edition",value:[{name:"EDITION_UNKNOWN",number:0},{name:"EDITION_LEGACY",number:900},{name:"EDITION_PROTO2",number:998},{name:"EDITION_PROTO3",number:999},{name:"EDITION_2023",number:1e3},{name:"EDITION_2024",number:1001},{name:"EDITION_1_TEST_ONLY",number:1},{name:"EDITION_2_TEST_ONLY",number:2},{name:"EDITION_99997_TEST_ONLY",number:99997},{name:"EDITION_99998_TEST_ONLY",number:99998},{name:"EDITION_99999_TEST_ONLY",number:99999},{name:"EDITION_MAX",number:0x7fffffff}]},{name:"SymbolVisibility",value:[{name:"VISIBILITY_UNSET",number:0},{name:"VISIBILITY_LOCAL",number:1},{name:"VISIBILITY_EXPORT",number:2}]}]},(i=Object.assign(Object.create({syntax:"",edition:0}),Object.assign(Object.assign({$typeName:"google.protobuf.FileDescriptorProto",dependency:[],publicDependency:[],weakDependency:[],optionDependency:[],service:[],extension:[]},d),{messageType:d.messageType.map(ro),enumType:d.enumType.map(ru)}))).messageType.forEach(t5),t9(i,()=>void 0).getFile(i.name)),1);function rh(e,t){var r;let n=tB(rc,tq(e));return n.messageType.forEach(t5),n.dependency=null!=(r=null==t?void 0:t.map(e=>e.proto.name))?r:[],t9(n,e=>null==t?void 0:t.find(t=>t.proto.name===e)).getFile(n.name)}(p=el||(el={}))[p.DECLARATION=0]="DECLARATION",p[p.UNVERIFIED=1]="UNVERIFIED",(y=eu||(eu={}))[y.DOUBLE=1]="DOUBLE",y[y.FLOAT=2]="FLOAT",y[y.INT64=3]="INT64",y[y.UINT64=4]="UINT64",y[y.INT32=5]="INT32",y[y.FIXED64=6]="FIXED64",y[y.FIXED32=7]="FIXED32",y[y.BOOL=8]="BOOL",y[y.STRING=9]="STRING",y[y.GROUP=10]="GROUP",y[y.MESSAGE=11]="MESSAGE",y[y.BYTES=12]="BYTES",y[y.UINT32=13]="UINT32",y[y.ENUM=14]="ENUM",y[y.SFIXED32=15]="SFIXED32",y[y.SFIXED64=16]="SFIXED64",y[y.SINT32=17]="SINT32",y[y.SINT64=18]="SINT64",(b=ed||(ed={}))[b.OPTIONAL=1]="OPTIONAL",b[b.REPEATED=3]="REPEATED",b[b.REQUIRED=2]="REQUIRED",(v=ec||(ec={}))[v.SPEED=1]="SPEED",v[v.CODE_SIZE=2]="CODE_SIZE",v[v.LITE_RUNTIME=3]="LITE_RUNTIME",(A=eh||(eh={}))[A.STRING=0]="STRING",A[A.CORD=1]="CORD",A[A.STRING_PIECE=2]="STRING_PIECE",(S=eg||(eg={}))[S.JS_NORMAL=0]="JS_NORMAL",S[S.JS_STRING=1]="JS_STRING",S[S.JS_NUMBER=2]="JS_NUMBER",(E=ef||(ef={}))[E.RETENTION_UNKNOWN=0]="RETENTION_UNKNOWN",E[E.RETENTION_RUNTIME=1]="RETENTION_RUNTIME",E[E.RETENTION_SOURCE=2]="RETENTION_SOURCE",(I=em||(em={}))[I.TARGET_TYPE_UNKNOWN=0]="TARGET_TYPE_UNKNOWN",I[I.TARGET_TYPE_FILE=1]="TARGET_TYPE_FILE",I[I.TARGET_TYPE_EXTENSION_RANGE=2]="TARGET_TYPE_EXTENSION_RANGE",I[I.TARGET_TYPE_MESSAGE=3]="TARGET_TYPE_MESSAGE",I[I.TARGET_TYPE_FIELD=4]="TARGET_TYPE_FIELD",I[I.TARGET_TYPE_ONEOF=5]="TARGET_TYPE_ONEOF",I[I.TARGET_TYPE_ENUM=6]="TARGET_TYPE_ENUM",I[I.TARGET_TYPE_ENUM_ENTRY=7]="TARGET_TYPE_ENUM_ENTRY",I[I.TARGET_TYPE_SERVICE=8]="TARGET_TYPE_SERVICE",I[I.TARGET_TYPE_METHOD=9]="TARGET_TYPE_METHOD",(w=ep||(ep={}))[w.IDEMPOTENCY_UNKNOWN=0]="IDEMPOTENCY_UNKNOWN",w[w.NO_SIDE_EFFECTS=1]="NO_SIDE_EFFECTS",w[w.IDEMPOTENT=2]="IDEMPOTENT",(N=ey||(ey={}))[N.DEFAULT_SYMBOL_VISIBILITY_UNKNOWN=0]="DEFAULT_SYMBOL_VISIBILITY_UNKNOWN",N[N.EXPORT_ALL=1]="EXPORT_ALL",N[N.EXPORT_TOP_LEVEL=2]="EXPORT_TOP_LEVEL",N[N.LOCAL_ALL=3]="LOCAL_ALL",N[N.STRICT=4]="STRICT",(R=eb||(eb={}))[R.FIELD_PRESENCE_UNKNOWN=0]="FIELD_PRESENCE_UNKNOWN",R[R.EXPLICIT=1]="EXPLICIT",R[R.IMPLICIT=2]="IMPLICIT",R[R.LEGACY_REQUIRED=3]="LEGACY_REQUIRED",(C=ev||(ev={}))[C.ENUM_TYPE_UNKNOWN=0]="ENUM_TYPE_UNKNOWN",C[C.OPEN=1]="OPEN",C[C.CLOSED=2]="CLOSED",(T=eA||(eA={}))[T.REPEATED_FIELD_ENCODING_UNKNOWN=0]="REPEATED_FIELD_ENCODING_UNKNOWN",T[T.PACKED=1]="PACKED",T[T.EXPANDED=2]="EXPANDED",(x=eS||(eS={}))[x.UTF8_VALIDATION_UNKNOWN=0]="UTF8_VALIDATION_UNKNOWN",x[x.VERIFY=2]="VERIFY",x[x.NONE=3]="NONE",(V=eE||(eE={}))[V.MESSAGE_ENCODING_UNKNOWN=0]="MESSAGE_ENCODING_UNKNOWN",V[V.LENGTH_PREFIXED=1]="LENGTH_PREFIXED",V[V.DELIMITED=2]="DELIMITED",(D=eI||(eI={}))[D.JSON_FORMAT_UNKNOWN=0]="JSON_FORMAT_UNKNOWN",D[D.ALLOW=1]="ALLOW",D[D.LEGACY_BEST_EFFORT=2]="LEGACY_BEST_EFFORT",(k=ew||(ew={}))[k.ENFORCE_NAMING_STYLE_UNKNOWN=0]="ENFORCE_NAMING_STYLE_UNKNOWN",k[k.STYLE2024=1]="STYLE2024",k[k.STYLE_LEGACY=2]="STYLE_LEGACY",(B=eN||(eN={}))[B.NONE=0]="NONE",B[B.SET=1]="SET",B[B.ALIAS=2]="ALIAS",(W=eR||(eR={}))[W.EDITION_UNKNOWN=0]="EDITION_UNKNOWN",W[W.EDITION_LEGACY=900]="EDITION_LEGACY",W[W.EDITION_PROTO2=998]="EDITION_PROTO2",W[W.EDITION_PROTO3=999]="EDITION_PROTO3",W[W.EDITION_2023=1e3]="EDITION_2023",W[W.EDITION_2024=1001]="EDITION_2024",W[W.EDITION_1_TEST_ONLY=1]="EDITION_1_TEST_ONLY",W[W.EDITION_2_TEST_ONLY=2]="EDITION_2_TEST_ONLY",W[W.EDITION_99997_TEST_ONLY=99997]="EDITION_99997_TEST_ONLY",W[W.EDITION_99998_TEST_ONLY=99998]="EDITION_99998_TEST_ONLY",W[W.EDITION_99999_TEST_ONLY=99999]="EDITION_99999_TEST_ONLY",W[W.EDITION_MAX=0x7fffffff]="EDITION_MAX",(L=eC||(eC={}))[L.VISIBILITY_UNSET=0]="VISIBILITY_UNSET",L[L.VISIBILITY_LOCAL=1]="VISIBILITY_LOCAL",L[L.VISIBILITY_EXPORT=2]="VISIBILITY_EXPORT";let rg=rh("Chlnb29nbGUvcHJvdG9idWYvYW55LnByb3RvEg9nb29nbGUucHJvdG9idWYiJgoDQW55EhAKCHR5cGVfdXJsGAEgASgJEg0KBXZhbHVlGAIgASgMQnYKE2NvbS5nb29nbGUucHJvdG9idWZCCEFueVByb3RvUAFaLGdvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL2FueXBiogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM"),rf=rd(rg,0),rm={writeUnknownFields:!0};function rp(e,t,r){return ry(new ti,r?Object.assign(Object.assign({},rm),r):rm,ty(e,t)).finish()}function ry(e,t,r){var n;for(let n of r.sortedFields){if(!r.isSet(n)){if(3==n.presence)throw Error(`cannot encode ${n} to binary: required field not set`);continue}rb(e,t,r,n)}if(t.writeUnknownFields)for(let{no:t,wireType:i,data:s}of null!=(n=r.getUnknown())?n:[])e.tag(t,i).raw(s);return e}function rb(e,t,r,n){var i;switch(n.fieldKind){case"scalar":case"enum":rv(e,r.desc.typeName,n.name,null!=(i=n.scalar)?i:ea.INT32,n.number,r.get(n));break;case"list":!function(e,t,r,n){var i;if("message"==r.listKind){for(let i of n)rA(e,t,r,i);return}let s=null!=(i=r.scalar)?i:ea.INT32;if(r.packed){if(!n.size)return;for(let t of(e.tag(r.number,eo.LengthDelimited).fork(),n))rS(e,r.parent.typeName,r.name,s,t);e.join();return}for(let t of n)rv(e,r.parent.typeName,r.name,s,r.number,t)}(e,t,n,r.get(n));break;case"message":rA(e,t,n,r.get(n));break;case"map":for(let[i,s]of r.get(n))!function(e,t,r,n,i){var s;switch(e.tag(r.number,eo.LengthDelimited).fork(),rv(e,r.parent.typeName,r.name,r.mapKey,1,n),r.mapKind){case"scalar":case"enum":rv(e,r.parent.typeName,r.name,null!=(s=r.scalar)?s:ea.INT32,2,i);break;case"message":ry(e.tag(2,eo.LengthDelimited).fork(),t,i).join()}e.join()}(e,t,n,i,s)}}function rv(e,t,r,n,i,s){rS(e.tag(i,function(e){switch(e){case ea.BYTES:case ea.STRING:return eo.LengthDelimited;case ea.DOUBLE:case ea.FIXED64:case ea.SFIXED64:return eo.Bit64;case ea.FIXED32:case ea.SFIXED32:case ea.FLOAT:return eo.Bit32;default:return eo.Varint}}(n)),t,r,n,s)}function rA(e,t,r,n){r.delimitedEncoding?ry(e.tag(r.number,eo.StartGroup),t,n).tag(r.number,eo.EndGroup):ry(e.tag(r.number,eo.LengthDelimited).fork(),t,n).join()}function rS(e,t,r,n,i){try{switch(n){case ea.STRING:e.string(i);break;case ea.BOOL:e.bool(i);break;case ea.DOUBLE:e.double(i);break;case ea.FLOAT:e.float(i);break;case ea.INT32:e.int32(i);break;case ea.INT64:e.int64(i);break;case ea.UINT64:e.uint64(i);break;case ea.FIXED64:e.fixed64(i);break;case ea.BYTES:e.bytes(i);break;case ea.FIXED32:e.fixed32(i);break;case ea.SFIXED32:e.sfixed32(i);break;case ea.SFIXED64:e.sfixed64(i);break;case ea.SINT64:e.sint64(i);break;case ea.UINT32:e.uint32(i);break;case ea.SINT32:e.sint32(i)}}catch(e){if(e instanceof Error)throw Error(`cannot encode field ${t}.${r} to binary: ${e.message}`);throw e}}function rE(e){let t=e.lastIndexOf("/"),r=t>=0?e.substring(t+1):e;if(!r.length)throw Error(`invalid type url: ${e}`);return r}let rI=rh("Chxnb29nbGUvcHJvdG9idWYvc3RydWN0LnByb3RvEg9nb29nbGUucHJvdG9idWYihAEKBlN0cnVjdBIzCgZmaWVsZHMYASADKAsyIy5nb29nbGUucHJvdG9idWYuU3RydWN0LkZpZWxkc0VudHJ5GkUKC0ZpZWxkc0VudHJ5EgsKA2tleRgBIAEoCRIlCgV2YWx1ZRgCIAEoCzIWLmdvb2dsZS5wcm90b2J1Zi5WYWx1ZToCOAEi6gEKBVZhbHVlEjAKCm51bGxfdmFsdWUYASABKA4yGi5nb29nbGUucHJvdG9idWYuTnVsbFZhbHVlSAASFgoMbnVtYmVyX3ZhbHVlGAIgASgBSAASFgoMc3RyaW5nX3ZhbHVlGAMgASgJSAASFAoKYm9vbF92YWx1ZRgEIAEoCEgAEi8KDHN0cnVjdF92YWx1ZRgFIAEoCzIXLmdvb2dsZS5wcm90b2J1Zi5TdHJ1Y3RIABIwCgpsaXN0X3ZhbHVlGAYgASgLMhouZ29vZ2xlLnByb3RvYnVmLkxpc3RWYWx1ZUgAQgYKBGtpbmQiMwoJTGlzdFZhbHVlEiYKBnZhbHVlcxgBIAMoCzIWLmdvb2dsZS5wcm90b2J1Zi5WYWx1ZSobCglOdWxsVmFsdWUSDgoKTlVMTF9WQUxVRRAAQn8KE2NvbS5nb29nbGUucHJvdG9idWZCC1N0cnVjdFByb3RvUAFaL2dvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL3N0cnVjdHBi+AEBogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM"),rw=rd(rI,0),rN=rd(rI,1),rR=rd(rI,2);function rC(e,t){let r=e.typeName,n=Object.assign(Object.assign({},e),{kind:"field",parent:e.extendee,localName:r}),i=Object.assign(Object.assign({},e.extendee),{fields:[n],members:[n],oneofs:[]}),s=e2(i,void 0!==t?{[r]:t}:void 0);return[ty(i,s),n,()=>{let t=s[r];if(void 0===t){let t=e.message;return e0(t)?eM(t.fields[0].scalar,t.fields[0].longAsString):e2(t)}return t}]}function rT(e,t){if(e.extendee.typeName!=t.$typeName)throw Error(`extension ${e.typeName} can only be applied to message ${e.extendee.typeName}`)}(O=eT||(eT={}))[O.NULL_VALUE=0]="NULL_VALUE";let rx={ignoreUnknownFields:!1};function rV(e,t,r){var n;if(function(e,t,r){if(!e.desc.typeName.startsWith("google.protobuf."))return!1;switch(e.desc.typeName){case"google.protobuf.Any":return function(e,t,r){var n,i,s,a,o;if(null===t||Array.isArray(t)||"object"!=typeof t)throw Error(`cannot decode message ${e.$typeName} from JSON: expected object but got ${tg(t)}`);if(0==Object.keys(t).length)return;let l=t["@type"];if("string"!=typeof l||""==l)throw Error(`cannot decode message ${e.$typeName} from JSON: "@type" is empty`);let u=l.includes("/")?l.substring(l.lastIndexOf("/")+1):l;if(!u.length)throw Error(`cannot decode message ${e.$typeName} from JSON: "@type" is invalid`);let d=null==(n=r.registry)?void 0:n.getMessage(u);if(!d)throw Error(`cannot decode message ${e.$typeName} from JSON: ${l} is not in the type registry`);let c=ty(d);if(u.startsWith("google.protobuf.")&&Object.prototype.hasOwnProperty.call(t,"value"))rV(c,t.value,r);else{let e=Object.assign({},t);delete e["@type"],rV(c,e,r)}i=c.desc,s=c.message,(a=e)||(a=e2(rf)),a.value=rp(i,s),a.typeUrl=(o=s.$typeName,`type.googleapis.com/${o}`)}(e.message,t,r),!0;case"google.protobuf.Timestamp":return function(e,t){if("string"!=typeof t)throw Error(`cannot decode message ${e.$typeName} from JSON: ${tg(t)}`);let r=t.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:\.([0-9]{1,9}))?(?:Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw Error(`cannot decode message ${e.$typeName} from JSON: invalid RFC 3339 string`);let n=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(n))throw Error(`cannot decode message ${e.$typeName} from JSON: invalid RFC 3339 string`);if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw Error(`cannot decode message ${e.$typeName} from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive`);e.seconds=eG.parse(n/1e3),e.nanos=0,r[7]&&(e.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9)}(e.message,t),!0;case"google.protobuf.Duration":return function(e,t){if("string"!=typeof t)throw Error(`cannot decode message ${e.$typeName} from JSON: ${tg(t)}`);let r=t.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(null===r)throw Error(`cannot decode message ${e.$typeName} from JSON: ${tg(t)}`);let n=Number(r[1]);if(n>315576e6||n<-315576e6)throw Error(`cannot decode message ${e.$typeName} from JSON: ${tg(t)}`);e.seconds=eG.parse(n),"string"!=typeof r[2]||(e.nanos=parseInt(r[2]+"0".repeat(9-r[2].length)),(n<0||Object.is(n,-0))&&(e.nanos=-e.nanos))}(e.message,t),!0;case"google.protobuf.FieldMask":return function(e,t){if("string"!=typeof t)throw Error(`cannot decode message ${e.$typeName} from JSON: ${tg(t)}`);""!==t&&(e.paths=t.split(",").map(function(t){if(t.includes("_"))throw Error(`cannot decode message ${e.$typeName} from JSON: path names must be lowerCamelCase`);let r=t.replace(/[A-Z]/g,e=>"_"+e.toLowerCase());return"_"===r[0]?r.substring(1):r}))}(e.message,t),!0;case"google.protobuf.Struct":return rZ(e.message,t),!0;case"google.protobuf.Value":return rF(e.message,t),!0;case"google.protobuf.ListValue":return rP(e.message,t),!0;default:if(e0(e.desc)){let r=e.desc.fields[0];return null===t?e.clear(r):e.set(r,rL(r,t,!0)),!0}return!1}}(e,t,r))return;if(null==t||Array.isArray(t)||"object"!=typeof t)throw Error(`cannot decode ${e.desc} from JSON: ${tg(t)}`);let i=new Map,s=new Map;for(let t of e.desc.fields)s.set(t.name,t).set(t.jsonName,t);for(let[a,o]of Object.entries(t)){let t=s.get(a);if(t){if(t.oneof){if(null===o&&"scalar"==t.fieldKind)continue;let e=i.get(t.oneof);if(void 0!==e)throw new tt(t.oneof,`oneof set multiple times by ${e.name} and ${t.name}`);i.set(t.oneof,t)}rD(e,t,o,r)}else{let t;if(a.startsWith("[")&&a.endsWith("]")&&(t=null==(n=r.registry)?void 0:n.getExtension(a.substring(1,a.length-1)))&&t.extendee.typeName===e.desc.typeName){let[n,i,s]=rC(t);rD(n,i,o,r),function(e,t,r){var n;rT(t,e);let i=(null!=(n=e.$unknown)?n:[]).filter(e=>e.no!==t.number),[s,a]=rC(t,r),o=new ti;rb(o,{writeUnknownFields:!0},s,a);let l=new ts(o.finish());for(;l.pos<l.len;){let[e,t]=l.tag(),r=l.skip(t,e);i.push({no:e,wireType:t,data:r})}e.$unknown=i}(e.message,t,s())}if(!t&&!r.ignoreUnknownFields)throw Error(`cannot decode ${e.desc} from JSON: key "${a}" is unknown`)}}}function rD(e,t,r,n){var i,s,a,o,l,u;switch(t.fieldKind){case"scalar":let d;i=e,(d=rL(s=t,r,!1))===rW?i.clear(s):i.set(s,d);break;case"enum":let c;a=e,o=t,l=r,u=n,(c=rB(o.enum,l,u.ignoreUnknownFields,!1))===rW?a.clear(o):c!==rk&&a.set(o,c);break;case"message":!function(e,t,r,n){if(null===r&&"google.protobuf.Value"!=t.message.typeName)return e.clear(t);let i=e.isSet(t)?e.get(t):ty(t.message);rV(i,r,n),e.set(t,i)}(e,t,r,n);break;case"list":!function(e,t,r){if(null===t)return;let n=e.field();if(!Array.isArray(t))throw new tt(n,"expected Array, got "+tg(t));for(let i of t){if(null===i)throw new tt(n,"list item must not be null");switch(n.listKind){case"message":let t=ty(n.message);rV(t,i,r),e.add(t);break;case"enum":let s=rB(n.enum,i,r.ignoreUnknownFields,!0);s!==rk&&e.add(s);break;case"scalar":e.add(rL(n,i,!0))}}}(e.get(t),r,n);break;case"map":!function(e,t,r){if(null===t)return;let n=e.field();if("object"!=typeof t||Array.isArray(t))throw new tt(n,"expected object, got "+tg(t));for(let[i,s]of Object.entries(t)){let t;if(null===s)throw new tt(n,"map value must not be null");switch(n.mapKind){case"message":let a=ty(n.message);rV(a,s,r),t=a;break;case"enum":if((t=rB(n.enum,s,r.ignoreUnknownFields,!0))===rk)return;break;case"scalar":t=rL(n,s,!0)}let o=function(e,t){switch(e){case ea.BOOL:switch(t){case"true":return!0;case"false":return!1}return t;case ea.INT32:case ea.FIXED32:case ea.UINT32:case ea.SFIXED32:case ea.SINT32:return rO(t);default:return t}}(n.mapKey,i);e.set(o,t)}}(e.get(t),r,n)}}let rk=Symbol();function rB(e,t,r,n){if(null===t)return"google.protobuf.NullValue"==e.typeName?0:n?e.values[0].number:rW;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":let i=e.values.find(e=>e.name===t);if(void 0!==i)return i.number;if(r)return rk}throw Error(`cannot decode ${e} from JSON: ${tg(t)}`)}let rW=Symbol();function rL(e,t,r){if(null===t)return r?eM(e.scalar,!1):rW;switch(e.scalar){case ea.DOUBLE:case ea.FLOAT:if("NaN"===t)return NaN;if("Infinity"===t)return 1/0;if("-Infinity"===t)return-1/0;if("number"==typeof t){if(Number.isNaN(t))throw new tt(e,"unexpected NaN number");if(!Number.isFinite(t))throw new tt(e,"unexpected infinite number");break}if("string"==typeof t){if(""===t||t.trim().length!==t.length)break;let e=Number(t);if(!Number.isFinite(e))break;return e}break;case ea.INT32:case ea.FIXED32:case ea.SFIXED32:case ea.SINT32:case ea.UINT32:return rO(t);case ea.BYTES:if("string"==typeof t){if(""===t)return new Uint8Array(0);try{return tq(t)}catch(t){throw new tt(e,t instanceof Error?t.message:String(t))}}}return t}function rO(e){if("string"==typeof e){if(""===e||e.trim().length!==e.length)return e;let t=Number(e);return Number.isNaN(t)?e:t}return e}function rZ(e,t){if("object"!=typeof t||null==t||Array.isArray(t))throw Error(`cannot decode message ${e.$typeName} from JSON ${tg(t)}`);for(let[r,n]of Object.entries(t)){let t=e2(rN);rF(t,n),e.fields[r]=t}}function rF(e,t){switch(typeof t){case"number":e.kind={case:"numberValue",value:t};break;case"string":e.kind={case:"stringValue",value:t};break;case"boolean":e.kind={case:"boolValue",value:t};break;case"object":if(null===t)e.kind={case:"nullValue",value:eT.NULL_VALUE};else if(Array.isArray(t)){let r=e2(rR);rP(r,t),e.kind={case:"listValue",value:r}}else{let r=e2(rw);rZ(r,t),e.kind={case:"structValue",value:r}}break;default:throw Error(`cannot decode message ${e.$typeName} from JSON ${tg(t)}`)}return e}function rP(e,t){if(!Array.isArray(t))throw Error(`cannot decode message ${e.$typeName} from JSON ${tg(t)}`);for(let r of t){let t=e2(rN);rF(t,r),e.values.push(t)}}let rU={alwaysEmitImplicit:!1,enumAsInteger:!1,useProtoFieldName:!1};function rG(e,t){var r,n;let i=function(e,t){if(e.desc.typeName.startsWith("google.protobuf."))switch(e.desc.typeName){case"google.protobuf.Any":return function(e,t){let r,n;if(""===e.typeUrl)return{};let{registry:i}=t;if(i&&(r=function(e,t){var r,n;if(""===e.typeUrl)return;let i="message"==t.kind?t:t.getMessage(rE(e.typeUrl));if(i&&(r=e,n=i,""!==r.typeUrl&&("string"==typeof n?n:n.typeName)===rE(r.typeUrl)))return tB(i,e.value)}(e,i))&&(n=i.getMessage(r.$typeName)),!n||!r)throw Error(`cannot encode message ${e.$typeName} to JSON: "${e.typeUrl}" is not in the type registry`);let s=rG(ty(n,r),t);return(n.typeName.startsWith("google.protobuf.")||null===s||Array.isArray(s)||"object"!=typeof s)&&(s={value:s}),s["@type"]=e.typeUrl,s}(e.message,t);case"google.protobuf.Timestamp":return function(e){let t=1e3*Number(e.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw Error(`cannot encode message ${e.$typeName} to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive`);if(e.nanos<0)throw Error(`cannot encode message ${e.$typeName} to JSON: nanos must not be negative`);if(e.nanos>0x3b9ac9ff)throw Error(`cannot encode message ${e.$typeName} to JSON: nanos must not be greater than 99999999`);let r="Z";if(e.nanos>0){let t=(e.nanos+1e9).toString().substring(1);r="000000"===t.substring(3)?"."+t.substring(0,3)+"Z":"000"===t.substring(6)?"."+t.substring(0,6)+"Z":"."+t+"Z"}return new Date(t).toISOString().replace(".000Z",r)}(e.message);case"google.protobuf.Duration":return function(e){let t=Number(e.seconds),r=e.nanos;if(t>315576e6||t<-315576e6)throw Error(`cannot encode message ${e.$typeName} to JSON: value out of range`);if(t>0&&r<0||t<0&&r>0)throw Error(`cannot encode message ${e.$typeName} to JSON: nanos sign must match seconds sign`);let n=e.seconds.toString();if(0!==r){let e=Math.abs(r).toString();"000000"===(e="0".repeat(9-e.length)+e).substring(3)?e=e.substring(0,3):"000"===e.substring(6)&&(e=e.substring(0,6)),n+="."+e,r<0&&0==t&&(n="-"+n)}return n+"s"}(e.message);case"google.protobuf.FieldMask":var r;return(r=e.message).paths.map(e=>{if(e.match(/_[0-9]?_/g)||e.match(/[A-Z]/g))throw Error(`cannot encode message ${r.$typeName} to JSON: lowerCamelCase of path name "`+e+'" is irreversible');return t1(e)}).join(",");case"google.protobuf.Struct":return r_(e.message);case"google.protobuf.Value":return rX(e.message);case"google.protobuf.ListValue":return rJ(e.message);default:if(e0(e.desc)){let t=e.desc.fields[0];return rM(t,e.get(t))}return}}(e,t);if(void 0!==i)return i;let s={};for(let r of e.sortedFields){if(!e.isSet(r)){if(3==r.presence)throw Error(`cannot encode ${r} to JSON: required field not set`);if(!t.alwaysEmitImplicit||2!==r.presence)continue}let i=rY(r,e.get(r),t);void 0!==i&&(s[n=r,t.useProtoFieldName?n.name:n.jsonName]=i)}if(t.registry){let n=new Set;for(let{no:i}of null!=(r=e.getUnknown())?r:[])if(!n.has(i)){n.add(i);let r=t.registry.getExtensionFor(e.desc,i);if(!r)continue;let a=function(e,t){rT(t,e);let r=function(e,t){if(void 0===e)return[];if("enum"===t.fieldKind||"scalar"===t.fieldKind){for(let r=e.length-1;r>=0;--r)if(e[r].no==t.number)return[e[r]];return[]}return e.filter(e=>e.no===t.number)}(e.$unknown,t),[n,i,s]=rC(t);for(let e of r)tL(n,new ts(e.data),i,e.wireType,{readUnknownFields:!0});return s()}(e.message,r),[o,l]=rC(r,a),u=rY(l,o.get(l),t);void 0!==u&&(s[r.jsonName]=u)}}return s}function rY(e,t,r){switch(e.fieldKind){case"scalar":return rM(e,t);case"message":return rG(t,r);case"enum":return rK(e.enum,t,r.enumAsInteger);case"list":var n=t,i=r;let s=n.field(),a=[];switch(s.listKind){case"scalar":for(let e of n)a.push(rM(s,e));break;case"enum":for(let e of n)a.push(rK(s.enum,e,i.enumAsInteger));break;case"message":for(let e of n)a.push(rG(e,i))}return i.alwaysEmitImplicit||a.length>0?a:void 0;case"map":var o=t,l=r;let u=o.field(),d={};switch(u.mapKind){case"scalar":for(let[e,t]of o)d[e]=rM(u,t);break;case"message":for(let[e,t]of o)d[e]=rG(t,l);break;case"enum":for(let[e,t]of o)d[e]=rK(u.enum,t,l.enumAsInteger)}return l.alwaysEmitImplicit||o.size>0?d:void 0}}function rK(e,t,r){var n;if("number"!=typeof t)throw Error(`cannot encode ${e} to JSON: expected number, got ${tg(t)}`);if("google.protobuf.NullValue"==e.typeName)return null;if(r)return t;let i=e.value[t];return null!=(n=null==i?void 0:i.name)?n:t}function rM(e,t){var r,n,i,s,a,o;switch(e.scalar){case ea.INT32:case ea.SFIXED32:case ea.SINT32:case ea.FIXED32:case ea.UINT32:if("number"!=typeof t)throw Error(`cannot encode ${e} to JSON: ${null==(r=tl(e,t))?void 0:r.message}`);return t;case ea.FLOAT:case ea.DOUBLE:if("number"!=typeof t)throw Error(`cannot encode ${e} to JSON: ${null==(n=tl(e,t))?void 0:n.message}`);if(Number.isNaN(t))return"NaN";if(t===1/0)return"Infinity";if(t===-1/0)return"-Infinity";return t;case ea.STRING:if("string"!=typeof t)throw Error(`cannot encode ${e} to JSON: ${null==(i=tl(e,t))?void 0:i.message}`);return t;case ea.BOOL:if("boolean"!=typeof t)throw Error(`cannot encode ${e} to JSON: ${null==(s=tl(e,t))?void 0:s.message}`);return t;case ea.UINT64:case ea.FIXED64:case ea.INT64:case ea.SFIXED64:case ea.SINT64:if("bigint"!=typeof t&&"string"!=typeof t)throw Error(`cannot encode ${e} to JSON: ${null==(a=tl(e,t))?void 0:a.message}`);return t.toString();case ea.BYTES:if(t instanceof Uint8Array)return function(e,t="std"){let r=t0(t),n="std"==t,i="",s=0,a,o=0;for(let t=0;t<e.length;t++)switch(a=e[t],s){case 0:i+=r[a>>2],o=(3&a)<<4,s=1;break;case 1:i+=r[o|a>>4],o=(15&a)<<2,s=2;break;case 2:i+=r[o|a>>6],i+=r[63&a],s=0}return s&&(i+=r[o],n&&(i+="=",1==s&&(i+="="))),i}(t);throw Error(`cannot encode ${e} to JSON: ${null==(o=tl(e,t))?void 0:o.message}`)}}function r_(e){let t={};for(let[r,n]of Object.entries(e.fields))t[r]=rX(n);return t}function rX(e){switch(e.kind.case){case"nullValue":return null;case"numberValue":if(!Number.isFinite(e.kind.value))throw Error(`${e.$typeName} cannot be NaN or Infinity`);return e.kind.value;case"boolValue":case"stringValue":return e.kind.value;case"structValue":return r_(e.kind.value);case"listValue":return rJ(e.kind.value);default:throw Error(`${e.$typeName} must have a value`)}}function rJ(e){return e.values.map(rX)}function rz(e,t,r,n){let i=t?r$(e.input,n):rj(e.input,r);return{parse:(t?r$(e.output,n):rj(e.output,r)).parse,serialize:i.serialize}}function r$(e,t){return{parse(r){try{return tB(e,r,t)}catch(t){let e=t instanceof Error?t.message:String(t);throw new tP(`parse binary: ${e}`,es.Internal)}},serialize(r){try{return rp(e,r,t)}catch(t){let e=t instanceof Error?t.message:String(t);throw new tP(`serialize binary: ${e}`,es.Internal)}}}}function rj(e,t){var r,n;let i,s=null!=(r=null==t?void 0:t.textEncoder)?r:new TextEncoder,a=null!=(n=null==t?void 0:t.textDecoder)?n:new TextDecoder,o=(null!=(i=Object.assign({},t)).ignoreUnknownFields||(i.ignoreUnknownFields=!0),i);return{parse(t){try{let r=a.decode(t);return function(e,t,r){let n=ty(e);try{rV(n,t,r?Object.assign(Object.assign({},rx),r):rx)}catch(e){if(e instanceof Error&&te.includes(e.name)&&"field"in e&&"function"==typeof e.field)throw Error(`cannot decode ${e.field()} from JSON: ${e.message}`,{cause:e});throw e}return n.message}(e,function(e,t){try{return JSON.parse(e)}catch(r){let e=r instanceof Error?r.message:String(r);throw Error(`cannot decode message ${t} from JSON: ${e}`,{cause:r})}}(r,e.typeName),o)}catch(e){throw tP.from(e,es.InvalidArgument)}},serialize(t){try{var r;let n=JSON.stringify(rG(ty(e,t),o?Object.assign(Object.assign({},rU),o):rU),null,null!=(r=null==o?void 0:o.prettySpaces)?r:0);return s.encode(n)}catch(e){throw tP.from(e,es.Internal)}}}}function rQ(e,t){return e.toString().replace(/\/?$/,`/${t.parent.typeName}/${t.name}`)}function rH(e,t){if(!t)return e;for(let r of t.concat().reverse())e=r(e);return e}function rq(e){if(!e.aborted)return;if(void 0!==e.reason)return e.reason;let t=Error("This operation was aborted");return t.name="AbortError",t}function r0(e){var t;let r,n,i,{signal:s,cleanup:a}=(t=e.timeoutMs,n=new AbortController,i=()=>{n.abort(new tP("the operation timed out",es.DeadlineExceeded))},void 0!==t&&(t<=0?i():r=setTimeout(i,t)),{signal:n.signal,cleanup:()=>clearTimeout(r)}),o=function(...e){let t=new AbortController,r=e.filter(e=>void 0!==e).concat(t.signal);for(let e of r){if(e.aborted){n.apply(e);break}e.addEventListener("abort",n)}function n(){for(let e of(t.signal.aborted||t.abort(rq(this)),r))e.removeEventListener("abort",n)}return t}(e.signal,s);return[o.signal,function(e){let t=tP.from(s.aborted?rq(s):e);return o.abort(t),a(),Promise.reject(t)},function(){a(),o.abort()}]}let r1="Grpc-Status",r2="Grpc-Message",r3="User-Agent",r5="X-User-Agent";function r9(e,t,r,n){var i,s;let a=new Headers(null!=r?r:{});a.set("Content-Type",e?"application/grpc-web+proto":"application/grpc-web+json"),a.set("X-Grpc-Web","1");let o=null!=(s=null!=(i=a.get(r3))?i:a.get(r5))?s:"connect-es/2.1.1";return a.set(r5,o),n&&a.set(r3,o),void 0!==t&&a.set("Grpc-Timeout",`${t}m`),a}function r4(e){let t=new Headers;for(let r of new TextDecoder().decode(e).split("\r\n")){if(""===r)continue;let e=r.indexOf(":");if(e>0){let n=r.substring(0,e).trim(),i=r.substring(e+1).trim();t.append(n,i)}}return t}let r6=rd(rh("CgxzdGF0dXMucHJvdG8SCmdvb2dsZS5ycGMiTgoGU3RhdHVzEgwKBGNvZGUYASABKAUSDwoHbWVzc2FnZRgCIAEoCRIlCgdkZXRhaWxzGAMgAygLMhQuZ29vZ2xlLnByb3RvYnVmLkFueUJeCg5jb20uZ29vZ2xlLnJwY0ILU3RhdHVzUHJvdG9QAVo3Z29vZ2xlLmdvbGFuZy5vcmcvZ2VucHJvdG8vZ29vZ2xlYXBpcy9ycGMvc3RhdHVzO3N0YXR1c6ICA1JQQ2IGcHJvdG8z",[rg]),0);function r8(e){var t;let r=e.get("Grpc-Status-Details-Bin");if(null!=r){let t=function(e,t,r){try{let r=tq(e);if(t)return tB(t,r,void 0);return r}catch(e){throw tP.from(e,es.DataLoss)}}(r,r6);if(0==t.code)return;let n=new tP(t.message,t.code,e);return n.details=t.details.map(e=>({type:e.typeUrl.substring(e.typeUrl.lastIndexOf("/")+1),value:e.value})),n}let n=e.get(r1);if(null!=n){if("0"===n)return;let r=parseInt(n,10);return r in es?new tP(decodeURIComponent(null!=(t=e.get(r2))?t:""),r,e):new tP(`invalid grpc-status: ${n}`,es.Internal,e)}}function r7(e,t){var r;if(e>=200&&e<300)return{foundStatus:t.has(r1),headerError:r8(t)};throw new tP(decodeURIComponent(null!=(r=t.get(r2))?r:`HTTP ${e}`),function(e){switch(e){case 400:return es.Internal;case 401:return es.Unauthenticated;case 403:return es.PermissionDenied;case 404:return es.Unimplemented;case 429:case 502:case 503:case 504:return es.Unavailable;default:return es.Unknown}}(e),t)}function ne(e,t){let r=r8(e);if(r)throw t.forEach((e,t)=>{r.metadata.append(t,e)}),r;if(!t.has(r1)&&!e.has(r1))throw new tP("protocol error: missing status",es.Internal)}var nt=function(e){return this instanceof nt?(this.v=e,this):new nt(e)},nr=function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),n[Symbol.asyncIterator]=function(){return this},n;function a(e,t){i[e]&&(n[e]=function(t){return new Promise(function(r,n){s.push([e,t,r,n])>1||o(e,t)})},t&&(n[e]=t(n[e])))}function o(e,t){try{var r;(r=i[e](t)).value instanceof nt?Promise.resolve(r.value.v).then(l,u):d(s[0][2],r)}catch(e){d(s[0][3],e)}}function l(e){o("next",e)}function u(e){o("throw",e)}function d(e,t){e(t),s.shift(),s.length&&o(s[0][0],s[0][1])}};let nn={redirect:"error"},ni=rh("Ch9nb29nbGUvcHJvdG9idWYvdGltZXN0YW1wLnByb3RvEg9nb29nbGUucHJvdG9idWYiKwoJVGltZXN0YW1wEg8KB3NlY29uZHMYASABKAMSDQoFbmFub3MYAiABKAVChQEKE2NvbS5nb29nbGUucHJvdG9idWZCDlRpbWVzdGFtcFByb3RvUAFaMmdvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL3RpbWVzdGFtcHBi+AEBogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM"),ns=rh("Ch5nb29nbGUvcHJvdG9idWYvd3JhcHBlcnMucHJvdG8SD2dvb2dsZS5wcm90b2J1ZiIcCgtEb3VibGVWYWx1ZRINCgV2YWx1ZRgBIAEoASIbCgpGbG9hdFZhbHVlEg0KBXZhbHVlGAEgASgCIhsKCkludDY0VmFsdWUSDQoFdmFsdWUYASABKAMiHAoLVUludDY0VmFsdWUSDQoFdmFsdWUYASABKAQiGwoKSW50MzJWYWx1ZRINCgV2YWx1ZRgBIAEoBSIcCgtVSW50MzJWYWx1ZRINCgV2YWx1ZRgBIAEoDSIaCglCb29sVmFsdWUSDQoFdmFsdWUYASABKAgiHAoLU3RyaW5nVmFsdWUSDQoFdmFsdWUYASABKAkiGwoKQnl0ZXNWYWx1ZRINCgV2YWx1ZRgBIAEoDEKDAQoTY29tLmdvb2dsZS5wcm90b2J1ZkINV3JhcHBlcnNQcm90b1ABWjFnb29nbGUuZ29sYW5nLm9yZy9wcm90b2J1Zi90eXBlcy9rbm93bi93cmFwcGVyc3Bi+AEBogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM"),na=rh("CiFzcmMvYXBpL3lvcmtpZS92MS9yZXNvdXJjZXMucHJvdG8SCXlvcmtpZS52MSKuAQoIU25hcHNob3QSJAoEcm9vdBgBIAEoCzIWLnlvcmtpZS52MS5KU09ORWxlbWVudBI1CglwcmVzZW5jZXMYAiADKAsyIi55b3JraWUudjEuU25hcHNob3QuUHJlc2VuY2VzRW50cnkaRQoOUHJlc2VuY2VzRW50cnkSCwoDa2V5GAEgASgJEiIKBXZhbHVlGAIgASgLMhMueW9ya2llLnYxLlByZXNlbmNlOgI4ASL7AQoKQ2hhbmdlUGFjaxIUCgxkb2N1bWVudF9rZXkYASABKAkSKQoKY2hlY2twb2ludBgCIAEoCzIVLnlvcmtpZS52MS5DaGVja3BvaW50EhAKCHNuYXBzaG90GAMgASgMEiIKB2NoYW5nZXMYBCADKAsyES55b3JraWUudjEuQ2hhbmdlEjAKEW1pbl9zeW5jZWRfdGlja2V0GAUgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSEgoKaXNfcmVtb3ZlZBgGIAEoCBIwCg52ZXJzaW9uX3ZlY3RvchgHIAEoCzIYLnlvcmtpZS52MS5WZXJzaW9uVmVjdG9yIpgBCgZDaGFuZ2USHwoCaWQYASABKAsyEy55b3JraWUudjEuQ2hhbmdlSUQSDwoHbWVzc2FnZRgCIAEoCRIoCgpvcGVyYXRpb25zGAMgAygLMhQueW9ya2llLnYxLk9wZXJhdGlvbhIyCg9wcmVzZW5jZV9jaGFuZ2UYBCABKAsyGS55b3JraWUudjEuUHJlc2VuY2VDaGFuZ2UihwEKCENoYW5nZUlEEhIKCmNsaWVudF9zZXEYASABKA0SEgoKc2VydmVyX3NlcRgCIAEoAxIPCgdsYW1wb3J0GAMgASgDEhAKCGFjdG9yX2lkGAQgASgMEjAKDnZlcnNpb25fdmVjdG9yGAUgASgLMhgueW9ya2llLnYxLlZlcnNpb25WZWN0b3IidAoNVmVyc2lvblZlY3RvchI0CgZ2ZWN0b3IYASADKAsyJC55b3JraWUudjEuVmVyc2lvblZlY3Rvci5WZWN0b3JFbnRyeRotCgtWZWN0b3JFbnRyeRILCgNrZXkYASABKAkSDQoFdmFsdWUYAiABKAM6AjgBIsoaCglPcGVyYXRpb24SJwoDc2V0GAEgASgLMhgueW9ya2llLnYxLk9wZXJhdGlvbi5TZXRIABInCgNhZGQYAiABKAsyGC55b3JraWUudjEuT3BlcmF0aW9uLkFkZEgAEikKBG1vdmUYAyABKAsyGS55b3JraWUudjEuT3BlcmF0aW9uLk1vdmVIABItCgZyZW1vdmUYBCABKAsyGy55b3JraWUudjEuT3BlcmF0aW9uLlJlbW92ZUgAEikKBGVkaXQYBSABKAsyGS55b3JraWUudjEuT3BlcmF0aW9uLkVkaXRIABIrCgVzdHlsZRgHIAEoCzIaLnlvcmtpZS52MS5PcGVyYXRpb24uU3R5bGVIABIxCghpbmNyZWFzZRgIIAEoCzIdLnlvcmtpZS52MS5PcGVyYXRpb24uSW5jcmVhc2VIABIyCgl0cmVlX2VkaXQYCSABKAsyHS55b3JraWUudjEuT3BlcmF0aW9uLlRyZWVFZGl0SAASNAoKdHJlZV9zdHlsZRgKIAEoCzIeLnlvcmtpZS52MS5PcGVyYXRpb24uVHJlZVN0eWxlSAASMgoJYXJyYXlfc2V0GAsgASgLMh0ueW9ya2llLnYxLk9wZXJhdGlvbi5BcnJheVNldEgAGp0BCgNTZXQSMAoRcGFyZW50X2NyZWF0ZWRfYXQYASABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBILCgNrZXkYAiABKAkSKwoFdmFsdWUYAyABKAsyHC55b3JraWUudjEuSlNPTkVsZW1lbnRTaW1wbGUSKgoLZXhlY3V0ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBrAAQoDQWRkEjAKEXBhcmVudF9jcmVhdGVkX2F0GAEgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSLgoPcHJldl9jcmVhdGVkX2F0GAIgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSKwoFdmFsdWUYAyABKAsyHC55b3JraWUudjEuSlNPTkVsZW1lbnRTaW1wbGUSKgoLZXhlY3V0ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBq/AQoETW92ZRIwChFwYXJlbnRfY3JlYXRlZF9hdBgBIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0Ei4KD3ByZXZfY3JlYXRlZF9hdBgCIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EikKCmNyZWF0ZWRfYXQYAyABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIqCgtleGVjdXRlZF9hdBgEIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0GpEBCgZSZW1vdmUSMAoRcGFyZW50X2NyZWF0ZWRfYXQYASABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIpCgpjcmVhdGVkX2F0GAIgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSKgoLZXhlY3V0ZWRfYXQYAyABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBrZAwoERWRpdBIwChFwYXJlbnRfY3JlYXRlZF9hdBgBIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EiQKBGZyb20YAiABKAsyFi55b3JraWUudjEuVGV4dE5vZGVQb3MSIgoCdG8YAyABKAsyFi55b3JraWUudjEuVGV4dE5vZGVQb3MSUwoXY3JlYXRlZF9hdF9tYXBfYnlfYWN0b3IYBCADKAsyMi55b3JraWUudjEuT3BlcmF0aW9uLkVkaXQuQ3JlYXRlZEF0TWFwQnlBY3RvckVudHJ5Eg8KB2NvbnRlbnQYBSABKAkSKgoLZXhlY3V0ZWRfYXQYBiABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBI9CgphdHRyaWJ1dGVzGAcgAygLMikueW9ya2llLnYxLk9wZXJhdGlvbi5FZGl0LkF0dHJpYnV0ZXNFbnRyeRpRChhDcmVhdGVkQXRNYXBCeUFjdG9yRW50cnkSCwoDa2V5GAEgASgJEiQKBXZhbHVlGAIgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQ6AjgBGjEKD0F0dHJpYnV0ZXNFbnRyeRILCgNrZXkYASABKAkSDQoFdmFsdWUYAiABKAk6AjgBGukDCgVTdHlsZRIwChFwYXJlbnRfY3JlYXRlZF9hdBgBIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EiQKBGZyb20YAiABKAsyFi55b3JraWUudjEuVGV4dE5vZGVQb3MSIgoCdG8YAyABKAsyFi55b3JraWUudjEuVGV4dE5vZGVQb3MSPgoKYXR0cmlidXRlcxgEIAMoCzIqLnlvcmtpZS52MS5PcGVyYXRpb24uU3R5bGUuQXR0cmlidXRlc0VudHJ5EioKC2V4ZWN1dGVkX2F0GAUgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSVAoXY3JlYXRlZF9hdF9tYXBfYnlfYWN0b3IYBiADKAsyMy55b3JraWUudjEuT3BlcmF0aW9uLlN0eWxlLkNyZWF0ZWRBdE1hcEJ5QWN0b3JFbnRyeRIcChRhdHRyaWJ1dGVzX3RvX3JlbW92ZRgHIAMoCRoxCg9BdHRyaWJ1dGVzRW50cnkSCwoDa2V5GAEgASgJEg0KBXZhbHVlGAIgASgJOgI4ARpRChhDcmVhdGVkQXRNYXBCeUFjdG9yRW50cnkSCwoDa2V5GAEgASgJEiQKBXZhbHVlGAIgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQ6AjgBGpUBCghJbmNyZWFzZRIwChFwYXJlbnRfY3JlYXRlZF9hdBgBIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EisKBXZhbHVlGAIgASgLMhwueW9ya2llLnYxLkpTT05FbGVtZW50U2ltcGxlEioKC2V4ZWN1dGVkX2F0GAMgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQakwMKCFRyZWVFZGl0EjAKEXBhcmVudF9jcmVhdGVkX2F0GAEgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSIAoEZnJvbRgCIAEoCzISLnlvcmtpZS52MS5UcmVlUG9zEh4KAnRvGAMgASgLMhIueW9ya2llLnYxLlRyZWVQb3MSVwoXY3JlYXRlZF9hdF9tYXBfYnlfYWN0b3IYBCADKAsyNi55b3JraWUudjEuT3BlcmF0aW9uLlRyZWVFZGl0LkNyZWF0ZWRBdE1hcEJ5QWN0b3JFbnRyeRImCghjb250ZW50cxgFIAMoCzIULnlvcmtpZS52MS5UcmVlTm9kZXMSEwoLc3BsaXRfbGV2ZWwYByABKAUSKgoLZXhlY3V0ZWRfYXQYBiABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBpRChhDcmVhdGVkQXRNYXBCeUFjdG9yRW50cnkSCwoDa2V5GAEgASgJEiQKBXZhbHVlGAIgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQ6AjgBGu0DCglUcmVlU3R5bGUSMAoRcGFyZW50X2NyZWF0ZWRfYXQYASABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIgCgRmcm9tGAIgASgLMhIueW9ya2llLnYxLlRyZWVQb3MSHgoCdG8YAyABKAsyEi55b3JraWUudjEuVHJlZVBvcxJCCgphdHRyaWJ1dGVzGAQgAygLMi4ueW9ya2llLnYxLk9wZXJhdGlvbi5UcmVlU3R5bGUuQXR0cmlidXRlc0VudHJ5EioKC2V4ZWN1dGVkX2F0GAUgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSHAoUYXR0cmlidXRlc190b19yZW1vdmUYBiADKAkSWAoXY3JlYXRlZF9hdF9tYXBfYnlfYWN0b3IYByADKAsyNy55b3JraWUudjEuT3BlcmF0aW9uLlRyZWVTdHlsZS5DcmVhdGVkQXRNYXBCeUFjdG9yRW50cnkaMQoPQXR0cmlidXRlc0VudHJ5EgsKA2tleRgBIAEoCRINCgV2YWx1ZRgCIAEoCToCOAEaUQoYQ3JlYXRlZEF0TWFwQnlBY3RvckVudHJ5EgsKA2tleRgBIAEoCRIkCgV2YWx1ZRgCIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0OgI4ARrAAQoIQXJyYXlTZXQSMAoRcGFyZW50X2NyZWF0ZWRfYXQYASABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIpCgpjcmVhdGVkX2F0GAIgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSKwoFdmFsdWUYAyABKAsyHC55b3JraWUudjEuSlNPTkVsZW1lbnRTaW1wbGUSKgoLZXhlY3V0ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldEIGCgRib2R5IsUBChFKU09ORWxlbWVudFNpbXBsZRIpCgpjcmVhdGVkX2F0GAEgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSJwoIbW92ZWRfYXQYAiABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIpCgpyZW1vdmVkX2F0GAMgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSIgoEdHlwZRgEIAEoDjIULnlvcmtpZS52MS5WYWx1ZVR5cGUSDQoFdmFsdWUYBSABKAwiggsKC0pTT05FbGVtZW50EjgKC2pzb25fb2JqZWN0GAEgASgLMiEueW9ya2llLnYxLkpTT05FbGVtZW50LkpTT05PYmplY3RIABI2Cgpqc29uX2FycmF5GAIgASgLMiAueW9ya2llLnYxLkpTT05FbGVtZW50LkpTT05BcnJheUgAEjUKCXByaW1pdGl2ZRgDIAEoCzIgLnlvcmtpZS52MS5KU09ORWxlbWVudC5QcmltaXRpdmVIABIrCgR0ZXh0GAUgASgLMhsueW9ya2llLnYxLkpTT05FbGVtZW50LlRleHRIABIxCgdjb3VudGVyGAYgASgLMh4ueW9ya2llLnYxLkpTT05FbGVtZW50LkNvdW50ZXJIABIrCgR0cmVlGAcgASgLMhsueW9ya2llLnYxLkpTT05FbGVtZW50LlRyZWVIABquAQoKSlNPTk9iamVjdBIhCgVub2RlcxgBIAMoCzISLnlvcmtpZS52MS5SSFROb2RlEikKCmNyZWF0ZWRfYXQYAiABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBInCghtb3ZlZF9hdBgDIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EikKCnJlbW92ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBqtAQoJSlNPTkFycmF5EiEKBW5vZGVzGAEgAygLMhIueW9ya2llLnYxLlJHQU5vZGUSKQoKY3JlYXRlZF9hdBgCIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EicKCG1vdmVkX2F0GAMgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSKQoKcmVtb3ZlZF9hdBgEIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0Gr0BCglQcmltaXRpdmUSIgoEdHlwZRgBIAEoDjIULnlvcmtpZS52MS5WYWx1ZVR5cGUSDQoFdmFsdWUYAiABKAwSKQoKY3JlYXRlZF9hdBgDIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EicKCG1vdmVkX2F0GAQgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSKQoKcmVtb3ZlZF9hdBgFIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0GqkBCgRUZXh0EiIKBW5vZGVzGAEgAygLMhMueW9ya2llLnYxLlRleHROb2RlEikKCmNyZWF0ZWRfYXQYAiABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBInCghtb3ZlZF9hdBgDIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EikKCnJlbW92ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBq7AQoHQ291bnRlchIiCgR0eXBlGAEgASgOMhQueW9ya2llLnYxLlZhbHVlVHlwZRINCgV2YWx1ZRgCIAEoDBIpCgpjcmVhdGVkX2F0GAMgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSJwoIbW92ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIpCgpyZW1vdmVkX2F0GAUgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQaqQEKBFRyZWUSIgoFbm9kZXMYASADKAsyEy55b3JraWUudjEuVHJlZU5vZGUSKQoKY3JlYXRlZF9hdBgCIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0EicKCG1vdmVkX2F0GAMgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSKQoKcmVtb3ZlZF9hdBgEIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0QgYKBGJvZHkiPwoHUkhUTm9kZRILCgNrZXkYASABKAkSJwoHZWxlbWVudBgCIAEoCzIWLnlvcmtpZS52MS5KU09ORWxlbWVudCJUCgdSR0FOb2RlEiAKBG5leHQYASABKAsyEi55b3JraWUudjEuUkdBTm9kZRInCgdlbGVtZW50GAIgASgLMhYueW9ya2llLnYxLkpTT05FbGVtZW50IlgKCE5vZGVBdHRyEg0KBXZhbHVlGAEgASgJEikKCnVwZGF0ZWRfYXQYAiABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBISCgppc19yZW1vdmVkGAMgASgIIpQCCghUZXh0Tm9kZRIhCgJpZBgBIAEoCzIVLnlvcmtpZS52MS5UZXh0Tm9kZUlEEg0KBXZhbHVlGAIgASgJEikKCnJlbW92ZWRfYXQYAyABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIqCgtpbnNfcHJldl9pZBgEIAEoCzIVLnlvcmtpZS52MS5UZXh0Tm9kZUlEEjcKCmF0dHJpYnV0ZXMYBSADKAsyIy55b3JraWUudjEuVGV4dE5vZGUuQXR0cmlidXRlc0VudHJ5GkYKD0F0dHJpYnV0ZXNFbnRyeRILCgNrZXkYASABKAkSIgoFdmFsdWUYAiABKAsyEy55b3JraWUudjEuTm9kZUF0dHI6AjgBIkcKClRleHROb2RlSUQSKQoKY3JlYXRlZF9hdBgBIAEoCzIVLnlvcmtpZS52MS5UaW1lVGlja2V0Eg4KBm9mZnNldBgCIAEoBSLdAgoIVHJlZU5vZGUSIQoCaWQYASABKAsyFS55b3JraWUudjEuVHJlZU5vZGVJRBIMCgR0eXBlGAIgASgJEg0KBXZhbHVlGAMgASgJEikKCnJlbW92ZWRfYXQYBCABKAsyFS55b3JraWUudjEuVGltZVRpY2tldBIqCgtpbnNfcHJldl9pZBgFIAEoCzIVLnlvcmtpZS52MS5UcmVlTm9kZUlEEioKC2luc19uZXh0X2lkGAYgASgLMhUueW9ya2llLnYxLlRyZWVOb2RlSUQSDQoFZGVwdGgYByABKAUSNwoKYXR0cmlidXRlcxgIIAMoCzIjLnlvcmtpZS52MS5UcmVlTm9kZS5BdHRyaWJ1dGVzRW50cnkaRgoPQXR0cmlidXRlc0VudHJ5EgsKA2tleRgBIAEoCRIiCgV2YWx1ZRgCIAEoCzITLnlvcmtpZS52MS5Ob2RlQXR0cjoCOAEiMQoJVHJlZU5vZGVzEiQKB2NvbnRlbnQYASADKAsyEy55b3JraWUudjEuVHJlZU5vZGUiRwoKVHJlZU5vZGVJRBIpCgpjcmVhdGVkX2F0GAEgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSDgoGb2Zmc2V0GAIgASgFImMKB1RyZWVQb3MSKAoJcGFyZW50X2lkGAEgASgLMhUueW9ya2llLnYxLlRyZWVOb2RlSUQSLgoPbGVmdF9zaWJsaW5nX2lkGAIgASgLMhUueW9ya2llLnYxLlRyZWVOb2RlSUQiawoEVXNlchIKCgJpZBgBIAEoCRIVCg1hdXRoX3Byb3ZpZGVyGAIgASgJEhAKCHVzZXJuYW1lGAMgASgJEi4KCmNyZWF0ZWRfYXQYBCABKAsyGi5nb29nbGUucHJvdG9idWYuVGltZXN0YW1wIokBCgZNZW1iZXISCgoCaWQYASABKAkSEgoKcHJvamVjdF9pZBgCIAEoCRIPCgd1c2VyX2lkGAMgASgJEhAKCHVzZXJuYW1lGAQgASgJEgwKBHJvbGUYBSABKAkSLgoKaW52aXRlZF9hdBgGIAEoCzIaLmdvb2dsZS5wcm90b2J1Zi5UaW1lc3RhbXAi6QYKB1Byb2plY3QSCgoCaWQYASABKAkSDAoEbmFtZRgCIAEoCRISCgpwdWJsaWNfa2V5GAMgASgJEhIKCnNlY3JldF9rZXkYBCABKAkSGAoQYXV0aF93ZWJob29rX3VybBgFIAEoCRIcChRhdXRoX3dlYmhvb2tfbWV0aG9kcxgGIAMoCRIgChhhdXRoX3dlYmhvb2tfbWF4X3JldHJpZXMYESABKAQSJgoeYXV0aF93ZWJob29rX21pbl93YWl0X2ludGVydmFsGBIgASgJEiYKHmF1dGhfd2ViaG9va19tYXhfd2FpdF9pbnRlcnZhbBgTIAEoCRIkChxhdXRoX3dlYmhvb2tfcmVxdWVzdF90aW1lb3V0GBQgASgJEhkKEWV2ZW50X3dlYmhvb2tfdXJsGAcgASgJEhwKFGV2ZW50X3dlYmhvb2tfZXZlbnRzGAggAygJEiEKGWV2ZW50X3dlYmhvb2tfbWF4X3JldHJpZXMYFSABKAQSJwofZXZlbnRfd2ViaG9va19taW5fd2FpdF9pbnRlcnZhbBgWIAEoCRInCh9ldmVudF93ZWJob29rX21heF93YWl0X2ludGVydmFsGBcgASgJEiUKHWV2ZW50X3dlYmhvb2tfcmVxdWVzdF90aW1lb3V0GBggASgJEiMKG2NsaWVudF9kZWFjdGl2YXRlX3RocmVzaG9sZBgJIAEoCRIaChJzbmFwc2hvdF90aHJlc2hvbGQYGSABKAMSGQoRc25hcHNob3RfaW50ZXJ2YWwYGiABKAMSJAocbWF4X3N1YnNjcmliZXJzX3Blcl9kb2N1bWVudBgKIAEoBRIkChxtYXhfYXR0YWNobWVudHNfcGVyX2RvY3VtZW50GAsgASgFEh0KFW1heF9zaXplX3Blcl9kb2N1bWVudBgPIAEoBRIYChByZW1vdmVfb25fZGV0YWNoGBAgASgIEh0KFWF1dG9fcmV2aXNpb25fZW5hYmxlZBgbIAEoCBIXCg9hbGxvd2VkX29yaWdpbnMYDiADKAkSLgoKY3JlYXRlZF9hdBgMIAEoCzIaLmdvb2dsZS5wcm90b2J1Zi5UaW1lc3RhbXASLgoKdXBkYXRlZF9hdBgNIAEoCzIaLmdvb2dsZS5wcm90b2J1Zi5UaW1lc3RhbXAiLwoLTWV0cmljUG9pbnQSEQoJdGltZXN0YW1wGAEgASgDEg0KBXZhbHVlGAIgASgFIqMMChZVcGRhdGFibGVQcm9qZWN0RmllbGRzEioKBG5hbWUYASABKAsyHC5nb29nbGUucHJvdG9idWYuU3RyaW5nVmFsdWUSNgoQYXV0aF93ZWJob29rX3VybBgCIAEoCzIcLmdvb2dsZS5wcm90b2J1Zi5TdHJpbmdWYWx1ZRJSChRhdXRoX3dlYmhvb2tfbWV0aG9kcxgDIAEoCzI0LnlvcmtpZS52MS5VcGRhdGFibGVQcm9qZWN0RmllbGRzLkF1dGhXZWJob29rTWV0aG9kcxI+ChhhdXRoX3dlYmhvb2tfbWF4X3JldHJpZXMYDCABKAsyHC5nb29nbGUucHJvdG9idWYuVUludDY0VmFsdWUSRAoeYXV0aF93ZWJob29rX21pbl93YWl0X2ludGVydmFsGA0gASgLMhwuZ29vZ2xlLnByb3RvYnVmLlN0cmluZ1ZhbHVlEkQKHmF1dGhfd2ViaG9va19tYXhfd2FpdF9pbnRlcnZhbBgOIAEoCzIcLmdvb2dsZS5wcm90b2J1Zi5TdHJpbmdWYWx1ZRJCChxhdXRoX3dlYmhvb2tfcmVxdWVzdF90aW1lb3V0GA8gASgLMhwuZ29vZ2xlLnByb3RvYnVmLlN0cmluZ1ZhbHVlEjcKEWV2ZW50X3dlYmhvb2tfdXJsGAQgASgLMhwuZ29vZ2xlLnByb3RvYnVmLlN0cmluZ1ZhbHVlElIKFGV2ZW50X3dlYmhvb2tfZXZlbnRzGAUgASgLMjQueW9ya2llLnYxLlVwZGF0YWJsZVByb2plY3RGaWVsZHMuRXZlbnRXZWJob29rRXZlbnRzEj8KGWV2ZW50X3dlYmhvb2tfbWF4X3JldHJpZXMYECABKAsyHC5nb29nbGUucHJvdG9idWYuVUludDY0VmFsdWUSRQofZXZlbnRfd2ViaG9va19taW5fd2FpdF9pbnRlcnZhbBgRIAEoCzIcLmdvb2dsZS5wcm90b2J1Zi5TdHJpbmdWYWx1ZRJFCh9ldmVudF93ZWJob29rX21heF93YWl0X2ludGVydmFsGBIgASgLMhwuZ29vZ2xlLnByb3RvYnVmLlN0cmluZ1ZhbHVlEkMKHWV2ZW50X3dlYmhvb2tfcmVxdWVzdF90aW1lb3V0GBMgASgLMhwuZ29vZ2xlLnByb3RvYnVmLlN0cmluZ1ZhbHVlEjcKEnNuYXBzaG90X3RocmVzaG9sZBgUIAEoCzIbLmdvb2dsZS5wcm90b2J1Zi5JbnQ2NFZhbHVlEjYKEXNuYXBzaG90X2ludGVydmFsGBUgASgLMhsuZ29vZ2xlLnByb3RvYnVmLkludDY0VmFsdWUSQQobY2xpZW50X2RlYWN0aXZhdGVfdGhyZXNob2xkGAYgASgLMhwuZ29vZ2xlLnByb3RvYnVmLlN0cmluZ1ZhbHVlEkEKHG1heF9zdWJzY3JpYmVyc19wZXJfZG9jdW1lbnQYByABKAsyGy5nb29nbGUucHJvdG9idWYuSW50MzJWYWx1ZRJBChxtYXhfYXR0YWNobWVudHNfcGVyX2RvY3VtZW50GAggASgLMhsuZ29vZ2xlLnByb3RvYnVmLkludDMyVmFsdWUSOgoVbWF4X3NpemVfcGVyX2RvY3VtZW50GAogASgLMhsuZ29vZ2xlLnByb3RvYnVmLkludDMyVmFsdWUSNAoQcmVtb3ZlX29uX2RldGFjaBgLIAEoCzIaLmdvb2dsZS5wcm90b2J1Zi5Cb29sVmFsdWUSOQoVYXV0b19yZXZpc2lvbl9lbmFibGVkGBYgASgLMhouZ29vZ2xlLnByb3RvYnVmLkJvb2xWYWx1ZRJJCg9hbGxvd2VkX29yaWdpbnMYCSABKAsyMC55b3JraWUudjEuVXBkYXRhYmxlUHJvamVjdEZpZWxkcy5BbGxvd2VkT3JpZ2lucxolChJBdXRoV2ViaG9va01ldGhvZHMSDwoHbWV0aG9kcxgBIAMoCRokChJFdmVudFdlYmhvb2tFdmVudHMSDgoGZXZlbnRzGAEgAygJGiEKDkFsbG93ZWRPcmlnaW5zEg8KB29yaWdpbnMYASADKAkipwMKD0RvY3VtZW50U3VtbWFyeRIKCgJpZBgBIAEoCRILCgNrZXkYAiABKAkSDAoEcm9vdBgDIAEoCRIYChBhdHRhY2hlZF9jbGllbnRzGAcgASgFEikKDWRvY3VtZW50X3NpemUYCCABKAsyEi55b3JraWUudjEuRG9jU2l6ZRISCgpzY2hlbWFfa2V5GAkgASgJEjwKCXByZXNlbmNlcxgKIAMoCzIpLnlvcmtpZS52MS5Eb2N1bWVudFN1bW1hcnkuUHJlc2VuY2VzRW50cnkSLgoKY3JlYXRlZF9hdBgEIAEoCzIaLmdvb2dsZS5wcm90b2J1Zi5UaW1lc3RhbXASLwoLYWNjZXNzZWRfYXQYBSABKAsyGi5nb29nbGUucHJvdG9idWYuVGltZXN0YW1wEi4KCnVwZGF0ZWRfYXQYBiABKAsyGi5nb29nbGUucHJvdG9idWYuVGltZXN0YW1wGkUKDlByZXNlbmNlc0VudHJ5EgsKA2tleRgBIAEoCRIiCgV2YWx1ZRgCIAEoCzITLnlvcmtpZS52MS5QcmVzZW5jZToCOAEi2gEKDlByZXNlbmNlQ2hhbmdlEjIKBHR5cGUYASABKA4yJC55b3JraWUudjEuUHJlc2VuY2VDaGFuZ2UuQ2hhbmdlVHlwZRIlCghwcmVzZW5jZRgCIAEoCzITLnlvcmtpZS52MS5QcmVzZW5jZSJtCgpDaGFuZ2VUeXBlEhsKF0NIQU5HRV9UWVBFX1VOU1BFQ0lGSUVEEAASEwoPQ0hBTkdFX1RZUEVfUFVUEAESFgoSQ0hBTkdFX1RZUEVfREVMRVRFEAISFQoRQ0hBTkdFX1RZUEVfQ0xFQVIQAyJkCghQcmVzZW5jZRIrCgRkYXRhGAEgAygLMh0ueW9ya2llLnYxLlByZXNlbmNlLkRhdGFFbnRyeRorCglEYXRhRW50cnkSCwoDa2V5GAEgASgJEg0KBXZhbHVlGAIgASgJOgI4ASI0Cg5DaGFubmVsU3VtbWFyeRILCgNrZXkYASABKAkSFQoNc2Vzc2lvbl9jb3VudBgCIAEoBSI0CgpDaGVja3BvaW50EhIKCnNlcnZlcl9zZXEYASABKAMSEgoKY2xpZW50X3NlcRgCIAEoDSJhCgtUZXh0Tm9kZVBvcxIpCgpjcmVhdGVkX2F0GAEgASgLMhUueW9ya2llLnYxLlRpbWVUaWNrZXQSDgoGb2Zmc2V0GAIgASgFEhcKD3JlbGF0aXZlX29mZnNldBgDIAEoBSJCCgpUaW1lVGlja2V0Eg8KB2xhbXBvcnQYASABKAMSEQoJZGVsaW1pdGVyGAIgASgNEhAKCGFjdG9yX2lkGAMgASgMIi4KDERvY0V2ZW50Qm9keRINCgV0b3BpYxgBIAEoCRIPCgdwYXlsb2FkGAIgASgMImsKCERvY0V2ZW50EiUKBHR5cGUYASABKA4yFy55b3JraWUudjEuRG9jRXZlbnRUeXBlEhEKCXB1Ymxpc2hlchgCIAEoCRIlCgRib2R5GAMgASgLMhcueW9ya2llLnYxLkRvY0V2ZW50Qm9keSLWAQoMQ2hhbm5lbEV2ZW50EioKBHR5cGUYASABKA4yHC55b3JraWUudjEuQ2hhbm5lbEV2ZW50LlR5cGUSEQoJcHVibGlzaGVyGAIgASgJEhUKDXNlc3Npb25fY291bnQYAyABKAMSCwoDc2VxGAQgASgDEg0KBXRvcGljGAUgASgJEg8KB3BheWxvYWQYBiABKAwiQwoEVHlwZRIUChBUWVBFX1VOU1BFQ0lGSUVEEAASEQoNVFlQRV9QUkVTRU5DRRABEhIKDlRZUEVfQlJPQURDQVNUEAIiJgoIRGF0YVNpemUSDAoEZGF0YRgBIAEoBRIMCgRtZXRhGAIgASgFIk0KB0RvY1NpemUSIQoEbGl2ZRgBIAEoCzITLnlvcmtpZS52MS5EYXRhU2l6ZRIfCgJnYxgCIAEoCzITLnlvcmtpZS52MS5EYXRhU2l6ZSKRAQoGU2NoZW1hEgoKAmlkGAEgASgJEgwKBG5hbWUYAiABKAkSDwoHdmVyc2lvbhgDIAEoBRIMCgRib2R5GAQgASgJEh4KBXJ1bGVzGAUgAygLMg8ueW9ya2llLnYxLlJ1bGUSLgoKY3JlYXRlZF9hdBgGIAEoCzIaLmdvb2dsZS5wcm90b2J1Zi5UaW1lc3RhbXAiIgoEUnVsZRIMCgRwYXRoGAEgASgJEgwKBHR5cGUYAiABKAkigwEKD1JldmlzaW9uU3VtbWFyeRIKCgJpZBgBIAEoCRINCgVsYWJlbBgCIAEoCRITCgtkZXNjcmlwdGlvbhgDIAEoCRIQCghzbmFwc2hvdBgEIAEoCRIuCgpjcmVhdGVkX2F0GAUgASgLMhouZ29vZ2xlLnByb3RvYnVmLlRpbWVzdGFtcCrUAgoJVmFsdWVUeXBlEhMKD1ZBTFVFX1RZUEVfTlVMTBAAEhYKElZBTFVFX1RZUEVfQk9PTEVBThABEhYKElZBTFVFX1RZUEVfSU5URUdFUhACEhMKD1ZBTFVFX1RZUEVfTE9ORxADEhUKEVZBTFVFX1RZUEVfRE9VQkxFEAQSFQoRVkFMVUVfVFlQRV9TVFJJTkcQBRIUChBWQUxVRV9UWVBFX0JZVEVTEAYSEwoPVkFMVUVfVFlQRV9EQVRFEAcSGgoWVkFMVUVfVFlQRV9KU09OX09CSkVDVBAIEhkKFVZBTFVFX1RZUEVfSlNPTl9BUlJBWRAJEhMKD1ZBTFVFX1RZUEVfVEVYVBAKEhoKFlZBTFVFX1RZUEVfSU5URUdFUl9DTlQQCxIXChNWQUxVRV9UWVBFX0xPTkdfQ05UEAwSEwoPVkFMVUVfVFlQRV9UUkVFEA0qpgEKDERvY0V2ZW50VHlwZRIjCh9ET0NfRVZFTlRfVFlQRV9ET0NVTUVOVF9DSEFOR0VEEAASIwofRE9DX0VWRU5UX1RZUEVfRE9DVU1FTlRfV0FUQ0hFRBABEiUKIURPQ19FVkVOVF9UWVBFX0RPQ1VNRU5UX1VOV0FUQ0hFRBACEiUKIURPQ19FVkVOVF9UWVBFX0RPQ1VNRU5UX0JST0FEQ0FTVBADQkUKEWRldi55b3JraWUuYXBpLnYxUAFaLmdpdGh1Yi5jb20veW9ya2llLXRlYW0veW9ya2llL2FwaS95b3JraWUvdjE7djFiBnByb3RvMw",[ni,ns]),no=rd(na,0),nl=rd(na,1),nu=rd(na,2),nd=rd(na,3),nc=rd(na,4),nh=rd(na,5),ng=rd(na,5,0),nf=rd(na,5,1),nm=rd(na,5,2),np=rd(na,5,3),ny=rd(na,5,4),nb=rd(na,5,5),nv=rd(na,5,6),nA=rd(na,5,7),nS=rd(na,5,8),nE=rd(na,5,9),nI=rd(na,6),nw=rd(na,7),nN=rd(na,7,0),nR=rd(na,7,1),nC=rd(na,7,2),nT=rd(na,7,3),nx=rd(na,7,4),nV=rd(na,7,5),nD=rd(na,8),nk=rd(na,9),nB=rd(na,10),nW=rd(na,11),nL=rd(na,12),nO=rd(na,13),nZ=rd(na,14),nF=rd(na,15),nP=rd(na,16),nU=rd(na,23);var nG=((Z={})[Z.UNSPECIFIED=0]="UNSPECIFIED",Z[Z.PUT=1]="PUT",Z[Z.DELETE=2]="DELETE",Z[Z.CLEAR=3]="CLEAR",Z);let nY=rd(na,24),nK=rd(na,26),nM=rd(na,27),n_=rd(na,28);var nX=((F={})[F.UNSPECIFIED=0]="UNSPECIFIED",F[F.PRESENCE=1]="PRESENCE",F[F.BROADCAST=2]="BROADCAST",F),nJ=((P={})[P.NULL=0]="NULL",P[P.BOOLEAN=1]="BOOLEAN",P[P.INTEGER=2]="INTEGER",P[P.LONG=3]="LONG",P[P.DOUBLE=4]="DOUBLE",P[P.STRING=5]="STRING",P[P.BYTES=6]="BYTES",P[P.DATE=7]="DATE",P[P.JSON_OBJECT=8]="JSON_OBJECT",P[P.JSON_ARRAY=9]="JSON_ARRAY",P[P.TEXT=10]="TEXT",P[P.INTEGER_CNT=11]="INTEGER_CNT",P[P.LONG_CNT=12]="LONG_CNT",P[P.TREE=13]="TREE",P),nz=((U={})[U.DOCUMENT_CHANGED=0]="DOCUMENT_CHANGED",U[U.DOCUMENT_WATCHED=1]="DOCUMENT_WATCHED",U[U.DOCUMENT_UNWATCHED=2]="DOCUMENT_UNWATCHED",U[U.DOCUMENT_BROADCAST=3]="DOCUMENT_BROADCAST",U);let n$=(c=rh("Ch5zcmMvYXBpL3lvcmtpZS92MS95b3JraWUucHJvdG8SCXlvcmtpZS52MSKeAQoVQWN0aXZhdGVDbGllbnRSZXF1ZXN0EhIKCmNsaWVudF9rZXkYASABKAkSQAoIbWV0YWRhdGEYAiADKAsyLi55b3JraWUudjEuQWN0aXZhdGVDbGllbnRSZXF1ZXN0Lk1ldGFkYXRhRW50cnkaLwoNTWV0YWRhdGFFbnRyeRILCgNrZXkYASABKAkSDQoFdmFsdWUYAiABKAk6AjgBIisKFkFjdGl2YXRlQ2xpZW50UmVzcG9uc2USEQoJY2xpZW50X2lkGAEgASgJIkEKF0RlYWN0aXZhdGVDbGllbnRSZXF1ZXN0EhEKCWNsaWVudF9pZBgBIAEoCRITCgtzeW5jaHJvbm91cxgCIAEoCCIaChhEZWFjdGl2YXRlQ2xpZW50UmVzcG9uc2UiagoVQXR0YWNoRG9jdW1lbnRSZXF1ZXN0EhEKCWNsaWVudF9pZBgBIAEoCRIqCgtjaGFuZ2VfcGFjaxgCIAEoCzIVLnlvcmtpZS52MS5DaGFuZ2VQYWNrEhIKCnNjaGVtYV9rZXkYAyABKAkinwEKFkF0dGFjaERvY3VtZW50UmVzcG9uc2USEwoLZG9jdW1lbnRfaWQYASABKAkSKgoLY2hhbmdlX3BhY2sYAiABKAsyFS55b3JraWUudjEuQ2hhbmdlUGFjaxIdChVtYXhfc2l6ZV9wZXJfZG9jdW1lbnQYAyABKAUSJQoMc2NoZW1hX3J1bGVzGAQgAygLMg8ueW9ya2llLnYxLlJ1bGUiiwEKFURldGFjaERvY3VtZW50UmVxdWVzdBIRCgljbGllbnRfaWQYASABKAkSEwoLZG9jdW1lbnRfaWQYAiABKAkSKgoLY2hhbmdlX3BhY2sYAyABKAsyFS55b3JraWUudjEuQ2hhbmdlUGFjaxIeChZyZW1vdmVfaWZfbm90X2F0dGFjaGVkGAQgASgIIkQKFkRldGFjaERvY3VtZW50UmVzcG9uc2USKgoLY2hhbmdlX3BhY2sYAiABKAsyFS55b3JraWUudjEuQ2hhbmdlUGFjayJTCgxXYXRjaFJlcXVlc3QSEQoJY2xpZW50X2lkGAEgASgJEjAKCXJlc291cmNlcxgCIAMoCzIdLnlvcmtpZS52MS5SZXNvdXJjZURlc2NyaXB0b3IihAEKElJlc291cmNlRGVzY3JpcHRvchIxCghkb2N1bWVudBgBIAEoCzIdLnlvcmtpZS52MS5Eb2N1bWVudERlc2NyaXB0b3JIABIvCgdjaGFubmVsGAIgASgLMhwueW9ya2llLnYxLkNoYW5uZWxEZXNjcmlwdG9ySABCCgoIcmVzb3VyY2UiKQoSRG9jdW1lbnREZXNjcmlwdG9yEhMKC2RvY3VtZW50X2lkGAEgASgJIigKEUNoYW5uZWxEZXNjcmlwdG9yEhMKC2NoYW5uZWxfa2V5GAEgASgJInkKDVdhdGNoUmVzcG9uc2USOAoOaW5pdGlhbGl6YXRpb24YASABKAsyHi55b3JraWUudjEuV2F0Y2hJbml0aWFsaXphdGlvbkgAEiYKBWV2ZW50GAIgASgLMhUueW9ya2llLnYxLldhdGNoRXZlbnRIAEIGCgRib2R5IkYKE1dhdGNoSW5pdGlhbGl6YXRpb24SLwoOcmVzb3VyY2VfaW5pdHMYASADKAsyFy55b3JraWUudjEuUmVzb3VyY2VJbml0IngKDFJlc291cmNlSW5pdBIwCg1kb2N1bWVudF9pbml0GAEgASgLMhcueW9ya2llLnYxLkRvY3VtZW50SW5pdEgAEi4KDGNoYW5uZWxfaW5pdBgCIAEoCzIWLnlvcmtpZS52MS5DaGFubmVsSW5pdEgAQgYKBGluaXQiNwoMRG9jdW1lbnRJbml0EhMKC2RvY3VtZW50X2lkGAEgASgJEhIKCmNsaWVudF9pZHMYAiADKAkiRgoLQ2hhbm5lbEluaXQSEwoLY2hhbm5lbF9rZXkYASABKAkSFQoNc2Vzc2lvbl9jb3VudBgCIAEoAxILCgNzZXEYAyABKAMiewoKV2F0Y2hFdmVudBItCglkb2NfZXZlbnQYASABKAsyGC55b3JraWUudjEuRG9jV2F0Y2hFdmVudEgAEjUKDWNoYW5uZWxfZXZlbnQYAiABKAsyHC55b3JraWUudjEuQ2hhbm5lbFdhdGNoRXZlbnRIAEIHCgVldmVudCJICg1Eb2NXYXRjaEV2ZW50EhMKC2RvY3VtZW50X2lkGAEgASgJEiIKBWV2ZW50GAIgASgLMhMueW9ya2llLnYxLkRvY0V2ZW50IlAKEUNoYW5uZWxXYXRjaEV2ZW50EhMKC2NoYW5uZWxfa2V5GAEgASgJEiYKBWV2ZW50GAIgASgLMhcueW9ya2llLnYxLkNoYW5uZWxFdmVudCJrChVSZW1vdmVEb2N1bWVudFJlcXVlc3QSEQoJY2xpZW50X2lkGAEgASgJEhMKC2RvY3VtZW50X2lkGAIgASgJEioKC2NoYW5nZV9wYWNrGAMgASgLMhUueW9ya2llLnYxLkNoYW5nZVBhY2siRAoWUmVtb3ZlRG9jdW1lbnRSZXNwb25zZRIqCgtjaGFuZ2VfcGFjaxgBIAEoCzIVLnlvcmtpZS52MS5DaGFuZ2VQYWNrIn8KFlB1c2hQdWxsQ2hhbmdlc1JlcXVlc3QSEQoJY2xpZW50X2lkGAEgASgJEhMKC2RvY3VtZW50X2lkGAIgASgJEioKC2NoYW5nZV9wYWNrGAMgASgLMhUueW9ya2llLnYxLkNoYW5nZVBhY2sSEQoJcHVzaF9vbmx5GAQgASgIIkUKF1B1c2hQdWxsQ2hhbmdlc1Jlc3BvbnNlEioKC2NoYW5nZV9wYWNrGAEgASgLMhUueW9ya2llLnYxLkNoYW5nZVBhY2siYwoVQ3JlYXRlUmV2aXNpb25SZXF1ZXN0EhEKCWNsaWVudF9pZBgBIAEoCRITCgtkb2N1bWVudF9pZBgCIAEoCRINCgVsYWJlbBgDIAEoCRITCgtkZXNjcmlwdGlvbhgEIAEoCSJGChZDcmVhdGVSZXZpc2lvblJlc3BvbnNlEiwKCHJldmlzaW9uGAEgASgLMhoueW9ya2llLnYxLlJldmlzaW9uU3VtbWFyeSJRChJHZXRSZXZpc2lvblJlcXVlc3QSEQoJY2xpZW50X2lkGAEgASgJEhMKC2RvY3VtZW50X2lkGAIgASgJEhMKC3JldmlzaW9uX2lkGAMgASgJIkMKE0dldFJldmlzaW9uUmVzcG9uc2USLAoIcmV2aXNpb24YASABKAsyGi55b3JraWUudjEuUmV2aXNpb25TdW1tYXJ5InUKFExpc3RSZXZpc2lvbnNSZXF1ZXN0EhEKCWNsaWVudF9pZBgBIAEoCRITCgtkb2N1bWVudF9pZBgCIAEoCRIRCglwYWdlX3NpemUYAyABKAUSDgoGb2Zmc2V0GAQgASgFEhIKCmlzX2ZvcndhcmQYBSABKAgiRgoVTGlzdFJldmlzaW9uc1Jlc3BvbnNlEi0KCXJldmlzaW9ucxgBIAMoCzIaLnlvcmtpZS52MS5SZXZpc2lvblN1bW1hcnkiVQoWUmVzdG9yZVJldmlzaW9uUmVxdWVzdBIRCgljbGllbnRfaWQYASABKAkSEwoLZG9jdW1lbnRfaWQYAiABKAkSEwoLcmV2aXNpb25faWQYBCABKAkiGQoXUmVzdG9yZVJldmlzaW9uUmVzcG9uc2UiPgoUQXR0YWNoQ2hhbm5lbFJlcXVlc3QSEQoJY2xpZW50X2lkGAEgASgJEhMKC2NoYW5uZWxfa2V5GAIgASgJIkIKFUF0dGFjaENoYW5uZWxSZXNwb25zZRISCgpzZXNzaW9uX2lkGAEgASgJEhUKDXNlc3Npb25fY291bnQYAiABKAMiUgoURGV0YWNoQ2hhbm5lbFJlcXVlc3QSEQoJY2xpZW50X2lkGAEgASgJEhMKC2NoYW5uZWxfa2V5GAIgASgJEhIKCnNlc3Npb25faWQYAyABKAkiLgoVRGV0YWNoQ2hhbm5lbFJlc3BvbnNlEhUKDXNlc3Npb25fY291bnQYASABKAMiUwoVUmVmcmVzaENoYW5uZWxSZXF1ZXN0EhEKCWNsaWVudF9pZBgBIAEoCRITCgtjaGFubmVsX2tleRgCIAEoCRISCgpzZXNzaW9uX2lkGAMgASgJIi8KFlJlZnJlc2hDaGFubmVsUmVzcG9uc2USFQoNc2Vzc2lvbl9jb3VudBgBIAEoAyJaChBCcm9hZGNhc3RSZXF1ZXN0EhEKCWNsaWVudF9pZBgBIAEoCRITCgtjaGFubmVsX2tleRgCIAEoCRINCgV0b3BpYxgDIAEoCRIPCgdwYXlsb2FkGAQgASgMIhMKEUJyb2FkY2FzdFJlc3BvbnNlMpgKCg1Zb3JraWVTZXJ2aWNlElcKDkFjdGl2YXRlQ2xpZW50EiAueW9ya2llLnYxLkFjdGl2YXRlQ2xpZW50UmVxdWVzdBohLnlvcmtpZS52MS5BY3RpdmF0ZUNsaWVudFJlc3BvbnNlIgASXQoQRGVhY3RpdmF0ZUNsaWVudBIiLnlvcmtpZS52MS5EZWFjdGl2YXRlQ2xpZW50UmVxdWVzdBojLnlvcmtpZS52MS5EZWFjdGl2YXRlQ2xpZW50UmVzcG9uc2UiABJXCg5BdHRhY2hEb2N1bWVudBIgLnlvcmtpZS52MS5BdHRhY2hEb2N1bWVudFJlcXVlc3QaIS55b3JraWUudjEuQXR0YWNoRG9jdW1lbnRSZXNwb25zZSIAElcKDkRldGFjaERvY3VtZW50EiAueW9ya2llLnYxLkRldGFjaERvY3VtZW50UmVxdWVzdBohLnlvcmtpZS52MS5EZXRhY2hEb2N1bWVudFJlc3BvbnNlIgASVwoOUmVtb3ZlRG9jdW1lbnQSIC55b3JraWUudjEuUmVtb3ZlRG9jdW1lbnRSZXF1ZXN0GiEueW9ya2llLnYxLlJlbW92ZURvY3VtZW50UmVzcG9uc2UiABJaCg9QdXNoUHVsbENoYW5nZXMSIS55b3JraWUudjEuUHVzaFB1bGxDaGFuZ2VzUmVxdWVzdBoiLnlvcmtpZS52MS5QdXNoUHVsbENoYW5nZXNSZXNwb25zZSIAEj4KBVdhdGNoEhcueW9ya2llLnYxLldhdGNoUmVxdWVzdBoYLnlvcmtpZS52MS5XYXRjaFJlc3BvbnNlIgAwARJXCg5DcmVhdGVSZXZpc2lvbhIgLnlvcmtpZS52MS5DcmVhdGVSZXZpc2lvblJlcXVlc3QaIS55b3JraWUudjEuQ3JlYXRlUmV2aXNpb25SZXNwb25zZSIAEk4KC0dldFJldmlzaW9uEh0ueW9ya2llLnYxLkdldFJldmlzaW9uUmVxdWVzdBoeLnlvcmtpZS52MS5HZXRSZXZpc2lvblJlc3BvbnNlIgASVAoNTGlzdFJldmlzaW9ucxIfLnlvcmtpZS52MS5MaXN0UmV2aXNpb25zUmVxdWVzdBogLnlvcmtpZS52MS5MaXN0UmV2aXNpb25zUmVzcG9uc2UiABJaCg9SZXN0b3JlUmV2aXNpb24SIS55b3JraWUudjEuUmVzdG9yZVJldmlzaW9uUmVxdWVzdBoiLnlvcmtpZS52MS5SZXN0b3JlUmV2aXNpb25SZXNwb25zZSIAElQKDUF0dGFjaENoYW5uZWwSHy55b3JraWUudjEuQXR0YWNoQ2hhbm5lbFJlcXVlc3QaIC55b3JraWUudjEuQXR0YWNoQ2hhbm5lbFJlc3BvbnNlIgASVAoNRGV0YWNoQ2hhbm5lbBIfLnlvcmtpZS52MS5EZXRhY2hDaGFubmVsUmVxdWVzdBogLnlvcmtpZS52MS5EZXRhY2hDaGFubmVsUmVzcG9uc2UiABJXCg5SZWZyZXNoQ2hhbm5lbBIgLnlvcmtpZS52MS5SZWZyZXNoQ2hhbm5lbFJlcXVlc3QaIS55b3JraWUudjEuUmVmcmVzaENoYW5uZWxSZXNwb25zZSIAEkgKCUJyb2FkY2FzdBIbLnlvcmtpZS52MS5Ccm9hZGNhc3RSZXF1ZXN0GhwueW9ya2llLnYxLkJyb2FkY2FzdFJlc3BvbnNlIgBCRQoRZGV2LnlvcmtpZS5hcGkudjFQAVouZ2l0aHViLmNvbS95b3JraWUtdGVhbS95b3JraWUvYXBpL3lvcmtpZS92MTt2MWIGcHJvdG8z",[na]),h=0,c.services[0]),nj=rh("Ch5nb29nbGUvcHJvdG9idWYvZHVyYXRpb24ucHJvdG8SD2dvb2dsZS5wcm90b2J1ZiIqCghEdXJhdGlvbhIPCgdzZWNvbmRzGAEgASgDEg0KBW5hbm9zGAIgASgFQoMBChNjb20uZ29vZ2xlLnByb3RvYnVmQg1EdXJhdGlvblByb3RvUAFaMWdvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL2R1cmF0aW9ucGL4AQGiAgNHUEKqAh5Hb29nbGUuUHJvdG9idWYuV2VsbEtub3duVHlwZXNiBnByb3RvMw"),nQ=rd(rh("Ch5nb29nbGUvcnBjL2Vycm9yX2RldGFpbHMucHJvdG8SCmdvb2dsZS5ycGMikwEKCUVycm9ySW5mbxIOCgZyZWFzb24YASABKAkSDgoGZG9tYWluGAIgASgJEjUKCG1ldGFkYXRhGAMgAygLMiMuZ29vZ2xlLnJwYy5FcnJvckluZm8uTWV0YWRhdGFFbnRyeRovCg1NZXRhZGF0YUVudHJ5EgsKA2tleRgBIAEoCRINCgV2YWx1ZRgCIAEoCToCOAEiOwoJUmV0cnlJbmZvEi4KC3JldHJ5X2RlbGF5GAEgASgLMhkuZ29vZ2xlLnByb3RvYnVmLkR1cmF0aW9uIjIKCURlYnVnSW5mbxIVCg1zdGFja19lbnRyaWVzGAEgAygJEg4KBmRldGFpbBgCIAEoCSKPAwoMUXVvdGFGYWlsdXJlEjYKCnZpb2xhdGlvbnMYASADKAsyIi5nb29nbGUucnBjLlF1b3RhRmFpbHVyZS5WaW9sYXRpb24axgIKCVZpb2xhdGlvbhIPCgdzdWJqZWN0GAEgASgJEhMKC2Rlc2NyaXB0aW9uGAIgASgJEhMKC2FwaV9zZXJ2aWNlGAMgASgJEhQKDHF1b3RhX21ldHJpYxgEIAEoCRIQCghxdW90YV9pZBgFIAEoCRJRChBxdW90YV9kaW1lbnNpb25zGAYgAygLMjcuZ29vZ2xlLnJwYy5RdW90YUZhaWx1cmUuVmlvbGF0aW9uLlF1b3RhRGltZW5zaW9uc0VudHJ5EhMKC3F1b3RhX3ZhbHVlGAcgASgDEh8KEmZ1dHVyZV9xdW90YV92YWx1ZRgIIAEoA0gAiAEBGjYKFFF1b3RhRGltZW5zaW9uc0VudHJ5EgsKA2tleRgBIAEoCRINCgV2YWx1ZRgCIAEoCToCOAFCFQoTX2Z1dHVyZV9xdW90YV92YWx1ZSKVAQoTUHJlY29uZGl0aW9uRmFpbHVyZRI9Cgp2aW9sYXRpb25zGAEgAygLMikuZ29vZ2xlLnJwYy5QcmVjb25kaXRpb25GYWlsdXJlLlZpb2xhdGlvbho/CglWaW9sYXRpb24SDAoEdHlwZRgBIAEoCRIPCgdzdWJqZWN0GAIgASgJEhMKC2Rlc2NyaXB0aW9uGAMgASgJIswBCgpCYWRSZXF1ZXN0Ej8KEGZpZWxkX3Zpb2xhdGlvbnMYASADKAsyJS5nb29nbGUucnBjLkJhZFJlcXVlc3QuRmllbGRWaW9sYXRpb24afQoORmllbGRWaW9sYXRpb24SDQoFZmllbGQYASABKAkSEwoLZGVzY3JpcHRpb24YAiABKAkSDgoGcmVhc29uGAMgASgJEjcKEWxvY2FsaXplZF9tZXNzYWdlGAQgASgLMhwuZ29vZ2xlLnJwYy5Mb2NhbGl6ZWRNZXNzYWdlIjcKC1JlcXVlc3RJbmZvEhIKCnJlcXVlc3RfaWQYASABKAkSFAoMc2VydmluZ19kYXRhGAIgASgJImAKDFJlc291cmNlSW5mbxIVCg1yZXNvdXJjZV90eXBlGAEgASgJEhUKDXJlc291cmNlX25hbWUYAiABKAkSDQoFb3duZXIYAyABKAkSEwoLZGVzY3JpcHRpb24YBCABKAkiVgoESGVscBIkCgVsaW5rcxgBIAMoCzIVLmdvb2dsZS5ycGMuSGVscC5MaW5rGigKBExpbmsSEwoLZGVzY3JpcHRpb24YASABKAkSCwoDdXJsGAIgASgJIjMKEExvY2FsaXplZE1lc3NhZ2USDgoGbG9jYWxlGAEgASgJEg8KB21lc3NhZ2UYAiABKAlCbAoOY29tLmdvb2dsZS5ycGNCEUVycm9yRGV0YWlsc1Byb3RvUAFaP2dvb2dsZS5nb2xhbmcub3JnL2dlbnByb3RvL2dvb2dsZWFwaXMvcnBjL2VycmRldGFpbHM7ZXJyZGV0YWlsc6ICA1JQQ2IGcHJvdG8z",[nj]),0);var nH=((G={}).Ok="ok",G.ErrClientNotActivated="ErrClientNotActivated",G.ErrClientNotFound="ErrClientNotFound",G.ErrUnimplemented="ErrUnimplemented",G.ErrInvalidType="ErrInvalidType",G.ErrDummy="ErrDummy",G.ErrNotAttached="ErrNotAttached",G.ErrNotDetached="ErrNotDetached",G.ErrDocumentRemoved="ErrDocumentRemoved",G.ErrDocumentSizeExceedsLimit="ErrDocumentSizeExceedsLimit",G.ErrDocumentSchemaValidationFailed="ErrDocumentSchemaValidationFailed",G.ErrInvalidObjectKey="ErrInvalidObjectKey",G.ErrInvalidArgument="ErrInvalidArgument",G.ErrNotInitialized="ErrNotInitialized",G.ErrNotReady="ErrNotReady",G.ErrRefused="ErrRefused",G.ErrContextNotProvided="ErrContextNotProvided",G.ErrPermissionDenied="ErrPermissionDenied",G.ErrUnauthenticated="ErrUnauthenticated",G.ErrTooManySubscribers="ErrTooManySubscribers",G.ErrTooManyAttachments="ErrTooManyAttachments",G);class nq extends Error{code;message;name;stack;constructor(e,t){super(t),this.code=e,this.message=t,this.name="YorkieError",this.toString=()=>`[code=${this.code}]: ${this.message}`}}var n0=((Y={}).Put="put",Y.Clear="clear",Y);let n1="000000000000000000000000";class n2{lamport;delimiter;actorID;constructor(e,t,r){this.lamport=e,this.delimiter=t,this.actorID=r}static of(e,t,r){return new n2(e,t,r)}static fromStruct(e){return n2.of(BigInt(e.lamport),e.delimiter,e.actorID)}toIDString(){return`${this.lamport.toString()}:${this.actorID}:${this.delimiter}`}toStruct(){return{lamport:this.getLamportAsString(),delimiter:this.getDelimiter(),actorID:this.getActorID()}}toTestString(){return`${this.lamport.toString()}:${this.actorID.slice(-2)}:${this.delimiter}`}setActor(e){return new n2(this.lamport,this.delimiter,e)}getLamportAsString(){return this.lamport.toString()}getLamport(){return this.lamport}getDelimiter(){return this.delimiter}getActorID(){return this.actorID}after(e){return this.compare(e)>0}equals(e){return 0===this.compare(e)}compare(e){if(this.lamport>e.lamport)return 1;if(e.lamport>this.lamport)return -1;let t=this.actorID.localeCompare(e.actorID);return 0!==t?t:this.delimiter>e.delimiter?1:e.delimiter>this.delimiter?-1:0}}let n3=new n2(0n,0,n1);function n5(e){return e.replace(/["'\\\n\r\f\b\t\u2028\u2029]/g,function(e){switch(e){case'"':case"\\":return"\\"+e;case"\n":return"\\n";case"\r":return"\\r";case"\f":return"\\f";case"\b":return"\\b";case"	":return"\\t";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e}})}new n2(0x7fffffffffffffffn,0xffffffff,"FFFFFFFFFFFFFFFFFFFFFFFF");class n9{createdAt;movedAt;removedAt;constructor(e){this.createdAt=e}getCreatedAt(){return this.createdAt}getID(){return this.createdAt}getMovedAt(){return this.movedAt}getRemovedAt(){return this.removedAt}getPositionedAt(){return this.movedAt?this.movedAt:this.createdAt}setCreatedAt(e){this.createdAt=e}setMovedAt(e){return!!(!this.movedAt||e&&e.after(this.movedAt))&&(this.movedAt=e,!0)}setRemovedAt(e){this.removedAt=e}remove(e){return!!(e&&e.after(this.createdAt)&&(!this.removedAt||e.after(this.removedAt)))&&(this.removedAt=e,!0)}isRemoved(){return!!this.removedAt}getMetaUsage(){let e=0;return this.getCreatedAt()&&(e+=24),this.getMovedAt()&&(e+=24),this.getRemovedAt()&&(e+=24),e}}class n4 extends n9{constructor(e){super(e)}}class n6{strKey;value;constructor(e,t){this.strKey=e,this.value=t}static of(e,t){return new n6(e,t)}isRemoved(){return this.value.isRemoved()}getStrKey(){return this.strKey}getValue(){return this.value}remove(e){return this.value.remove(e)}}class n8{nodeMapByKey;nodeMapByCreatedAt;constructor(){this.nodeMapByKey=new Map,this.nodeMapByCreatedAt=new Map}static create(){return new n8}set(e,t,r){let n,i=this.nodeMapByKey.get(e);i&&!i.isRemoved()&&i.remove(r)&&(n=i.getValue());let s=n6.of(e,t);return this.nodeMapByCreatedAt.set(t.getCreatedAt().toIDString(),s),(!i||r.after(i.getValue().getPositionedAt()))&&(this.nodeMapByKey.set(e,s),t.setMovedAt(r)),n}delete(e,t){if(!this.nodeMapByCreatedAt.has(e.toIDString()))throw new nq(nH.ErrInvalidArgument,`fail to find ${e.toIDString()}`);let r=this.nodeMapByCreatedAt.get(e.toIDString());return r.remove(t),r.getValue()}subPathOf(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());if(t)return t.getStrKey()}purge(e){let t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!t)throw new nq(nH.ErrInvalidArgument,`fail to find ${e.getCreatedAt().toIDString()}`);let r=this.nodeMapByKey.get(t.getStrKey());t===r&&this.nodeMapByKey.delete(r.getStrKey()),this.nodeMapByCreatedAt.delete(t.getValue().getCreatedAt().toIDString())}deleteByKey(e,t){let r=this.nodeMapByKey.get(e);if(r&&r.remove(t))return r.getValue()}has(e){let t=this.nodeMapByKey.get(e);return!!t&&!t.isRemoved()}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}get(e){let t=this.nodeMapByKey.get(e);if(!(!t||t.isRemoved()))return t}deepcopy(){let e=n8.create();for(let[,t]of this.nodeMapByCreatedAt)e.nodeMapByCreatedAt.set(t.getValue().getCreatedAt().toIDString(),n6.of(t.getStrKey(),t.getValue().deepcopy()));for(let[t,r]of this.nodeMapByKey)e.nodeMapByKey.set(t,e.nodeMapByCreatedAt.get(r.getValue().getCreatedAt().toIDString()));return e}*[Symbol.iterator](){for(let[,e]of this.nodeMapByCreatedAt)yield e}}class n7 extends n4{memberNodes;constructor(e,t){super(e),this.memberNodes=t}static create(e,t){if(!t)return new n7(e,n8.create());let r=n8.create();for(let[e,n]of Object.entries(t))r.set(e,n.deepcopy(),n.getCreatedAt());return new n7(e,r)}subPathOf(e){return this.memberNodes.subPathOf(e)}purge(e){this.memberNodes.purge(e)}set(e,t,r){return this.memberNodes.set(e,t,r)}delete(e,t){return this.memberNodes.delete(e,t)}deleteByKey(e,t){return this.memberNodes.deleteByKey(e,t)}get(e){let t=this.memberNodes.get(e);return t?.getValue()}getByID(e){let t=this.memberNodes.getByID(e);return t?.getValue()}has(e){return this.memberNodes.has(e)}getDataSize(){return{data:0,meta:this.getMetaUsage()}}toJSON(){let e=[];for(let[t,r]of this)e.push(`"${n5(t)}":${r.toJSON()}`);return`{${e.join(",")}}`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){let e={};for(let[t,r]of this){let{createdAt:n,value:i,type:s}=r.toJSForTest();e[t]={key:t,createdAt:n,value:i,type:s}}return{createdAt:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_OBJECT"}}getKeys(){let e=[];for(let[t]of this)e.push(t);return e}toSortedJSON(){let e=new Set;for(let[t]of this)e.add(t);let t=[];for(let r of Array.from(e).sort()){let e=this.memberNodes.get(r)?.getValue();t.push(`"${n5(r)}":${e.toSortedJSON()}`)}return`{${t.join(",")}}`}getRHT(){return this.memberNodes}deepcopy(){let e=n7.create(this.getCreatedAt());return e.memberNodes=this.memberNodes.deepcopy(),e.setRemovedAt(this.getRemovedAt()),e.setMovedAt(this.getMovedAt()),e}getDescendants(e){for(let t of this.memberNodes){let r=t.getValue();if(e(r,this))return;r instanceof n4&&r.getDescendants(e)}}*[Symbol.iterator](){for(let e of this.memberNodes)e.isRemoved()||(yield[e.getStrKey(),e.getValue()])}}var ie=((K={}).Local="local",K.Remote="remote",K.UndoRedo="undoredo",K);class it{parentCreatedAt;executedAt;constructor(e,t){this.parentCreatedAt=e,this.executedAt=t}getParentCreatedAt(){return this.parentCreatedAt}getExecutedAt(){if(!this.executedAt)throw new nq(nH.ErrNotReady,"executedAt is not set yet");return this.executedAt}setActor(e){this.executedAt&&(this.executedAt=this.executedAt.setActor(e))}setExecutedAt(e){this.executedAt=e}}class ir{value;left;right;parent;weight;constructor(e){this.value=e,this.initWeight()}getNodeString(){return`${this.weight}${this.value}`}getValue(){return this.value}getLeftWeight(){return this.hasLeft()?this.left.getWeight():0}getRightWeight(){return this.hasRight()?this.right.getWeight():0}getWeight(){return this.weight}getLeft(){return this.left}getRight(){return this.right}getParent(){return this.parent}hasLeft(){return!!this.left}hasRight(){return!!this.right}hasParent(){return!!this.parent}setLeft(e){this.left=e}setRight(e){this.right=e}setParent(e){this.parent=e}unlink(){this.parent=void 0,this.right=void 0,this.left=void 0}hasLinks(){return this.hasParent()||this.hasLeft()||this.hasRight()}increaseWeight(e){this.weight+=e}initWeight(){this.weight=this.getLength()}}class ii{root;constructor(e){this.root=e}get length(){return this.root?this.root.getWeight():0}findForText(e){if(!this.root||e<0)return[void 0,0];let t=this.root;for(;;)if(t.hasLeft()&&e<=t.getLeftWeight())t=t.getLeft();else if(t.hasRight()&&t.getLeftWeight()+t.getLength()<e)e-=t.getLeftWeight()+t.getLength(),t=t.getRight();else{e-=t.getLeftWeight();break}if(e>t.getLength())throw new nq(nH.ErrInvalidArgument,`out of index range: pos: ${e} > node.length: ${t.getLength()}`);return this.splayNode(t),[t,e]}findForArray(e){if(!this.root)return;if(e<0||e>=this.length)throw new nq(nH.ErrInvalidArgument,`out of index range: idx: ${e}, length: ${this.length}`);let t=this.root;for(;;)if(t.hasLeft()&&e<t.getLeftWeight())t=t.getLeft();else if(t.hasRight()&&t.getLeftWeight()+t.getLength()<=e)e-=t.getLeftWeight()+t.getLength(),t=t.getRight();else break;return this.splayNode(t),t}indexOf(e){return e&&(e===this.root||e.hasLinks())?(this.splayNode(e),this.root.getLeftWeight()):-1}getRoot(){return this.root}insert(e){return this.insertAfter(this.root,e)}insertAfter(e,t){return e?(this.splayNode(e),this.root=t,t.setRight(e.getRight()),e.hasRight()&&e.getRight().setParent(t),t.setLeft(e),e.setParent(t),e.setRight(),this.updateWeight(e),this.updateWeight(t)):this.root=t,t}updateWeight(e){e.initWeight(),e.hasLeft()&&e.increaseWeight(e.getLeftWeight()),e.hasRight()&&e.increaseWeight(e.getRightWeight())}updateTreeWeight(e){for(;e;)this.updateWeight(e),e=e.getParent()}splayNode(e){if(e)for(;;)if(this.isLeftChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e),this.rotateLeft(e);else if(this.isLeftChild(e.getParent())&&this.isLeftChild(e))this.rotateRight(e.getParent()),this.rotateRight(e);else if(this.isRightChild(e.getParent())&&this.isRightChild(e))this.rotateLeft(e.getParent()),this.rotateLeft(e);else{this.isLeftChild(e)?this.rotateRight(e):this.isRightChild(e)&&this.rotateLeft(e),this.updateWeight(e);return}}delete(e){this.splayNode(e);let t=new ii(e.getLeft());t.root&&t.root.setParent();let r=new ii(e.getRight());if(r.root&&r.root.setParent(),t.root){let e=t.getRightmost();t.splayNode(e),t.root.setRight(r.root),r.root&&r.root.setParent(t.root),this.root=t.root}else this.root=r.root;e.unlink(),this.root&&this.updateWeight(this.root)}deleteRange(e,t){if(!t){this.splayNode(e),this.cutOffRight(e);return}this.splayNode(e),this.splayNode(t),t.getLeft()!=e&&this.rotateRight(e),this.cutOffRight(e)}cutOffRight(e){let t=[];for(let r of(this.traversePostorder(e.getRight(),t),t))r.initWeight();this.updateTreeWeight(e)}toTestString(){let e=[];return this.traverseInorder(this.root,e),e.map(e=>`[${e.getWeight()},${e.getLength()}]${e.getValue()||""}`).join("")}checkWeight(){let e=[];for(let t of(this.traverseInorder(this.root,e),e))if(t.getWeight()!=t.getLength()+t.getLeftWeight()+t.getRightWeight())return!1;return!0}getRightmost(){let e=this.root;for(;e.hasRight();)e=e.getRight();return e}traverseInorder(e,t){e&&(this.traverseInorder(e.getLeft(),t),t.push(e),this.traverseInorder(e.getRight(),t))}traversePostorder(e,t){e&&(this.traversePostorder(e.getLeft(),t),this.traversePostorder(e.getRight(),t),t.push(e))}rotateLeft(e){let t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setRight(e.getLeft()),t.hasRight()&&t.getRight().setParent(t),e.setLeft(t),e.getLeft().setParent(e),this.updateWeight(t),this.updateWeight(e)}rotateRight(e){let t=e.getParent();t.hasParent()?t===t.getParent().getLeft()?t.getParent().setLeft(e):t.getParent().setRight(e):this.root=e,e.setParent(t.getParent()),t.setLeft(e.getRight()),t.hasLeft()&&t.getLeft().setParent(t),e.setRight(t),e.getRight().setParent(e),this.updateWeight(t),this.updateWeight(e)}isLeftChild(e){return!!(e&&e.hasParent())&&e.getParent().getLeft()===e}isRightChild(e){return!!(e&&e.hasParent())&&e.getParent().getRight()===e}}var is=null;try{is=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function ia(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function io(e){return!0===(e&&e.__isLong__)}function il(e){var t=Math.clz32(e&-e);return e?31-t:t}ia.prototype.__isLong__,Object.defineProperty(ia.prototype,"__isLong__",{value:!0}),ia.isLong=io;var iu={},id={};function ic(e,t){var r,n,i;if(t)return(e>>>=0,(i=0<=e&&e<256)&&(n=id[e]))?n:(r=ig(e,0,!0),i&&(id[e]=r),r);return(e|=0,(i=-128<=e&&e<128)&&(n=iu[e]))?n:(r=ig(e,e<0?-1:0,!1),i&&(iu[e]=r),r)}function ih(e,t){if(isNaN(e))return t?iI:iE;if(t){if(e<0)return iI;if(e>=iv)return iT}else{if(e<=-iA)return ix;if(e+1>=iA)return iC}return e<0?ih(-e,t).neg():ig(e%ib|0,e/ib|0,t)}function ig(e,t,r){return new ia(e,t,r)}ia.fromInt=ic,ia.fromNumber=ih,ia.fromBits=ig;var im=Math.pow;function ip(e,t,r){if(0===e.length)throw Error("empty string");if("number"==typeof t?(r=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?iI:iE;if((r=r||10)<2||36<r)throw RangeError("radix");if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return ip(e.substring(1),t,r).neg();for(var n,i=ih(im(r,8)),s=iE,a=0;a<e.length;a+=8){var o=Math.min(8,e.length-a),l=parseInt(e.substring(a,a+o),r);if(o<8){var u=ih(im(r,o));s=s.mul(u).add(ih(l))}else s=(s=s.mul(i)).add(ih(l))}return s.unsigned=t,s}function iy(e,t){return"number"==typeof e?ih(e,t):"string"==typeof e?ip(e,t):ig(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}ia.fromString=ip,ia.fromValue=iy;var ib=0x100000000,iv=0xffffffffffffffff,iA=0x8000000000000000,iS=ic(0x1000000),iE=ic(0);ia.ZERO=iE;var iI=ic(0,!0);ia.UZERO=iI;var iw=ic(1);ia.ONE=iw;var iN=ic(1,!0);ia.UONE=iN;var iR=ic(-1);ia.NEG_ONE=iR;var iC=ig(-1,0x7fffffff,!1);ia.MAX_VALUE=iC;var iT=ig(-1,-1,!0);ia.MAX_UNSIGNED_VALUE=iT;var ix=ig(0,-0x80000000,!1);ia.MIN_VALUE=ix;var iV=ia.prototype;iV.toInt=function(){return this.unsigned?this.low>>>0:this.low},iV.toNumber=function(){return this.unsigned?(this.high>>>0)*ib+(this.low>>>0):this.high*ib+(this.low>>>0)},iV.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(!this.eq(ix))return"-"+this.neg().toString(e);else{var t=ih(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}for(var i=ih(im(e,6),this.unsigned),s=this,a="";;){var o=s.div(i),l=(s.sub(o.mul(i)).toInt()>>>0).toString(e);if((s=o).isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}},iV.getHighBits=function(){return this.high},iV.getHighBitsUnsigned=function(){return this.high>>>0},iV.getLowBits=function(){return this.low},iV.getLowBitsUnsigned=function(){return this.low>>>0},iV.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ix)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return 0!=this.high?t+33:t+1},iV.isSafeInteger=function(){var e=this.high>>21;return!e||!this.unsigned&&-1===e&&(0!==this.low||-2097152!==this.high)},iV.isZero=function(){return 0===this.high&&0===this.low},iV.eqz=iV.isZero,iV.isNegative=function(){return!this.unsigned&&this.high<0},iV.isPositive=function(){return this.unsigned||this.high>=0},iV.isOdd=function(){return(1&this.low)==1},iV.isEven=function(){return(1&this.low)==0},iV.equals=function(e){return io(e)||(e=iy(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},iV.eq=iV.equals,iV.notEquals=function(e){return!this.eq(e)},iV.neq=iV.notEquals,iV.ne=iV.notEquals,iV.lessThan=function(e){return 0>this.comp(e)},iV.lt=iV.lessThan,iV.lessThanOrEqual=function(e){return 0>=this.comp(e)},iV.lte=iV.lessThanOrEqual,iV.le=iV.lessThanOrEqual,iV.greaterThan=function(e){return this.comp(e)>0},iV.gt=iV.greaterThan,iV.greaterThanOrEqual=function(e){return this.comp(e)>=0},iV.gte=iV.greaterThanOrEqual,iV.ge=iV.greaterThanOrEqual,iV.compare=function(e){if(io(e)||(e=iy(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},iV.comp=iV.compare,iV.negate=function(){return!this.unsigned&&this.eq(ix)?ix:this.not().add(iw)},iV.neg=iV.negate,iV.add=function(e){io(e)||(e=iy(e));var t,r,n=this.high>>>16,i=65535&this.high,s=this.low>>>16,a=65535&this.low,o=e.high>>>16,l=65535&e.high,u=e.low>>>16,d=65535&e.low,c=0,h=0;return t=0+((r=0+(a+d))>>>16),r&=65535,t+=s+u,h+=t>>>16,t&=65535,h+=i+l,c+=h>>>16,h&=65535,c+=n+o,ig(t<<16|r,(c&=65535)<<16|h,this.unsigned)},iV.subtract=function(e){return io(e)||(e=iy(e)),this.add(e.neg())},iV.sub=iV.subtract,iV.multiply=function(e){if(this.isZero())return this;if(io(e)||(e=iy(e)),is)return ig(is.mul(this.low,this.high,e.low,e.high),is.get_high(),this.unsigned);if(e.isZero())return this.unsigned?iI:iE;if(this.eq(ix))return e.isOdd()?ix:iE;if(e.eq(ix))return this.isOdd()?ix:iE;if(this.isNegative())if(e.isNegative())return this.neg().mul(e.neg());else return this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(iS)&&e.lt(iS))return ih(this.toNumber()*e.toNumber(),this.unsigned);var t,r,n=this.high>>>16,i=65535&this.high,s=this.low>>>16,a=65535&this.low,o=e.high>>>16,l=65535&e.high,u=e.low>>>16,d=65535&e.low,c=0,h=0;return t=0+((r=0+a*d)>>>16),r&=65535,t+=s*d,h+=t>>>16,t&=65535,t+=a*u,h+=t>>>16,t&=65535,h+=i*d,c+=h>>>16,h&=65535,h+=s*u,c+=h>>>16,h&=65535,h+=a*l,c+=h>>>16,h&=65535,c+=n*d+i*u+s*l+a*o,ig(t<<16|r,(c&=65535)<<16|h,this.unsigned)},iV.mul=iV.multiply,iV.divide=function(e){if(io(e)||(e=iy(e)),e.isZero())throw Error("division by zero");if(is){var t,r,n;return this.unsigned||-0x80000000!==this.high||-1!==e.low||-1!==e.high?ig((this.unsigned?is.div_u:is.div_s)(this.low,this.high,e.low,e.high),is.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?iI:iE;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return iI;if(e.gt(this.shru(1)))return iN;n=iI}else{if(this.eq(ix))if(e.eq(iw)||e.eq(iR))return ix;else return e.eq(ix)?iw:(t=this.shr(1).div(e).shl(1)).eq(iE)?e.isNegative()?iw:iR:(r=this.sub(e.mul(t)),n=t.add(r.div(e)));if(e.eq(ix))return this.unsigned?iI:iE;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=iE}for(r=this;r.gte(e);){for(var i=Math.ceil(Math.log(t=Math.max(1,Math.floor(r.toNumber()/e.toNumber())))/Math.LN2),s=i<=48?1:im(2,i-48),a=ih(t),o=a.mul(e);o.isNegative()||o.gt(r);)t-=s,o=(a=ih(t,this.unsigned)).mul(e);a.isZero()&&(a=iw),n=n.add(a),r=r.sub(o)}return n},iV.div=iV.divide,iV.modulo=function(e){return(io(e)||(e=iy(e)),is)?ig((this.unsigned?is.rem_u:is.rem_s)(this.low,this.high,e.low,e.high),is.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},iV.mod=iV.modulo,iV.rem=iV.modulo,iV.not=function(){return ig(~this.low,~this.high,this.unsigned)},iV.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},iV.clz=iV.countLeadingZeros,iV.countTrailingZeros=function(){return this.low?il(this.low):il(this.high)+32},iV.ctz=iV.countTrailingZeros,iV.and=function(e){return io(e)||(e=iy(e)),ig(this.low&e.low,this.high&e.high,this.unsigned)},iV.or=function(e){return io(e)||(e=iy(e)),ig(this.low|e.low,this.high|e.high,this.unsigned)},iV.xor=function(e){return io(e)||(e=iy(e)),ig(this.low^e.low,this.high^e.high,this.unsigned)},iV.shiftLeft=function(e){return(io(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?ig(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):ig(0,this.low<<e-32,this.unsigned)},iV.shl=iV.shiftLeft,iV.shiftRight=function(e){return(io(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?ig(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):ig(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},iV.shr=iV.shiftRight,iV.shiftRightUnsigned=function(e){return(io(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?ig(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):32===e?ig(this.high,0,this.unsigned):ig(this.high>>>e-32,0,this.unsigned)},iV.shru=iV.shiftRightUnsigned,iV.shr_u=iV.shiftRightUnsigned,iV.rotateLeft=function(e){var t;return(io(e)&&(e=e.toInt()),0==(e&=63))?this:32===e?ig(this.high,this.low,this.unsigned):e<32?(t=32-e,ig(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,ig(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},iV.rotl=iV.rotateLeft,iV.rotateRight=function(e){var t;return(io(e)&&(e=e.toInt()),0==(e&=63))?this:32===e?ig(this.high,this.low,this.unsigned):e<32?(t=32-e,ig(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,ig(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},iV.rotr=iV.rotateRight,iV.toSigned=function(){return this.unsigned?ig(this.low,this.high,!1):this},iV.toUnsigned=function(){return this.unsigned?this:ig(this.low,this.high,!0)},iV.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},iV.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},iV.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},ia.fromBytes=function(e,t,r){return r?ia.fromBytesLE(e,t):ia.fromBytesBE(e,t)},ia.fromBytesLE=function(e,t){return new ia(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},ia.fromBytesBE=function(e,t){return new ia(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},"function"==typeof BigInt&&(ia.fromBigInt=function(e,t){return ig(Number(BigInt.asIntN(32,e)),Number(BigInt.asIntN(32,e>>BigInt(32))),t)},ia.fromValue=function(e,t){return"bigint"==typeof e?ia.fromBigInt(e,t):iy(e,t)},iV.toBigInt=function(){var e=BigInt(this.low>>>0);return BigInt(this.unsigned?this.high>>>0:this.high)<<BigInt(32)|e});var iD=((M={})[M.Null=0]="Null",M[M.Boolean=1]="Boolean",M[M.Integer=2]="Integer",M[M.Long=3]="Long",M[M.Double=4]="Double",M[M.String=5]="String",M[M.Bytes=6]="Bytes",M[M.Date=7]="Date",M);class ik extends n9{valueType;value;constructor(e,t){super(t),this.valueType=ik.getPrimitiveType(e),this.value=void 0===e?null:e}static of(e,t){return new ik(e,t)}static valueFromBytes(e,t){switch(e){case 0:return null;case 1:return!!t[0];case 2:return t[0]|t[1]<<8|t[2]<<16|t[3]<<24;case 4:{let e=new DataView(t.buffer);return t.forEach(function(t,r){e.setUint8(r,t)}),e.getFloat64(0,!0)}case 5:return new TextDecoder("utf-8").decode(t);case 3:return ia.fromBytesLE(Array.from(t));case 6:return t;case 7:return new Date(ia.fromBytesLE(Array.from(t),!0).toNumber());default:throw new nq(nH.ErrUnimplemented,`unimplemented type: ${e}`)}}getValueSize(){switch(this.valueType){case 0:case 3:case 4:case 7:return 8;case 1:case 2:return 4;case 5:return 2*this.value.length;case 6:return this.value.length;default:throw new nq(nH.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}getDataSize(){return{data:this.getValueSize(),meta:this.getMetaUsage()}}toJSON(){return 5===this.valueType?`"${n5(this.value)}"`:`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_PRIMITIVE"}}deepcopy(){let e=ik.of(this.value,this.getCreatedAt());return e.setMovedAt(this.getMovedAt()),e.setRemovedAt(this.getRemovedAt()),e}getType(){return this.valueType}static getPrimitiveType(e){switch(typeof e){case"undefined":return 0;case"boolean":return 1;case"number":if(this.isInteger(e))return 2;return 4;case"string":return 5;case"object":if(null===e)return 0;if(e instanceof ia)return 3;if(e instanceof Uint8Array)return 6;else if(e instanceof Date)return 7}}static isSupport(e){return void 0!==ik.getPrimitiveType(e)}static isInteger(e){return e%1==0}isNumericType(){let e=this.valueType;return 2===e||3===e||4===e}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:return new Uint8Array;case 1:return new Uint8Array(this.value?[1]:[0]);case 2:{let e=this.value;return new Uint8Array([255&e,e>>8&255,e>>16&255,e>>24&255])}case 4:{let e=this.value,t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),t}case 5:return new TextEncoder().encode(this.value);case 3:{let e=this.value.toBytesLE();return Uint8Array.from(e)}case 6:return this.value;case 7:{let e=this.value,t=ia.fromNumber(e.getTime(),!0).toBytesLE();return Uint8Array.from(t)}default:throw new nq(nH.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}}class iB extends ir{prev;next;movedFrom;constructor(e){super(e),this.value=e}static createAfter(e,t){let r=new iB(t),n=e.next;return e.next=r,r.prev=e,r.next=n,n&&(n.prev=r),r}remove(e){return this.value.remove(e)}getCreatedAt(){return this.value.getCreatedAt()}getPositionedAt(){return this.value.getPositionedAt()}release(){this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.prev=void 0,this.next=void 0}getLength(){return+!this.value.isRemoved()}getPrev(){return this.prev}getNext(){return this.next}getMovedFrom(){return this.movedFrom}setMovedFrom(e){this.movedFrom=e}getValue(){return this.value}isRemoved(){return this.value.isRemoved()}}class iW{dummyHead;last;nodeMapByIndex;nodeMapByCreatedAt;constructor(){const e=ik.of(0,n3);e.setRemovedAt(n3),this.dummyHead=new iB(e),this.last=this.dummyHead,this.nodeMapByIndex=new ii,this.nodeMapByCreatedAt=new Map,this.nodeMapByIndex.insert(this.dummyHead),this.nodeMapByCreatedAt.set(this.dummyHead.getCreatedAt().toIDString(),this.dummyHead)}static create(){return new iW}get length(){return this.nodeMapByIndex.length}findNextBeforeExecutedAt(e,t){let r=this.nodeMapByCreatedAt.get(e.toIDString());if(!r)throw new nq(nH.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);for(;r.getValue().getMovedAt()&&r.getValue().getMovedAt().after(t)&&r.getMovedFrom();)r=r.getMovedFrom();for(;r.getNext()&&r.getNext().getPositionedAt().after(t);)r=r.getNext();return r}release(e){this.last===e&&(this.last=e.getPrev()),e.release(),this.nodeMapByIndex.delete(e),this.nodeMapByCreatedAt.delete(e.getValue().getCreatedAt().toIDString())}insertAfter(e,t,r=t.getCreatedAt()){let n=this.findNextBeforeExecutedAt(e,r),i=iB.createAfter(n,t);return n===this.last&&(this.last=i),this.nodeMapByIndex.insertAfter(n,i),this.nodeMapByCreatedAt.set(i.getCreatedAt().toIDString(),i),i}moveAfter(e,t,r){let n=this.nodeMapByCreatedAt.get(e.toIDString());if(!n)throw new nq(nH.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);let i=this.nodeMapByCreatedAt.get(t.toIDString());if(!i)throw new nq(nH.ErrInvalidArgument,`cant find the given node: ${t.toIDString()}`);if(n!==i&&r.after(i.getPositionedAt())){let e=i.getPrev(),t=i.getNext();for(this.release(i),(i=this.insertAfter(n.getCreatedAt(),i.getValue(),r)).getValue().setMovedAt(r),i.setMovedFrom(e);t&&t.getPositionedAt().after(r);)n=i,t=(i=t).getNext(),this.release(i),(i=this.insertAfter(n.getCreatedAt(),i.getValue(),r)).getValue().setMovedAt(r),i.setMovedFrom(e)}}insert(e){this.insertAfter(this.last.getCreatedAt(),e)}getByID(e){return this.nodeMapByCreatedAt.get(e.toIDString())}subPathOf(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());if(t)return String(this.nodeMapByIndex.indexOf(t))}purge(e){let t=this.nodeMapByCreatedAt.get(e.getCreatedAt().toIDString());if(!t)throw new nq(nH.ErrInvalidArgument,`fail to find the given createdAt: ${e.getCreatedAt().toIDString()}`);this.release(t)}getByIndex(e){if(!(e>=this.length))return this.nodeMapByIndex.findForArray(e)}getPrevCreatedAt(e){let t=this.nodeMapByCreatedAt.get(e.toIDString());do t=t.getPrev();while(this.dummyHead!==t&&t.isRemoved())return t.getValue().getCreatedAt()}delete(e,t){let r=this.nodeMapByCreatedAt.get(e.toIDString()),n=r.isRemoved();return r.remove(t)&&!n&&this.nodeMapByIndex.splayNode(r),r.getValue()}set(e,t,r){let n=this.nodeMapByCreatedAt.get(e.toIDString());if(!n)throw new nq(nH.ErrInvalidArgument,`cant find the given node: ${e.toIDString()}`);return this.insertAfter(n.getCreatedAt(),t,r),this.delete(e,r)}deleteByIndex(e,t){let r=this.getByIndex(e);if(r)return r.remove(t)&&this.nodeMapByIndex.splayNode(r),r.getValue()}getHead(){return this.dummyHead.getValue()}getLast(){return this.last.getValue()}getLastCreatedAt(){return this.last.getCreatedAt()}toTestString(){let e=[];for(let t of this){let r=`${t.getCreatedAt().toIDString()}:${t.getValue().toJSON()}`;t.isRemoved()?e.push(`{${r}}`):e.push(`[${r}]`)}return e.join("")}*[Symbol.iterator](){let e=this.dummyHead.getNext();for(;e;)yield e,e=e.getNext()}}class iL extends n4{elements;constructor(e,t){super(e),this.elements=t}static create(e,t){if(!t)return new iL(e,iW.create());let r=iW.create();for(let e of t)r.insertAfter(r.getLastCreatedAt(),e.deepcopy());return new iL(e,r)}subPathOf(e){return this.elements.subPathOf(e)}purge(e){this.elements.purge(e)}insertAfter(e,t,r){this.elements.insertAfter(e,t,r)}moveAfter(e,t,r){this.elements.moveAfter(e,t,r)}get(e){let t=this.elements.getByIndex(e);return t?.getValue()}getByID(e){let t=this.elements.getByID(e);return t?.getValue()}getHead(){return this.elements.getHead()}getLast(){return this.elements.getLast()}getPrevCreatedAt(e){return this.elements.getPrevCreatedAt(e)}delete(e,t){return this.elements.delete(e,t)}deleteByIndex(e,t){return this.elements.deleteByIndex(e,t)}set(e,t,r){return this.elements.set(e,t,r)}getLastCreatedAt(){return this.elements.getLastCreatedAt()}get length(){return this.elements.length}*[Symbol.iterator](){for(let e of this.elements)e.isRemoved()||(yield e.getValue())}toTestString(){return this.elements.toTestString()}getDescendants(e){for(let t of this.elements){let r=t.getValue();if(e(r,this))return;r instanceof n4&&r.getDescendants(e)}}getDataSize(){return{data:0,meta:this.getMetaUsage()}}toJSON(){let e=[];for(let t of this)e.push(t.toJSON());return`[${e.join(",")}]`}toJS(){return JSON.parse(this.toJSON())}toJSForTest(){let e={};for(let t=0;t<this.length;t++){let{createdAt:r,value:n,type:i}=this.get(t).toJSForTest();e[t]={key:String(t),createdAt:r,value:n,type:i}}return{createdAt:this.getCreatedAt().toTestString(),value:e,type:"YORKIE_ARRAY"}}toSortedJSON(){return this.toJSON()}getElements(){return this.elements}deepcopy(){let e=iL.create(this.getCreatedAt());for(let t of this.elements)e.elements.insertAfter(e.getLastCreatedAt(),t.getValue().deepcopy());return e.setRemovedAt(this.getRemovedAt()),e.setMovedAt(this.getMovedAt()),e}}class iO extends it{prevCreatedAt;value;constructor(e,t,r,n){super(e,n),this.prevCreatedAt=t,this.value=r}static create(e,t,r,n){return new iO(e,t,r,n)}execute(e){let t=e.findByCreatedAt(this.getParentCreatedAt());if(!t)throw new nq(nH.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(t instanceof iL))throw new nq(nH.ErrInvalidArgument,"fail to execute, only array can execute add");let r=this.value.deepcopy();return t.insertAfter(this.prevCreatedAt,r,this.getExecutedAt()),e.registerElement(r,t),{opInfos:[{type:"add",path:e.createPath(this.getParentCreatedAt()),index:Number(t.subPathOf(this.getEffectedCreatedAt()))}],reverseOp:this.toReverseOperation()}}toReverseOperation(){return iZ.create(this.getParentCreatedAt(),this.value.getCreatedAt())}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.ADD.${this.value.toJSON()}`}getPrevCreatedAt(){return this.prevCreatedAt}getValue(){return this.value}setPrevCreatedAt(e){this.prevCreatedAt=e}}class iZ extends it{createdAt;constructor(e,t,r){super(e,r),this.createdAt=t}static create(e,t,r){return new iZ(e,t,r)}execute(e,t){let r=e.findByCreatedAt(this.getParentCreatedAt());if(!r)throw new nq(nH.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(r instanceof n4))throw new nq(nH.ErrInvalidArgument,`only object and array can execute remove: ${r}`);if(t===ie.UndoRedo){let t=r.getByID(this.createdAt);for(;t;){if(t.getRemovedAt())return;t=e.findElementPairByCreatedAt(t.getCreatedAt())?.parent}}let n=r.subPathOf(this.createdAt),i=this.toReverseOperation(r),s=r.delete(this.createdAt,this.getExecutedAt());return e.registerRemovedElement(s),{opInfos:r instanceof iL?[{type:"remove",path:e.createPath(this.getParentCreatedAt()),index:Number(n)}]:[{type:"remove",path:e.createPath(this.getParentCreatedAt()),key:n}],reverseOp:i}}toReverseOperation(e){if(e instanceof iL){let t=e.getByID(this.createdAt);if(void 0!==t){let r=e.getPrevCreatedAt(this.createdAt);return iO.create(this.getParentCreatedAt(),r,t.deepcopy())}}if(e instanceof n7){let t=e.subPathOf(this.createdAt);if(void 0!==t){let r=e.get(t);if(void 0!==r)return iF.create(t,r.deepcopy(),this.getParentCreatedAt())}}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.REMOVE.${this.createdAt.toTestString()}`}getCreatedAt(){return this.createdAt}setCreatedAt(e){this.createdAt=e}}class iF extends it{key;value;constructor(e,t,r,n){super(r,n),this.key=e,this.value=t}static create(e,t,r,n){return new iF(e,t,r,n)}execute(e,t){let r=e.findByCreatedAt(this.getParentCreatedAt());if(!r)throw new nq(nH.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(r instanceof n7))throw new nq(nH.ErrInvalidArgument,"fail to execute, only object can execute set");if(t===ie.UndoRedo){let t=r;for(;t;){if(t.getRemovedAt())return;t=e.findElementPairByCreatedAt(t.getCreatedAt())?.parent}}let n=r.get(this.key),i=this.toReverseOperation(n),s=this.value.deepcopy(),a=r.set(this.key,s,this.getExecutedAt());return t===ie.UndoRedo&&e.findByCreatedAt(s.getCreatedAt())&&e.deregisterElement(s),e.registerElement(s,r),a&&e.registerRemovedElement(a),{opInfos:[{type:"set",path:e.createPath(this.getParentCreatedAt()),key:this.key}],reverseOp:i}}toReverseOperation(e){let t=iZ.create(this.getParentCreatedAt(),this.value.getCreatedAt());return void 0===e||e.isRemoved()||(t=iF.create(this.key,e.deepcopy(),this.getParentCreatedAt())),t}getEffectedCreatedAt(){return this.value.getCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.SET.${this.key}=${this.value.toSortedJSON()}`}getKey(){return this.key}getValue(){return this.value}}class iP extends it{prevCreatedAt;createdAt;constructor(e,t,r,n){super(e,n),this.prevCreatedAt=t,this.createdAt=r}static create(e,t,r,n){return new iP(e,t,r,n)}execute(e){let t=e.findByCreatedAt(this.getParentCreatedAt());if(!t)throw new nq(nH.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(t instanceof iL))throw new nq(nH.ErrInvalidArgument,"fail to execute, only array can execute move");let r=this.toReverseOperation(t),n=Number(t.subPathOf(this.createdAt));t.moveAfter(this.prevCreatedAt,this.createdAt,this.getExecutedAt());let i=Number(t.subPathOf(this.createdAt));return{opInfos:[{type:"move",path:e.createPath(this.getParentCreatedAt()),index:i,previousIndex:n}],reverseOp:r}}toReverseOperation(e){let t=e.getPrevCreatedAt(this.createdAt);return iP.create(this.getParentCreatedAt(),t,this.createdAt)}getEffectedCreatedAt(){return this.createdAt}toTestString(){return`${this.getParentCreatedAt().toTestString()}.MOVE`}getPrevCreatedAt(){return this.prevCreatedAt}getCreatedAt(){return this.createdAt}setPrevCreatedAt(e){this.prevCreatedAt=e}setCreatedAt(e){this.createdAt=e}}let iU=(e,t)=>e===t?0:e<t?-1:1;class iG{key;value;left;right;isRed;constructor(e,t,r){this.key=e,this.value=t,this.isRed=r}}class iY{stack;constructor(e){this.stack=[],this.traverseInorder(e)}traverseInorder(e){e&&(this.traverseInorder(e.left),this.stack.push({key:e.key,value:e.value}),this.traverseInorder(e.right))}}class iK{root;comparator;counter;constructor(e){this.comparator=void 0!==e?e:iU,this.counter=0}put(e,t){return this.root=this.putInternal(e,t,this.root),this.root.isRed=!1,t}get(e){let t=this.getInternal(e,this.root);return t?t.value:void 0}remove(e){this.isRed(this.root.left)||this.isRed(this.root.right)||(this.root.isRed=!0),this.root=this.removeInternal(this.root,e),this.root&&(this.root.isRed=!1)}getIterator(){return new iY(this.root)}values(){let e=[];for(let t of this.getIterator().stack)e.push(t.value);return e}floorEntry(e){let t,r=this.root;for(;r;){let n=this.comparator(e,r.key);if(0===n)return r;n<0?r=r.left:(t=r,r=r.right)}return t}lastEntry(){if(!this.root)return this.root;let e=this.root;for(;e.right;)e=e.right;return e}size(){return this.counter}isEmpty(){return 0===this.counter}getInternal(e,t){for(;t;){let r=this.comparator(e,t.key);if(0===r)return t;r<0?t=t.left:r>0&&(t=t.right)}}putInternal(e,t,r){if(!r)return this.counter+=1,new iG(e,t,!0);let n=this.comparator(e,r.key);return n<0?r.left=this.putInternal(e,t,r.left):n>0?r.right=this.putInternal(e,t,r.right):r.value=t,this.isRed(r.right)&&!this.isRed(r.left)&&(r=this.rotateLeft(r)),this.isRed(r.left)&&this.isRed(r.left.left)&&(r=this.rotateRight(r)),this.isRed(r.left)&&this.isRed(r.right)&&this.flipColors(r),r}removeInternal(e,t){if(0>this.comparator(t,e.key))this.isRed(e.left)||this.isRed(e.left.left)||(e=this.moveRedLeft(e)),e.left=this.removeInternal(e.left,t);else{if(this.isRed(e.left)&&(e=this.rotateRight(e)),0===this.comparator(t,e.key)&&!e.right){this.counter-=1;return}if(this.isRed(e.right)||this.isRed(e.right.left)||(e=this.moveRedRight(e)),0===this.comparator(t,e.key)){this.counter-=1;let t=this.min(e.right);e.value=t.value,e.key=t.key,e.right=this.removeMin(e.right)}else e.right=this.removeInternal(e.right,t)}return this.fixUp(e)}min(e){return e.left?this.min(e.left):e}removeMin(e){if(e.left)return this.isRed(e.left)||this.isRed(e.left.left)||(e=this.moveRedLeft(e)),e.left=this.removeMin(e.left),this.fixUp(e)}fixUp(e){return this.isRed(e.right)&&(e=this.rotateLeft(e)),this.isRed(e.left)&&this.isRed(e.left.left)&&(e=this.rotateRight(e)),this.isRed(e.left)&&this.isRed(e.right)&&this.flipColors(e),e}moveRedLeft(e){return this.flipColors(e),this.isRed(e.right.left)&&(e.right=this.rotateRight(e.right),e=this.rotateLeft(e),this.flipColors(e)),e}moveRedRight(e){return this.flipColors(e),this.isRed(e.left.left)&&(e=this.rotateRight(e),this.flipColors(e)),e}isRed(e){return e&&e.isRed}rotateLeft(e){let t=e.right;return e.right=t.left,t.left=e,t.isRed=t.left.isRed,t.left.isRed=!0,t}rotateRight(e){let t=e.left;return e.left=t.right,t.right=e,t.isRed=t.right.isRed,t.right.isRed=!0,t}flipColors(e){e.isRed=!e.isRed,e.left.isRed=!e.left.isRed,e.right.isRed=!e.right.isRed}}function iM(e){return e.data+e.meta}function i_(e,...t){for(let r of t)e.data+=r.data,e.meta+=r.meta}function iX(e,t){e.data-=t.data,e.meta-=t.meta}class iJ{createdAt;offset;constructor(e,t){this.createdAt=e,this.offset=t}static of(e,t){return new iJ(e,t)}static fromStruct(e){return iJ.of(n2.fromStruct(e.createdAt),e.offset)}getCreatedAt(){return this.createdAt}getOffset(){return this.offset}equals(e){return 0===this.createdAt.compare(e.createdAt)&&this.offset===e.offset}hasSameCreatedAt(e){return 0===this.createdAt.compare(e.createdAt)}split(e){return new iJ(this.createdAt,this.offset+e)}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toTestString(){return`${this.createdAt.toTestString()}:${this.offset}`}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}}let iz=iJ.of(n3,0);class i${id;relativeOffset;constructor(e,t){this.id=e,this.relativeOffset=t}static of(e,t){return new i$(e,t)}static fromStruct(e){let t=iJ.fromStruct(e.id);return i$.of(t,e.relativeOffset)}getID(){return this.id}getRelativeOffset(){return this.relativeOffset}getAbsoluteID(){return iJ.of(this.id.getCreatedAt(),this.id.getOffset()+this.relativeOffset)}toTestString(){return`${this.id.toTestString()}:${this.relativeOffset}`}toStruct(){return{id:this.id.toStruct(),relativeOffset:this.relativeOffset}}equals(e){return!!this.id.equals(e.id)&&this.relativeOffset===e.relativeOffset}}class ij extends ir{id;removedAt;prev;next;insPrev;insNext;constructor(e,t,r){super(t),this.id=e,this.removedAt=r}static create(e,t){return new ij(e,t)}static createComparator(){return(e,t)=>{let r=e.getCreatedAt().compare(t.getCreatedAt());return 0!==r?r:e.getOffset()>t.getOffset()?1:e.getOffset()<t.getOffset()?-1:0}}getID(){return this.id}getCreatedAt(){return this.id.getCreatedAt()}getLength(){return this.removedAt?0:this.getContentLength()}getContentLength(){return this.value&&this.value.length||0}getPrev(){return this.prev}getNext(){return this.next}getInsPrev(){return this.insPrev}getInsNext(){return this.insNext}getInsPrevID(){return this.insPrev.getID()}setPrev(e){this.prev=e,e&&(e.next=this)}setNext(e){this.next=e,e&&(e.prev=this)}setInsPrev(e){this.insPrev=e,e&&(e.insNext=this)}setInsNext(e){this.insNext=e,e&&(e.insPrev=this)}hasNext(){return!!this.next}hasInsPrev(){return!!this.insPrev}isRemoved(){return!!this.removedAt}getRemovedAt(){return this.removedAt}split(e){return new ij(this.id.split(e),this.splitValue(e),this.removedAt)}canRemove(e,t,r){return!!t&&!!(!this.removedAt||!r&&e?.after(this.removedAt))}canStyle(e,t){return this.getCreatedAt().getLamport()<=t&&(!this.removedAt||e.after(this.removedAt))}setRemovedAt(e){this.removedAt=e}remove(e){if(!this.removedAt){this.removedAt=e;return}e.after(this.removedAt)&&(this.removedAt=e)}createPosRange(){return[i$.of(this.id,0),i$.of(this.id,this.getLength())]}getDataSize(){let e=this.value.getDataSize();return this.id&&(e.meta+=24),this.removedAt&&(e.meta+=24),e}deepcopy(){return new ij(this.id,this.value,this.removedAt)}toTestString(){return`${this.id.toTestString()} ${this.value?this.value:""}`}splitValue(e){let t=this.value;return this.value=t.substring(0,e),t.substring(e,t.length)}toIDString(){return this.id.toIDString()}}class iQ{head;treeByIndex;treeByID;constructor(){this.head=ij.create(iz),this.treeByIndex=new ii,this.treeByID=new iK(ij.createComparator()),this.treeByIndex.insert(this.head),this.treeByID.put(this.head.getID(),this.head)}static create(){return new iQ}edit(e,t,r,n){let i={data:0,meta:0},[s,a,o]=this.findNodeWithSplit(e[1],t),[l,u,d]=this.findNodeWithSplit(e[0],t);i_(i,a,u);let c=this.findBetween(d,o),[h,g]=this.deleteNodes(c,t,n),f=o?o.getID():s.getID(),m=i$.of(f,0);if(r){let e=this.posToIndex(l.createPosRange()[1],!0),n=this.insertAfter(l,ij.create(iJ.of(t,0),r));i_(i,n.getDataSize()),h.length&&h[h.length-1].from===e?h[h.length-1].value=r:h.push({actor:t.getActorID(),from:e,to:e,value:r}),m=i$.of(n.getID(),n.getContentLength())}let p=[],y=[];for(let[,e]of g)p.push({parent:this,child:e}),y.push(e.getValue());return[m,p,i,h,y]}indexToPos(e){let[t,r]=this.treeByIndex.findForText(e);return i$.of(t.getID(),r)}findIndexesFromRange(e){let[t,r]=e;return[this.posToIndex(t,!1),this.posToIndex(r,!0)]}posToIndex(e,t){let r=e.getAbsoluteID(),n=t?this.findFloorNodePreferToLeft(r):this.findFloorNode(r);if(!n)throw new nq(nH.ErrInvalidArgument,`the node of the given id should be found: ${r.toTestString()}`);return this.treeByIndex.indexOf(n)+(n.isRemoved()?0:r.getOffset()-n.getID().getOffset())}findNode(e){return this.findFloorNode(e)}get length(){return this.treeByIndex.length}getTreeByIndex(){return this.treeByIndex}getTreeByID(){return this.treeByID}toString(){let e=[];for(let t of this)t.isRemoved()||e.push(t.getValue());return e.join("")}*[Symbol.iterator](){let e=this.head.getNext();for(;e;)yield e,e=e.getNext()}getHead(){return this.head}deepcopy(){let e,t=new iQ,r=this.head.getNext(),n=t.head;for(;r;){if(e=t.insertAfter(n,r.deepcopy()),r.hasInsPrev()){let n=t.findNode(r.getInsPrevID());e.setInsPrev(n)}n=e,r=r.getNext()}return t}normalizePos(e){let t=this.findFloorNode(e.getID());if(!t)throw new nq(nH.ErrInvalidArgument,`the node of the given id should be found: ${e.getID().toTestString()}`);let r=e.getRelativeOffset(),n=t,i=t.getPrev();for(;i;)r+=i.getLength(),n=i,i=i.getPrev();return i$.of(n.getID(),r)}refinePos(e){let t=this.findFloorNode(e.getID());if(!t)throw new nq(nH.ErrInvalidArgument,`the node of the given id should be found: ${e.getID().toTestString()}`);let r=e.getRelativeOffset(),n=t.getContentLength();for(;r>n;){r-=n;let e=t.getNext();if(!e)return i$.of(t.getID(),n);n=(t=e).getLength()}return i$.of(t.getID(),r)}toTestString(){let e=[],t=this.head;for(;t;)t.isRemoved()?e.push(`{${t.toTestString()}}`):e.push(`[${t.toTestString()}]`),t=t.getNext();return e.join("")}insertAfter(e,t){let r=e.getNext();return t.setPrev(e),r&&r.setPrev(t),this.treeByID.put(t.getID(),t),this.treeByIndex.insertAfter(e,t),t}findNodeWithSplit(e,t){let r=e.getAbsoluteID(),n=this.findFloorNodePreferToLeft(r),i=r.getOffset()-n.getID().getOffset(),[,s]=this.splitNode(n,i);for(;n.hasNext()&&n.getNext().getCreatedAt().after(t);)n=n.getNext();return[n,s,n.getNext()]}findFloorNodePreferToLeft(e){let t=this.findFloorNode(e);if(!t)throw new nq(nH.ErrInvalidArgument,`the node of the given id should be found: ${e.toTestString()}`);if(e.getOffset()>0&&t.getID().getOffset()==e.getOffset()){if(!t.hasInsPrev())return t;t=t.getInsPrev()}return t}findFloorNode(e){let t=this.treeByID.floorEntry(e);if(t&&(t.key.equals(e)||t.key.hasSameCreatedAt(e)))return t.value}findBetween(e,t){let r=[],n=e;for(;n&&n!==t;)r.push(n),n=n.getNext();return r}splitNode(e,t){let r={data:0,meta:0};if(t>e.getContentLength())throw new nq(nH.ErrInvalidArgument,"offset should be less than or equal to length");if(0===t)return[e,r];if(t===e.getContentLength())return[e.getNext(),r];let n=e.getDataSize(),i=e.split(t);this.treeByIndex.updateWeight(i),this.insertAfter(e,i);let s=e.getInsNext();return s&&s.setInsPrev(i),i.setInsPrev(e),i_(r,e.getDataSize(),i.getDataSize()),iX(r,n),[i,r]}deleteNodes(e,t,r){if(!e.length)return[[],new Map];let n=void 0===r||0===r.size(),i=[],s=[],[a,o]=this.findEdgesOfCandidates(e);for(let o of(s.push(a),e)){let e=!1;if(n)e=!0;else{let t=r?.get(o.getCreatedAt().getActorID());t&&t>=o.getCreatedAt().getLamport()&&(e=!0)}let a=!1;if(o.getRemovedAt()){let e=r?.get(o.getRemovedAt().getActorID());n?a=!0:e&&e>=o.getRemovedAt().getLamport()&&(a=!0)}o.canRemove(t,e,a)?i.push(o):s.push(o)}s.push(o);let l=this.makeChanges(s,t),u=new Map;for(let e of i)u.set(e.getID().toIDString(),e),e.remove(t);return this.deleteIndexNodes(s),[l,u]}findEdgesOfCandidates(e){return[e[0].getPrev(),e[e.length-1].getNext()]}makeChanges(e,t){let r,n,i=[];for(let s=0;s<e.length-1;s++){let a=e[s],o=e[s+1];a.getNext()!=o&&([r]=this.findIndexesFromRange(a.getNext().createPosRange()),o?[,n]=this.findIndexesFromRange(o.getPrev().createPosRange()):n=this.treeByIndex.length,r<n&&i.push({actor:t.getActorID(),from:r,to:n}))}return i.reverse()}deleteIndexNodes(e){for(let t=0;t<e.length-1;t++){let r=e[t],n=e[t+1];r.getNext()!=n&&this.treeByIndex.deleteRange(r,n)}}purge(e){this.treeByIndex.delete(e),this.treeByID.remove(e.getID());let t=e.getPrev(),r=e.getNext(),n=e.getInsPrev(),i=e.getInsNext();t&&t.setNext(r),r&&r.setPrev(t),e.setPrev(void 0),e.setNext(void 0),n&&n.setInsNext(i),i&&i.setInsPrev(n),e.setInsPrev(void 0),e.setInsNext(void 0)}}class iH{key;value;updatedAt;_isRemoved;constructor(e,t,r,n){this.key=e,this.value=t,this.updatedAt=r,this._isRemoved=n}static of(e,t,r,n){return new iH(e,t,r,n)}getKey(){return this.key}getValue(){return this.value}getUpdatedAt(){return this.updatedAt}isRemoved(){return this._isRemoved}toIDString(){return`${this.updatedAt.toIDString()}:${this.key}`}getRemovedAt(){if(this._isRemoved)return this.updatedAt}getDataSize(){return{data:(this.key.length+this.value.length)*2,meta:24}}}class iq{nodeMapByKey;numberOfRemovedElement;constructor(){this.nodeMapByKey=new Map,this.numberOfRemovedElement=0}static create(){return new iq}getNodeMapByKey(){return this.nodeMapByKey}set(e,t,r){let n=this.nodeMapByKey.get(e);if(n&&n.isRemoved()&&r.after(n.getUpdatedAt())&&(this.numberOfRemovedElement-=1),void 0===n||r.after(n.getUpdatedAt())){let i=iH.of(e,t,r,!1);return(this.nodeMapByKey.set(e,i),void 0!==n&&n.isRemoved())?[n,i]:[void 0,i]}return n.isRemoved()?[n,void 0]:[void 0,void 0]}setInternal(e,t,r,n){let i=iH.of(e,t,r,n);this.nodeMapByKey.set(e,i),n&&this.numberOfRemovedElement++}remove(e,t){let r=this.nodeMapByKey.get(e),n=[];if(void 0===r||t.after(r.getUpdatedAt())){if(void 0===r){this.numberOfRemovedElement+=1;let r=iH.of(e,"",t,!0);return this.nodeMapByKey.set(e,r),n.push(r),n}let i=r.isRemoved();i||(this.numberOfRemovedElement+=1),i&&n.push(r);let s=iH.of(e,r.getValue(),t,!0);this.nodeMapByKey.set(e,s),n.push(s)}return n}has(e){if(this.nodeMapByKey.has(e)){let t=this.nodeMapByKey.get(e);return void 0!==t&&!t.isRemoved()}return!1}get(e){if(this.nodeMapByKey.has(e))return this.nodeMapByKey.get(e).getValue()}deepcopy(){let e=new iq;for(let[,t]of this.nodeMapByKey)e.setInternal(t.getKey(),t.getValue(),t.getUpdatedAt(),t.isRemoved());return e}toJSON(){if(!this.size())return"{}";let e=[];for(let[t,r]of this.nodeMapByKey)r.isRemoved()||e.push(`"${n5(t)}":"${n5(r.getValue())}"`);return`{${e.join(",")}}`}size(){return this.nodeMapByKey.size-this.numberOfRemovedElement}toObject(){let e={};for(let[t,r]of this.nodeMapByKey)r.isRemoved()||(e[t]=r.getValue());return e}*[Symbol.iterator](){for(let[,e]of this.nodeMapByKey)yield e}purge(e){let t=this.nodeMapByKey.get(e.getKey());void 0!=t&&t.toIDString()==e.toIDString()&&(this.nodeMapByKey.delete(e.getKey()),this.numberOfRemovedElement--)}}function i0(e){return e instanceof Map?new Map(JSON.parse(JSON.stringify(Array.from(e)))):JSON.parse(JSON.stringify(e))}let i1=e=>!e||0===Object.entries(e).length,i2=e=>{let t={};for(let[r,n]of Object.entries(e))t[r]=JSON.stringify(n);return t},i3=e=>{let t={};for(let[r,n]of Object.entries(e))t[r]=JSON.parse(n);return t};var i5=((_=i5||{}).Content="content",_.Style="style",_);class i9{attributes;content;constructor(e){this.attributes=iq.create(),this.content=e}static create(e){return new i9(e)}get length(){return this.content.length}substring(e,t){let r=new i9(this.content.substring(e,t));return r.attributes=this.attributes.deepcopy(),r}setAttr(e,t,r){return this.attributes.set(e,t,r)}getAttrs(){return this.attributes}toString(){return this.content}getDataSize(){let e={data:0,meta:0};for(let t of(e.data+=2*this.content.length,this.attributes)){let r=t.getDataSize();e.meta+=r.meta,e.data+=r.data}return e}toJSON(){let e=n5(this.content),t=this.attributes.toObject(),r=[];for(let[e,n]of Object.entries(t)){let t=JSON.parse(n),i="string"==typeof t?`"${n5(e)}":"${n5(t)}"`:`"${n5(e)}":${String(t)}`;r.push(i)}return(r.sort(),0===r.length)?`{"val":"${e}"}`:`{"attrs":{${r.join(",")}},"val":"${e}"}`}getAttributes(){return this.attributes.toObject()}getContent(){return this.content}purge(e){this.attributes&&e instanceof iH&&this.attributes.purge(e)}getGCPairs(){let e=[];for(let t of this.attributes)t.getRemovedAt()&&e.push({parent:this,child:t});return e}}class i4 extends n9{rgaTreeSplit;constructor(e,t){super(t),this.rgaTreeSplit=e}static create(e,t){return new i4(e,t)}edit(e,t,r,n,i){let s=t?i9.create(t):void 0;if(s&&n)for(let[e,t]of Object.entries(n))s.setAttr(e,t,r);let[a,o,l,u,d]=this.rgaTreeSplit.edit(e,r,s,i);return[u.map(e=>({...e,value:e.value?{attributes:i3(e.value.getAttributes()),content:e.value.getContent()}:{attributes:void 0,content:""},type:"content"})),o,l,[a,a],d]}setStyle(e,t,r,n){let i={data:0,meta:0},[,s,a]=this.rgaTreeSplit.findNodeWithSplit(e[1],r),[,o,l]=this.rgaTreeSplit.findNodeWithSplit(e[0],r);i_(i,s,o);let u=[],d=this.rgaTreeSplit.findBetween(l,a),c=[];for(let e of d){let t=e.getCreatedAt().getActorID(),i=0x7fffffffffffffffn;void 0!=n&&(i=n.get(t)?n.get(t):0n),e.canStyle(r,i)&&c.push(e)}let h=new Map,g=[],f=!1,m=[];for(let e of c){if(e.isRemoved())continue;if(!f){for(let r of Object.keys(t)){let t=e.getValue().getAttrs();t.has(r)?h.set(r,t.get(r)):g.push(r)}f=!0}let[n,s]=this.rgaTreeSplit.findIndexesFromRange(e.createPosRange());for(let[a,o]of(u.push({type:"style",actor:r.getActorID(),from:n,to:s,value:{attributes:i3(t)}}),Object.entries(t))){let[t]=e.getValue().setAttr(a,o,r);void 0!==t&&m.push({parent:e.getValue(),child:t});let n=e.getValue().getAttrs().getNodeMapByKey().get(a);void 0!==n&&i_(i,n.getDataSize())}}return[m,i,u,h,g]}removeStyle(e,t,r,n){let i={data:0,meta:0},[,s,a]=this.rgaTreeSplit.findNodeWithSplit(e[1],r),[,o,l]=this.rgaTreeSplit.findNodeWithSplit(e[0],r);i_(i,s,o);let u=[],d=this.rgaTreeSplit.findBetween(l,a),c=[];for(let e of d){let t=e.getCreatedAt().getActorID(),i=0x7fffffffffffffffn;void 0!=n&&(i=n.get(t)?n.get(t):0n),e.canStyle(r,i)&&c.push(e)}let h=new Map,g=!1,f=[];for(let e of c){if(e.isRemoved())continue;if(!g){for(let r of t){let t=e.getValue().getAttrs();t.has(r)&&h.set(r,t.get(r))}g=!0}let[n,s]=this.rgaTreeSplit.findIndexesFromRange(e.createPosRange());for(let a of(u.push({type:"style",actor:r.getActorID(),from:n,to:s,value:{attributes:{}}}),t))for(let t of e.getValue().getAttrs().remove(a,r))f.push({parent:e.getValue(),child:t}),i_(i,t.getDataSize())}return[f,i,u,h]}indexRangeToPosRange(e,t){let r=this.rgaTreeSplit.indexToPos(e);return e===t?[r,r]:[r,this.rgaTreeSplit.indexToPos(t)]}get length(){return this.rgaTreeSplit.length}getTreeByIndex(){return this.rgaTreeSplit.getTreeByIndex()}getTreeByID(){return this.rgaTreeSplit.getTreeByID()}refinePos(e){return this.rgaTreeSplit.refinePos(e)}normalizePos(e){return this.rgaTreeSplit.normalizePos(e)}getDataSize(){let e={data:0,meta:0};for(let t of this.rgaTreeSplit){if(t.isRemoved())continue;let r=t.getDataSize();e.data+=r.data,e.meta+=r.meta}return{data:e.data,meta:e.meta+this.getMetaUsage()}}toJSON(){let e=[];for(let t of this.rgaTreeSplit)t.isRemoved()||e.push(t.getValue().toJSON());return`[${e.join(",")}]`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TEXT"}}toString(){return this.rgaTreeSplit.toString()}values(){let e=[];for(let t of this.rgaTreeSplit)if(!t.isRemoved()){let r=t.getValue();e.push({attributes:i3(r.getAttributes()),content:r.getContent()})}return e}getRGATreeSplit(){return this.rgaTreeSplit}toTestString(){return this.rgaTreeSplit.toTestString()}deepcopy(){let e=new i4(this.rgaTreeSplit.deepcopy(),this.getCreatedAt());return e.setRemovedAt(this.getRemovedAt()),e.setMovedAt(this.getMovedAt()),e}findIndexesFromRange(e){return this.rgaTreeSplit.findIndexesFromRange(e)}posToIndex(e,t=!1){return this.rgaTreeSplit.posToIndex(e,t)}getGCPairs(){let e=[];for(let t of this.rgaTreeSplit)for(let r of(t.getRemovedAt()&&e.push({parent:this.rgaTreeSplit,child:t}),t.getValue().getGCPairs()))e.push(r);return e}}class i6 extends it{fromPos;toPos;content;attributes;isUndoOp;constructor(e,t,r,n,i,s,a){super(e,s),this.fromPos=t,this.toPos=r,this.content=n,this.attributes=i,this.isUndoOp=a}static create(e,t,r,n,i,s,a){return new i6(e,t,r,n,i,s,a)}execute(e,t,r){let n=e.findByCreatedAt(this.getParentCreatedAt());if(!n)throw new nq(nH.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(n instanceof i4))throw new nq(nH.ErrInvalidArgument,"fail to execute, only Text can execute edit");this.isUndoOp&&(this.fromPos=n.refinePos(this.fromPos),this.toPos=n.refinePos(this.toPos));let[i,s,a,,o]=n.edit([this.fromPos,this.toPos],this.content,this.getExecutedAt(),Object.fromEntries(this.attributes),r),l=this.toReverseOperation(o,n.normalizePos(this.fromPos));for(let t of(e.acc(a),s))e.registerGCPair(t);return{opInfos:i.map(({from:t,to:r,value:n})=>({type:"edit",from:t,to:r,value:n,path:e.createPath(this.getParentCreatedAt())})),reverseOp:l}}toReverseOperation(e,t){let r,n=e?.length?e.map(e=>e.getContent()).join(""):"";if(1===e.length){let t=e[0].getAttributes();t&&(r=Array.from(Object.entries(t)))}return i6.create(this.getParentCreatedAt(),t,i$.of(t.getID(),t.getRelativeOffset()+(this.content?.length??0)),n,r?new Map(r):new Map,void 0,!0)}normalizePos(e){let t=e.findByCreatedAt(this.getParentCreatedAt());if(!t)throw new nq(nH.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(t instanceof i4))throw new nq(nH.ErrInvalidArgument,"only Text can normalize edit");return[t.normalizePos(this.fromPos).getRelativeOffset(),t.normalizePos(this.toPos).getRelativeOffset()]}reconcileOperation(e,t,r){if(!this.isUndoOp||e>t)return;let n=t-e,i=this.fromPos.getRelativeOffset(),s=this.toPos.getRelativeOffset(),a=(e,t)=>{this.fromPos=i$.of(this.fromPos.getID(),Math.max(0,e)),this.toPos=i$.of(this.toPos.getID(),Math.max(0,t))};if(t<=i)return void a(i-n+r,s-n+r);if(!(s<=e)){if(e<=i&&s<=t&&e!==t)return void a(e,e);if(i<=e&&t<=s&&i!==s)return void a(i,s-n+r);if(e<i&&i<t&&t<s)return void a(e,e+(s-t));if(i<e&&e<s&&s<t)return void a(i,e)}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){let e=this.getParentCreatedAt().toTestString(),t=this.fromPos.toTestString(),r=this.toPos.toTestString(),n=this.content;return`${e}.EDIT(${t},${r},${n})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContent(){return this.content}getAttributes(){return this.attributes||new Map}}class i8 extends it{fromPos;toPos;attributes;attributesToRemove;constructor(e,t,r,n,i,s){super(e,s),this.fromPos=t,this.toPos=r,this.attributes=n,this.attributesToRemove=i}static create(e,t,r,n,i){return new i8(e,t,r,n,[],i)}static createRemoveStyleOperation(e,t,r,n,i){return new i8(e,t,r,new Map,n,i)}execute(e,t,r){let n,i=e.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new nq(nH.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof i4))throw new nq(nH.ErrInvalidArgument,"fail to execute, only Text can execute edit");let s=[],a=[],o={data:0,meta:0},l=new Map,u=[];if(this.attributesToRemove.length>0){let[e,t,n,u]=i.removeStyle([this.fromPos,this.toPos],this.attributesToRemove,this.getExecutedAt(),r);for(let[r,i]of(o={data:o.data+t.data,meta:o.meta+t.meta},s.push(...e),a.push(...n),u))l.set(r,i)}if(this.attributes.size>0){let[e,t,n,d,c]=i.setStyle([this.fromPos,this.toPos],Object.fromEntries(this.attributes),this.getExecutedAt(),r);for(let[r,i]of(o={data:o.data+t.data,meta:o.meta+t.meta},s.push(...e),a.push(...n),d))l.set(r,i);u.push(...c)}for(let t of(e.acc(o),s))e.registerGCPair(t);return(l.size>0||u.length>0)&&(n=l.size>0&&u.length>0?new i8(this.getParentCreatedAt(),this.fromPos,this.toPos,l,u):u.length>0?i8.createRemoveStyleOperation(this.getParentCreatedAt(),this.fromPos,this.toPos,u):i8.create(this.getParentCreatedAt(),this.fromPos,this.toPos,l)),{opInfos:a.map(({from:t,to:r,value:n})=>({type:"style",from:t,to:r,value:n,path:e.createPath(this.getParentCreatedAt())})),reverseOp:n}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){let e=this.getParentCreatedAt().toTestString(),t=this.fromPos.toTestString(),r=this.toPos.toTestString(),n=this.attributes;return`${e}.STYL(${t},${r},${JSON.stringify(n)})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getAttributesToRemove(){return this.attributesToRemove}}let i7="text";function se(e,t,r=!1){let n=0,i=r?e.allChildren:e.children;for(let e=0;e<t;e++){let t=i[e];t&&(r||!t.isRemoved)&&(n+=t.paddedSize(r))}return n}class st{type;parent;_children;visibleSize;totalSize;constructor(e,t=[]){if(this.type=e,this.visibleSize=0,this.totalSize=0,this._children=t,this.isText&&this._children.length>0)throw new nq(nH.ErrRefused,"Text node cannot have children")}updateAncestorsSize(e,t=!1){let r=this.parent;for(;r;){if(t)r.totalSize+=e;else if(r.visibleSize+=e,r.isRemoved)break;r=r.parent}}updateDescendantsSize(e=!1){let t=0;for(let r of this._children){let n=r.updateDescendantsSize(e);(e||!r.isRemoved)&&(t+=n)}return e?this.totalSize+=t:this.visibleSize+=t,this.paddedSize(e)}get isText(){return this.type===i7}paddedSize(e=!1){let t=this.visibleSize;return e&&(t=this.totalSize),this.isText||(t+=2),t}isAncestorOf(e){var t=this,r=e;if(t===r)return!1;for(;r.parent;){if(r.parent===t)return!0;r=r.parent}return!1}get nextSibling(){let e=this.parent.findOffset(this),t=this.parent.children[e+1];if(t)return t}get prevSibling(){let e=this.parent.findOffset(this),t=this.parent.children[e-1];if(t)return t}splitText(e,t){let r={data:0,meta:0};if(0===e||e===this.visibleSize)return[void 0,r];let n=this.value.slice(0,e),i=this.value.slice(e);if(!i.length)return[void 0,r];let s=this.getDataSize();this.value=n;let a=this.cloneText(e+t);return a.value=i,this.parent.insertAfterInternal(a,this),i_(r,this.getDataSize(),a.getDataSize()),iX(r,s),[a,r]}get children(){return this._children.filter(e=>!e.isRemoved)}get allChildren(){return[...this._children]}hasTextChild(){return this.children.length>0&&this.children.every(e=>e.isText)}getChildrenText(){return this.isText?this.value:this.hasTextChild()?this.children.map(e=>e.value).join(""):""}append(...e){if(this.isText)throw new nq(nH.ErrRefused,"Text node cannot have children");for(let t of(this._children.push(...e),e))t.parent=this,t.updateAncestorsSize(t.paddedSize()),t.updateAncestorsSize(t.paddedSize(!0),!0)}prepend(...e){if(this.isText)throw new nq(nH.ErrRefused,"Text node cannot have children");for(let t of(this._children.unshift(...e),e))t.parent=this}insertBefore(e,t){if(this.isText)throw new nq(nH.ErrRefused,"Text node cannot have children");let r=this._children.indexOf(t);if(-1===r)throw new nq(nH.ErrInvalidArgument,"child not found");this.insertAtInternal(e,r),e.updateAncestorsSize(e.paddedSize()),e.updateAncestorsSize(e.paddedSize(!0),!0)}insertAfter(e,t){if(this.isText)throw new nq(nH.ErrRefused,"Text node cannot have children");let r=this._children.indexOf(t);if(-1===r)throw new nq(nH.ErrInvalidArgument,"child not found");this.insertAtInternal(e,r+1),e.updateAncestorsSize(e.paddedSize()),e.updateAncestorsSize(e.paddedSize(!0),!0)}insertAt(e,t){if(this.isText)throw new nq(nH.ErrRefused,"Text node cannot have children");this.insertAtInternal(e,t),e.updateAncestorsSize(e.paddedSize()),e.updateAncestorsSize(e.paddedSize(!0),!0)}removeChild(e){if(this.isText)throw new nq(nH.ErrRefused,"Text node cannot have children");let t=this._children.indexOf(e);if(-1===t)throw new nq(nH.ErrInvalidArgument,"child not found");this._children.splice(t,1),e.updateAncestorsSize(-e.paddedSize(!0),!0),e.parent=void 0}splitElement(e,t){let r={data:0,meta:0},n=this.getDataSize(),i=this.cloneElement(t);this.parent.insertAfterInternal(i,this),i.updateAncestorsSize(i.paddedSize()),i.updateAncestorsSize(i.paddedSize(!0),!0);let s=this.children.slice(0,e),a=this.children.slice(e);for(let e of(this._children=s,i._children=a,this.visibleSize=this._children.reduce((e,t)=>e+t.paddedSize(),0),this.totalSize=this._children.reduce((e,t)=>e+t.paddedSize(!0),0),i.visibleSize=i._children.reduce((e,t)=>e+t.paddedSize(!0),0),i.totalSize=i._children.reduce((e,t)=>e+t.paddedSize(!0),0),i._children))e.parent=i;return i_(r,this.getDataSize(),i.getDataSize()),iX(r,n),[i,r]}insertAfterInternal(e,t){if(this.isText)throw new nq(nH.ErrRefused,"Text node cannot have children");let r=this._children.indexOf(t);if(-1===r)throw new nq(nH.ErrInvalidArgument,"child not found");this.insertAtInternal(e,r+1)}insertAtInternal(e,t){if(this.isText)throw new nq(nH.ErrRefused,"Text node cannot have children");this._children.splice(t,0,e),e.parent=this}findOffset(e,t=!1){if(this.isText)throw new nq(nH.ErrRefused,"Text node cannot have children");if(t)return this._children.indexOf(e);if(e.isRemoved){let t=this._children.indexOf(e);return this.allChildren.splice(0,t).filter(e=>!e.isRemoved).length}return this.children.indexOf(e)}findBranchOffset(e){if(this.isText)throw new nq(nH.ErrRefused,"Text node cannot have children");let t=e;for(;t;){let e=this._children.indexOf(t);if(-1!==e)return e;t=t.parent}return -1}}var sr=((X={}).Start="Start",X.End="End",X.Text="Text",X);function sn(e,t,r=0){for(let n of e._children)sn(n,t,r+1);t(e,r)}class si{root;constructor(e){this.root=e}tokensBetween(e,t,r,n=!1){!function e(t,r,n,i,s=!1){if(r>n)throw new nq(nH.ErrInvalidArgument,`from is greater than to: ${r} > ${n}`);let a=s?t.totalSize:t.visibleSize;if(r>a)throw new nq(nH.ErrInvalidArgument,`from is out of range: ${r} > ${a}`);if(n>a)throw new nq(nH.ErrInvalidArgument,`to is out of range: ${n} > ${a}`);if(r===n)return;let o=0;for(let a of s?t._children:t.children){if(r-a.paddedSize(s)<o&&o<n){let t=a.isText?r-o:r-o-1,l=a.isText?n-o:n-o-1,u=s?a.totalSize:a.visibleSize,d=!a.isText&&t<0,c=!a.isText&&l>u;(a.isText||d)&&i([a,a.isText?"Text":"Start"],c),e(a,Math.max(0,t),Math.min(l,u),i,s),c&&i([a,"End"],c)}o+=a.paddedSize(s)}}(this.root,e,t,r,n)}traverse(e){!function e(t,r,n=0){for(let i of t.children)e(i,r,n+1);r(t,n)}(this.root,e,0)}traverseAll(e){sn(this.root,e,0)}findTreePos(e,t=!0){return function e(t,r,n=!0){if(r>t.visibleSize)throw new nq(nH.ErrInvalidArgument,`index is out of range: ${r} > ${t.visibleSize}`);if(t.isText)return{node:t,offset:r};let i=0,s=0;for(let a of t.children){if(n&&a.isText&&a.visibleSize>=r-s)return e(a,r-s,n);if(r===s)break;if(!n&&a.paddedSize()===r-s)return{node:t,offset:i+1};if(a.paddedSize()>r-s)return e(a,r-s-1,n);s+=a.paddedSize(),i+=1}return{node:t,offset:i}}(this.root,e,t)}treePosToPath(e){let t=[],r=e.node;if(r.isText){let n=r.parent.findOffset(r);if(-1===n)throw new nq(nH.ErrInvalidArgument,"invalid treePos");let i=se(r.parent,n);t.push(i+e.offset),r=r.parent}else if(r.hasTextChild()){let n=se(r,e.offset);t.push(n)}else t.push(e.offset);for(;r.parent;){let e=r.parent.findOffset(r);if(-1===e)throw new nq(nH.ErrInvalidArgument,"invalid treePos");t.push(e),r=r.parent}return t.reverse()}pathToIndex(e){let t=this.pathToTreePos(e);return this.indexOf(t)}pathToTreePos(e){if(!e.length)throw new nq(nH.ErrInvalidArgument,"unacceptable path");let t=this.root;for(let r=0;r<e.length-1;r++){let n=e[r];if(!(t=t.children[n]))throw new nq(nH.ErrInvalidArgument,"unacceptable path")}if(t.hasTextChild()){var r=t,n=e[e.length-1];if(r.visibleSize<n)throw new nq(nH.ErrInvalidArgument,"unacceptable path");for(let e=0;e<r.children.length;e++){let t=r.children[e];if(t.visibleSize<n)n-=t.visibleSize;else{r=t;break}}return{node:r,offset:n}}if(t.children.length<e[e.length-1])throw new nq(nH.ErrInvalidArgument,"unacceptable path");return{node:t,offset:e[e.length-1]}}getRoot(){return this.root}get size(){return this.root.visibleSize}findPostorderRight(e){let{node:t,offset:r}=e;if(t.isText){if(t.visibleSize===r){let e=t.nextSibling;return e||t.parent}return t}return t.children.length===r?t:function e(t){return t.isText||0===t.children.length?t:e(t.children[0])}(t.children[r])}indexOf(e,t=!1){let{node:r}=e,{offset:n}=e,i=0,s=1;if(r.isText){i+=n;let e=r.parent,s=e.findOffset(r,t);if(-1===s)throw new nq(nH.ErrInvalidArgument,"invalid pos");i+=se(e,s,t),r=r.parent}else i+=se(r,n,t);for(;r?.parent;){let e=r.parent,n=e.findOffset(r,t);if(-1===n)throw new nq(nH.ErrInvalidArgument,"invalid pos");i+=se(e,n,t),s++,r=r.parent}return i+s-1}indexToPath(e){let t=this.findTreePos(e);return this.treePosToPath(t)}}(J={}).Content="content",J.Style="style",J.RemoveStyle="removeStyle";class ss{parentID;leftSiblingID;constructor(e,t){this.parentID=e,this.leftSiblingID=t}static of(e,t){return new ss(e,t)}static fromTreePos(e){let t,{offset:r}=e,{node:n}=e;return n.isText?(t=n.parent.children[0]===n&&0===r?n.parent:n,n=n.parent):t=0===r?n:n.children[r-1],ss.of(n.id,sa.of(t.getCreatedAt(),t.getOffset()+r))}getParentID(){return this.parentID}static fromStruct(e){return ss.of(sa.of(n2.fromStruct(e.parentID.createdAt),e.parentID.offset),sa.of(n2.fromStruct(e.leftSiblingID.createdAt),e.leftSiblingID.offset))}toStruct(){return{parentID:{createdAt:this.getParentID().getCreatedAt().toStruct(),offset:this.getParentID().getOffset()},leftSiblingID:{createdAt:this.getLeftSiblingID().getCreatedAt().toStruct(),offset:this.getLeftSiblingID().getOffset()}}}toTreeNodePair(e){let t=this.getParentID(),r=this.getLeftSiblingID(),n=e.findFloorNode(t),i=e.findFloorNode(r);if(!n||!i)throw new nq(nH.ErrRefused,`cannot find node of CRDTTreePos(${t.toTestString()}, ${r.toTestString()})`);return!r.equals(t)&&r.getOffset()>0&&r.getOffset()===i.id.getOffset()&&i.insPrevID&&(i=e.findFloorNode(i.insPrevID)),[n,i]}getLeftSiblingID(){return this.leftSiblingID}equals(e){return this.getParentID().getCreatedAt().equals(e.getParentID().getCreatedAt())&&this.getParentID().getOffset()===e.getParentID().getOffset()&&this.getLeftSiblingID().getCreatedAt().equals(e.getLeftSiblingID().getCreatedAt())&&this.getLeftSiblingID().getOffset()===e.getLeftSiblingID().getOffset()}}class sa{createdAt;offset;constructor(e,t){this.createdAt=e,this.offset=t}static of(e,t){return new sa(e,t)}static fromStruct(e){return sa.of(n2.fromStruct(e.createdAt),e.offset)}static createComparator(){return(e,t)=>{let r=e.getCreatedAt().compare(t.getCreatedAt());return 0!==r?r:e.getOffset()>t.getOffset()?1:e.getOffset()<t.getOffset()?-1:0}}getCreatedAt(){return this.createdAt}equals(e){return 0===this.createdAt.compare(e.createdAt)&&this.offset===e.offset}getOffset(){return this.offset}setOffset(e){this.offset=e}toStruct(){return{createdAt:this.createdAt.toStruct(),offset:this.offset}}toIDString(){return`${this.createdAt.toIDString()}:${this.offset}`}toTestString(){return`${this.createdAt.toTestString()}/${this.offset}`}}class so extends st{id;removedAt;attrs;insPrevID;insNextID;_value="";constructor(e,t,r,n,i){super(t),this.id=e,this.removedAt=i,n&&(this.attrs=n),"string"==typeof r?this.value=r:Array.isArray(r)&&(this._children=r)}toIDString(){return this.id.toIDString()}getRemovedAt(){return this.removedAt}static create(e,t,r,n){return new so(e,t,r,n)}deepcopy(){let e=new so(this.id,this.type);return e.removedAt=this.removedAt,e._value=this._value,e.visibleSize=this.visibleSize,e.totalSize=this.totalSize,e.attrs=this.attrs?.deepcopy(),e._children=this._children.map(t=>{let r=t.deepcopy();return r.parent=e,r}),e.insPrevID=this.insPrevID,e.insNextID=this.insNextID,e}get value(){if(!this.isText)throw new nq(nH.ErrInvalidType,`cannot get value of element node: ${this.type}`);return this._value}set value(e){if(!this.isText)throw new nq(nH.ErrInvalidType,`cannot set value of element node: ${this.type}`);this._value=e,this.visibleSize=e.length,this.totalSize=e.length}get isRemoved(){return!!this.removedAt}remove(e){return this.removedAt?(e.after(this.removedAt)&&(this.removedAt=e),!1):(this.removedAt=e,this.updateAncestorsSize(-this.paddedSize()),!0)}cloneText(e){return new so(sa.of(this.id.getCreatedAt(),e),this.type,void 0,void 0,this.removedAt)}cloneElement(e){return new so(sa.of(e(),0),this.type,void 0,void 0,this.removedAt)}split(e,t,r){let[n,i]=this.isText?this.splitText(t,this.id.getOffset()):this.splitElement(t,r);return n&&(n.insPrevID=this.id,this.insNextID&&(e.findFloorNode(this.insNextID).insPrevID=n.id,n.insNextID=this.insNextID),this.insNextID=n.id,e.registerNode(n)),[n,i]}getCreatedAt(){return this.id.getCreatedAt()}getOffset(){return this.id.getOffset()}canDelete(e,t,r){return!!t&&!!(!this.removedAt||!r&&e?.after(this.removedAt))}canStyle(e,t){return!this.isText&&this.getCreatedAt().getLamport()<=t&&(!this.removedAt||e.after(this.removedAt))}setAttrs(e,t){this.attrs||(this.attrs=new iq);let r=[];for(let[n,i]of Object.entries(e))r.push(this.attrs.set(n,i,t));return r}purge(e){this.attrs&&this.attrs.purge(e)}getDataSize(){let e={data:0,meta:0};if(this.isText&&(e.data+=2*this.visibleSize),this.id&&(e.meta+=24),this.removedAt&&(e.meta+=24),this.attrs)for(let t of this.attrs){if(t.getRemovedAt())continue;let r=t.getDataSize();e.meta+=r.meta,e.data+=r.data}return e}getGCPairs(){let e=[];if(!this.attrs)return e;for(let t of this.attrs)t.getRemovedAt()&&e.push({parent:this,child:t});return e}}function sl(e){if(e.isText)return{type:e.type,value:e.value};let t={type:e.type,children:e.children.map(sl)};return e.attrs&&(t.attributes=i3(e.attrs?.toObject())),t}function su(e){if(e.isText)return e.value;let t="";return e.attrs&&e.attrs.size()&&(t=" "+Array.from(e.attrs).filter(e=>!e.isRemoved()).sort((e,t)=>e.getKey().localeCompare(t.getKey())).map(e=>{let t=JSON.parse(e.getValue());return"string"==typeof t?`${e.getKey()}="${t}"`:`${e.getKey()}="${n5(e.getValue())}"`}).join(" ")),`<${e.type}${t}>${e.children.map(e=>su(e)).join("")}</${e.type}>`}class sd extends n9{indexTree;nodeMapByID;constructor(e,t){super(t),this.indexTree=new si(e),this.nodeMapByID=new iK(sa.createComparator()),this.indexTree.traverseAll(e=>{this.nodeMapByID.put(e.id,e)})}static create(e,t){return new sd(e,t)}findFloorNode(e){let t=this.nodeMapByID.floorEntry(e);if(t&&t.key.getCreatedAt().equals(e.getCreatedAt()))return t.value}registerNode(e){this.nodeMapByID.put(e.id,e)}findNodesAndSplitText(e,t){let r={data:0,meta:0},[n,i]=e.toTreeNodePair(this),s=i,a=n===s,o=s.parent&&!a?s.parent:n;if(s.isText){let[,t]=s.split(this,e.getLeftSiblingID().getOffset()-s.id.getOffset());r=t}if(t){let e=o.allChildren,r=a?0:e.indexOf(s)+1;for(let n=r;n<e.length;n++){let r=e[n];if(!r.id.getCreatedAt().after(t))break;s=r}}return[[o,s],r]}style(e,t,r,n){let i={data:0,meta:0},[[s,a],o]=this.findNodesAndSplitText(e[0],r),[[l,u],d]=this.findNodesAndSplitText(e[1],r);i_(i,d,o);let c=[],h=t?i3(t):{},g=[];return this.traverseInPosRange(s,a,l,u,([e,s])=>{let a=e.getCreatedAt().getActorID(),o=0x7fffffffffffffffn;if(void 0!=n&&(o=n.get(a)?n.get(a):0n),e.canStyle(r,o)&&t){let n=e.setAttrs(t,r),a=n.reduce((e,[,t])=>(t&&(e[t.getKey()]=h[t.getKey()]),e),{}),o=e.parent,l=e.prevSibling||e.parent;for(let[t]of(Object.keys(a).length>0&&c.push({type:"style",from:this.toIndex(o,l),to:this.toIndex(e,e),fromPath:this.toPath(o,l),toPath:this.toPath(e,e),actor:r.getActorID(),value:a}),n))t&&g.push({parent:e,child:t});for(let[t]of Object.entries(h)){let r=e.attrs?.getNodeMapByKey().get(t);void 0!==r&&s!==sr.End&&i_(i,r.getDataSize())}}}),[g,c,i]}removeStyle(e,t,r,n){let i={data:0,meta:0},[[s,a],o]=this.findNodesAndSplitText(e[0],r),[[l,u],d]=this.findNodesAndSplitText(e[1],r);i_(i,d,o);let c=[],h=[];return this.traverseInPosRange(s,a,l,u,([e])=>{let i=e.getCreatedAt().getActorID(),s=0x7fffffffffffffffn;if(void 0!=n&&(s=n.get(i)?n.get(i):0n),e.canStyle(r,s)&&t){for(let n of(e.attrs||(e.attrs=new iq),t))for(let t of e.attrs.remove(n,r))h.push({parent:e,child:t});let n=e.parent,i=e.prevSibling||e.parent;c.push({actor:r.getActorID(),type:"removeStyle",from:this.toIndex(n,i),to:this.toIndex(e,e),fromPath:this.toPath(n,i),toPath:this.toPath(e,e),value:t})}}),[h,c,i]}edit(e,t,r,n,i,s){let a={data:0,meta:0},[[o,l],u]=this.findNodesAndSplitText(e[0],n),[[d,c],h]=this.findNodesAndSplitText(e[1],n);i_(a,h,u);let g=this.toIndex(o,l),f=this.toPath(o,l),m=[],p=[],y=[];this.traverseInPosRange(o,l,d,c,([e,t],r)=>{if(t===sr.Start&&!r)for(let t of e.children)y.push(t);let i=void 0===s,a=!1,o=s?.get(e.id.getCreatedAt().getActorID());a=i||void 0!==o&&o>=e.id.getCreatedAt().getLamport();let l=!1;if(e.removedAt){let t=s?.get(e.removedAt.getActorID());l=i||void 0!==t&&t>=e.removedAt.getLamport()}(e.canDelete(n,a,l)||m.includes(e.parent))&&((t===sr.Text||t===sr.Start)&&m.push(e),p.push([e,t]))},!0);let b=this.makeDeletionChanges(p,n),v=[];for(let e of m)e.remove(n),e.isRemoved&&v.push({parent:this,child:e});for(let e of y)e.removedAt||o.append(e);if(r>0){let e=0,t=o,s=l;for(;e<r;)t.split(this,t.findOffset(s)+1,i),s=t,t=t.parent,e++;b.push({type:"content",from:g,to:g,fromPath:f,toPath:f,actor:n.getActorID()})}if(t?.length){let e=[],r=l;for(let i of t)r===o?o.insertAt(i,0):o.insertAfter(i,r),r=i,sn(i,e=>{o.isRemoved?(e.remove(n),v.push({parent:this,child:e})):i_(a,e.getDataSize()),this.nodeMapByID.put(e.id,e)}),i.isRemoved||e.push(i);if(e.length){let t=e.map(e=>sl(e));b.length&&b[b.length-1].from===g?b[b.length-1].value=t:b.push({type:"content",from:g,to:g,fromPath:f,toPath:f,actor:n.getActorID(),value:t})}}return[b,v,a]}editT(e,t,r,n,i){let s=this.findPos(e[0]),a=this.findPos(e[1]);return this.edit([s,a],t,r,n,i)}move(e,t,r){throw new nq(nH.ErrUnimplemented,`not implemented: ${e}, ${t}, ${r}`)}pathToTreePos(e){return this.indexTree.pathToTreePos(e)}purge(e){e.parent?.removeChild(e),this.nodeMapByID.remove(e.id);let t=e.insPrevID,r=e.insNextID;t&&(this.findFloorNode(t).insNextID=r),r&&(this.findFloorNode(r).insPrevID=t),e.insPrevID=void 0,e.insNextID=void 0}getGCPairs(){let e=[];return this.indexTree.traverse(t=>{for(let r of(t.getRemovedAt()&&e.push({parent:this,child:t}),t.getGCPairs()))e.push(r)}),e}findPos(e,t=!0){let r=this.indexTree.findTreePos(e,t);return ss.fromTreePos(r)}pathToPosRange(e){let t=this.pathToIndex(e);return[this.findPos(t),this.findPos(t+1)]}pathToPos(e){let t=this.indexTree.pathToIndex(e);return this.findPos(t)}getRoot(){return this.indexTree.getRoot()}getSize(){return this.indexTree.size}getNodeSize(){return this.nodeMapByID.size()}getIndexTree(){return this.indexTree}toXML(){return su(this.indexTree.getRoot())}getDataSize(){let e={data:0,meta:0};return this.indexTree.traverse(t=>{if(t.getRemovedAt())return;let r=t.getDataSize();e.data+=r.data,e.meta+=r.meta}),{data:e.data,meta:e.meta+this.getMetaUsage()}}toJSON(){return JSON.stringify(this.getRootTreeNode())}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:JSON.parse(this.toJSON()),type:"YORKIE_TREE"}}toJSInfoForTest(){let e=this.indexTree.getRoot(),t=(e,r,n,i=0)=>{let s,a,o,l=e.isText?{node:e,offset:0}:r&&n?this.toTreePos(r,n):null;l&&(s=this.indexTree.indexOf(l),a=this.indexTree.treePosToPath(l),o=ss.fromTreePos(l).toStruct());let u={type:e.type,parent:r?.id.toTestString(),size:e.visibleSize,id:e.id.toTestString(),removedAt:e.removedAt?.toTestString(),insPrev:e.insPrevID?.toTestString(),insNext:e.insNextID?.toTestString(),value:e.isText?e.value:void 0,isRemoved:e.isRemoved,children:[],depth:i,attributes:e.attrs?i3(e.attrs?.toObject()):void 0,index:s,path:a,pos:o};for(let r=0;r<e.allChildren.length;r++){let n=0===r?e:e.allChildren[r-1];u.children.push(t(e.allChildren[r],e,n,i+1))}return u};return t(e)}getRootTreeNode(){return sl(this.indexTree.getRoot())}toTestTreeNode(){return function e(t){return t.isText?{type:t.type,value:t.value,visibleSize:t.visibleSize,isRemoved:t.isRemoved}:{type:t.type,children:t.children.map(e),visibleSize:t.visibleSize,isRemoved:t.isRemoved}}(this.indexTree.getRoot())}toSortedJSON(){return this.toJSON()}deepcopy(){let e=new sd(this.getRoot().deepcopy(),this.getCreatedAt());return e.setRemovedAt(this.getRemovedAt()),e.setMovedAt(this.getMovedAt()),e}toPath(e,t){let r=this.toTreePos(e,t);return r?this.indexTree.treePosToPath(r):[]}toIndex(e,t,r=!1){let n=this.toTreePos(e,t,r);return n?this.indexTree.indexOf(n,r):-1}indexToPath(e){return this.indexTree.indexToPath(e)}pathToIndex(e){return this.indexTree.pathToIndex(e)}indexRangeToPosRange(e){let t=this.findPos(e[0]);return e[0]===e[1]?[t,t]:[t,this.findPos(e[1])]}indexRangeToPosStructRange(e){let[t,r]=e,n=this.findPos(t);return t===r?[n.toStruct(),n.toStruct()]:[n.toStruct(),this.findPos(r).toStruct()]}posRangeToPathRange(e){let[[t,r]]=this.findNodesAndSplitText(e[0]),[[n,i]]=this.findNodesAndSplitText(e[1]);return[this.toPath(t,r),this.toPath(n,i)]}posRangeToIndexRange(e){let[[t,r]]=this.findNodesAndSplitText(e[0]),[[n,i]]=this.findNodesAndSplitText(e[1]);return[this.toIndex(t,r),this.toIndex(n,i)]}traverseInPosRange(e,t,r,n,i,s=!1){let a=this.toIndex(e,t,s),o=this.toIndex(r,n,s);this.indexTree.tokensBetween(a,o,i,s)}toTreePos(e,t,r=!1){if(!e||!t)return;if(!r&&e.isRemoved){let t;for(;e.isRemoved;)e=(t=e).parent;let n=e.findOffset(t,r);return{node:e,offset:n}}if(e===t)return{node:e,offset:0};let n=e.findOffset(t,r);if(r||!t.isRemoved){if(t.isText)return{node:t,offset:t.paddedSize(r)};n++}return{node:e,offset:n}}makeDeletionChanges(e,t){let r=[],n=[],i=null,s=null;for(let t=0;t<e.length;t++){let r=e[t],a=e[t+1];i||(i=r),s=r;let o=this.findRightToken(r);o&&a&&o[0]===a[0]&&o[1]===a[1]||(n.push([i,s]),i=null,s=null)}for(let e of n){let[n,i]=e,[s,a]=this.findLeftToken(n),[o,l]=i,u=a===sr.Start?s:s.parent,d=l===sr.Start?o:o.parent,c=this.toIndex(u,s),h=this.toIndex(d,o);c<h&&(r.length>0&&c===r[r.length-1].to?(r[r.length-1].to=h,r[r.length-1].toPath=this.toPath(d,o)):r.push({type:"content",from:c,to:h,fromPath:this.toPath(u,s),toPath:this.toPath(d,o),actor:t.getActorID()}))}return r.reverse()}findRightToken([e,t]){if(t===sr.Start){let t=e.allChildren;return t.length>0?[t[0],t[0].isText?sr.Text:sr.Start]:[e,sr.End]}let r=e.parent,n=r.allChildren,i=n.indexOf(e);if(r&&i===n.length-1)return[r,sr.End];let s=n[i+1];return[s,s.isText?sr.Text:sr.Start]}findLeftToken([e,t]){if(t===sr.End){let t=e.allChildren;if(t.length>0){let e=t[t.length-1];return[e,e.isText?sr.Text:sr.End]}return[e,sr.Start]}let r=e.parent,n=r.allChildren,i=n.indexOf(e);if(r&&0===i)return[r,sr.Start];let s=n[i-1];return[s,s.isText?sr.Text:sr.End]}}class sc extends it{fromPos;toPos;contents;splitLevel;constructor(e,t,r,n,i,s){super(e,s),this.fromPos=t,this.toPos=r,this.contents=n,this.splitLevel=i}static create(e,t,r,n,i,s){return new sc(e,t,r,n,i,s)}execute(e,t,r){let n,i=e.findByCreatedAt(this.getParentCreatedAt());if(!i)throw new nq(nH.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(i instanceof sd))throw new nq(nH.ErrInvalidArgument,"fail to execute, only Tree can execute edit");let s=this.getExecutedAt(),[a,o,l]=i.edit([this.fromPos,this.toPos],this.contents?.map(e=>e.deepcopy()),this.splitLevel,s,(n=s.getDelimiter(),void 0!==this.contents&&(n+=this.contents.length),()=>n2.of(s.getLamport(),++n,s.getActorID())),r);for(let t of(e.acc(l),o))e.registerGCPair(t);return{opInfos:a.map(({from:t,to:r,value:n,splitLevel:i,fromPath:s,toPath:a})=>({type:"tree-edit",path:e.createPath(this.getParentCreatedAt()),from:t,to:r,value:n,splitLevel:i,fromPath:s,toPath:a}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){let e=this.getParentCreatedAt().toTestString(),t=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.fromPos.getLeftSiblingID().getOffset()}`,r=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}/${this.toPos.getLeftSiblingID().getOffset()}`,n=this.contents||[];return`${e}.EDIT(${t},${r},${n.map(e=>su(e)).join("")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getContents(){return this.contents}getSplitLevel(){return this.splitLevel}}class sh{vector;constructor(e){this.vector=e||new Map}set(e,t){this.vector.set(e,t)}unset(e){this.vector.delete(e)}get(e){return this.vector.get(e)}has(e){return this.vector.has(e)}maxLamport(){let e=BigInt(0);for(let[,t]of this)t>e&&(e=t);return e}max(e){let t=new Map;for(let[r,n]of e){let e=this.vector.get(r),i=e&&e>n?e:n;t.set(r,i)}for(let[r,n]of this){let i=e.get(r),s=i&&i>n?i:n;t.set(r,s)}return new sh(t)}afterOrEqual(e){let t=this.vector.get(e.getActorID());return void 0!==t&&t>=e.getLamport()}deepcopy(){let e=new Map;for(let[t,r]of this.vector)e.set(t,r);return new sh(e)}filter(e){let t=new Map;for(let[r]of e){let e=this.vector.get(r);void 0!==e&&t.set(r,e)}return new sh(t)}size(){return this.vector.size}*[Symbol.iterator](){for(let[e,t]of this.vector)yield[e,t]}}let sg=new sh(new Map);class sf{clientSeq;serverSeq;actor;lamport;versionVector;constructor(e,t,r,n,i){this.clientSeq=e,this.serverSeq=i,this.lamport=t,this.versionVector=n,this.actor=r}hasClocks(){return this.versionVector.size()>0&&0n!=this.lamport}static of(e,t,r,n,i){return new sf(e,t,r,n,i)}next(e=!1){if(e)return new sf(this.clientSeq+1,this.lamport,this.actor,sg,0n);let t=this.versionVector.deepcopy();return t.set(this.actor,this.lamport+1n),new sf(this.clientSeq+1,this.lamport+1n,this.actor,t)}syncClocks(e){if(!e.hasClocks())return this;let t=e.lamport>this.lamport?e.lamport+1n:this.lamport+1n,r=this.versionVector.max(e.versionVector),n=new sf(this.clientSeq,t,this.actor,r);return n.versionVector.set(this.actor,t),n}setClocks(e,t){let r=e>this.lamport?e+1n:this.lamport+1n,n=this.versionVector.max(t);return n.set(this.actor,r),sf.of(this.clientSeq,r,this.actor,n)}createTimeTicket(e){return n2.of(this.lamport,e,this.actor)}setActor(e){return new sf(this.clientSeq,this.lamport,e,this.versionVector,this.serverSeq)}setLamport(e){return new sf(this.clientSeq,e,this.actor,this.versionVector,this.serverSeq)}setVersionVector(e){return new sf(this.clientSeq,this.lamport,this.actor,e,this.serverSeq)}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq?this.serverSeq.toString():""}getLamport(){return this.lamport}getLamportAsString(){return this.lamport.toString()}getActorID(){return this.actor}getVersionVector(){return this.versionVector}toTestString(){return`${this.lamport.toString()}:${this.actor.slice(-2)}:${this.clientSeq}`}}let sm=new sf(0,0n,n1,sg);class sp{id;operations;presenceChange;message;constructor({id:e,operations:t,presenceChange:r,message:n}){this.id=e,this.operations=t||[],this.presenceChange=r,this.message=n}static create({id:e,operations:t,presenceChange:r,message:n}){return new sp({id:e,operations:t,presenceChange:r,message:n})}getID(){return this.id}getMessage(){return this.message}hasOperations(){return this.operations.length>0}getOperations(){return this.operations}setActor(e){for(let t of this.operations)t.setActor(e);this.id=this.id.setActor(e)}hasPresenceChange(){return void 0!==this.presenceChange}getPresenceChange(){return this.presenceChange}execute(e,t,r){let n=[],i=[],s=[];for(let t of this.operations){let a=t.execute(e,r,this.id.getVersionVector());if(!a)continue;let{opInfos:o,reverseOp:l}=a;n.push(...o),i.push(t),l&&s.unshift(l)}return this.presenceChange&&(this.presenceChange.type===n0.Put?t.set(this.id.getActorID(),i0(this.presenceChange.presence)):t.delete(this.id.getActorID())),{operations:i,opInfos:n,reverseOps:s}}toTestString(){return`${this.operations.map(e=>e.toTestString()).join(",")}`}toStruct(){return{changeID:s8.bytesToHex(s8.changeIDToBinary(this.getID())),message:this.getMessage(),operations:this.getOperations().map(e=>s8.bytesToHex(s8.operationToBinary(e))),presenceChange:this.getPresenceChange()}}static fromStruct(e){let{changeID:t,operations:r,presenceChange:n,message:i}=e;return sp.create({id:s8.bytesToChangeID(s8.hexToBytes(t)),operations:r?.map(e=>s8.bytesToOperation(s8.hexToBytes(e))),presenceChange:n,message:i})}}class sy{documentKey;checkpoint;isRemoved;changes;snapshot;versionVector;constructor(e,t,r,n,i,s){this.documentKey=e,this.checkpoint=t,this.isRemoved=r,this.changes=n,this.snapshot=s,this.versionVector=i}static create(e,t,r,n,i,s){return new sy(e,t,r,n,i,s)}getDocumentKey(){return this.documentKey}getCheckpoint(){return this.checkpoint}getIsRemoved(){return this.isRemoved}getChanges(){return this.changes}hasChanges(){return this.changes.length>0}getChangeSize(){return this.changes.length}hasSnapshot(){return!!this.snapshot&&!!this.snapshot.length}getSnapshot(){return this.snapshot}getVersionVector(){return this.versionVector}}class sb{serverSeq;clientSeq;constructor(e,t){this.serverSeq=e,this.clientSeq=t}static of(e,t){return new sb(e,t)}increaseClientSeq(e){return 0===e?this:new sb(this.serverSeq,this.clientSeq+e)}forward(e){if(this.equals(e))return this;let t=this.serverSeq>e.serverSeq?this.serverSeq:e.serverSeq,r=Math.max(this.clientSeq,e.clientSeq);return sb.of(t,r)}getServerSeqAsString(){return this.serverSeq.toString()}getClientSeq(){return this.clientSeq}getServerSeq(){return this.serverSeq}equals(e){return this.clientSeq===e.clientSeq&&this.serverSeq==e.serverSeq}toTestString(){return`serverSeq=${this.serverSeq}, clientSeq=${this.clientSeq}`}}let sv=new sb(0n,0),sA=e=>e<0?Math.ceil(e):Math.floor(e);var sS=((z={})[z.Int=0]="Int",z[z.Long=1]="Long",z);class sE extends n9{valueType;value;constructor(e,t,r){switch(super(r),this.valueType=e,e){case 0:"number"==typeof t?t>0x7fffffff||t<-0x80000000?this.value=ia.fromNumber(t).toInt():this.value=sA(t):this.value=t.toInt();break;case 1:"number"==typeof t?this.value=ia.fromNumber(t):this.value=t;break;default:throw new nq(nH.ErrUnimplemented,`unimplemented type: ${e}`)}}static create(e,t,r){return new sE(e,t,r)}static valueFromBytes(e,t){switch(e){case 0:return t[0]|t[1]<<8|t[2]<<16|t[3]<<24;case 1:return ia.fromBytesLE(Array.from(t));default:throw new nq(nH.ErrUnimplemented,`unimplemented type: ${e}`)}}getDataSize(){return{data:0===this.valueType?4:8,meta:this.getMetaUsage()}}toJSON(){return`${this.value}`}toSortedJSON(){return this.toJSON()}toJSForTest(){return{createdAt:this.getCreatedAt().toTestString(),value:this.value,type:"YORKIE_COUNTER"}}deepcopy(){let e=sE.create(this.valueType,this.value,this.getCreatedAt());return e.setRemovedAt(this.getRemovedAt()),e.setMovedAt(this.getMovedAt()),e}getType(){return this.valueType}static getCounterType(e){switch(typeof e){case"object":if(e instanceof ia)return 1;return;case"number":if(e>0x7fffffff||e<-0x80000000)return 1;return 0;default:return}}static isSupport(e){return!!sE.getCounterType(e)}static isInteger(e){return e%1==0}isNumericType(){let e=this.valueType;return 0===e||1===e}getValueType(){return this.valueType}getValue(){return this.value}toBytes(){switch(this.valueType){case 0:{let e=this.value;return new Uint8Array([255&e,e>>8&255,e>>16&255,e>>24&255])}case 1:{let e=this.value.toBytesLE();return Uint8Array.from(e)}default:throw new nq(nH.ErrUnimplemented,`unimplemented type: ${this.valueType}`)}}increase(e){function t(e){if(!e.isNumericType())throw TypeError(`Unsupported type of value: ${typeof e.getValue()}`)}return t(this),t(e),1===this.valueType?this.value=this.value.add(e.getValue()):e.getType()===iD.Long?this.value=this.value+e.getValue().toInt():this.value=ia.fromNumber(this.value+sA(e.getValue())).toInt(),this}}class sI extends it{value;constructor(e,t,r){super(e,r),this.value=t}static create(e,t,r){return new sI(e,t,r)}execute(e){let t=e.findByCreatedAt(this.getParentCreatedAt());if(!t)throw new nq(nH.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(t instanceof sE))throw new nq(nH.ErrInvalidArgument,"fail to execute, only Counter can execute increase");let r=this.value.deepcopy();return t.increase(r),{opInfos:[{type:"increase",path:e.createPath(this.getParentCreatedAt()),value:r.getValue()}],reverseOp:this.toReverseOperation()}}toReverseOperation(){let e=this.value.deepcopy(),t=e.getType()===iD.Long?e.getValue().multiply(-1):-1*e.getValue();return sI.create(this.getParentCreatedAt(),ik.of(t,e.getCreatedAt()))}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){return`${this.getParentCreatedAt().toTestString()}.INCREASE.${this.value.toJSON()}`}getValue(){return this.value}}class sw extends it{fromPos;toPos;attributes;attributesToRemove;constructor(e,t,r,n,i,s){super(e,s),this.fromPos=t,this.toPos=r,this.attributes=n,this.attributesToRemove=i}static create(e,t,r,n,i){return new sw(e,t,r,n,[],i)}static createTreeRemoveStyleOperation(e,t,r,n,i){return new sw(e,t,r,new Map,n,i)}execute(e,t,r){let n,i,s=e.findByCreatedAt(this.getParentCreatedAt());if(!s)throw new nq(nH.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(s instanceof sd))throw new nq(nH.ErrInvalidArgument,"fail to execute, only Tree can execute edit");let a={data:0,meta:0};if(this.attributes.size){let e={};[...this.attributes].forEach(([t,r])=>e[t]=r),[i,n,a]=s.style([this.fromPos,this.toPos],e,this.getExecutedAt(),r)}else{let e=this.attributesToRemove;[i,n,a]=s.removeStyle([this.fromPos,this.toPos],e,this.getExecutedAt(),r)}for(let t of(e.acc(a),i))e.registerGCPair(t);return{opInfos:n.map(({from:t,to:r,value:n,fromPath:i,toPath:s})=>({type:"tree-style",from:t,to:r,value:this.attributes.size?{attributes:n}:{attributesToRemove:n},fromPath:i,toPath:s,path:e.createPath(this.getParentCreatedAt())}))}}getEffectedCreatedAt(){return this.getParentCreatedAt()}toTestString(){let e=this.getParentCreatedAt().toTestString(),t=`${this.fromPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.fromPos.getLeftSiblingID().getOffset()}`,r=`${this.toPos.getLeftSiblingID().getCreatedAt().toTestString()}:${this.toPos.getLeftSiblingID().getOffset()}`;return`${e}.STYLE(${t},${r},${Object.entries(this.attributes||{}).map(([e,t])=>`${e}:"${t}"`).join(" ")})`}getFromPos(){return this.fromPos}getToPos(){return this.toPos}getAttributes(){return this.attributes}getAttributesToRemove(){return this.attributesToRemove}}class sN extends it{createdAt;value;constructor(e,t,r,n){super(e,n),this.createdAt=t,this.value=r}static create(e,t,r,n){return new sN(e,t,r,n)}execute(e){let t=e.findByCreatedAt(this.getParentCreatedAt());if(!t)throw new nq(nH.ErrInvalidArgument,`fail to find ${this.getParentCreatedAt()}`);if(!(t instanceof iL))throw new nq(nH.ErrInvalidArgument,"fail to execute, only array can execute set");let r=t.getByID(this.createdAt).deepcopy(),n=this.toReverseOperation(this.value,r),i=this.value.deepcopy();return t.insertAfter(this.createdAt,i,this.getExecutedAt()),t.delete(this.createdAt,this.getExecutedAt()),e.registerElement(i),{opInfos:[{type:"array-set",path:e.createPath(this.getParentCreatedAt())}],reverseOp:n}}toReverseOperation(e,t){return sN.create(this.getParentCreatedAt(),e.getCreatedAt(),t)}getEffectedCreatedAt(){return this.createdAt}toTestString(){return`${this.getParentCreatedAt().toTestString()}.ARRAY_SET.${this.createdAt.toTestString()}=${this.value.toSortedJSON()}`}getCreatedAt(){return this.createdAt}getValue(){return this.value}setCreatedAt(e){this.createdAt=e}}function sR(e){return e2(nd,{clientSeq:e.getClientSeq(),lamport:e.getLamport(),actorId:s6(e.getActorID()),versionVector:sT(e.getVersionVector())})}function sC(e){if(e)return e2(n_,{lamport:e.getLamport(),delimiter:e.getDelimiter(),actorId:s6(e.getActorID())})}function sT(e){if(!e)return;let t=e2(nc);for(let[r,n]of e){let e=function(e){if("function"==typeof window.btoa){let t="";for(let r=0;r<e.byteLength;r++)t+=String.fromCharCode(e[r]);return window.btoa(t)}if("undefined"!=typeof globalThis&&void 0!==globalThis.Buffer)return globalThis.Buffer.from(e).toString("base64");throw Error("No base64 encoder available")}(s6(r));t.vector[e]=BigInt(n.toString())}return t}function sx(e){switch(e){case iD.Null:return nJ.NULL;case iD.Boolean:return nJ.BOOLEAN;case iD.Integer:return nJ.INTEGER;case iD.Long:return nJ.LONG;case iD.Double:return nJ.DOUBLE;case iD.String:return nJ.STRING;case iD.Bytes:return nJ.BYTES;case iD.Date:return nJ.DATE;default:throw new nq(nH.ErrInvalidType,`unsupported type: ${e}`)}}function sV(e){switch(e){case sS.Int:return nJ.INTEGER_CNT;case sS.Long:return nJ.LONG_CNT;default:throw new nq(nH.ErrInvalidType,`unsupported type: ${e}`)}}function sD(e){if(e instanceof n7)return e2(nI,{type:nJ.JSON_OBJECT,createdAt:sC(e.getCreatedAt()),value:function(e){return rp(nw,sP(e))}(e)});if(e instanceof iL)return e2(nI,{type:nJ.JSON_ARRAY,createdAt:sC(e.getCreatedAt()),value:rp(nw,sZ(e))});if(e instanceof i4)return e2(nI,{type:nJ.TEXT,createdAt:sC(e.getCreatedAt())});if(e instanceof ik)return e2(nI,{type:sx(e.getType()),createdAt:sC(e.getCreatedAt()),value:e.toBytes()});if(e instanceof sE)return e2(nI,{type:sV(e.getType()),createdAt:sC(e.getCreatedAt()),value:e.toBytes()});if(e instanceof sd)return e2(nI,{type:nJ.TREE,createdAt:sC(e.getCreatedAt()),value:rp(nw,sF(e))});throw new nq(nH.ErrUnimplemented,"unimplemented element")}function sk(e){return e2(nM,{createdAt:sC(e.getID().getCreatedAt()),offset:e.getID().getOffset(),relativeOffset:e.getRelativeOffset()})}function sB(e){return e2(nP,{parentId:sW(e.getParentID()),leftSiblingId:sW(e.getLeftSiblingID())})}function sW(e){return e2(nF,{createdAt:sC(e.getCreatedAt()),offset:e.getOffset()})}function sL(e){let t=e2(nh);if(e instanceof iF){let r=e2(ng);r.parentCreatedAt=sC(e.getParentCreatedAt()),r.key=e.getKey(),r.value=sD(e.getValue()),r.executedAt=sC(e.getExecutedAt()),t.body.case="set",t.body.value=r}else if(e instanceof iO){let r=e2(nf);r.parentCreatedAt=sC(e.getParentCreatedAt()),r.prevCreatedAt=sC(e.getPrevCreatedAt()),r.value=sD(e.getValue()),r.executedAt=sC(e.getExecutedAt()),t.body.case="add",t.body.value=r}else if(e instanceof iP){let r=e2(nm);r.parentCreatedAt=sC(e.getParentCreatedAt()),r.prevCreatedAt=sC(e.getPrevCreatedAt()),r.createdAt=sC(e.getCreatedAt()),r.executedAt=sC(e.getExecutedAt()),t.body.case="move",t.body.value=r}else if(e instanceof iZ){let r=e2(np);r.parentCreatedAt=sC(e.getParentCreatedAt()),r.createdAt=sC(e.getCreatedAt()),r.executedAt=sC(e.getExecutedAt()),t.body.case="remove",t.body.value=r}else if(e instanceof i6){let r=e2(ny);r.parentCreatedAt=sC(e.getParentCreatedAt()),r.from=sk(e.getFromPos()),r.to=sk(e.getToPos()),r.content=e.getContent();let n=r.attributes;for(let[t,r]of e.getAttributes())n[t]=r;r.executedAt=sC(e.getExecutedAt()),t.body.case="edit",t.body.value=r}else if(e instanceof i8){let r=e2(nb);r.parentCreatedAt=sC(e.getParentCreatedAt()),r.from=sk(e.getFromPos()),r.to=sk(e.getToPos());let n=e.getAttributesToRemove();n.length>0&&(r.attributesToRemove=n);let i=r.attributes;for(let[t,r]of e.getAttributes())i[t]=r;r.executedAt=sC(e.getExecutedAt()),t.body.case="style",t.body.value=r}else if(e instanceof sI){let r=e2(nv);r.parentCreatedAt=sC(e.getParentCreatedAt()),r.value=sD(e.getValue()),r.executedAt=sC(e.getExecutedAt()),t.body.case="increase",t.body.value=r}else if(e instanceof sc){let r=e2(nA);r.parentCreatedAt=sC(e.getParentCreatedAt()),r.from=sB(e.getFromPos()),r.to=sB(e.getToPos()),r.contents=function(e){let t=[];if(!e||!e.length)return t;for(let r of e)t.push(e2(nZ,{content:sO(r)}));return t}(e.getContents()),r.splitLevel=e.getSplitLevel(),r.executedAt=sC(e.getExecutedAt()),t.body.case="treeEdit",t.body.value=r}else if(e instanceof sw){let r=e2(nS);r.parentCreatedAt=sC(e.getParentCreatedAt()),r.from=sB(e.getFromPos()),r.to=sB(e.getToPos());let n=e.getAttributesToRemove();if(n.length>0)r.attributesToRemove=n;else{let t=r.attributes;for(let[r,n]of e.getAttributes())t[r]=n}r.executedAt=sC(e.getExecutedAt()),t.body.case="treeStyle",t.body.value=r}else if(e instanceof sN){let r=e2(nE);r.parentCreatedAt=sC(e.getParentCreatedAt()),r.createdAt=sC(e.getCreatedAt()),r.value=sD(e.getValue()),r.executedAt=sC(e.getExecutedAt()),t.body.case="arraySet",t.body.value=r}else throw new nq(nH.ErrUnimplemented,"unimplemented operation");return t}function sO(e){if(!e)return[];let t=[];return sn(e,(e,r)=>{let n=e2(nO,{id:sW(e.id),type:e.type,removedAt:sC(e.removedAt),depth:r});e.isText&&(n.value=e.value),e.insPrevID&&(n.insPrevId=sW(e.insPrevID)),e.insNextID&&(n.insNextId=sW(e.insNextID)),e.attrs&&(n.attributes=function(e){let t={};for(let r of e)t[r.getKey()]=e2(nB,{value:r.getValue(),updatedAt:sC(r.getUpdatedAt()),isRemoved:r.isRemoved()});return t}(e.attrs)),t.push(n)}),t}function sZ(e){return e2(nw,{body:{case:"jsonArray",value:e2(nR,{nodes:function(e){let t=[];for(let r of e)t.push(e2(nk,{element:sP(r.getValue())}));return t}(e.getElements()),createdAt:sC(e.getCreatedAt()),movedAt:sC(e.getMovedAt()),removedAt:sC(e.getRemovedAt())})}})}function sF(e){return e2(nw,{body:{case:"tree",value:e2(nV,{nodes:sO(e.getRoot()),createdAt:sC(e.getCreatedAt()),movedAt:sC(e.getMovedAt()),removedAt:sC(e.getRemovedAt())})}})}function sP(e){if(e instanceof n7)return e2(nw,{body:{case:"jsonObject",value:e2(nN,{nodes:function(e){let t=[];for(let r of e)t.push(e2(nD,{key:r.getStrKey(),element:sP(r.getValue())}));return t}(e.getRHT()),createdAt:sC(e.getCreatedAt()),movedAt:sC(e.getMovedAt()),removedAt:sC(e.getRemovedAt())})}});if(e instanceof iL)return sZ(e);if(e instanceof ik)return e2(nw,{body:{case:"primitive",value:e2(nC,{type:sx(e.getType()),value:e.toBytes(),createdAt:sC(e.getCreatedAt()),movedAt:sC(e.getMovedAt()),removedAt:sC(e.getRemovedAt())})}});if(e instanceof i4)return e2(nw,{body:{case:"text",value:e2(nT,{nodes:function(e){let t=[];for(let n of e){var r;let e=e2(nW);e.id=e2(nL,{createdAt:sC((r=n.getID()).getCreatedAt()),offset:r.getOffset()}),e.value=n.getValue().getContent(),e.removedAt=sC(n.getRemovedAt());let i=e.attributes;for(let e of n.getValue().getAttrs()){let t=e2(nB);t.value=e.getValue(),t.updatedAt=sC(e.getUpdatedAt()),i[e.getKey()]=t}t.push(e)}return t}(e.getRGATreeSplit()),createdAt:sC(e.getCreatedAt()),movedAt:sC(e.getMovedAt()),removedAt:sC(e.getRemovedAt())})}});if(e instanceof sE)return e2(nw,{body:{case:"counter",value:e2(nx,{type:sV(e.getType()),value:e.toBytes(),createdAt:sC(e.getCreatedAt()),movedAt:sC(e.getMovedAt()),removedAt:sC(e.getRemovedAt())})}});if(e instanceof sd)return sF(e);throw new nq(nH.ErrUnimplemented,"unimplemented element")}function sU(e){if(!(e instanceof tP))return{};for(let t of e.findDetails(nQ))return t.metadata;return{}}function sG(e){return sU(e).code??""}function sY(e,t){return e instanceof tP&&sG(e)===t}function sK(e){return sf.of(e.clientSeq,BigInt(e.lamport),s4(e.actorId),sM(e.versionVector),BigInt(e.serverSeq))}function sM(e){if(!e)return;let t=new sh;return Object.entries(e.vector).forEach(([e,r])=>{let n=s4(function(e){if("function"==typeof window.atob){let t=window.atob(e),r=t.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);return n}if("undefined"!=typeof globalThis&&void 0!==globalThis.Buffer)return new Uint8Array(globalThis.Buffer.from(e,"base64"));throw Error("No base64 decoder available")}(e));t.set(n,BigInt(r.toString()))}),t}function s_(e){if(e)return n2.of(BigInt(e.lamport),e.delimiter,s4(e.actorId))}function sX(e){let t={};return Object.entries(e.data).forEach(([e,r])=>{t[e]=JSON.parse(r)}),t}function sJ(e){switch(e){case nJ.NULL:return iD.Null;case nJ.BOOLEAN:return iD.Boolean;case nJ.INTEGER:return iD.Integer;case nJ.LONG:return iD.Long;case nJ.DOUBLE:return iD.Double;case nJ.STRING:return iD.String;case nJ.BYTES:return iD.Bytes;case nJ.DATE:return iD.Date}throw new nq(nH.ErrUnimplemented,`unimplemented value type: ${e}`)}function sz(e){switch(e){case nJ.INTEGER_CNT:return sS.Int;case nJ.LONG_CNT:return sS.Long}throw new nq(nH.ErrUnimplemented,`unimplemented value type: ${e}`)}function s$(e){switch(e.type){case nJ.JSON_OBJECT:if(!e.value)return n7.create(s_(e.createdAt));return function(e){if(!e)throw new nq(nH.ErrInvalidArgument,"bytes is empty");return s2(tB(nw,e).body.value)}(e.value);case nJ.JSON_ARRAY:if(!e.value)return iL.create(s_(e.createdAt));var t=e.value;if(!t)throw new nq(nH.ErrInvalidArgument,"bytes is empty");return s3(tB(nw,t).body.value);case nJ.TEXT:return i4.create(iQ.create(),s_(e.createdAt));case nJ.TREE:var r=e.value;if(!r)throw new nq(nH.ErrInvalidArgument,"bytes is empty");return s5(tB(nw,r).body.value);case nJ.NULL:case nJ.BOOLEAN:case nJ.INTEGER:case nJ.LONG:case nJ.DOUBLE:case nJ.STRING:case nJ.BYTES:case nJ.DATE:return ik.of(ik.valueFromBytes(sJ(e.type),e.value),s_(e.createdAt));case nJ.INTEGER_CNT:case nJ.LONG_CNT:return sE.create(sz(e.type),sE.valueFromBytes(sz(e.type),e.value),s_(e.createdAt))}}function sj(e){return i$.of(iJ.of(s_(e.createdAt),e.offset),e.relativeOffset)}function sQ(e){return iJ.of(s_(e.createdAt),e.offset)}function sH(e){return ss.of(sq(e.parentId),sq(e.leftSiblingId))}function sq(e){return sa.of(s_(e.createdAt),e.offset)}function s0(e){if(0===e.length)return;let t=[];for(let r of e)t.push(function(e){let t=sq(e.id),r=so.create(t,e.type),n=Object.entries(e.attributes);return r.isText?r.value=e.value:n.length&&(r.attrs=function(e){let t=iq.create();for(let[r,n]of Object.entries(e))t.setInternal(r,n.value,s_(n.updatedAt),n.isRemoved);return t}(e.attributes)),e.insPrevId&&(r.insPrevID=sq(e.insPrevId)),e.insNextId&&(r.insNextID=sq(e.insNextId)),r.removedAt=s_(e.removedAt),r}(r));let r=t[t.length-1],n=new Map;n.set(e[t.length-1].depth,t[t.length-1]);for(let r=t.length-2;r>=0;r--)n.get(e[r].depth-1).prepend(t[r]),n.set(e[r].depth,t[r]);return r.updateDescendantsSize(),r.updateDescendantsSize(!0),sd.create(r,n3).getRoot()}function s1(e){if("set"===e.body.case){let t=e.body.value;return iF.create(t.key,s$(t.value),s_(t.parentCreatedAt),s_(t.executedAt))}if("add"===e.body.case){let t=e.body.value;return iO.create(s_(t.parentCreatedAt),s_(t.prevCreatedAt),s$(t.value),s_(t.executedAt))}if("move"===e.body.case){let t=e.body.value;return iP.create(s_(t.parentCreatedAt),s_(t.prevCreatedAt),s_(t.createdAt),s_(t.executedAt))}if("remove"===e.body.case){let t=e.body.value;return iZ.create(s_(t.parentCreatedAt),s_(t.createdAt),s_(t.executedAt))}if("edit"===e.body.case){let t=e.body.value,r=new Map;return Object.entries(t.attributes).forEach(([e,t])=>{r.set(e,t)}),i6.create(s_(t.parentCreatedAt),sj(t.from),sj(t.to),t.content,r,s_(t.executedAt))}else if("style"===e.body.case){let t=e.body.value,r=new Map;Object.entries(t.attributes).forEach(([e,t])=>{r.set(e,t)});let n=t.attributesToRemove??[];return new i8(s_(t.parentCreatedAt),sj(t.from),sj(t.to),r,n,s_(t.executedAt))}else if("increase"===e.body.case){let t=e.body.value;return sI.create(s_(t.parentCreatedAt),s$(t.value),s_(t.executedAt))}else if("treeEdit"===e.body.case){let t=e.body.value;return sc.create(s_(t.parentCreatedAt),sH(t.from),sH(t.to),function(e){if(!e.length)return;let t=[];return e.forEach(e=>{let r=s0(e.content);t.push(r)}),t}(t.contents),t.splitLevel,s_(t.executedAt))}else if("treeStyle"===e.body.case){let t=e.body.value,r=new Map,n=t.attributesToRemove;return n?.length>0?sw.createTreeRemoveStyleOperation(s_(t.parentCreatedAt),sH(t.from),sH(t.to),n,s_(t.executedAt)):(Object.entries(t.attributes).forEach(([e,t])=>{r.set(e,t)}),sw.create(s_(t.parentCreatedAt),sH(t.from),sH(t.to),r,s_(t.executedAt)))}else if("arraySet"===e.body.case){let t=e.body.value;return sN.create(s_(t.parentCreatedAt),s_(t.createdAt),s$(t.value),s_(t.executedAt))}else throw new nq(nH.ErrUnimplemented,"unimplemented operation")}function s2(e){let t=new n8;for(let r of e.nodes){let e=s9(r.element);t.set(r.key,e,e.getPositionedAt())}let r=new n7(s_(e.createdAt),t);return r.setMovedAt(s_(e.movedAt)),r.setRemovedAt(s_(e.removedAt)),r}function s3(e){let t=new iW;for(let r of e.nodes)t.insert(s9(r.element));let r=new iL(s_(e.createdAt),t);return r.setMovedAt(s_(e.movedAt)),r.setRemovedAt(s_(e.removedAt)),r}function s5(e){let t=s0(e.nodes);return sd.create(t,s_(e.createdAt))}function s9(e){var t,r;if("jsonObject"===e.body.case)return s2(e.body.value);if("jsonArray"===e.body.case)return s3(e.body.value);if("primitive"===e.body.case){let r;return t=e.body.value,(r=ik.of(ik.valueFromBytes(sJ(t.type),t.value),s_(t.createdAt))).setMovedAt(s_(t.movedAt)),r.setRemovedAt(s_(t.removedAt)),r}if("text"===e.body.case)return function(e){let t=new iQ,r=t.getHead();for(let n of e.nodes){let e=t.insertAfter(r,function(e){let t=i9.create(e.value);Object.entries(e.attributes).forEach(([e,r])=>{t.setAttr(e,r.value,s_(r.updatedAt))});let r=ij.create(sQ(e.id),t);return r.setRemovedAt(s_(e.removedAt)),r}(n));n.insPrevId&&e.setInsPrev(t.findNode(sQ(n.insPrevId))),r=e}let n=new i4(t,s_(e.createdAt));return n.setMovedAt(s_(e.movedAt)),n.setRemovedAt(s_(e.removedAt)),n}(e.body.value);if("counter"===e.body.case){let t;return r=e.body.value,(t=sE.create(sz(r.type),sE.valueFromBytes(sz(r.type),r.value),s_(r.createdAt))).setMovedAt(s_(r.movedAt)),t.setRemovedAt(s_(r.removedAt)),t}else if("tree"===e.body.case)return s5(e.body.value);else throw new nq(nH.ErrUnimplemented,"unimplemented element")}function s4(e){return e?Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join(""):""}function s6(e){return new Uint8Array(e.match(/.{1,2}/g).map(e=>parseInt(e,16)))}let s8={toChangePack:function(e){var t;return e2(nl,{documentKey:e.getDocumentKey(),checkpoint:e2(nK,{serverSeq:(t=e.getCheckpoint()).getServerSeq(),clientSeq:t.getClientSeq()}),isRemoved:e.getIsRemoved(),changes:function(e){let t=[];for(let r of e)t.push(function(e){let t=e2(nu,{id:sR(e.getID()),message:e.getMessage()});return e.hasOperations()&&(t.operations=function(e){let t=[];for(let r of e)t.push(sL(r));return t}(e.getOperations())),e.hasPresenceChange()&&(t.presenceChange=function(e){if(e.type===n0.Put)return e2(nU,{type:nG.PUT,presence:function(e){let t={};for(let[r,n]of Object.entries(e))t[r]=JSON.stringify(n);return e2(nY,{data:t})}(e.presence)});if(e.type===n0.Clear)return e2(nU,{type:nG.CLEAR});throw new nq(nH.ErrUnimplemented,"unimplemented type")}(e.getPresenceChange())),t}(r));return t}(e.getChanges()),snapshot:e.getSnapshot(),versionVector:sT(e.getVersionVector())})},fromChangePack:function(e){var t;return sy.create(e.documentKey,(t=e.checkpoint,sb.of(BigInt(t.serverSeq),t.clientSeq)),e.isRemoved,function(e){let t=[];for(let r of e)t.push(sp.create({id:sK(r.id),operations:function(e){let t=[];for(let r of e){let e=s1(r);e&&t.push(e)}return t}(r.operations),presenceChange:r.presenceChange?function(e){let t=e.type;if(t===nG.PUT){let t=sX(e.presence);return{type:n0.Put,presence:t}}if(t===nG.CLEAR)return{type:n0.Clear};throw new nq(nH.ErrInvalidType,`unsupported type: ${t}`)}(r.presenceChange):void 0,message:r.message}));return t}(e.changes),sM(e.versionVector),e.snapshot)},bytesToSnapshot:function(e){var t;let r;if(!e)return{root:n7.create(n3),presences:new Map};let n=tB(no,e);return{root:s9(n.root),presences:(t=n.presences,r=new Map,Object.entries(t).forEach(([e,t])=>{r.set(e,sX(t))}),r)}},bytesToHex:s4,hexToBytes:s6,bytesToChangeID:function(e){return sK(tB(nd,e))},bytesToOperation:function(e){return s1(tB(nh,e))},versionVectorToHex:function(e){return s4(rp(nc,sT(e)))},hexToVersionVector:function(e){return sM(tB(nc,s6(e)))},fromSchemaRules:function(e){return e.map(e=>({path:e.path,type:e.type}))},toRevisionSummary:function(e){var t;return{id:e.id,label:e.label,description:e.description,snapshot:e.snapshot,createdAt:e.createdAt?new Date(1e3*Number((t=e.createdAt).seconds)+Math.round(t.nanos/1e6)):new Date}},changeIDToBinary:e=>rp(nd,sR(e)),operationToBinary:e=>rp(nh,sL(e))};var s7=(($={})[$.Trivial=0]="Trivial",$[$.Debug=1]="Debug",$[$.Info=2]="Info",$[$.Warn=3]="Warn",$[$.Error=4]="Error",$[$.Fatal=5]="Fatal",$);let ae=3,at=(...e)=>{ae>0||"undefined"!=typeof console&&console.log("YORKIE T:",...e)},ar=(...e)=>{ae>1||"undefined"!=typeof console&&console.log("YORKIE D:",...e)},an=(...e)=>{ae>2||"undefined"!=typeof console&&console.log("YORKIE I:",...e)},ai=(...e)=>{ae>4||"undefined"!=typeof console&&(void 0!==console.error?console.error("YORKIE E:",...e):console.log("YORKIE E:",...e))};function as(){return"xxxxxxxx-xxxx-4xxxy-xxxx-xxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}let aa=()=>{};class ao{finalized=!1;observers=[];finalError;constructor(e){try{e(this)}catch(e){this.error(e)}}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let n;if(!e)throw new nq(nH.ErrInvalidArgument,"missing observer");if(this.finalized)throw new nq(nH.ErrRefused,"observable is finalized due to previous error");void 0===(n="object"==typeof e?e:{next:e,error:t,complete:r}).next&&(n.next=aa),void 0===n.error&&(n.error=aa),void 0===n.complete&&(n.complete=aa);let i=as(),s=this.unsubscribeOne.bind(this,i);if(this.observers.push({subscriptionID:i,observer:n}),this.finalized)try{this.finalError?n.error(this.finalError):n.complete()}catch(e){((...e)=>{ae>3||"undefined"!=typeof console&&(void 0!==console.warn?console.warn("YORKIE W:",...e):console.log("YORKIE W:",...e))})(e)}return s}unsubscribeOne(e){this.observers=this.observers?.filter(t=>t.subscriptionID!==e)}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e].observer)}catch(e){ai(e)}}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.observers=void 0)}}function al(e){let t=new ao(e);return{subscribe:t.subscribe.bind(t),getProxy:()=>t}}class au{prevID;nextID;delimiter;message;root;operations;presenceChange;previousPresence;reversePresenceKeys;constructor(e,t,r,n){this.prevID=e,this.nextID=e.next(),this.delimiter=0,this.root=t,this.operations=[],this.previousPresence=i0(r),this.presenceChange=void 0,this.reversePresenceKeys=new Set,this.message=n}static create(e,t,r,n){return new au(e,t,r,n)}push(e){this.operations.push(e)}registerElement(e,t){this.root.registerElement(e,t)}registerRemovedElement(e){this.root.registerRemovedElement(e)}registerGCPair(e){this.root.registerGCPair(e)}getNextID(){return this.isPresenceOnlyChange()?this.prevID.next(!0).setLamport(this.prevID.getLamport()).setVersionVector(this.prevID.getVersionVector()):this.nextID}toChange(){let e=this.isPresenceOnlyChange()?this.prevID.next(!0):this.nextID;return sp.create({id:e,operations:this.operations,presenceChange:this.presenceChange,message:this.message})}isPresenceOnlyChange(){return 0===this.operations.length}hasChange(){return this.operations.length>0||void 0!==this.presenceChange}setPresenceChange(e){this.presenceChange=e}setReversePresence(e,t){for(let r of Object.keys(e))t?.addToHistory?this.reversePresenceKeys.add(r):this.reversePresenceKeys.delete(r)}getReversePresence(){if(0===this.reversePresenceKeys.size)return;let e={};for(let t of this.reversePresenceKeys)e[t]=this.previousPresence[t];return e}issueTimeTicket(){return this.delimiter+=1,this.nextID.createTimeTicket(this.delimiter)}getLastTimeTicket(){return this.nextID.createTimeTicket(this.delimiter)}acc(e){this.root.acc(e)}}function ad(e,t){return new Proxy(t,new ac(e).getHandlers())}class ac{context;handlers;constructor(e){this.context=e,this.handlers={set:(t,r,n)=>{let i;return i=s7.Trivial,ae<=i&&at(`obj[${r}]=${JSON.stringify(n)}`),ac.setInternal(e,t,r,n),!0},get:(t,r)=>{let n;return(n=s7.Trivial,ae<=n&&at(`obj[${r}]`),"getID"===r)?()=>t.getCreatedAt():"toJSON"===r||"toString"===r?()=>t.toJSON():"toJS"===r?()=>t.toJS():"toJSForTest"===r?()=>t.toJSForTest():aE(e,t.get(r))},ownKeys:e=>e.getKeys(),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),deleteProperty:(t,r)=>{let n;return n=s7.Trivial,ae<=n&&at(`obj[${r}]`),ac.deleteInternal(e,t,r),!0}}}static setInternal(e,t,r,n){if(r.includes("."))throw new nq(nH.ErrInvalidObjectKey,"key must not contain the '.'.");let i=e.issueTimeTicket(),s=aI(e,n,i),a=t.set(r,s,i);e.registerElement(s,t),a&&e.registerRemovedElement(a),e.push(iF.create(r,s.deepcopy(),t.getCreatedAt(),i))}static buildObjectMembers(e,t){let r={};for(let[n,i]of Object.entries(t)){if(n.includes("."))throw new nq(nH.ErrInvalidObjectKey,"key must not contain the '.'.");let t=e.issueTimeTicket(),s=aI(e,i,t);r[n]=s}return r}static deleteInternal(e,t,r){let n=e.issueTimeTicket(),i=t.deleteByKey(r,n);i&&(e.push(iZ.create(t.getCreatedAt(),i.getCreatedAt(),n)),e.registerRemovedElement(i))}getHandlers(){return this.handlers}}function ah(e){return("string"==typeof e||e instanceof String)&&!isNaN(e)}class ag{context;handlers;array;constructor(e,t){this.context=e,this.array=t,this.handlers={get:(t,r,n)=>{if("getID"===r)return()=>t.getCreatedAt();if("getElementByID"===r)return r=>{let n=t.getByID(r);if(!(!n||n.isRemoved()))return aS(e,n)};if("getElementByIndex"===r)return r=>aS(e,t.get(r));if("getLast"===r)return()=>aS(e,t.getLast());if("delete"===r)return r=>{let n=ag.deleteInternalByIndex(e,t,r);return aS(e,n)};else if("deleteByID"===r)return r=>{let n=ag.deleteInternalByID(e,t,r);return aS(e,n)};else if("insertAfter"===r)return(r,n)=>{let i=ag.insertAfterInternal(e,t,r,n);return aS(e,i)};else if("insertIntegerAfter"===r)return(r,n)=>{let i=ag.insertIntegerAfterInternal(e,t,r,n);return aS(e,i)};else if("insertBefore"===r)return(r,n)=>{let i=ag.insertBeforeInternal(e,t,r,n);return aS(e,i)};else if("setValue"===r)return(r,n)=>{let i=ag.setValueInternal(e,t,r,n);return aS(e,i)};else if("moveBefore"===r)return(r,n)=>{ag.moveBeforeInternal(e,t,r,n)};else if("moveAfter"===r)return(r,n)=>{ag.moveAfterInternal(e,t,r,n)};else if("moveAfterByIndex"===r)return(r,n)=>{ag.moveAfterByIndexInternal(e,t,r,n)};else if("moveFront"===r)return r=>{ag.moveFrontInternal(e,t,r)};else if("moveLast"===r)return r=>{ag.moveLastInternal(e,t,r)};else if(ah(r))return aE(e,t.get(Number(r)));else if("push"===r)return r=>ag.pushInternal(e,t,r);else if("splice"===r)return(r,n,...i)=>ag.splice(e,t,r,n,...i);else if("length"===r)return t.length;else if("symbol"==typeof r&&r===Symbol.iterator)return ag.iteratorInternal.bind(this,e,t);else if("includes"===r)return(r,n)=>ag.includes(e,t,r,n);else if("indexOf"===r)return(r,n)=>ag.indexOf(e,t,r,n);else if("lastIndexOf"===r)return(r,n)=>ag.lastIndexOf(e,t,r,n);else if("toJSForTest"===r)return()=>t.toJSForTest();else if("toTestString"===r)return()=>ag.toTestString(t);else if("string"==typeof r&&["concat","entries","every","filter","find","findIndex","forEach","join","keys","map","reduce","reduceRight","slice","some","toLocaleString","toString","values"].includes(r))return(...n)=>{let i=Array.from(t).map(t=>aE(e,t));return Array.prototype[r].apply(i,n)};return Reflect.get(t,r,n)},set:(t,r,n)=>{if(ah(r)){let i=Number(r);return ag.setValueInternal(e,t,i,n),!0}return Reflect.set(t,r,n)},deleteProperty:(t,r)=>{let n;return n=s7.Trivial,ae<=n&&at(`array[${r}]`),ag.deleteInternalByIndex(e,t,Number.parseInt(r)),!0}}}static*iteratorInternal(e,t){for(let r of t)yield aS(e,r)}static buildArrayElements(e,t){let r=[];for(let n of t){let t=e.issueTimeTicket(),i=aI(e,n,t);r.push(i)}return r}static pushInternal(e,t,r){return ag.insertAfterInternal(e,t,t.getLastCreatedAt(),r),t.length}static moveBeforeInternal(e,t,r,n){let i=e.issueTimeTicket(),s=t.getPrevCreatedAt(r);t.moveAfter(s,n,i),e.push(iP.create(t.getCreatedAt(),s,n,i))}static moveAfterInternal(e,t,r,n){let i=e.issueTimeTicket();e.push(iP.create(t.getCreatedAt(),r,n,i)),t.moveAfter(r,n,i)}static moveAfterByIndexInternal(e,t,r,n){let i=t.get(r);if(!i)throw new nq(nH.ErrInvalidArgument,`index out of bounds: ${r}`);let s=t.get(n);if(!s)throw new nq(nH.ErrInvalidArgument,`index out of bounds: ${n}`);ag.moveAfterInternal(e,t,i.getCreatedAt(),s.getCreatedAt())}static moveFrontInternal(e,t,r){let n=e.issueTimeTicket(),i=t.getHead();t.moveAfter(i.getCreatedAt(),r,n),e.push(iP.create(t.getCreatedAt(),i.getCreatedAt(),r,n))}static moveLastInternal(e,t,r){let n=e.issueTimeTicket(),i=t.getLastCreatedAt();t.moveAfter(i,r,n),e.push(iP.create(t.getCreatedAt(),i,r,n))}static insertAfterInternal(e,t,r,n){let i=e.issueTimeTicket(),s=aI(e,n,i);return t.insertAfter(r,s),e.registerElement(s,t),e.push(iO.create(t.getCreatedAt(),r,s.deepcopy(),i)),s}static insertIntegerAfterInternal(e,t,r,n){let i=t.get(r);if(!i)throw new nq(nH.ErrInvalidArgument,`index out of bounds: ${r}`);return ag.insertAfterInternal(e,t,i.getCreatedAt(),n),t}static insertBeforeInternal(e,t,r,n){return ag.insertAfterInternal(e,t,t.getPrevCreatedAt(r),n)}static setValueInternal(e,t,r,n){let i=t.get(r);if(!i)throw new nq(nH.ErrInvalidArgument,`index out of bounds: ${r}`);return ag.setByIndexInternal(e,t,i.getCreatedAt(),n),t}static setByIndexInternal(e,t,r,n){let i=e.issueTimeTicket(),s=aI(e,n,i),a=s.deepcopy();return e.push(sN.create(t.getCreatedAt(),r,a,i)),t.set(r,s,i),e.registerElement(s,t),s}static deleteInternalByIndex(e,t,r){let n=e.issueTimeTicket(),i=t.deleteByIndex(r,n);if(i)return e.push(iZ.create(t.getCreatedAt(),i.getCreatedAt(),n)),e.registerRemovedElement(i),i}static deleteInternalByID(e,t,r){let n=e.issueTimeTicket(),i=t.delete(r,n);return e.push(iZ.create(t.getCreatedAt(),i.getCreatedAt(),n)),e.registerRemovedElement(i),i}static splice(e,t,r,n,...i){let s=t.length,a=r>=0?Math.min(r,s):Math.max(s+r,0),o=void 0===n?s:n<0?a:Math.min(a+n,s),l=[];for(let r=a;r<o;r++){let r=ag.deleteInternalByIndex(e,t,a);if(r){let t=r.deepcopy();t.setRemovedAt(),l.push(aE(e,t))}}if(i){let r=0===a?t.getHead().getID():t.get(a-1).getID();for(let n of i)r=ag.insertAfterInternal(e,t,r,n).getID()}return l}static includes(e,t,r,n){let i=t.length,s=void 0===n?0:n<0?Math.max(n+i,0):n;if(s>=i)return!1;if(ik.isSupport(r))return Array.from(t).map(t=>aE(e,t)).includes(r,s);for(let e=s;e<i;e++)if(t.get(e)?.getID()===r.getID())return!0;return!1}static indexOf(e,t,r,n){let i=t.length,s=void 0===n?0:n<0?Math.max(n+i,0):n;if(s>=i)return -1;if(ik.isSupport(r))return Array.from(t).map(t=>aE(e,t)).indexOf(r,s);for(let e=s;e<i;e++)if(t.get(e)?.getID()===r.getID())return e;return -1}static lastIndexOf(e,t,r,n){let i=t.length,s=void 0===n||n>=i?i-1:n<0?n+i:n;if(s<0)return -1;if(ik.isSupport(r))return Array.from(t).map(t=>aE(e,t)).lastIndexOf(r,s);for(let e=s;e>0;e--)if(t.get(e)?.getID()===r.getID())return e;return -1}static toTestString(e){return e.toTestString()}getHandlers(){return this.handlers}}class af{context;text;constructor(e,t){this.context=e,this.text=t}initialize(e,t){this.context=e,this.text=t}getID(){return this.text.getID()}edit(e,t,r,n){let i;if(!this.context||!this.text)throw new nq(nH.ErrNotInitialized,"Text is not initialized yet");if(e>t)throw new nq(nH.ErrInvalidArgument,"from should be less than or equal to to");let s=this.text.indexRangeToPosRange(e,t);i=s7.Debug,ae<=i&&ar(`EDIT: f:${e}->${s[0].toTestString()}, t:${t}->${s[1].toTestString()} c:${r}`);let a=n?i2(n):void 0,o=this.context.issueTimeTicket(),[,l,u,d]=this.text.edit(s,r,o,a);for(let e of(this.context.acc(u),l))this.context.registerGCPair(e);return this.context.push(new i6(this.text.getCreatedAt(),s[0],s[1],r,a?new Map(Object.entries(a)):new Map,o)),this.text.findIndexesFromRange(d)}delete(e,t){return this.edit(e,t,"")}empty(){return this.edit(0,this.length,"")}setStyle(e,t,r){let n;if(!this.context||!this.text)throw new nq(nH.ErrNotInitialized,"Text is not initialized yet");if(e>t)throw new nq(nH.ErrInvalidArgument,"from should be less than or equal to to");let i=this.text.indexRangeToPosRange(e,t);n=s7.Debug,ae<=n&&ar(`STYL: f:${e}->${i[0].toTestString()}, t:${t}->${i[1].toTestString()} a:${JSON.stringify(r)}`);let s=i2(r),a=this.context.issueTimeTicket(),[o,l]=this.text.setStyle(i,s,a);for(let e of(this.context.acc(l),o))this.context.registerGCPair(e);return this.context.push(i8.create(this.text.getCreatedAt(),i[0],i[1],new Map(Object.entries(s)),a)),!0}indexRangeToPosRange(e){if(!this.context||!this.text)throw new nq(nH.ErrNotInitialized,"Text is not initialized yet");let t=this.text.indexRangeToPosRange(e[0],e[1]);return[t[0].toStruct(),t[1].toStruct()]}posRangeToIndexRange(e){if(!this.context||!this.text)throw new nq(nH.ErrNotInitialized,"Text is not initialized yet");let t=this.text.findIndexesFromRange([i$.fromStruct(e[0]),i$.fromStruct(e[1])]);return[t[0],t[1]]}toTestString(){if(!this.context||!this.text)throw new nq(nH.ErrNotInitialized,"Text is not initialized yet");return this.text.toTestString()}values(){if(!this.context||!this.text)throw new nq(nH.ErrNotInitialized,"Text is not initialized yet");return this.text.values()}get length(){return this.text.length}getTreeByIndex(){return this.text.getTreeByIndex()}getTreeByID(){return this.text.getTreeByID()}toString(){if(!this.context||!this.text)throw new nq(nH.ErrNotInitialized,"Text is not initialized yet");return this.text.toString()}toJSON(){if(!this.context||!this.text)throw new nq(nH.ErrNotInitialized,"Text is not initialized yet");return this.text.toJSON()}toJSForTest(){if(!this.context||!this.text)throw new nq(nH.ErrNotInitialized,"Text is not initialized yet");return this.text.toJSForTest()}createRangeForTest(e,t){if(!this.context||!this.text)throw new nq(nH.ErrNotInitialized,"Text is not initialized yet");return this.text.indexRangeToPosRange(e,t)}}class am{valueType;value;context;counter;constructor(e,t){this.valueType=e,this.value=t}initialize(e,t){this.valueType=t.getValueType(),this.context=e,this.counter=t,this.value=t.getValue()}getID(){return this.counter.getID()}getValue(){return this.value}getValueType(){return this.valueType}increase(e){if(!this.context||!this.counter)throw new nq(nH.ErrNotInitialized,"Counter is not initialized yet");let t=this.context.issueTimeTicket(),r=ik.of(e,t);if(!r.isNumericType())throw TypeError(`Unsupported type of value: ${typeof r.getValue()}`);return this.counter.increase(r),this.context.push(sI.create(this.counter.getCreatedAt(),r,t)),this}toJSForTest(){if(!this.context||!this.counter)throw new nq(nH.ErrNotInitialized,"Counter is not initialized yet");return this.counter.toJSForTest()}}function ap(e){if(e.isText)return{type:e.type,value:e.value};let t={type:e.type,children:e.children.map(e=>ap(e))};return e.attrs&&(t.attributes=i3(e.attrs.toObject())),t}function ay(e,t,r){let{type:n}=e,i=r.issueTimeTicket();if(n===i7){ab(e);let{value:r}=e,s=so.create(sa.of(i,0),n,r);t.append(s)}else{let s,{children:a=[]}=e,{attributes:o}=e;if("object"==typeof o&&!i1(o)){let e=i2(o);for(let[t,r]of(s=new iq,Object.entries(e)))s.set(t,r,i)}let l=so.create(sa.of(i,0),n,void 0,s);for(let e of(t.append(l),a))ay(e,l,r)}}function ab(e){if(!e.value.length)throw new nq(nH.ErrInvalidArgument,"text node cannot have empty value");return!0}function av(e){if(!e.length)return!0;if(e[0].type===i7)for(let t of e){let{type:e}=t;if(e!==i7)throw new nq(nH.ErrInvalidArgument,"element node and text node cannot be passed together");ab(t)}else for(let t of e){let{type:e}=t;if(e===i7)throw new nq(nH.ErrInvalidArgument,"element node and text node cannot be passed together")}return!0}class aA{initialRoot;context;tree;constructor(e){this.initialRoot=e}initialize(e,t){this.context=e,this.tree=t}getID(){return this.tree.getID()}buildRoot(e){if(!this.initialRoot)return so.create(sa.of(e.issueTimeTicket(),0),"root");let t=so.create(sa.of(e.issueTimeTicket(),0),this.initialRoot.type);for(let r of this.initialRoot.children)ay(r,t,e);return t}getSize(){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getSize()}getNodeSize(){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getNodeSize()}getIndexTree(){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getIndexTree()}splitByPath(e){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");if(!e.length)throw new nq(nH.ErrInvalidArgument,"path should not be empty");for(let t of function(e,t){var r;let n,{node:i}=e,s=[...t].slice(0,-1),a=[...s,i.isText?i.parent.getChildrenText().length:i.children.length],o=[...s],l=[];return o[o.length-1]+=1,t.every((e,t)=>e===a[t])||l.push({fromPath:[...t],toPath:a}),l.push({fromPath:o,toPath:o,content:(r=t[t.length-1],n={type:i.isText?i.parent.type:i.type,children:i.isText?i.parent.getChildrenText().length===r?[]:[{type:i7,value:i.parent.getChildrenText().slice(r)}]:i.children.slice(r).map(e=>ap(e))},i.attrs?n.attributes=i3(i.attrs.toObject()):i.isText&&i.parent.attrs&&(n.attributes=i3(i.parent.attrs.toObject())),n)}),l}(this.tree.pathToTreePos(e),e)){let{fromPath:e,toPath:r,content:n}=t,i=this.tree.pathToPos(e),s=this.tree.pathToPos(r);this.editInternal(i,s,n?[n]:[],0)}}mergeByPath(e){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");if(!e.length)throw new nq(nH.ErrInvalidArgument,"path should not be empty");let t=this.tree.pathToTreePos(e);if(t.node.isText)throw new nq(nH.ErrInvalidArgument,"text node cannot be merged");for(let r of function(e,t){let{node:r,offset:n}=e,i=r.children[n],s=r.children[n-1],{children:a}=i,o=[...t].slice(0,-1),l=[{fromPath:[...t],toPath:[...o,n+1]}];if(!i.children.length)return l;let u=[...o,n-1,s.hasTextChild()?s.getChildrenText().length:s.children.length];return l.push({fromPath:u,toPath:u,content:a.map(e=>ap(e))}),l}(t,e)){let{fromPath:e,toPath:t,content:n}=r,i=this.tree.pathToPos(e),s=this.tree.pathToPos(t);this.editInternal(i,s,n??[],0)}}styleByPath(e,t){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");if(!e.length)throw new nq(nH.ErrInvalidArgument,"path should not be empty");let[r,n]=this.tree.pathToPosRange(e),i=this.context.issueTimeTicket(),s=t?i2(t):void 0,[a,,o]=this.tree.style([r,n],s,i);for(let e of(this.context.acc(o),a))this.context.registerGCPair(e);this.context.push(sw.create(this.tree.getCreatedAt(),r,n,s?new Map(Object.entries(s)):new Map,i))}style(e,t,r){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new nq(nH.ErrInvalidArgument,"from should be less than or equal to to");let n=this.tree.findPos(e),i=this.tree.findPos(t),s=this.context.issueTimeTicket(),a=r?i2(r):void 0,[o,,l]=this.tree.style([n,i],a,s);for(let e of(this.context.acc(l),o))this.context.registerGCPair(e);this.context.push(sw.create(this.tree.getCreatedAt(),n,i,a?new Map(Object.entries(a)):new Map,s))}removeStyle(e,t,r){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new nq(nH.ErrInvalidArgument,"from should be less than or equal to to");let n=this.tree.findPos(e),i=this.tree.findPos(t),s=this.context.issueTimeTicket(),[a,,o]=this.tree.removeStyle([n,i],r,s);for(let e of(this.context.acc(o),a))this.context.registerGCPair(e);this.context.push(sw.createTreeRemoveStyleOperation(this.tree.getCreatedAt(),n,i,r,s))}editInternal(e,t,r,n=0){if(0!==r.length&&r[0]&&(av(r),r[0].type!==i7))for(let e of r){let{children:t=[]}=e;av(t)}let i=this.context.getLastTimeTicket(),s=[];if(r[0]?.type===i7){let e="";for(let t of r){let{value:r}=t;e+=r}s.push(so.create(sa.of(this.context.issueTimeTicket(),0),i7,e))}else s=r.map(e=>e&&function(e,t){let r,{type:n}=t,i=e.issueTimeTicket();if(t.type===i7){let{value:e}=t;r=so.create(sa.of(i,0),n,e)}else if(t){let s,{children:a=[]}=t,{attributes:o}=t;if("object"==typeof o&&!i1(o)){let e=i2(o);for(let[t,r]of(s=new iq,Object.entries(e)))s.set(t,r,i)}for(let t of(r=so.create(sa.of(e.issueTimeTicket(),0),n,void 0,s),a))ay(t,r,e)}return r}(this.context,e)).filter(e=>e);let[,a,o]=this.tree.edit([e,t],s.length?s.map(e=>e?.deepcopy()):void 0,n,i,()=>this.context.issueTimeTicket());for(let e of(this.context.acc(o),a))this.context.registerGCPair(e);return this.context.push(sc.create(this.tree.getCreatedAt(),e,t,s.length?s:void 0,n,i)),!0}editByPath(e,t,r,n=0){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");if(e.length!==t.length)throw new nq(nH.ErrInvalidArgument,"path length should be equal");if(!e.length||!t.length)throw new nq(nH.ErrInvalidArgument,"path should not be empty");let i=this.tree.pathToPos(e),s=this.tree.pathToPos(t);return this.editInternal(i,s,r?[r]:[],n)}editBulkByPath(e,t,r,n=0){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");if(e.length!==t.length)throw new nq(nH.ErrInvalidArgument,"path length should be equal");if(!e.length||!t.length)throw new nq(nH.ErrInvalidArgument,"path should not be empty");let i=this.tree.pathToPos(e),s=this.tree.pathToPos(t);return this.editInternal(i,s,r,n)}edit(e,t,r,n=0){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new nq(nH.ErrInvalidArgument,"from should be less than or equal to to");let i=this.tree.findPos(e),s=this.tree.findPos(t);return this.editInternal(i,s,r?[r]:[],n)}editBulk(e,t,r,n=0){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");if(e>t)throw new nq(nH.ErrInvalidArgument,"from should be less than or equal to to");let i=this.tree.findPos(e),s=this.tree.findPos(t);return this.editInternal(i,s,r,n)}toXML(){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toXML()}toJSON(){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSON()}toJSForTest(){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSForTest()}toJSInfoForTest(){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");return this.tree.toJSInfoForTest()}getRootTreeNode(){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");return this.tree.getRootTreeNode()}indexToPath(e){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");return this.tree.indexToPath(e)}pathToIndex(e){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");return this.tree.pathToIndex(e)}pathRangeToPosRange(e){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");let t=[this.tree.pathToIndex(e[0]),this.tree.pathToIndex(e[1])],r=this.tree.indexRangeToPosRange(t);return[r[0].toStruct(),r[1].toStruct()]}indexRangeToPosRange(e){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");return this.tree.indexRangeToPosStructRange(e)}posRangeToIndexRange(e){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");let t=[ss.fromStruct(e[0]),ss.fromStruct(e[1])];return this.tree.posRangeToIndexRange(t)}posRangeToPathRange(e){if(!this.context||!this.tree)throw new nq(nH.ErrNotInitialized,"Tree is not initialized yet");let t=[ss.fromStruct(e[0]),ss.fromStruct(e[1])];return this.tree.posRangeToPathRange(t)}}function aS(e,t){if(t){if(t instanceof ik)return t;if(t instanceof n7)return ad(e,t);if(t instanceof iL){let r;return r=new ag(e,t),new Proxy(t,r.getHandlers())}else if(t instanceof i4)return new af(e,t);else if(t instanceof sE){let r=new am(sS.Int,0);return r.initialize(e,t),r}else if(t instanceof sd){let r=new aA;return r.initialize(e,t),r}throw TypeError(`Unsupported type of element: ${typeof t}`)}}function aE(e,t){let r=aS(e,t);return r instanceof ik?r.getValue():r}function aI(e,t,r){let n;if(ik.isSupport(t))n=ik.of(t,r);else if(Array.isArray(t))n=iL.create(r,ag.buildArrayElements(e,t));else if("object"==typeof t)t instanceof af?(n=i4.create(iQ.create(),r),t.initialize(e,n)):t instanceof am?(n=sE.create(t.getValueType(),t.getValue(),r),t.initialize(e,n)):t instanceof aA?(n=sd.create(t.buildRoot(e),r),t.initialize(e,n)):n=n7.create(r,ac.buildObjectMembers(e,t));else throw TypeError(`Unsupported type of value: ${typeof t}`);return n}class aw{rootObject;elementPairMapByCreatedAt;gcElementSetByCreatedAt;gcPairMap;docSize;constructor(e){this.rootObject=e,this.elementPairMapByCreatedAt=new Map,this.gcElementSetByCreatedAt=new Set,this.gcPairMap=new Map,this.docSize={live:{data:0,meta:0},gc:{data:0,meta:0}},this.registerElement(e,void 0),e.getDescendants(e=>{if(e.getRemovedAt()&&this.registerRemovedElement(e),e instanceof i4||e instanceof sd)for(let t of e.getGCPairs())this.registerGCPair(t);return!1})}static create(){return new aw(n7.create(n3))}findByCreatedAt(e){let t=this.elementPairMapByCreatedAt.get(e.toIDString());if(t)return t.element}findElementPairByCreatedAt(e){return this.elementPairMapByCreatedAt.get(e.toIDString())}createSubPaths(e){let t=this.elementPairMapByCreatedAt.get(e.toIDString());if(!t)return[];let r=[];for(;t.parent;){let e=t.element.getCreatedAt(),n=t.parent.subPathOf(e);if(void 0===n)throw new nq(nH.ErrInvalidArgument,`cant find the given element: ${e.toIDString()}`);r.unshift(n),t=this.elementPairMapByCreatedAt.get(t.parent.getCreatedAt().toIDString())}return r.unshift("$"),r}createPath(e){return this.createSubPaths(e).join(".")}registerElement(e,t){this.elementPairMapByCreatedAt.set(e.getCreatedAt().toIDString(),{parent:t,element:e}),i_(this.docSize.live,e.getDataSize()),e instanceof n4&&e.getDescendants((e,t)=>(this.elementPairMapByCreatedAt.set(e.getCreatedAt().toIDString(),{parent:t,element:e}),i_(this.docSize.live,e.getDataSize()),!1))}deregisterElement(e){let t=0,r=e=>{let r=e.getCreatedAt().toIDString();iX(this.docSize.gc,e.getDataSize()),this.elementPairMapByCreatedAt.delete(r),this.gcElementSetByCreatedAt.delete(r),t++};return r(e),e instanceof n4&&e.getDescendants(e=>(r(e),!1)),t}registerRemovedElement(e){i_(this.docSize.gc,e.getDataSize()),iX(this.docSize.live,e.getDataSize()),this.docSize.live.meta+=24,this.gcElementSetByCreatedAt.add(e.getCreatedAt().toIDString())}registerGCPair(e){if(this.gcPairMap.get(e.child.toIDString()))return void this.gcPairMap.delete(e.child.toIDString());this.gcPairMap.set(e.child.toIDString(),e);let t=this.gcPairMap.get(e.child.toIDString()).child.getDataSize();i_(this.docSize.gc,t),iX(this.docSize.live,t),e.child instanceof iH||(this.docSize.live.meta+=24)}getElementMapSize(){return this.elementPairMapByCreatedAt.size}getGarbageElementSetSize(){let e=new Set;for(let t of this.gcElementSetByCreatedAt){e.add(t);let r=this.elementPairMapByCreatedAt.get(t);r.element instanceof n4&&r.element.getDescendants(t=>(e.add(t.getCreatedAt().toIDString()),!1))}return e.size}getObject(){return this.rootObject}getGarbageLen(){return this.getGarbageElementSetSize()+this.gcPairMap.size}getDocSize(){return this.docSize}deepcopy(){return new aw(this.rootObject.deepcopy())}garbageCollect(e){let t=0;for(let r of this.gcElementSetByCreatedAt){let n=this.elementPairMapByCreatedAt.get(r),i=n.element.getRemovedAt();i&&e?.afterOrEqual(i)&&(n.parent.purge(n.element),t+=this.deregisterElement(n.element))}for(let[,r]of this.gcPairMap){let n=r.child.getRemovedAt();n&&e?.afterOrEqual(n)&&(r.parent.purge(r.child),iX(this.docSize.gc,r.child.getDataSize()),this.gcPairMap.delete(r.child.toIDString()),t+=1)}return t}toJSON(){return this.rootObject.toJSON()}toSortedJSON(){return this.rootObject.toSortedJSON()}getStats(){return{elements:this.getElementMapSize(),gcPairs:this.gcPairMap.size,gcElements:this.getGarbageElementSetSize()}}acc(e){i_(this.docSize.live,e)}*getGCElementPairs(){for(let e of this.gcElementSetByCreatedAt){let t=this.elementPairMapByCreatedAt.get(e);t&&(yield t)}}}class aN{context;presence;constructor(e,t){this.context=e,this.presence=t}set(e,t){for(let t of Object.keys(e))this.presence[t]=e[t];this.context.setPresenceChange({type:n0.Put,presence:i0(this.presence)}),this.context.setReversePresence(e,t)}get(e){return this.presence[e]}clear(){this.presence={},this.context.setPresenceChange({type:n0.Clear})}}class aR{undoStack=[];redoStack=[];hasUndo(){return this.undoStack.length>0}hasRedo(){return this.redoStack.length>0}pushUndo(e){this.undoStack.length>=50&&this.undoStack.shift(),this.undoStack.push(e)}popUndo(){return this.undoStack.pop()}pushRedo(e){this.redoStack.length>=50&&this.redoStack.shift(),this.redoStack.push(e)}popRedo(){return this.redoStack.pop()}clearRedo(){this.redoStack=[]}clearUndo(){this.undoStack=[]}getUndoStackForTest(){return this.undoStack}getRedoStackForTest(){return this.redoStack}reconcileCreatedAt(e,t){let r=r=>{for(let n of r)for(let r of n)(r instanceof sN||r instanceof iZ||r instanceof iP)&&r.getCreatedAt()===e&&r.setCreatedAt(t),(r instanceof iO||r instanceof iP)&&r.getPrevCreatedAt()===e&&r.setPrevCreatedAt(t)};r(this.undoStack),r(this.redoStack)}reconcileTextEdit(e,t,r,n){let i=i=>{for(let s of i)for(let i of s)i instanceof i6&&0===i.getParentCreatedAt().compare(e)&&i.reconcileOperation(t,r,n)};i(this.undoStack),i(this.redoStack)}}function aC(e){return[aW.StatusChanged,aW.Snapshot,aW.LocalChange,aW.RemoteChange,aW.Initialized,aW.Watched,aW.Unwatched,aW.PresenceChanged].includes(e.type)}function aT(e){return e.every(aC)}e.s(["isDocEventForReplay",()=>aC,"isDocEventsForReplay",()=>aT],31403);let ax="disconnected",aV=new Map,aD=new Map;function ak(e,t){(t?.force||"disconnected"!==ax)&&window.postMessage({source:"yorkie-devtools-sdk",...e},"*")}window.docEventsForReplayByDocKey=aD;var aB=((j={}).Detached="detached",j.Attached="attached",j.Removed="removed",j),aW=((Q={}).StatusChanged="status-changed",Q.ConnectionChanged="connection-changed",Q.SyncStatusChanged="sync-status-changed",Q.Snapshot="snapshot",Q.LocalChange="local-change",Q.RemoteChange="remote-change",Q.Initialized="initialized",Q.Watched="watched",Q.Unwatched="unwatched",Q.PresenceChanged="presence-changed",Q.AuthError="auth-error",Q),aL=((H={}).Connected="connected",H.Disconnected="disconnected",H),aO=((q={}).Synced="synced",q.SyncFailed="sync-failed",q);class aZ{key;status;opts;maxSizeLimit;schemaRules;changeID;checkpoint;localChanges;root;presences;clone;internalHistory;isUpdating;onlineClients;eventStream;eventStreamObserver;history;constructor(e,t){this.key=e,this.status="detached",this.opts=t||{},this.maxSizeLimit=0,this.schemaRules=[],this.changeID=sm,this.checkpoint=sv,this.localChanges=[],this.root=aw.create(),this.presences=new Map,this.onlineClients=new Set,this.internalHistory=new aR,this.isUpdating=!1,this.eventStream=al(e=>this.eventStreamObserver=e),this.history={canUndo:()=>this.internalHistory.hasUndo()&&!this.isUpdating,canRedo:()=>this.internalHistory.hasRedo()&&!this.isUpdating,undo:()=>this.executeUndoRedo(!0),redo:()=>this.executeUndoRedo(!1)},function(e){if(!e.isEnableDevtools()||aV.has(e.getKey()))return;aD.set(e.getKey(),[]);let t=e.subscribe("all",t=>{aT(t)&&(aD.get(e.getKey()).push(t),"synced"===ax&&ak({msg:"doc::sync::partial",docKey:e.getKey(),event:t}))});aV.set(e.getKey(),[t]),ak({msg:"refresh-devtools"},{force:!0}),window.addEventListener("message",t=>{if(t.data?.source==="yorkie-devtools-panel")switch(t.data.msg){case"devtools::connect":if("disconnected"!==ax)break;ax="connected",ak({msg:"doc::available",docKey:e.getKey()}),an(`[YD] Devtools connected. Doc: ${e.getKey()}`);break;case"devtools::disconnect":ax="disconnected",an(`[YD] Devtools disconnected. Doc: ${e.getKey()}`);break;case"devtools::subscribe":ax="synced",ak({msg:"doc::sync::full",docKey:e.getKey(),events:aD.get(e.getKey())}),an(`[YD] Devtools subscribed. Doc: ${e.getKey()}`)}})}(this)}update(e,t){var r,n;if("removed"===this.getStatus())throw new nq(nH.ErrDocumentRemoved,`${this.key} is removed`);this.ensureClone();let i=this.changeID.getActorID(),s=au.create(this.changeID,this.clone.root,this.clone.presences.get(i)||{},t);try{let t=(r=this.clone.root.getObject(),ad(s,r));this.presences.has(i)||this.clone.presences.set(i,{}),this.isUpdating=!0,e(t,new aN(s,this.clone.presences.get(i)))}catch(e){throw this.clone=void 0,e}finally{this.isUpdating=!1}let a=this.getSchemaRules();if(!s.isPresenceOnlyChange()&&a.length){let e=function(e,t){let r=[];for(let n of t){let t=function(e,t){switch(t.type){case"string":case"boolean":case"integer":case"double":case"long":case"date":case"bytes":case"null":var r,n;return r=e,n=t,r instanceof ik&&r.getType()===function(e){switch(e){case"null":return iD.Null;case"boolean":return iD.Boolean;case"integer":return iD.Integer;case"long":return iD.Long;case"double":return iD.Double;case"string":return iD.String;case"bytes":return iD.Bytes;case"date":return iD.Date;default:throw Error(`Unknown primitive type: ${e}`)}}(n.type)?{valid:!0}:{valid:!1,errors:[{path:n.path,message:`expected ${n.type} at path ${n.path}`}]};case"object":if(!(e instanceof n7))return{valid:!1,errors:[{path:t.path,message:`expected object at path ${t.path}`}]};break;case"array":if(!(e instanceof iL))return{valid:!1,errors:[{path:t.path,message:`expected array at path ${t.path}`}]};break;case"yorkie.Text":if(!(e instanceof i4))return{valid:!1,errors:[{path:t.path,message:`expected yorkie.Text at path ${t.path}`}]};break;case"yorkie.Tree":if(!(e instanceof sd))return{valid:!1,errors:[{path:t.path,message:`expected yorkie.Tree at path ${t.path}`}]};break;case"yorkie.Counter":if(!(e instanceof sE))return{valid:!1,errors:[{path:t.path,message:`expected yorkie.Counter at path ${t.path}`}]};break;default:throw Error(`Unknown rule type: ${t.type}`)}return{valid:!0}}(function(e,t){if(!t.startsWith("$"))throw Error(`Path must start with $, got ${t}`);let r=t.split("."),n=e;for(let e=1;e<r.length;e++){let t=r[e];if(!(n instanceof n7))return;n=n.get(t)}return n}(e,n.path),n);if(!t.valid)for(let e of t.errors||[])r.push(e)}return{valid:0===r.length,errors:r}}(this.clone?.root.getObject(),a);if(!e.valid)throw this.clone=void 0,new nq(nH.ErrDocumentSchemaValidationFailed,`schema validation failed: ${e.errors?.map(e=>e.message).join(", ")}`)}let o=(n=this.clone?.root.getDocSize())?iM(n.live)+iM(n.gc):0;if(!s.isPresenceOnlyChange()&&this.maxSizeLimit>0&&this.maxSizeLimit<o)throw this.clone=void 0,new nq(nH.ErrDocumentSizeExceedsLimit,`document size exceeded: ${o} > ${this.maxSizeLimit}`);if(s.hasChange()){let e,t;e=s7.Trivial,ae<=e&&at(`trying to update a local change: ${this.toJSON()}`);let r=s.toChange(),{opInfos:n,reverseOps:a}=r.execute(this.root,this.presences,ie.Local);for(let e of r.getOperations())e instanceof sN&&this.internalHistory.reconcileCreatedAt(e.getCreatedAt(),e.getValue().getCreatedAt());let o=s.getReversePresence();o&&a.push({type:"presence",value:o}),this.localChanges.push(r),a.length&&this.internalHistory.pushUndo(a),n.length&&this.internalHistory.clearRedo(),this.changeID=s.getNextID();let l=[];n.length&&l.push({type:"local-change",source:ie.Local,value:{message:r.getMessage()||"",operations:n,actor:i,clientSeq:r.getID().getClientSeq(),serverSeq:r.getID().getServerSeq()},rawChange:this.isEnableDevtools()?r.toStruct():void 0}),r.hasPresenceChange()&&l.push({type:"presence-changed",source:ie.Local,value:{clientID:i,presence:this.getPresence(i)}}),this.publish(l),t=s7.Trivial,ae<=t&&at(`after update a local change: ${this.toJSON()}`)}}subscribe(e,t,r,n){if("string"==typeof e){if("function"!=typeof t)throw new nq(nH.ErrInvalidArgument,"Second argument must be a callback function");return"presence"===e?this.eventStream.subscribe(e=>{for(let r of e)("initialized"===r.type||"watched"===r.type||"unwatched"===r.type||"presence-changed"===r.type)&&t(r)},r,n):"my-presence"===e?this.eventStream.subscribe(e=>{for(let r of e)("initialized"===r.type||"presence-changed"===r.type)&&("presence-changed"!==r.type||r.value.clientID===this.changeID.getActorID())&&t(r)},r,n):"others"===e?this.eventStream.subscribe(e=>{for(let r of e)("watched"===r.type||"unwatched"===r.type||"presence-changed"===r.type)&&r.value.clientID!==this.changeID.getActorID()&&t(r)},r,n):"connection"===e?this.eventStream.subscribe(e=>{for(let r of e)"connection-changed"===r.type&&t(r)},r,n):"status"===e?this.eventStream.subscribe(e=>{for(let r of e)"status-changed"===r.type&&t(r)},r,n):"sync"===e?this.eventStream.subscribe(e=>{for(let r of e)"sync-status-changed"===r.type&&t(r)},r,n):"auth-error"===e?this.eventStream.subscribe(e=>{for(let r of e)"auth-error"===r.type&&t(r)},r):"all"===e?this.eventStream.subscribe(t,r,n):this.eventStream.subscribe(r=>{for(let n of r){if("local-change"!==n.type&&"remote-change"!==n.type)continue;let r=[];for(let t of n.value.operations)this.isSameElementOrChildOf(t.path,e)&&r.push(t);r.length&&t({...n,value:{...n.value,operations:r}})}},r,n)}if("function"==typeof e)return this.eventStream.subscribe(t=>{for(let r of t)("snapshot"===r.type||"local-change"===r.type||"remote-change"===r.type)&&e(r)},t,r);throw new nq(nH.ErrInvalidArgument,`"${e}" is not a valid`)}publish(e){this.eventStreamObserver&&this.eventStreamObserver.next(e)}applyChangePack(e){let t;e.hasSnapshot()?this.applySnapshot(e.getCheckpoint().getServerSeq(),e.getVersionVector(),e.getSnapshot(),e.getCheckpoint().getClientSeq()):(this.applyChanges(e.getChanges(),ie.Remote),this.removePushedLocalChanges(e.getCheckpoint().getClientSeq())),this.checkpoint=this.checkpoint.forward(e.getCheckpoint()),e.hasSnapshot()||this.garbageCollect(e.getVersionVector()),e.getIsRemoved()&&this.applyStatus("removed"),t=s7.Trivial,ae<=t&&at(`${this.root.toJSON()}`)}getCheckpoint(){return this.checkpoint}getChangeID(){return this.changeID}hasLocalChanges(){return this.localChanges.length>0}ensureClone(){this.clone||(this.clone={root:this.root.deepcopy(),presences:i0(this.presences)})}createChangePack(){let e=Array.from(this.localChanges),t=this.checkpoint.increaseClientSeq(e.length);return sy.create(this.key,t,!1,e,this.getVersionVector())}setActor(e){for(let t of this.localChanges)t.setActor(e);this.changeID=this.changeID.setActor(e)}isEnableDevtools(){return!!this.opts.enableDevtools}getKey(){return this.key}getStatus(){return this.status}getClone(){return this.clone}getCloneRoot(){if(this.clone)return this.clone.root.getObject()}getRoot(){return this.ensureClone(),ad(au.create(this.changeID.next(),this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{}),this.clone.root.getObject())}getDocSize(){return this.root.getDocSize()}getMaxSizePerDocument(){return this.maxSizeLimit}setMaxSizePerDocument(e){this.maxSizeLimit=e}getSchemaRules(){return this.schemaRules}setSchemaRules(e){this.schemaRules=e}garbageCollect(e){return this.opts.disableGC?0:(this.clone&&this.clone.root.garbageCollect(e),this.root.garbageCollect(e))}getRootObject(){return this.root.getObject()}getGarbageLen(){return this.root.getGarbageLen()}getRootCRDT(){return this.root}getGarbageLenFromClone(){return this.clone.root.getGarbageLen()}toJSON(){return this.root.toJSON()}toSortedJSON(){return this.root.toSortedJSON()}getStats(){return this.root.getStats()}toJSForTest(){return{...this.getRoot().toJSForTest(),key:"root"}}applySnapshot(e,t,r,n=-1){let{root:i,presences:s}=s8.bytesToSnapshot(r);this.root=new aw(i),this.presences=s,this.changeID=this.changeID.setClocks(t.maxLamport(),t),this.clone=void 0,this.removePushedLocalChanges(n),this.applyChanges(this.localChanges,ie.Local),this.clearHistory(),this.publish([{type:"snapshot",source:ie.Remote,value:{serverSeq:e.toString(),snapshot:this.isEnableDevtools()?s8.bytesToHex(r):void 0,snapshotVector:s8.versionVectorToHex(t)}}])}clearHistory(){this.internalHistory.clearRedo(),this.internalHistory.clearUndo()}applyChanges(e,t){let r,n,i;for(let i of(r=s7.Debug,ae<=r&&ar(`trying to apply ${e.length} remote changes.elements:${this.root.getElementMapSize()}, removeds:${this.root.getGarbageElementSetSize()}`),n=s7.Trivial,ae<=n&&at(e.map(e=>`${e.getID().toTestString()}	${e.toTestString()}`).join("\n")),e))this.applyChange(i,t);i=s7.Debug,ae<=i&&ar(`after appling ${e.length} remote changes.elements:${this.root.getElementMapSize()},  removeds:${this.root.getGarbageElementSetSize()}`)}applyChange(e,t){this.ensureClone(),e.execute(this.clone.root,this.clone.presences,t);let r=[],n=e.getID().getActorID();if(e.hasPresenceChange()&&this.onlineClients.has(n)){let i=e.getPresenceChange();switch(i.type){case n0.Put:r.push(this.presences.has(n)?{type:"presence-changed",source:t,value:{clientID:n,presence:i.presence}}:{type:"watched",source:ie.Remote,value:{clientID:n,presence:i.presence}});break;case n0.Clear:r.push({type:"unwatched",source:ie.Remote,value:{clientID:n,presence:this.getPresence(n)}}),this.removeOnlineClient(n)}}let{opInfos:i,operations:s}=e.execute(this.root,this.presences,t);for(let e of s)if(e instanceof i6){let[t,r]=e.normalizePos(this.root);this.internalHistory.reconcileTextEdit(e.getParentCreatedAt(),t,r,e.getContent()?.length??0)}if(this.changeID=this.changeID.syncClocks(e.getID()),i.length){let s=this.isEnableDevtools()?e.toStruct():void 0;r.push(t===ie.Remote?{type:"remote-change",source:t,value:{actor:n,clientSeq:e.getID().getClientSeq(),serverSeq:e.getID().getServerSeq(),message:e.getMessage()||"",operations:i},rawChange:s}:{type:"local-change",source:t,value:{actor:n,clientSeq:e.getID().getClientSeq(),serverSeq:e.getID().getServerSeq(),message:e.getMessage()||"",operations:i},rawChange:s})}r.length&&this.publish(r)}applyWatchInit(e){let t=new Set;for(let r of e)r!==this.changeID.getActorID()&&t.add(r);for(let e of(this.setOnlineClients(t),Array.from(this.presences.keys())))e===this.changeID.getActorID()||t.has(e)||this.presences.delete(e);this.publish([{type:"initialized",source:ie.Local,value:this.getPresences()}])}applyDocEvent(e,t){let r=[];if(e===nz.DOCUMENT_WATCHED){if(this.onlineClients.has(t)&&this.hasPresence(t))return;this.addOnlineClient(t),this.hasPresence(t)&&r.push({type:"watched",source:ie.Remote,value:{clientID:t,presence:this.getPresence(t)}})}else if(e===nz.DOCUMENT_UNWATCHED){let e=this.getPresence(t);this.removeOnlineClient(t),this.presences.delete(t),e&&r.push({type:"unwatched",source:ie.Remote,value:{clientID:t,presence:e}})}r.length&&this.publish(r)}applyStatus(e){this.status=e,"detached"===e&&this.setActor(n1),this.publish([{source:"removed"===e?ie.Remote:ie.Local,type:"status-changed",value:"attached"===e?{status:e,actorID:this.changeID.getActorID()}:{status:e}}])}applyDocEventsForReplay(e){for(let t of e){if("status-changed"===t.type){this.applyStatus(t.value.status),"attached"===t.value.status&&this.setActor(t.value.actorID);continue}if("snapshot"===t.type){let{snapshot:e,serverSeq:r,snapshotVector:n}=t.value;if(!e)continue;this.applySnapshot(BigInt(r),s8.hexToVersionVector(n),s8.hexToBytes(e));continue}if("local-change"===t.type||"remote-change"===t.type){if(!t.rawChange)continue;let e=sp.fromStruct(t.rawChange);this.applyChange(e,t.source)}if("initialized"===t.type){let e=new Set;for(let{clientID:r,presence:n}of t.value)e.add(r),this.presences.set(r,n);this.setOnlineClients(e)}else if("watched"===t.type){let{clientID:e,presence:r}=t.value;this.addOnlineClient(e),this.presences.set(e,r)}else if("unwatched"===t.type){let{clientID:e}=t.value;this.removeOnlineClient(e),this.presences.delete(e)}else if("presence-changed"===t.type){let{clientID:e,presence:r}=t.value;this.presences.set(e,r)}}}getValueByPath(e){if(!e.startsWith("$"))throw new nq(nH.ErrInvalidArgument,'path must start with "$"');let t=e.split(".");t.shift();let r=this.getRoot();for(let e of t)if(!(r=r[e]))return;return r}setOnlineClients(e){this.onlineClients=e}resetOnlineClients(){this.onlineClients=new Set}addOnlineClient(e){this.onlineClients.add(e)}removeOnlineClient(e){this.onlineClients.delete(e)}hasPresence(e){return this.presences.has(e)}getMyPresence(){if("attached"!==this.status)return{};let e=this.presences.get(this.changeID.getActorID());return e?i0(e):{}}getOthersPresences(){let e=[],t=this.changeID.getActorID();for(let r of this.onlineClients)r!==t&&this.presences.has(r)&&e.push({clientID:r,presence:i0(this.presences.get(r))});return e}getPresence(e){if(e===this.changeID.getActorID())return this.getMyPresence();if(!this.onlineClients.has(e))return;let t=this.presences.get(e);return t?i0(t):void 0}getPresences(){let e=[];for(let t of(e.push({clientID:this.changeID.getActorID(),presence:i0(this.getMyPresence())}),this.onlineClients))this.presences.has(t)&&e.push({clientID:t,presence:i0(this.presences.get(t))});return e}getPresenceForTest(e){let t=this.presences.get(e);return t?i0(t):void 0}getSelfForTest(){return{clientID:this.getChangeID().getActorID(),presence:this.getMyPresence()}}getOthersForTest(){let e=this.getChangeID().getActorID();return this.getPresences().filter(t=>t.clientID!==e).sort((e,t)=>e.clientID>t.clientID?1:-1)}getUndoStackForTest(){return this.internalHistory.getUndoStackForTest()}getRedoStackForTest(){return this.internalHistory.getRedoStackForTest()}getVersionVector(){return this.changeID.getVersionVector()}isSameElementOrChildOf(e,t){if(t===e)return!0;let r=e.split(".");return t.split(".").every((e,t)=>e===r[t])}removePushedLocalChanges(e){for(;this.localChanges.length&&!(this.localChanges[0].getID().getClientSeq()>e);)this.localChanges.shift()}executeUndoRedo(e){if(this.isUpdating)throw new nq(nH.ErrRefused,`${e?"Undo":"Redo"} is not allowed during an update`);let t=e?this.internalHistory.popUndo():this.internalHistory.popRedo();if(!t)throw new nq(nH.ErrRefused,`There is no operation to be ${e?"undone":"redone"}`);this.ensureClone();let r=au.create(this.changeID,this.clone.root,this.clone.presences.get(this.changeID.getActorID())||{});for(let e of t){if(!(e instanceof it)){new aN(r,i0(this.clone.presences.get(this.changeID.getActorID()))).set(e.value,{addToHistory:!0});continue}let t=r.issueTimeTicket();if(e.setExecutedAt(t),e instanceof sN){let r=e.getCreatedAt();e.getValue().setCreatedAt(t),this.internalHistory.reconcileCreatedAt(r,t)}else if(e instanceof iO){let r=e.getValue().getCreatedAt();e.getValue().setCreatedAt(t),this.internalHistory.reconcileCreatedAt(r,t)}r.push(e)}let n=r.toChange();n.execute(this.clone.root,this.clone.presences,ie.UndoRedo);let{opInfos:i,reverseOps:s}=n.execute(this.root,this.presences,ie.UndoRedo),a=r.getReversePresence();if(a&&s.push({type:"presence",value:a}),s.length&&(e?this.internalHistory.pushRedo(s):this.internalHistory.pushUndo(s)),!n.hasPresenceChange()&&!i.length)return;this.localChanges.push(n),this.changeID=r.getNextID();let o=this.changeID.getActorID(),l=[];i.length&&l.push({type:"local-change",source:ie.UndoRedo,value:{message:n.getMessage()||"",operations:i,actor:o,clientSeq:n.getID().getClientSeq(),serverSeq:n.getID().getServerSeq()},rawChange:this.isEnableDevtools()?n.toStruct():void 0}),n.hasPresenceChange()&&l.push({type:"presence-changed",source:ie.UndoRedo,value:{clientID:o,presence:this.getPresence(o)}}),this.publish(l)}}class aF{resource;resourceID;syncMode;changeEventReceived;lastHeartbeatTime;reconnectStreamDelay;cancelled;watchStream;watchLoopTimerID;watchAbortController;constructor(e,t,r,n){this.reconnectStreamDelay=e,this.resource=t,this.resourceID=r,this.syncMode=n,this.changeEventReceived=void 0===n&&void 0,this.lastHeartbeatTime=Date.now(),this.cancelled=!1}changeSyncMode(e){this.syncMode=e}needRealtimeSync(){return this.syncMode!==aM.RealtimeSyncOff&&(this.syncMode===aM.RealtimePushOnly?this.resource.hasLocalChanges():this.syncMode!==aM.Manual&&(this.resource.hasLocalChanges()||(this.changeEventReceived??!1)))}needSync(e){return this.resource instanceof aZ?this.needRealtimeSync():this.syncMode!==aM.Manual&&Date.now()-this.lastHeartbeatTime>=e}updateHeartbeatTime(){this.lastHeartbeatTime=Date.now()}async runWatchLoop(e){let t=async()=>{if(this.watchStream)return Promise.resolve();this.watchLoopTimerID&&(clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0);try{[this.watchStream,this.watchAbortController]=await e(()=>{this.watchStream=void 0,this.watchAbortController=void 0,this.cancelled||(this.watchLoopTimerID=setTimeout(t,this.reconnectStreamDelay))})}catch{}};await t()}cancelWatchStream(){this.cancelled=!0,this.watchStream&&this.watchAbortController&&(this.watchAbortController.abort(),this.watchStream=void 0,this.watchAbortController=void 0),clearTimeout(this.watchLoopTimerID),this.watchLoopTimerID=void 0}}var aP=e.i(73995),aU=((ee={}).Detached="detached",ee.Attached="attached",ee.Removed="removed",ee),aG=((et={}).PresenceChanged="presence-changed",et.Initialized="initialized",et.Broadcast="broadcast",et.LocalBroadcast="local-broadcast",et.AuthError="auth-error",et);class aY{key;status;actorID;sessionID;sessionCount;seq;eventStream;eventStreamObserver;constructor(e){this.validateChannelKey(e),this.key=e,this.status="detached",this.sessionCount=0,this.seq=0,this.eventStream=al(e=>this.eventStreamObserver=e)}getKey(){return this.key}getFirstKeyPath(){return this.key.split(".")[0]}getStatus(){return this.status}applyStatus(e){this.status=e}isAttached(){return"attached"===this.status}getActorID(){return this.actorID}setActor(e){this.actorID=e}getSessionID(){return this.sessionID}setSessionID(e){this.sessionID=e}getSessionCount(){return this.sessionCount}updateSessionCount(e,t){return(0===t||t>this.seq)&&(this.sessionCount=e,this.seq=t,!0)}hasLocalChanges(){return!1}subscribe(e,t){if("function"==typeof e)return this.eventStream.subscribe(e);if(!t)throw Error("callback is required when subscribing to specific event type or topic");return"broadcast"===e?this.eventStream.subscribe(e=>{"broadcast"===e.type&&t(e)}):"local-broadcast"===e?this.eventStream.subscribe(e=>{"local-broadcast"===e.type&&t(e)}):"auth-error"===e?this.eventStream.subscribe(e=>{"auth-error"===e.type&&t(e)}):"presence"===e?this.eventStream.subscribe(e=>{("presence-changed"===e.type||"initialized"===e.type)&&t(e)}):"all"===e?this.eventStream.subscribe(t):this.eventStream.subscribe(r=>{"broadcast"===r.type&&r.topic===e&&t(r)})}publish(e){this.eventStreamObserver&&this.eventStreamObserver.next(e)}broadcast(e,t,r){if("attached"!==this.status)throw Error(`channel is not attached: ${this.status}`);if(!this.actorID)throw Error("actorID is not set");this.publish({type:"local-broadcast",clientID:this.actorID,topic:e,payload:t,options:r})}validateChannelKey(e){if(""===e)throw Error("channel key must not be empty");if(e.includes(" "))throw Error("channel key must not contain a whitespace");if(e.startsWith("."))throw Error("channel key must not start with a period");if(e.endsWith("."))throw Error("channel key must not end with a period");if(e.includes(".."))throw Error("channel key path must not empty")}}function aK(e,t,r){let{stream:n,ac:i,isInit:s,onResponse:a,onStreamEnd:o,onError:l,onDisconnect:u,shouldIgnoreError:d}=e;return new Promise((e,c)=>{(async()=>{try{let t=!1;for await(let r of n)a(r),!t&&s(r)&&(t=!0,e([n,i]));o(),u()}catch(e){if(d&&d(e))return;l(e),await t(e)?u():r(),c(e)}})()})}var aM=((er={}).Manual="manual",er.Realtime="realtime",er.RealtimePushOnly="realtime-pushonly",er.RealtimeSyncOff="realtime-syncoff",er);(en={}).Deactivated="deactivated",en.Activated="activated",(ei={}).SyncLoop="SyncLoop",ei.WatchLoop="WatchLoop";let a_={rpcAddr:"https://api.yorkie.dev",syncLoopDuration:50,retrySyncLoopDelay:1e3,reconnectStreamDelay:1e3,channelHeartbeatInterval:3e4},aX={maxRetries:1/0,initialRetryInterval:1e3,maxBackoff:2e4};class aJ{id;key;metadata;status;attachmentMap;apiKey;authTokenInjector;conditions;syncLoopDuration;reconnectStreamDelay;retrySyncLoopDelay;channelHeartbeatInterval;rpcClient;setAuthToken;taskQueue;processing=!1;keepalive=!1;constructor(e){const t=(e=e||a_).rpcAddr||a_.rpcAddr;this.key=e.key||as(),this.metadata=e.metadata||{},this.status="deactivated",this.attachmentMap=new Map,this.apiKey=e.apiKey||"",this.authTokenInjector=e.authTokenInjector,this.conditions={SyncLoop:!1,WatchLoop:!1},this.syncLoopDuration=e.syncLoopDuration??a_.syncLoopDuration,this.reconnectStreamDelay=e.reconnectStreamDelay??a_.reconnectStreamDelay,this.retrySyncLoopDelay=e.retrySyncLoopDelay??a_.retrySyncLoopDelay,this.channelHeartbeatInterval=e.channelHeartbeatInterval??a_.channelHeartbeatInterval;const{authInterceptor:r,setToken:n}=function(e,t){let r;return{authInterceptor:t=>async n=>(e&&n.header.set("x-api-key",e),r&&n.header.set("authorization",r),await t(n)),setToken:e=>{r=e}}}(this.apiKey);this.setAuthToken=n,this.rpcClient=function(e,t){var r=e=>{var r,n,i,s,a,o,l,u;switch(e.methodKind){case"unary":return r=t,n=e,async(e,t)=>{var i,s;let a=await r.unary(n,null==t?void 0:t.signal,null==t?void 0:t.timeoutMs,null==t?void 0:t.headers,e,null==t?void 0:t.contextValues);return null==(i=null==t?void 0:t.onHeader)||i.call(t,a.header),null==(s=null==t?void 0:t.onTrailer)||s.call(t,a.trailer),a.message};case"server_streaming":return i=t,s=e,(e,t)=>tQ(i.stream(s,null==t?void 0:t.signal,null==t?void 0:t.timeoutMs,null==t?void 0:t.headers,function(e){return t_(this,arguments,function*(){yield tM((yield*tX(tK(e))))})}([e]),null==t?void 0:t.contextValues),t);case"client_streaming":return a=t,o=e,async(e,t)=>{let r,n=await a.stream(o,null==t?void 0:t.signal,null==t?void 0:t.timeoutMs,null==t?void 0:t.headers,e,null==t?void 0:t.contextValues);null==(c=null==t?void 0:t.onHeader)||c.call(t,n.header);let i=0;try{for(var s,l,u,d,c,h,g,f=!0,m=tJ(n.message);!(s=(g=await m.next()).done);f=!0)d=g.value,f=!1,r=d,i++}catch(e){l={error:e}}finally{try{!f&&!s&&(u=m.return)&&await u.call(m)}finally{if(l)throw l.error}}if(!r)throw new tP("protocol error: missing response message",es.Unimplemented);if(i>1)throw new tP("protocol error: received extra messages for client streaming method",es.Unimplemented);return null==(h=null==t?void 0:t.onTrailer)||h.call(t,n.trailer),r};case"bidi_streaming":return l=t,u=e,(e,t)=>tQ(l.stream(u,null==t?void 0:t.signal,null==t?void 0:t.timeoutMs,null==t?void 0:t.headers,e,null==t?void 0:t.contextValues),t);default:return null}};let n={};for(let t of e.methods){let e=r(t);null!=e&&(n[t.localName]=e)}return n}(n$,function(e){var t;try{new Headers}catch(e){throw Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}let r=null==(t=e.useBinaryFormat)||t;return{async unary(t,n,i,s,a,o){let{serialize:l,parse:u}=rz(t,r,e.jsonOptions,e.binaryOptions);return i=void 0===i?e.defaultTimeoutMs:i<=0?void 0:i,await function(e){let t=rH(e.next,e.interceptors),[r,n,i]=r0(e);return t(Object.assign(Object.assign({},e.req),{message:e2(e.req.method.input,e.req.message),signal:r})).then(e=>(i(),e),n)}({interceptors:e.interceptors,signal:n,timeoutMs:i,req:{stream:!1,service:t.parent,method:t,requestMethod:"POST",url:rQ(e.baseUrl,t),header:r9(r,i,s,!1),contextValues:null!=o?o:tH(),message:a},next:async r=>{var n;let i,s,a=null!=(n=e.fetch)?n:globalThis.fetch,o=await a(r.url,Object.assign(Object.assign({},nn),{method:r.requestMethod,headers:r.header,signal:r.signal,body:tY(0,l(r.message))})),{headerError:d}=r7(o.status,o.headers);if(!o.body){if(void 0!==d)throw d;throw"missing response body"}let c=tG(o.body).getReader();for(;;){let e=await c.read();if(e.done)break;let{flags:t,data:r}=e.value;if((1&t)==1)throw new tP("protocol error: received unsupported compressed output",es.Internal);if(128===t){if(void 0!==i)throw"extra trailer";i=r4(r);continue}if(void 0!==s)throw new tP("extra message",es.Unimplemented);s=u(r)}if(void 0===i){if(void 0!==d)throw d;throw new tP("missing trailer",o.headers.has(r1)?es.Unimplemented:es.Unknown)}if(ne(i,o.headers),void 0===s)throw new tP("missing message",i.has(r1)?es.Unimplemented:es.Unknown);return{stream:!1,service:t.parent,method:t,header:o.headers,message:s,trailer:i}}})},async stream(t,n,i,s,a,o){let{serialize:l,parse:u}=rz(t,r,e.jsonOptions,e.binaryOptions);async function d(e){if("server_streaming"!=t.methodKind)throw"The fetch API does not support streaming request bodies";let r=await e[Symbol.asyncIterator]().next();if(!0==r.done)throw"missing request message";return tY(0,l(r.value))}return i=void 0===i?e.defaultTimeoutMs:i<=0?void 0:i,function(e){let t=rH(e.next,e.interceptors),[r,n,i]=r0(e),s=Object.assign(Object.assign({},e.req),{message:function(e,t){function r(t){return!0===t.done?t:{done:t.done,value:e2(e,t.value)}}return{[Symbol.asyncIterator](){let e=t[Symbol.asyncIterator](),n={next:()=>e.next().then(r)};return void 0!==e.throw&&(n.throw=t=>e.throw(t).then(r)),void 0!==e.return&&(n.return=t=>e.return(t).then(r)),n}}}(e.req.method.input,e.req.message),signal:r}),a=!1;return r.addEventListener("abort",function(){var t,r;let n=e.req.message[Symbol.asyncIterator]();a||null==(t=n.throw)||t.call(n,this.reason).catch(()=>{}),null==(r=n.return)||r.call(n).catch(()=>{})}),t(s).then(e=>Object.assign(Object.assign({},e),{message:{[Symbol.asyncIterator](){let t=e.message[Symbol.asyncIterator]();return{next:()=>t.next().then(e=>(!0==e.done&&(a=!0,i()),e),n)}}}}),n)}({interceptors:e.interceptors,signal:n,timeoutMs:i,req:{stream:!0,service:t.parent,method:t,requestMethod:"POST",url:rQ(e.baseUrl,t),header:r9(r,i,s,!1),contextValues:null!=o?o:tH(),message:a},next:async t=>{var r;let n=null!=(r=e.fetch)?r:globalThis.fetch,i=await n(t.url,Object.assign(Object.assign({},nn),{method:t.requestMethod,headers:t.header,signal:t.signal,body:await d(t.message)})),{foundStatus:s,headerError:a}=r7(i.status,i.headers);if(void 0!=a)throw a;if(!i.body)throw"missing response body";let o=new Headers;return Object.assign(Object.assign({},t),{header:i.headers,trailer:o,message:function(e,t,r,n,i){return nr(this,arguments,function*(){let s=tG(e).getReader();if(t){if(!(yield nt(s.read())).done)throw"extra data for trailers-only";return yield nt(void 0)}let a=!1;for(;;){let e=yield nt(s.read());if(e.done)break;let{flags:t,data:i}=e.value;if((128&t)==128){if(a)throw"extra trailer";a=!0;let e=r4(i);ne(e,n),e.forEach((e,t)=>r.set(t,e));continue}if(a)throw"extra message";yield yield nt(u(i))}if("throwIfAborted"in i&&i.throwIfAborted(),!a)throw"missing trailer"})}(i.body,s,o,i.headers,t.signal)})}})}}}({baseUrl:t,interceptors:[r,function(e){return t=>async r=>(e?r.header.set("x-yorkie-user-agent",e):r.header.set("x-yorkie-user-agent",aP.default.name+"/"+aP.default.version),await t(r))}(e?.userAgent)],fetch:(e,t)=>fetch(e,{...t,keepalive:this.keepalive})})),this.taskQueue=[]}async activate(){if(this.isActive())return Promise.resolve();if(this.authTokenInjector){let e=await this.authTokenInjector();this.setAuthToken(e)}return this.enqueueTask(async()=>{try{let e=await this.rpcClient.activateClient({clientKey:this.key,metadata:this.metadata},{headers:{"x-shard-key":`${this.apiKey}/${this.key}`}});this.id=e.clientId,this.status="activated",this.runSyncLoop(),an(`[AC] c:"${this.getKey()}" activated, id:"${this.id}"`),window.addEventListener("beforeunload",async()=>{await this.deactivate({keepalive:!0})})}catch(e){throw ai(`[AC] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}})}deactivate(e={keepalive:!1,synchronous:!1}){if("deactivated"===this.status)return Promise.resolve();let t=async()=>{try{await this.rpcClient.deactivateClient({clientId:this.id,synchronous:e.synchronous},{headers:{"x-shard-key":`${this.apiKey}/${this.key}`}}),this.deactivateInternal(),an(`[DC] c"${this.getKey()}" deactivated`)}catch(e){throw ai(`[DC] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}};if(e.keepalive){this.keepalive=!0;let e=t();return this.keepalive=!1,e}return this.enqueueTask(t)}has(e){return this.attachmentMap.has(e)}attach(e,t){return e instanceof aY?this.attachChannel(e,t):this.attachDocument(e,t)}attachDocument(e,t={}){if(!this.isActive())throw new nq(nH.ErrClientNotActivated,`${this.key} is not active`);if(e.getStatus()!==aB.Detached)throw new nq(nH.ErrNotDetached,`${e.getKey()} is not detached`);e.setActor(this.id),e.update((e,r)=>r.set(t.initialPresence||{}));let r=t.syncMode??"realtime";return this.enqueueTask(async()=>{try{let n=await this.rpcClient.attachDocument({clientId:this.id,changePack:s8.toChangePack(e.createChangePack()),schemaKey:t.schema},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}});(n.maxSizePerDocument??0)>0&&e.setMaxSizePerDocument(n.maxSizePerDocument),n.schemaRules.length>0&&e.setSchemaRules(s8.fromSchemaRules(n.schemaRules));let i=s8.fromChangePack(n.changePack);if(e.applyChangePack(i),e.getStatus()===aB.Removed)return e;e.applyStatus(aB.Attached),this.attachmentMap.set(e.getKey(),new aF(this.reconnectStreamDelay,e,n.documentId,r)),"manual"!==r&&await this.runWatchLoop(e.getKey()),an(`[AD] c:"${this.getKey()}" attaches d:"${e.getKey()}"`);let s=e.getRootObject();if(t.initialRoot){let r=t.initialRoot;e.update(e=>{for(let[t,n]of Object.entries(r))s.has(t)||(e[t]=n)})}return e}catch(e){throw ai(`[AD] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}})}detach(e,t){return e instanceof aY?this.detachChannel(e):this.detachDocument(e,t)}detachDocument(e,t={keepalive:!1}){if(!this.isActive())throw new nq(nH.ErrClientNotActivated,`${this.key} is not active`);let r=this.attachmentMap.get(e.getKey());if(!r)throw new nq(nH.ErrNotAttached,`${e.getKey()} is not attached`);e.update((e,t)=>t.clear());let n=async()=>{try{let t=await this.rpcClient.detachDocument({clientId:this.id,documentId:r.resourceID,changePack:s8.toChangePack(e.createChangePack())},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),n=s8.fromChangePack(t.changePack);return e.applyChangePack(n),e.getStatus()!==aB.Removed&&e.applyStatus(aB.Detached),this.detachInternal(e.getKey()),an(`[DD] c:"${this.getKey()}" detaches d:"${e.getKey()}"`),e}catch(e){throw ai(`[DD] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}};if(t.keepalive){this.keepalive=!0;let e=n();return this.keepalive=!1,e}return this.enqueueTask(n)}async attachChannel(e,t={}){if(!this.isActive())throw new nq(nH.ErrClientNotActivated,`${this.key} is not active`);if(e.getStatus()!==aU.Detached)throw new nq(nH.ErrNotDetached,`${e.getKey()} is not detached`);e.setActor(this.id);let r=async()=>{try{let r=await this.rpcClient.attachChannel({clientId:this.id,channelKey:e.getKey()},{headers:{"x-shard-key":`${this.apiKey}/${e.getFirstKeyPath()}`}});e.setSessionID(r.sessionId),e.updateSessionCount(Number(r.sessionCount),0),e.applyStatus(aU.Attached);let n=!1!==t.isRealtime?"realtime":"manual",i=new aF(this.reconnectStreamDelay,e,r.sessionId,n);return e.subscribe("local-broadcast",t=>{let{topic:r,payload:n,options:i}=t;this.broadcast(e.getKey(),r,n,i).catch(e=>{i?.error&&i.error(e),ai(`[BC] c:"${this.getKey()}" failed: ${e}`)})}),this.attachmentMap.set(e.getKey(),i),"realtime"===n&&await this.runWatchLoop(e.getKey()),an(`[AP] c:"${this.getKey()}" attaches p:"${e.getKey()}" mode:${n} count:${e.getSessionCount()}`),e}catch(e){throw ai(`[AP] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}};return this.enqueueTask(r)}async detachChannel(e){if(!this.isActive())throw new nq(nH.ErrClientNotActivated,`${this.key} is not active`);if(!this.attachmentMap.has(e.getKey()))throw new nq(nH.ErrNotAttached,`${e.getKey()} is not attached`);let t=async()=>{try{let t=await this.rpcClient.detachChannel({clientId:this.id,channelKey:e.getKey(),sessionId:e.getSessionID()},{headers:{"x-shard-key":`${this.apiKey}/${e.getFirstKeyPath()}`}});return e.updateSessionCount(Number(t.sessionCount),0),e.applyStatus(aU.Detached),this.detachInternal(e.getKey()),an(`[DP] c:"${this.getKey()}" detaches p:"${e.getKey()}" count:${e.getSessionCount()}`),e}catch(e){throw ai(`[DP] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}};return this.enqueueTask(t)}async changeSyncMode(e,t){if(!this.isActive())throw new nq(nH.ErrClientNotActivated,`${this.key} is not active`);let r=this.attachmentMap.get(e.getKey());if(!r)throw new nq(nH.ErrNotAttached,`${e.getKey()} is not attached`);let n=r.syncMode;return n===t||((r.changeSyncMode(t),"manual"===t)?r.cancelWatchStream():("realtime"===t&&(r.changeEventReceived=!0),"manual"===n&&await this.runWatchLoop(e.getKey()))),e}sync(e){if(!this.isActive())throw new nq(nH.ErrClientNotActivated,`${this.key} is not active`);if(e instanceof aY){let t=this.attachmentMap.get(e.getKey());if(!t)throw new nq(nH.ErrNotAttached,`${e.getKey()} is not attached`);return this.enqueueTask(async()=>this.syncInternal(t).catch(async e=>{throw ai(`[SY] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}))}if(e instanceof aZ){let t=this.attachmentMap.get(e.getKey());if(!t)throw new nq(nH.ErrNotAttached,`${e.getKey()} is not attached`);return this.enqueueTask(async()=>this.syncInternal(t,"realtime").catch(async e=>{throw ai(`[SY] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}))}return this.enqueueTask(async()=>{let e=[];for(let[,t]of this.attachmentMap)void 0!==t.syncMode&&t.resource instanceof aZ&&e.push(this.syncInternal(t,t.syncMode));return Promise.all(e).catch(async e=>{throw ai(`[SY] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e})})}remove(e){if(!this.isActive())throw new nq(nH.ErrClientNotActivated,`${this.key} is not active`);let t=this.attachmentMap.get(e.getKey());if(!t)throw new nq(nH.ErrNotAttached,`${e.getKey()} is not attached`);e.setActor(this.id);let r=s8.toChangePack(e.createChangePack());return r.isRemoved=!0,this.enqueueTask(async()=>{try{let n=await this.rpcClient.removeDocument({clientId:this.id,documentId:t.resourceID,changePack:r},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),i=s8.fromChangePack(n.changePack);e.applyChangePack(i),this.detachInternal(e.getKey()),an(`[RD] c:"${this.getKey()}" removes d:"${e.getKey()}"`)}catch(e){throw ai(`[RD] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}})}getID(){return this.id}getKey(){return this.key}isActive(){return"activated"===this.status}getStatus(){return this.status}getCondition(e){return this.conditions[e]}async createRevision(e,t,r){if(!this.isActive())throw new nq(nH.ErrClientNotActivated,`${this.key} is not active`);let n=this.attachmentMap.get(e.getKey());if(!n)throw new nq(nH.ErrNotAttached,`${e.getKey()} is not attached`);let i=async()=>{try{let i=await this.rpcClient.createRevision({clientId:this.id,documentId:n.resourceID,label:t,description:r||""},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}});if(!i.revision)throw new nq(nH.ErrInvalidArgument,"revision is not returned");return an(`[CR] c:"${this.getKey()}" creates revision d:"${e.getKey()}" l:"${t}"`),s8.toRevisionSummary(i.revision)}catch(e){throw ai(`[CR] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}};return this.enqueueTask(i)}async listRevisions(e,t){if(!this.isActive())throw new nq(nH.ErrClientNotActivated,`${this.key} is not active`);let r=this.attachmentMap.get(e.getKey());if(!r)throw new nq(nH.ErrNotAttached,`${e.getKey()} is not attached`);let n=async()=>{try{let n=await this.rpcClient.listRevisions({clientId:this.id,documentId:r.resourceID,pageSize:t?.pageSize||10,offset:t?.offset||0,isForward:t?.isForward??!1},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}});return an(`[LR] c:"${this.getKey()}" lists revisions d:"${e.getKey()}" count:${n.revisions.length}`),n.revisions.map(s8.toRevisionSummary)}catch(e){throw ai(`[LR] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}};return this.enqueueTask(n)}async getRevision(e,t){if(!this.isActive())throw new nq(nH.ErrClientNotActivated,`${this.key} is not active`);let r=this.attachmentMap.get(e.getKey());if(!r)throw new nq(nH.ErrNotAttached,`${e.getKey()} is not attached`);let n=async()=>{try{let n=await this.rpcClient.getRevision({clientId:this.id,documentId:r.resourceID,revisionId:t},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}});if(!n.revision)throw new nq(nH.ErrInvalidArgument,"revision is not returned");return an(`[GR] c:"${this.getKey()}" gets revision d:"${e.getKey()}" r:"${t}"`),s8.toRevisionSummary(n.revision)}catch(e){throw ai(`[GR] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}};return this.enqueueTask(n)}async restoreRevision(e,t){if(!this.isActive())throw new nq(nH.ErrClientNotActivated,`${this.key} is not active`);let r=this.attachmentMap.get(e.getKey());if(!r)throw new nq(nH.ErrNotAttached,`${e.getKey()} is not attached`);let n=async()=>{try{await this.rpcClient.restoreRevision({clientId:this.id,documentId:r.resourceID,revisionId:t},{headers:{"x-shard-key":`${this.apiKey}/${e.getKey()}`}}),an(`[RR] c:"${this.getKey()}" restores revision d:"${e.getKey()}" r:"${t}"`)}catch(e){throw ai(`[RR] c:"${this.getKey()}" err :`,e),await this.handleConnectError(e),e}};return this.enqueueTask(n)}async broadcast(e,t,r,n){if(!this.isActive())throw new nq(nH.ErrClientNotActivated,`${this.key} is not active`);let i=this.attachmentMap.get(e);if(!i)throw new nq(nH.ErrNotAttached,`${e} is not attached`);if(!(e=>{try{let t=JSON.stringify(e);if(void 0===t)return!1}catch{return!1}return!0})(r))throw new nq(nH.ErrInvalidArgument,"payload is not serializable");let s=i.resource,a=n?.maxRetries??aX.maxRetries,o=aX.maxBackoff,l=0,u=async()=>this.enqueueTask(async()=>{try{await this.rpcClient.broadcast({clientId:this.id,channelKey:e,topic:t,payload:new TextEncoder().encode(JSON.stringify(r))},{headers:{"x-shard-key":`${this.apiKey}/${s.getFirstKeyPath()}`}}),an(`[BC] c:"${this.getKey()}" broadcasts p:"${e}" t:"${t}"`)}catch(e){if(ai(`[BC] c:"${this.getKey()}" err:`,e),await this.handleConnectError(e))if(sY(e,nH.ErrUnauthenticated)&&i.resource instanceof aY&&i.resource.publish({type:aG.AuthError,reason:sU(e).reason||"unauthenticated",method:"Broadcast"}),l<a){var n;setTimeout(()=>u(),(n=++l-1,Math.min(aX.initialRetryInterval*2**n,o))),an(`[BC] c:"${this.getKey()}" retry attempt ${l}/${a}`)}else throw ai(`[BC] c:"${this.getKey()}" exceeded maximum retry attempts`),e}});return u()}runSyncLoop(){let e=async()=>{if(!this.isActive()){ar(`[SL] c:"${this.getKey()}" exit sync loop`),this.conditions.SyncLoop=!1;return}try{await this.enqueueTask(async()=>{let t=[];for(let[,e]of this.attachmentMap)e.needSync(this.channelHeartbeatInterval)&&(void 0!==e.changeEventReceived&&(e.changeEventReceived=!1),t.push(this.syncInternal(e,e.syncMode).catch(t=>{throw sY(t,nH.ErrUnauthenticated)&&e.resource.publish([{type:aW.AuthError,value:{reason:sU(t).reason,method:"PushPull"}}]),t})));await Promise.all(t),setTimeout(e,this.syncLoopDuration)})}catch(t){ai(`[SL] c:"${this.getKey()}" sync failed:`,t),await this.handleConnectError(t)?setTimeout(e,this.retrySyncLoopDelay):this.conditions.SyncLoop=!1}};ar(`[SL] c:"${this.getKey()}" run sync loop`),this.conditions.SyncLoop=!0,e()}async runWatchLoop(e){let t=this.attachmentMap.get(e);if(!t)throw new nq(nH.ErrNotAttached,`${e} is not attached`);return this.conditions.WatchLoop=!0,t.runWatchLoop(r=>{if(!this.isActive())return this.conditions.WatchLoop=!1,Promise.reject(new nq(nH.ErrClientNotActivated,`${this.key} is not active`));if(!this.attachmentMap.has(e))return this.conditions.WatchLoop=!1,Promise.reject(new nq(nH.ErrNotAttached,`${e} is not attached`));let n=new AbortController;return t.resource instanceof aZ?this.createDocumentWatchStream(t,e,n,r):t.resource instanceof aY?this.createChannelWatchStream(t,e,n,r):Promise.reject(new nq(nH.ErrClientNotActivated,`Unknown resource type for ${e}`))})}createDocumentWatchStream(e,t,r,n){let i=this.rpcClient.watch({clientId:this.id,resources:[{resource:{case:"document",value:{documentId:e.resourceID}}}]},{headers:{"x-shard-key":`${this.apiKey}/${t}`},signal:r.signal});e.resource.publish([{type:aW.ConnectionChanged,value:aL.Connected}]),an(`[WD] c:"${this.getKey()}" watches d:"${t}"`),void 0!==e.changeEventReceived&&(e.changeEventReceived=!0);let s=()=>{e.resource.resetOnlineClients(),e.resource.publish([{type:aW.Initialized,source:ie.Local,value:e.resource.getPresences()}]),e.resource.publish([{type:aW.ConnectionChanged,value:aL.Disconnected}])};return aK({stream:i,ac:r,isInit:e=>"initialization"===e.body.case,onResponse:t=>this.handleWatchDocumentResponse(e,t),onStreamEnd:()=>{s(),ar(`[WD] c:"${this.getKey()}" unwatches (stream ended)`)},onError:t=>{s(),ar(`[WD] c:"${this.getKey()}" unwatches`),sY(t,nH.ErrUnauthenticated)&&e.resource.publish([{type:aW.AuthError,value:{reason:sU(t).reason,method:"Watch"}}])},onDisconnect:n},e=>this.handleConnectError(e),()=>{this.conditions.WatchLoop=!1})}createChannelWatchStream(e,t,r,n){let i=this.rpcClient.watch({clientId:this.id,resources:[{resource:{case:"channel",value:{channelKey:t}}}]},{headers:{"x-shard-key":`${this.apiKey}/${e.resource.getFirstKeyPath()}`},signal:r.signal});return an(`[WP] c:"${this.getKey()}" watches p:"${t}"`),aK({stream:i,ac:r,isInit:e=>"initialization"===e.body.case,onResponse:t=>this.handleWatchChannelResponse(e,t),onStreamEnd:()=>{ar(`[WP] c:"${this.getKey()}" p:"${t}" stream ended`)},onError:e=>{ar(`[WP] c:"${this.getKey()}" p:"${t}" err:`,e)},onDisconnect:n,shouldIgnoreError:e=>e instanceof Error&&"AbortError"===e.name&&(ar(`[WP] c:"${this.getKey()}" p:"${t}" stream aborted`),!0)},e=>this.handleConnectError(e),()=>{this.conditions.WatchLoop=!1})}handleWatchChannelResponse(e,t){let r=e.resource;if("initialization"===t.body.case){for(let e of t.body.value.resourceInits)if("channelInit"===e.init.case){let{sessionCount:t,seq:n}=e.init.value;r.updateSessionCount(Number(t),Number(n))&&r.publish({type:aG.Initialized,count:Number(t)})}return}if("event"===t.body.case){let e=t.body.value;if("channelEvent"===e.event.case){let t=e.event.value.event;if(!t)return;if(t.type===nX.BROADCAST){let e=new TextDecoder;try{let n=JSON.parse(e.decode(t.payload));r.publish({type:aG.Broadcast,clientID:t.publisher,topic:t.topic,payload:n})}catch(e){ai(`[WP] c:"${this.getKey()}" failed to parse broadcast payload:`,e)}return}r.updateSessionCount(Number(t.sessionCount),Number(t.seq))&&r.publish({type:aG.PresenceChanged,count:Number(t.sessionCount)})}}}handleWatchDocumentResponse(e,t){if("initialization"===t.body.case){for(let r of t.body.value.resourceInits)"documentInit"===r.init.case&&e.resource.applyWatchInit(r.init.value.clientIds);return}if("event"===t.body.case){let r=t.body.value;if("docEvent"===r.event.case){let t=r.event.value;if(t.event?.type===nz.DOCUMENT_CHANGED){void 0!==e.changeEventReceived&&(e.changeEventReceived=!0);return}t.event&&e.resource.applyDocEvent(t.event.type,t.event.publisher)}}}deactivateInternal(){for(let[e,t]of(this.status="deactivated",this.attachmentMap))this.detachInternal(e),t.resource instanceof aZ?t.resource.applyStatus(aB.Detached):t.resource instanceof aY&&t.resource.applyStatus(aU.Detached)}detachInternal(e){let t=this.attachmentMap.get(e);t&&(t.cancelWatchStream(),t.resource instanceof aZ&&t.resource.resetOnlineClients(),this.attachmentMap.delete(e))}async syncInternal(e,t){let{resource:r}=e;if(r instanceof aY){try{let t=await this.rpcClient.refreshChannel({clientId:this.id,channelKey:r.getKey(),sessionId:r.getSessionID()},{headers:{"x-shard-key":`${this.apiKey}/${r.getFirstKeyPath()}`}});r.updateSessionCount(Number(t.sessionCount),0),e.updateHeartbeatTime(),ar(`[RP] c:"${this.getKey()}" refreshes p:"${r.getKey()}" mode:${e.syncMode}`)}catch(e){throw ai(`[RP] c:"${this.getKey()}" err :`,e),e}return r}let{resourceID:n}=e,i=r.createChangePack();try{let s=await this.rpcClient.pushPullChanges({clientId:this.id,documentId:n,changePack:s8.toChangePack(i),pushOnly:"realtime-pushonly"===t},{headers:{"x-shard-key":`${this.apiKey}/${r.getKey()}`}}),a=s8.fromChangePack(s.changePack);if(a.hasChanges()&&("realtime-pushonly"===e.syncMode||"realtime-syncoff"===e.syncMode))return r;r.applyChangePack(a),e.resource.publish([{type:aW.SyncStatusChanged,value:aO.Synced}]),r.getStatus()===aB.Removed&&this.detachInternal(r.getKey());let o=r.getKey(),l=a.getChangeSize();return an(`[PP] c:"${this.getKey()}" sync d:"${o}", push:${i.getChangeSize()} pull:${l} cp:${a.getCheckpoint().toTestString()}`),r}catch(e){throw r.publish([{type:aW.SyncStatusChanged,value:aO.SyncFailed}]),ai(`[PP] c:"${this.getKey()}" err :`,e),e}}async handleConnectError(e){if(!(e instanceof tP))return!1;if(e.code===es.Canceled||e.code===es.Unknown||e.code===es.ResourceExhausted||e.code===es.Unavailable)return!0;if(sG(e)===nH.ErrUnauthenticated){if(this.authTokenInjector){let t=await this.authTokenInjector(sU(e).reason);this.setAuthToken(t)}return!0}return sG(e)===nH.ErrTooManySubscribers?(ai(`[WD] c:"${this.getKey()}" err :`,e.rawMessage),!0):sG(e)!==nH.ErrTooManyAttachments&&((sG(e)===nH.ErrClientNotActivated||sG(e)===nH.ErrClientNotFound)&&this.deactivateInternal(),!1)}enqueueTask(e){return new Promise((t,r)=>{this.taskQueue.push(()=>e().then(t).catch(r)),this.processing||this.processNext()})}async processNext(){if(0===this.taskQueue.length){this.processing=!1;return}try{this.processing=!0;let e=this.taskQueue.shift();await e()}catch{ai(`[TQ] c:"${this.getKey()}" process failed, id:"${this.id}"`)}this.processNext()}}function az(e){return"object"==typeof e&&null!==e&&"Text"===e.type&&Array.isArray(e.nodes)}function a$(e){return"object"==typeof e&&null!==e&&"Tree"===e.type&&"object"==typeof e.root}function aj(e){return"object"==typeof e&&null!==e&&"Int"===e.type&&"number"==typeof e.value}function aQ(e){return"object"==typeof e&&null!==e&&"Long"===e.type&&"number"==typeof e.value}function aH(e){return"object"==typeof e&&null!==e&&"Date"===e.type&&"string"==typeof e.value}function aq(e){return"object"==typeof e&&null!==e&&"BinData"===e.type&&"string"==typeof e.value}function a0(e){return"object"==typeof e&&null!==e&&"Counter"===e.type&&"object"==typeof e.value}function a1(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&!az(e)&&!a$(e)&&!aj(e)&&!aQ(e)&&!aH(e)&&!aq(e)&&!a0(e)}function a2(e){try{let t,r=t=(t=(t=(t=(t=(t=(t=e.replace(/Counter\((Int|Long)\((-?\d+)\)\)/g,(e,t,r)=>`{"__yson_type":"Counter","__yson_data":{"__yson_type":"${t}","__yson_data":${r}}}`)).replace(/Int\((-?\d+)\)/g,(e,t)=>`{"__yson_type":"Int","__yson_data":${t}}`)).replace(/Long\((-?\d+)\)/g,(e,t)=>`{"__yson_type":"Long","__yson_data":${t}}`)).replace(/Date\("([^"]*)"\)/g,(e,t)=>`{"__yson_type":"Date","__yson_data":"${t}"}`)).replace(/BinData\("([^"]*)"\)/g,(e,t)=>`{"__yson_type":"BinData","__yson_data":"${t}"}`)).replace(/Text\((\[(?:[^[\]]|\[(?:[^[\]]|\[[^[\]]*\])*\])*\])\)/g,(e,t)=>`{"__yson_type":"Text","__yson_data":${t}}`)).replace(/Tree\((\{[^{}]*(?:\{[^{}]*(?:\{[^{}]*\})*[^{}]*\})*[^{}]*\})\)/g,(e,t)=>`{"__yson_type":"Tree","__yson_data":${t}}`),n=JSON.parse(r);return function e(t){if(null===t||"object"!=typeof t)return t;if("Int"===t.__yson_type&&"number"==typeof t.__yson_data)return{type:"Int",value:t.__yson_data};if("Long"===t.__yson_type&&"number"==typeof t.__yson_data)return{type:"Long",value:t.__yson_data};if("Date"===t.__yson_type&&"string"==typeof t.__yson_data)return{type:"Date",value:t.__yson_data};if("BinData"===t.__yson_type&&"string"==typeof t.__yson_data)return{type:"BinData",value:t.__yson_data};if("Counter"===t.__yson_type&&"object"==typeof t.__yson_data){let r=e(t.__yson_data);if("object"==typeof r&&null!==r&&"type"in r&&("Int"===r.type||"Long"===r.type))return{type:"Counter",value:r};throw new nq(nH.ErrInvalidArgument,"Counter must contain Int or Long")}if("Text"===t.__yson_type&&Array.isArray(t.__yson_data))return{type:"Text",nodes:t.__yson_data.map(e=>(function(e){if("object"!=typeof e||null===e||"string"!=typeof e.val)throw new nq(nH.ErrInvalidArgument,"invalid text node format");let t={val:e.val};return e.attrs&&"object"==typeof e.attrs&&(t.attrs=e.attrs),t})(e))};if("Tree"===t.__yson_type&&"object"==typeof t.__yson_data)return{type:"Tree",root:function e(t){if("object"!=typeof t||null===t||"string"!=typeof t.type)throw new nq(nH.ErrInvalidArgument,"invalid tree node format");let r={type:t.type};return"text"===t.type&&"string"==typeof t.value?r.value=t.value:(t.attrs&&"object"==typeof t.attrs&&(r.attrs=t.attrs),Array.isArray(t.children)&&(r.children=t.children.map(t=>e(t)))),r}(t.__yson_data)};if(Array.isArray(t))return t.map(t=>e(t));let r={};for(let[n,i]of Object.entries(t))r[n]=e(i);return r}(n)}catch(e){throw new nq(nH.ErrInvalidArgument,`Failed to parse YSON: ${e instanceof Error?e.message:String(e)}`)}}function a3(e){return e.nodes.map(e=>e.val).join("")}function a5(e){return function e(t){let r=t.attrs?Object.entries(t.attrs).map(([e,t])=>` ${e}="${a9(t)}"`).join(""):"";if("text"===t.type&&void 0!==t.value)return`<${t.type}${r}>${a9(t.value)}</${t.type}>`;if(!t.children||0===t.children.length)return`<${t.type}${r} />`;let n=t.children.map(t=>e(t)).join("");return`<${t.type}${r}>${n}</${t.type}>`}(e.root)}function a9(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}e.i(31403),e.s([],84470),e.i(84470),e.s(["isBinData",()=>aq,"isCounter",()=>a0,"isDate",()=>aH,"isInt",()=>aj,"isLong",()=>aQ,"isObject",()=>a1,"isText",()=>az,"isTree",()=>a$,"parse",()=>a2,"textToString",()=>a3,"treeToXML",()=>a5],99054);var a4=e.i(99054);sS.Int,sS.Long,"undefined"!=typeof globalThis&&(globalThis.yorkie={Client:aJ,Document:aZ,Primitive:ik,Text:af,Counter:am,Tree:aA,Channel:aY,ChannelEventType:aG,YSON:a4,LogLevel:s7,setLogLevel:function(e){ae=e},IntType:sS.Int,LongType:sS.Long});var a6=e.i(22533),a8=e.i(68942);let a7=(0,a8.createContext)({client:void 0,loading:!0,error:void 0}),oe=({children:e,...t})=>{let{client:r,loading:n,error:i}=function(e){let[t,r]=(0,a8.useState)(void 0),[n,i]=(0,a8.useState)(!0),[s,a]=(0,a8.useState)(void 0),[o,l]=(0,a8.useState)(!1);return(0,a8.useEffect)(()=>{l(!0)},[]),(0,a8.useEffect)(()=>(i(!0),a(void 0),async function(){if(o)try{let t=new aJ(e);await t.activate(),r(t)}catch(e){a(e instanceof Error?e:Error("Failed to activate client"))}finally{i(!1)}}(),()=>{t?.isActive()&&t.deactivate({keepalive:!0})}),[e.apiKey,e.rpcAddr,o]),{client:t,loading:n,error:s}}((0,a8.useMemo)(()=>({userAgent:a6.default.name+"/"+a6.default.version,...t}),[t.apiKey,t.rpcAddr]));return(0,eV.jsx)(a7.Provider,{value:{client:r,loading:n,error:i},children:e})},ot=(0,a8.createContext)(void 0),or=({docKey:e,initialRoot:t={},initialPresence:r={},enableDevtools:n=!1,children:i})=>{var s;let a,o,{client:l,loading:u,error:d}=(()=>{let e=(0,a8.useContext)(a7);if(!e)throw Error("useYorkie must be used under YorkieProvider");return{client:e.client,loading:e.loading,error:e.error}})(),c=(0,a8.useRef)(void 0);c.current||(s={doc:void 0,root:t,presences:[],connection:aL.Disconnected,update:()=>{},loading:!0,error:void 0},a=new Set,o=s,c.current={subscribe:e=>(a.add(e),()=>a.delete(e)),getSnapshot:()=>o,setState:e=>{let t=o;o="function"==typeof e?e(t):e,t!==o&&a.forEach(e=>e(o))},destroy:()=>{a.clear()}});let h=c.current;return!function(e,t,r,n,i,s,a,o){let l=(0,a8.useRef)(i),u=(0,a8.useRef)(s),[d,c]=(0,a8.useState)(!1);(0,a8.useEffect)(()=>{c(!0)},[]),(0,a8.useEffect)(()=>{if(r)return void o.setState(e=>({...e,loading:!1,error:r}));if(!e||t||!d)return void o.setState(e=>({...e,loading:!0}));o.setState(e=>({...e,loading:!0,error:void 0}));let i=new aZ(n,{enableDevtools:a}),s=[];return s.push(i.subscribe(()=>{o.setState(e=>({...e,root:i.getRoot()}))})),s.push(i.subscribe("presence",()=>{o.setState(e=>({...e,presences:i.getPresences()}))})),s.push(i.subscribe("connection",e=>{o.setState(t=>({...t,connection:e.value}))})),async function(){try{await e?.attach(i,{initialRoot:l.current,initialPresence:u.current});let t=e=>{try{i.update(e)}catch(e){o.setState(t=>({...t,error:e instanceof Error?e:Error("Failed to update document")}))}};o.setState(e=>({...e,doc:i,root:i.getRoot(),presences:i.getPresences(),update:t}))}catch(e){o.setState(t=>({...t,error:e instanceof Error?e:Error("Failed to attach document")}))}finally{o.setState(e=>({...e,loading:!1}))}}(),()=>{for(let t of(e&&e.has(n)&&e.detach(i),s))t()}},[e,t,r,n,o,d])}(l,u,d,e,t,r,n,h),(0,eV.jsx)(ot.Provider,{value:h,children:i})};function on(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=function e(t){var r,n,i="";if("string"==typeof t||"number"==typeof t)i+=t;else if("object"==typeof t)if(Array.isArray(t)){var s=t.length;for(r=0;r<s;r++)t[r]&&(n=e(t[r]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}(e))&&(n&&(n+=" "),n+=t);return n}let oi=(e=new Map,t=null,r)=>({nextPart:e,validators:t,classGroupId:r}),os=[],oa=(e,t,r)=>{if(0==e.length-t)return r.classGroupId;let n=e[t],i=r.nextPart.get(n);if(i){let r=oa(e,t+1,i);if(r)return r}let s=r.validators;if(null===s)return;let a=0===t?e.join("-"):e.slice(t).join("-"),o=s.length;for(let e=0;e<o;e++){let t=s[e];if(t.validator(a))return t.classGroupId}},oo=(e,t)=>{let r=oi();for(let n in e)ol(e[n],r,n,t);return r},ol=(e,t,r,n)=>{let i=e.length;for(let s=0;s<i;s++)ou(e[s],t,r,n)},ou=(e,t,r,n)=>{"string"==typeof e?od(e,t,r):"function"==typeof e?oc(e,t,r,n):oh(e,t,r,n)},od=(e,t,r)=>{(""===e?t:og(t,e)).classGroupId=r},oc=(e,t,r,n)=>{of(e)?ol(e(n),t,r,n):(null===t.validators&&(t.validators=[]),t.validators.push({classGroupId:r,validator:e}))},oh=(e,t,r,n)=>{let i=Object.entries(e),s=i.length;for(let e=0;e<s;e++){let[s,a]=i[e];ol(a,og(t,s),r,n)}},og=(e,t)=>{let r=e,n=t.split("-"),i=n.length;for(let e=0;e<i;e++){let t=n[e],i=r.nextPart.get(t);i||(i=oi(),r.nextPart.set(t,i)),r=i}return r},of=e=>"isThemeGetter"in e&&!0===e.isThemeGetter,om=[],op=(e,t,r,n,i)=>({modifiers:e,hasImportantModifier:t,baseClassName:r,maybePostfixModifierPosition:n,isExternal:i}),oy=/\s+/,ob=e=>{let t;if("string"==typeof e)return e;let r="";for(let n=0;n<e.length;n++)e[n]&&(t=ob(e[n]))&&(r&&(r+=" "),r+=t);return r},ov=[],oA=e=>{let t=t=>t[e]||ov;return t.isThemeGetter=!0,t},oS=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,oE=/^\((?:(\w[\w-]*):)?(.+)\)$/i,oI=/^\d+\/\d+$/,ow=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,oN=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,oR=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,oC=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,oT=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ox=e=>oI.test(e),oV=e=>!!e&&!Number.isNaN(Number(e)),oD=e=>!!e&&Number.isInteger(Number(e)),ok=e=>e.endsWith("%")&&oV(e.slice(0,-1)),oB=e=>ow.test(e),oW=()=>!0,oL=e=>oN.test(e)&&!oR.test(e),oO=()=>!1,oZ=e=>oC.test(e),oF=e=>oT.test(e),oP=e=>!oG(e)&&!oJ(e),oU=e=>o0(e,o5,oO),oG=e=>oS.test(e),oY=e=>o0(e,o9,oL),oK=e=>o0(e,o4,oV),oM=e=>o0(e,o2,oO),o_=e=>o0(e,o3,oF),oX=e=>o0(e,o8,oZ),oJ=e=>oE.test(e),oz=e=>o1(e,o9),o$=e=>o1(e,o6),oj=e=>o1(e,o2),oQ=e=>o1(e,o5),oH=e=>o1(e,o3),oq=e=>o1(e,o8,!0),o0=(e,t,r)=>{let n=oS.exec(e);return!!n&&(n[1]?t(n[1]):r(n[2]))},o1=(e,t,r=!1)=>{let n=oE.exec(e);return!!n&&(n[1]?t(n[1]):r)},o2=e=>"position"===e||"percentage"===e,o3=e=>"image"===e||"url"===e,o5=e=>"length"===e||"size"===e||"bg-size"===e,o9=e=>"length"===e,o4=e=>"number"===e,o6=e=>"family-name"===e,o8=e=>"shadow"===e,o7=((e,...t)=>{let r,n,i,s,a=e=>{let t=n(e);if(t)return t;let s=((e,t)=>{let{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i,sortModifiers:s}=t,a=[],o=e.trim().split(oy),l="";for(let e=o.length-1;e>=0;e-=1){let t=o[e],{isExternal:u,modifiers:d,hasImportantModifier:c,baseClassName:h,maybePostfixModifierPosition:g}=r(t);if(u){l=t+(l.length>0?" "+l:l);continue}let f=!!g,m=n(f?h.substring(0,g):h);if(!m){if(!f||!(m=n(h))){l=t+(l.length>0?" "+l:l);continue}f=!1}let p=0===d.length?"":1===d.length?d[0]:s(d).join(":"),y=c?p+"!":p,b=y+m;if(a.indexOf(b)>-1)continue;a.push(b);let v=i(m,f);for(let e=0;e<v.length;++e){let t=v[e];a.push(y+t)}l=t+(l.length>0?" "+l:l)}return l})(e,r);return i(e,s),s};return s=o=>{var l;let u;return n=(r={cache:(e=>{if(e<1)return{get:()=>void 0,set:()=>{}};let t=0,r=Object.create(null),n=Object.create(null),i=(i,s)=>{r[i]=s,++t>e&&(t=0,n=r,r=Object.create(null))};return{get(e){let t=r[e];return void 0!==t?t:void 0!==(t=n[e])?(i(e,t),t):void 0},set(e,t){e in r?r[e]=t:i(e,t)}}})((l=t.reduce((e,t)=>t(e),e())).cacheSize),parseClassName:(e=>{let{prefix:t,experimentalParseClassName:r}=e,n=e=>{let t,r=[],n=0,i=0,s=0,a=e.length;for(let o=0;o<a;o++){let a=e[o];if(0===n&&0===i){if(":"===a){r.push(e.slice(s,o)),s=o+1;continue}if("/"===a){t=o;continue}}"["===a?n++:"]"===a?n--:"("===a?i++:")"===a&&i--}let o=0===r.length?e:e.slice(s),l=o,u=!1;return o.endsWith("!")?(l=o.slice(0,-1),u=!0):o.startsWith("!")&&(l=o.slice(1),u=!0),op(r,u,l,t&&t>s?t-s:void 0)};if(t){let e=t+":",r=n;n=t=>t.startsWith(e)?r(t.slice(e.length)):op(om,!1,t,void 0,!0)}if(r){let e=n;n=t=>r({className:t,parseClassName:e})}return n})(l),sortModifiers:(u=new Map,l.orderSensitiveModifiers.forEach((e,t)=>{u.set(e,1e6+t)}),e=>{let t=[],r=[];for(let n=0;n<e.length;n++){let i=e[n],s="["===i[0],a=u.has(i);s||a?(r.length>0&&(r.sort(),t.push(...r),r=[]),t.push(i)):r.push(i)}return r.length>0&&(r.sort(),t.push(...r)),t}),...(e=>{let t=(e=>{let{theme:t,classGroups:r}=e;return oo(r,t)})(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:e=>{if(e.startsWith("[")&&e.endsWith("]")){var r;let t,n,i;return -1===(r=e).slice(1,-1).indexOf(":")?void 0:(n=(t=r.slice(1,-1)).indexOf(":"),(i=t.slice(0,n))?"arbitrary.."+i:void 0)}let n=e.split("-"),i=+(""===n[0]&&n.length>1);return oa(n,i,t)},getConflictingClassGroupIds:(e,t)=>{if(t){let t=n[e],i=r[e];if(t){if(i){let e=Array(i.length+t.length);for(let t=0;t<i.length;t++)e[t]=i[t];for(let r=0;r<t.length;r++)e[i.length+r]=t[r];return e}return t}return i||os}return r[e]||os}}})(l)}).cache.get,i=r.cache.set,s=a,a(o)},(...e)=>s(((...e)=>{let t,r,n=0,i="";for(;n<e.length;)(t=e[n++])&&(r=ob(t))&&(i&&(i+=" "),i+=r);return i})(...e))})(()=>{let e=oA("color"),t=oA("font"),r=oA("text"),n=oA("font-weight"),i=oA("tracking"),s=oA("leading"),a=oA("breakpoint"),o=oA("container"),l=oA("spacing"),u=oA("radius"),d=oA("shadow"),c=oA("inset-shadow"),h=oA("text-shadow"),g=oA("drop-shadow"),f=oA("blur"),m=oA("perspective"),p=oA("aspect"),y=oA("ease"),b=oA("animate"),v=()=>["auto","avoid","all","avoid-page","page","left","right","column"],A=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],S=()=>[...A(),oJ,oG],E=()=>["auto","hidden","clip","visible","scroll"],I=()=>["auto","contain","none"],w=()=>[oJ,oG,l],N=()=>[ox,"full","auto",...w()],R=()=>[oD,"none","subgrid",oJ,oG],C=()=>["auto",{span:["full",oD,oJ,oG]},oD,oJ,oG],T=()=>[oD,"auto",oJ,oG],x=()=>["auto","min","max","fr",oJ,oG],V=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],D=()=>["start","end","center","stretch","center-safe","end-safe"],k=()=>["auto",...w()],B=()=>[ox,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...w()],W=()=>[e,oJ,oG],L=()=>[...A(),oj,oM,{position:[oJ,oG]}],O=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Z=()=>["auto","cover","contain",oQ,oU,{size:[oJ,oG]}],F=()=>[ok,oz,oY],P=()=>["","none","full",u,oJ,oG],U=()=>["",oV,oz,oY],G=()=>["solid","dashed","dotted","double"],Y=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],K=()=>[oV,ok,oj,oM],M=()=>["","none",f,oJ,oG],_=()=>["none",oV,oJ,oG],X=()=>["none",oV,oJ,oG],J=()=>[oV,oJ,oG],z=()=>[ox,"full",...w()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[oB],breakpoint:[oB],color:[oW],container:[oB],"drop-shadow":[oB],ease:["in","out","in-out"],font:[oP],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[oB],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[oB],shadow:[oB],spacing:["px",oV],text:[oB],"text-shadow":[oB],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ox,oG,oJ,p]}],container:["container"],columns:[{columns:[oV,oG,oJ,o]}],"break-after":[{"break-after":v()}],"break-before":[{"break-before":v()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:S()}],overflow:[{overflow:E()}],"overflow-x":[{"overflow-x":E()}],"overflow-y":[{"overflow-y":E()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:N()}],"inset-x":[{"inset-x":N()}],"inset-y":[{"inset-y":N()}],start:[{start:N()}],end:[{end:N()}],top:[{top:N()}],right:[{right:N()}],bottom:[{bottom:N()}],left:[{left:N()}],visibility:["visible","invisible","collapse"],z:[{z:[oD,"auto",oJ,oG]}],basis:[{basis:[ox,"full","auto",o,...w()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[oV,ox,"auto","initial","none",oG]}],grow:[{grow:["",oV,oJ,oG]}],shrink:[{shrink:["",oV,oJ,oG]}],order:[{order:[oD,"first","last","none",oJ,oG]}],"grid-cols":[{"grid-cols":R()}],"col-start-end":[{col:C()}],"col-start":[{"col-start":T()}],"col-end":[{"col-end":T()}],"grid-rows":[{"grid-rows":R()}],"row-start-end":[{row:C()}],"row-start":[{"row-start":T()}],"row-end":[{"row-end":T()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":x()}],"auto-rows":[{"auto-rows":x()}],gap:[{gap:w()}],"gap-x":[{"gap-x":w()}],"gap-y":[{"gap-y":w()}],"justify-content":[{justify:[...V(),"normal"]}],"justify-items":[{"justify-items":[...D(),"normal"]}],"justify-self":[{"justify-self":["auto",...D()]}],"align-content":[{content:["normal",...V()]}],"align-items":[{items:[...D(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...D(),{baseline:["","last"]}]}],"place-content":[{"place-content":V()}],"place-items":[{"place-items":[...D(),"baseline"]}],"place-self":[{"place-self":["auto",...D()]}],p:[{p:w()}],px:[{px:w()}],py:[{py:w()}],ps:[{ps:w()}],pe:[{pe:w()}],pt:[{pt:w()}],pr:[{pr:w()}],pb:[{pb:w()}],pl:[{pl:w()}],m:[{m:k()}],mx:[{mx:k()}],my:[{my:k()}],ms:[{ms:k()}],me:[{me:k()}],mt:[{mt:k()}],mr:[{mr:k()}],mb:[{mb:k()}],ml:[{ml:k()}],"space-x":[{"space-x":w()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":w()}],"space-y-reverse":["space-y-reverse"],size:[{size:B()}],w:[{w:[o,"screen",...B()]}],"min-w":[{"min-w":[o,"screen","none",...B()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...B()]}],h:[{h:["screen","lh",...B()]}],"min-h":[{"min-h":["screen","lh","none",...B()]}],"max-h":[{"max-h":["screen","lh",...B()]}],"font-size":[{text:["base",r,oz,oY]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,oJ,oK]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",ok,oG]}],"font-family":[{font:[o$,oG,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,oJ,oG]}],"line-clamp":[{"line-clamp":[oV,"none",oJ,oK]}],leading:[{leading:[s,...w()]}],"list-image":[{"list-image":["none",oJ,oG]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",oJ,oG]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:W()}],"text-color":[{text:W()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...G(),"wavy"]}],"text-decoration-thickness":[{decoration:[oV,"from-font","auto",oJ,oY]}],"text-decoration-color":[{decoration:W()}],"underline-offset":[{"underline-offset":[oV,"auto",oJ,oG]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:w()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",oJ,oG]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",oJ,oG]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:L()}],"bg-repeat":[{bg:O()}],"bg-size":[{bg:Z()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},oD,oJ,oG],radial:["",oJ,oG],conic:[oD,oJ,oG]},oH,o_]}],"bg-color":[{bg:W()}],"gradient-from-pos":[{from:F()}],"gradient-via-pos":[{via:F()}],"gradient-to-pos":[{to:F()}],"gradient-from":[{from:W()}],"gradient-via":[{via:W()}],"gradient-to":[{to:W()}],rounded:[{rounded:P()}],"rounded-s":[{"rounded-s":P()}],"rounded-e":[{"rounded-e":P()}],"rounded-t":[{"rounded-t":P()}],"rounded-r":[{"rounded-r":P()}],"rounded-b":[{"rounded-b":P()}],"rounded-l":[{"rounded-l":P()}],"rounded-ss":[{"rounded-ss":P()}],"rounded-se":[{"rounded-se":P()}],"rounded-ee":[{"rounded-ee":P()}],"rounded-es":[{"rounded-es":P()}],"rounded-tl":[{"rounded-tl":P()}],"rounded-tr":[{"rounded-tr":P()}],"rounded-br":[{"rounded-br":P()}],"rounded-bl":[{"rounded-bl":P()}],"border-w":[{border:U()}],"border-w-x":[{"border-x":U()}],"border-w-y":[{"border-y":U()}],"border-w-s":[{"border-s":U()}],"border-w-e":[{"border-e":U()}],"border-w-t":[{"border-t":U()}],"border-w-r":[{"border-r":U()}],"border-w-b":[{"border-b":U()}],"border-w-l":[{"border-l":U()}],"divide-x":[{"divide-x":U()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":U()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...G(),"hidden","none"]}],"divide-style":[{divide:[...G(),"hidden","none"]}],"border-color":[{border:W()}],"border-color-x":[{"border-x":W()}],"border-color-y":[{"border-y":W()}],"border-color-s":[{"border-s":W()}],"border-color-e":[{"border-e":W()}],"border-color-t":[{"border-t":W()}],"border-color-r":[{"border-r":W()}],"border-color-b":[{"border-b":W()}],"border-color-l":[{"border-l":W()}],"divide-color":[{divide:W()}],"outline-style":[{outline:[...G(),"none","hidden"]}],"outline-offset":[{"outline-offset":[oV,oJ,oG]}],"outline-w":[{outline:["",oV,oz,oY]}],"outline-color":[{outline:W()}],shadow:[{shadow:["","none",d,oq,oX]}],"shadow-color":[{shadow:W()}],"inset-shadow":[{"inset-shadow":["none",c,oq,oX]}],"inset-shadow-color":[{"inset-shadow":W()}],"ring-w":[{ring:U()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:W()}],"ring-offset-w":[{"ring-offset":[oV,oY]}],"ring-offset-color":[{"ring-offset":W()}],"inset-ring-w":[{"inset-ring":U()}],"inset-ring-color":[{"inset-ring":W()}],"text-shadow":[{"text-shadow":["none",h,oq,oX]}],"text-shadow-color":[{"text-shadow":W()}],opacity:[{opacity:[oV,oJ,oG]}],"mix-blend":[{"mix-blend":[...Y(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Y()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[oV]}],"mask-image-linear-from-pos":[{"mask-linear-from":K()}],"mask-image-linear-to-pos":[{"mask-linear-to":K()}],"mask-image-linear-from-color":[{"mask-linear-from":W()}],"mask-image-linear-to-color":[{"mask-linear-to":W()}],"mask-image-t-from-pos":[{"mask-t-from":K()}],"mask-image-t-to-pos":[{"mask-t-to":K()}],"mask-image-t-from-color":[{"mask-t-from":W()}],"mask-image-t-to-color":[{"mask-t-to":W()}],"mask-image-r-from-pos":[{"mask-r-from":K()}],"mask-image-r-to-pos":[{"mask-r-to":K()}],"mask-image-r-from-color":[{"mask-r-from":W()}],"mask-image-r-to-color":[{"mask-r-to":W()}],"mask-image-b-from-pos":[{"mask-b-from":K()}],"mask-image-b-to-pos":[{"mask-b-to":K()}],"mask-image-b-from-color":[{"mask-b-from":W()}],"mask-image-b-to-color":[{"mask-b-to":W()}],"mask-image-l-from-pos":[{"mask-l-from":K()}],"mask-image-l-to-pos":[{"mask-l-to":K()}],"mask-image-l-from-color":[{"mask-l-from":W()}],"mask-image-l-to-color":[{"mask-l-to":W()}],"mask-image-x-from-pos":[{"mask-x-from":K()}],"mask-image-x-to-pos":[{"mask-x-to":K()}],"mask-image-x-from-color":[{"mask-x-from":W()}],"mask-image-x-to-color":[{"mask-x-to":W()}],"mask-image-y-from-pos":[{"mask-y-from":K()}],"mask-image-y-to-pos":[{"mask-y-to":K()}],"mask-image-y-from-color":[{"mask-y-from":W()}],"mask-image-y-to-color":[{"mask-y-to":W()}],"mask-image-radial":[{"mask-radial":[oJ,oG]}],"mask-image-radial-from-pos":[{"mask-radial-from":K()}],"mask-image-radial-to-pos":[{"mask-radial-to":K()}],"mask-image-radial-from-color":[{"mask-radial-from":W()}],"mask-image-radial-to-color":[{"mask-radial-to":W()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":A()}],"mask-image-conic-pos":[{"mask-conic":[oV]}],"mask-image-conic-from-pos":[{"mask-conic-from":K()}],"mask-image-conic-to-pos":[{"mask-conic-to":K()}],"mask-image-conic-from-color":[{"mask-conic-from":W()}],"mask-image-conic-to-color":[{"mask-conic-to":W()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:L()}],"mask-repeat":[{mask:O()}],"mask-size":[{mask:Z()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",oJ,oG]}],filter:[{filter:["","none",oJ,oG]}],blur:[{blur:M()}],brightness:[{brightness:[oV,oJ,oG]}],contrast:[{contrast:[oV,oJ,oG]}],"drop-shadow":[{"drop-shadow":["","none",g,oq,oX]}],"drop-shadow-color":[{"drop-shadow":W()}],grayscale:[{grayscale:["",oV,oJ,oG]}],"hue-rotate":[{"hue-rotate":[oV,oJ,oG]}],invert:[{invert:["",oV,oJ,oG]}],saturate:[{saturate:[oV,oJ,oG]}],sepia:[{sepia:["",oV,oJ,oG]}],"backdrop-filter":[{"backdrop-filter":["","none",oJ,oG]}],"backdrop-blur":[{"backdrop-blur":M()}],"backdrop-brightness":[{"backdrop-brightness":[oV,oJ,oG]}],"backdrop-contrast":[{"backdrop-contrast":[oV,oJ,oG]}],"backdrop-grayscale":[{"backdrop-grayscale":["",oV,oJ,oG]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[oV,oJ,oG]}],"backdrop-invert":[{"backdrop-invert":["",oV,oJ,oG]}],"backdrop-opacity":[{"backdrop-opacity":[oV,oJ,oG]}],"backdrop-saturate":[{"backdrop-saturate":[oV,oJ,oG]}],"backdrop-sepia":[{"backdrop-sepia":["",oV,oJ,oG]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":w()}],"border-spacing-x":[{"border-spacing-x":w()}],"border-spacing-y":[{"border-spacing-y":w()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",oJ,oG]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[oV,"initial",oJ,oG]}],ease:[{ease:["linear","initial",y,oJ,oG]}],delay:[{delay:[oV,oJ,oG]}],animate:[{animate:["none",b,oJ,oG]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[m,oJ,oG]}],"perspective-origin":[{"perspective-origin":S()}],rotate:[{rotate:_()}],"rotate-x":[{"rotate-x":_()}],"rotate-y":[{"rotate-y":_()}],"rotate-z":[{"rotate-z":_()}],scale:[{scale:X()}],"scale-x":[{"scale-x":X()}],"scale-y":[{"scale-y":X()}],"scale-z":[{"scale-z":X()}],"scale-3d":["scale-3d"],skew:[{skew:J()}],"skew-x":[{"skew-x":J()}],"skew-y":[{"skew-y":J()}],transform:[{transform:[oJ,oG,"","none","gpu","cpu"]}],"transform-origin":[{origin:S()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:z()}],"translate-x":[{"translate-x":z()}],"translate-y":[{"translate-y":z()}],"translate-z":[{"translate-z":z()}],"translate-none":["translate-none"],accent:[{accent:W()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:W()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",oJ,oG]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":w()}],"scroll-mx":[{"scroll-mx":w()}],"scroll-my":[{"scroll-my":w()}],"scroll-ms":[{"scroll-ms":w()}],"scroll-me":[{"scroll-me":w()}],"scroll-mt":[{"scroll-mt":w()}],"scroll-mr":[{"scroll-mr":w()}],"scroll-mb":[{"scroll-mb":w()}],"scroll-ml":[{"scroll-ml":w()}],"scroll-p":[{"scroll-p":w()}],"scroll-px":[{"scroll-px":w()}],"scroll-py":[{"scroll-py":w()}],"scroll-ps":[{"scroll-ps":w()}],"scroll-pe":[{"scroll-pe":w()}],"scroll-pt":[{"scroll-pt":w()}],"scroll-pr":[{"scroll-pr":w()}],"scroll-pb":[{"scroll-pb":w()}],"scroll-pl":[{"scroll-pl":w()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",oJ,oG]}],fill:[{fill:["none",...W()]}],"stroke-w":[{stroke:[oV,oz,oY,oK]}],stroke:[{stroke:["none",...W()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});function le({className:e,...t}){return(0,eV.jsx)("div",{"data-slot":"card",className:((...e)=>o7(on(e)))("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function lt({className:e,...t}){return(0,eV.jsx)("div",{"data-slot":"card-header",className:((...e)=>o7(on(e)))("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function lr({className:e,...t}){return(0,eV.jsx)("div",{"data-slot":"card-title",className:((...e)=>o7(on(e)))("leading-none font-semibold",e),...t})}function ln({className:e,...t}){return(0,eV.jsx)("div",{"data-slot":"card-content",className:((...e)=>o7(on(e)))("px-6",e),...t})}function li({className:e,type:t,...r}){return(0,eV.jsx)("input",{type:t,"data-slot":"input",className:((...e)=>o7(on(e)))("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...r})}function ls(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}var la=Symbol.for("react.lazy"),lo=a8[" use ".trim().toString()];function ll(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===la&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}var lu=((u=a8.forwardRef((e,t)=>{let{children:r,...n}=e;if(ll(r)&&"function"==typeof lo&&(r=lo(r._payload)),a8.isValidElement(r)){var i;let e,s,a=(i=r,(s=(e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.ref:(s=(e=Object.getOwnPropertyDescriptor(i,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.props.ref:i.props.ref||i.ref),o=function(e,t){let r={...t};for(let n in t){let i=e[n],s=t[n];/^on[A-Z]/.test(n)?i&&s?r[n]=(...e)=>{let t=s(...e);return i(...e),t}:i&&(r[n]=i):"style"===n?r[n]={...i,...s}:"className"===n&&(r[n]=[i,s].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==a8.Fragment&&(o.ref=t?function(...e){return t=>{let r=!1,n=e.map(e=>{let n=ls(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():ls(e[t],null)}}}}(t,a):a),a8.cloneElement(r,o)}return a8.Children.count(r)>1?a8.Children.only(null):null})).displayName="Slot.SlotClone",s=u,(a=a8.forwardRef((e,t)=>{let{children:r,...n}=e;ll(r)&&"function"==typeof lo&&(r=lo(r._payload));let i=a8.Children.toArray(r),a=i.find(lc);if(a){let e=a.props.children,r=i.map(t=>t!==a?t:a8.Children.count(e)>1?a8.Children.only(null):a8.isValidElement(e)?e.props.children:null);return(0,eV.jsx)(s,{...n,ref:t,children:a8.isValidElement(e)?a8.cloneElement(e,void 0,r):null})}return(0,eV.jsx)(s,{...n,ref:t,children:r})})).displayName="Slot.Slot",a),ld=Symbol("radix.slottable");function lc(e){return a8.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===ld}let lh=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,lg=(o="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",l={variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}},e=>{var t;if((null==l?void 0:l.variants)==null)return on(o,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:r,defaultVariants:n}=l,i=Object.keys(r).map(t=>{let i=null==e?void 0:e[t],s=null==n?void 0:n[t];if(null===i)return null;let a=lh(i)||lh(s);return r[t][a]}),s=e&&Object.entries(e).reduce((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e},{});return on(o,i,null==l||null==(t=l.compoundVariants)?void 0:t.reduce((e,t)=>{let{class:r,className:i,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...n,...s}[t]):({...n,...s})[t]===r})?[...e,r,i]:e},[]),null==e?void 0:e.class,null==e?void 0:e.className)});function lf({className:e,variant:t,size:r,asChild:n=!1,...i}){return(0,eV.jsx)(n?lu:"button",{"data-slot":"button",className:((...e)=>o7(on(e)))(lg({variant:t,size:r,className:e})),...i})}let lm=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},lp=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var ly={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let lb=(0,a8.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:a,...o},l)=>(0,a8.createElement)("svg",{ref:l,...ly,width:t,height:t,stroke:e,strokeWidth:n?24*Number(r)/Number(t):r,className:lp("lucide",i),...!s&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(o)&&{"aria-hidden":"true"},...o},[...a.map(([e,t])=>(0,a8.createElement)(e,t)),...Array.isArray(s)?s:[s]])),lv=(e,t)=>{let r=(0,a8.forwardRef)(({className:r,...n},i)=>(0,a8.createElement)(lb,{ref:i,iconNode:t,className:lp(`lucide-${lm(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...n}));return r.displayName=lm(e),r},lA=lv("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),lS=lv("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),lE=lv("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),lI=()=>{let[e,t]=(0,a8.useState)(""),{root:r,presences:n,update:i,loading:s,error:a}=function(){let e=(0,a8.useContext)(ot);if(!e)throw Error("useDocument must be used within a DocumentProvider");return function(e,t,r=Object.is){let n=(0,a8.useRef)(void 0),i=(0,a8.useRef)(r),s=(0,a8.useRef)(void 0);n.current=void 0,i.current=r;let a=()=>{let t=e.getSnapshot(),r=n.current?n.current(t):t;return void 0!==s.current&&i.current(s.current,r)?s.current:(s.current=r,r)};return(0,a8.useSyncExternalStore)(e.subscribe,a,a)}(e)}(),o=(0,a8.useMemo)(()=>n?.length,[n]),l=()=>{""!==e.trim()&&(i(t=>{t.todos.push({id:String(Date.now()),text:e,completed:!1})}),t(""))};return s?(0,eV.jsx)("p",{children:"Loading..."}):a?(0,eV.jsxs)("p",{children:["Error: ",a.message]}):(0,eV.jsxs)(le,{className:"w-full max-w-md mx-auto",children:[(0,eV.jsxs)(lt,{children:[(0,eV.jsx)(lr,{className:"text-center",children:"Todo List"}),(0,eV.jsx)("div",{className:"text-center text-sm text-gray-500",children:o>0?(0,eV.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,eV.jsx)("div",{className:"flex -space-x-2",children:[...Array(Math.min(o,3))].map((e,t)=>(0,eV.jsx)("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-blue-200 to-blue-300 border-2 border-white flex items-center justify-center text-white text-xs",children:""},t))}),(0,eV.jsx)("span",{children:1===o?"Working solo":`${o} people in this space`})]}):(0,eV.jsx)("span",{className:"text-gray-400",children:"No participants"})})]}),(0,eV.jsxs)(ln,{children:[(0,eV.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,eV.jsx)(li,{type:"text",value:e,onChange:e=>t(e.target.value),onKeyUp:e=>{"Enter"===e.key&&l()},placeholder:"Enter a new todo",className:"flex-1"}),(0,eV.jsx)(lf,{onClick:l,className:"px-4",children:(0,eV.jsx)(lE,{className:"h-4 w-4"})})]}),(0,eV.jsx)("div",{className:"space-y-2",children:r.todos.map(e=>(0,eV.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,eV.jsxs)("div",{className:"flex items-center gap-2",children:[(0,eV.jsx)(lf,{variant:e.completed?"default":"outline",size:"sm",onClick:()=>{var t;return t=e.id,void i(e=>{for(let r of e.todos)if(r.id===t){r.completed=!r.completed;break}})},children:(0,eV.jsx)(lS,{className:"h-4 w-4"})}),(0,eV.jsx)("span",{className:`${e.completed?"line-through text-gray-500":""}`,children:e.text})]}),(0,eV.jsx)(lf,{variant:"ghost",size:"sm",onClick:()=>{var t;return t=e.id,void i(e=>{let r=e.todos.findIndex(e=>e.id===t);-1!==r&&e.todos.delete?.(r)})},className:"text-red-500 hover:text-red-700",children:(0,eV.jsx)(lA,{className:"h-4 w-4"})})]},e.id))})]})]})};function lw(){return(0,eV.jsx)(oe,{apiKey:"D6sd9E5ehtXBssmeRZ4QQP",rpcAddr:"https://api.yorkie.dev",children:(0,eV.jsx)(or,{docKey:"nextjs-todolist",initialRoot:{todos:[]},children:(0,eV.jsx)("main",{className:"container mx-auto p-4",children:(0,eV.jsx)(lI,{})})})})}e.s(["default",()=>lw],82052)}]);